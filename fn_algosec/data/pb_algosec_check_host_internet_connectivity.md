<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - AlgoSec: Check Host Internet Connectivity - Example (PB)

### API Name
`algosec_check_host_internet_connectivity`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type in ['IP Address', 'DNS Name', 'Network CIDR Range']`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Destination | `algosec_destination` | text | The destination address to test if the given source address can reach | Optional |

### Object Type
`artifact`

### Description
Check internet connection for a given "IP Address" artifact using AlgoSec FireFlow. The connectivity query results are updated in the incident's Data Table called "AlgoSec Internet Connection"


---
## Function - AlgoSec: Traffic Simulation Query

### API Name
`algosec_traffic_simulation_query`

### Output Name
`inet_check_output`

### Message Destination
`fn_algosec`

### Function-Input Script
```python
inputs.algosec_source = artifact.value
inputs.algosec_destination = getattr(playbook.inputs, "algosec_destination", "8.8.8.8") or "8.8.8.8"
inputs.algosec_service = "any"
```

---

## Local script - Check Internet Connectivity output

### Description


### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
from datetime import datetime
results = playbook.functions.results.inet_check_output
content = results.get("content", {})

# Processing if the function is a success
if results.get("success"):
  for queryResult in content.get("queryResult", []):
    # Add Row
    row = incident.addRow("algosec_internet_connectivity_queries")
    row.artifact_ip = artifact.value
    row.query_description = queryResult.get("queryDescription")
    row.traffic_simulation_fip_results = queryResult.get("fipResult")
    row.traffic_simulation_final_results = queryResult.get("finalResult")
    row.query_html_path = f'<a href=\"{queryResult.get("queryHTMLPath")}\"target=\"_blank\">{queryResult.get("queryHTMLPath")}</a>'
    row.query_date = datetime.now()
else:
  incident.addNote(f"Check Internet Connectivity Failed with reason: {results.get('reason')}")
```

---

