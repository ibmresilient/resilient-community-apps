<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.1.1.824
-->

# Playbook - Wiz: Sync Status

### API Name
`wiz_sync_status`

### Status
`enabled`

### Activation Type
`Automatic`

### Activation Conditions
`incident.plan_status changed_to Closed AND incident.properties.wiz_issue_id has_a_value AND incident.resolution_summary not_contains Closed by Wiz:`

### Object Type
`incident`

### Description
Update Wiz issue status if case status changes


---
## Function - Wiz: Sync Status

### API Name
`wiz_sync_status`

### Output Name
`status_results`

### Message Destination
`fn_wiz`

### Function-Input Script
```python
inputs.wiz_issue_id = incident.properties.wiz_issue_id
inputs.wiz_resolution_reason = incident.resolution_id
inputs.wiz_resolution_summary = incident.resolution_summary.content
```

---

## Local script - Add note with results

### Description
Add a note to SOAR case to indicate success or failure in updating Wiz issue

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
results = playbook.functions.results.status_results
if not results.success:
  incident.addNote(f"<b>Wiz: Sync Status:</b> Unable to sync issue status: {results.reason}")
else:
  content = results.get('content', {})
  if content:
    issue = content.get('response', None)
    if issue:
      new_status = "REJECTED"
      incident.properties.wiz_issue_status = new_status
      incident.addNote(f"<b>Wiz: Sync Status:</b> Successfully closed Wiz issue with status {new_status}")
    else:
      incident.addNote("<b>Wiz: Sync Status:</b> Unable to sync issue status because Wiz Issue not found")
```

---

