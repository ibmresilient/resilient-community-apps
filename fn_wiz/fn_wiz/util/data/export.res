{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1732107197071,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_num_results",
      "hide_notification": false,
      "id": 376,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_num_results",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_num_results",
      "tooltip": "",
      "type_id": 11,
      "uuid": "82f65c98-798c-40d8-8db9-a068cb9808d7",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_issue_id",
      "hide_notification": false,
      "id": 377,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_issue_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_issue_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "8489af53-4bd8-46eb-8a83-3ed924c61b90",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_soar_note",
      "hide_notification": false,
      "id": 378,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_soar_note",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_soar_note",
      "tooltip": "",
      "type_id": 11,
      "uuid": "9b10f0c6-1298-4255-a164-a137a7b353bc",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_resolution_summary",
      "hide_notification": false,
      "id": 379,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_resolution_summary",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_resolution_summary",
      "tooltip": "Resolution summary from SOAR case",
      "type_id": 11,
      "uuid": "c9aa5758-11ea-4dcc-a1c0-3c3a363c503c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_resolution_reason",
      "hide_notification": false,
      "id": 380,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_resolution_reason",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_resolution_reason",
      "tooltip": "",
      "type_id": 11,
      "uuid": "27a8e57c-f0a5-4d3e-9ae8-93347cdbcf4a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_project_ids",
      "hide_notification": false,
      "id": 381,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_project_ids",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_project_ids",
      "tooltip": "",
      "type_id": 11,
      "uuid": "583a002f-debd-44c3-97e0-55641baf6dc7",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/wiz_query_filter",
      "hide_notification": false,
      "id": 382,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_query_filter",
      "operation_perms": {},
      "operations": [],
      "placeholder": "{ \"first\": 5, \"filterBy\": { \"vendorSeverity\": [ \"CRITICAL\" ] } }",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "wiz_query_filter",
      "tooltip": "Dictionary that represents \u0027variables\u0027 object that gets passed with the Wiz query to filter results. Required \u0027first\u0027 parameter.",
      "type_id": 11,
      "uuid": "64e093be-c5be-4a06-b08e-c16dcbc88dc1",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/wiz_issue_status",
      "hide_notification": false,
      "id": 360,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_issue_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Wiz Issue Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "81116d67-7b6f-4823-8c49-c1b1cadcc9d4",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/wiz_issue_type",
      "hide_notification": false,
      "id": 384,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_issue_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Wiz Issue Type",
      "tooltip": "",
      "type_id": 0,
      "uuid": "b27b1638-1f49-48ac-a758-b393985cf038",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/wiz_issue_id",
      "hide_notification": false,
      "id": 361,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_issue_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Wiz Issue Id",
      "tooltip": "",
      "type_id": 0,
      "uuid": "589259ce-db51-4696-a064-e2f6f8c61c48",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/wiz_description",
      "hide_notification": false,
      "id": 362,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "wiz_description",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Wiz Description",
      "tooltip": "Source control description from Wiz Issue",
      "type_id": 0,
      "uuid": "747beb2e-e612-49e6-b6cb-a558521ddaa6",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1731937742265,
      "description": {
        "content": "Query Wiz for vulnerability data. Default query searches for OPEN vulnerabilities that have \"HIGH\" and \"CRITICAL\" Vendor Severity.",
        "format": "text"
      },
      "destination_handle": "fn_wiz",
      "display_name": "Wiz: Pull Vulnerabilities",
      "export_key": "wiz_pull_vulnerabilities",
      "id": 3,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1731937742265,
      "name": "wiz_pull_vulnerabilities",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"response\": [{\"id\": \"1234567-abcdefg\", \"portalUrl\": \"https://app.wiz.io/explorer/vulnerability-findings#~(entity~(~\u0027ID))\", \"name\": \"CWE-89\", \"CVEDescription\": \"The software constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.\", \"CVSSSeverity\": \"NONE\", \"score\": 0, \"exploitabilityScore\": 0, \"impactScore\": 0, \"dataSourceName\": \"Wiz Demo\", \"hasExploit\": null, \"hasCisaKevExploit\": false, \"status\": \"OPEN\", \"vendorSeverity\": \"CRITICAL\", \"firstDetectedAt\": \"2024-04-15T11:12:05.228481Z\", \"lastDetectedAt\": \"2024-04-15T11:12:05.228481Z\", \"resolvedAt\": null, \"description\": \"The vulnerability `CWE-89`  was found in the  `GET /WebGoat/SqlInjectionMitigations/servers?column=id` with  severity of `Critical`.The vulnerability can be remediated by \u0027use an Object-Relational Mapping (ORM) like Hibernate that safely handles database interaction`.\", \"remediation\": \"The most effective method of stopping SQL injection attacks is to only use an Object-Relational Mapping (ORM) like Hibernate...\", \"detailedName\": \"GET /WebGoat/SqlInjectionMitigations/servers?column=id\", \"version\": null, \"fixedVersion\": null, \"detectionMethod\": \"EXTERNAL_NETWORK_SCAN\", \"link\": \"https:/test/com\", \"locationPath\": null, \"resolutionReason\": null, \"epssSeverity\": null, \"epssPercentile\": 0, \"epssProbability\": 0, \"validatedInRuntime\": null, \"layerMetadata\": null, \"projects\": [{\"id\": \"1234567-abcdefg\", \"name\": \"Project 2\", \"slug\": \"project-2\", \"businessUnit\": \"\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}, {\"id\": \"1234567-abcdefg\", \"name\": \"project 4\", \"slug\": \"project-4\", \"businessUnit\": \"Dev\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}, {\"id\": \"1234567-abcdefg\", \"name\": \"Project1\", \"slug\": \"project1\", \"businessUnit\": \"Dev\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}], \"ignoreRules\": null, \"vulnerableAsset\": {\"id\": \"1234567-abcdefg\", \"type\": \"VIRTUAL_MACHINE\", \"name\": \"Demo vulns findings\", \"region\": \"us-east-2\", \"providerUniqueId\": \"arn:aws:instance/abcedefg\", \"cloudProviderURL\": \"https://test-console.aws.amazon.com/ec2/v2/home?#instanceDetailsid=0\", \"cloudPlatform\": \"AWS\", \"status\": \"Active\", \"subscriptionName\": \"wiz-integrations\", \"subscriptionExternalId\": \"998231069301\", \"subscriptionId\": \"abcdefg-12345\", \"tags\": {\"Name\": \"Demo vulns findings\"}, \"hasLimitedInternetExposure\": true, \"hasWideInternetExposure\": true, \"isAccessibleFromVPN\": null, \"isAccessibleFromOtherVnets\": null, \"isAccessibleFromOtherSubscriptions\": null, \"operatingSystem\": \"Linux\", \"ipAddresses\": [\"1.1.1.1\", \"2.2.2.2\"]}}, {\"id\": \"1234567-abcdefg\", \"portalUrl\": \"https://app.wiz.io/explorer/vulnerability-findings#~(entity~(~\u0027ID))\", \"name\": \"CWE-89\", \"CVEDescription\": \"The software constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.\", \"CVSSSeverity\": \"NONE\", \"score\": 0, \"exploitabilityScore\": 0, \"impactScore\": 0, \"dataSourceName\": \"Wiz Demo\", \"hasExploit\": null, \"hasCisaKevExploit\": false, \"status\": \"OPEN\", \"vendorSeverity\": \"CRITICAL\", \"firstDetectedAt\": \"2024-04-15T11:12:05.226955Z\", \"lastDetectedAt\": \"2024-04-15T11:12:05.226955Z\", \"resolvedAt\": null, \"description\": \"The vulnerability `CWE-89`  was found in the  `GET /WebGoat/SqlInjectionMitigations/servers?column=id` with  severity of `Critical`.The vulnerability can be remediated by \u0027use an Object-Relational Mapping (ORM) like Hibernate that safely handles database interaction`.\", \"remediation\": \"The most effective method of stopping SQL injection attacks is to only use an Object-Relational Mapping (ORM) like Hibernate...\", \"detailedName\": \"GET /WebGoat/SqlInjectionMitigations/servers?column=id\", \"version\": null, \"fixedVersion\": null, \"detectionMethod\": \"EXTERNAL_NETWORK_SCAN\", \"link\": \"https:/test/com\", \"locationPath\": null, \"resolutionReason\": null, \"epssSeverity\": null, \"epssPercentile\": 0, \"epssProbability\": 0, \"validatedInRuntime\": null, \"layerMetadata\": null, \"projects\": [{\"id\": \"1234567-abcdefg\", \"name\": \"Project 2\", \"slug\": \"project-2\", \"businessUnit\": \"\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}, {\"id\": \"1234567-abcdefg\", \"name\": \"project 4\", \"slug\": \"project-4\", \"businessUnit\": \"Dev\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}, {\"id\": \"1234567-abcdefg\", \"name\": \"Project1\", \"slug\": \"project1\", \"businessUnit\": \"Dev\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}], \"ignoreRules\": null, \"vulnerableAsset\": {\"id\": \"1234567-abcdefg\", \"type\": \"CONTAINER_IMAGE\", \"name\": \"test-aws.amazonaws.com/eks/kube-proxy@sha256:7d1eabcdefg\", \"region\": \"us-east-1\", \"providerUniqueId\": \"\", \"cloudProviderURL\": null, \"cloudPlatform\": \"AWS\", \"status\": \"Active\", \"subscriptionName\": null, \"subscriptionExternalId\": \"6024000000000\", \"subscriptionId\": \"e644fdd8-abcdefg\", \"tags\": {\"io.cri-containerd.image\": \"managed\"}, \"hasLimitedInternetExposure\": null, \"hasWideInternetExposure\": null, \"isAccessibleFromVPN\": null, \"isAccessibleFromOtherVnets\": null, \"isAccessibleFromOtherSubscriptions\": null, \"imageId\": \"sha256:7d1eabcdefg\"}}], \"projects\": [\"83b76efe-a7b6-5762-8a53-8e8f59e68bd8\", \"af52828c-4eb1-5c4e-847c-ebc3a5ead531\", \"d6ac50bb-aec0-52fc-80ab-bacd7b02f178\"]}, \"raw\": null, \"inputs\": {\"wiz_project_ids\": \"83b76efe-a7b6-5762-8a53-8e8f59e68bd8,af52828c-4eb1-5c4e-847c-ebc3a5ead531,d6ac50bb-aec0-52fc-80ab-bacd7b02f178\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-wiz\", \"package_version\": \"1.0.1982\", \"host\": \"e35c5a28-689e-4f7f-b84e-4eced01ba15f-55b865fcb6-pnkfz\", \"execution_time_ms\": 3713, \"timestamp\": \"2024-04-15 11:57:40\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"response\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"portalUrl\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}, \"CVEDescription\": {\"type\": \"string\"}, \"CVSSSeverity\": {\"type\": \"string\"}, \"score\": {\"type\": \"number\"}, \"exploitabilityScore\": {\"type\": \"number\"}, \"impactScore\": {\"type\": \"number\"}, \"dataSourceName\": {\"type\": [\"null\", \"string\"]}, \"hasExploit\": {\"type\": [\"boolean\", \"null\"]}, \"hasCisaKevExploit\": {\"type\": \"boolean\"}, \"status\": {\"type\": \"string\"}, \"vendorSeverity\": {\"type\": \"string\"}, \"firstDetectedAt\": {\"type\": \"string\"}, \"lastDetectedAt\": {\"type\": \"string\"}, \"resolvedAt\": {}, \"description\": {\"type\": \"string\"}, \"remediation\": {\"type\": \"string\"}, \"detailedName\": {\"type\": \"string\"}, \"version\": {\"type\": [\"null\", \"string\"]}, \"fixedVersion\": {\"type\": [\"null\", \"string\"]}, \"detectionMethod\": {\"type\": \"string\"}, \"link\": {\"type\": \"string\"}, \"locationPath\": {}, \"resolutionReason\": {}, \"epssSeverity\": {\"type\": [\"null\", \"string\"]}, \"epssPercentile\": {\"type\": \"number\"}, \"epssProbability\": {\"type\": \"number\"}, \"validatedInRuntime\": {}, \"layerMetadata\": {}, \"projects\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}, \"slug\": {\"type\": \"string\"}, \"businessUnit\": {\"type\": \"string\"}, \"riskProfile\": {\"type\": \"object\", \"properties\": {\"businessImpact\": {\"type\": \"string\"}}}}}}, \"ignoreRules\": {}, \"vulnerableAsset\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"type\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}, \"region\": {\"type\": \"string\"}, \"providerUniqueId\": {\"type\": \"string\"}, \"cloudProviderURL\": {\"type\": [\"null\", \"string\"]}, \"cloudPlatform\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}, \"subscriptionName\": {\"type\": [\"null\", \"string\"]}, \"subscriptionExternalId\": {\"type\": \"string\"}, \"subscriptionId\": {\"type\": \"string\"}, \"tags\": {\"type\": \"object\", \"properties\": {\"Name\": {\"type\": \"string\"}, \"io.cri-containerd.image\": {\"type\": \"string\"}}}, \"hasLimitedInternetExposure\": {\"type\": [\"boolean\", \"null\"]}, \"hasWideInternetExposure\": {\"type\": [\"boolean\", \"null\"]}, \"isAccessibleFromVPN\": {}, \"isAccessibleFromOtherVnets\": {}, \"isAccessibleFromOtherSubscriptions\": {}, \"operatingSystem\": {\"type\": \"string\"}, \"ipAddresses\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"imageId\": {\"type\": \"string\"}}}}}}, \"projects\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"wiz_project_ids\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "124ecedc-0933-479a-bf9d-5e6f6e3af6d5",
      "version": 0,
      "view_items": [
        {
          "content": "82f65c98-798c-40d8-8db9-a068cb9808d7",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "583a002f-debd-44c3-97e0-55641baf6dc7",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "64e093be-c5be-4a06-b08e-c16dcbc88dc1",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1731937742479,
      "description": {
        "content": "Enrich case data with issue data",
        "format": "text"
      },
      "destination_handle": "fn_wiz",
      "display_name": "Wiz: Query Issue",
      "export_key": "wiz_query_issue",
      "id": 4,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1731937742479,
      "name": "wiz_query_issue",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"response\": {\"id\": \"dec4dad8-abcdefg\", \"sourceRule\": {\"__typename\": \"Control\", \"id\": \"60873d6d-abcdefg\", \"name\": \"All Findings\", \"controlDescription\": \"\", \"resolutionRecommendation\": \"\", \"securitySubCategories\": null}, \"createdAt\": \"2024-04-15T10:16:14.443631Z\", \"updatedAt\": \"2024-04-15T11:55:20.484648Z\", \"dueAt\": null, \"type\": \"TOXIC_COMBINATION\", \"resolvedAt\": null, \"statusChangedAt\": \"2024-04-15T10:14:50.891007Z\", \"projects\": [{\"id\": \"83b76efe-abcdefg\", \"name\": \"Project 2\", \"slug\": \"project-2\", \"businessUnit\": \"\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}, {\"id\": \"af52828c-abcdefg\", \"name\": \"project 4\", \"slug\": \"project-4\", \"businessUnit\": \"Dev\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}, {\"id\": \"d6ac50bb-abcdefg\", \"name\": \"Project1\", \"slug\": \"project1\", \"businessUnit\": \"Dev\", \"riskProfile\": {\"businessImpact\": \"MBI\"}}], \"status\": \"OPEN\", \"severity\": \"INFORMATIONAL\", \"entitySnapshot\": {\"id\": \"fa059989-abcdefg\", \"type\": \"SECURITY_TOOL_FINDING\", \"nativeType\": \"\", \"name\": \"CVE-2023-5528\", \"status\": null, \"cloudPlatform\": null, \"cloudProviderURL\": \"\", \"providerId\": \"vulnerability##592f0bdc-ab9b##\", \"region\": \"\", \"resourceGroupExternalId\": \"\", \"subscriptionExternalId\": \"\", \"subscriptionName\": \"\", \"subscriptionTags\": null, \"tags\": {}, \"createdAt\": null, \"externalId\": \"vulnerability##592f0bdc-ab9b##\"}, \"serviceTickets\": [], \"notes\": [{\"createdAt\": \"2024-04-15T11:55:20.461314Z\", \"updatedAt\": \"2024-04-15T11:55:20.46232Z\", \"text\": \"Note from SOAR: test note\", \"user\": null, \"serviceAccount\": {\"name\": \"ibm-soar\"}}]}}, \"raw\": null, \"inputs\": {\"wiz_issue_id\": \"dec4dad8-abcdefg\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-wiz\", \"package_version\": \"1.0.1982\", \"host\": \"e35c5a28-abcdefg\", \"execution_time_ms\": 668, \"timestamp\": \"2024-04-15 11:57:34\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"response\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"sourceRule\": {\"type\": \"object\", \"properties\": {\"__typename\": {\"type\": \"string\"}, \"id\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}, \"controlDescription\": {\"type\": \"string\"}, \"resolutionRecommendation\": {\"type\": \"string\"}, \"securitySubCategories\": {}}}, \"createdAt\": {\"type\": \"string\"}, \"updatedAt\": {\"type\": \"string\"}, \"dueAt\": {}, \"type\": {\"type\": \"string\"}, \"resolvedAt\": {}, \"statusChangedAt\": {\"type\": \"string\"}, \"projects\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}, \"slug\": {\"type\": \"string\"}, \"businessUnit\": {\"type\": \"string\"}, \"riskProfile\": {\"type\": \"object\", \"properties\": {\"businessImpact\": {\"type\": \"string\"}}}}}}, \"status\": {\"type\": \"string\"}, \"severity\": {\"type\": \"string\"}, \"entitySnapshot\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"type\": {\"type\": \"string\"}, \"nativeType\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}, \"status\": {}, \"cloudPlatform\": {}, \"cloudProviderURL\": {\"type\": \"string\"}, \"providerId\": {\"type\": \"string\"}, \"region\": {\"type\": \"string\"}, \"resourceGroupExternalId\": {\"type\": \"string\"}, \"subscriptionExternalId\": {\"type\": \"string\"}, \"subscriptionName\": {\"type\": \"string\"}, \"subscriptionTags\": {}, \"tags\": {\"type\": \"object\"}, \"createdAt\": {}, \"externalId\": {\"type\": \"string\"}}}, \"serviceTickets\": {\"type\": \"array\"}, \"notes\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"createdAt\": {\"type\": \"string\"}, \"updatedAt\": {\"type\": \"string\"}, \"text\": {\"type\": \"string\"}, \"user\": {}, \"serviceAccount\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}}}}}}}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"wiz_issue_id\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "31695a54-304d-4f0b-985e-98d8ebb539bf",
      "version": 0,
      "view_items": [
        {
          "content": "8489af53-4bd8-46eb-8a83-3ed924c61b90",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1731937742574,
      "description": {
        "content": "Send notes from SOAR case to Wiz issue",
        "format": "text"
      },
      "destination_handle": "fn_wiz",
      "display_name": "Wiz: Send SOAR Notes",
      "export_key": "wiz_send_soar_notes",
      "id": 5,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1731937742574,
      "name": "wiz_send_soar_notes",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"response\": {\"id\": \"dec4dad8-abcdefg\", \"note\": \"\", \"status\": \"OPEN\", \"dueAt\": null, \"resolutionReason\": null}, \"message\": \"Successfully updated issue.\"}, \"raw\": null, \"inputs\": {\"wiz_issue_id\": \"dec4dad8-abcdefg\", \"wiz_soar_note\": \"\u003cdiv class=\\\"soar-rte-content\\\"\u003e\u003cp\u003etest\u003c/p\u003e\u003c/div\u003e\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-wiz\", \"package_version\": \"1.0.1982\", \"host\": \"e35c5a28-abcdefg\", \"execution_time_ms\": 2034, \"timestamp\": \"2024-04-15 11:58:17\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"response\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"note\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}, \"dueAt\": {}, \"resolutionReason\": {}}}, \"message\": {\"type\": \"string\"}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"wiz_issue_id\": {\"type\": \"string\"}, \"wiz_soar_note\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "ddf384b4-3436-4f45-95e3-228d55fb7637",
      "version": 0,
      "view_items": [
        {
          "content": "8489af53-4bd8-46eb-8a83-3ed924c61b90",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9b10f0c6-1298-4255-a164-a137a7b353bc",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1731937742666,
      "description": {
        "content": "Update Wiz issue status if case status changed",
        "format": "text"
      },
      "destination_handle": "fn_wiz",
      "display_name": "Wiz: Sync Status",
      "export_key": "wiz_sync_status",
      "id": 6,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1731937742666,
      "name": "wiz_sync_status",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"response\": {\"id\": \"dec4dad8-abcdefg\", \"note\": \"\", \"status\": \"REJECTED\", \"dueAt\": null, \"resolutionReason\": \"WONT_FIX\"}, \"message\": \"Successfully updated issue.\"}, \"raw\": null, \"inputs\": {\"wiz_issue_id\": \"dec4dad8-abcdefg\", \"wiz_resolution_reason\": \"Not an Issue\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-wiz\", \"package_version\": \"1.0.1982\", \"host\": \"e35c5a28-4eabcdefg\", \"execution_time_ms\": 1383, \"timestamp\": \"2024-04-15 11:58:34\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"response\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"note\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}, \"dueAt\": {}, \"resolutionReason\": {\"type\": \"string\"}}}, \"message\": {\"type\": \"string\"}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"wiz_issue_id\": {\"type\": \"string\"}, \"wiz_resolution_reason\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "fa25185e-8150-487d-b070-688992b78c8e",
      "version": 0,
      "view_items": [
        {
          "content": "8489af53-4bd8-46eb-8a83-3ed924c61b90",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "27a8e57c-f0a5-4d3e-9ae8-93347cdbcf4a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c9aa5758-11ea-4dcc-a1c0-3c3a363c503c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 5,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1732107195237,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1732107195237,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "20a45f5e-1ebb-4c8e-9ffb-641c85a8169e"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_wiz",
      "name": "fn_wiz",
      "programmatic_name": "fn_wiz",
      "tags": [],
      "users": [
        "a@example.com"
      ],
      "uuid": "0593dcba-7e35-415b-b9bb-7bb2aab55b9e"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.wiz_issue_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2\" isExecutable=\"true\" name=\"playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1ijgcvx\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Wiz: Query Issue\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"31695a54-304d-4f0b-985e-98d8ebb539bf\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.wiz_issue_id = incident.properties.wiz_issue_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"query_issue_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ijgcvx\u003c/incoming\u003e\u003coutgoing\u003eFlow_04422z6\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1ijgcvx\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_04422z6\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_8\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1abiwjc\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"Wiz: Pull Vulnerabilities\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"124ecedc-0933-479a-bf9d-5e6f6e3af6d5\"\u003e{\"inputs\":{},\"pre_processing_script\":\"\\\"\\\"\\\"\\nPull out project ids associated with the given issue. We can use this to query Wiz for vulnerabilities data.\\n\\\"\\\"\\\"\\n\\nresults = playbook.functions.results.query_issue_results\\n\\nproject_ids = []\\nif not results.success:\\n  incident.addNote(\\\"\u0026lt;b\u0026gt;Wiz: Populate Case:\u0026lt;/b\u0026gt; Unable to get issue data to retrieve projects.\\\")\\nelse:\\n  projects = results.get(\\\"content\\\", {}).get(\\\"response\\\", {}).get(\\\"projects\\\", [])\\n  if projects:\\n    inputs.wiz_project_ids = \\\",\\\".join([p.get(\\\"id\\\") for p in projects])\\n  \\n# OPTIONAL: Specify the maximum desired number of results, returns max of 50 results by default\\n# inputs.wiz_num_results = \\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"vulnerability_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ncoseb\u003c/incoming\u003e\u003coutgoing\u003eFlow_0tihdpj\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0tihdpj\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_9\"/\u003e\u003cscriptTask id=\"ScriptTask_7\" name=\"Create Artifacts from Projects\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"939142ef-3610-4d0b-bb91-a4f99d5a37cb\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1hv7mi8\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ncoseb\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1ncoseb\" sourceRef=\"ScriptTask_7\" targetRef=\"ServiceTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_8\" name=\"Populate Projects Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4c144b81-9d68-44c5-bf71-790481da0f7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_04422z6\u003c/incoming\u003e\u003coutgoing\u003eFlow_1hv7mi8\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1hv7mi8\" sourceRef=\"ScriptTask_8\" targetRef=\"ScriptTask_7\"/\u003e\u003cscriptTask id=\"ScriptTask_9\" name=\"Wiz: Populate Vulnerabilities Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"350f11de-1515-4d59-bf9a-de801acb3acc\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0tihdpj\u003c/incoming\u003e\u003coutgoing\u003eFlow_1abiwjc\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1abiwjc\" sourceRef=\"ScriptTask_9\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1abiwjc\" id=\"Flow_1abiwjc_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"772\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"844\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1hv7mi8\" id=\"Flow_1hv7mi8_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ncoseb\" id=\"Flow_1ncoseb_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"558\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0tihdpj\" id=\"Flow_0tihdpj_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"642\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"665\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"665\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"688\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_04422z6\" id=\"Flow_04422z6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ijgcvx\" id=\"Flow_1ijgcvx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"558\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_7\" id=\"ScriptTask_7_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_8\" id=\"ScriptTask_8_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"277.6499938964844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_9\" id=\"ScriptTask_9_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.4118852459017\" y=\"687.8196721311475\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1731937743294,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2",
      "description": {
        "content": "Add Wiz issue details to SOAR case: Get Issue data, create artifacts for projects, populate a data table for project details. Continue to get relevant vulnerabilities that affect the projects related to the issue. Use this data to populate a vulnerabilities data table.",
        "format": "text"
      },
      "display_name": "Wiz: Populate Case",
      "export_key": "wiz_populate_case",
      "field_type_handle": "playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2",
      "fields_type": {
        "actions": [],
        "display_name": "Wiz: Populate Case",
        "export_key": "playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2",
        "uuid": "7e81cf0d-35af-41a1-bab0-199359fce062"
      },
      "has_logical_errors": false,
      "id": 3,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1732049536435,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1731937743441,
          "description": "Create artifacts for each project found in the Wiz issue",
          "enabled": false,
          "export_key": "Create Artifacts from Projects",
          "id": 4,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937743441,
          "name": "Create Artifacts from Projects",
          "object_type": "incident",
          "playbook_handle": "wiz_populate_case",
          "programmatic_name": "wiz_populate_case_create_artifacts_from_projects",
          "script_text": "results = playbook.functions.results.query_issue_results\nif not results.success:\n    incident.addNote(f\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e Unable to get issue data to update custom fields: {results.reason}\")\nelse:\n  projects = results.get(\"content\", {}).get(\"response\", {}).get(\"projects\", [])\n  if projects:\n    for p in projects:\n      incident.addArtifact(\u0027Observed Data\u0027, p.get(\u0027name\u0027) , \u0027Found project in Wiz\u0027)\n    incident.addNote(f\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e Added {len(projects)} projects as artifacts\")\n  else:\n    incident.addNote(\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e No projects found in Wiz to add as artifacts\")\n      ",
          "tags": [],
          "uuid": "939142ef-3610-4d0b-bb91-a4f99d5a37cb"
        },
        {
          "actions": [],
          "created_date": 1731937743495,
          "description": "Populate Projects Data Table with more detailed data on projects related to Wiz Issue",
          "enabled": false,
          "export_key": "Populate Projects Data Table",
          "id": 5,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937743495,
          "name": "Populate Projects Data Table",
          "object_type": "incident",
          "playbook_handle": "wiz_populate_case",
          "programmatic_name": "wiz_populate_case_create_projects_datatable",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.query_issue_results\n\nif not results.success:\n  incident.addNote(f\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e Unable to get issue data to populate projects data table: {results.reason}\")\nelse:\n  projects = results.get(\"content\", {}).get(\"response\", {}).get(\"projects\", [])\n  if projects:\n    for p in projects:\n      row = incident.addRow(\"wiz_projects_table\")\n      row[\"date_added\"] = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n      row[\"project_name\"] = p.get(\u0027name\u0027, \u0027\u0027)\n      row[\"project_id\"] = p.get(\u0027id\u0027, \u0027\u0027)\n      row[\"business_unit\"] = p.get(\u0027businessUnit\u0027, \u0027n/a\u0027)\n    incident.addNote(f\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e Added {len(projects)} projects to Wiz Projects data table\")\n  else:\n    incident.addNote(\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e No projects to add to Projects data table\")",
          "tags": [],
          "uuid": "4c144b81-9d68-44c5-bf71-790481da0f7c"
        },
        {
          "actions": [],
          "created_date": 1731937743544,
          "description": "Post a note to explain why we skipped querying for vulnerabilities in this playbook",
          "enabled": false,
          "export_key": "Post note ",
          "id": 6,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937743544,
          "name": "Post note ",
          "object_type": "incident",
          "playbook_handle": "wiz_populate_case",
          "programmatic_name": "wiz_populate_case_post_note_",
          "script_text": "incident.addNote(\"\u003cb\u003e Wiz: Populate Case:\u003c/b\u003e No projects to for in vulnerabilities query, skipping population of vulnerabilities data table.\")",
          "tags": [],
          "uuid": "a1a25f36-7e48-41ae-88d5-6107a37bd4eb"
        },
        {
          "actions": [],
          "created_date": 1731937743585,
          "description": "Populate Vulnerabilities Data Table containing vulnerability data",
          "enabled": false,
          "export_key": "Wiz: Populate Vulnerabilities Data Table",
          "id": 7,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937743585,
          "name": "Wiz: Populate Vulnerabilities Data Table",
          "object_type": "incident",
          "playbook_handle": "wiz_populate_case",
          "programmatic_name": "wiz_populate_case_vuln_dt",
          "script_text": "from datetime import datetime\n\ndef get_projects(vuln):\n  \"\"\"\n  Get a string of the project names affected by this vulnerability \n  :param vuln (dict): vulnerability object\n  \"\"\"\n  projects = vuln.get(\u0027projects\u0027, [])\n  if projects:\n    project_names = [p.get(\u0027name\u0027) for p in projects]\n    return \", \".join(project_names)\n  \n  return \"-\"\n  \nresults = playbook.functions.results.vulnerability_results\n\nif not results.success:\n    incident.addNote(f\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e Unable to get vulnerability data to update Wiz Vulnerabilities data table: {results.reason}\")\nelse:\n  content = results.get(\u0027content\u0027, {})\n  if content:\n    vulnerabilities = content.get(\u0027response\u0027, [])\n    for vuln in vulnerabilities:\n      row = incident.addRow(\"wiz_vulnerabilities_table\")\n      row[\"date_added\"] = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n      row[\"vulnerability_description\"] = vuln.get(\u0027description\u0027, \u0027\u0027)\n      row[\"vulnerability_name\"] = vuln.get(\u0027name\u0027, \u0027\u0027)\n      row[\"affected_projects\"] = get_projects(vuln)\n      row[\"vendor_severity\"] = vuln.get(\u0027vendorSeverity\u0027, \u0027\u0027)\n      row[\"remediation\"] = vuln.get(\u0027remediation\u0027, \u0027\u0027)\n      row[\"vulnerable_asset_id\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027id\u0027, \u0027\u0027)\n      row[\"vulnerable_asset_type\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027type\u0027, \u0027\u0027)\n      row[\"vulnerable_asset_os\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027operatingSystem\u0027, \u0027\u0027)\n      \n    incident.addNote(f\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e Added {len(vulnerabilities)} vulnerabilities to Wiz Vulnerabilities data table\")\n  else:\n    incident.addNote(\"\u003cb\u003eWiz: Populate Case:\u003c/b\u003e No content found to add to vulnerabilities data table\")\n",
          "tags": [],
          "uuid": "350f11de-1515-4d59-bf9a-de801acb3acc"
        },
        {
          "actions": [],
          "created_date": 1731937743626,
          "description": "",
          "enabled": false,
          "export_key": "Wiz: Write Query Results",
          "id": 8,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937743626,
          "name": "Wiz: Write Query Results",
          "object_type": "incident",
          "playbook_handle": "wiz_populate_case",
          "programmatic_name": "wiz_populate_case_wiz_write_query_results",
          "script_text": "results = playbook.functions.results.query_issue_results\n\nif results and len(results) == 1:\n  # set issue status\n  incident.properties.wiz_issue_status = results.get(\u0027status\u0027, \u0027OPEN\u0027)\n  ",
          "tags": [],
          "uuid": "87f75569-a3d5-4371-894e-2f2a54381256"
        }
      ],
      "name": "wiz_populate_case",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_b36d9eac-9320-4f7f-b5ed-59933aec69b2",
        "id": 6,
        "name": "playbook_b36d9eac_9320_4f7f_b5ed_59933aec69b2",
        "type": "playbook",
        "uuid": "9e9a1e1d-3e24-46ab-89a9-a0ebf5b83f4b"
      },
      "tags": [],
      "type": "default",
      "uuid": "b36d9eac-9320-4f7f-b5ed-59933aec69b2",
      "version": 6
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263\" isExecutable=\"true\" name=\"playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_14p22hp\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Wiz: Pull Vulnerabilities\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"124ecedc-0933-479a-bf9d-5e6f6e3af6d5\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.wiz_query_filter = playbook.inputs.wiz_query_filter.get(\\\"content\\\", None)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"vulnerability_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_14p22hp\u003c/incoming\u003e\u003coutgoing\u003eFlow_0m28nva\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_14p22hp\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_0m28nva\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0ataukx\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"Wiz: Populate Vulnerabilities Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"6f84e0b4-9b62-4ab8-b461-e755877137ea\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0m28nva\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ataukx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0ataukx\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ataukx\" id=\"Flow_0ataukx_di\"\u003e\u003comgdi:waypoint x=\"810\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"810\" y=\"553\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0m28nva\" id=\"Flow_0m28nva_di\"\u003e\u003comgdi:waypoint x=\"810\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"810\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14p22hp\" id=\"Flow_14p22hp_di\"\u003e\u003comgdi:waypoint x=\"810\" y=\"186\"/\u003e\u003comgdi:waypoint x=\"810\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"716\" y=\"134\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"712\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"743.75\" y=\"553.25\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"711.5\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1731937745081,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263",
      "description": {
        "content": "Query for vulnerabilities based on provided variables filter that gets passed to Wiz query.",
        "format": "text"
      },
      "display_name": "Wiz: Pull Vulnerabilities",
      "export_key": "wiz_pull_vulnerabilities",
      "field_type_handle": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263",
      "fields_type": {
        "actions": [],
        "display_name": "Wiz: Pull Vulnerabilities",
        "export_key": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263",
        "fields": {
          "wiz_query_filter": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263/wiz_query_filter",
            "hide_notification": false,
            "id": 383,
            "input_type": "textarea",
            "internal": false,
            "is_tracked": false,
            "name": "wiz_query_filter",
            "operation_perms": {},
            "operations": [],
            "placeholder": "{ \"first\": 5, \"filterBy\": { \"vendorSeverity\": [ \"CRITICAL\" ] } }",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Wiz Query Filter",
            "tooltip": "Dictionary that represents \u0027variables\u0027 object that gets passed with the Wiz query to filter results. Required \u0027first\u0027 parameter.",
            "type_id": 1005,
            "uuid": "4c42407c-1eb4-4fc5-8188-30c9d2f5b09c",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263",
        "uuid": "18b70b81-0308-4380-85d3-e15ee8b77bf9"
      },
      "has_logical_errors": false,
      "id": 4,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1732049537023,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1731937745294,
          "description": "Add rows from vulnerabilities query to data table",
          "enabled": false,
          "export_key": "Wiz: Populate Vulnerabilities Data Table",
          "id": 9,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937745294,
          "name": "Wiz: Populate Vulnerabilities Data Table",
          "object_type": "incident",
          "playbook_handle": "wiz_pull_vulnerabilities",
          "programmatic_name": "wiz_pull_vulnerabilities_data_table",
          "script_text": "from datetime import datetime\n\ndef get_projects(vuln):\n  \"\"\"\n  Get a string of the project names affected by this vulnerability \n  :param vuln (dict): vulnerability object\n  \"\"\"\n  projects = vuln.get(\u0027projects\u0027, [])\n  if projects:\n    project_names = [p.get(\u0027name\u0027) for p in projects]\n    return \", \".join(project_names)\n  \n  return \"-\"\n  \nresults = playbook.functions.results.vulnerability_results\n\nif not results.success:\n    incident.addNote(f\"\u003cb\u003eWiz: Pull Vulnerabilities:\u003c/b\u003e Unable to get vulnerability data to update Wiz Vulnerabilities data table: {results.reason}\")\nelse:\n  content = results.get(\u0027content\u0027, {})\n  if content:\n    vulnerabilities = content.get(\u0027response\u0027, [])\n    for vuln in vulnerabilities:\n      row = incident.addRow(\"wiz_vulnerabilities_table\")\n      row[\"date_added\"] = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n      row[\"vulnerability_description\"] = vuln.get(\u0027description\u0027, \u0027\u0027)\n      row[\"vulnerability_name\"] = vuln.get(\u0027name\u0027, \u0027\u0027)\n      row[\"affected_projects\"] = get_projects(vuln)\n      row[\"vendor_severity\"] = vuln.get(\u0027vendorSeverity\u0027, \u0027\u0027)\n      row[\"remediation\"] = vuln.get(\u0027remediation\u0027, \u0027\u0027)\n      row[\"vulnerable_asset_id\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027id\u0027, \u0027\u0027)\n      row[\"vulnerable_asset_type\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027type\u0027, \u0027\u0027)\n      row[\"vulnerable_asset_os\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027operatingSystem\u0027, \u0027\u0027)\n    \n    if playbook.inputs.wiz_query_filter:\n      incident.addNote(f\"\u003cb\u003eWiz: Pull Vulnerabilities:\u003c/b\u003e Added {len(vulnerabilities)} vulnerabilities to Wiz Vulnerabilities data table with filter {playbook.inputs.wiz_query_filter}\")\n    else:\n      incident.addNote(f\"\u003cb\u003eWiz: Pull Vulnerabilities:\u003c/b\u003e Added {len(vulnerabilities)} vulnerabilities to Wiz Vulnerabilities data table with default filter\")\n  else:\n    incident.addNote(\"\u003cb\u003eWiz: Pull Vulnerabilities:\u003c/b\u003e No content found to add to vulnerabilities data table\")\n",
          "tags": [],
          "uuid": "6f84e0b4-9b62-4ab8-b461-e755877137ea"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.wiz_issue_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "4c42407c-1eb4-4fc5-8188-30c9d2f5b09c",
            "element": "field_uuid",
            "field_type": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "wiz_pull_vulnerabilities",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_fe76b6f2-0873-4248-8c25-b36d00f4a263",
        "id": 7,
        "name": "playbook_fe76b6f2_0873_4248_8c25_b36d00f4a263",
        "type": "playbook",
        "uuid": "af704fae-aa28-459a-97b7-76236162d683"
      },
      "tags": [],
      "type": "default",
      "uuid": "fe76b6f2-0873-4248-8c25-b36d00f4a263",
      "version": 6
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_1664264e_748a_4611_8362_cab9471c7c70\" isExecutable=\"true\" name=\"playbook_1664264e_748a_4611_8362_cab9471c7c70\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0gdcw1n\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Wiz: Pull Vulnerabilities\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"124ecedc-0933-479a-bf9d-5e6f6e3af6d5\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Get id for this specific project in the data table row\\ninputs.wiz_project_ids = row.project_id\\n\\n# OPTIONAL: Specify the maximum desired number of results, returns max of 50 results by default\\n# inputs.wiz_num_results = \",\"pre_processing_script_language\":\"python3\",\"result_name\":\"vulnerability_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0gdcw1n\u003c/incoming\u003e\u003coutgoing\u003eFlow_1u5mk0u\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0gdcw1n\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_1u5mk0u\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_5\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0h97st4\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"Wiz: Populate Vulnerabilities Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"593ac12d-f61a-434b-a75f-85de69cbcd38\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1u5mk0u\u003c/incoming\u003e\u003coutgoing\u003eFlow_0h97st4\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0h97st4\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_1664264e_748a_4611_8362_cab9471c7c70\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0h97st4\" id=\"Flow_0h97st4_di\"\u003e\u003comgdi:waypoint x=\"704\" y=\"155\"/\u003e\u003comgdi:waypoint x=\"704\" y=\"224\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1u5mk0u\" id=\"Flow_1u5mk0u_di\"\u003e\u003comgdi:waypoint x=\"703\" y=\"2\"/\u003e\u003comgdi:waypoint x=\"703\" y=\"71\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0gdcw1n\" id=\"Flow_0gdcw1n_di\"\u003e\u003comgdi:waypoint x=\"703\" y=\"-154\"/\u003e\u003comgdi:waypoint x=\"703\" y=\"-82\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"612\" y=\"-206\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"605\" y=\"-82\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"637\" y=\"224\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"604.825\" y=\"70.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1731937746422,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_1664264e_748a_4611_8362_cab9471c7c70",
      "description": {
        "content": "Pull vulnerabilities associated with a given project ID and add to vulnerabilities data table. Queries project vulnerabilities for those with \"HIGH\" and \"CRITICAL\" Vendor Severity scores that are also \"OPEN\".",
        "format": "text"
      },
      "display_name": "Wiz: Pull Vulnerabilities by Project",
      "export_key": "wiz_pull_vulnerabilities_by_project",
      "field_type_handle": "playbook_1664264e_748a_4611_8362_cab9471c7c70",
      "fields_type": {
        "actions": [],
        "display_name": "Wiz: Pull Vulnerabilities by Project",
        "export_key": "playbook_1664264e_748a_4611_8362_cab9471c7c70",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_1664264e_748a_4611_8362_cab9471c7c70",
        "uuid": "c9170e8c-095b-4b95-ba73-8f7465ae3bdf"
      },
      "has_logical_errors": false,
      "id": 5,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1732049537681,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1731937746539,
          "description": "Add rows to Vulnerabilities Data table based n results from Wiz query",
          "enabled": false,
          "export_key": "Wiz: Populate Vulnerabilities Data Table",
          "id": 10,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937746539,
          "name": "Wiz: Populate Vulnerabilities Data Table",
          "object_type": "wiz_projects_table",
          "playbook_handle": "wiz_pull_vulnerabilities_by_project",
          "programmatic_name": "wiz_pull_vulnerabilities_by_project_wiz_populate_vulnerabilities_data_table",
          "script_text": "from datetime import datetime\n\ndef get_projects(vuln):\n  \"\"\"\n  Get a string of the project names affected by this vulnerability \n  :param vuln (dict): vulnerability object\n  \"\"\"\n  projects = vuln.get(\u0027projects\u0027, [])\n  if projects:\n    project_names = [p.get(\u0027name\u0027) for p in projects]\n    return \", \".join(project_names)\n  \n  return \"-\"\n  \nresults = playbook.functions.results.vulnerability_results\n\nif not results.success:\n    incident.addNote(f\"\u003cb\u003eWiz: Pull Vulnerabilities by Project ID:\u003c/b\u003e Unable to get vulnerability data to update Wiz Vulnerabilities data table: {results.reason}\")\nelse:\n  content = results.get(\u0027content\u0027, {})\n  if content:\n    vulnerabilities = content.get(\u0027response\u0027, [])\n    for vuln in vulnerabilities:\n      vuln_row = incident.addRow(\"wiz_vulnerabilities_table\")\n      vuln_row[\"date_added\"] = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n      vuln_row[\"vulnerability_description\"] = vuln.get(\u0027description\u0027, \u0027\u0027)\n      vuln_row[\"vulnerability_name\"] = vuln.get(\u0027name\u0027, \u0027\u0027)\n      vuln_row[\"affected_projects\"] = get_projects(vuln)\n      vuln_row[\"vendor_severity\"] = vuln.get(\u0027vendorSeverity\u0027, \u0027\u0027)\n      vuln_row[\"remediation\"] = vuln.get(\u0027remediation\u0027, \u0027\u0027)\n      vuln_row[\"vulnerable_asset_id\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027id\u0027, \u0027\u0027)\n      vuln_row[\"vulnerable_asset_type\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027type\u0027, \u0027\u0027)\n      vuln_row[\"vulnerable_asset_os\"] = vuln.get(\u0027vulnerableAsset\u0027, {}).get(\u0027operatingSystem\u0027, \u0027\u0027)\n      \n    incident.addNote(f\"\u003cb\u003eWiz: Pull Vulnerabilities by Project ID:\u003c/b\u003e Added {len(vulnerabilities)} vulnerabilities to Wiz Vulnerabilities data table for project with ID {row.project_id}\")\n  else:\n    incident.addNote(\"\u003cb\u003eWiz: Pull Vulnerabilities by Project ID:\u003c/b\u003e No content found to add to vulnerabilities data table\")\n",
          "tags": [],
          "uuid": "593ac12d-f61a-434b-a75f-85de69cbcd38"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "wiz_pull_vulnerabilities_by_project",
      "object_type": "wiz_projects_table",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_1664264e-748a-4611-8362-cab9471c7c70",
        "id": 8,
        "name": "playbook_1664264e_748a_4611_8362_cab9471c7c70",
        "type": "playbook",
        "uuid": "8798414d-4adb-41b0-aea7-4ce69102007c"
      },
      "tags": [],
      "type": "default",
      "uuid": "1664264e-748a-4611-8362-cab9471c7c70",
      "version": 6
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.wiz_issue_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Wiz: "
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357\" isExecutable=\"true\" name=\"playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_06747tx\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Wiz: Send SOAR Notes\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"ddf384b4-3436-4f45-95e3-228d55fb7637\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.wiz_issue_id = incident.properties.wiz_issue_id\\ninputs.wiz_soar_note = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"notes_result\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_06747tx\u003c/incoming\u003e\u003coutgoing\u003eFlow_0dumywe\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_06747tx\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_05er5e3\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0dumywe\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Add failure note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"5ddddb97-27e5-46f8-82de-1fd5d51bcf01\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0dumywe\u003c/incoming\u003e\u003coutgoing\u003eFlow_05er5e3\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_05er5e3\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_05er5e3\" id=\"Flow_05er5e3_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-158\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-116\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0dumywe\" id=\"Flow_0dumywe_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-278\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-242\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_06747tx\" id=\"Flow_06747tx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-404\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-362\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"-456\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.783\" y=\"-361.8500061035156\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"-116\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"-242.14999389648438\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1731937747518,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357",
      "description": {
        "content": "Add notes from SOAR Case to Wiz Issue",
        "format": "text"
      },
      "display_name": "Wiz: Sync Notes to Issue",
      "export_key": "wiz_sync_notes_to_issue",
      "field_type_handle": "playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357",
      "fields_type": {
        "actions": [],
        "display_name": "Wiz: Sync Notes to Issue",
        "export_key": "playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357",
        "uuid": "fc4aa2e6-d4f9-4ee5-8e5d-047c0df869e6"
      },
      "has_logical_errors": false,
      "id": 6,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1732049538396,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1731937747650,
          "description": "Add note to incident if syncing notes failed",
          "enabled": false,
          "export_key": "Add failure note",
          "id": 11,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937747650,
          "name": "Add failure note",
          "object_type": "note",
          "playbook_handle": "wiz_sync_notes_to_issue",
          "programmatic_name": "wiz_sync_notes_to_issue_add_failure_note",
          "script_text": "results = playbook.functions.results.notes_result\n\nif not results.success:\n  incident.addNote(f\"\u003cb\u003eWiz: Sync Notes to Issue:\u003c/b\u003e Failed to add note to Wiz issue: {results.reason}\")",
          "tags": [],
          "uuid": "5ddddb97-27e5-46f8-82de-1fd5d51bcf01"
        }
      ],
      "name": "wiz_sync_notes_to_issue",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_5721b7e7-b324-411c-b79b-2bb58cb3f357",
        "id": 9,
        "name": "playbook_5721b7e7_b324_411c_b79b_2bb58cb3f357",
        "type": "playbook",
        "uuid": "39f9f800-b7e3-4bc6-8911-1f4e3e8a3c5e"
      },
      "tags": [],
      "type": "default",
      "uuid": "5721b7e7-b324-411c-b79b-2bb58cb3f357",
      "version": 6
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "changed_to",
              "type": null,
              "value": "Closed"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.wiz_issue_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_summary",
              "method": "not_contains",
              "type": null,
              "value": "Closed by Wiz:"
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa\" isExecutable=\"true\" name=\"playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0b4mhce\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Wiz: Sync Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fa25185e-8150-487d-b070-688992b78c8e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.wiz_issue_id = incident.properties.wiz_issue_id\\ninputs.wiz_resolution_reason = incident.resolution_id\\ninputs.wiz_resolution_summary = incident.resolution_summary.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"status_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0b4mhce\u003c/incoming\u003e\u003coutgoing\u003eFlow_02gumnb\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0b4mhce\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_14cev3i\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_02gumnb\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Add note with results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"39805b12-c8ae-49df-a5a5-305b9058aa74\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02gumnb\u003c/incoming\u003e\u003coutgoing\u003eFlow_14cev3i\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_14cev3i\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14cev3i\" id=\"Flow_14cev3i_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"132\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"204\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02gumnb\" id=\"Flow_02gumnb_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-28\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"48\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0b4mhce\" id=\"Flow_0b4mhce_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-184\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-112\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"-236\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.042\" y=\"-112\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655.292\" y=\"203.75\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.292\" y=\"47.75\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1731937748411,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa",
      "description": {
        "content": "Update Wiz issue status if case status changes",
        "format": "text"
      },
      "display_name": "Wiz: Sync Status",
      "export_key": "wiz_sync_status",
      "field_type_handle": "playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa",
      "fields_type": {
        "actions": [],
        "display_name": "Wiz: Sync Status",
        "export_key": "playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa",
        "uuid": "eaa5f0b6-031c-43d4-9166-10f19226a38e"
      },
      "has_logical_errors": false,
      "id": 7,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 3,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1732049538859,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1731937748528,
          "description": "Add a note to SOAR case to indicate success or failure in updating Wiz issue",
          "enabled": false,
          "export_key": "Add note with results",
          "id": 12,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1731937748528,
          "name": "Add note with results",
          "object_type": "incident",
          "playbook_handle": "wiz_sync_status",
          "programmatic_name": "wiz_sync_status_add_note",
          "script_text": "results = playbook.functions.results.status_results\nif not results.success:\n  incident.addNote(f\"\u003cb\u003eWiz: Sync Status:\u003c/b\u003e Unable to sync issue status: {results.reason}\")\nelse:\n  content = results.get(\u0027content\u0027, {})\n  if content:\n    issue = content.get(\u0027response\u0027, None)\n    if issue:\n      new_status = \"REJECTED\"\n      incident.properties.wiz_issue_status = new_status\n      incident.addNote(f\"\u003cb\u003eWiz: Sync Status:\u003c/b\u003e Successfully closed Wiz issue with status {new_status}\")\n    else:\n      incident.addNote(\"\u003cb\u003eWiz: Sync Status:\u003c/b\u003e Unable to sync issue status because Wiz Issue not found\")",
          "tags": [],
          "uuid": "39805b12-c8ae-49df-a5a5-305b9058aa74"
        }
      ],
      "name": "wiz_sync_status",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_b61b27f8-e7cb-4b60-b9b9-9eebc88282aa",
        "id": 10,
        "name": "playbook_b61b27f8_e7cb_4b60_b9b9_9eebc88282aa",
        "type": "playbook",
        "uuid": "8ed45449-9154-4a9c-84a4-8da79c59a158"
      },
      "tags": [],
      "type": "default",
      "uuid": "b61b27f8-e7cb-4b60-b9b9-9eebc88282aa",
      "version": 6
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 9339,
    "f": 0,
    "m": 0,
    "major": 0,
    "minor": 0,
    "r": 0,
    "v": 51,
    "version": "51.0.0.0.9339"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "Wiz Projects Table",
      "export_key": "wiz_projects_table",
      "fields": {
        "business_unit": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_projects_table/business_unit",
          "hide_notification": false,
          "id": 363,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "business_unit",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Business Unit",
          "tooltip": "Business unit related to project",
          "type_id": 1002,
          "uuid": "64e39948-eb74-4cfb-b1bd-187fd681593c",
          "values": [],
          "width": 136
        },
        "date_added": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_projects_table/date_added",
          "hide_notification": false,
          "id": 364,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "date_added",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Date Added",
          "tooltip": "Timestamp of date when row was added to data table",
          "type_id": 1002,
          "uuid": "c39d2e9b-70e6-4969-a0af-488c82038689",
          "values": [],
          "width": 191
        },
        "project_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_projects_table/project_id",
          "hide_notification": false,
          "id": 365,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "project_id",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "required": "always",
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Project ID",
          "tooltip": "ID hash of a project",
          "type_id": 1002,
          "uuid": "3cec2b2d-a6c5-43ce-9fb0-3fd0d9ee3747",
          "values": [],
          "width": 285
        },
        "project_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_projects_table/project_name",
          "hide_notification": false,
          "id": 366,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "project_name",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "required": "always",
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Project Name",
          "tooltip": "Name of project",
          "type_id": 1002,
          "uuid": "994c6f89-0295-4e1e-9438-173b0dac6ebf",
          "values": [],
          "width": 147
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "wiz_projects_table",
      "uuid": "32862c81-f680-4ae1-b2b8-9455fd2fdbc2"
    },
    {
      "actions": [],
      "display_name": "Wiz Vulnerabilities Table",
      "export_key": "wiz_vulnerabilities_table",
      "fields": {
        "affected_projects": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/affected_projects",
          "hide_notification": false,
          "id": 367,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "affected_projects",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Affected Projects",
          "tooltip": "Project names where vulnerability has been identified",
          "type_id": 1003,
          "uuid": "eed2a314-d99c-482b-8c12-5ddc2e95d059",
          "values": [],
          "width": 154
        },
        "date_added": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/date_added",
          "hide_notification": false,
          "id": 368,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "date_added",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Date Added",
          "tooltip": "Timestamp that the row was added to the data table",
          "type_id": 1003,
          "uuid": "7817051b-a312-4f4f-8a54-d92503bfd12b",
          "values": [],
          "width": 198
        },
        "remediation": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/remediation",
          "hide_notification": false,
          "id": 369,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "remediation",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Remediation",
          "tooltip": "Suggested remediation by Wiz",
          "type_id": 1003,
          "uuid": "87cd7117-9242-41ea-a80e-19b1a9590f48",
          "values": [],
          "width": 180
        },
        "vendor_severity": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/vendor_severity",
          "hide_notification": false,
          "id": 370,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "vendor_severity",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Vendor Severity",
          "tooltip": "Vendor Severity Score",
          "type_id": 1003,
          "uuid": "d6954a60-3ea1-4630-b34f-33b78a064a02",
          "values": [],
          "width": 143
        },
        "vulnerability_description": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/vulnerability_description",
          "hide_notification": false,
          "id": 371,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "vulnerability_description",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Vulnerability Description",
          "tooltip": "Description of identified vulnerability",
          "type_id": 1003,
          "uuid": "83efafbd-6f17-490a-b957-5986d93281e1",
          "values": [],
          "width": 350
        },
        "vulnerability_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/vulnerability_name",
          "hide_notification": false,
          "id": 372,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "vulnerability_name",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Vulnerability Name",
          "tooltip": "Name of identified vulnerability",
          "type_id": 1003,
          "uuid": "fd8d3985-76d1-4d45-a37f-a739735750d0",
          "values": [],
          "width": 169
        },
        "vulnerable_asset_id": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/vulnerable_asset_id",
          "hide_notification": false,
          "id": 373,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "vulnerable_asset_id",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Vulnerable Asset ID",
          "tooltip": "Vulnerable asset affected by vulnerability",
          "type_id": 1003,
          "uuid": "de31fceb-0a9a-413a-8b01-9b77ae6b0d34",
          "values": [],
          "width": 240
        },
        "vulnerable_asset_os": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/vulnerable_asset_os",
          "hide_notification": false,
          "id": 374,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "vulnerable_asset_os",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Vulnerable Asset Operating System",
          "tooltip": "Operating system of asset affected by vulnerability",
          "type_id": 1003,
          "uuid": "70751988-f600-4647-b010-b986c756d70a",
          "values": [],
          "width": 292
        },
        "vulnerable_asset_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "wiz_vulnerabilities_table/vulnerable_asset_type",
          "hide_notification": false,
          "id": 375,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "vulnerable_asset_type",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Vulnerable Asset Type",
          "tooltip": "Type of asset affected by vulnerability",
          "type_id": 1003,
          "uuid": "dcc5b9f8-0a27-4c12-a090-fff97259f2aa",
          "values": [],
          "width": 193
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "wiz_vulnerabilities_table",
      "uuid": "2ccf0a7b-fd62-4441-a7ff-b2bd07227b6d"
    }
  ],
  "workflows": [],
  "workspaces": []
}
