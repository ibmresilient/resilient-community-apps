<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Yeti Observables Query

## Function - Yeti

### API Name
`fn_yeti`

### Output Name
`None`

### Message Destination
`yeti`

### Pre-Processing Script
```python
inputs.yeti_artifact_type = artifact.type
inputs.yeti_artifact_value = artifact.value
```

### Post-Processing Script
```python
if results.success:
  if results.content:
    resp = results.content
    hit = []

    tags = ""
    for tag in resp[0]["tags"]:
        if tags != "":
            tags += ", "
        tags += tag["name"]
    
    descript = resp[0]["description"] if resp[0]["description"] else "None"
    hit = [
        {
          "name": "Type",
          "type": "string",
          "value": "{}".format(resp[0]["type"])
        }, 
        {
          "name": "Value",
          "type": "string",
          "value": "{}".format(resp[0]["value"])
        }, 
        {
          "name": "Tags",
          "type": "string",
          "value": "{}".format(tags)
        },
        {
          "name": "Created",
          "type": "string",
          "value": "{}".format(resp[0]["created"])
        },
        {
          "name": "URL",
          "type": "uri",
          "value": "{}".format(resp[0]["human_url"])
        },
        {
          "name": "Description",
          "type": "string",
          "value": "{}".format(descript)
        }
        ]
    artifact.addHit("Yeti Function hits added", hit)
else:
  incident.addNote("Yeti query failed: {}".format(results.reason))
  
```

---

