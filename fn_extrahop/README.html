<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="Google Geocoding" href="../fn_geocoding/README.html" /><link rel="prev" title="Microsoft Exchange Online" href="../fn_exchange_online/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>ExtraHop - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=11eca18f" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pb_sans_isc_scan_ip/README.html">ISC SANS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feed ODBCFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">Alien Vault OTX Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">Anomali Staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">Amazon AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco AMP for Endpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">Component Files for App Host</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">ExtraHop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing Threat Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">SOAR LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">About MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html#remote-windows-commands">Remote Windows commands:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">PhishTank Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint Targeted Attack Protection (TAP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint Threat Response Auto-Pull</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR (formally IBM ReaQta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">Remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio Send SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watson_translate/README.html">Watson Translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk HTTP Event Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <!--
  This README.md is generated by running:
  "resilient-sdk docgen -p fn_extrahop"

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  All fields followed by "::CHANGE_ME::"" should be manually edited

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)

  NOTE: If your app is available in the container-format only, there is no need to mention the integration server in this readme.
-->
<section id="extrahop">
<h1>ExtraHop<a class="headerlink" href="#extrahop" title="Link to this heading">#</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
<li><p><a class="reference internal" href="#endpoint-developed-with"><span class="xref myst">Endpoint Developed With</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#poller---extrahop-escalate-detections"><span class="xref myst">Poller - ExtraHop Escalate Detections</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-add-detection-note"><span class="xref myst">Function - Extrahop Reveal(x) add detection note</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-assign-tag"><span class="xref myst">Function - Extrahop Reveal(x) assign tag</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-create-tag"><span class="xref myst">Function - Extrahop Reveal(x) create tag</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-get-activitymaps"><span class="xref myst">Function - Extrahop Reveal(x) get activitymaps</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-get-detection-note"><span class="xref myst">Function - Extrahop Reveal(x) get detection note</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-get-detections"><span class="xref myst">Function - Extrahop Reveal(x) get detections</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-get-devices"><span class="xref myst">Function - Extrahop Reveal(x) get devices</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-get-tags"><span class="xref myst">Function - Extrahop Reveal(x) get tags</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-get-watchlist"><span class="xref myst">Function - Extrahop Reveal(x) get watchlist</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-search-detections"><span class="xref myst">Function - Extrahop Reveal(x) search detections</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-search-devices"><span class="xref myst">Function - Extrahop Reveal(x) search devices</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-search-packets"><span class="xref myst">Function - Extrahop Reveal(x) search packets</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-update-detection"><span class="xref myst">Function - Extrahop Reveal(x) update detection</span></a></p></li>
<li><p><a class="reference internal" href="#function---extrahop-revealx-update-watchlist"><span class="xref myst">Function - Extrahop Reveal(x) update watchlist</span></a></p></li>
<li><p><a class="reference internal" href="#script---extrahop-script-add-artifact-from-device"><span class="xref myst">Script - ExtraHop script: add artifact from device</span></a></p></li>
<li><p><a class="reference internal" href="#script---extrahop-script-detection-property-helper"><span class="xref myst">Script - ExtraHop script: detection property helper</span></a></p></li>
<li><p><a class="reference internal" href="#script---extrahop-script-device-property-helper"><span class="xref myst">Script - ExtraHop script: device property helper</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---extrahop-activitymaps"><span class="xref myst">Data Table - ExtraHop Activitymaps</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---extrahop-detections"><span class="xref myst">Data Table - Extrahop Detections</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---extrahop-devices"><span class="xref myst">Data Table - ExtraHop Devices</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---extrahop-tags"><span class="xref myst">Data Table - Extrahop Tags</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---extrahop-watchlist"><span class="xref myst">Data Table - ExtraHop Watchlist</span></a></p></li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#rules"><span class="xref myst">Rules</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">#</a></h2>
<!--
  Specify all changes in this release. Do not remove the release
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.1.0</p></td>
<td><p>04/2023</p></td>
<td><p>Use mod_time instead of update_time in poller. Convert rules/workflows to playbooks</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.0</p></td>
<td><p>06/2022</p></td>
<td><p>Initial Release</p></td>
</tr>
</tbody>
</table>
</div>
<section id="changes">
<h3>1.1 Changes<a class="headerlink" href="#changes" title="Link to this heading">#</a></h3>
<p>In v1.1, the existing rules and workflows have been replaced with playbooks.
This change is made to support the ongoing, newer capabilities of playbooks.
Each playbook has the same functionality as the previous, corresponding rule/workflow.</p>
<p>If upgrading from a previous release, notice that the previous release’s rules/workflows remain in place. Both sets of rules and playbooks are active. For manual actions, playbooks will have the same name as it’s corresponding rule, but with “(PB)” added at the end.</p>
<p>You can continue to use the rules/workflows.
But migrating to playbooks will provide greater functionality along with future app enhancements and bug fixes.</p>
<p><strong>NOTE</strong> Starting with version 1.1.0 of the ExtraHop app for SOAR:</p>
<ul class="simple">
<li><p>The poller uses ExtraHop detection <code class="docutils literal notranslate"><span class="pre">mod_time</span></code> field to determine which detections to pull in to SOAR.</p></li>
<li><p>The poller includes an optional <code class="docutils literal notranslate"><span class="pre">polling_lookback</span></code> parameter in the app.config that can be used to look back the specified number of minutes when the poller starts or restarts to pull in “older” detections.  If not specified in the app.config, the poller uses a look back of zero minutes.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x)</span> <span class="pre">search</span> <span class="pre">detections</span></code> takes an optional <code class="docutils literal notranslate"><span class="pre">mod_time</span></code> parameter used for searching detections in ExtraHop.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<!--
  Provide a high-level description of the function itself and its remote software or application.
  The text below is parsed from the "description" and "long_description" attributes in the setup.py file
-->
<p><strong>IBM Security SOAR app for ExtraHop</strong></p>
<p><img alt="screenshot: main" src="../_images/main13.png" /></p>
<p>ExtraHop is a cybersecurity cloud-native solution that provides AI-based network intelligence to help enterprises detect and respond to advanced threats.</p>
<p>The ExtraHop App for IBM SOAR escalates ExtraHop detections into IBM Security SOAR as an incident/case and facilitates manual enrichment and remediation actions against an ExtraHop RevealX 360 environment in the IBM SOAR Platform.</p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">#</a></h3>
<!--
  List the Key Features of the Integration
-->
<p>The ExtraHop App provides the following functionality:</p>
<ul class="simple">
<li><p>A poller which gathers current detections from ExtraHop and escalates to the SOAR platform as cases/incidents.</p></li>
<li><p>Functions to get, search and update detections.</p></li>
<li><p>Functions to get and add detection notes.</p></li>
<li><p>Functions to get and search devices.</p></li>
<li><p>Functions to get, create and assign tags.</p></li>
<li><p>Functions get and set the watchlist.</p></li>
<li><p>A function to get activitymaps.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">#</a></h2>
<!--
  List any Requirements
-->
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">#</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, App Host and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">45.0.0</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">45.0.0</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient-circuits&gt;=42.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>incident</p></td>
<td><p>Create</p></td>
</tr>
<tr class="row-odd"><td><p>all_incidents</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>all_incidents_fields</p></td>
<td><p>Edit</p></td>
</tr>
<tr class="row-odd"><td><p>layouts</p></td>
<td><p>Read, Edit</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>App Host Deployment Guide</em> or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">#</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= 1.4.</p></li>
<li><p>Cloud Pak is configured with an App Host.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">#</a></h3>
<p>The app <strong>does</strong> support a proxy server via the https_proxy and http_proxy app.config settings.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">#</a></h3>
<p>Both Python 3.6 and Python 3.9 are supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>resilient-circuits&gt;=48.0.0</p></li>
<li><p>retry2 ~= 0.9</p></li>
</ul>
</section>
<section id="endpoint-developed-with">
<h3>Endpoint Developed With<a class="headerlink" href="#endpoint-developed-with" title="Link to this heading">#</a></h3>
<p>This app has been implemented using:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Product Name</p></th>
<th class="head"><p>Product Version</p></th>
<th class="head"><p>API URL</p></th>
<th class="head"><p>API Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ExtraHop RevealX 360</p></td>
<td><p>9.2.01526</p></td>
<td><p>https://&lt;extrahop_cloud_api_url&gt; or https://&lt;sensor_hostname_or_ip&gt;</p></td>
<td><p>v1</p></td>
</tr>
</tbody>
</table>
</div>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h4>
<!--
List any prerequisites that are needed to use with this endpoint solution. Remove any section that is unnecessary.
-->
<ul class="simple">
<li><p>An ExtraHop discover appliance/sensor must be deployed in the users environment.</p></li>
<li><p>The app user must have a user account on the ExtraHop standalone discover appliance or Cloud Services instance with REST API access enabled.</p></li>
<li><p>If the user wants to use the <code class="docutils literal notranslate"><span class="pre">Function</span> <span class="pre">-</span> <span class="pre">Extrahop</span> <span class="pre">Reveal(x)</span> <span class="pre">search</span> <span class="pre">packets</span></code> function a trace appliance must be deployed in the users environment.</p></li>
<li><p>ExtraHop detection tracking enables a user to connect ExtraHop detections back to SOAR incidents.</p></li>
</ul>
<p>For deployments see: <a class="reference external" href="https://docs.extrahop.com/current/deploy/#revealx-systems">ExtraHop Deployment</a></p>
<p>For ticket tracking See: <a class="reference external" href="https://docs.extrahop.com/current/detections-configure-ticket-tracking/">Ticket Tracking</a></p>
<p><strong><em>NOTE:</em></strong> If the user environment is in AWS, a Reveal(x) Ultra sensor can be deployed which is a combination of a discover appliance and a trace appliance.</p>
<p><strong><em>NOTE:</em></strong> If detection tracking is enabled on ExtraHop the app functions to get and add detection notes will not complete.</p>
</section>
<section id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h4>
<!--
List any steps that are needed to configure the endpoint to use this app.
-->
<section id="extrahop-standalone-sensor">
<h5>ExtraHop standalone sensor<a class="headerlink" href="#extrahop-standalone-sensor" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>The ExtraHop system must be configured to allow API key generation for the user.</p></li>
<li><p>A valid API key must be generated for the ExtraHop app user.</p></li>
</ul>
</section>
<section id="extrahop-cloud-services">
<h5>ExtraHop Cloud Services<a class="headerlink" href="#extrahop-cloud-services" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p>REST API access must be enabled for the user.</p></li>
<li><p>Create REST API credentials (key ID and key secret token) for the ExtraHop app user.</p></li>
</ul>
<p>See: <a class="reference external" href="https://docs.extrahop.com/current/rx360-rest-api/">Cloud Service api setup</a></p>
</section>
</section>
<section id="permission">
<h4>Permission<a class="headerlink" href="#permission" title="Link to this heading">#</a></h4>
<!--
List any user permissions that are needed to use this endpoint. For example, list the API key permissions.
-->
<ul class="simple">
<li><p>REST API access must be enabled for the account that IBM SOAR is communicating with as specified in the App configration file.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">#</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>extrahop_rx_host_url</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://&lt;extrahop-hostname-or-IP-api-address&gt;</span></code></p></td>
<td><p><em>Cloud api service url or sensor url.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>extrahop_rx_api_version</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">v1</span></code></p></td>
<td><p><em>Version of (API) access to ExtraHop.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>extrahop_rx_cloud_console_url</strong></p></td>
<td class="text-center"><p>*Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://&lt;extrahop-hostname-or-IP-console-address&gt;</span></code></p></td>
<td><p><em>Cloud service console url for cloud-based ExtraHop instance.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>extrahop_rx_key_id</strong></p></td>
<td class="text-center"><p>*Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1ab2ef34gh56ijklm012n3abc4</span></code></p></td>
<td><p><em>Key ID setting if ExtraHop cloud instance used by the integration.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>extrahop_rx_key_secret</strong></p></td>
<td class="text-center"><p>*Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ab2ef34gh56ijklm012n3abc41ab2ef34gh56ijklm012n3abc4</span></code></p></td>
<td><p><em>Key secret setting if ExtraHop cloud instance used by the integration.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>extrahop_rx_api_key</strong></p></td>
<td class="text-center"><p>*Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ab2ef34GH56ijkLM012n3abc41ab2ef34GH56ijklm4</span></code></p></td>
<td><p><em>API key setting if standalone sensor used by the integration.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_interval</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60</span></code></p></td>
<td><p><em>Interval to wait between polls of ExtraHop for detections.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_lookback</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">120</span></code></p></td>
<td><p><em>Number of <strong>minutes</strong> to look back for new ExtraHop detections the first time the app starts or restarts.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_filters</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">polling_filters=&quot;risk_score_min&quot;:</span> <span class="pre">80,</span> <span class="pre">&quot;category&quot;:</span> <span class="pre">[&quot;sec.exploit&quot;],</span> <span class="pre">&quot;types&quot;:</span> <span class="pre">[&quot;interactive_traffic_ssh&quot;,</span> <span class="pre">&quot;interactive_traffic_shell&quot;],</span>&#160; <span class="pre">&quot;status&quot;:</span> <span class="pre">[&quot;.none&quot;,</span> <span class="pre">&quot;new&quot;,</span> <span class="pre">&quot;in_progress&quot;,</span> <span class="pre">&quot;acknowledged&quot;],</span> <span class="pre">&quot;resolution&quot;:</span> <span class="pre">[&quot;.none&quot;</span> <span class="pre">]</span></code></p></td>
<td><p><em>Filter detection results returned to SOAR using key/value pairs.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>extrahop_cafile</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">cert</span> <span class="pre">file&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p><em>TLS certificate setting. Can be a path to a CA bundle or ‘false’</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>https_proxy</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://proxy:443</span></code> or <code class="docutils literal notranslate"><span class="pre">proxy:443</span></code></p></td>
<td><p><em>Optional setting for an https proxy if required.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong><em>NOTE:</em></strong> The integration can use either the ExtraHop Cloud Service or an ExtraHop standalone sensor.</p></td>
<td class="text-center"><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong><em>NOTE:</em></strong> If connecting to an ExtraHop cloud instance, the setting <code class="docutils literal notranslate"><span class="pre">extrahop_rx_api_key</span></code> should be set to a blank value or alteratively commented out.</p>
<p><strong><em>NOTE:</em></strong> If connecting to a standalone sensor, the settings <code class="docutils literal notranslate"><span class="pre">extrahop_rx_key_id</span></code> and <code class="docutils literal notranslate"><span class="pre">extrahop_rx_key_secret</span></code> should be set to a blank value or alternatively commented out.</p>
</section>
<section id="custom-layout">
<h3>Custom Layout<a class="headerlink" href="#custom-layout" title="Link to this heading">#</a></h3>
<!--
  Use this section to provide guidance on where the user should add any custom fields and data tables.
  You may wish to recommend a new incident tab.
  You should save a screenshot "custom_layouts.png" in the doc/screenshots directory and reference it here
-->
<p>When the poller starts running, a new incident tab is created as shown below. If the poller is not configured to run, the custom layout can be configured manually.</p>
<ul class="simple">
<li><p>Import the Data Tables and Custom Fields like the screenshot below:</p></li>
<li><p>Create a new ExtraHop incident tab in Layouts as follows:</p></li>
</ul>
<ol class="arabic simple">
<li><p>Navigate to the ‘Customization Settings’ and select the Layouts tab.</p></li>
<li><p>Click on ‘Incident Tabs’.</p></li>
<li><p>Add a new incident tab named ‘ExtraHop’.</p></li>
<li><p>Drag and Drop the ‘ExtraHop Update Notification’ custom property onto the ExtraHop tab.</p></li>
<li><p>Create new heading ‘ExtraHop Properties’ in the ExtraHop tab.</p></li>
<li><p>Drag and Drop the ExtraHop the remaining custom properties under the new heading as shown below.</p></li>
<li><p>Create new heading ‘ExtraHop Details’ in the ExtraHop tab.</p></li>
<li><p>Drag and drop the ExtraHop data tables under the new heading as shown below.</p></li>
<li><p>Click Save.</p></li>
</ol>
<p>The following screenshot shows the ExtraHop properties and data tables added to the ExtraHop tab:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts8.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="poller-extrahop-escalate-detections">
<h2>Poller - ExtraHop Escalate Detections<a class="headerlink" href="#poller-extrahop-escalate-detections" title="Link to this heading">#</a></h2>
<p>The ExtraHop integration poller starts querying ExtraHop for detections as soon as the app begins running.</p>
<p>The poller provides the following functionality.</p>
<ul class="simple">
<li><p>For any new detections discovered, creates a  matching incident in the SOAR platform.</p></li>
<li><p>The ExtraHop detections Ticket ID is assigned the SOAR case value.</p></li>
<li><p>The playbook <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Case</span> <span class="pre">(PB)</span></code> is triggered automatically to update an incident/case.</p></li>
<li><p>The automatic playbook enhances the case/incident by adding artifacts and data tables with detection and device information from the matching ExtraHop detection.</p></li>
<li><p>Can be configured to filter the detections which are escalated to the SOAR cases.</p></li>
<li><p>Closes SOAR case if the corresponding ExtraHop detections are closed.</p></li>
<li><p>Closes ExtraHop detections if the corresponding SOAR cases are closed.</p></li>
<li><p>Updates a notification property in the ExtraHop custom tab if information for a SOAR case if the corresponding ExtraHop detection is updated.</p></li>
<li><p>Adds a note to an ExtraHop detection when a matching SOAR case is created.</p></li>
</ul>
<p><strong>NOTE</strong> Starting with version 1.1.0 of the ExtraHop app for SOAR:</p>
<ul class="simple">
<li><p>The poller uses ExtraHop detection <code class="docutils literal notranslate"><span class="pre">mod_time</span></code> field to determine which detections to pull in to SOAR.</p></li>
<li><p>The poller includes an optional <code class="docutils literal notranslate"><span class="pre">polling_lookback</span></code> parameter in the app.config that can be used to look back the specified number of minutes when the poller starts or restarts to pull in “older” detections.  If not specified in the app.config, the poller uses a look back of zero minutes.</p></li>
</ul>
<p>The following screenshot shows examples of SOAR incidents created by the poller from ExtraHop detections:</p>
<p><img alt="screenshot: fn-extrahop-revealx-incidents" src="../_images/fn-extrahop-revealx-incidents.png" /></p>
<p>The following screenshot shows an example of a SOAR incident Details tab created by the poller:</p>
<p><img alt="screenshot: fn-extrahop-revealx-incident-details" src="../_images/fn-extrahop-revealx-incident-details.png" /></p>
<p>The following screenshot shows an example of custom properties in the ExtraHop tab of a SOAR incident created by the poller:</p>
<p><img alt="screenshot: fn-extrahop-revealx-incident-properties" src="../_images/fn-extrahop-revealx-incident-properties.png" /></p>
<p>The following screenshot shows an example of an ExtraHop detection update notification in the ExtraHop tab of a SOAR incident created by the poller:</p>
<p><img alt="screenshot: fn-extrahop-revealx-incident-notification" src="../_images/fn-extrahop-revealx-incident-notification.png" /></p>
<p>The following screenshot shows examples of artifacts added to a SOAR incident created by the poller:</p>
<p><img alt="screenshot: fn-extrahop-revealx-incident-artifacts" src="../_images/fn-extrahop-revealx-incident-artifacts.png" /></p>
<p><strong><em>NOTE:</em></strong> See the data tables section for examples of data tables updated by the poller.</p>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-add-detection-note">
<h2>Function - Extrahop Reveal(x) add detection note<a class="headerlink" href="#function-extrahop-reveal-x-add-detection-note" title="Link to this heading">#</a></h2>
<p>Add a note to an ExtraHop detection. Parameters detection_id, note. (Optional) update_time.</p>
<p><img alt="screenshot: fn-extrahop-revealx-add-detection-note " src="../_images/fn-extrahop-revealx-add-detection-note.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Adds a note to a detection in the ExtraHop environment. The original note is overwritten.</p></li>
</ul>
<p><strong><em>NOTE:</em></strong> The original note is overwritten.</p>
<p><strong><em>NOTE:</em></strong> Add detection note will fail if <code class="docutils literal notranslate"><span class="pre">Detection</span> <span class="pre">Tracking</span></code> is enabled on ExtraHop.</p>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x)</span> <span class="pre">Update</span> <span class="pre">Detection</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the ExtraHop detection when a matching SOAR case is closed.</p></li>
</ul>
<p>The automatic data table playbook <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Detection</span> <span class="pre">(PB)</span></code> is triggered when a SOAR case is closed.</p>
<p>The following screenshot shows an example of a note added to an ExtraHop detection:</p>
<p><img alt="screenshot: fn-extrahop-revealx-add-detection-note-note" src="../_images/fn-extrahop-revealx-add-detection-note-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Extrahop detection ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_note</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>ExtraHop note object</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_update_time</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Return detections that were updated on or after the specified date, expressed in milliseconds since the epoch.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_update_time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_note&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">IBM SOAR 10/04/2023 15:36:28</span><span class="se">\n</span><span class="s2">[SOAR Case - 3080](https://host0.ibm.com:443/#incidents/3080)</span><span class="se">\n</span><span class="s2">IBM SOAR 10/04/2023 14:00:50</span><span class="se">\n</span><span class="s2">[SOAR Case - 3390](https://host1.ibm.com:443/#incidents/3390)</span><span class="se">\n</span><span class="s2">IBM SOAR 2023-04-10 14:18:35</span><span class="se">\n</span><span class="s2">[SOAR case - &#39;3390&#39;](Closed with resolution summary: &#39;Not an issue&#39;)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_detection_id&quot;</span><span class="p">:</span> <span class="mi">4294967305</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MBP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">4470</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-04-10 14:18:48&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_update_detection pre processing script ##</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_detection_id</span>

<span class="n">UPD_DET_DATETIME</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_detection_note_result</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">SUMMARY</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&lt;[^&lt;]+?&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">resolution_summary</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_current_note</span><span class="p">():</span>
    <span class="c1"># Get old note</span>
    <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">get_detection_note_content</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_detection_note_result</span><span class="o">.</span><span class="n">content</span>
    <span class="n">note_obj</span> <span class="o">=</span> <span class="n">get_detection_note_content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">note_obj</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Existing ExtraHop detection note not found.&quot;</span><span class="p">)</span>
    <span class="n">note</span> <span class="o">=</span> <span class="n">note_obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;note&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">note</span>


<span class="k">def</span> <span class="nf">make_summary_note</span><span class="p">():</span>
    <span class="c1"># Make a  note.</span>
    <span class="n">summary_note</span> <span class="o">=</span> <span class="s2">&quot;IBM SOAR </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">UPD_DET_DATETIME</span><span class="p">)</span>
    <span class="n">summary_note</span> <span class="o">+=</span> <span class="s2">&quot;[SOAR case - &#39;</span><span class="si">{}</span><span class="s2">&#39;](Closed with resolution summary: &#39;</span><span class="si">{}</span><span class="s2">&#39;)&quot;</span> \
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">SUMMARY</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">summary_note</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">detection_note</span> <span class="o">=</span> <span class="n">get_current_note</span><span class="p">()</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_note</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">detection_note</span> <span class="k">if</span> <span class="n">detection_note</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">make_summary_note</span><span class="p">()])</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_update_time</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_update_detection post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_add_detection_note&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Update Detection&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">add_detection_note_result</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">detection_id</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_detection_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully added closure resolution note to &quot;</span> \
                        <span class="s2">&quot;ExtraHop detection &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">detection_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to add closure resolution note to ExtraHop &quot;</span> \
                         <span class="s2">&quot;detection &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">detection_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Error code: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;, Error &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">),</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;failed&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to add closure resolution note to ExtraHop &quot;</span> \
                        <span class="s2">&quot;detection &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">detection_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to add closure resolution note to ExtraHop &quot;</span> \
                        <span class="s2">&quot;detection &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with unexpected response for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">detection_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to add closure resolution note to ExtraHop detection &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters&quot;</span> \
                     <span class="s2">&quot; &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; .&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">detection_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-assign-tag">
<h2>Function - Extrahop Reveal(x) assign tag<a class="headerlink" href="#function-extrahop-reveal-x-assign-tag" title="Link to this heading">#</a></h2>
<p>Assign a tag to a list of devices ids forExtrahop Reveal(x). Parameters tag_id. devices_ids.</p>
<p><img alt="screenshot: fn-extrahop-revealx-assign-tag" src="../_images/fn-extrahop-revealx-assign-tag.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Assigns a tag to a list of device ids discovered in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Assign</span> <span class="pre">Tag</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
</ul>
<p>The playbook is initiated by the manual data table menu item <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Assign</span> <span class="pre">Tag</span> <span class="pre">(PB)</span></code> for data table <code class="docutils literal notranslate"><span class="pre">ExtraGop</span> <span class="pre">Devices</span></code>.</p>
<p><img alt="screenshot: fn-extrahop-revealx-assign-tag-action" src="../_images/fn-extrahop-revealx-assign-tag-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-assign-tag-action_2" src="../_images/fn-extrahop-revealx-assign-tag-action_2.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-assign-tag-note" src="../_images/fn-extrahop-revealx-assign-tag-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_device_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma or newline seperated list of device ids.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_tag_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The unique identifier for the tag.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_device_ids&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_tag_id&quot;</span><span class="p">:</span> <span class="mi">5</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">810</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:19:42&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tag_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_name</span>
<span class="n">get_tags_content</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_tags_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_ids</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">devs_id</span><span class="p">)</span>
<span class="k">if</span> <span class="n">tag_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tag name is not set&quot;</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_id</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">get_tags_content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">[]):</span>
    <span class="k">if</span> <span class="n">tag_name</span> <span class="o">==</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_id</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">break</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_id</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Tag </span><span class="si">{}</span><span class="s2"> not found.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tag_name</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_assign_tag post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_assign_tag&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Assign Tag&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">assign_tag_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="n">tag_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_name</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_tag_name&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
            <span class="n">device_id</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_device_ids&quot;</span><span class="p">)</span>
            <span class="n">tag_id</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_tag_id&quot;</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully assigned tag &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt; with id &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; to device id &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for SOAR &quot;</span> \
                        <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{5}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">tag_id</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;failed&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to assign tag &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with id &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; to device id &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{5}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">tag_id</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Assign tag &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with id &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; to device id &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; failed with unexpected &quot;</span> \
                        <span class="s2">&quot;response for SOAR function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{5}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">tag_id</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to assign tag &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with id  &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; to device id &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{5}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">tag_id</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-create-tag">
<h2>Function - Extrahop Reveal(x) create tag<a class="headerlink" href="#function-extrahop-reveal-x-create-tag" title="Link to this heading">#</a></h2>
<p>Create a new tag for Extrahop Reveal(x).  Parameter tag_name.</p>
<p><img alt="screenshot: fn-extrahop-revealx-create-tag " src="../_images/fn-extrahop-revealx-create-tag.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Creates a new tag in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Create</span> <span class="pre">Tag</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Tags</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the menu item <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Create</span> <span class="pre">Tag</span> <span class="pre">(PB)</span></code>.</p>
<p><img alt="screenshot: fn-extrahop-revealx-create-tag-action" src="../_images/fn-extrahop-revealx-create-tag-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-create-tag-action_2" src="../_images/fn-extrahop-revealx-create-tag-action_2.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-create-tag-note" src="../_images/fn-extrahop-revealx-create-tag-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_tag_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The string value for an ExtraHop  tag name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_tag_name&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_TAG_1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">798</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:22:37&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_name</span>
<span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tag name is not set&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - wf_extrahop_rx_create_tag post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_create_tag&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Create Tag&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">create_tag_result</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>

<span class="c1"># Processing</span>

<span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
<span class="n">tag</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_tag_name&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
        <span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;tag_created&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_tag_name&quot;</span><span class="p">)</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully created tag &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt; for SOAR &quot;</span> \
                    <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;failed&quot;</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to create tag &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt; for &quot;</span> \
                    <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;exists&quot;</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: A 422 (tag name exists) error was thrown while to create tag &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt; for &quot;</span> \
                    <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Create tag &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt; failed with unexpected &quot;</span> \
                    <span class="s2">&quot;response for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook&lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                 <span class="s2">&quot;to create a tag &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt;for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; .&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-get-activitymaps">
<h2>Function - Extrahop Reveal(x) get activitymaps<a class="headerlink" href="#function-extrahop-reveal-x-get-activitymaps" title="Link to this heading">#</a></h2>
<p>Get activitymap information from Extrahop Reveal(x). Optional parameter activitymap_id.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-activitymaps" src="../_images/fn-extrahop-revealx-get-activitymaps.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves information on activitymaps in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Get</span> <span class="pre">Activitymaps</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Activitymaps</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the incident menu item <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Get</span> <span class="pre">Activitymaps</span> <span class="pre">(PB)</span></code>.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-activitymaps-action" src="../_images/fn-extrahop-revealx-get-activitymaps-action.png" /></p>
<p>The following screenshot shows an example of the data table updated by the function.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-activitymaps-datatable" src="../_images/dt-extrahop-activitymaps.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-activitymaps-note" src="../_images/fn-extrahop-revealx-get-activitymaps-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_activitymap_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The unique identifier for the activity map.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Test map 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;mod_time&quot;</span><span class="p">:</span> <span class="mi">1644514002331</span><span class="p">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;2dforce&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Test_activity_map_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;setup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rights&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;delete&quot;</span><span class="p">,</span>
          <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
          <span class="s2">&quot;share&quot;</span><span class="p">,</span>
          <span class="s2">&quot;transfer&quot;</span><span class="p">,</span>
          <span class="s2">&quot;view&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;short_code&quot;</span><span class="p">:</span> <span class="s2">&quot;wGCGL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;show_alert_status&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;walks&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;origins&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;object_id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;device&quot;</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;relationships&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;any&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;any&quot;</span>
                  <span class="p">}</span>
                <span class="p">]</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;weighting&quot;</span><span class="p">:</span> <span class="s2">&quot;bytes&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1063</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 16:50:16&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_get_activitymaps post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_get_activitymaps&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Get Activitymaps&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_activitymap_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DATA_TABLE</span> <span class="o">=</span> <span class="s2">&quot;extrahop_activitymaps&quot;</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ams_description&quot;</span><span class="p">,</span> <span class="s2">&quot;ams_id&quot;</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;ams_name&quot;</span><span class="p">,</span> <span class="s2">&quot;owner&quot;</span><span class="p">,</span> <span class="s2">&quot;rights&quot;</span><span class="p">,</span> <span class="s2">&quot;short_code&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;show_alert_status&quot;</span><span class="p">,</span> <span class="s2">&quot;walks&quot;</span><span class="p">,</span> <span class="s2">&quot;weighting&quot;</span><span class="p">]</span>
<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">ams</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Activitymaps returned for SOAR &quot;</span> \
                    <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ams</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">ams</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">am</span> <span class="ow">in</span> <span class="n">ams</span><span class="p">:</span>
                <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">mod_time</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">f1</span> <span class="ow">in</span> <span class="n">DATA_TBL_FIELDS</span><span class="p">:</span>
                    <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span>
                    <span class="k">if</span> <span class="n">f1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ams_&quot;</span><span class="p">):</span>
                        <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">f1</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;walks&quot;</span><span class="p">]:</span>
                            <span class="n">obj_cnt</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="n">tbl</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
                            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">]:</span>
                                <span class="k">for</span> <span class="n">kw</span><span class="p">,</span> <span class="n">vw</span> <span class="ow">in</span> <span class="n">w</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                    <span class="k">if</span> <span class="n">kw</span> <span class="o">==</span> <span class="s2">&quot;origins&quot;</span><span class="p">:</span>
                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div&gt;&lt;b&gt;origins:&lt;/b&gt;&lt;/div&gt;&quot;</span>
                                        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">vw</span><span class="p">:</span>
                                            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                                <span class="n">tbl</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;div&gt;&lt;b&gt;&amp;emsp;</span><span class="si">{0}</span><span class="s2">:&lt;/b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                                    <span class="k">elif</span> <span class="n">kw</span> <span class="o">==</span> <span class="s2">&quot;steps&quot;</span><span class="p">:</span>
                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div&gt;&lt;b&gt;steps:&lt;/b&gt;&lt;/div&gt;&quot;</span>
                                        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">vw</span><span class="p">:</span>
                                            <span class="n">relationships</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;relationships&quot;</span><span class="p">)</span>
                                            <span class="k">if</span> <span class="n">relationships</span><span class="p">:</span>
                                                <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div&gt;&lt;b&gt;&amp;emsp;relationships:&lt;/b&gt;&lt;/div&gt;&quot;</span>
                                                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">relationships</span><span class="p">:</span>
                                                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div&gt;&lt;b&gt;&amp;emsp;&amp;emsp;</span><span class="si">{0}</span><span class="s2">:&lt;/b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                                                <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div&gt;&lt;b&gt;</span><span class="si">{}</span><span class="s2">:&lt;/b&gt;&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
                                        <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;div&gt;&lt;b&gt;&amp;emsp</span><span class="si">{}</span><span class="s2">&lt;/b&gt;&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vw</span><span class="p">)</span>
                            <span class="n">tbl</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>
                            <span class="n">obj_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">],</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                        <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">am</span><span class="p">[</span><span class="n">f2</span><span class="p">])</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Extrahop Activitymaps&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to get activitymaps for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>


</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-get-detection-note">
<h2>Function - Extrahop Reveal(x) get detection note<a class="headerlink" href="#function-extrahop-reveal-x-get-detection-note" title="Link to this heading">#</a></h2>
<p>Get a note from an ExtraHop detection. Parameter detection_id.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-detection-note " src="../_images/fn-extrahop-revealx-get-detection-note.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Gets the current note from a detection in the ExtraHop environment.</p></li>
</ul>
<p><strong><em>NOTE:</em></strong> Get detection note will fail if <code class="docutils literal notranslate"><span class="pre">Detection</span> <span class="pre">Tracking</span></code> is enabled on ExtraHop.</p>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Detection</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>The current note is retrieved from the ExtraHop detection when a matching SOAR incident is closed.</p></li>
</ul>
<p>The automatic data table playbook <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Detection</span> <span class="pre">(PB)</span></code> is initiated when a SOAR case/incident is closed.</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Extrahop detection ID</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;setup&quot;</span><span class="p">,</span>
      <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">IBM SOAR 16/05/2022 15:13:37</span><span class="se">\n</span><span class="s2">[SOAR Case - 4305](https://127.0.0.1:1443/#incidents/4305)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;update_time&quot;</span><span class="p">:</span> <span class="mi">1652711350410</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_detection_id&quot;</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">780</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-05-16 15:29:13&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_detection_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">soar_inc_owner_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">owner_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">soar_inc_plan_status</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">plan_status</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">soar_inc_resolution_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_update_setection post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_update_detection&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Update Detection&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">update_detection_result</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
            <span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;update_detection_ok&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully updated the detection status for SOAR &quot;</span> \
                        <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;failed&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to update the detection status for &quot;</span> \
                        <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Update detection status failed with unexpected &quot;</span> \
                        <span class="s2">&quot;response for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to update the detection status &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-get-detections">
<h2>Function - Extrahop Reveal(x) get detections<a class="headerlink" href="#function-extrahop-reveal-x-get-detections" title="Link to this heading">#</a></h2>
<p>Get detections information from Extrahop Reveal(x). Optional parameter extrahop_detection_id.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-detections " src="../_images/fn-extrahop-revealx-get-detections.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves information on detections in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Case</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Detections</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the automatic <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Case</span> <span class="pre">(PB)</span></code>.
The following screenshots show an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-detections-datatable" src="../_images/fn-extrahop-revealx-get-detections-datatable.png" />
<img alt="screenshot: fn-extrahop-revealx-get-detections-datatable_2" src="../_images/fn-extrahop-revealx-get-detections-datatable_2.png" />
<img alt="screenshot: fn-extrahop-revealx-get-detections-datatable_3" src="../_images/fn-extrahop-revealx-get-detections-datatable_3.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-detections-note" src="../_images/fn-extrahop-revealx-get-detections-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Extrahop detection ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_limit</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Limit the number of devices returned to the specified maximum number.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;appliance_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="s2">&quot;a@a.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;sec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sec.caution&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Over the past week, servers negotiated SSL/TLS sessions with a cipher suite that includes an encryption algorithm that is known to be vulnerable. Cipher suites that contain weak encryption algorithms such as CBC, 3DES, RC4, null, anonymous, and export should be removed from servers and replaced with stronger cipher suites.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="mi">1647051270000</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">71</span><span class="p">,</span>
      <span class="s2">&quot;is_user_created&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;mitre_tactics&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;mitre_techniques&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;participants&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">175</span><span class="p">,</span>
          <span class="s2">&quot;object_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
          <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span>
          <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;offender&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">179</span><span class="p">,</span>
          <span class="s2">&quot;object_id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
          <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span>
          <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;offender&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;risk_score&quot;</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span>
      <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">1646559540000</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;in_progress&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ticket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;3055&quot;</span><span class="p">,</span>
      <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Weekly Summary: Weak Cipher Suites&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;weak_cipher&quot;</span><span class="p">,</span>
      <span class="s2">&quot;update_time&quot;</span><span class="p">:</span> <span class="mi">1647656040000</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_detection_id&quot;</span><span class="p">:</span> <span class="mi">71</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1373</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:01:56&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_detection_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_search_detections post processing script ##</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_search_detections&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Revealx search detections&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">search_detections_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DATA_TABLE</span> <span class="o">=</span> <span class="s2">&quot;extrahop_detections&quot;</span>

<span class="c1"># Read CATEGORY_MAP and TYPE_MAP from workflow property.</span>
<span class="n">CATEGORY_MAP</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">category_map</span>
<span class="n">TYPE_MAP</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">type_map</span>

<span class="n">LINKBACK_URL</span> <span class="o">=</span> <span class="s2">&quot;/extrahop/#/detections/detail/</span><span class="si">{}</span><span class="s2">&quot;</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">process_dets</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
    <span class="n">detection_url</span> <span class="o">=</span> <span class="n">make_linkback_url</span><span class="p">(</span><span class="n">det</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
    <span class="n">detection_url_html</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&lt;div&gt;&lt;b&gt;&lt;a target=&quot;blank&quot; href=&quot;</span><span class="si">{0}</span><span class="s1">&quot;&gt;</span><span class="si">{1}</span><span class="s1">&lt;/a&gt;&lt;/b&gt;&lt;/div&gt;&#39;</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">detection_url</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">detection_url</span> <span class="o">=</span> <span class="n">detection_url_html</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">appliance_id</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;appliance_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">assignee</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;assignee&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CATEGORY_MAP</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="n">CATEGORY_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;categories&quot;</span><span class="p">,</span> <span class="p">[])))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">det_description</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">det_id</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">is_user_created</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_user_created&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mod_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">update_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;update_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">detection_type</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">TYPE_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">detection_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">detection_type</span> <span class="ow">and</span> <span class="n">TYPE_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">detection_type</span><span class="p">)</span> <span class="k">else</span> <span class="n">detection_type</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">risk_score</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;risk_score&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resolution&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="c1">#newrow.ticket_url =  &#39;&lt;div&gt;&lt;b&gt;&lt;a target=&quot;blank&quot; href=&quot;{0}&quot;&gt;{1}&lt;/a&gt;&lt;/div&gt;&#39;.format(det.get(f2, None), det.get(f2, None).split(&#39;/&#39;)[-1])</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">ticket_id</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ticket_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">make_properties_string</span><span class="p">(</span><span class="n">det</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">participants</span> <span class="o">=</span> <span class="n">make_list_string</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mitre_tactics</span> <span class="o">=</span> <span class="n">make_list_string</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mitre_tactics&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mitre_techniques</span> <span class="o">=</span> <span class="n">make_list_string</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mitre_techniques&quot;</span><span class="p">,</span> <span class="p">[]))</span>

<span class="k">def</span> <span class="nf">make_properties_string</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        det (json object): ExtraHop detection object</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : properties json object converted to a formatted string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;suspicious_ipaddr&quot;</span><span class="p">:</span>
            <span class="n">det_type</span> <span class="o">=</span> <span class="s2">&quot;Suspicious IP Addresses&quot;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">det_type</span><span class="p">)</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;/b&gt;</span><span class="si">{2}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tbl</span>

<span class="k">def</span> <span class="nf">make_list_string</span><span class="p">(</span><span class="n">detection_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        det (json object): ExtraHop detection object</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : properties json object converted to a formatted string</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">tbl</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">detection_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;legacy_ids&quot;</span><span class="p">:</span>
                <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;/b&gt;</span><span class="si">{2}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span>
                <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;a target=&quot;blank&quot; href=&quot;</span><span class="si">{2}</span><span class="s1">&quot;&gt;</span><span class="si">{3}</span><span class="s1">&lt;/a&gt;&lt;/div&gt;&#39;</span> \
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;/b&gt;</span><span class="si">{2}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">tbl</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;&quot;</span>

    <span class="k">return</span> <span class="n">tbl</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">make_linkback_url</span><span class="p">(</span><span class="n">det_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a url to link back to the detection.</span>

<span class="sd">    Args:</span>
<span class="sd">        det_id (str/int): id representing the detection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: completed url for linkback</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_console_url</span> <span class="o">+</span> <span class="n">LINKBACK_URL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">det_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">format_input_params</span><span class="p">(</span><span class="n">input_params</span><span class="p">):</span>
    <span class="n">input_params_formatted</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">input_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;extrahop_active_until&quot;</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;extrahop_active_from&quot;</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="n">input_params_formatted</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">input_params_formatted</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">input_params_formatted</span> <span class="o">=</span> <span class="n">format_input_params</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">dets</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Detections returned for SOAR &quot;</span> \
                    <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dets</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">det</span> <span class="ow">in</span> <span class="n">dets</span><span class="p">:</span>
                <span class="n">process_dets</span><span class="p">(</span><span class="n">det</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Extrahop Detections&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to search detections for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;&quot;</span> \
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="c1"># Start execution</span>
<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-get-devices">
<h2>Function - Extrahop Reveal(x) get devices<a class="headerlink" href="#function-extrahop-reveal-x-get-devices" title="Link to this heading">#</a></h2>
<p>Get devices information from Extrahop Reveal(x). Optional parameters  device_id, active_from, active_util, limit and offset.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-devices " src="../_images/fn-extrahop-revealx-get-devices.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves information for devices in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Devices</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Devices</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the manual incident menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Devices</span> <span class="pre">(PB)</span></code>.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-devices-action" src="../_images/fn-extrahop-revealx-get-devices-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices-action_2" src="../_images/fn-extrahop-revealx-search-devices-action_2.png" /></p>
<p>The following screenshots show an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-devices-datatable" src="../_images/fn-extrahop-revealx-get-devices-datatable.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-get-devices-datatable_2" src="../_images/fn-extrahop-revealx-get-devices-datatable_2.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-devices-note" src="../_images/fn-extrahop-revealx-get-devices-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_from</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The beginning timestamp for the request. Return only devices active after this time. Time is expressed in milliseconds since the epoch. 0 indicates the time of the request.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_until</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The ending timestamp for the request. Return only devices active before this time.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_device_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Extrahop device ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_limit</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Limit the number of devices returned to the specified maximum number.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_offset</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Skip the specified number of devices. This parameter is often combined with the limit parameter to paginate result sets.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_search_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Indicates the field to search.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Indicates the vakue to search for.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;analysis&quot;</span><span class="p">:</span> <span class="s2">&quot;advanced&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analysis_level&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;auto_role&quot;</span><span class="p">:</span> <span class="s2">&quot;http_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cdp_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cloud_account&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_type&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;custom_criticality&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_make&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_model&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Device 027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;device_class&quot;</span><span class="p">:</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dhcp_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;discover_time&quot;</span><span class="p">:</span> <span class="mi">1644418590000</span><span class="p">,</span>
        <span class="s2">&quot;discovery_id&quot;</span><span class="p">:</span> <span class="s2">&quot;027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Device 027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dns_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extrahop_id&quot;</span><span class="p">:</span> <span class="s2">&quot;027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;ipaddr4&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipaddr6&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;is_l3&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;last_seen_time&quot;</span><span class="p">:</span> <span class="mi">1647052260000</span><span class="p">,</span>
        <span class="s2">&quot;macaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;02:74:37:B6:3D:F4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mod_time&quot;</span><span class="p">:</span> <span class="mi">1647052291076</span><span class="p">,</span>
        <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;model_override&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;netbios_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;node_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;on_watchlist&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;parent_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;http_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subnet_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;user_mod_time&quot;</span><span class="p">:</span> <span class="mi">1646046972271</span><span class="p">,</span>
        <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;vlanid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;vpc_id&quot;</span><span class="p">:</span> <span class="n">null</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1558</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:02:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">search_filters</span> <span class="o">=</span>  <span class="p">[</span>
    <span class="s2">&quot;extrahop_device_field&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_device_operand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_device_operator&quot;</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">search_filters</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A search filter and Device ID are not allowed at the same time.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_id</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_id</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_get_devices post processing script ##</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_get_devices&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x) search devices&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_devices_result</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="c1"># Display subset of fields</span>
<span class="n">DATA_TABLE</span> <span class="o">=</span> <span class="s2">&quot;extrahop_devices&quot;</span>
<span class="n">LINKBACK_URL</span> <span class="o">=</span> <span class="s2">&quot;/extrahop/#/metrics/devices/</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span>


<span class="k">def</span> <span class="nf">make_linkback_url</span><span class="p">(</span><span class="n">dev_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a url to link back to the endpoint alert, case, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        dev_id (str/int): id representing the device etc.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: completed url for linkback</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_console_url</span> <span class="o">+</span> <span class="n">LINKBACK_URL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_site_uuid</span><span class="p">,</span>
                                                                          <span class="n">dev_id</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">format_input_params</span><span class="p">(</span><span class="n">input_params</span><span class="p">):</span>
    <span class="n">input_params_formatted</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">input_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;extrahop_active_until&quot;</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;extrahop_active_from&quot;</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="n">input_params_formatted</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">input_params_formatted</span>

<span class="k">def</span> <span class="nf">process_devs</span><span class="p">(</span><span class="n">dev</span><span class="p">):</span>
    <span class="c1"># Process a device result.</span>
    <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">devs_description</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">default_name</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">dns_name</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dns_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">ipaddr4</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ipaddr4&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">ipaddr6</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ipaddr6&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">macaddr</span>  <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;macaddr&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">vendor</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vendor&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">devs_id</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">extrahop_id</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">activity</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">on_watchlist</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;on_watchlist&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mod_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">user_mod_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">discover_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discover_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">last_seen_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last_seen_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_url</span> <span class="o">=</span> <span class="n">make_linkback_url</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="s2">&quot;extrahop_id&quot;</span><span class="p">])</span>
    <span class="n">device_url_html</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&lt;div&gt;&lt;b&gt;&lt;a target=&quot;blank&quot; href=&quot;</span><span class="si">{1}</span><span class="s1">&quot;&gt;</span><span class="si">{2}</span><span class="s1">&lt;/a&gt;&lt;/b&gt;&lt;/div&gt;&#39;</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="n">device_url</span><span class="p">,</span> <span class="n">dev</span><span class="p">[</span><span class="s2">&quot;extrahop_id&quot;</span><span class="p">])</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">device_url</span> <span class="o">=</span> <span class="n">device_url_html</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">device_id</span> <span class="o">=</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_device_id&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">input_params_formatted</span> <span class="o">=</span> <span class="n">format_input_params</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">devs</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">devs</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop app: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Device(s) successfully returned for &quot;</span> \
                        <span class="s2">&quot;Device ID &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;&quot;</span> \
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">devs</span><span class="p">),</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>
            <span class="c1"># Extrahop will return a list or a single json object</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">devs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
              <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">devs</span><span class="p">:</span>
                <span class="n">process_devs</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">process_devs</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span>

            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop app: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to get device for device ID &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; .&quot;</span> \
                     <span class="s2">&quot; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;&quot;</span> \
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop app: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to get device for device ID &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; .&quot;</span> \
                     <span class="s2">&quot; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>


<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-get-tags">
<h2>Function - Extrahop Reveal(x) get tags<a class="headerlink" href="#function-extrahop-reveal-x-get-tags" title="Link to this heading">#</a></h2>
<p>Get tags information from Extrahop Reveal(x). Optional parameter tag_id.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-tags" src="../_images/fn-extrahop-revealx-get-tags.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves a list of tags discovered in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Get</span> <span class="pre">Tags</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Tags</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the manual incident menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Get</span> <span class="pre">Tags</span> <span class="pre">(PB)</span></code>.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-tags-action" src="../_images/fn-extrahop-revealx-get-tags-action.png" /></p>
<p>The following screenshot shows an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-tags-datatable" src="../_images/fn-extrahop-revealx-get-tags-datatable.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR case:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-tags-note" src="../_images/fn-extrahop-revealx-get-tags-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_tag_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The unique identifier for the tag.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;mod_time&quot;</span><span class="p">:</span> <span class="mi">1646045416014</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_TAG_1&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;mod_time&quot;</span><span class="p">:</span> <span class="mi">1646064909025</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TEST_TAG_2&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">969</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:19:40&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_tag_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The tag name is not set&quot;</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_get_tags post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_get_tags&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Get Tags&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_tags_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;am_description&quot;</span><span class="p">,</span> <span class="s2">&quot;am_id&quot;</span><span class="p">,</span> <span class="s2">&quot;mod_time&quot;</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;owner&quot;</span><span class="p">,</span> <span class="s2">&quot;rights&quot;</span><span class="p">,</span> <span class="s2">&quot;short_code&quot;</span><span class="p">,</span> <span class="s2">&quot;show_alert_status&quot;</span><span class="p">,</span> <span class="s2">&quot;walks&quot;</span><span class="p">,</span> <span class="s2">&quot;weighting&quot;</span><span class="p">]</span>


<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook&lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Tags returned for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span>\
                     <span class="s2">&quot;with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tags</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">tags</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
                <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;extrahop_tags&quot;</span><span class="p">)</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">mod_time</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mod_time&quot;</span><span class="p">)</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">tag_id</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Extrahop Tags&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to get tags for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-get-watchlist">
<h2>Function - Extrahop Reveal(x) get watchlist<a class="headerlink" href="#function-extrahop-reveal-x-get-watchlist" title="Link to this heading">#</a></h2>
<p>Retrieve all devices that are in the watchlist from Extrahop Reveal(x).</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-watchlist " src="../_images/fn-extrahop-revealx-get-watchlist.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves a list of devices on the watchlist in the ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Get</span> <span class="pre">Watchlist</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Watchlist</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the manual incident menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Get</span> <span class="pre">Watchlist</span> <span class="pre">(PB)</span></code>.</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-watchlist-action" src="../_images/fn-extrahop-revealx-get-watchlist-action.png" /></p>
<p>The following screenshot shows an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-watchlist-datatable" src="../_images/fn-extrahop-revealx-get-watchlist-datatable.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-get-watchlist-note" src="../_images/fn-extrahop-revealx-get-watchlist-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;analysis&quot;</span><span class="p">:</span> <span class="s2">&quot;advanced&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analysis_level&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;auto_role&quot;</span><span class="p">:</span> <span class="s2">&quot;http_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cdp_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cloud_account&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_type&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;custom_criticality&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_make&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_model&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Device 027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;device_class&quot;</span><span class="p">:</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dhcp_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;discover_time&quot;</span><span class="p">:</span> <span class="mi">1644418590000</span><span class="p">,</span>
        <span class="s2">&quot;discovery_id&quot;</span><span class="p">:</span> <span class="s2">&quot;027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Device 027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dns_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extrahop_id&quot;</span><span class="p">:</span> <span class="s2">&quot;027437b63df40000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;ipaddr4&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipaddr6&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;is_l3&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;last_seen_time&quot;</span><span class="p">:</span> <span class="mi">1647052260000</span><span class="p">,</span>
        <span class="s2">&quot;macaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;02:74:37:B6:3D:F4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mod_time&quot;</span><span class="p">:</span> <span class="mi">1647052291076</span><span class="p">,</span>
        <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;model_override&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;netbios_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;node_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;on_watchlist&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;parent_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;http_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subnet_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;user_mod_time&quot;</span><span class="p">:</span> <span class="mi">1646046972271</span><span class="p">,</span>
        <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;vlanid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;vpc_id&quot;</span><span class="p">:</span> <span class="n">null</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">739</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 16:50:11&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_get_watchlist post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_get_watchlist&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Get Watchlist&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_watchlist_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="c1"># Display subset of fields</span>
<span class="n">DATA_TABLE</span> <span class="o">=</span> <span class="s2">&quot;extrahop_watchlist&quot;</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;display_name&quot;</span><span class="p">,</span> <span class="s2">&quot;ipaddr4&quot;</span><span class="p">,</span> <span class="s2">&quot;ipaddr6&quot;</span><span class="p">,</span> <span class="s2">&quot;macaddr&quot;</span><span class="p">,</span> <span class="s2">&quot;extrahop_id&quot;</span><span class="p">]</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">devs</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; devices returned in the Watchlist&quot;</span> \
                    <span class="s2">&quot; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">devs</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">devs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">devs</span><span class="p">:</span>
                <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;extrahop_watchlist&quot;</span><span class="p">)</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
                <span class="k">for</span> <span class="n">f1</span> <span class="ow">in</span> <span class="n">DATA_TBL_FIELDS</span><span class="p">:</span>
                  <span class="n">f2</span> <span class="o">=</span> <span class="n">f1</span>
                  <span class="k">if</span> <span class="n">dev</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                      <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dev</span><span class="p">[</span><span class="n">f2</span><span class="p">]</span>
                  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="n">f1</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                      <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="n">f2</span><span class="p">]))</span>
                  <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="n">f1</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>
                      <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="n">f2</span><span class="p">])</span>
                  <span class="k">else</span><span class="p">:</span>
                      <span class="n">newrow</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="n">f2</span><span class="p">])</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Extrahop Detections&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to get the watchlist for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-search-detections">
<h2>Function - Extrahop Reveal(x) search detections<a class="headerlink" href="#function-extrahop-reveal-x-search-detections" title="Link to this heading">#</a></h2>
<p>Search for detections information from Extrahop Reveal(x). Optional parameters search_filter, active_from, active_util, limit, offset, update_time and sort.</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-detections " src="../_images/fn-extrahop-revealx-search-detections.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves a list of detections in the ExtraHop environment based on the provided parameters.</p></li>
<li><p>A filter in JSON is used to target the information retrieved.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Detections</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Detections</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the manual incident menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Detections</span> <span class="pre">(PB)</span></code>.</p>
<p>The following screenshot shows an example of the action inputs for the playbook:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-detections-action" src="../_images/fn-extrahop-revealx-search-detections-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-search-detections-action_2" src="../_images/fn-extrahop-revealx-search-detections-action_2.png" /></p>
<p>The following screenshot shows an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-detections-datatable" src="../_images/fn-extrahop-revealx-search-detections-datatable.png" />
<img alt="screenshot: fn-extrahop-revealx-search-detections-datatable_2" src="../_images/fn-extrahop-revealx-search-detections-datatable_2.png" />
<img alt="screenshot: fn-extrahop-revealx-search-detections-datatable_3" src="../_images/fn-extrahop-revealx-search-detections-datatable_3.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-detections-note" src="../_images/fn-extrahop-revealx-search-detections-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_from</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The beginning timestamp for the request. Return only devices active after this time. Time is expressed in milliseconds since the epoch. 0 indicates the time of the request.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_until</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The ending timestamp for the request. Return only devices active before this time.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_limit</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Limit the number of devices returned to the specified maximum number.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_mod_time</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Return detections that were modified on or after the specified date, expressed in milliseconds since the epoch.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_offset</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Skip the specified number of devices. This parameter is often combined with the limit parameter to paginate result sets.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_search_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The  filter criteria for Extrahop search results.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_sort</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Sorts returned detections by the specified fields. By default, detections are sorted by most recent update time and then ID in ascending order.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_update_time</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Return detections that were updated on or after the specified date, expressed in milliseconds since the epoch.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;appliance_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;sec&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sec.caution&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Over the past day, servers received connections from devices with suspicious IP addresses. These IP addresses are considered suspicious based on threat intelligence found in your Reveal(x) system. Investigate to determine if the IP addresses are from malicious endpoints.</span><span class="se">\n\n</span><span class="s2">Suspicious IP addresses linked to this detection:</span><span class="se">\n</span><span class="s2">* 109.237.103.9</span><span class="se">\n</span><span class="s2">* 45.83.65.214</span><span class="se">\n</span><span class="s2">* 45.83.67.186</span><span class="se">\n</span><span class="s2">* 185.220.101.63</span><span class="se">\n</span><span class="s2">* 185.220.101.191</span><span class="se">\n</span><span class="s2">* 130.211.54.158</span><span class="se">\n</span><span class="s2">* 192.241.212.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="mi">1644556530000</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;is_user_created&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;mitre_tactics&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;mitre_techniques&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;participants&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;object_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;victim&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
            <span class="s2">&quot;object_id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;victim&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;suspicious_ipaddr&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipaddr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;192.168.1.9&quot;</span><span class="p">,</span>
              <span class="s2">&quot;192.168.1.214&quot;</span><span class="p">,</span>
              <span class="s2">&quot;192.168.1.186&quot;</span><span class="p">,</span>
              <span class="s2">&quot;192.168.1.63&quot;</span><span class="p">,</span>
              <span class="s2">&quot;192.168.1.191&quot;</span><span class="p">,</span>
              <span class="s2">&quot;192.168.1.158&quot;</span><span class="p">,</span>
              <span class="s2">&quot;192.168.2.103&quot;</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;risk_score&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">1644540480000</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;in_progress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ticket_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Daily Summary: Inbound Suspicious Connections&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ti_tcp_incoming&quot;</span><span class="p">,</span>
        <span class="s2">&quot;update_time&quot;</span><span class="p">:</span> <span class="mi">1644642690000</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;appliance_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="s2">&quot;a@a.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;sec&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sec.exploit&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;[Device 02a1d541ff800000](#/metrics/devices/c708d037ae5a46b69ec4dcbf7e4555e5.02a1d541ff800000/overview?from=1646741073</span><span class="se">\u0026</span><span class="s2">interval_type=DT</span><span class="se">\u0026</span><span class="s2">until=1646741073) received a Remote Desktop Protocol (RDP) connection request that is consistent with a known vulnerability, also known as BlueKeep, in older versions of Microsoft Windows. This vulnerability allows an unauthenticated attacker to remotely run arbitrary code on an RDP server. The attacker can then tamper with data or install malware that could propagate to other Windows devices across the network. Investigate to determine if [Device 02a1d541ff800000](#/metrics/devices/c708d037ae5a46b69ec4dcbf7e4555e5.02a1d541ff800000/overview?from=1646741073</span><span class="se">\u0026</span><span class="s2">interval_type=DT</span><span class="se">\u0026</span><span class="s2">until=1646741073) is hosting a version affected by CVE-2019-0708: Windows 7, Windows XP, Windows Vista, Windows Server 2003, and Windows Server 2008.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="mi">1646741073962</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">79</span><span class="p">,</span>
        <span class="s2">&quot;is_user_created&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;mitre_tactics&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;TA0008&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Lateral Movement&quot;</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://attack.mitre.org/tactics/TA0008&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;mitre_techniques&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;T1210&quot;</span><span class="p">,</span>
            <span class="s2">&quot;legacy_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;T1210&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Exploitation of Remote Services&quot;</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://attack.mitre.org/techniques/T1210&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;participants&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">194</span><span class="p">,</span>
            <span class="s2">&quot;object_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;victim&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">195</span><span class="p">,</span>
            <span class="s2">&quot;object_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipaddr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;object_value&quot;</span><span class="p">:</span> <span class="s2">&quot;216.218.206.66&quot;</span><span class="p">,</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;offender&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;client_port&quot;</span><span class="p">:</span> <span class="mi">45214</span><span class="p">,</span>
          <span class="s2">&quot;server_port&quot;</span><span class="p">:</span> <span class="mi">3389</span>
        <span class="p">},</span>
        <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;risk_score&quot;</span><span class="p">:</span> <span class="mi">98</span><span class="p">,</span>
        <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">1646741073962</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;in_progress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ticket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2529&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-0708 RDP Exploit Attempt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;cve_2019_0708&quot;</span><span class="p">,</span>
        <span class="s2">&quot;update_time&quot;</span><span class="p">:</span> <span class="mi">1646741073962</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_search_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">filter</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">status</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">in_progress</span><span class="se">\&quot;</span><span class="s2">]}}&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">948</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:53:38&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - wf_extrahop_rx_search_detections pre processing script ##</span>
<span class="c1"># Read CATEGORY_MAP and TYPE_MAP from workflow propertyself.</span>
<span class="c1"># Reverse the dict keys and values</span>
<span class="n">CATEGORY_MAP</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">category_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">TYPE_MAP</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">type_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">DOT_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;me&quot;</span><span class="p">,</span>
    <span class="s2">&quot;none&quot;</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">get_prop</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">prop</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">prop</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">DOT_PARAMS</span> <span class="k">else</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prop</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">prop</span> <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">DOT_PARAMS</span> <span class="k">else</span> <span class="n">prop</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="nb">filter</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">search_filter</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">category</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">detection_types</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_category</span><span class="p">:</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">CATEGORY_MAP</span><span class="p">[</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_category</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;extrahop_detection_types&quot;</span><span class="p">):</span>
    <span class="n">detection_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">TYPE_MAP</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_types</span><span class="p">]</span>

<span class="n">filter_props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;risk_score_min&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_risk_score_min</span><span class="p">),</span>
    <span class="s2">&quot;types&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">detection_types</span><span class="p">),</span>
    <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">category</span><span class="p">),</span>
    <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_assignee</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ticket_id&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_ticket_id</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">),</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_detection_status&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;extrahop_detection_status&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
    <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_detection_resolution&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;extrahop_detection_resolution&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="p">}</span>

<span class="nb">filter</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">filter_props</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>

<span class="k">if</span> <span class="nb">filter</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_detection_id</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The search filter and Detecion ID are not allowed at the same time.&quot;</span><span class="p">)</span>

    <span class="n">search_filter</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="nb">filter</span>
    <span class="p">}</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_search_filter</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">search_filter</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_update_time</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_update_time</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_update_time</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_mod_time</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_mod_time</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_mod_time</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_search_detections post processing script ##</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_search_detections&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Revealx search detections&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">search_detections_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DATA_TABLE</span> <span class="o">=</span> <span class="s2">&quot;extrahop_detections&quot;</span>

<span class="c1"># Read CATEGORY_MAP and TYPE_MAP from workflow property.</span>
<span class="n">CATEGORY_MAP</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">category_map</span>
<span class="n">TYPE_MAP</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">type_map</span>

<span class="n">LINKBACK_URL</span> <span class="o">=</span> <span class="s2">&quot;/extrahop/#/detections/detail/</span><span class="si">{}</span><span class="s2">&quot;</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">process_dets</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
    <span class="n">detection_url</span> <span class="o">=</span> <span class="n">make_linkback_url</span><span class="p">(</span><span class="n">det</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
    <span class="n">detection_url_html</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&lt;div&gt;&lt;b&gt;&lt;a target=&quot;blank&quot; href=&quot;</span><span class="si">{0}</span><span class="s1">&quot;&gt;</span><span class="si">{1}</span><span class="s1">&lt;/a&gt;&lt;/b&gt;&lt;/div&gt;&#39;</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">detection_url</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">detection_url</span> <span class="o">=</span> <span class="n">detection_url_html</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">appliance_id</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;appliance_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">assignee</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;assignee&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CATEGORY_MAP</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="n">CATEGORY_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;categories&quot;</span><span class="p">,</span> <span class="p">[])))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">det_description</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">det_id</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">is_user_created</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_user_created&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">end_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mod_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">update_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;update_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">detection_type</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">TYPE_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">detection_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">detection_type</span> <span class="ow">and</span> <span class="n">TYPE_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">detection_type</span><span class="p">)</span> <span class="k">else</span> <span class="n">detection_type</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">risk_score</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;risk_score&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resolution&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="c1">#newrow.ticket_url =  &#39;&lt;div&gt;&lt;b&gt;&lt;a target=&quot;blank&quot; href=&quot;{0}&quot;&gt;{1}&lt;/a&gt;&lt;/div&gt;&#39;.format(det.get(f2, None), det.get(f2, None).split(&#39;/&#39;)[-1])</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">ticket_id</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ticket_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">make_properties_string</span><span class="p">(</span><span class="n">det</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">participants</span> <span class="o">=</span> <span class="n">make_list_string</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;participants&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mitre_tactics</span> <span class="o">=</span> <span class="n">make_list_string</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mitre_tactics&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mitre_techniques</span> <span class="o">=</span> <span class="n">make_list_string</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mitre_techniques&quot;</span><span class="p">,</span> <span class="p">[]))</span>

<span class="k">def</span> <span class="nf">make_properties_string</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        det (json object): ExtraHop detection object</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : properties json object converted to a formatted string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">det</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s2">&quot;suspicious_ipaddr&quot;</span><span class="p">:</span>
            <span class="n">det_type</span> <span class="o">=</span> <span class="s2">&quot;Suspicious IP Addresses&quot;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">det_type</span><span class="p">)</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;/b&gt;</span><span class="si">{2}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tbl</span>

<span class="k">def</span> <span class="nf">make_list_string</span><span class="p">(</span><span class="n">detection_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        det (json object): ExtraHop detection object</span>

<span class="sd">    Returns:</span>
<span class="sd">        str : properties json object converted to a formatted string</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">tbl</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">detection_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;legacy_ids&quot;</span><span class="p">:</span>
                <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;/b&gt;</span><span class="si">{2}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span>
                <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;a target=&quot;blank&quot; href=&quot;</span><span class="si">{2}</span><span class="s1">&quot;&gt;</span><span class="si">{3}</span><span class="s1">&lt;/a&gt;&lt;/div&gt;&#39;</span> \
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tbl</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;div&gt;&lt;b&gt;</span><span class="si">{1}</span><span class="s1">:&lt;/b&gt;</span><span class="si">{2}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tbl</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">tbl</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;&quot;</span>

    <span class="k">return</span> <span class="n">tbl</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">make_linkback_url</span><span class="p">(</span><span class="n">det_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a url to link back to the detection.</span>

<span class="sd">    Args:</span>
<span class="sd">        det_id (str/int): id representing the detection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: completed url for linkback</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_console_url</span> <span class="o">+</span> <span class="n">LINKBACK_URL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">det_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">format_input_params</span><span class="p">(</span><span class="n">input_params</span><span class="p">):</span>
    <span class="n">input_params_formatted</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">input_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;extrahop_active_until&quot;</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;extrahop_active_from&quot;</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="n">input_params_formatted</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">input_params_formatted</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">input_params_formatted</span> <span class="o">=</span> <span class="n">format_input_params</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">dets</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Detections returned for SOAR &quot;</span> \
                    <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dets</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dets</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">det</span> <span class="ow">in</span> <span class="n">dets</span><span class="p">:</span>
                <span class="n">process_dets</span><span class="p">(</span><span class="n">det</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Extrahop Detections&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Reveal(x): Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to search detections for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters: &lt;br&gt; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;&quot;</span> \
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="n">input_params_formatted</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="c1"># Start execution</span>
<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-search-devices">
<h2>Function - Extrahop Reveal(x) search devices<a class="headerlink" href="#function-extrahop-reveal-x-search-devices" title="Link to this heading">#</a></h2>
<p>Search for devices information from Extrahop Reveal(x). Optional parameters search_filter, active_from, active_util, limit and offset.</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices " src="../_images/fn-extrahop-revealx-search-devices.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Retrieves a list of devices on the in the ExtraHop environment based on the parameters provided.</p></li>
<li><p>A filter in JSON is used to target the information retrieved.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Devices</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>The data table <code class="docutils literal notranslate"><span class="pre">Extrahop</span> <span class="pre">Devices</span></code> is updated.</p></li>
</ul>
<p>The playbook is initiated by the manual incident menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Devices</span> <span class="pre">(PB)</span></code>.</p>
<p>The following screenshot shows an example of the action inputs for the playbook:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices-action" src="../_images/fn-extrahop-revealx-search-devices-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices-action_2" src="../_images/fn-extrahop-revealx-search-devices-action_2.png" /></p>
<p>The following screenshot shows an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices-datatable" src="../_images/fn-extrahop-revealx-search-devices-datatable.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices-datatable_2" src="../_images/fn-extrahop-revealx-search-devices-datatable_2.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-devices-note" src="../_images/fn-extrahop-revealx-search-devices-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_from</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The beginning timestamp for the request. Return only devices active after this time. Time is expressed in milliseconds since the epoch. 0 indicates the time of the request.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_until</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The ending timestamp for the request. Return only devices active before this time.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_limit</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Limit the number of devices returned to the specified maximum number.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_offset</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) Skip the specified number of devices. This parameter is often combined with the limit parameter to paginate result sets.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_search_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The  filter criteria for Extrahop search results.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;analysis&quot;</span><span class="p">:</span> <span class="s2">&quot;advanced&quot;</span><span class="p">,</span>
        <span class="s2">&quot;analysis_level&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;auto_role&quot;</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cdp_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cloud_account&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cloud_instance_type&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;custom_criticality&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_make&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_model&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;custom_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Device 02f6b87341f00000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;device_class&quot;</span><span class="p">:</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dhcp_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;discover_time&quot;</span><span class="p">:</span> <span class="mi">1644418320000</span><span class="p">,</span>
        <span class="s2">&quot;discovery_id&quot;</span><span class="p">:</span> <span class="s2">&quot;02f6b87341f00000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;display_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Device 02f6b87341f00000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dns_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extrahop_id&quot;</span><span class="p">:</span> <span class="s2">&quot;02f6b87341f00000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;ipaddr4&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.159&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipaddr6&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;is_l3&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;last_seen_time&quot;</span><span class="p">:</span> <span class="mi">1647052200000</span><span class="p">,</span>
        <span class="s2">&quot;macaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;02:F6:B8:73:41:F0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mod_time&quot;</span><span class="p">:</span> <span class="mi">1649866540057</span><span class="p">,</span>
        <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;model_override&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;netbios_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;node_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;on_watchlist&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;parent_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subnet_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;user_mod_time&quot;</span><span class="p">:</span> <span class="mi">1644418537403</span><span class="p">,</span>
        <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;vlanid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;vpc_id&quot;</span><span class="p">:</span> <span class="n">null</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_search_filter&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">filter</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">operator</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">=</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">field</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ipaddr</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">operand</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">192.168.1.159</span><span class="se">\&quot;</span><span class="s2">}}&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">965</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:17:19&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">search_filters</span> <span class="o">=</span>  <span class="p">[</span>
    <span class="s2">&quot;extrahop_device_field&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_device_operand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_device_operator&quot;</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">search_filters</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A search filter and Device ID are not allowed at the same time.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_id</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_device_id</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_offset</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_search_devices post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_search_devices&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Search Devices&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">device_search_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="c1"># Display subset of fields</span>
<span class="n">DATA_TABLE</span> <span class="o">=</span> <span class="s2">&quot;extrahop_devices&quot;</span>
<span class="n">LINKBACK_URL</span> <span class="o">=</span> <span class="s2">&quot;/extrahop/#/metrics/devices/</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span>


<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">make_linkback_url</span><span class="p">(</span><span class="n">dev_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a url to link back to the endpoint alert, case, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        dev_id (str/int): id representing the device etc.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: completed url for linkback</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_console_url</span> <span class="o">+</span> <span class="n">LINKBACK_URL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_site_uuid</span><span class="p">,</span> <span class="n">dev_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">process_devs</span><span class="p">(</span><span class="n">dev</span><span class="p">):</span>
    <span class="c1"># Process a device result.</span>
    <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">devs_description</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">default_name</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">dns_name</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dns_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">ipaddr4</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ipaddr4&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">ipaddr6</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ipaddr6&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">macaddr</span>  <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;macaddr&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">vendor</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vendor&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">devs_id</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">extrahop_id</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrahop_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">activity</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">on_watchlist</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;on_watchlist&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">mod_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">user_mod_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_mod_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">discover_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discover_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">last_seen_time</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last_seen_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_url</span> <span class="o">=</span> <span class="n">make_linkback_url</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="s2">&quot;extrahop_id&quot;</span><span class="p">])</span>
    <span class="n">device_url_html</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&lt;div&gt;&lt;b&gt;&lt;a target=&quot;blank&quot; href=&quot;</span><span class="si">{1}</span><span class="s1">&quot;&gt;</span><span class="si">{2}</span><span class="s1">&lt;/a&gt;&lt;/b&gt;&lt;/div&gt;&#39;</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="n">device_url</span><span class="p">,</span> <span class="n">dev</span><span class="p">[</span><span class="s2">&quot;extrahop_id&quot;</span><span class="p">])</span>
    <span class="n">newrow</span><span class="o">.</span><span class="n">device_url</span> <span class="o">=</span> <span class="n">device_url_html</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Search devices failed with error &lt;b&gt;&#39;</span><span class="si">{1}</span><span class="s2">&#39;&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">CONTENT</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unicode</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">devs</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Devices returned for SOAR &quot;</span> \
                        <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">devs</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">devs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">devs</span><span class="p">:</span>
                    <span class="n">process_devs</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
                <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;The data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; has been updated&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DATA_TABLE</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to search devices for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-search-packets">
<h2>Function - Extrahop Reveal(x) search packets<a class="headerlink" href="#function-extrahop-reveal-x-search-packets" title="Link to this heading">#</a></h2>
<p>Search for and download packets stored on the ExtraHop Reveal(x) system.
Valid output types are: pcap, keylog_txt or zip.</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-packets " src="../_images/fn-extrahop-revealx-search-packets.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Does a packet search and download from an ExtraHop environment. The packet data can be downloaded in pcap, zip and keylog_txt output format.</p></li>
</ul>
<p><strong><em>NOTE:</em></strong> Extra configuration is required to use the keylog_txt output. <a class="reference external" href="https://docs.extrahop.com/current/session-key-download/">Session key download</a></p>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Packets</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>An attachment in the select output format is added to the SOAR incident.</p></li>
</ul>
<p>The playbook is initiated by the manual incident artifact menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Search</span> <span class="pre">Packets</span></code>.</p>
<p>The following screenshot shows an example of the action inputs for the playbook:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-packets-action" src="../_images/fn-extrahop-revealx-search-packets-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-search-packets-action_2" src="../_images/fn-extrahop-revealx-search-packets-action_2.png" /></p>
<p>The following screenshot shows an example of the attachments added by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-packets-attachment" src="../_images/fn-extrahop-revealx-search-packets-attachment.png" /></p>
<p>The following screenshot shows an example of notes added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-search-packets-note" src="../_images/fn-extrahop-revealx-search-packets-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_from</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The beginning timestamp for the request. Return only devices active after this time. Time is expressed in milliseconds since the epoch. 0 indicates the time of the request.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_active_until</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>(Optional) The ending timestamp for the request. Return only devices active before this time.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_always_return_body</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>If True return an empty packet capture file and an HTTP status of 200.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_bpf</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">host</span> <span class="pre">192.168.1.2</span>&#160; <span class="pre">dst</span> <span class="pre">host</span> <span class="pre">192.168.1.3</span></code></p></td>
<td><p>Filter packets with Berkeley Packet Filter syntax.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_ip1</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Return packets sent to or received by the specified IP address.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_ip2</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Return packets sent to or received by the specified IP address.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_limit_bytes</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The maximum number of bytes to return.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_limit_search_duration</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The maximum amount of time to run the packet search.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_output</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The output format. Valid values pcap , keylog_txt  and zip</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_port1</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Return packets sent from or received on the specified port.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_port2</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Return packets sent from or received on the specified port.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID for the incident in SOAR</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;attachment&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">b</span><span class="se">\u003e</span><span class="s2">extrahop 2022-05-11 16.00.00 to 2022-05-12 21.39.30 PDT.pcap</span><span class="se">\u003c</span><span class="s2">/b</span><span class="se">\u003e</span><span class="s2">&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_active_from&quot;</span><span class="p">:</span> <span class="mi">1652310000000</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_active_until&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_bpf&quot;</span><span class="p">:</span> <span class="s2">&quot;host 192.168.1.2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_ip1&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_ip2&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_limit_bytes&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_limit_search_duration&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_output&quot;</span><span class="p">:</span> <span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_port1&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_port2&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">4307</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">20395</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-05-17 11:24:39&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;IP Address&quot;</span> <span class="ow">or</span> <span class="n">artifact</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;DNS Name&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_bpf</span> <span class="o">=</span> <span class="s2">&quot;host </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">artifact</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;MAC Address&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_bpf</span> <span class="o">=</span> <span class="s2">&quot;ether host </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_from</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_active_until</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_output</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_output</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit_search_duration</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit_search_duration</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit_bytes</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_limit_bytes</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_ip1</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_ip1</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_port1</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_port1</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_ip2</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_ip2</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_port2</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_port2</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_search_packets post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_search_packets&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Search Packets&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">search_packets_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attachment&quot;</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully searched for packets for SOAR &quot;</span> \
                         <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Attachment &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;b&gt; added.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attachment&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Search for packets returned no results for SOAR &quot;</span> \
                        <span class="sa">u</span><span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;Status &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Search for packets failed for &quot;</span> \
                        <span class="sa">u</span><span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;Error &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="sa">u</span><span class="s2">&quot;to search packets for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span> \
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-update-detection">
<h2>Function - Extrahop Reveal(x) update detection<a class="headerlink" href="#function-extrahop-reveal-x-update-detection" title="Link to this heading">#</a></h2>
<p>Update a detection in Extrahop Reveal(x). Required parameter incident_id, detection_id, owner_id, plan_status, resolution. Optional parameters participants.
<img alt="screenshot: fn-extrahop-revealx-update-detection " src="../_images/fn-extrahop-revealx-update-detection.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Updates the status, resolution, ticket ID, assignee and optionally participants of an ExtraHop detection.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Detection</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>Closes an ExtraHop detection if the equivalent SOAR incident is closed.</p></li>
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
<li><p>A note is added to the ExtraHop detection.</p></li>
</ul>
<p><strong><em>NOTE:</em></strong> Get or add ExtraHop detection note will fail if <code class="docutils literal notranslate"><span class="pre">Detection</span> <span class="pre">Tracking</span></code> is enabled on ExtraHop but the playbook should still complete.</p>
<p>The playbook is initiated by an automatic incident menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Detection</span> <span class="pre">(PB)</span></code></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-update-detection-note" src="../_images/fn-extrahop-revealx-update-detection-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Extrahop detection ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_participants</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;id&quot;:</span> <span class="pre">0,</span> <span class="pre">&quot;usernames&quot;:</span> <span class="pre">[],</span> <span class="pre">&quot;origins&quot;:</span> <span class="pre">[]</span> <span class="pre">}</span></code></p></td>
<td><p>A list of devices and applications associated with a detection.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID for the incident in SOAR</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">soar_inc_owner_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">soar_inc_plan_status</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>SOAR incident status</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">soar_inc_resolution_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>SOAR incident resolution</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_detection_id&quot;</span><span class="p">:</span> <span class="mi">71</span><span class="p">,</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">3235</span><span class="p">,</span>
    <span class="s2">&quot;soar_inc_owner_id&quot;</span><span class="p">:</span> <span class="s2">&quot;a@a.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;soar_inc_plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="s2">&quot;soar_inc_resolution_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1084</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:21:32&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_detection_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">extrahop_detection_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">soar_inc_owner_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">owner_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">soar_inc_plan_status</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">plan_status</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">soar_inc_resolution_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_update_detection post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_update_detection&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Update Detection&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">update_detection_result</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
            <span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;update_detection_ok&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully updated the detection status for SOAR &quot;</span> \
                        <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;failed&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to update the detection status for &quot;</span> \
                        <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Update detection status failed with unexpected &quot;</span> \
                        <span class="s2">&quot;response for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to update the detection status &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for SOAR function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-extrahop-reveal-x-update-watchlist">
<h2>Function - Extrahop Reveal(x) update watchlist<a class="headerlink" href="#function-extrahop-reveal-x-update-watchlist" title="Link to this heading">#</a></h2>
<p>Add or remove devices from the watchlist on Extrahop Reveal(x). Required parameter assign or unassign comma-seperated list of devices.</p>
<p><img alt="screenshot: fn-extrahop-revealx-update-watchlist " src="../_images/fn-extrahop-revealx-update-watchlist.png" /></p>
<p>The function provides the following functionality.</p>
<ul class="simple">
<li><p>Adds or removes devices to or from the ExtraHop watchlist of the target ExtraHop environment.</p></li>
</ul>
<p>An example playbook that uses this SOAR function is <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Update</span> <span class="pre">Watchlist</span> <span class="pre">(PB)</span></code>.</p>
<ul class="simple">
<li><p>Adds a device or list ExtraHop devices to the watchlist of the target ExtraHop environment.</p></li>
<li><p>Refreshes the associated row of the data table  <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Devices</span></code>.</p></li>
<li><p>A note is added to the SOAR incident with the status of the action.</p></li>
</ul>
<p>The playbook is initiated by the manual data table menu item <code class="docutils literal notranslate"><span class="pre">ExtraHop</span> <span class="pre">Reveal(x):</span> <span class="pre">Assign</span> <span class="pre">Tag</span> <span class="pre">(PB)</span></code>.</p>
<p>The following screenshot shows an example of the action inputs for the playbook:</p>
<p><img alt="screenshot: fn-extrahop-revealx-update-watchlist-action" src="../_images/fn-extrahop-revealx-update-watchlist-action.png" /></p>
<p><img alt="screenshot: fn-extrahop-revealx-update-watchlist-action_2" src="../_images/fn-extrahop-revealx-update-watchlist-action_2.png" /></p>
<p>The following screenshot shows an example of the data table updated by the function:</p>
<p><img alt="screenshot: fn-extrahop-revealx-update-watchlist-datatable" src="../_images/fn-extrahop-revealx-update-watchlist-datatable.png" /></p>
<p>The following screenshot shows an example of a note added to a SOAR incident:</p>
<p><img alt="screenshot: fn-extrahop-revealx-update-watchlist-note" src="../_images/fn-extrahop-revealx-update-watchlist-note.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_assign</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma or newline seperated list of devices to assign to a watchlist.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrahop_unassign</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma or newline seperated list of devices to unassign from a watchlist.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_assign&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">719</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost.ibm.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-extrahop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-13 17:17:23&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dev_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">devs_id</span>
<span class="n">action</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_watchlist_action</span>
<span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_assign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dev_id</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;remove&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_unassign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dev_id</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - pb_extrahop_rx_update_watchlist post processing script ##</span>
<span class="c1">#  Globals</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;funct_extrahop_rx_update_watchlist&quot;</span>
<span class="n">PB_NAME</span> <span class="o">=</span> <span class="s2">&quot;Extrahop Reveal(x): Update Watchlist&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">update_watchlist_results</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="c1"># Processing</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">CONTENT</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
            <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;watchlist_updated&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Successfully updated the watchlist for SOAR &quot;</span> \
                        <span class="s2">&quot;function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for device &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">row</span><span class="o">.</span><span class="n">devs_id</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;failed&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Failed to update the watchlist for &quot;</span> \
                        <span class="s2">&quot;SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for device &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;conflict&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: A 409 (conflict) error was thrown while attempting  &quot;</span> \
                        <span class="s2">&quot;to update the watchlist for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for device &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">row</span><span class="o">.</span><span class="n">devs_id</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;Check if the sensor is being managed from the cloud-based service.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Update watchlist failed with unexpected &quot;</span> \
                        <span class="s2">&quot;response for SOAR function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for device &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">row</span><span class="o">.</span><span class="n">devs_id</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;ExtraHop Integration: Playbook &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; result returned while attempting &quot;</span> \
                     <span class="s2">&quot;to update the watchlist &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with parameters &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for device &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PB_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">row</span><span class="o">.</span><span class="n">devs_id</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-extrahop-script-add-artifact-from-device">
<h2>Script - ExtraHop script: add artifact from device<a class="headerlink" href="#script-extrahop-script-add-artifact-from-device" title="Link to this heading">#</a></h2>
<p>Add Devices data table field as a SOAR artifact.</p>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a SOAR artifact based on a dropdown which selects the corresponding data-table field.</span>
<span class="n">ARTIFACT_TYPE</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_artifact_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; (v4)&quot;</span> <span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; (v6)&quot;</span> <span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">PARAMS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;IP Address&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">ipaddr4</span><span class="p">,</span>
    <span class="s2">&quot;DNS Name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">dns_name</span><span class="p">,</span>
    <span class="s2">&quot;MAC Address&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">macaddr</span>
<span class="p">}</span>
<span class="c1"># Both IP address V4 or V6 will be added as type &quot;IP Address&quot;.</span>
<span class="k">if</span> <span class="s2">&quot;v6&quot;</span> <span class="ow">in</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">extrahop_artifact_type</span><span class="p">:</span>
    <span class="n">PARAMS</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;IP Address&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">ipaddr6</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">addArtifact</span><span class="p">(</span><span class="n">artifact_type</span><span class="p">,</span> <span class="n">artifact_value</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This method adds new artifacts to the incident derived from matches of the the regular expression</span>

<span class="sd">    :param artifact_type: The type of the artifact.</span>
<span class="sd">    :param artifact_value: - The value of the artifact.</span>
<span class="sd">    :param description: - the description of the artifact.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="n">artifact_type</span><span class="p">,</span> <span class="n">artifact_value</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">validate_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure required fields are present. Throw ValueError if not</span>
<span class="sd">    :param fields: Required fields.</span>
<span class="sd">    :param params: Data-table fields as parameters.</span>
<span class="sd">    :return: no return</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Required data-table field is missing or empty for artifact type: &#39;</span> <span class="o">+</span> <span class="n">f</span><span class="p">))</span>


<span class="c1"># Processing starts here</span>
<span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">validate_fields</span><span class="p">([</span><span class="n">ARTIFACT_TYPE</span><span class="p">],</span> <span class="n">PARAMS</span><span class="p">)</span>
<span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;Artifact from Device detected in the ExtraHop environment. Device name &#39;</span><span class="si">{}</span><span class="s2">&#39;, Device ID &#39;</span><span class="si">{}</span><span class="s2">&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">default_name</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">devs_id</span><span class="p">)</span>
<span class="n">addArtifact</span><span class="p">(</span><span class="n">ARTIFACT_TYPE</span><span class="p">,</span> <span class="n">PARAMS</span><span class="p">[</span><span class="n">ARTIFACT_TYPE</span><span class="p">],</span> <span class="n">desc</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-extrahop-script-detection-property-helper">
<h2>Script - ExtraHop script: detection property helper<a class="headerlink" href="#script-extrahop-script-detection-property-helper" title="Link to this heading">#</a></h2>
<p>Set ExtraHop detection properties as workflow property dicts.</p>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  ExtraHop - scr_extrahop_detection_property_helper script ##</span>
<span class="c1"># Used to share data with several workflows.</span>

<span class="c1"># Map of detection category  display name to name.</span>
<span class="n">CATEGORY_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sec.action&quot;</span><span class="p">:</span> <span class="s2">&quot;Actions on Objective&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.botnet&quot;</span><span class="p">:</span> <span class="s2">&quot;Botnet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.caution&quot;</span><span class="p">:</span> <span class="s2">&quot;Caution&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.command&quot;</span><span class="p">:</span> <span class="s2">&quot;Command &amp; Control&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.cryptomining&quot;</span><span class="p">:</span> <span class="s2">&quot;Cryptocurrency Mining&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.dos&quot;</span><span class="p">:</span> <span class="s2">&quot;Denial of Service&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.exfil&quot;</span><span class="p">:</span> <span class="s2">&quot;Exfiltration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.exploit&quot;</span><span class="p">:</span> <span class="s2">&quot;Exploitation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.hardening&quot;</span><span class="p">:</span> <span class="s2">&quot;Hardening&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.lateral&quot;</span><span class="p">:</span> <span class="s2">&quot;Lateral Movement&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.ransomware&quot;</span><span class="p">:</span> <span class="s2">&quot;Ransomware&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec.recon&quot;</span><span class="p">:</span> <span class="s2">&quot;Reconnaissance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sec&quot;</span><span class="p">:</span> <span class="s2">&quot;Security&quot;</span>
<span class="p">}</span>
<span class="c1"># Map of detection type name to  display name.</span>
<span class="n">TYPE_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;aaa_auth_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;AAA Auth Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;aaa_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in AAA Failed Login Attempts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;abnormally_large_database_response&quot;</span><span class="p">:</span> <span class="s2">&quot;Database Data Staging&quot;</span><span class="p">,</span>
    <span class="s2">&quot;abnormal_s3_upload&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Exfiltration to S3 Bucket&quot;</span><span class="p">,</span>
    <span class="s2">&quot;abnormal_user_creation&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual User Creation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;add_printer_driver&quot;</span><span class="p">:</span> <span class="s2">&quot;New Printer Driver Installation Request&quot;</span><span class="p">,</span>
    <span class="s2">&quot;anonymous_ftp&quot;</span><span class="p">:</span> <span class="s2">&quot;Anonymous FTP Auth Enabled&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apache_http_server_path_traversal&quot;</span><span class="p">:</span> <span class="s2">&quot;Apache HTTP Server Path Traversal Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apache_struts2_exploit_attempt&quot;</span><span class="p">:</span> <span class="s2">&quot;Apache Struts 2 Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;attempted_connections_dropped&quot;</span><span class="p">:</span> <span class="s2">&quot;Attempted Connections Dropped&quot;</span><span class="p">,</span>
    <span class="s2">&quot;aws_imds_proxying&quot;</span><span class="p">:</span> <span class="s2">&quot;AWS Instance Metadata Service (IMDS) Proxy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;aws_services_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;AWS Cloud Service Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bittorrent_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;BitTorrent Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;blacklisted_cert&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious SSL/TLS Certificates&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bloodhound_enumeration_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;BloodHound Enumeration Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;c2_web_beaconing&quot;</span><span class="p">:</span> <span class="s2">&quot;Command-and-Control Beaconing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;call_does_not_exist_error&quot;</span><span class="p">:</span> <span class="s2">&quot;Call Does Not Exist Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cifs_round_trip_time&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Transaction Delays&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cisco_cdp_vulnerabilities&quot;</span><span class="p">:</span> <span class="s2">&quot;Cisco CDP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;citrix_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Citrix Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cobalt_strike_c2_dns&quot;</span><span class="p">:</span> <span class="s2">&quot;Cobalt Strike DNS Beaconing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cobalt_strike_c2_http&quot;</span><span class="p">:</span> <span class="s2">&quot;Cobalt Strike C&amp;C HTTP Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cobalt_strike_c2_tls&quot;</span><span class="p">:</span> <span class="s2">&quot;Cobalt Strike C&amp;C SSL/TLS Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;crit_server_suspicious_download&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious File Download on Critical Server&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cryptocurrency_mining&quot;</span><span class="p">:</span> <span class="s2">&quot;Cryptocurrency Mining&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cryptomining_pool_dns_request&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Request for a Cryptocurrency Mining Pool&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cryptomining_pool_ssl_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;SSL/TLS Connection to a Cryptocurrency Mining Pool&quot;</span><span class="p">,</span>
    <span class="s2">&quot;customer_detection_template&quot;</span><span class="p">:</span> <span class="s2">&quot;Custom&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2017_12635&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2017-12635 Apache CouchDB Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2018_1111&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2018-1111 Red Hat DHCP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2018_13379&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2018-13379 Fortinet FortiOS Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2018_15961&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2018-15961 Adobe ColdFusion Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2018_7600&quot;</span><span class="p">:</span> <span class="s2">&quot;Drupal Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_0193&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-0193 Apache Solr Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_0604&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-0604 Microsoft SharePoint Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_0708&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-0708 RDP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_10149&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-10149 Exim Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_11510&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-11510 Pulse Connect Secure Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_11580&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-11580: Atlassian Crowd Vulnerability&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_15846&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-15846 Exim Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_17558&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-17558 Apache Solr Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_19781_exploit&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-19781 Citrix ADC and Gateway Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_19781_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-19781 Citrix ADC and Gateway Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_2725&quot;</span><span class="p">:</span> <span class="s2">&quot;Oracle WebLogic Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_8394&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-8394 Zoho ManageEngine Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2019_9670&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2019-9670 Synacor Zimbra Collaboration Suite Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_0601&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-0601 Windows CryptoAPI ECC Validation Vulnerability&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_0796&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-0796 Windows 10 SMBv3 Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_10189&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-10189 Zoho ManageEngine Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_11651&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-11651 Salt Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_12695&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-12695 UPnP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_1301&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-1301 SMBv1 Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_1350&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-1350 SIGRed Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_1472&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-1472 Zerologon Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_1472_exploit&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-1472 Zerologon Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_15505&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-15505 MobileIron Core and Connector Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_16898&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-16898 Windows TCP/IP Stack Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_16899&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-16899 Windows TCP/IP Stack Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_17051&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-17051 Windows NFS Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_1938&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-1938 Ghostcat Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_25577&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-25577 FreeBSD Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_25583&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-25583 FreeBSD Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_3952&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-3952 VMware vCenter Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_5902&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-5902 F5 BIG-IP Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_6207&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-6207 SAP Solution Manager Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_6287&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-6287 SAP RECON Vulnerability&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2020_7247&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-7247 OpenSMTPD Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_1497&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-1497 Cisco HyperFlex HX Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_1498&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-1498 Cisco HyperFlex HX Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_21972_exploit&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-21972 VMware vCenter Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_21972_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-21972 VMware vCenter Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_21974&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-21974 VMware ESXi OpenSLP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_21985&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-21985 VMware vCenter Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_22005&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-22005 VMware vCenter Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_22006&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-22006 VMware vCenter Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_22205&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-22205 GitLab CE and EE Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_22893&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-22893 Pulse Connect Secure Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_22986&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-22986 F5 BIG-IP and BIG-IQ Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_22991&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-22991 F5 BIG-IP Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_26084&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-26084 Atlassian Confluence Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_26432&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-26432 Windows NFS ONCRPC Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_26877&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-26877 Windows DNS Server Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_26897&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-26897 Windows DNS Server Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_28324&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-28324 Windows 10 SMBv3 Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_31166&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-31166 Windows HTTP Stack Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_31181&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-31181 Microsoft SharePoint Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_34467&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-34467 Microsoft SharePoint Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_34473&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-34473 Microsoft Exchange Server Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_34527&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-34527 Windows Print Spooler Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_35394&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-35394 Realtek SDK Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_35395&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-35395 Realtek SDK Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_38647&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-38647 OMIGOD Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_42321&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-42321 Microsoft Exchange Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_43798&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2021-43798 Grafana Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_44228_jndi_injection_attempt&quot;</span><span class="p">:</span> <span class="s2">&quot;Log4Shell JNDI Injection Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2021_44228_outbound_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;Outbound Log4Shell Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2022_0543&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2022-0543 Redis Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2022_1388&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2022-1388 F5 BIG-IP Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2022_21907&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2022-21907 Windows HTTP Stack Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2022_22947&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2022-22947 Spring Cloud Gateway Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cve_2022_22963&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2022-22963 Spring Cloud Function Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;database_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;Database Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;database_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Database Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;database_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Database Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;database_takeover&quot;</span><span class="p">:</span> <span class="s2">&quot;Database Takeover Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;database_transaction_failures&quot;</span><span class="p">:</span> <span class="s2">&quot;Database Transaction Failures&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_exfil_by_vpn&quot;</span><span class="p">:</span> <span class="s2">&quot;VPN Client Data Exfiltration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_exfiltration&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Exfiltration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_transfer_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Transfer Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;db_processing_spike&quot;</span><span class="p">:</span> <span class="s2">&quot;Poor Database Performance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dcom_lateral_movement&quot;</span><span class="p">:</span> <span class="s2">&quot;DCOM Remote Command Launch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dcshadow&quot;</span><span class="p">:</span> <span class="s2">&quot;DCShadow Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dcsync&quot;</span><span class="p">:</span> <span class="s2">&quot;DCSync Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_citrix_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Citrix Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_database_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Database Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_email_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Email Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_ftp_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed FTP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_http_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed HTTP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_ip_address_configuration&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed IP Address Configuration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_kerberos_auth&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Kerberos Auth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_kerberos_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Kerberos Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_ldap_auth&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed LDAP Auth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_ldap_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed LDAP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_memcache_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Memcache Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_redis_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Redis Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_web_services&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed Web Services&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delayed_wifi_auth&quot;</span><span class="p">:</span> <span class="s2">&quot;Delayed WiFi Auth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dhcp_decline_error&quot;</span><span class="p">:</span> <span class="s2">&quot;DHCP Decline Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dhcp_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;DHCP Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dhcp_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;DHCP Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dhcp_restart_error&quot;</span><span class="p">:</span> <span class="s2">&quot;DHCP Restart Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_internal_reverse_lookup_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Internal Reverse Lookup Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_lookup_failures&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Lookup Failures&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_rebind&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Rebinding&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_request_timeouts&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Request Timeouts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_timeouts&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Timeouts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_tunnel&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Tunnel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dns_zone_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Zone Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain_fronting&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Fronting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain_generation_algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Generation Algorithm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain_generation_algorithm_resolved&quot;</span><span class="p">:</span> <span class="s2">&quot;DGA Domain Resolution&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain_generation_algorithm_unresolved&quot;</span><span class="p">:</span> <span class="s2">&quot;DGA Domain Queries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain_trust_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Trust Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain_trusts_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Trusts Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;doublepulsar_rdp_implant&quot;</span><span class="p">:</span> <span class="s2">&quot;DoublePulsar RDP Implant&quot;</span><span class="p">,</span>
    <span class="s2">&quot;doublepulsar_rdp_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;DoublePulsar RDP Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;doublepulsar_smb_implant&quot;</span><span class="p">:</span> <span class="s2">&quot;DoublePulsar SMB/CIFS Implant Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;doublepulsar_smb_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;DoublePulsar SMB/CIFS Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Email Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Email Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email_mailbox_unavailable_error&quot;</span><span class="p">:</span> <span class="s2">&quot;Email Mailbox Unavailable Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email_service_unavailable_error&quot;</span><span class="p">:</span> <span class="s2">&quot;Email Service Unavailable Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;empire_c2_http&quot;</span><span class="p">:</span> <span class="s2">&quot;Empire C&amp;C HTTP Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;empire_c2_tls&quot;</span><span class="p">:</span> <span class="s2">&quot;Empire C&amp;C SSL/TLS Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eternalblue_exploit&quot;</span><span class="p">:</span> <span class="s2">&quot;EternalBlue Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;excessive_ip_fragmentation&quot;</span><span class="p">:</span> <span class="s2">&quot;Overlapping IP Fragmentation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experimental&quot;</span><span class="p">:</span> <span class="s2">&quot;Experimental Detection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experimentalMetric&quot;</span><span class="p">:</span> <span class="s2">&quot;Experimental Detection for Protocol Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experimentalMetricAnomaly&quot;</span><span class="p">:</span> <span class="s2">&quot;Experimental Detection for a Single Metric&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experimentalSource&quot;</span><span class="p">:</span> <span class="s2">&quot;Experimental Detection for a Single Source&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expired_cert&quot;</span><span class="p">:</span> <span class="s2">&quot;Expired SSL Server Certificates&quot;</span><span class="p">,</span>
    <span class="s2">&quot;external_db_req&quot;</span><span class="p">:</span> <span class="s2">&quot;Request to External Database Server&quot;</span><span class="p">,</span>
    <span class="s2">&quot;external_exec_file_download&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Executable File Download&quot;</span><span class="p">,</span>
    <span class="s2">&quot;external_ldap_req&quot;</span><span class="p">:</span> <span class="s2">&quot;Request to External LDAP Server&quot;</span><span class="p">,</span>
    <span class="s2">&quot;external_nfs_req&quot;</span><span class="p">:</span> <span class="s2">&quot;Request to External NFS Server&quot;</span><span class="p">,</span>
    <span class="s2">&quot;external_ssh_new_device&quot;</span><span class="p">:</span> <span class="s2">&quot;New SSH Device&quot;</span><span class="p">,</span>
    <span class="s2">&quot;file_access_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;File Access Failure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ftp_access_denied_error&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP Access Denied Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ftp_bad_syntax_error&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP Bad Syntax Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ftp_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ftp_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ftp_file_transfer_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP File Transfer Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ftp_not_logged_in_error&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP Not Logged in Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hacking_tools&quot;</span><span class="p">:</span> <span class="s2">&quot;Hacking Tool Domain Access&quot;</span><span class="p">,</span>
    <span class="s2">&quot;high_citrix_latency&quot;</span><span class="p">:</span> <span class="s2">&quot;High Citrix Latency&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_400_status_codes&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP 400 Status Codes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_bad_requests&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Bad Requests&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_desync_attack&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Desync Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_forbidden&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Forbidden&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_gateway_timeout_error&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Gateway Timeout Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_internal_error&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Internal Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_method_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Method Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_not_found&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Not Found&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_path_traversal&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Path Traversal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_plaintext_password_client&quot;</span><span class="p">:</span> <span class="s2">&quot;Credentials Sent over HTTP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_plaintext_password_server&quot;</span><span class="p">:</span> <span class="s2">&quot;Credentials Received over HTTP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http_service_unavailable_error&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Service Unavailable Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;icmp_tunnel&quot;</span><span class="p">:</span> <span class="s2">&quot;ICMP Tunnel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inbound_cobalt_strike_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;Inbound Connection from a Cobalt Strike IP Address&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inbound_tor_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;Inbound Tor Node Connections&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interactive_traffic_remote_desktop&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Interactive Traffic from a Remote Desktop&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interactive_traffic_shell&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Interactive Traffic from an External Endpoint&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interactive_traffic_ssh&quot;</span><span class="p">:</span> <span class="s2">&quot;Remote Control SSH Traffic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interrupted_citrix_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Interrupted Citrix Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kali_ssh_server_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Default Kali Linux SSH Keys&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kaseya_ml&quot;</span><span class="p">:</span> <span class="s2">&quot;REvil C&amp;C Activity (Kaseya Supply Chain)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kaseya_ml_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;REvil Suspicious Connection (Kaseya Supply Chain)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kaseya_vsa&quot;</span><span class="p">:</span> <span class="s2">&quot;Kaseya VSA Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_attack_tool_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Attack Tool Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_auth_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Auth Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_auth_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Auth Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_duplicate_sessions_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Duplicate Sessions Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_expired_password_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Expired Password Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_golden_ticket_attack&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Golden Ticket Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_invalid_ticket_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Invalid Ticket Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_policy_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Policy Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_revoked_credentials_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Revoked Credentials Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_service_unknown_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Service Unknown Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_silver_ticket_attack&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Silver Ticket Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_sync_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Sync Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_ticket_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Ticket Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_unknown_service_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Unknown Service Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_user_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos User Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kerberos_wrong_password_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Kerberos Wrong Password Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_all_workstation_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Workstation Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_as_rep_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;AS-REP Roasting Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_auth_error&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Auth Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_auth_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Auth Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_auth_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Auth Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_client_any_attribute_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Wildcard Query&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_computer_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Computer Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_gpo_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP GPO Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_invalid_credentials_error&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Invalid Credentials Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_object_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;All Object Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_operational_error&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Operational Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_protocol_error&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP Protocol Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ldap_spn_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;LDAP SPN Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;llmnr_poisoning&quot;</span><span class="p">:</span> <span class="s2">&quot;LLMNR Poisoning&quot;</span><span class="p">,</span>
    <span class="s2">&quot;local_admin_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Windows Account Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;memcache_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Memcache Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;memcache_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Memcache Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meterpreter_shell&quot;</span><span class="p">:</span> <span class="s2">&quot;Meterpreter C&amp;C Session&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_exchange_ssrf_rce&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft Exchange Server SSRF and RCE Exploit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msf_cert&quot;</span><span class="p">:</span> <span class="s2">&quot;Metasploit C&amp;C SSL/TLS Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_admin_access_check&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Remote Admin Connection Requests&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_alias_member_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Alias Member Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_domain_controller_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Controller Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_group_member_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Group Member Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_loggedon_user_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Logged-On User Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_netsession_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;User Session Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_network_share_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Network Share Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_rdp_session_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;RDP Session Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_registry_enumeration_via_winreg&quot;</span><span class="p">:</span> <span class="s2">&quot;Windows Registry Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_scheduled_task_via_atsvc&quot;</span><span class="p">:</span> <span class="s2">&quot;Scheduled Task Activity (ATSVC)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msrpc_scheduled_task_via_ITaskSchedulerService&quot;</span><span class="p">:</span> <span class="s2">&quot;Scheduled Task Activity (ITaskSchedulerService)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multiple_email_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiple Email Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multiple_ftp_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiple FTP Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multiple_kerberos_auth_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiple Kerberos Authentication Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multiple_ldap_auth_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiple LDAP Auth Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multiple_smb_cifs_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiple SMB/CIFS Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nbt_ns_poisoning&quot;</span><span class="p">:</span> <span class="s2">&quot;NBT-NS Poisoning&quot;</span><span class="p">,</span>
    <span class="s2">&quot;network_privilege_escalation&quot;</span><span class="p">:</span> <span class="s2">&quot;Network Privilege Escalation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_adws_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;New Active Directory Web Service (ADWS) Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_dhcp_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;New DHCP Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_doh_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;New DNS over HTTPS (DoH) Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_db_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External Database Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_iiop_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External IIOP Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_ldap_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External LDAP Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_nfs_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External NFS Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_rdp_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External RDP Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_rmi_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External Java RMI Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_ssh_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External SSH Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_telnet_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External Telnet Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_external_vnc_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External VNC Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_iot_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New External IoT Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_local_dns_server&quot;</span><span class="p">:</span> <span class="s2">&quot;New Local DNS Server Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_smb_cifs_file_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;New SMB/CIFS Executable File Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;new_telnet_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;New Telnet Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nfs_file_access_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;NFS File Access Failure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ntlm_relay&quot;</span><span class="p">:</span> <span class="s2">&quot;NTLM Relay Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ntlmv1_authentication&quot;</span><span class="p">:</span> <span class="s2">&quot;NTLMv1 Authentication&quot;</span><span class="p">,</span>
    <span class="s2">&quot;numerous_emails&quot;</span><span class="p">:</span> <span class="s2">&quot;Numerous Emails&quot;</span><span class="p">,</span>
    <span class="s2">&quot;onepercent_ml&quot;</span><span class="p">:</span> <span class="s2">&quot;Confirmed OnePercent Group Ransomware IOC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;outbound_cobalt_strike_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;Outbound Connection to a Cobalt Strike IP Address&quot;</span><span class="p">,</span>
    <span class="s2">&quot;outbound_socks_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;New Outbound SOCKS Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;outbound_tor_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;Outbound Tor Node Connections&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_citrix_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Citrix Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_database_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Database Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_email_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Email Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_ftp_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed FTP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_http_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed HTTP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_kerberos_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Kerberos Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_ldap_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed LDAP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_memcache_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Memcache Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwhelmed_redis_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Overwhelmed Redis Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ping_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;Ping Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;poor_aaa_performance&quot;</span><span class="p">:</span> <span class="s2">&quot;Poor AAA Performance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;poor_dhcp_performance&quot;</span><span class="p">:</span> <span class="s2">&quot;Poor DHCP Performance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;poor_http_performance&quot;</span><span class="p">:</span> <span class="s2">&quot;Poor HTTP Performance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;potential_covert_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Tunnel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;psexec_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;Remote Service Launch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ransomware_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;Ransomware Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rare_database_table_access&quot;</span><span class="p">:</span> <span class="s2">&quot;Rare Database Table Access&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rare_ssh_port&quot;</span><span class="p">:</span> <span class="s2">&quot;Rare SSH Port&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rdp_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;RDP Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rdp_unusual_location&quot;</span><span class="p">:</span> <span class="s2">&quot;Inbound Remote Desktop Traffic from an Unusual Location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;redis_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;Redis Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;redis_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Redis Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;remote_reg_setvalue&quot;</span><span class="p">:</span> <span class="s2">&quot;Remote Registry Modification&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reverse_ssh_connection&quot;</span><span class="p">:</span> <span class="s2">&quot;Reverse SSH Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rfb_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;VNC Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ripple20_dns_rce&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2020-11901 Ripple20 Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ripple20_icmp_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;Ripple20 ICMP Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ripple20_icmp_treck&quot;</span><span class="p">:</span> <span class="s2">&quot;Treck TCP/IP Network Stack Detected&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ripple20_ip_in_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;Ripple20 IP in IP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ripple20_ip_in_ip_ipaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;Ripple20 IP in IP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rpc_log_deletion_srv&quot;</span><span class="p">:</span> <span class="s2">&quot;Remote Log Deletion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rpc_remote_shutdown&quot;</span><span class="p">:</span> <span class="s2">&quot;Remote System Shutdown&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_domain_admin_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Admin Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_domain_computer_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Workstation Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_domain_group_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Group Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_domain_user_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain User Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_domain_workstation_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Domain Workstation Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_local_admin_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Local Admin Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;samr_local_user_enum&quot;</span><span class="p">:</span> <span class="s2">&quot;Local User Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;scheduled_task_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;Scheduled Task Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sensitive_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Sensitive Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;shellshock_dhcp&quot;</span><span class="p">:</span> <span class="s2">&quot;Shellshock DHCP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;shellshock_http&quot;</span><span class="p">:</span> <span class="s2">&quot;Shellshock HTTP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sip_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;SIP Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_autostart_path&quot;</span><span class="p">:</span> <span class="s2">&quot;File Transfer to Windows Autostart Path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_access_denied_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Access Denied Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_file_access_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS File Access Failure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_privileged_pipe&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Privileged Pipe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_share_enumeration&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Share Enumeration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_cifs_valid_login_errors&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Account Errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smb_named_pipe_beaconing&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Named Pipe Beaconing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smtp_helo_ehlo_buffer_overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Email Domain Length&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smtp_processing_spike&quot;</span><span class="p">:</span> <span class="s2">&quot;Poor SMTP Server Performance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;smtp_syntax_error&quot;</span><span class="p">:</span> <span class="s2">&quot;SMTP Syntax Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_email_traffic_volume&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in Email Traffic Volume&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_ldap_requests&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in LDAP Requests&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_rdp_sessions&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in RDP Sessions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_rfb_sessions&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in VNC Sessions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_round_trip_time&quot;</span><span class="p">:</span> <span class="s2">&quot;Transaction Delays&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_ssh_sessions&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in SSH Sessions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spike_in_telnet_connections&quot;</span><span class="p">:</span> <span class="s2">&quot;Spike in Telnet Connections&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spoofed_self_signed_ssl_certificate&quot;</span><span class="p">:</span> <span class="s2">&quot;Spoofed SSL/TLS Certificate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spring4shell&quot;</span><span class="p">:</span> <span class="s2">&quot;CVE-2022-22965 Spring4Shell Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sqli_attack&quot;</span><span class="p">:</span> <span class="s2">&quot;SQL Injection (SQLi) Attack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssh_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;SSH Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssh_unusual_location&quot;</span><span class="p">:</span> <span class="s2">&quot;Inbound SSH Traffic from an Unusual Location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssh_unusual_location_c2&quot;</span><span class="p">:</span> <span class="s2">&quot;Outbound SSH Traffic to an Unusual Location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssl_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;SSL Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stalled_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Stalled Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sudden_decrease_in_application_bandwidth&quot;</span><span class="p">:</span> <span class="s2">&quot;Sudden Decrease in Application Bandwidth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sudden_decrease_in_device_bandwidth&quot;</span><span class="p">:</span> <span class="s2">&quot;Sudden Decrease in Device Bandwidth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sudden_decrease_in_network_bandwidth&quot;</span><span class="p">:</span> <span class="s2">&quot;Sudden Decrease in Network Bandwidth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sunburst&quot;</span><span class="p">:</span> <span class="s2">&quot;SUNBURST C&amp;C Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;supernova_web_shell_command&quot;</span><span class="p">:</span> <span class="s2">&quot;SUPERNOVA Web Shell&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_cifs&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious SMB/CIFS Resource Accessed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_file_download_external&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious External File Download&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_file_download_internal&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious Internal File Download&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_ftp_data_reads&quot;</span><span class="p">:</span> <span class="s2">&quot;FTP Data Staging&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_ftp_download&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious FTP Download&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_hta_download&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual HTML Application (HTA) File Download&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_http_file&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious HTTP File Received&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_http_port&quot;</span><span class="p">:</span> <span class="s2">&quot;Non-standard HTTP Port&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_ja3_fingerprint&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious JA3 Fingerprint&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_new_device&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious New Device Detected&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_nfs_data_reads&quot;</span><span class="p">:</span> <span class="s2">&quot;NFS Data Staging&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_nfs_file_reads&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious NFS File Reads&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_nfs_file_share_access&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious NFS File Share Access&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_rdp_client&quot;</span><span class="p">:</span> <span class="s2">&quot;RDP Attack Tool Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_smb_cifs_data_reads&quot;</span><span class="p">:</span> <span class="s2">&quot;SMB/CIFS Data Staging&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_smb_cifs_file_reads&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious SMB/CIFS File Reads&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_smb_cifs_file_share_access&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious SMB/CIFS File Share Access&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_smb_cifs_file_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual SMB/CIFS Executable File Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_smb_named_pipe&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious SMB/CIFS Named Pipe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_tld&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious Top-level Domain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;suspicious_user_agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious User Agent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tcp_null_fin_or_xmas_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;TCP NULL, FIN, or XMAS Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tcp_syn_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;TCP SYN Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tcp_urg_flag_client&quot;</span><span class="p">:</span> <span class="s2">&quot;TCP Stack Exploit Attempt (Client)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tcp_urg_flag_server&quot;</span><span class="p">:</span> <span class="s2">&quot;TCP Stack Exploit Attempt (Server)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;telnet_password&quot;</span><span class="p">:</span> <span class="s2">&quot;Telnet Password&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ti_dns_host&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Client Request to a Suspicious Host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ti_http_host&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Client Request to a Suspicious Host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ti_http_uri&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP Client Request to a Suspicious URI&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ti_ssl_sni&quot;</span><span class="p">:</span> <span class="s2">&quot;SSL/TLS Connection to a Suspicious Host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ti_tcp_incoming&quot;</span><span class="p">:</span> <span class="s2">&quot;Inbound Suspicious Connections&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ti_tcp_outgoing&quot;</span><span class="p">:</span> <span class="s2">&quot;Outbound Suspicious Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tomcat_jsp_upload&quot;</span><span class="p">:</span> <span class="s2">&quot;Apache Tomcat JSP Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;udp_port_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;UDP Port Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unapproved_saas&quot;</span><span class="p">:</span> <span class="s2">&quot;Unapproved Cloud Service Access&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unauthorized_caller_error&quot;</span><span class="p">:</span> <span class="s2">&quot;Unauthorized Caller Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_new_external_host&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional External Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_new_internal_host&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional Internal Connection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_new_protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional Protocol Communication&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_rdp_behavior&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional RDP Behavior&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_rdp_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional RDP Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_rfb_behavior&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional VNC Behavior&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_rfb_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional VNC Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_smb_cifs_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional SMB/CIFS Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_ssh_behavior&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional SSH Behavior&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_ssh_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional SSH Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unconventional_telnet_data_transfer&quot;</span><span class="p">:</span> <span class="s2">&quot;Unconventional Telnet Data Transfer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unencrypted_zoom&quot;</span><span class="p">:</span> <span class="s2">&quot;Unencrypted Zoom Data&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unexpected_dropped_connections&quot;</span><span class="p">:</span> <span class="s2">&quot;Unexpected Dropped Connections&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unexpected_service_access&quot;</span><span class="p">:</span> <span class="s2">&quot;Unexpected Service Access&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unknown_public_dns_server&quot;</span><span class="p">:</span> <span class="s2">&quot;Unknown Public DNS Server&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unknown_s3_bucket_upload&quot;</span><span class="p">:</span> <span class="s2">&quot;Data Exfiltration to Unknown S3 Bucket&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unsafe_ldap_auth&quot;</span><span class="p">:</span> <span class="s2">&quot;Unsafe LDAP Authentication&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unusual_iot_protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual IoT Protocol Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unusual_kerberos_fingerprint&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Kerberos Fingerprint&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unusual_protocol_for_enterprise_software&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Protocol for Enterprise Software&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unusual_s3_download&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Download from S3 Bucket&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unusual_user_login_time&quot;</span><span class="p">:</span> <span class="s2">&quot;Unusual Login Time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vnc_unusual_location&quot;</span><span class="p">:</span> <span class="s2">&quot;Inbound VNC Traffic from an Unusual Location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;voip_call_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;VoIP Call Failure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;voip_unavailability_error&quot;</span><span class="p">:</span> <span class="s2">&quot;VoIP Unavailability Error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vpn_gateway_unusual_location&quot;</span><span class="p">:</span> <span class="s2">&quot;VPN Gateway Access from an Unusual Location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;weak_cipher&quot;</span><span class="p">:</span> <span class="s2">&quot;Weak Cipher Suites&quot;</span><span class="p">,</span>
    <span class="s2">&quot;weak_kerberos_encryption_attempt&quot;</span><span class="p">:</span> <span class="s2">&quot;Weak Kerberos Encryption&quot;</span><span class="p">,</span>
    <span class="s2">&quot;web_directory_scan&quot;</span><span class="p">:</span> <span class="s2">&quot;Web Directory Scan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;web_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Web Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;weblogic_admin_console_handle_rce&quot;</span><span class="p">:</span> <span class="s2">&quot;Oracle WebLogic Administration Console Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;weblogic_xml_deserialization&quot;</span><span class="p">:</span> <span class="s2">&quot;Oracle WebLogic Deserialization Exploit Attempt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;web_service_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;Web Service Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wifi_auth_issues&quot;</span><span class="p">:</span> <span class="s2">&quot;WiFi Auth Issues&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wmi_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;New WMI Method Launch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wmi_create_process&quot;</span><span class="p">:</span> <span class="s2">&quot;New WMI Process Creation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wmi_enumeration_query&quot;</span><span class="p">:</span> <span class="s2">&quot;New WMI Enumeration Query&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wordpress_brute_force&quot;</span><span class="p">:</span> <span class="s2">&quot;WordPress Brute Force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wsman_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;PowerShell Remoting Activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;xss_attack&quot;</span><span class="p">:</span> <span class="s2">&quot;Cross-Site Scripting (XSS) Attack&quot;</span>
<span class="p">}</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;category_map&quot;</span><span class="p">,</span> <span class="n">CATEGORY_MAP</span><span class="p">)</span>
    <span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;type_map&quot;</span><span class="p">,</span> <span class="n">TYPE_MAP</span><span class="p">)</span>
    <span class="n">script_inputs</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;category_map&quot;</span><span class="p">,</span> <span class="n">CATEGORY_MAP</span><span class="p">)</span>
    <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;type_map&quot;</span><span class="p">,</span> <span class="n">TYPE_MAP</span><span class="p">)</span>
    <span class="n">script_inputs</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="data-table-extrahop-activitymaps">
<h2>Data Table - ExtraHop Activitymaps<a class="headerlink" href="#data-table-extrahop-activitymaps" title="Link to this heading">#</a></h2>
<p><img alt="screenshot: dt-extrahop-activitymaps" src="../_images/dt-extrahop-activitymaps.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">#</a></h3>
<p>extrahop_activitymaps</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ams_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ams_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Mod time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mod_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Mode</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ams_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Owner</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">owner</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Rights</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rights</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Short code</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">short_code</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Show alert status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">show_alert_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Walks</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">walks</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Weighting</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">weighting</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-extrahop-detections">
<h2>Data Table - Extrahop Detections<a class="headerlink" href="#data-table-extrahop-detections" title="Link to this heading">#</a></h2>
<p><img alt="screenshot: dt-extrahop-detections" src="../_images/dt-extrahop-detections.png" />
<img alt="screenshot: dt-extrahop-detections_2" src="../_images/dt-extrahop-detections_2.png" />
<img alt="screenshot: dt-extrahop-detections_3" src="../_images/dt-extrahop-detections_3.png" /></p>
<section id="id1">
<h3>API Name:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>extrahop_detections</p>
</section>
<section id="id2">
<h3>Columns:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Appliance ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">appliance_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Assignee</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">assignee</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Categories</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">categories</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">det_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Detection URL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">detection_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>End time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">end_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Detection ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">det_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Is user created</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">is_user_created</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Mod time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mod_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Mitre tactics</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mitre_tactics</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Mitre techniques</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mitre_techniques</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Participants</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">participants</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Properties</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Resolution</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Risk score</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">risk_score</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Start time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">start_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Ticket ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ticket_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Ticket URL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ticket_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Title</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">title</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Update time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">update_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-extrahop-devices">
<h2>Data Table - ExtraHop Devices<a class="headerlink" href="#data-table-extrahop-devices" title="Link to this heading">#</a></h2>
<p><img alt="screenshot: dt-extrahop-devices" src="../_images/dt-extrahop-devices.png" />
<img alt="screenshot: dt-extrahop-devices_2" src="../_images/dt-extrahop-devices_2.png" /></p>
<section id="id3">
<h3>API Name:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>extrahop_devices</p>
</section>
<section id="id4">
<h3>Columns:<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Activity</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">activity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Default name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">default_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">devs_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Device URL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>Linkback to  device on ExtraHop.</p></td>
</tr>
<tr class="row-even"><td><p>Discovery time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">discover_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Display name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">display_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>DNS name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dns_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop  ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>ExtraHop Discovery ID</p></td>
</tr>
<tr class="row-even"><td><p>Device ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">devs_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p>REST API ID</p></td>
</tr>
<tr class="row-odd"><td><p>IPaddr4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ipaddr4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>IPaddr6</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ipaddr6</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Last seen time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">last_seen_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>MACaddr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">macaddr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Modification time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mod_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>On watchlist</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">on_watchlist</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Role</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">role</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>User modification time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user_mod_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Vendor</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vendor</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-extrahop-tags">
<h2>Data Table - Extrahop Tags<a class="headerlink" href="#data-table-extrahop-tags" title="Link to this heading">#</a></h2>
<p><img alt="screenshot: dt-extrahop-tags" src="../_images/dt-extrahop-tags.png" /></p>
<section id="id5">
<h3>API Name:<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>extrahop_tags</p>
</section>
<section id="id6">
<h3>Columns:<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tag_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Tag ID</p></td>
</tr>
<tr class="row-odd"><td><p>Mod time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mod_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>Tag modification time</p></td>
</tr>
<tr class="row-even"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Tag</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tag</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Tag name</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-extrahop-watchlist">
<h2>Data Table - ExtraHop Watchlist<a class="headerlink" href="#data-table-extrahop-watchlist" title="Link to this heading">#</a></h2>
<p><img alt="screenshot: dt-extrahop-watchlist" src="../_images/dt-extrahop-watchlist.png" /></p>
<section id="id7">
<h3>API Name:<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>extrahop_watchlist</p>
</section>
<section id="id8">
<h3>Columns:<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Display name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">display_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>IPaddr4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ipaddr4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>IPaddr6</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ipaddr6</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>MACaddr</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">macaddr</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">#</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Extrahop Assignee</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_assignee</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Extrahop Console URL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_console_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>ExtraHop base console url.</p></td>
</tr>
<tr class="row-even"><td><p>Extrahop Detection ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>Extrahop detecion ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Extrahop Detection Link</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_link</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>Link back to ExtraHop detection</p></td>
</tr>
<tr class="row-even"><td><p>Extrahop Detection Updated</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_detection_updated</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>Field to indicate detection has been updated</p></td>
</tr>
<tr class="row-odd"><td><p>Extrahop End Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_end_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Mod Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_mod_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Extrahop Risk Score</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_risk_score</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Extrahop Site name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_site_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>The name of the ExtraHop appliance.</p></td>
</tr>
<tr class="row-odd"><td><p>Extrahop Site UUID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_site_uuid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>The uuid of the ExtraHop appliance.</p></td>
</tr>
<tr class="row-even"><td><p>Extrahop Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Extrahop Ticket ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_ticket_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Update Notification</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">extrahop_update_notification</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">#</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Add Artifact (PB)</p></td>
<td><p>Add Devices data table field as a SOAR artifact.</p></td>
<td><p>extrahop_devices</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop Reveal(x): Assign Tag (PB)</p></td>
<td><p>Assign a tag to a list of devices ids for Extrahop Reveal(x).</p></td>
<td><p>extrahop_devices</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Create tag (PB)</p></td>
<td><p>Create a new tag for  ExtraHop Reveal(x).</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop Reveal(x): Get Activity Maps (PB)</p></td>
<td><p>Get activity maps information from Extrahop Reveal(x) and write to the ExtraHop Activitymaps data table.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Get Tags (PB)</p></td>
<td><p>Get tags information from Extrahop Reveal(x) and write to the ExtraHop Tags data table.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop Reveal(x): Get Watchlist (PB)</p></td>
<td><p>Retrieve all devices that are in the watchlist from Extrahop Reveal(x).</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Refresh Case (PB)</p></td>
<td><p>Manually refresh SOAR case with detection and device information from Extrahop Reveal(x).</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop Reveal(x): Search Detections (PB)</p></td>
<td><p>Search for detections information from Extrahop Reveal(x).</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Search Devices (PB)</p></td>
<td><p>Search for devices information from Extrahop Reveal(x) using a filter.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop Reveal(x): Search Packets (PB)</p></td>
<td><p>Search for and download packets stored on the ExtraHop Reveal(x) system and add as an attachment. Valid output types are: pcap, keylog_txt or zip.</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Update Detection (PB)</p></td>
<td><p>Automatic playbook to update ExtraHop detection if the status is changed on the associated  SOAR incident. Add a resolution note to the  detection.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ExtraHop Reveal(x): Update Case (PB)</p></td>
<td><p>Automatic playbook to update ExtraHop SOAR case with detection information from Extrahop.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ExtraHop Reveal(x): Update Watchlist (PB)</p></td>
<td><p>Add or remove an ExtraHop device to or from the watchlist.</p></td>
<td><p>extrahop_devices</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabledt</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="templates-for-soar-cases">
<h2>Templates for SOAR Cases<a class="headerlink" href="#templates-for-soar-cases" title="Link to this heading">#</a></h2>
<p>It may necessary to modify the templates used to create or close SOAR cases based on a customer’s required custom fields. Below are the default templates used which can be copied, modified and used with app_config’s
<code class="docutils literal notranslate"><span class="pre">soar_create_case_template</span></code> and <code class="docutils literal notranslate"><span class="pre">soar_close_case_template</span></code> settings to override the default templates.</p>
<section id="soar-close-incident-jinja">
<h3>soar_close_incident.jinja<a class="headerlink" href="#soar-close-incident-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for closing a SOAR incident from an ExtraHop detection. #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
  <span class="s2">&quot;resolution_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ resolution | soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="n">Unresolved</span><span class="s2">&quot;, &quot;</span><span class="n">no_action_taken</span><span class="s2">&quot;: &quot;</span><span class="n">Not</span> <span class="n">an</span> <span class="n">Issue</span><span class="s2">&quot;, &quot;</span><span class="n">action_taken</span><span class="s2">&quot;: &quot;</span><span class="n">Resolved</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;resolution_summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Closed by ExtraHop, Detection resolution = {{ resolution }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status | string |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_ticket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ ticket_id |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_assignee&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ assignee | string |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_update_notification&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;span style=&#39;color:red;&#39;&gt;The ExtraHop Detection has been closed.&lt;/span&gt;&lt;br&gt;&lt;div&gt;To refresh the incident run the playbook: Extrahop Reveal(x) Refresh Case.&lt;div/&gt;&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="soar-create-incident-jinja">
<h3>soar_create_incident.jinja<a class="headerlink" href="#soar-create-incident-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for creating a new SOAR incident from an ExtraHop detection. #}</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ExtraHop detection - {{ title }}&quot;</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># Remove escapes and backticks unnecessary for payload, introduced by api for some detections. #}</span>
  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;html&quot;</span><span class="p">,</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{{</span><span class="n">description</span> <span class="o">|</span> <span class="n">e</span> <span class="o">|</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">)</span>  <span class="o">|</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\_&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">replace</span> <span class="p">(</span><span class="s1">&#39;\.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">tojson</span><span class="p">}}</span>
  <span class="p">},</span>
  <span class="p">{</span><span class="c1"># start_date cannot be after discovered_date #}</span>
  <span class="s2">&quot;discovered_date&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">start_time</span> <span class="p">}},</span>
  <span class="s2">&quot;start_date&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">start_time</span> <span class="p">}},</span>
  <span class="p">{</span><span class="c1"># if detection users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
  <span class="p">{</span><span class="c1"># &quot;owner_id&quot;: &quot;{{ assignedTo|soar_substitute(&#39;{&quot;Automation&quot;: &quot;soar_user1@ent.com&quot;, &quot;defender_user2@co.com&quot;: &quot;soar_user2@ent.com&quot;, &quot;DEFAULT&quot;: &quot;default_user@ent.com&quot; }&#39;) }}&quot;, #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status|string|soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">acknowledged</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">in_progress</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">closed</span><span class="s2">&quot;: &quot;</span><span class="n">C</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="mf">1.0</span> <span class="o">&lt;=</span> <span class="n">risk_score</span> <span class="o">&lt;=</span> <span class="mi">30</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="mi">31</span> <span class="o">&lt;=</span> <span class="n">risk_score</span> <span class="o">&lt;=</span> <span class="mi">79</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_detection_id&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="nb">id</span> <span class="p">}},</span>
    <span class="s2">&quot;extrahop_mod_time&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">mod_time</span> <span class="p">}},</span>
    <span class="s2">&quot;extrahop_update_time&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">update_time</span> <span class="p">}},</span>
     <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">end_time</span> <span class="o">%</span><span class="p">}</span>
        <span class="s2">&quot;extrahop_end_time&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">end_time</span> <span class="p">}},</span>
     <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;extrahop_risk_score&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">risk_score</span> <span class="p">}},</span>
    <span class="s2">&quot;extrahop_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status | string |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_ticket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ ticket_id |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_assignee&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ assignee | string |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_detection_link&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;{{ detection_url }}&#39;&gt;ExtraHop detection&lt;/a&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_console_url&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ console_url }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_site_name&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ network.name }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_site_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ network.appliance_uuid }}&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;comments&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Created by ExtraHop from a detection.&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="soar-ticketid-incident-jinja">
<h3>soar_ticketid_incident.jinja<a class="headerlink" href="#soar-ticketid-incident-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for updating a SOAR incident ticket id when SOAR case linked to an ExtraHop detection. #}</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_ticket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ ticket_id }}&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="soar-update-incident-jinja">
<h3>soar_update_incident.jinja<a class="headerlink" href="#soar-update-incident-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for updating a SOAR incident from an ExtraHop detection. #}</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ExtraHop detection - {{ title }}&quot;</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># Remove escapes and backticks unnecessary for payload, introduced by api for some detections. #}</span>
  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;html&quot;</span><span class="p">,</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{{</span><span class="n">description</span> <span class="o">|</span> <span class="n">e</span> <span class="o">|</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">)</span>  <span class="o">|</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;\_&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">replace</span> <span class="p">(</span><span class="s1">&#39;\.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">tojson</span><span class="p">}}</span>
  <span class="p">},</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">end_time</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;end_date&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">end_time</span> <span class="p">}},</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="c1"># if detection users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
  <span class="p">{</span><span class="c1"># &quot;owner_id&quot;: &quot;{{ assignedTo|soar_substitute(&#39;{&quot;Automation&quot;: &quot;soar_user1@ent.com&quot;, &quot;defender_user2@co.com&quot;: &quot;soar_user2@ent.com&quot;, &quot;DEFAULT&quot;: &quot;default_user@ent.com&quot; }&#39;) }}&quot;, #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status|string|soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">acknowledged</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">in_progress</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">closed</span><span class="s2">&quot;: &quot;</span><span class="n">C</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="mf">1.0</span> <span class="o">&lt;=</span> <span class="n">risk_score</span> <span class="o">&lt;=</span> <span class="mi">30</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="mi">31</span> <span class="o">&lt;=</span> <span class="n">risk_score</span> <span class="o">&lt;=</span> <span class="mi">79</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;extrahop_update_time&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">update_time</span> <span class="p">}},</span>
    <span class="s2">&quot;extrahop_mod_time&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">mod_time</span> <span class="p">}},</span>
     <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">end_time</span> <span class="o">%</span><span class="p">}</span>
        <span class="s2">&quot;extrahop_end_time&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">end_time</span> <span class="p">}},</span>
     <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;extrahop_risk_score&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">risk_score</span> <span class="p">}},</span>
    <span class="s2">&quot;extrahop_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status | string |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_ticket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ ticket_id |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_assignee&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ assignee | string |soar_substitute(&#39;{&quot;</span><span class="kc">None</span><span class="s2">&quot;: &quot;</span><span class="kc">None</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extrahop_detection_updated&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">epoch_now</span> <span class="p">}},</span>
    <span class="s2">&quot;extrahop_update_notification&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;span style=&#39;color:red;&#39;&gt;The ExtraHop Detection has been updated.&lt;/span&gt;&lt;br&gt;&lt;div&gt;To refresh the case run the playbook: Extrahop Reveal(x): Refresh Case (PB).&lt;div/&gt;&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">#</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">#</a></h3>
<p>This is an IBM supported app. Please search <a class="reference external" href="https://ibm.com/mysupport">ibm.com/mysupport</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_geocoding/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Google Geocoding</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_exchange_online/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Microsoft Exchange Online</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ExtraHop</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li><a class="reference internal" href="#changes">1.1 Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#endpoint-developed-with">Endpoint Developed With</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#extrahop-standalone-sensor">ExtraHop standalone sensor</a></li>
<li><a class="reference internal" href="#extrahop-cloud-services">ExtraHop Cloud Services</a></li>
</ul>
</li>
<li><a class="reference internal" href="#permission">Permission</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
<li><a class="reference internal" href="#custom-layout">Custom Layout</a></li>
</ul>
</li>
<li><a class="reference internal" href="#poller-extrahop-escalate-detections">Poller - ExtraHop Escalate Detections</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-add-detection-note">Function - Extrahop Reveal(x) add detection note</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-assign-tag">Function - Extrahop Reveal(x) assign tag</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-create-tag">Function - Extrahop Reveal(x) create tag</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-get-activitymaps">Function - Extrahop Reveal(x) get activitymaps</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-get-detection-note">Function - Extrahop Reveal(x) get detection note</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-get-detections">Function - Extrahop Reveal(x) get detections</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-get-devices">Function - Extrahop Reveal(x) get devices</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-get-tags">Function - Extrahop Reveal(x) get tags</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-get-watchlist">Function - Extrahop Reveal(x) get watchlist</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-search-detections">Function - Extrahop Reveal(x) search detections</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-search-devices">Function - Extrahop Reveal(x) search devices</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-search-packets">Function - Extrahop Reveal(x) search packets</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-update-detection">Function - Extrahop Reveal(x) update detection</a></li>
<li><a class="reference internal" href="#function-extrahop-reveal-x-update-watchlist">Function - Extrahop Reveal(x) update watchlist</a></li>
<li><a class="reference internal" href="#script-extrahop-script-add-artifact-from-device">Script - ExtraHop script: add artifact from device</a></li>
<li><a class="reference internal" href="#script-extrahop-script-detection-property-helper">Script - ExtraHop script: detection property helper</a></li>
<li><a class="reference internal" href="#data-table-extrahop-activitymaps">Data Table - ExtraHop Activitymaps</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-extrahop-detections">Data Table - Extrahop Detections</a><ul>
<li><a class="reference internal" href="#id1">API Name:</a></li>
<li><a class="reference internal" href="#id2">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-extrahop-devices">Data Table - ExtraHop Devices</a><ul>
<li><a class="reference internal" href="#id3">API Name:</a></li>
<li><a class="reference internal" href="#id4">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-extrahop-tags">Data Table - Extrahop Tags</a><ul>
<li><a class="reference internal" href="#id5">API Name:</a></li>
<li><a class="reference internal" href="#id6">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-extrahop-watchlist">Data Table - ExtraHop Watchlist</a><ul>
<li><a class="reference internal" href="#id7">API Name:</a></li>
<li><a class="reference internal" href="#id8">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#templates-for-soar-cases">Templates for SOAR Cases</a><ul>
<li><a class="reference internal" href="#soar-close-incident-jinja">soar_close_incident.jinja</a></li>
<li><a class="reference internal" href="#soar-create-incident-jinja">soar_create_incident.jinja</a></li>
<li><a class="reference internal" href="#soar-ticketid-incident-jinja">soar_ticketid_incident.jinja</a></li>
<li><a class="reference internal" href="#soar-update-incident-jinja">soar_update_incident.jinja</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>