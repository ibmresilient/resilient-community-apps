<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Siemplify Auto Sync Case

## Function - Siemplify Sync Case

### API Name
`siemplify_sync_case`

### Output Name
``

### Message Destination
`fn_siemplify`

### Pre-Processing Script
```python
inputs.siemplify_incident_id = incident.id
inputs.siemplify_assigned_user = None
inputs.siemplify_environment = None
inputs.siemplify_case_id = incident.properties.siemplify_case_id
inputs.siemplify_alert_id = incident.properties.siemplify_alert_id
```

### Post-Processing Script
```python
PRIORITY_LOOKUP = {-1: "Informational", 40: "Low", 50:"Medium", 60:"Medium", 80:"High", 100:"Critical", "DEFAULT": "Medium"}

if results.success:
  case = results.content
  incident.properties.siemplify_case_id = case.get('id')
  incident.properties.siemplify_case_link = helper.createRichText("<a target='blank' href='{}'>{}</a>".format(case.get('siemplify_case_url'), case.get('title')))
  incident.properties.siemplify_is_important = case.get('isImportant')
  incident.properties.siemplify_stage = case.get('stage')
  incident.properties.siemplify_assignee = case.get('assignedUserName')
  incident.properties.siemplify_priority = PRIORITY_LOOKUP.get(case.get('priority'), str(case.get('priority')))
  incident.properties.siemplify_tags = ", ".join([tag['tag'] for tag in case.get('tags')])
  
  if results.content.get('alerts'):
    incident.properties.siemplify_alert_id = case['alerts'][0]['identifier']
  incident.addNote("Siemplify Sync Case {} created".format(case.get('id')))
else:
  incident.addNote("Siemplify Sync Case failed: {}".format(str(results.content)))
```

---

