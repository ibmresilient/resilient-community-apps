<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Siemplify Get Block List Entities

## Function - Siemplify: Get Blocklist Entities

### API Name
`siemplify_get_blocklist_entities`

### Output Name
`None`

### Message Destination
`fn_siemplify`

### Pre-Processing Script
```python
inputs.siemplify_limit = rule.properties.siemplify_limit_result if rule.properties.siemplify_limit_result else 100
inputs.siemplify_search = rule.properties.siemplify_search_term 
```

### Post-Processing Script
```python
from java.util import Date

current_dt = Date().getTime()

if results.success:
  if isinstance(results.content, list):
    entity_list = results.content
  else:
    entity_list = results.content.get("objectsList", {})
    
  for entity in entity_list:
    row = incident.addRow('siemplify_list_entries')
    row['report_date'] = current_dt
    row['list_name'] = 'Block List'
    row['entity'] = entity['entityIdentifier']
    row['entity_type'] = entity['entityType']
    row['environments'] = ", ".join(entity['environments'])
    row['entity_id'] = entity['id']
else:
  incident.addNote("Siemplify Get Blocklist Entities failed: {}".format(results.reason))

```

---

