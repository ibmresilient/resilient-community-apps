<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# SentinelOne: Add Agent to Data Table

## Function - SentinelOne: Get Agent Details

### API Name
`sentinelone_get_agent_details`

### Output Name
`None`

### Message Destination
`fn_sentinelone`

### Pre-Processing Script
```python
inputs.sentinelone_agent_id = incident.properties.sentinelone_agent_id
```

### Post-Processing Script
```python
from java.util import Date

note = u"<b>SentinelOne: Add Agent to Data Table: </b> \n"
content = results.get("content")
if content:
  data = content.get("data")
  if data:
    data_len = len(data)
    note = u"{0} {1} agent added to SentinelOne Agent data table.".format(note, data_len)
    for agent in data:
      agent_row = incident.addRow("sentinelone_agents_dt")
      agent_row.sentinelone_dt_query_date = Date()
      agent_row.sentinelone_dt_agent_id = agent.get("id")
      networkStatus = agent.get("networkStatus")
      if networkStatus == "connected":
        display_color = "green"
      else:
        display_color = "red"
      networkStatus = u"""<p style= "color:{color}">{status}</p>""".format(color=display_color, status=networkStatus)
      agent_row.sentinelone_dt_network_status = helper.createRichText(networkStatus)
      agent_row.sentinelone_dt_computername = agent.get("computerName")
      agent_row.sentinelone_dt_external_ip = agent.get("externalIp")
      agent_row.sentinelone_dt_site = agent.get("siteName")
      agent_row.sentinelone_dt_agent_version = agent.get("agentVersion")
      agent_row.sentinelone_dt_threat_count = agent.get("activeThreats")
      agent_row.sentinelone_dt_domain = agent.get("domain")
      agent_row.sentinelone_dt_os_name = agent.get("osName")
      agent_row.sentinelone_dt_uuid = agent.get("uuid")
      agent_row.sentinelone_dt_is_active = agent.get("isActive")
      agent_row.sentinelone_dt_registered = agent.get("registeredAt")
      agent_row.sentinelone_dt_created = agent.get("createdAt")
      agent_row.sentinelone_dt_updated = agent.get("updatedAt")
  else:
    note = u"{0} No data returned from function.".format(note)
else:
  note = u"{0} No content data returned from function.".format(note)
  
incident.addNote(helper.createRichText(note))
```

---

