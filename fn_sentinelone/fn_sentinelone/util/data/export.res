{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "export_date": 1694718039310,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sentinelone_agent_id",
      "hide_notification": false,
      "id": 354,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_agent_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sentinelone_agent_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "dbfe950b-d843-4105-ae4d-a586a96850f8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sentinelone_threat_analyst_verdict",
      "hide_notification": false,
      "id": 355,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_analyst_verdict",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sentinelone_threat_analyst_verdict",
      "tooltip": "",
      "type_id": 11,
      "uuid": "e0ed407a-e9e0-40f8-b46b-5167eab16a70",
      "values": [
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "false_positive",
          "properties": null,
          "uuid": "55fe7fb5-9ad9-4588-bc2b-cac8cf797a2c",
          "value": 136
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "suspicious",
          "properties": null,
          "uuid": "9baf9f94-0df8-4ba6-9044-3fc2a443dbba",
          "value": 137
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "true_positive",
          "properties": null,
          "uuid": "19108977-afe9-48ba-84fc-baab792216f3",
          "value": 138
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "undefined",
          "properties": null,
          "uuid": "84ca083b-c0f4-4f3e-a5bd-da8a3420920f",
          "value": 139
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sentinelone_threat_status",
      "hide_notification": false,
      "id": 356,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sentinelone_threat_status",
      "tooltip": "",
      "type_id": 11,
      "uuid": "e823e746-184b-4ae8-9b7e-ce7f6d99d19e",
      "values": [
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "resolved",
          "properties": null,
          "uuid": "8e342407-677a-450f-b7d1-3cb9a231f2be",
          "value": 140
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "in_progress",
          "properties": null,
          "uuid": "ad4044bf-fc24-4296-9911-4a946a3363cd",
          "value": 141
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "unresolved",
          "properties": null,
          "uuid": "e38a55ab-d981-4363-810c-2bf16d71fb91",
          "value": 142
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sentinelone_threat_id",
      "hide_notification": false,
      "id": 357,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sentinelone_threat_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "f0f85d50-0f6e-4a99-9b5c-a568c69772ce",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sentinelone_hash",
      "hide_notification": false,
      "id": 358,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_hash",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sentinelone_hash",
      "tooltip": "",
      "type_id": 11,
      "uuid": "43312564-a5a6-4694-9d9f-ec51b499f0d0",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sentinelone_note_text",
      "hide_notification": false,
      "id": 359,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_note_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sentinelone_note_text",
      "tooltip": "",
      "type_id": 11,
      "uuid": "6972b6e9-61b0-4a23-97e3-c76230d12f2e",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/incident_id",
      "hide_notification": false,
      "id": 292,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "780d2cdb-f5d8-4be5-81d6-93927c72eb34",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_mitigation_status_description",
      "hide_notification": false,
      "id": 319,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_mitigation_status_description",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Mitigation Status Description",
      "tooltip": "",
      "type_id": 0,
      "uuid": "927a8e24-a2e8-436c-a335-abb65e714761",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_threat_analyst_verdict",
      "hide_notification": false,
      "id": 320,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_analyst_verdict",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Analyst Verdict",
      "tooltip": "SentinelOne threat analyst verdict",
      "type_id": 0,
      "uuid": "d377bf25-737a-44f4-924b-8c6531e62ceb",
      "values": [
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "false_positive",
          "properties": null,
          "uuid": "79663344-be90-41da-8608-3ea99621f813",
          "value": 111
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "suspicious",
          "properties": null,
          "uuid": "368d2011-6ce0-460e-a7ee-195b7a9721e4",
          "value": 112
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "true_positive",
          "properties": null,
          "uuid": "82f19a63-c9a7-472f-a53e-b2c25bd3fcfd",
          "value": 113
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "undefined",
          "properties": null,
          "uuid": "e4b6021d-14ec-4aad-94dc-fe9d038d3471",
          "value": 114
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_confidence_level",
      "hide_notification": false,
      "id": 321,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_confidence_level",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Confidence Level",
      "tooltip": "",
      "type_id": 0,
      "uuid": "d88cd581-5fb3-4dce-8c97-42c5b391f72e",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_incident_status",
      "hide_notification": false,
      "id": 322,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_incident_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Incident Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "0d9638b2-0df7-4e20-bef5-627a3faf0aa3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_classification",
      "hide_notification": false,
      "id": 323,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_classification",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Classification",
      "tooltip": "",
      "type_id": 0,
      "uuid": "1ab10e4d-aac6-45d8-a647-b83a1693d085",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_threat_id",
      "hide_notification": false,
      "id": 324,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Threat Id",
      "tooltip": "",
      "type_id": 0,
      "uuid": "3961faa6-c6d0-4a0e-8588-dcc011e53ce4",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_threat_name",
      "hide_notification": false,
      "id": 325,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Threat Name",
      "tooltip": "",
      "type_id": 0,
      "uuid": "3ace162b-9529-419b-b91f-52e23e20f3fc",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_agent_id",
      "hide_notification": false,
      "id": 326,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_agent_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Agent Id",
      "tooltip": "",
      "type_id": 0,
      "uuid": "6b4ec4a9-2dc7-463a-aa64-d1bbfa36be43",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_threat_overview_url",
      "hide_notification": false,
      "id": 327,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_threat_overview_url",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": true,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Threat Overview URL",
      "tooltip": "",
      "type_id": 0,
      "uuid": "7c5a98c7-caeb-4b73-b90b-d89ad2731373",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sentinelone_mitigation_status",
      "hide_notification": false,
      "id": 328,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sentinelone_mitigation_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Mitigation Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "7f0a4b98-9245-4f0f-9c2e-16095776795a",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1692720239690,
      "description": {
        "content": "Abort a Disk Scan on an agent managed by SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Abort Disk Scan",
      "export_key": "sentinelone_abort_disk_scan",
      "id": 28,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694701596190,
      "name": "sentinelone_abort_disk_scan",
      "tags": [],
      "uuid": "25716252-8e8c-43a5-8dbb-f9137266bf70",
      "version": 2,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720239743,
      "description": {
        "content": "Connect an endpoint managed by Sentinel to the network.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Connect to Network",
      "export_key": "sentinelone_connect_to_network",
      "id": 29,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720239779,
      "name": "sentinelone_connect_to_network",
      "tags": [],
      "uuid": "517e7712-cf4f-42da-91a2-06d028dad318",
      "version": 1,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720239794,
      "description": {
        "content": "Disconnect an endpoint managed by SentinelOne from the network.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Disconnect From Network",
      "export_key": "sentinelone_disconnect_from_network",
      "id": 30,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720239833,
      "name": "sentinelone_disconnect_from_network",
      "tags": [],
      "uuid": "49a731e0-8b31-473a-9911-cccfb794e6c5",
      "version": 1,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720239849,
      "description": {
        "content": "Get details of a SentinelOne managed agent.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Get Agent Details",
      "export_key": "sentinelone_get_agent_details",
      "id": 31,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720239886,
      "name": "sentinelone_get_agent_details",
      "tags": [],
      "uuid": "3bc833b4-0545-4db6-8ede-515d7439279a",
      "version": 1,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720239902,
      "description": {
        "content": "Get the SentinelOne reputation of a hash.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Get Hash Reputation",
      "export_key": "sentinelone_get_hash_reputation",
      "id": 32,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720239938,
      "name": "sentinelone_get_hash_reputation",
      "tags": [],
      "uuid": "1cace8fb-a62d-4c3c-859a-71ad12b6fb1a",
      "version": 1,
      "view_items": [
        {
          "content": "43312564-a5a6-4694-9d9f-ec51b499f0d0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720239953,
      "description": {
        "content": "Get the details of a threat detected by SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Get Threat Details",
      "export_key": "sentinelone_get_threat_details",
      "id": 33,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720239990,
      "name": "sentinelone_get_threat_details",
      "tags": [],
      "uuid": "2a2f6e9e-0fda-428e-adc0-cf0e7ca833fd",
      "version": 1,
      "view_items": [
        {
          "content": "f0f85d50-0f6e-4a99-9b5c-a568c69772ce",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240007,
      "description": {
        "content": "Initiate a Full Disk scan on an agent managed by SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Initiate Disk Scan",
      "export_key": "sentinelone_initiate_disk_scan",
      "id": 34,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240048,
      "name": "sentinelone_initiate_disk_scan",
      "tags": [],
      "uuid": "3e5cb5d4-87c1-4d55-bc4e-917ebe781e6f",
      "version": 1,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240066,
      "description": {
        "content": "Resolve (close) a threat in SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Resolve Threat in SentinelOne",
      "export_key": "sentinelone_resolve_threat_in_sentinelone",
      "id": 35,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240105,
      "name": "sentinelone_resolve_threat_in_sentinelone",
      "tags": [],
      "uuid": "c7a26323-ba72-4ac7-a3fc-60b3abcfaca0",
      "version": 1,
      "view_items": [
        {
          "content": "780d2cdb-f5d8-4be5-81d6-93927c72eb34",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240122,
      "description": {
        "content": "Restart a endpoint managed by SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Restart Agent",
      "export_key": "sentinelone_restart_agent",
      "id": 36,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240162,
      "name": "sentinelone_restart_agent",
      "tags": [],
      "uuid": "e0b6e8bc-fd8f-4bc4-9131-8e49b07d9a7b",
      "version": 1,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240179,
      "description": {
        "content": "Send a note created in SOAR to corresponding SentinelOne threat.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Send SOAR Note to SentinelOne",
      "export_key": "sentinelone_send_soar_note_to_sentinelone",
      "id": 37,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240220,
      "name": "sentinelone_send_soar_note_to_sentinelone",
      "tags": [],
      "uuid": "fbf44fc5-ae3d-4e67-ad31-1b79fd87bdb8",
      "version": 1,
      "view_items": [
        {
          "content": "f0f85d50-0f6e-4a99-9b5c-a568c69772ce",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "6972b6e9-61b0-4a23-97e3-c76230d12f2e",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240237,
      "description": {
        "content": "Shutdown an agent managed by SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Shutdown Agent",
      "export_key": "sentinelone_shutdown_agent",
      "id": 38,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240277,
      "name": "sentinelone_shutdown_agent",
      "tags": [],
      "uuid": "41479530-59cd-432f-bc33-562dad5322db",
      "version": 1,
      "view_items": [
        {
          "content": "dbfe950b-d843-4105-ae4d-a586a96850f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240295,
      "description": {
        "content": "Query SentinelOne threat and add any new threat notes to the SOAR incident.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "SentinelOne: Update Notes From SentinelOne",
      "export_key": "sentinelone_update_notes_from_sentinelone",
      "id": 39,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240340,
      "name": "sentinelone_update_notes_from_sentinelone",
      "tags": [],
      "uuid": "351d4c78-2c26-40f5-889f-6111e408068d",
      "version": 1,
      "view_items": [
        {
          "content": "780d2cdb-f5d8-4be5-81d6-93927c72eb34",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f0f85d50-0f6e-4a99-9b5c-a568c69772ce",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1692720240358,
      "description": {
        "content": "Update the incidentStatus and analystVerdict of a threat in SentinelOne.",
        "format": "text"
      },
      "destination_handle": "fn_sentinelone",
      "display_name": "Sentinelone: Update Threat Status",
      "export_key": "sentinelone_update_threat_status",
      "id": 40,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692720240398,
      "name": "sentinelone_update_threat_status",
      "tags": [],
      "uuid": "174b4b88-28d3-4596-97af-abbb3aef87f3",
      "version": 1,
      "view_items": [
        {
          "content": "f0f85d50-0f6e-4a99-9b5c-a568c69772ce",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "e823e746-184b-4ae8-9b7e-ce7f6d99d19e",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "e0ed407a-e9e0-40f8-b46b-5167eab16a70",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 96,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1694718037475,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1694718037475,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "industries": null,
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "6a62b728-5d4e-462c-b5a4-bc95efa435b2"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_sentinelone",
      "name": "fn_sentinelone",
      "programmatic_name": "fn_sentinelone",
      "tags": [],
      "users": [
        "admin@example.com"
      ],
      "uuid": "8864c644-67aa-4bd4-a7d3-6e5896b469db"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_3563c338_9593_4b3f_a745_796931cbd3a1\" isExecutable=\"true\" name=\"playbook_3563c338_9593_4b3f_a745_796931cbd3a1\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0otf4wz\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Abort Disk Scan\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"25716252-8e8c-43a5-8dbb-f9137266bf70\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = row.sentinelone_dt_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"abort_scan_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0otf4wz\u003c/incoming\u003e\u003coutgoing\u003eFlow_06661nc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0otf4wz\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Write Abort Scan Results to a Note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"308b51c4-d2bd-47ce-9f35-3fb9380f9c54\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_06661nc\u003c/incoming\u003e\u003coutgoing\u003eFlow_03svtmj\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_06661nc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_03svtmj\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_03svtmj\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_3563c338_9593_4b3f_a745_796931cbd3a1\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_03svtmj\" id=\"Flow_03svtmj_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"372\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"404\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_06661nc\" id=\"Flow_06661nc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"288\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0otf4wz\" id=\"Flow_0otf4wz_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"288\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"404\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692725543009,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_3563c338_9593_4b3f_a745_796931cbd3a1",
      "description": {
        "content": "Abort a Full Disk Scan on an agent managed by SentinelOne.",
        "format": "text"
      },
      "display_name": "SentinelOne: Abort Disk Scan (PB)",
      "export_key": "sentinelone_abort_disk_scan_pb",
      "field_type_handle": "playbook_3563c338_9593_4b3f_a745_796931cbd3a1",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Abort Disk Scan (PB)",
        "export_key": "playbook_3563c338_9593_4b3f_a745_796931cbd3a1",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_3563c338_9593_4b3f_a745_796931cbd3a1",
        "uuid": "d8e38c32-2de9-46fa-b057-bc54b184e67c"
      },
      "has_logical_errors": false,
      "id": 24,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693239924293,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1692725713811,
          "description": "Write abort scan function results to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Write Abort Scan Results to a Note",
          "id": 32,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1692725713821,
          "name": "SentinelOne: Write Abort Scan Results to a Note",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_abort_disk_scan_pb",
          "programmatic_name": "sentinelone_abort_disk_scan_pb_sentinelone_write_abort_scan_results_to_a_note",
          "script_text": "results = playbook.functions.results.abort_scan_results\n\nso_inputs = results.get(\"inputs\")\nagent_id = so_inputs.get(\"sentinelone_agent_id\")\nnote = u\"\u003cb\u003eSentinelOne: Abort Full Disk Scan \u003c/b\u003e\u003cbr\u003e  SentinelOne Agent Id: {0}\".format(agent_id)\ncontent = results.get(\"content\")\nif content:\n  data = content.get(\"data\")\n  if data:\n    if int(data.get(\"affected\")) \u003c= 0:\n      note = u\"{0} Full Disk Scan was NOT aborted.\".format(note)\n    else:\n      note = u\"{0} Full Disk Scan aborted.\".format(note)\n  else:\n    note = u\"{0} Full Disk Scan was NOT aborted. No \u0027data\u0027 returned from function\".format(note)\nelse:\n    note = u\"{0} Full Disk Scan was NOT aborted. No content returned from function\".format(note)  \n\nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "308b51c4-d2bd-47ce-9f35-3fb9380f9c54"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_is_active",
              "method": "equals",
              "type": null,
              "value": true
            },
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "connected"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_abort_disk_scan_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_3563c338-9593-4b3f-a745-796931cbd3a1",
        "id": 26,
        "name": "playbook_3563c338_9593_4b3f_a745_796931cbd3a1",
        "type": "playbook",
        "uuid": "1b6b430e-ec4d-485a-bc2d-bb3bd496a9ad"
      },
      "tags": [],
      "type": "default",
      "uuid": "3563c338-9593-4b3f-a745-796931cbd3a1",
      "version": 10
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_agent_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 13,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_96a64463_72c2_4dae_b106_68987e03f1d2\" isExecutable=\"true\" name=\"playbook_96a64463_72c2_4dae_b106_68987e03f1d2\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_098e2l6\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Get Agent Details\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3bc833b4-0545-4db6-8ede-515d7439279a\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = incident.properties.sentinelone_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_agent_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_098e2l6\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ogdb4c\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_098e2l6\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Write Agent Details to Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"8849f75b-4c6a-4519-a230-a7c93bc3f87f\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ogdb4c\u003c/incoming\u003e\u003coutgoing\u003eFlow_1i2dmup\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1ogdb4c\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1i2dmup\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1i2dmup\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_96a64463_72c2_4dae_b106_68987e03f1d2\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1i2dmup\" id=\"Flow_1i2dmup_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"434\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ogdb4c\" id=\"Flow_1ogdb4c_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_098e2l6\" id=\"Flow_098e2l6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"434\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692720584835,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_96a64463_72c2_4dae_b106_68987e03f1d2",
      "description": {
        "content": "Add information from an agent managed by SentinelOne to the SentinelOne Agent data table.",
        "format": "text"
      },
      "display_name": "SentinelOne: Add Agent to Data Table (PB)",
      "export_key": "sentinelone_add_agent_to_data_table_pb",
      "field_type_handle": "playbook_96a64463_72c2_4dae_b106_68987e03f1d2",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Add Agent to Data Table (PB)",
        "export_key": "playbook_96a64463_72c2_4dae_b106_68987e03f1d2",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_96a64463_72c2_4dae_b106_68987e03f1d2",
        "uuid": "dd47047f-2907-4404-8187-a50c7c55a0ab"
      },
      "has_logical_errors": false,
      "id": 21,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694463294721,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1692721320217,
          "description": "",
          "enabled": false,
          "export_key": "SentinelOne: Write Agent Details to Data Table",
          "id": 29,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1694463292456,
          "name": "SentinelOne: Write Agent Details to Data Table",
          "object_type": "incident",
          "playbook_handle": "sentinelone_add_agent_to_data_table_pb",
          "programmatic_name": "sentinelone_add_agent_to_data_table_pb_sentinelone_write_agent_details_to_data_table",
          "script_text": "from datetime import datetime\nimport json\n\nresults = playbook.functions.results.get_agent_results\nsuccess = results.get(\"success\", False)\nif success:\n  note = \"\u003cb\u003eSentinelOne: Add Agent to Data Table (PB): \u003c/b\u003e \\n\"\n  content = results.get(\"content\", False)\n  if content:\n    data = content.get(\"data\", False)\n    if data:\n      data_len = len(data)\n      note = \"{0} {1} agent added to SentinelOne Agent data table.\".format(note, data_len)\n      for agent in data:\n        agent_row = incident.addRow(\"sentinelone_agents_dt\")\n        agent_row.sentinelone_dt_query_date = datetime.now()\n        agent_row.sentinelone_dt_agent_id = agent.get(\"id\")\n        networkStatus = agent.get(\"networkStatus\")\n        display_color = \"green\" if networkStatus ==\"connected\" else \"red\"\n        networkStatus = u\"\"\"\u003cp style= \"color:{color}\"\u003e{status}\u003c/p\u003e\"\"\".format(color=display_color, status=networkStatus)\n        agent_row.sentinelone_dt_network_status = helper.createRichText(networkStatus)\n        agent_row.sentinelone_dt_computername = agent.get(\"computerName\")\n        agent_row.sentinelone_dt_external_ip = agent.get(\"externalIp\")\n        agent_row.sentinelone_dt_site = agent.get(\"siteName\")\n        agent_row.sentinelone_dt_agent_version = agent.get(\"agentVersion\")\n        agent_row.sentinelone_dt_threat_count = agent.get(\"activeThreats\")\n        agent_row.sentinelone_dt_domain = agent.get(\"domain\")\n        agent_row.sentinelone_dt_os_name = agent.get(\"osName\")\n        agent_row.sentinelone_dt_uuid = agent.get(\"uuid\")\n        agent_row.sentinelone_dt_is_active = agent.get(\"isActive\")\n        agent_row.sentinelone_dt_registered = agent.get(\"registeredAt\")\n        agent_row.sentinelone_dt_created = agent.get(\"createdAt\")\n        agent_row.sentinelone_dt_updated = agent.get(\"updatedAt\")\n    else:\n      note = \"{0} No data returned from function.\".format(note)\n  else:\n    note = \"{0} No content data returned from function.\".format(note)\nelse:\n  note = \"{0} function did not return success.\".format(note)\n\nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "8849f75b-4c6a-4519-a230-a7c93bc3f87f"
        }
      ],
      "name": "sentinelone_add_agent_to_data_table_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_96a64463-72c2-4dae-b106-68987e03f1d2",
        "id": 23,
        "name": "playbook_96a64463_72c2_4dae_b106_68987e03f1d2",
        "type": "playbook",
        "uuid": "f2cb4850-7fb1-4b7c-8025-9dbe30b03f7b"
      },
      "tags": [],
      "type": "default",
      "uuid": "96a64463-72c2-4dae-b106-68987e03f1d2",
      "version": 17
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_cef9752c_b644_40ac_8854_457f28f86344\" isExecutable=\"true\" name=\"playbook_cef9752c_b644_40ac_8854_457f28f86344\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0hvjt5z\u003c/outgoing\u003e\u003c/startEvent\u003e\u003csequenceFlow id=\"Flow_0hvjt5z\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1cmiqdi\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"SentinelOne: Connect to Network\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"517e7712-cf4f-42da-91a2-06d028dad318\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = row.sentinelone_dt_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"connect_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0hvjt5z\u003c/incoming\u003e\u003coutgoing\u003eFlow_0kqv3y7\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0kqv3y7\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"SentinelOne: Update data table with Connect to Network results \"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"9016f826-c891-463e-948a-f6f2bd9c4ab4\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0kqv3y7\u003c/incoming\u003e\u003coutgoing\u003eFlow_1cmiqdi\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1cmiqdi\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_cef9752c_b644_40ac_8854_457f28f86344\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hvjt5z\" id=\"Flow_0hvjt5z_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0kqv3y7\" id=\"Flow_0kqv3y7_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1cmiqdi\" id=\"Flow_1cmiqdi_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"414\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"414\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"157.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"267.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692725904189,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_cef9752c_b644_40ac_8854_457f28f86344",
      "description": {
        "content": "Disconnect a SentinelOne managed endpoint from the network.",
        "format": "text"
      },
      "display_name": "SentinelOne: Connect Agent to Network (PB)",
      "export_key": "sentinelone_connect_agent_to_network_pb",
      "field_type_handle": "playbook_cef9752c_b644_40ac_8854_457f28f86344",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Connect Agent to Network (PB)",
        "export_key": "playbook_cef9752c_b644_40ac_8854_457f28f86344",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_cef9752c_b644_40ac_8854_457f28f86344",
        "uuid": "833bf533-25d1-4fc8-8f56-06e353fe878d"
      },
      "has_logical_errors": false,
      "id": 25,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693250500203,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693250464655,
          "description": "Update the agent data table Network Status with results of Connect to Network function. ",
          "enabled": false,
          "export_key": "SentinelOne: Update data table with Connect to Network results ",
          "id": 45,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693250464690,
          "name": "SentinelOne: Update data table with Connect to Network results ",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_connect_agent_to_network_pb",
          "programmatic_name": "sentinelone_connect_agent_to_network_pb_sentinelone_update_data_table_with_connect_to_network_results_",
          "script_text": "results = playbook.functions.results.connect_results\n\nso_inputs = results.get(\"inputs\")\nagent_id = so_inputs.get(\"sentinelone_agent_id\")\nnote = u\"\u003cb\u003eSentinelOne: Connect to Network \u003c/b\u003e\u003cbr\u003e  SentinelOne Agent Id: {0}\".format(agent_id)\ncontent = results.get(\"content\")\nif content:\n  data = content.get(\"data\")\n  if data:\n    if int(data.get(\"affected\")) \u003c= 0:\n      note = u\"{0} is NOT connected to network\".format(note)\n    else:\n      networkStatus = u\"\"\"\u003cp style= \"color:{color}\"\u003e{status}\u003c/p\u003e\"\"\".format(color=\"green\", status=\"connected\")\n      row[\"sentinelone_dt_network_status\"] = helper.createRichText(networkStatus)\n      note = u\"{0} is connected to network\".format(note)\n  else:\n    note = u\"{0} no data returned from function\".format(note)\nelse:\n    note = u\"{0} no content data returned from function\".format(note)  \n\nincident.addNote(helper.createRichText(note))\n",
          "tags": [],
          "uuid": "9016f826-c891-463e-948a-f6f2bd9c4ab4"
        },
        {
          "actions": [],
          "created_date": 1692726234273,
          "description": "Write disconnect from network results to a note and update the networkStatus in the Agent Data Table",
          "enabled": false,
          "export_key": "SentinelOne: Write Disconnect from Network Results",
          "id": 33,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1692726234283,
          "name": "SentinelOne: Write Disconnect from Network Results",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_connect_agent_to_network_pb",
          "programmatic_name": "sentinelone_connect_agent_to_network_pb_sentinelone_write_disconnect_from_network_results",
          "script_text": "results = playbook.functions.results.disconnect_results\n\nso_inputs = results.get(\"inputs\")\nagent_id = so_inputs.get(\"sentinelone_agent_id\")\nnote = u\"\u003cb\u003eSentinelOne: Disconnect From Network \u003c/b\u003e\u003cbr\u003e  SentinelOne Agent Id: {0}\".format(agent_id)\ncontent = results.get(\"content\")\nif content:\n  data = content.get(\"data\")\n  if data:\n    if int(data.get(\"affected\")) \u003c= 0:\n      note = u\"{0} was not disconnected from network\".format(note)\n    else:\n      networkStatus = u\"\"\"\u003cp style= \"color:{color}\"\u003e{status}\u003c/p\u003e\"\"\".format(color=\"red\", status=\"disconnected\")\n      row[\"sentinelone_dt_network_status\"] = helper.createRichText(networkStatus)      \n      note = u\"{0} is disconnected from network\".format(note)\n  else:\n    note = u\"{0} no data returned from function\".format(note)\nelse:\n    note = u\"{0} no content data returned from function\".format(note)  \n\nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "2f061767-9970-4a98-8074-33d5c9276726"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 3,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_is_active",
              "method": "equals",
              "type": null,
              "value": true
            },
            {
              "evaluation_id": 1,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "disconnected"
            },
            {
              "evaluation_id": 2,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "disconnecting"
            }
          ],
          "custom_condition": "(1 OR 2) AND 3",
          "logic_type": "advanced"
        },
        "view_items": []
      },
      "name": "sentinelone_connect_agent_to_network_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_cef9752c-b644-40ac-8854-457f28f86344",
        "id": 27,
        "name": "playbook_cef9752c_b644_40ac_8854_457f28f86344",
        "type": "playbook",
        "uuid": "1f01878c-7c4a-4416-952a-217730304e81"
      },
      "tags": [],
      "type": "default",
      "uuid": "cef9752c-b644-40ac-8854-457f28f86344",
      "version": 9
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_48614130_af03_4470_810d_9dc0aeed330f\" isExecutable=\"true\" name=\"playbook_48614130_af03_4470_810d_9dc0aeed330f\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0grk3o5\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Disconnect From Network\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"49a731e0-8b31-473a-9911-cccfb794e6c5\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = row.sentinelone_dt_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"disconnect_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0grk3o5\u003c/incoming\u003e\u003coutgoing\u003eFlow_1mfd309\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0grk3o5\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Write Disconnect from Network results \"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4a65e32f-d740-44de-b6b7-6b4e883847d2\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mfd309\u003c/incoming\u003e\u003coutgoing\u003eFlow_0v8rihs\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1mfd309\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0v8rihs\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0v8rihs\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_48614130_af03_4470_810d_9dc0aeed330f\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0v8rihs\" id=\"Flow_0v8rihs_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"404\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mfd309\" id=\"Flow_1mfd309_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0grk3o5\" id=\"Flow_0grk3o5_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"404\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693239500609,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_48614130_af03_4470_810d_9dc0aeed330f",
      "description": {
        "content": "Disconnect a SentinelOne managed endpoint from the network.",
        "format": "text"
      },
      "display_name": "SentinelOne: Disconnect Agent From Network (PB)",
      "export_key": "sentinelone_disconnect_agent_from_network_pb",
      "field_type_handle": "playbook_48614130_af03_4470_810d_9dc0aeed330f",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Disconnect Agent From Network (PB)",
        "export_key": "playbook_48614130_af03_4470_810d_9dc0aeed330f",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_48614130_af03_4470_810d_9dc0aeed330f",
        "uuid": "4882a495-88c4-4a92-803f-cc06eb7d3891"
      },
      "has_logical_errors": false,
      "id": 36,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693249901958,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693239876381,
          "description": "Update the Network Status column of the Agent data table and write results to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Write Disconnect from Network results ",
          "id": 44,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693249271619,
          "name": "SentinelOne: Write Disconnect from Network results ",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_disconnect_agent_from_network_pb",
          "programmatic_name": "sentinelone_disconnect_agent_from_network_pb_sentinelone_write_disconnect_from_network_results_",
          "script_text": "results = playbook.functions.results.disconnect_results\n\nnote = u\"\u003cb\u003eSentinelOne: Disconnect From Network \u003c/b\u003e\"\n\nif results.get(\"success\"):\n  so_inputs = results.get(\"inputs\")\n  agent_id = so_inputs.get(\"sentinelone_agent_id\")\n  note = \"{0}\u003cbr\u003e  SentinelOne Agent Id: {1}\".format(note, agent_id)\n  content = results.get(\"content\")\n  if content:\n    data = content.get(\"data\")\n    if data:\n      if int(data.get(\"affected\")) \u003c= 0:\n        note = \"{0} was not disconnected from network\".format(note)\n      else:\n        networkStatus = \"\"\"\u003cp style= \"color:{color}\"\u003e{status}\u003c/p\u003e\"\"\".format(color=\"red\", status=\"disconnected\")\n        row[\"sentinelone_dt_network_status\"] = helper.createRichText(networkStatus)      \n        note = \"{0} is disconnected from network\".format(note)\n    else:\n      note = \"{0} no data returned from function\".format(note)\n  else:\n    note = \"{0} no content data returned from function\".format(note)  \nelse:\n  note = \"{0} Disconnect from Network function did not return success\".format(note)\n  \nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "4a65e32f-d740-44de-b6b7-6b4e883847d2"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 3,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_is_active",
              "method": "equals",
              "type": null,
              "value": true
            },
            {
              "evaluation_id": 1,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "connected"
            },
            {
              "evaluation_id": 2,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "connecting"
            }
          ],
          "custom_condition": "(1 OR 2) AND 3",
          "logic_type": "advanced"
        },
        "view_items": []
      },
      "name": "sentinelone_disconnect_agent_from_network_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_48614130-af03-4470-810d-9dc0aeed330f",
        "id": 38,
        "name": "playbook_48614130_af03_4470_810d_9dc0aeed330f",
        "type": "playbook",
        "uuid": "589ae585-9aff-4920-b5e5-2b82dd17cea1"
      },
      "tags": [],
      "type": "default",
      "uuid": "48614130-af03-4470-810d-9dc0aeed330f",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66\" isExecutable=\"true\" name=\"playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_10y5qwg\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Get Hash Reputation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"1cace8fb-a62d-4c3c-859a-71ad12b6fb1a\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_hash = artifact.value\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_reputation_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_10y5qwg\u003c/incoming\u003e\u003coutgoing\u003eFlow_0j42d1a\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_10y5qwg\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Write get hash reputation results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7e793ee4-cc71-45c3-8ff4-88141d46573a\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0j42d1a\u003c/incoming\u003e\u003coutgoing\u003eFlow_09u8hej\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0j42d1a\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_09u8hej\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_09u8hej\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_10y5qwg\" id=\"Flow_10y5qwg_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0j42d1a\" id=\"Flow_0j42d1a_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_09u8hej\" id=\"Flow_09u8hej_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"424\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"424\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692726320862,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66",
      "description": {
        "content": "Get the SentinelOne hash reputation and write it to an incident note.",
        "format": "text"
      },
      "display_name": "SentinelOne: Get Hash Reputation (PB)",
      "export_key": "sentinelone_get_hash_reputation_pb",
      "field_type_handle": "playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Get Hash Reputation (PB)",
        "export_key": "playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66",
        "uuid": "226b98d2-368d-4177-a316-baf240e60f36"
      },
      "has_logical_errors": false,
      "id": 26,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692726628752,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1692726537398,
          "description": "Write get hash reputation results to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Write get hash reputation results to a note",
          "id": 34,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1692726537408,
          "name": "SentinelOne: Write get hash reputation results to a note",
          "object_type": "artifact",
          "playbook_handle": "sentinelone_get_hash_reputation_pb",
          "programmatic_name": "sentinelone_get_hash_reputation_pb_sentinelone_write_get_hash_reputation_results_to_a_note",
          "script_text": "results = playbook.functions.results.get_reputation_results\n\nnote = u\"\u003cb\u003eSentinelOne: Get Hash Reputation: \u003c/b\u003e\u003cbr\u003e\"\ncontent = results.get(\"content\")\ninputs = results.get(\"inputs\")\nhash_value = inputs.get(\"sentinelone_hash\")\nif content:\n  data = content.get(\"data\")\n  if data:\n    rank = data.get(\"rank\")\n    note = u\"{0} Hash \u003cb\u003e{1}\u003c/b\u003e has rank: \u003cb\u003e{2}\u003c/b\u003e\".format(note, hash_value, rank)\n  else:\n    note = u\"{0} No data returned from function.\".format(note)\nelse:\n  note = u\"{0} No content data returned from function.\".format(note)\n  \nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "7e793ee4-cc71-45c3-8ff4-88141d46573a"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Malware SHA-1 Hash"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_get_hash_reputation_pb",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_0c925aa4-6ef5-454b-a9d8-48bcfc1c1b66",
        "id": 28,
        "name": "playbook_0c925aa4_6ef5_454b_a9d8_48bcfc1c1b66",
        "type": "playbook",
        "uuid": "65640151-bf42-4f72-9835-e4963f1f1eaa"
      },
      "tags": [],
      "type": "default",
      "uuid": "0c925aa4-6ef5-454b-a9d8-48bcfc1c1b66",
      "version": 7
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0\" isExecutable=\"true\" name=\"playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0duzt1x\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Initiate Disk Scan\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3e5cb5d4-87c1-4d55-bc4e-917ebe781e6f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = row.sentinelone_dt_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"initiate_scan_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0duzt1x\u003c/incoming\u003e\u003coutgoing\u003eFlow_1h9l4im\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0duzt1x\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Write Initiate Disk Scan results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"deb2b20d-4c24-4f0b-a58e-aa87cffb236b\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1h9l4im\u003c/incoming\u003e\u003coutgoing\u003eFlow_13fuu6a\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1h9l4im\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_13fuu6a\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_13fuu6a\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0duzt1x\" id=\"Flow_0duzt1x_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1h9l4im\" id=\"Flow_1h9l4im_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_13fuu6a\" id=\"Flow_13fuu6a_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"424\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"424\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692726658809,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0",
      "description": {
        "content": "Initiate a full disk scan on an agent managed by SentinelOne.",
        "format": "text"
      },
      "display_name": "SentinelOne: Initiate Disk Scan (PB)",
      "export_key": "sentinelone_initiate_disk_scan_pb",
      "field_type_handle": "playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Initiate Disk Scan (PB)",
        "export_key": "playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0",
        "uuid": "7f6c8a5e-a451-401c-8ad9-dba21b6d9957"
      },
      "has_logical_errors": false,
      "id": 27,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1692726923101,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1692726875100,
          "description": "Write Initiate Disk Scan results to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Write Initiate Disk Scan results to a note",
          "id": 35,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1692726875110,
          "name": "SentinelOne: Write Initiate Disk Scan results to a note",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_initiate_disk_scan_pb",
          "programmatic_name": "sentinelone_initiate_disk_scan_pb_sentinelone_write_initiate_disk_scan_results_to_a_note",
          "script_text": "results = playbook.functions.results.initiate_scan_results\nso_inputs = results.get(\"inputs\")\nagent_id = so_inputs.get(\"sentinelone_agent_id\")\nnote = u\"\u003cb\u003eSentinelOne: Initiate Full Disk Scan \u003c/b\u003e\u003cbr\u003e  SentinelOne Agent Id: {0}\".format(agent_id)\ncontent = results.get(\"content\")\nif content:\n  data = content.get(\"data\")\n  if data:\n    if int(data.get(\"affected\")) \u003c= 0:\n      note = u\"{0} Full Disk Scan was NOT initiated.\".format(note)\n    else:\n      note = u\"{0} Full Disk Scan initiated.\".format(note)\n  else:\n    note = u\"{0} Full Disk Scan was NOT initiated. No \u0027data\u0027 returned from function\".format(note)\nelse:\n    note = u\"{0} Full Disk Scan was NOT initiated. No content returned from function\".format(note)  \n\nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "deb2b20d-4c24-4f0b-a58e-aa87cffb236b"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_is_active",
              "method": "equals",
              "type": null,
              "value": true
            },
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "connected"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_initiate_disk_scan_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_4f575019-4828-4e15-87d7-2a6e92cfc8f0",
        "id": 29,
        "name": "playbook_4f575019_4828_4e15_87d7_2a6e92cfc8f0",
        "type": "playbook",
        "uuid": "63d477c2-a0a4-4f47-8458-4b08e4a2e2d7"
      },
      "tags": [],
      "type": "default",
      "uuid": "4f575019-4828-4e15-87d7-2a6e92cfc8f0",
      "version": 10
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "changed_to",
              "type": null,
              "value": "Closed"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_incident_status",
              "method": "not_equals",
              "type": null,
              "value": "resolved"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e\" isExecutable=\"true\" name=\"playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1tv9a80\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Resolve Threat in SentinelOne\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c7a26323-ba72-4ac7-a3fc-60b3abcfaca0\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.incident_id = incident.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"resolve_threat_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1tv9a80\u003c/incoming\u003e\u003coutgoing\u003eFlow_13dp9rc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1tv9a80\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Write Resolve Threat results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"93ecc80b-7ce8-45e4-aaa8-00177fd2663d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_13dp9rc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ngry6m\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_13dp9rc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1ngry6m\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1ngry6m\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ngry6m\" id=\"Flow_1ngry6m_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"414\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_13dp9rc\" id=\"Flow_13dp9rc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1tv9a80\" id=\"Flow_1tv9a80_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"414\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692724391160,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e",
      "description": {
        "content": "Resolve a SentinelOne threat in SentinelOne.",
        "format": "text"
      },
      "display_name": "SentinelOne: Resolve Threat in SentinelOne (PB)",
      "export_key": "sentinelone_resolve_threat_in_sentinelone_pb",
      "field_type_handle": "playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Resolve Threat in SentinelOne (PB)",
        "export_key": "playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e",
        "uuid": "bd596463-a40d-42f9-8480-25474ee7fdf2"
      },
      "has_logical_errors": false,
      "id": 22,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694716123979,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1692724793085,
          "description": "Write the results of Resolve Threat in SentinelOne function to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Write Resolve Threat results to a note",
          "id": 30,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1694716121937,
          "name": "SentinelOne: Write Resolve Threat results to a note",
          "object_type": "incident",
          "playbook_handle": "sentinelone_resolve_threat_in_sentinelone_pb",
          "programmatic_name": "sentinelone_resolve_threat_in_sentinelone_pb_sentinelone_write_resolve_threat_results_to_a_note",
          "script_text": "results = playbook.functions.results.resolve_threat_results\n\ncontent = results.get(\"content\")\nsuccess = content.get(\"success\", False)\nthreat_id = content.get(\"threat_id\", None)\nif success:\n  noteText = u\u0027\u003cb\u003eSentinelOne: Resolve Threat in SentinelOne\u003c/b\u003e\u003cbr\u003e threatId {0} resolved.\u0027.format(threat_id)\n  incident.properties.sentinelone_incident_status = \"resolved\"\nelse:\n  noteText = u\u0027\u003cb\u003eSentinelOne: Resolve Threat in SentinelOne\u003c/b\u003e\u003cbr\u003e threatId {0}: check analystVerdict and incidentStatus in SentinelOne.\u0027.format(threat_id)\n\nincident.addNote(noteText)",
          "tags": [],
          "uuid": "93ecc80b-7ce8-45e4-aaa8-00177fd2663d"
        }
      ],
      "name": "sentinelone_resolve_threat_in_sentinelone_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_1a40d0bd-210a-4623-b9e6-a9c75ba9fb5e",
        "id": 24,
        "name": "playbook_1a40d0bd_210a_4623_b9e6_a9c75ba9fb5e",
        "type": "playbook",
        "uuid": "f573d1b2-d4f2-4f50-96f4-1e71dac076d9"
      },
      "tags": [],
      "type": "default",
      "uuid": "1a40d0bd-210a-4623-b9e6-a9c75ba9fb5e",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 6,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_b40b46aa_53b5_494b_9324_cb2b541e5574\" isExecutable=\"true\" name=\"playbook_b40b46aa_53b5_494b_9324_cb2b541e5574\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_15m6vbj\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Restart Agent\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"e0b6e8bc-fd8f-4bc4-9131-8e49b07d9a7b\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = incident.properties.sentinelone_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"restart_agent_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_15m6vbj\u003c/incoming\u003e\u003coutgoing\u003eFlow_0m2a7r7\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_15m6vbj\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0m2a7r7\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0m2a7r7\" sourceRef=\"ServiceTask_1\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_b40b46aa_53b5_494b_9324_cb2b541e5574\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0m2a7r7\" id=\"Flow_0m2a7r7_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"324\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15m6vbj\" id=\"Flow_15m6vbj_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"324\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693231402570,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_b40b46aa_53b5_494b_9324_cb2b541e5574",
      "description": {
        "content": "Restart an agent managed by SentinelOne.",
        "format": "text"
      },
      "display_name": "SentinelOne: Restart Agent (PB)",
      "export_key": "sentinelone_restart_agent_pb",
      "field_type_handle": "playbook_b40b46aa_53b5_494b_9324_cb2b541e5574",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Restart Agent (PB)",
        "export_key": "playbook_b40b46aa_53b5_494b_9324_cb2b541e5574",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_b40b46aa_53b5_494b_9324_cb2b541e5574",
        "uuid": "f1ef6f1e-93fa-4aed-adf6-a193a6224f9e"
      },
      "has_logical_errors": false,
      "id": 28,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693239979913,
      "local_scripts": [],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_is_active",
              "method": "equals",
              "type": null,
              "value": true
            },
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "connected"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_restart_agent_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_b40b46aa-53b5-494b-9324-cb2b541e5574",
        "id": 30,
        "name": "playbook_b40b46aa_53b5_494b_9324_cb2b541e5574",
        "type": "playbook",
        "uuid": "2bd9b776-9323-48b0-bcc5-6b708fb7d044"
      },
      "tags": [],
      "type": "default",
      "uuid": "b40b46aa-53b5-494b-9324-cb2b541e5574",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 10,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_55933303_af6a_4c75_a2a5_7ac777940095\" isExecutable=\"true\" name=\"playbook_55933303_af6a_4c75_a2a5_7ac777940095\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1bxkxo5\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Send SOAR Note to SentinelOne\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fbf44fc5-ae3d-4e67-ad31-1b79fd87bdb8\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_threat_id = incident.properties.sentinelone_threat_id\\ninputs.sentinelone_note_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"send_note_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1bxkxo5\u003c/incoming\u003e\u003coutgoing\u003eFlow_0meys1l\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1bxkxo5\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Add sent header to SOAR note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"162a63e2-28a2-4a7b-b6b7-03d86184690f\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0meys1l\u003c/incoming\u003e\u003coutgoing\u003eFlow_17ri8ji\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0meys1l\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_17ri8ji\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_17ri8ji\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_55933303_af6a_4c75_a2a5_7ac777940095\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_17ri8ji\" id=\"Flow_17ri8ji_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"384\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0meys1l\" id=\"Flow_0meys1l_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1bxkxo5\" id=\"Flow_1bxkxo5_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"384\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693231767738,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_55933303_af6a_4c75_a2a5_7ac777940095",
      "description": {
        "content": "Send a note created in SOAR to the corresponding SentinelOne threat as a threat note.",
        "format": "text"
      },
      "display_name": "SentinelOne: Send Note to SentinelOne Threat (PB)",
      "export_key": "sentinelone_send_note_to_sentinelone_threat_pb",
      "field_type_handle": "playbook_55933303_af6a_4c75_a2a5_7ac777940095",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Send Note to SentinelOne Threat (PB)",
        "export_key": "playbook_55933303_af6a_4c75_a2a5_7ac777940095",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_55933303_af6a_4c75_a2a5_7ac777940095",
        "uuid": "f42cf019-02a7-4e4d-b59e-ea63c7aaf055"
      },
      "has_logical_errors": false,
      "id": 29,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694610204658,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693232130916,
          "description": " Add sent header to SOAR note so it is only sent once.",
          "enabled": false,
          "export_key": "SentinelOne: Add sent header to SOAR note",
          "id": 36,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693248111954,
          "name": "SentinelOne: Add sent header to SOAR note",
          "object_type": "note",
          "playbook_handle": "sentinelone_send_note_to_sentinelone_threat_pb",
          "programmatic_name": "sentinelone_send_note_to_sentinelone_threat_pb_sentinelone_add_sent_header_to_soar_note",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.send_note_results\n\n# Edit note in SOAR to indicate it was sent to SentinelOne\nif results.get(\"success\"):\n  # Get the current time\n  dt_now = datetime.now()\n  \n  # Add header to note so we know it\u0027s been sent to S1 once\n  note.text = \"\u003cb\u003eSent to SentinelOne at {0}\u003c/b\u003e\u003cbr\u003e{1}\".format(dt_now, note.text.content)",
          "tags": [],
          "uuid": "162a63e2-28a2-4a7b-b6b7-03d86184690f"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Sent to SentinelOne at "
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_send_note_to_sentinelone_threat_pb",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_55933303-af6a-4c75-a2a5-7ac777940095",
        "id": 31,
        "name": "playbook_55933303_af6a_4c75_a2a5_7ac777940095",
        "type": "playbook",
        "uuid": "22a3e8a2-77f2-4763-96a2-5938bab3eeeb"
      },
      "tags": [],
      "type": "default",
      "uuid": "55933303-af6a-4c75-a2a5-7ac777940095",
      "version": 15
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "From SentinelOne"
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_47bec986_769f_4ce4_ba97_a2f766568601\" isExecutable=\"true\" name=\"playbook_47bec986_769f_4ce4_ba97_a2f766568601\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0feam4k\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Send SOAR Note to SentinelOne\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fbf44fc5-ae3d-4e67-ad31-1b79fd87bdb8\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_threat_id = incident.properties.sentinelone_threat_id\\ninputs.sentinelone_note_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"send_note_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0feam4k\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ev7vmx\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0feam4k\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Add Header to indicate note was sent to SentinelOne\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"518e8850-8a62-4d29-a7d1-baf3ace93147\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ev7vmx\u003c/incoming\u003e\u003coutgoing\u003eFlow_1j5gog2\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1ev7vmx\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1j5gog2\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1j5gog2\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_47bec986_769f_4ce4_ba97_a2f766568601\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1j5gog2\" id=\"Flow_1j5gog2_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"372\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"424\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ev7vmx\" id=\"Flow_1ev7vmx_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"288\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0feam4k\" id=\"Flow_0feam4k_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"639\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622\" y=\"288\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"654\" y=\"424\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1692724939695,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_47bec986_769f_4ce4_ba97_a2f766568601",
      "description": {
        "content": "Send a note created in SOAR to the corresponding SentinelOne threat as a threat note.",
        "format": "text"
      },
      "display_name": "SentinelOne: Send SOAR Note to SentinelOne (PB)",
      "export_key": "sentinelone_send_soar_note_to_sentinelone_pb",
      "field_type_handle": "playbook_47bec986_769f_4ce4_ba97_a2f766568601",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Send SOAR Note to SentinelOne (PB)",
        "export_key": "playbook_47bec986_769f_4ce4_ba97_a2f766568601",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_47bec986_769f_4ce4_ba97_a2f766568601",
        "uuid": "13b049d2-bbe5-402f-a5fe-4347fd31e82f"
      },
      "has_logical_errors": false,
      "id": 23,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694618315137,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1692725394527,
          "description": "Update note to indicate it was sent to SentinelOne.",
          "enabled": false,
          "export_key": "SentinelOne: Add Header to indicate note was sent to SentinelOne",
          "id": 31,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693247961629,
          "name": "SentinelOne: Add Header to indicate note was sent to SentinelOne",
          "object_type": "note",
          "playbook_handle": "sentinelone_send_soar_note_to_sentinelone_pb",
          "programmatic_name": "sentinelone_send_soar_note_to_sentinelone_pb_sentinelone_add_header_to_indicate_note_was_sent_to_sentinelone",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.send_note_results\n\n# Edit note in SOAR to indicate it was sent to SentinelOne\n#if results.get(\"success\"):\n  # Get the current time\n#  dt_now = datetime.now()\n#  note.text = u\"\u003cb\u003eSent to SentinelOne at {0}\u003c/b\u003e\u003cbr\u003e{1}\".format(dt_now, note.text.content)",
          "tags": [],
          "uuid": "518e8850-8a62-4d29-a7d1-baf3ace93147"
        }
      ],
      "name": "sentinelone_send_soar_note_to_sentinelone_pb",
      "object_type": "note",
      "status": "disabled",
      "tag": {
        "display_name": "Playbook_47bec986-769f-4ce4-ba97-a2f766568601",
        "id": 25,
        "name": "playbook_47bec986_769f_4ce4_ba97_a2f766568601",
        "type": "playbook",
        "uuid": "b7e42343-bc4b-4ef9-878c-ee64e6ddf6e1"
      },
      "tags": [],
      "type": "default",
      "uuid": "47bec986-769f-4ce4-ba97-a2f766568601",
      "version": 12
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58\" isExecutable=\"true\" name=\"playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_07evlnu\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Shutdown Agent\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"41479530-59cd-432f-bc33-562dad5322db\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = row.sentinelone_dt_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"shutdown_agent_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_07evlnu\u003c/incoming\u003e\u003coutgoing\u003eFlow_05ms2uc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_07evlnu\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1vz17y2\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"SentinelOne: Write shutdown agent results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"eea92321-26bf-4462-846e-d2df381cea6e\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_05ms2uc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1vz17y2\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_05ms2uc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1vz17y2\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_07evlnu\" id=\"Flow_07evlnu_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_05ms2uc\" id=\"Flow_05ms2uc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vz17y2\" id=\"Flow_1vz17y2_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"404\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"404\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693232464357,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58",
      "description": {
        "content": "Shutdown an agent managed by SentinelOne.",
        "format": "text"
      },
      "display_name": "SentinelOne: Shutdown Agent (PB)",
      "export_key": "sentinelone_shutdown_agent_pb",
      "field_type_handle": "playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Shutdown Agent (PB)",
        "export_key": "playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58",
        "uuid": "1e1ece2b-591c-48ca-b542-95a3230de9bd"
      },
      "has_logical_errors": false,
      "id": 30,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693240038848,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693232942685,
          "description": "Write the results of shutdown agent function to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Write shutdown agent results to a note",
          "id": 37,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693232942721,
          "name": "SentinelOne: Write shutdown agent results to a note",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_shutdown_agent_pb",
          "programmatic_name": "sentinelone_shutdown_agent_pb_sentinelone_write_shutdown_agent_results_to_a_note",
          "script_text": "results = playbook.functions.results.shutdown_agent_results\n\nif results.success:\n  so_inputs = results.get(\"inputs\")\n  agent_id = so_inputs.get(\"sentinelone_agent_id\")\n  note = \"\u003cb\u003eSentinelOne: Shutdown Agent \u003c/b\u003e\u003cbr\u003e  SentinelOne Agent Id: {0}\".format(agent_id)\n  content = results.get(\"content\")\n  if content:\n    data = content.get(\"data\")\n    if data:\n      if int(data.get(\"affected\")) \u003c= 0:\n        note = \"{0} Agent was NOT shutdown.\".format(note)\n      else:\n        note = \"{0} Agent shutdown initiated.\".format(note)\n    else:\n      note = \"{0} Agent shutdown was NOT initiated. No \u0027data\u0027 returned from function\".format(note)\n  else:\n    note = \"{0} Agent shutdown was NOT initiated. No content returned from function\".format(note)  \nelse:\n  note = \"{0} Agent shutdown was NOT initiated. Function did no return success\".format(note)  \n  \nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "eea92321-26bf-4462-846e-d2df381cea6e"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_is_active",
              "method": "equals",
              "type": null,
              "value": true
            },
            {
              "evaluation_id": null,
              "field_name": "sentinelone_agents_dt.sentinelone_dt_network_status",
              "method": "equals",
              "type": null,
              "value": "connected"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_shutdown_agent_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_494c0e8d-8cd2-4c46-b8b7-bf331d174d58",
        "id": 32,
        "name": "playbook_494c0e8d_8cd2_4c46_b8b7_bf331d174d58",
        "type": "playbook",
        "uuid": "8263f583-2a86-41cb-9be7-03a56fe877c5"
      },
      "tags": [],
      "type": "default",
      "uuid": "494c0e8d-8cd2-4c46-b8b7-bf331d174d58",
      "version": 9
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 6,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f\" isExecutable=\"true\" name=\"playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_16rp92e\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Get Agent Details\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3bc833b4-0545-4db6-8ede-515d7439279a\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = incident.properties.sentinelone_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_agent_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_16rp92e\u003c/incoming\u003e\u003coutgoing\u003eFlow_1cnp0xy\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_16rp92e\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Update Agent Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"e011505d-b789-4116-8c11-c8f566107caa\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1cnp0xy\u003c/incoming\u003e\u003coutgoing\u003eFlow_1a68xyy\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1cnp0xy\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1a68xyy\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1a68xyy\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1a68xyy\" id=\"Flow_1a68xyy_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"394\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1cnp0xy\" id=\"Flow_1cnp0xy_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_16rp92e\" id=\"Flow_16rp92e_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"620\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"654\" y=\"394\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693233468690,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f",
      "description": {
        "content": "Update the agent details in the SentinelOne Agent data table.",
        "format": "text"
      },
      "display_name": "SentinelOne: Update Agent in Data Table (PB)",
      "export_key": "sentinelone_update_agent_in_data_table_pb",
      "field_type_handle": "playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Update Agent in Data table (PB)",
        "export_key": "playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f",
        "uuid": "e7bb544a-fba5-4467-a1dd-a9c9fe791a27"
      },
      "has_logical_errors": false,
      "id": 31,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693249618354,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693233957337,
          "description": "Update agent data table and write results to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Update Agent Data Table",
          "id": 38,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693249615496,
          "name": "SentinelOne: Update Agent Data Table",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_update_agent_in_data_table_pb",
          "programmatic_name": "sentinelone_update_agent_in_data_table_pb_sentinelone_update_agent_data_table",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.update_agent_results\n\nnote = u\"\u003cb\u003eSentinelOne: Update Agent in Data Table: \u003c/b\u003e \\n\"\nif results.get(\"success\"):\n  content = results.get(\"content\")\n  if content:\n    data = content.get(\"data\")\n    if data:\n      for agent in data:\n        row.sentinelone_dt_query_date = datetime.now()\n        row.sentinelone_dt_agent_id = agent.get(\"id\")\n        networkStatus = agent.get(\"networkStatus\")\n        display_color = \"green\" if networkStatus == \"connected\" else \"red\"\n        networkStatus = u\"\"\"\u003cp style= \"color:{color}\"\u003e{status}\u003c/p\u003e\"\"\".format(color=display_color, status=networkStatus)\n        row.sentinelone_dt_network_status = helper.createRichText(networkStatus)\n        row.sentinelone_dt_computername = agent.get(\"computerName\")\n        row.sentinelone_dt_external_ip = agent.get(\"externalIp\")\n        row.sentinelone_dt_site = agent.get(\"siteName\")\n        row.sentinelone_dt_agent_version = agent.get(\"agentVersion\")\n        row.sentinelone_dt_threat_count = agent.get(\"activeThreats\")\n        row.sentinelone_dt_domain = agent.get(\"domain\")\n        row.sentinelone_dt_os_name = agent.get(\"osName\")\n        row.sentinelone_dt_uuid = agent.get(\"uuid\")\n        row.sentinelone_dt_is_active = agent.get(\"isActive\")\n        row.sentinelone_dt_registered = agent.get(\"registeredAt\")\n        row.sentinelone_dt_created = agent.get(\"createdAt\")\n        row.sentinelone_dt_updated = agent.get(\"updatedAt\")\n        note = \"{0} success.\".format(note)\n    else:\n      note = \"{0} No agent data returned from function.\".format(note)\n  else:\n    note = \"{0} No content data returned from function.\".format(note)\nelse:\n  note = \"{0} Get Agent Details function did not return success.\".format(note)\n  \nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "e011505d-b789-4116-8c11-c8f566107caa"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_update_agent_in_data_table_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_364b744a-dd86-4e4a-960b-b18f3ce7744f",
        "id": 33,
        "name": "playbook_364b744a_dd86_4e4a_960b_b18f3ce7744f",
        "type": "playbook",
        "uuid": "f454cf52-8873-429a-83e8-e297af6d4320"
      },
      "tags": [],
      "type": "default",
      "uuid": "364b744a-dd86-4e4a-960b-b18f3ce7744f",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 10,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9\" isExecutable=\"true\" name=\"playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1c8zhoq\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sentinelone: Update Threat Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"174b4b88-28d3-4596-97af-abbb3aef87f3\"\u003e{\"inputs\":{\"f0f85d50-0f6e-4a99-9b5c-a568c69772ce\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e823e746-184b-4ae8-9b7e-ce7f6d99d19e\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"8e342407-677a-450f-b7d1-3cb9a231f2be\"}},\"e0ed407a-e9e0-40f8-b46b-5167eab16a70\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"55fe7fb5-9ad9-4588-bc2b-cac8cf797a2c\"}}},\"pre_processing_script\":\"inputs.sentinelone_threat_id = incident.properties.sentinelone_threat_id\\ninputs.sentinelone_threat_status = playbook.inputs.sentinelone_threat_status\\ninputs.sentinelone_threat_analyst_verdict = playbook.inputs.sentinelone_threat_analyst_verdict\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_status_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1c8zhoq\u003c/incoming\u003e\u003coutgoing\u003eFlow_0clmfjg\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1c8zhoq\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1w7pguc\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"SentinelOne: Update Threat Status and Analyst Verdict results \"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"aa660a03-23ff-4474-b519-bc7df20bdc86\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0clmfjg\u003c/incoming\u003e\u003coutgoing\u003eFlow_1w7pguc\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0clmfjg\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1w7pguc\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1w7pguc\" id=\"Flow_1w7pguc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"424\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0clmfjg\" id=\"Flow_0clmfjg_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1c8zhoq\" id=\"Flow_1c8zhoq_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"424\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693234506309,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
      "description": {
        "content": "Update the Incident Status and Analyst Verdict of a threat in SentinelOne.  Write the results to a notes.",
        "format": "text"
      },
      "display_name": "SentinelOne: Update Analyst Verdict and Threat Status (PB)",
      "export_key": "sentinelone_update_analyst_verdict_and_threat_status",
      "field_type_handle": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Update Analyst Verdict and Threat Status (PB)",
        "export_key": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
        "fields": {
          "sentinelone_threat_analyst_verdict": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9/sentinelone_threat_analyst_verdict",
            "hide_notification": false,
            "id": 360,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sentinelone_threat_analyst_verdict",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Analyst Verdict",
            "tooltip": "Select the SentinelOne incidentStatus",
            "type_id": 1032,
            "uuid": "a0a6737f-6a25-4340-94a7-24d41d652ff2",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "true_positive",
                "properties": null,
                "uuid": "64f53350-18ba-42c3-861b-44bddd6f855d",
                "value": 152
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "undefined",
                "properties": null,
                "uuid": "be7f02fd-94ae-45a7-996f-aede109a9509",
                "value": 153
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "suspicious",
                "properties": null,
                "uuid": "ef921d57-1e3b-4af4-951c-9108f39d651e",
                "value": 154
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "false_positive",
                "properties": null,
                "uuid": "83055877-a965-41c3-9c4e-dc8a4769c278",
                "value": 155
              }
            ]
          },
          "sentinelone_threat_status": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9/sentinelone_threat_status",
            "hide_notification": false,
            "id": 361,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sentinelone_threat_status",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Threat Status",
            "tooltip": "",
            "type_id": 1032,
            "uuid": "01ff3cf2-9099-452f-ac58-2bffbae3c532",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "resolved",
                "properties": null,
                "uuid": "041c614f-72ab-47b2-84ad-57b19beaf062",
                "value": 156
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "in_progress",
                "properties": null,
                "uuid": "579804b5-0f15-426c-b475-3b01ba77b911",
                "value": 157
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "unresolved",
                "properties": null,
                "uuid": "09458ca7-86ee-4ef9-b00f-fd1cec8de5c7",
                "value": 158
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
        "uuid": "5182d939-f666-4744-acbf-b9ff1c9eda51"
      },
      "has_logical_errors": false,
      "id": 32,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694552905803,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693235242616,
          "description": "Write Status and Analyst Verdict results to a note.",
          "enabled": false,
          "export_key": "SentinelOne: Update Threat Status and Analyst Verdict results ",
          "id": 39,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693252914115,
          "name": "SentinelOne: Update Threat Status and Analyst Verdict results ",
          "object_type": "incident",
          "playbook_handle": "sentinelone_update_analyst_verdict_and_threat_status",
          "programmatic_name": "sentinelone_update_analyst_verdict_and_threat_status_script_update_threat_status_and_analyst_verdict_resultsentinelones_to_a_note_",
          "script_text": "results = playbook.functions.results.update_status_results\n\nnote = \"\u003cb\u003eSentinelOne: Update Threat Status \u003c/b\u003e\"\nif results.get(\"success\"):\n  content = results.get(\"content\")\n  threat_id = content.get(\"threat_id\")\n  success_verdict = content.get(\"success_verdict\")\n  success_status = content.get(\"success_status\")\n  status = content.get(\"threat_status\")\n  verdict = content.get(\"threat_analyst_verdict\")\n  note = \"{0}\u003e\u003cbr\u003e  SentinelOne Threat Id: {1}\u003cbr\u003e\".format(note, threat_id)\n  content = results.get(\"content\")\n  if success_verdict and success_status:\n    note = \"{0} analystVerdict set to \u003cb\u003e{1}\u003c/b\u003e\u003cbr\u003e incidentStatus set to \u003cb\u003e{2}\u003c/b\u003e in SentinelOne\".format(note, verdict, status)\n  elif success_verdict:\n    note = \"{0} analystVerdict set to \u003cb\u003e{1}\u003c/b\u003e\u003cbr\u003e incidentStatus was NOT set to {2} in SentinelOne\".format(note, verdict, status)\n  elif success_status:\n    note = \"{0} incidentStatus set to \u003cb\u003e{1}\u003c/b\u003e\u003cbr\u003e analystVerdict was NOT set to {2} in SentinelOne\".format(note, status, verdict)\n  else:\n    note = \"{0} analystVerdict: \u003cb\u003e{1}\u003c/b\u003e and incidentStatus: \u003cb\u003e{2}\u003c/b\u003e were NOT set in SentinelOne\".format(note, verdict, status)\nelse:\n  note = \"{0} function did not return success.\".format(note)\n  \nincident.addNote(helper.createRichText(note))",
          "tags": [],
          "uuid": "aa660a03-23ff-4474-b519-bc7df20bdc86"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "a0a6737f-6a25-4340-94a7-24d41d652ff2",
            "element": "field_uuid",
            "field_type": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "01ff3cf2-9099-452f-ac58-2bffbae3c532",
            "element": "field_uuid",
            "field_type": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "sentinelone_update_analyst_verdict_and_threat_status",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_bb713a02-68fa-47c4-942c-cb0054aac3b9",
        "id": 34,
        "name": "playbook_bb713a02_68fa_47c4_942c_cb0054aac3b9",
        "type": "playbook",
        "uuid": "a7b1e4e6-a70a-4cb3-9b69-17e9b8378c81"
      },
      "tags": [],
      "type": "default",
      "uuid": "bb713a02-68fa-47c4-942c-cb0054aac3b9",
      "version": 16
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 20,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_c4d419dd_4143_4585_8544_ec638e350f1b\" isExecutable=\"true\" name=\"playbook_c4d419dd_4143_4585_8544_ec638e350f1b\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_081rbam\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Get Threat Details\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"2a2f6e9e-0fda-428e-adc0-cf0e7ca833fd\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_threat_id = incident.properties.sentinelone_threat_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_threat_details_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_081rbam\u003c/incoming\u003e\u003coutgoing\u003eFlow_1qov47s\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_081rbam\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Update Case with threat info\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f4aa44ce-9fcf-4141-bd87-6f703743c685\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1qov47s\u003c/incoming\u003e\u003coutgoing\u003eFlow_1b3j6nj\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1qov47s\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1b3j6nj\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1b3j6nj\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_c4d419dd_4143_4585_8544_ec638e350f1b\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1b3j6nj\" id=\"Flow_1b3j6nj_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"414\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1qov47s\" id=\"Flow_1qov47s_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_081rbam\" id=\"Flow_081rbam_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"414\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1694539424463,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_c4d419dd_4143_4585_8544_ec638e350f1b",
      "description": {
        "content": "Automatic playbook to update the SentinelOne case in SOAR.",
        "format": "text"
      },
      "display_name": "SentinelOne: Update Case in SOAR",
      "export_key": "sentinelone_update_case_in_soar",
      "field_type_handle": "playbook_c4d419dd_4143_4585_8544_ec638e350f1b",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Update Case in SOAR",
        "export_key": "playbook_c4d419dd_4143_4585_8544_ec638e350f1b",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_c4d419dd_4143_4585_8544_ec638e350f1b",
        "uuid": "61952d28-ae85-4a0d-924e-2c303352a18d"
      },
      "has_logical_errors": false,
      "id": 37,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1694608816458,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1694541857500,
          "description": "Update custom fields and add artifact with threat information from SentinelOne threat.",
          "enabled": false,
          "export_key": "SentinelOne: Update Case with threat info",
          "id": 48,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1694547945234,
          "name": "SentinelOne: Update Case with threat info",
          "object_type": "incident",
          "playbook_handle": "sentinelone_update_case_in_soar",
          "programmatic_name": "sentinelone_update_case_in_soar_sentinelone_update_case_with_threat_info",
          "script_text": "results = playbook.functions.results.get_threat_details_results\n\nsuccess = results.get(\"success\", False)\nif success:\n  content = results.get(\"content\", False)\n  if content:\n    data = content.get(\"data\", [])\n    if data and isinstance(data, list):\n      threat_data = data[0]\n      threat_info = threat_data.get(\"threatInfo\", False)\n      if threat_info:\n\n        incident.properties.sentinelone_classification = threat_info.get(\"classification\")\n        incident.properties.sentinelone_confidence_level = threat_info.get(\"confidenceLevel\")\n        incident.properties.sentinelone_incident_status = threat_info.get(\"incidentStatus\")\n        incident.properties.sentinelone_mitigation_status = threat_info.get(\"mitigationStatus\")\n        incident.properties.sentinelone_threat_analyst_verdict = threat_info.get(\"analystVerdict\")\n        incident.properties.sentinelone_mitigation_status_description = threat_info.get(\"mitigationStatusDescription\")\n        \n        entity_url = content.get(\"entity_url\", False)\n        if entity_url:\n          threat_url_link = \"\u003ca target=\u0027blank\u0027 href=\u0027{0}\u0027\u003e{1}\u003c/a\u003e\".format(entity_url, threat_info.get(\"threatId\"))\n          incident.properties.sentinelone_threat_overview_url = threat_url_link\n            \n        # CREATE ARTIFACTS\n        # Create any artifacts from the threat or agent info here\n        agent_realtime_info = threat_data.get(\"agentRealtimeInfo\", False)\n        if agent_realtime_info and agent_realtime_info.get(\"agentComputerName\"):\n            incident.addArtifact(\"System Name\", agent_realtime_info.get(\"agentComputerName\"), \"Created by SentinelOne\")\n\n        agent_detection_info = threat_data.get(\"agentDetectionInfo\")\n        if agent_detection_info and agent_detection_info.get(\"externalIp\", False):\n            incident.addArtifact(\"IP Address\", agent_detection_info.get(\"externalIp\"), \"Created by SentinelOne\")\n            \n        if threat_info.get(\"processUser\"):\n            incident.addArtifact(\"Process Name\", threat_info.get(\"processUser\"), \"Created by SentinelOne\")\n           \n        if threat_info.get(\"sha1\"):\n            incident.addArtifact(\"Malware SHA-1 Hash\", threat_info.get(\"sha1\"), \"Created by SentinelOne\")\n            \n        if threat_info.get(\"filePath\"):\n            incident.addArtifact(\"File Path\", threat_info.get(\"filePath\"), \"Created by SentinelOne\")\n            \n        if threat_info.get(\"threatName\"):\n            threat_name = threat_info.get(\"threatName\")\n            threat_name = threat_name.replace(\u0027\\\\\u0027, \u0027\\\\\\\\\u0027)\n            threat_name = threat_name.replace(\u0027\"\u0027, \u0027\\\\\"\u0027)\n            incident.addArtifact(\"File Name\", threat_name, \"Created by SentinelOne\")\n      else:\n        incident.addNote(\"SentinelOne: Update Case: Unable to get threat info data to update case.\")\n    else: \n      incident.addNote(\"SentinelOne: Update Case: Unable to get data to update case.\")\n  else:\n    incident.addNote(\"SentinelOne: Update Case: Unable to get content data to update case.\")\nelse:\n  incident.addNote(\"SentinelOne: Update Case: Unable to get threat data to update case.\")\n            ",
          "tags": [],
          "uuid": "f4aa44ce-9fcf-4141-bd87-6f703743c685"
        }
      ],
      "name": "sentinelone_update_case_in_soar",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_c4d419dd-4143-4585-8544-ec638e350f1b",
        "id": 39,
        "name": "playbook_c4d419dd_4143_4585_8544_ec638e350f1b",
        "type": "playbook",
        "uuid": "88c5251f-fb8b-4a39-8222-7e23fe8aed3f"
      },
      "tags": [],
      "type": "default",
      "uuid": "c4d419dd-4143-4585-8544-ec638e350f1b",
      "version": 24
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_eb51643a_58c7_4c71_8b88_418db9472487\" isExecutable=\"true\" name=\"playbook_eb51643a_58c7_4c71_8b88_418db9472487\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0ylavvf\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Update Notes From SentinelOne\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"351d4c78-2c26-40f5-889f-6111e408068d\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.incident_id = incident.id\\ninputs.sentinelone_threat_id = incident.properties.sentinelone_threat_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_notes_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ylavvf\u003c/incoming\u003e\u003coutgoing\u003eFlow_1l4e2ay\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0ylavvf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1l4e2ay\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1l4e2ay\" sourceRef=\"ServiceTask_1\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_eb51643a_58c7_4c71_8b88_418db9472487\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ylavvf\" id=\"Flow_0ylavvf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1l4e2ay\" id=\"Flow_1l4e2ay_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"314\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"314\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693235550281,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_eb51643a_58c7_4c71_8b88_418db9472487",
      "description": {
        "content": "Query SentinelOne and add any new threat notes to the SOAR incident.",
        "format": "text"
      },
      "display_name": "SentinelOne: Update Notes from SentinelOne (PB)",
      "export_key": "sentinelone_update_notes_from_sentinelone_pb",
      "field_type_handle": "playbook_eb51643a_58c7_4c71_8b88_418db9472487",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Update Notes from SentinelOne (PB)",
        "export_key": "playbook_eb51643a_58c7_4c71_8b88_418db9472487",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_eb51643a_58c7_4c71_8b88_418db9472487",
        "uuid": "8e0d1f4a-94e1-4e0e-b28f-c505907e72bf"
      },
      "has_logical_errors": false,
      "id": 33,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693240090610,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693238202108,
          "description": "Create json object note to pass to JSON Conversion script. ",
          "enabled": false,
          "export_key": "SentinelOne: Write formmated results",
          "id": 41,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693240090565,
          "name": "SentinelOne: Write formmated results",
          "object_type": "incident",
          "playbook_handle": "sentinelone_update_notes_from_sentinelone_pb",
          "programmatic_name": "sentinelone_update_notes_from_sentinelone_pb_sentinelone_write_formmated_results",
          "script_text": "# Put the results json into a workflow property so we can call the \n# convert_json_to_rich_text script to print readable formatted json in an incident note.\nresults = playbook.functions.results.get_agent_results\ninputs = results.get(\"inputs\")\nagent_id = inputs.get(\"sentinelone_agent_id\")\nheader = \"SentinelOne Agent Id: {0} Details:\".format(agent_id)\n\ncontent = results.get(\"content\")\ndata = content.get(\"data\")\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": data,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "88f85796-cd18-44e0-81f6-4ff0a39c5b91"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_update_notes_from_sentinelone_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_eb51643a-58c7-4c71-8b88-418db9472487",
        "id": 35,
        "name": "playbook_eb51643a_58c7_4c71_8b88_418db9472487",
        "type": "playbook",
        "uuid": "7ca6082c-8922-4d8f-845a-141e37e1d0b7"
      },
      "tags": [],
      "type": "default",
      "uuid": "eb51643a-58c7-4c71-8b88-418db9472487",
      "version": 9
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1\" isExecutable=\"true\" name=\"playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1lty374\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Get Agent Details\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3bc833b4-0545-4db6-8ede-515d7439279a\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_agent_id = row.sentinelone_dt_agent_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_agent_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1lty374\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ads4wc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1lty374\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0hfykzk\u003c/incoming\u003e\u003coutgoing\u003eFlow_16u0ahy\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0ads4wc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_16u0ahy\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_16u0ahy\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"SentinelOne: Prepare results for JSON Converter Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f1b3126c-c139-446b-8ebe-3315cdc678c6\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ads4wc\u003c/incoming\u003e\u003coutgoing\u003eFlow_0hfykzk\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0hfykzk\" sourceRef=\"ScriptTask_4\" targetRef=\"ScriptTask_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_16u0ahy\" id=\"Flow_16u0ahy_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"484\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ads4wc\" id=\"Flow_0ads4wc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"192\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"238\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1lty374\" id=\"Flow_1lty374_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"108\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hfykzk\" id=\"Flow_0hfykzk_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"322\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"108\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"237.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"358\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"484\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693237198147,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1",
      "description": {
        "content": "Get the SentinelOne agent details in JSON format and call the Convert JSON to rich text script to write the information to an incident note in formatted rich text.",
        "format": "text"
      },
      "display_name": "SentinelOne: Write Agent Details to Note (PB)",
      "export_key": "sentinelone_write_agent_details_to_note_pb",
      "field_type_handle": "playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Write Agent Details to Note (PB)",
        "export_key": "playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1",
        "uuid": "017bdf7c-2c01-4f25-a149-a1d8d10b971e"
      },
      "has_logical_errors": false,
      "id": 34,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693240074017,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693238446634,
          "description": "Prepare the results from Get Agent Details to send to JSON converter script.",
          "enabled": false,
          "export_key": "SentinelOne: Prepare results for JSON Converter Script",
          "id": 42,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693238446648,
          "name": "SentinelOne: Prepare results for JSON Converter Script",
          "object_type": "sentinelone_agents_dt",
          "playbook_handle": "sentinelone_write_agent_details_to_note_pb",
          "programmatic_name": "sentinelone_write_agent_details_to_note_pb_sentinelone_prepare_results_for_json_converter_script",
          "script_text": "# Put the results json into a workflow property so we can call the \n# convert_json_to_rich_text script to print readable formatted json in an incident note.\nresults = playbook.functions.results.get_agent_results\ninputs = results.get(\"inputs\")\nagent_id = inputs.get(\"sentinelone_agent_id\")\nheader = \"SentinelOne Agent Id: {0} Details:\".format(agent_id)\n\ncontent = results.get(\"content\")\ndata = content.get(\"data\")\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": data,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "f1b3126c-c139-446b-8ebe-3315cdc678c6"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_write_agent_details_to_note_pb",
      "object_type": "sentinelone_agents_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_b91172d5-5e66-45cd-8fe7-92e79f2afad1",
        "id": 36,
        "name": "playbook_b91172d5_5e66_45cd_8fe7_92e79f2afad1",
        "type": "playbook",
        "uuid": "dba6905d-ca24-47d5-a3fd-a340b45ac911"
      },
      "tags": [],
      "type": "default",
      "uuid": "b91172d5-5e66-45cd-8fe7-92e79f2afad1",
      "version": 8
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_2275e891_cc0b_460f_8a72_890033330f60\" isExecutable=\"true\" name=\"playbook_2275e891_cc0b_460f_8a72_890033330f60\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0izp0u1\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SentinelOne: Get Threat Details\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"2a2f6e9e-0fda-428e-adc0-cf0e7ca833fd\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sentinelone_threat_id = incident.properties.sentinelone_threat_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_threat_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0izp0u1\u003c/incoming\u003e\u003coutgoing\u003eFlow_1i3p7dw\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0izp0u1\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"SentinelOne: Prepare input to JSON Converter Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"c67639fd-ac50-40f0-bada-5a323453c3ca\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1i3p7dw\u003c/incoming\u003e\u003coutgoing\u003eFlow_1mn7jl3\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1i3p7dw\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mn7jl3\u003c/incoming\u003e\u003coutgoing\u003eFlow_1hml24a\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1mn7jl3\" sourceRef=\"ScriptTask_2\" targetRef=\"ScriptTask_3\"/\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1hml24a\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1hml24a\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_2275e891_cc0b_460f_8a72_890033330f60\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1hml24a\" id=\"Flow_1hml24a_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"524\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mn7jl3\" id=\"Flow_1mn7jl3_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1i3p7dw\" id=\"Flow_1i3p7dw_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0izp0u1\" id=\"Flow_0izp0u1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"524\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1693238964395,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_2275e891_cc0b_460f_8a72_890033330f60",
      "description": {
        "content": "Get the SentinelOne agent details in JSON format and call the Convert JSON to rich text script to write the information to an incident note in formatted rich text.",
        "format": "text"
      },
      "display_name": "SentinelOne: Write Threat Details to Note (PB)",
      "export_key": "sentinelone_write_threat_details_to_note_pb",
      "field_type_handle": "playbook_2275e891_cc0b_460f_8a72_890033330f60",
      "fields_type": {
        "actions": [],
        "display_name": "SentinelOne: Write Threat Details to Note (PB)",
        "export_key": "playbook_2275e891_cc0b_460f_8a72_890033330f60",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_2275e891_cc0b_460f_8a72_890033330f60",
        "uuid": "94e51493-0537-48e2-adba-2e99771cfa77"
      },
      "has_logical_errors": false,
      "id": 35,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1693240057429,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1693239258392,
          "description": "Prepare results from Get Threat Details function to pass to JSON Converter Script.",
          "enabled": false,
          "export_key": "SentinelOne: Prepare input to JSON Converter Script",
          "id": 43,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1693239258402,
          "name": "SentinelOne: Prepare input to JSON Converter Script",
          "object_type": "incident",
          "playbook_handle": "sentinelone_write_threat_details_to_note_pb",
          "programmatic_name": "sentinelone_write_threat_details_to_note_pb_sentinelone_prepare_input_to_json_converter_script",
          "script_text": "results = playbook.functions.results.get_threat_results\n\ninputs = results.get(\"inputs\")\nthreat_id = inputs.get(\"sentinelone_threat_id\")\ncontent = results.get(\"content\")\ndata = content.get(\"data\")\n\nheader = u\"SentinelOne Threat Id: {0} Details:\".format(threat_id)\n\njson_note = {\n              \"version\": \"1.1\",\n              \"header\": header, \n              \"json\": data,\n              \"sort\": False\n            }\n\nworkflow.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "c67639fd-ac50-40f0-bada-5a323453c3ca"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sentinelone_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sentinelone_write_threat_details_to_note_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_2275e891-cc0b-460f-8a72-890033330f60",
        "id": 37,
        "name": "playbook_2275e891_cc0b_460f_8a72_890033330f60",
        "type": "playbook",
        "uuid": "ec0016f5-00ff-46d1-b463-6c39172f387d"
      },
      "tags": [],
      "type": "default",
      "uuid": "2275e891-cc0b-460f-8a72-890033330f60",
      "version": 8
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [
    {
      "actions": [],
      "created_date": 1693236532644,
      "description": "This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note. A workflow property is used to share the json to convert and identify parameters used on how to perform the conversion.\nTypically, a function will create workflow property and this script will run after that function to perform the conversion.\n\nFeatures:\n\n* Display the hierarchical nature of json, presenting the json keys (sorted if specified) as bold labels\n* Provide links to found URLs\n* Create either an incident note or add results to an incident (custom) rich text field.",
      "enabled": false,
      "export_key": "Convert JSON to rich text v1.3",
      "id": 40,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1693236532681,
      "name": "Convert JSON to rich text v1.3",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "convert_json_to_rich_text_13",
      "script_text": "# (c) Copyright IBM Corp. 2010, 2022. All Rights Reserved.\nVERSION = 1.3\n\"\"\"\n  This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note.\n  A workflow property is used to define the json to convert and identify parameters used on how to perform the conversion.\n  Typically, a function will create workflow property and this script will run after that function to perform the conversion.\n  Features:\n    * Display the hierarchical nature of json, presenting the json keys as bold labels\n    * Provide links to found URLs\n    * Create either an incident note or add results to an incident (custom) rich text field.\n  \n  In order to use this script, define a workflow property called: convert_json_to_rich_text, to define the json and parameters to use for the conversion.\n  Workflow properties can be added using a command similar to this:\n  workflow.addProperty(\u0027convert_json_to_rich_text\u0027, {\n    \"version\": 1.3,\n    \"header\": \"Artifact scan results for: {}\".format(artifact.value),\n    \"padding\": 10,\n    \"separator\": u\"\u003cbr /\u003e\",\n    \"sort\": True,\n    \"json\": results.content,\n    \"json_omit_list\": [\"omit\"],\n    \"incident_field\": None\n  })\n  \n  Format of workflow.property.convert_json_to_rich_text:\n  { \n    \"version\": 1.3, [this is for future compatibility]\n    \"header\": str, [header line to add to converted json produced or None. Ex: Results from scanning artifact: xxx. The header may contain rich text tags]\n    \"padding\": 10, [padding for nested json elements, or defaults to 10]\n    \"separator\": u\"\u003cbr /\u003e\"|list such as [\u0027\u003cspan\u003e\u0027,\u0027\u003c/span\u003e\u0027], [html separator between json keys and lists or defaults to html break: \u0027\u003cbr /\u003e\u0027. \n                                                If a list, then the data is brackets by the pair specified]\n    \"sort\": True|False, [sort the json keys at each level when displayed]\n    \"json\": json, [required json to convert]\n    \"json_omit_list\": [list of json keys to exclude or None]\n    \"incident_field\": \"\u003cincident_field\u003e\" [indicates a builtin rich text incident field, such as \u0027description\u0027 \n                                          or a custom rich text field in the format: \u0027properties.\u003cfield\u003e\u0027. default: create an incident note]\n  }\n\n  For playbooks, use playbook.addProperty() with the same format as workflow.addProperty()\n\n  Playbooks can also use playbook.functions.results.convert_json_to_rich_text using the standard function output which contains the \u0027content\u0027 json element.\n  When using playbook.functions.results.convert_json_to_rich_text with standard function results, all the defaults for padding, separator, etc. are used.\n\"\"\"\n\nimport re\n\n# needed for python 3\ntry:\n    unicode(\"abc\") # fails in py3\n    py2 = True\nexcept:\n    unicode = str\n    py2 = False\n\n\nrc = re.compile(r\u0027http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.\u0026+#\\?]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+\u0027)\n\nclass ConvertJson:\n    \"\"\"Class to hold the conversion parameters and perform the conversion\"\"\"\n\n    def __init__(self, omit_keys=[], padding=10, separator=u\"\u003cbr /\u003e\", sort_keys=False):\n        self.omit_keys = omit_keys\n        self.padding = padding\n        self.separator = separator\n        self.sort_keys = sort_keys\n\n\n    def format_link(self, item):\n        \"\"\"[summary]\n          Find embedded urls (http(s)) and add html anchor tags to display as links\n          Args:\n              item ([string])\n\n          Returns:\n              [str]: None|original text if no links|text with html links\n        \"\"\"\n        formatted_item = item\n        if py2:\n            num_type = bool(item and isinstance(item, (int, long, bool, float)))\n        else:\n            num_type = bool(item and isinstance(item, (int, bool, float)))\n\n        if item and not num_type:\n            list = rc.findall(item)\n            if list:\n                for link in list:\n                    formatted_item = formatted_item.replace(link, u\"\u003ca target=\u0027blank\u0027 href=\u0027{0}\u0027\u003e{0}\u003c/a\u003e\".format(link))\n\n        return formatted_item\n\n    def expand_list(self, list_value, is_list=False):\n        \"\"\"[summary]\n          convert items to html, adding indents to nested dictionaries.\n          Args:\n              list_value ([dict|list]): json element\n\n          Returns:\n              [str]: html converted code\n        \"\"\"\n        if not isinstance(list_value, list):\n            return self.format_link(list_value)\n        elif not list_value:\n            return u\"None\u003cbr\u003e\"\n\n        try:\n            items_list = []  # this will ensure list starts on second line of key label\n            for item in list_value:\n                if isinstance(item, dict):\n                    result = self.convert_json_to_rich_text(item)\n                    if is_list:\n                        items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(result))\n                    else:\n                        items_list.append(result)\n                elif isinstance(item, list):\n                    items_list.append(self.expand_list(item, is_list=True))\n                elif is_list:\n                    items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(self.format_link(unicode(item))))\n                else:\n                    items_list.append(self.format_link(unicode(item)))\n\n            expand_list_result = self.add_separator(self.separator if not is_list else u\"\",\n                                                    items_list,\n                                                    is_list=is_list)\n\n            if is_list:\n                return u\"\u003cul\u003e{}\u003c/ul\u003e\".format(expand_list_result)\n            else:\n                return u\"\u003cdiv style=\u0027padding:5px\u0027\u003e{}\u003c/div\u003e\".format(expand_list_result)\n        except Exception as err:\n            return str(err)\n\n    def convert_json_to_rich_text(self, sub_dict):\n        \"\"\"[summary]\n          Walk dictionary tree and convert to html for better display\n          Args:\n              sub_dict ([type]): [description]\n\n          Returns:\n              [type]: [description]\n        \"\"\"\n        notes = []\n        if sub_dict and isinstance(sub_dict, (list, dict)):\n            if isinstance(sub_dict, list):\n                expanded_list = self.expand_list(sub_dict, is_list=True)\n                notes.append(self.add_separator(self.separator, expanded_list))\n            else:\n                keys = sorted (sub_dict.keys()) if self.sort_keys else sub_dict.keys()\n\n                for key in keys:\n                    if key not in self.omit_keys:\n                        value = sub_dict[key]\n                        is_list = isinstance(value, list)\n                        item_list = [u\"\u003cstrong\u003e{0}\u003c/strong\u003e: \".format(key)]\n                        if isinstance(value, dict):\n                            convert_result = self.convert_json_to_rich_text(value)\n                            if convert_result:\n                                item_list.append(u\"\u003cdiv style=\u0027padding:{}px\u0027\u003e{}\u003c/div\u003e\".format(self.padding, convert_result))\n                            else:\n                                item_list.append(u\"None\u003cbr\u003e\")\n                        else:\n                            item_list.append(self.expand_list(value, is_list=is_list))\n\n                        notes.append(self.add_separator(self.separator, u\"\".join(make_unicode(v) for v in item_list), is_list=is_list))\n\n        result_notes = u\"\".join(notes)\n        if isinstance(self.separator, list):\n            return result_notes\n        else:\n            return result_notes.replace(\n                u\"\u003c/div\u003e{0}\".format(self.separator), u\"\u003c/div\u003e\").replace(\n                u\"{0}\u003c/div\u003e\".format(self.separator), u\"\u003c/div\u003e\"\n            )  # tighten up result\n\n    def add_separator(self, separator, items, is_list=False):\n        \"\"\"\n        apply the separator to the data\n        :param separator: None, str or list such as [\u0027\u003cspan\u003e\u0027, \u0027\u003c/span\u003e\u0027]\n        :param items: str or list to add separator\n        :return: text with separator applied\n        \"\"\"\n        _items = items\n\n        if not _items:\n            return \"\u003cbr\u003e\"\n\n        if not isinstance(_items, list):\n            _items = [_items]\n\n        if isinstance(separator, list):\n            return u\"\".join([u\"{}{}{}\".format(separator[0], item, separator[1]) for item in _items])\n\n        return u\"{}{}\".format(separator.join(_items), separator if not is_list else u\"\")\n\ndef make_unicode(value):\n    if value is None:\n        return \u0027None\u0027\n\n    return unicode(value)\n\ndef get_results(property_name):\n    if playbook and playbook.functions.results[property_name] is not None:\n        return playbook.functions.results[property_name]\n    elif playbook and playbook.properties[property_name] is not None:\n        return playbook.properties[property_name]\n    elif workflow and workflow.properties[property_name] is not None:\n        return workflow.properties[property_name]\n\n    return None\n\ndef get_properties(property_name):\n    \"\"\"\n    Logic to collect the json and parameters from a workflow property.\n    Args:\n      property_name: workflow property to reference\n    Returns:\n      padding, separator, header, json_omit_list, incident_field, json, sort_keys\n    \"\"\"\n    result_properties = get_results(property_name)\n    if not result_properties:\n        helper.fail(\"Playbook/workflow property not found: {}\".format(property_name))\n\n    padding = int(result_properties.get(\"padding\", 10))\n    separator = result_properties.get(\"separator\", u\"\u003cbr /\u003e\")\n    if isinstance(separator, list) and len(separator) != 2:\n        helper.fail(\"list of separators should be specified as a pair such as [\u0027\u003cdiv\u003e\u0027, \u0027\u003c/div\u003e\u0027]: {}\".format(separator))\n\n    header = result_properties.get(\"header\")\n    sort_keys = bool(result_properties.get(\"sort\", False))\n    json_omit_list = result_properties.get(\"json_omit_list\")\n    if not json_omit_list:\n        json_omit_list = []\n    incident_field = result_properties.get(\"incident_field\")\n    \n    # workflow formatted content is \u0027json\u0027. Standard functions is \u0027content\u0027\n    json = result_properties.get(\"json\") if result_properties.get(\"json\") else result_properties.get(\"content\")\n    json_err = None\n    # is there an issue we need handle now?\n    if not json and \\\n        result_properties.get(\"success\") == False and result_properties.get(\"reason\"):\n        json_err = result_properties.get(\"reason\")\n    \n    return padding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys\n\n\n## S T A R T\npadding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys = get_properties(\u0027convert_json_to_rich_text\u0027)\nif json_err:\n    result = \"Result error: {}\".format(json_err)\nelse:\n    if header:\n        if isinstance(separator, list):\n            hdr = u\"{0}{1}{2}\".format(separator[0], header, separator[1])\n        else:\n            hdr = u\"{0}{1}\".format(header, separator)\n    else:\n        hdr = u\"\"\n\n    convert = ConvertJson(omit_keys=json_omit_list, padding=padding, separator=separator, sort_keys=sort_keys)\n    converted_json = convert.convert_json_to_rich_text(json)\n    result = u\"{}{}\".format(hdr, converted_json if converted_json else \"\\nNone\")\n\nrich_text_note = helper.createRichText(result)\nif incident_field:\n    incident[incident_field] = rich_text_note\nelse:\n    incident.addNote(rich_text_note)\n",
      "tags": [],
      "uuid": "64d3e6da-8b56-4d19-9ce8-a75586f71dad"
    }
  ],
  "server_version": {
    "build_number": 8131,
    "major": 46,
    "minor": 0,
    "version": "46.0.8131"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "SentinelOne Agent",
      "export_key": "sentinelone_agents_dt",
      "fields": {
        "sentinelone_dt_agent_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_agent_id",
          "hide_notification": false,
          "id": 329,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_agent_id",
          "operation_perms": {},
          "operations": [],
          "order": 10,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Agent ID",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "e8372600-1df3-4733-b275-a9f74658970c",
          "values": [],
          "width": 167
        },
        "sentinelone_dt_agent_version": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_agent_version",
          "hide_notification": false,
          "id": 330,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_agent_version",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Agent Version",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "8707325d-aa16-4bb6-a742-d4587ac51310",
          "values": [],
          "width": 57
        },
        "sentinelone_dt_computername": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_computername",
          "hide_notification": false,
          "id": 331,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_computername",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Computer Name",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "e8d004b3-39ec-4767-87a2-27367bc38413",
          "values": [],
          "width": 115
        },
        "sentinelone_dt_created": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_created",
          "hide_notification": false,
          "id": 332,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_created",
          "operation_perms": {},
          "operations": [],
          "order": 12,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Created At",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "1e88f49b-24aa-44c2-9963-b2c1d18b1100",
          "values": [],
          "width": 60
        },
        "sentinelone_dt_domain": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_domain",
          "hide_notification": false,
          "id": 333,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_domain",
          "operation_perms": {},
          "operations": [],
          "order": 11,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Domain",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "d0c01b2f-0f5a-4dfd-a7b6-b1813ea12c08",
          "values": [],
          "width": 58
        },
        "sentinelone_dt_external_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_external_ip",
          "hide_notification": false,
          "id": 334,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_external_ip",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "External IP",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "c3988494-c1bc-4005-9d46-8517ca9844c2",
          "values": [],
          "width": 115
        },
        "sentinelone_dt_is_active": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_is_active",
          "hide_notification": false,
          "id": 335,
          "input_type": "boolean",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_is_active",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Is Active",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "395881b2-6f1f-454b-899e-6213a6dea781",
          "values": [],
          "width": 48
        },
        "sentinelone_dt_network_status": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_network_status",
          "hide_notification": false,
          "id": 336,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_network_status",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": true,
          "tags": [],
          "templates": [],
          "text": "Network Status",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "625b9b90-d165-4080-974e-865494161ad6",
          "values": [],
          "width": 65
        },
        "sentinelone_dt_os_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_os_name",
          "hide_notification": false,
          "id": 337,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_os_name",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "OS Name",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "16d80cf7-2e5c-47f9-a2d9-f09dc7951471",
          "values": [],
          "width": 57
        },
        "sentinelone_dt_query_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_query_date",
          "hide_notification": false,
          "id": 338,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_query_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query Date",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "b0366df4-4468-4d36-98f1-cfe57e85844d",
          "values": [],
          "width": 146
        },
        "sentinelone_dt_registered": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_registered",
          "hide_notification": false,
          "id": 339,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_registered",
          "operation_perms": {},
          "operations": [],
          "order": 13,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Registered At",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "7ddf1974-f240-4bd2-8f42-81bc524f244d",
          "values": [],
          "width": 82
        },
        "sentinelone_dt_site": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_site",
          "hide_notification": false,
          "id": 340,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_site",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Site",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "b93d1433-2287-4552-af23-c3bc270d5869",
          "values": [],
          "width": 115
        },
        "sentinelone_dt_threat_count": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_threat_count",
          "hide_notification": false,
          "id": 341,
          "input_type": "number",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_threat_count",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Threat Count",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "8da86dc1-3594-49a4-a301-59d69250fd05",
          "values": [],
          "width": 50
        },
        "sentinelone_dt_updated": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_updated",
          "hide_notification": false,
          "id": 342,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_updated",
          "operation_perms": {},
          "operations": [],
          "order": 14,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Updated At",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "2e41b920-64c3-438f-83a2-ceaea5874f0e",
          "values": [],
          "width": 65
        },
        "sentinelone_dt_uuid": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sentinelone_agents_dt/sentinelone_dt_uuid",
          "hide_notification": false,
          "id": 343,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sentinelone_dt_uuid",
          "operation_perms": {},
          "operations": [],
          "order": 9,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "UUID",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "00f07379-46bb-436e-b4c9-75ebac817760",
          "values": [],
          "width": 40
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "sentinelone_agents_dt",
      "uuid": "fbddc8a9-d2f1-4852-9c0c-efa703999ca0"
    }
  ],
  "workflows": [],
  "workspaces": []
}
