<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="MISP" href="../fn_misp/README.html" /><link rel="prev" title="Microsoft Security Graph Integration for SOAR" href="../fn_microsoft_security_graph/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>Microsoft Sentinel - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">Remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmware_cbc/README.html">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">Anomali Staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">fn_aws_guardduty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration Application for IBM Resilient.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#table-of-contents">Table of Contents -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#about-this-package">About this package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#use-cases">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#resilient-configurations">Resilient Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#rules">Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#run-application">Run Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#application-usage-and-details">Application Usage and Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#guardium-4a-list-parameter-names-by-report-name">Guardium: 4A. List Parameter Names By Report Name :</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#guardium-4b-search-all-guardium-reports">Guardium: 4B. Search All Guardium Reports :</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">IBM SOAR LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph Integration for SOAR</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">About MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">PhishTank Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watson_translate/README.html">Watson Translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="microsoft-sentinel">
<h1>Microsoft Sentinel<a class="headerlink" href="#microsoft-sentinel" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sentinel-configuration"><span class="xref myst">Sentinel Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---sentinel-add-incident-comment"><span class="xref myst">Function - Sentinel Add Incident Comment</span></a></p></li>
<li><p><a class="reference internal" href="#function---sentinel-get-incident-alerts"><span class="xref myst">Function - Sentinel Get Incident Alerts</span></a></p></li>
<li><p><a class="reference internal" href="#function---sentinel-get-incident-comments"><span class="xref myst">Function - Sentinel Get Incident Comments</span></a></p></li>
<li><p><a class="reference internal" href="#function---sentinel-get-incident-entities"><span class="xref myst">Function - Sentinel Get Incident Entities</span></a></p></li>
<li><p><a class="reference internal" href="#function---sentinel-update-incident"><span class="xref myst">Function - Sentinel Update Incident</span></a></p>
<ul>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#data-table---sentinel-incident-alerts"><span class="xref myst">Data Table - Sentinel Incident Alerts</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---sentinel-incident-entities"><span class="xref myst">Data Table - Sentinel Incident Entities</span></a></p></li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#custom-templates"><span class="xref myst">Custom Templates</span></a></p></li>
<li><p><a class="reference internal" href="#custom-poller-filter-template"><span class="xref myst">Custom poller filter template</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<!--
  Specify all changes in this release. Do not remove the release 
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2.1.1</p></td>
<td><p>07/2024</p></td>
<td><p>Correction to documentation on template references</p></td>
</tr>
<tr class="row-odd"><td><p>2.1.0</p></td>
<td><p>03/2024</p></td>
<td><p>Add support for multi-tenancy.</p></td>
</tr>
<tr class="row-even"><td><p>2.0.0</p></td>
<td><p>01/2024</p></td>
<td><p><ul><li>Bug fix in jinja template, “incident_update_template.jinja”, for escaping double quotation mark when rendering in json.</li><li>Update jinja templates to use values rather than IDs.</li><li>Add new setting in the app.config to set api-version.</li><li>Add the ability to use a jinja template as the poller incident filter.</li></ul></p></td>
</tr>
<tr class="row-odd"><td><p>1.2.0</p></td>
<td><p>07/2023</p></td>
<td><p>Add config setting to not close SOAR case was Sentinel incident is closed</p></td>
</tr>
<tr class="row-even"><td><p>1.1.0</p></td>
<td><p>04/2023</p></td>
<td><p>Update function ‘Sentinel Update Incident’</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.4</p></td>
<td><p>06/2022</p></td>
<td><p>Several template fixes for tags (labels) and severity</p></td>
</tr>
<tr class="row-even"><td><p>1.0.3</p></td>
<td><p>04/2022</p></td>
<td><p>Support for app.config verify and cert parameters</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.2</p></td>
<td><p>02/2022</p></td>
<td><p>Bug fix in some situations updating Sentinel from SOAR</p></td>
</tr>
<tr class="row-even"><td><p>1.0.1</p></td>
<td><p>11/2021</p></td>
<td><p>Minor bug fixes and datatable improvements</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.0</p></td>
<td><p>08/2021</p></td>
<td><p>Initial Release</p></td>
</tr>
</tbody>
</table>
</div>
<section id="v2-1-1">
<h3>v2.1.1<a class="headerlink" href="#v2-1-1" title="Link to this heading">¶</a></h3>
<p>The default configuration file incorrectly specified the override Sentinel template references were:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">update_sentinel_incident_template</span>
<span class="n">close_sentinel_incident_template</span>
</pre></div>
</div>
<p>The correct settings are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sentinel_update_incident_template</span>
<span class="n">sentinel_close_incident_template</span>
</pre></div>
</div>
</section>
<section id="v2-1-0">
<h3>v2.1.0<a class="headerlink" href="#v2-1-0" title="Link to this heading">¶</a></h3>
<p>When upgrading from a previous version to v2.1.0, manually update your app.config to be able to use the multi-tenant capability. The app.config changes are documented here <a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a>. The previous version of the app.config from versions before 2.1.0 are compatible with version 2.1.0+.</p>
</section>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p><strong>SOAR integration for ‘fn_microsoft_sentinel’</strong></p>
<p><img alt="screenshot: main" src="../_images/main34.png" /></p>
<p>This app allows bi-directional synchronization between IBM SOAR and Microsoft Sentinel.
Sentinel entities are exposed as artifacts for further investigation.</p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Escalate Microsoft Sentinel Incidents to IBM SOAR Cases</p></li>
<li><p>Automatically keep Incidents and Cases synchronized</p></li>
<li><p>Retrieve Sentinel Incident alert entities as artifacts and data table rows</p></li>
<li><p>Sync comments to and from Sentinel Incidents</p></li>
<li><p>Support editable templates for field mapping between the two systems</p></li>
<li><p>Supports configuring multiple Sentinel servers</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (also known as App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">50.0.9097</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">50.0.9097</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=50.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Incident</p></td>
<td><p>Read, Edit, Create, Owner, Status</p></td>
</tr>
<tr class="row-odd"><td><p>Incident Notes</p></td>
<td><p>Edit</p></td>
</tr>
<tr class="row-even"><td><p>Layout</p></td>
<td><p>Read, Edit</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= <code class="docutils literal notranslate"><span class="pre">1.10.15</span></code>.</p></li>
<li><p>Cloud Pak is configured with an Edge Gateway.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.9 and Python 3.11 are supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>jinja2~=3.1.0</p></li>
<li><p>resilient_circuits&gt;=50.0.0</p></li>
<li><p>simplejson~=3.19.0</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="sentinel-configuration">
<h2>Sentinel Configuration<a class="headerlink" href="#sentinel-configuration" title="Link to this heading">¶</a></h2>
<p>Several steps are necessary to enable API access to Sentinel. Below is a brief list of steps to complete:</p>
<ol class="arabic">
<li><p>Define an App under <code class="docutils literal notranslate"><span class="pre">App</span> <span class="pre">registration</span></code>,  for Sentinel access. The Application (client) ID will be used as the app.config <code class="docutils literal notranslate"><span class="pre">client_id</span></code>.</p>
<p>a. Specify a client secret. This will be used in the app.config file as <code class="docutils literal notranslate"><span class="pre">api_secret</span></code>.</p>
</li>
</ol>
<p><img alt="screenshot: app client_id" src="../_images/app_client_id.png" />
<img alt="screenshot: app secret" src="../_images/app_secret.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Define a workspace and resource group for the subscription. These names will be defined in the app.config file as <code class="docutils literal notranslate"><span class="pre">workspace_name</span></code> and <code class="docutils literal notranslate"><span class="pre">resource_groupname</span></code>.</p></li>
</ol>
<p><img alt="screenshot: subscription role" src="../_images/workspace_resource_group.png" /></p>
<ol class="arabic simple" start="3">
<li><p>For your resource group, specify the app with the Sentinel Responder role.</p></li>
</ol>
<p><img alt="screenshot: subscription role" src="../_images/subscription_role.png" /></p>
<ol class="arabic simple" start="4">
<li><p>Add your tenant_id (Under <code class="docutils literal notranslate"><span class="pre">Tenant</span> <span class="pre">properties</span></code>) and subscription_id to the app.config file.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>azure_url</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://management.azure.com</span></code></p></td>
<td><p><em>URL for Azure access. This field is typically not changed</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ms_sentinel_labels</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">label1</span></code></p></td>
<td><p><em>A comma separated list of label(s) to access</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_lookback</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">120</span></code></p></td>
<td><p><em># of minutes to look back for incident changes. This is used only the first time the app starts</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_interval</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60</span></code></p></td>
<td><p><em># of Seconds to wait until checking for changes in Sentinel. Comment out to disable the poller</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>api_version</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2023-11-01-preview</span></code></p></td>
<td><p><em>API version to use when making API calls to Microsoft Sentinel. Sentinel API versions can be found https://learn.microsoft.com/en-us/rest/api/securityinsights/api-versions</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>https_proxy</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https:/your.proxy.com</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><strong>http_proxy</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">http:/your.proxy.com</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><strong>verify</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p><em>verify= false or /path/to/client_certificate.pem</em></p></td>
</tr>
</tbody>
</table>
</div>
<p>For each labeled server:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>tenant_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aaa-bbb-ccc</span></code></p></td>
<td><p><em>Your tenant_id</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>client_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aaa-bbb-ddd</span></code></p></td>
<td><p><em>Your App Id or client_id</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>app_secret</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aaa-bbb-eee</span></code></p></td>
<td><p><em>Your app secret</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>subscription_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aaa-bbb-fff</span></code></p></td>
<td><p>*subscription_id for incident access *</p></td>
</tr>
<tr class="row-even"><td><p><strong>workspace_name</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p>``</p></td>
<td><p><em>workspace name for incident access.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>resource_groupname</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p>``</p></td>
<td><p><em>resource group for incident access.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>new_incident_filters</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;status&quot;:</span> <span class="pre">[&quot;New&quot;,</span> <span class="pre">&quot;Active&quot;],&quot;severity&quot;:</span> <span class="pre">[&quot;High&quot;,</span> <span class="pre">&quot;Medium&quot;,&quot;Low&quot;]</span></code></p></td>
<td><p>*Set of filters to apply when escalating incidents to SOAR. Incidents not matching the criteria are not synchronized. In this example, both a match of status and severity would be required. *</p></td>
</tr>
<tr class="row-odd"><td><p><strong>poller_filters_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/var/rescircuits/poller_filters_template.jinja</p></td>
<td><p>Customer supplied template for filters to apply to new Sentinel incidents found by the poller.</p></td>
</tr>
<tr class="row-even"><td><p><strong>max_alerts</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p>10</p></td>
<td><p><em>limit the number of alerts per sentinel incident to the first n alerts or leave blank for all alerts</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>close_soar_case</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Whether the SOAR case should be closed when its linked Sentinel incident is closed. If set to False the linked SOAR case will be updated, but not closed.</p></td>
</tr>
<tr class="row-even"><td><p><strong>create_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/var/rescircuits/create_incident_template.jinja</p></td>
<td><p>Customer supplied template for mapping Sentinel Incident fields to an SOAR incident. If not specified, a default template is used.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/var/rescircuits/update_incident_template.jinja</p></td>
<td><p>Customer supplied template for mapping Sentinel Incident fields to an SOAR incident. If not specified, a default template is used.</p></td>
</tr>
<tr class="row-even"><td><p><strong>close_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/var/rescircuits/close_incident_template.jinja</p></td>
<td><p>Customer supplied template for mapping Sentinel Incident fields to an SOAR incident. If not specified, a default template is used. This is useful when a customer customizes the fields used when closing an incident.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>sentinel_update_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/var/rescircuits/update_sentinel_incident_template.jinja</p></td>
<td><p>Customer supplied template for updating a sentinel incident when the SOAR incident is updated</p></td>
</tr>
<tr class="row-even"><td><p><strong>sentinel_close_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/var/rescircuits/update_sentinel_incident_template.jinja</p></td>
<td><p>Customer supplied template for closing a sentinel incident when the SOAR incident is closed</p></td>
</tr>
</tbody>
</table>
</div>
<p>See the section below for examples of the templates.</p>
<hr class="docutils" />
<p><img alt="screenshot: function-list " src="../_images/function_list.png" /></p>
</section>
</section>
<section id="function-sentinel-add-incident-comment">
<h2>Function - Sentinel Add Incident Comment<a class="headerlink" href="#function-sentinel-add-incident-comment" title="Link to this heading">¶</a></h2>
<p>Create a comment for a given Sentinel incident. This is used by a playbook to automatically sync
SOAR Comments with Sentinel.</p>
<p><img alt="screenshot: fn-sentinel-add-incident-comment " src="../_images/fn-sentinel-add-incident-comment.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_comment</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comment to add to the Sentinel Incident.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID of a Sentinel Incident.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Label give to the Sentinel server in the app.config. Example in app.config [fn_microsoft_sentinel:label1] the label here is label1.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_profile</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The Sentinel profile name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1f017068-0000-0100-0000-6616d57f0000</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/Incidents/b3763ac5-6319-496b-b404-6c5000418a81/Comments/42acd50c-f765-11ee-ab89-fa89897771d8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;42acd50c-f765-11ee-ab89-fa89897771d8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Comment created from external application - MS Sentinel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;objectId&quot;</span><span class="p">:</span> <span class="s2">&quot;fb5360be-0c6a-4260-ae69-9b07dd735441&quot;</span><span class="p">,</span>
        <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">:</span> <span class="n">null</span>
      <span class="p">},</span>
      <span class="s2">&quot;createdTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T18:07:59.058255Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastModifiedTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T18:07:59.058255Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;From IBM SOAR:</span><span class="se">\n</span><span class="s2">hello&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/Incidents/Comments&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sentinel_incident_comment&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_label&quot;</span><span class="p">:</span> <span class="s2">&quot;label1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1497</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-microsoft-sentinel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10 14:07:59&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_incident_comment</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">content</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_number</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_profile</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_label</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">comment_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="c1"># Get the current time</span>
  <span class="n">dt_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
  <span class="c1"># note.text = f&quot;&lt;b&gt;Sent to Sentinel at {dt_now}&lt;/b&gt;&lt;br&gt;{str(note.text.content)}&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sentinel Comment Sync failed with reason: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sentinel-get-incident-alerts">
<h2>Function - Sentinel Get Incident Alerts<a class="headerlink" href="#function-sentinel-get-incident-alerts" title="Link to this heading">¶</a></h2>
<p>Sentinel Get Incident Alerts</p>
<p><img alt="screenshot: fn-sentinel-get-incident-alerts " src="../_images/fn-sentinel-get-incident-alerts.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID of a Sentinel Incident.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Label give to the Sentinel server in the app.config. Example in app.config [fn_microsoft_sentinel:label1] the label here is label1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_profile</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The Sentinel profile name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/Entities/4c4831e9-2ed7-a44a-e530-c784cc7c2ddc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;SecurityAlert&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;4c4831e9-2ed7-a44a-e530-c784cc7c2ddc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;additionalData&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;AlertMessageEnqueueTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T15:29:49.911Z&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MTP_Classification&quot;</span><span class="p">:</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;OriginalProductComponentName&quot;</span><span class="p">:</span> <span class="s2">&quot;Databases&quot;</span><span class="p">,</span>
            <span class="s2">&quot;OriginalProductName&quot;</span><span class="p">:</span> <span class="s2">&quot;Azure Security Center&quot;</span><span class="p">,</span>
            <span class="s2">&quot;StoreAlertPublisher&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">Succeeded</span><span class="se">\&quot;</span><span class="s2">:true,</span><span class="se">\&quot;</span><span class="s2">Reason</span><span class="se">\&quot;</span><span class="s2">:null,</span><span class="se">\&quot;</span><span class="s2">PublishTime</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">2024-04-10T15:29:41.6565662Z</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;effectiveSubscriptionId&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;alertDisplayName&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspected brute-force attack attempt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;alertLink&quot;</span><span class="p">:</span> <span class="s2">&quot;https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2516895378499999999_c01aa88b-4520-4c62-a80d-c61f3dfaf47e/subscriptionId/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroup/DemoAssets/referencedFrom/alertDeepLink/location/centralus&quot;</span><span class="p">,</span>
          <span class="s2">&quot;alertType&quot;</span><span class="p">:</span> <span class="s2">&quot;SQL.VM_BruteForce&quot;</span><span class="p">,</span>
          <span class="s2">&quot;compromisedEntity&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;confidenceLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Brute-force attack is a common attack technique for finding valid credentials to the database. By submitting many users/passwords combinations, an attacker can guess a correct one.</span><span class="se">\r\n</span><span class="s2">Once obtained, an attacker can have full access to the database. While this specific alert doesn</span><span class="se">\u0027</span><span class="s2">t indicate a successful brute-force, it is advised to take safety measures to protect your resource against this attack.</span><span class="se">\r\n</span><span class="s2">To investigate this suspected brute-force attempt, review it</span><span class="se">\u0027</span><span class="s2">s origin (based on the application name and IP/Location), and try to find out whether it</span><span class="se">\u0027</span><span class="s2">s recognized to you, or suspicious.</span><span class="se">\r\n</span><span class="s2">If you believe this to be an attack on your database, use firewall rules to limit the access to your resource, and make sure you use strong passwords and not well known user names.</span><span class="se">\r\n</span><span class="s2">Also, consider using only AAD authentication to further enhance your security posture.</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="s2">&quot;endTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T15:29:10Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspected brute-force attack attempt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;processingEndTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T15:29:40.734843Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;productComponentName&quot;</span><span class="p">:</span> <span class="s2">&quot;Databases&quot;</span><span class="p">,</span>
          <span class="s2">&quot;productName&quot;</span><span class="p">:</span> <span class="s2">&quot;Azure Security Center&quot;</span><span class="p">,</span>
          <span class="s2">&quot;providerAlertId&quot;</span><span class="p">:</span> <span class="s2">&quot;2516895378499999999_c01aa88b-4520-4c62-a80d-c61f3dfaf47e&quot;</span><span class="p">,</span>
          <span class="s2">&quot;remediationSteps&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;* Apply [workflow automation](https://go.microsoft.com/fwlink/?linkid=2174808) to block future attacks.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Consider [blocking the IP address](https://go.microsoft.com/fwlink/?linkid=2099055) of the attacking client and hardening your firewall.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* When possible, use [Windows authentication](https://go.microsoft.com/fwlink/?linkid=2129121) and disable SQL Server authentication.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Use [strong passwords](https://go.microsoft.com/fwlink/?linkid=2099068) and avoid reusing them across multiple databases.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* If applicable, disable default and well known application/database accounts such as SA.&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;resourceIdentifiers&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;resourceId&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/DemoAssets/providers/Microsoft.Compute/virtualMachines/PAMSqlSv&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subscriptionId&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span><span class="p">,</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;AzureResource&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;agentId&quot;</span><span class="p">:</span> <span class="s2">&quot;7db452ea-1cae-4079-94a5-85dc76156e96&quot;</span><span class="p">,</span>
              <span class="s2">&quot;subscriptionId&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span><span class="p">,</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LogAnalytics&quot;</span><span class="p">,</span>
              <span class="s2">&quot;workspaceId&quot;</span><span class="p">:</span> <span class="s2">&quot;c6c712b0-dc3d-4408-945a-4bde1db6579b&quot;</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
          <span class="s2">&quot;startTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T15:29:10Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;New&quot;</span><span class="p">,</span>
          <span class="s2">&quot;systemAlertId&quot;</span><span class="p">:</span> <span class="s2">&quot;4c4831e9-2ed7-a44a-e530-c784cc7c2ddc&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tactics&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;PreAttack&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;timeGenerated&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T15:29:49.9010714Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;timeGenerated_ms&quot;</span><span class="p">:</span> <span class="mi">1712762989000</span><span class="p">,</span>
          <span class="s2">&quot;vendorName&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/Entities&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sentinel_incident_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_label&quot;</span><span class="p">:</span> <span class="s2">&quot;label1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">883</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-microsoft-sentinel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10 14:07:28&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_number</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_profile</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_label</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">current_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">alerts_results</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">):</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;sentinel_incident_alerts&quot;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_dt</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeGenerated_ms&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alertDisplayName&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alertType&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_severity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;severity&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_confidence_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;confidenceLevel&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_tactics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tactics&#39;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_compromised_entity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;compromisedEntity&#39;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_remediation_steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;remediationSteps&#39;</span><span class="p">,</span> <span class="p">[])))</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;systemAlertId&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alertLink&#39;</span><span class="p">):</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;</span><span class="si">{</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alertLink&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&gt;Alert Link&lt;/a&gt;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;https://security.microsoft.com/alerts/</span><span class="si">{</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;systemAlertId&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&gt;Alert Link&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sentinel Incident Sync failed with reason: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sentinel-get-incident-comments">
<h2>Function - Sentinel Get Incident Comments<a class="headerlink" href="#function-sentinel-get-incident-comments" title="Link to this heading">¶</a></h2>
<p>Get Comments from a Sentinel Incident.</p>
<p><img alt="screenshot: fn-sentinel-get-incident-comments " src="../_images/fn-sentinel-get-incident-comments.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IncidentID</span></code></p></td>
<td><p>SOAR Incident ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID of a Sentinel Incident.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Label give to the Sentinel server in the app.config. Example in app.config [fn_microsoft_sentinel:label1] the label here is label1.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_profile</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The Sentinel profile name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1f016d66-0000-0100-0000-6616d56e0000</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/Incidents/b3763ac5-6319-496b-b404-6c5000418a81/Comments/aebab623-5e91-43a7-b7a6-541548fc738f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;aebab623-5e91-43a7-b7a6-541548fc738f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;example@microsoft.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;objectId&quot;</span><span class="p">:</span> <span class="s2">&quot;43dd7b73-6a70-475e-88c3-609a9f30b514&quot;</span><span class="p">,</span>
            <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">:</span> <span class="s2">&quot;example@microsoft.com&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;createdTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T18:07:42.5540333Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;lastModifiedTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T18:07:42.5540333Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/Incidents/Comments&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2121</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_label&quot;</span><span class="p">:</span> <span class="s2">&quot;label1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1044</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-microsoft-sentinel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10 14:07:55&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_number</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_profile</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_label</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">comment_results</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">):</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">comment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sentinel Get Incident Comments failed with reason: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sentinel-get-incident-entities">
<h2>Function - Sentinel Get Incident Entities<a class="headerlink" href="#function-sentinel-get-incident-entities" title="Link to this heading">¶</a></h2>
<p>Get the Entities associated with a Sentinel Incident.</p>
<p><img alt="screenshot: fn-sentinel-get-incident-entities " src="../_images/fn-sentinel-get-incident-entities.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID of a Sentinel Incident.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Label give to the Sentinel server in the app.config. Example in app.config [fn_microsoft_sentinel:label1] the label here is label1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_profile</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The Sentinel profile name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81_4c4831e9-2ed7-a44a-e530-c784cc7c2ddc&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/entities/b9ce5c65-0b04-27bf-c4af-c5926008a5d3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;Ip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;b9ce5c65-0b04-27bf-c4af-c5926008a5d3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;80.66.76.30&quot;</span><span class="p">,</span>
          <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;80.66.76.30&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;resilient_artifact_type&quot;</span><span class="p">:</span> <span class="s2">&quot;IP Address&quot;</span><span class="p">,</span>
        <span class="s2">&quot;resilient_artifact_value&quot;</span><span class="p">:</span> <span class="s2">&quot;80.66.76.30&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/entities&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/entities/8e6ffdf6-05ab-b16e-aaa7-c3465af09c46&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;AzureResource&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;8e6ffdf6-05ab-b16e-aaa7-c3465af09c46&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;additionalData&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ResourceName&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ResourceType&quot;</span><span class="p">:</span> <span class="s2">&quot;Virtual Machine&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;resourceId&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/DemoAssets/providers/Microsoft.Compute/virtualMachines/PAMSqlSv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;subscriptionId&quot;</span><span class="p">:</span> <span class="s2">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;resilient_artifact_type&quot;</span><span class="p">:</span> <span class="s2">&quot;String&quot;</span><span class="p">,</span>
        <span class="s2">&quot;resilient_artifact_value&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/entities&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/entities/eda45dbc-9011-cfbc-4e9b-4fd97d44f069&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;Host&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;eda45dbc-9011-cfbc-4e9b-4fd97d44f069&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;azureID&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/DemoAssets/providers/Microsoft.Compute/virtualMachines/PAMSqlSv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostName&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;omsAgentID&quot;</span><span class="p">:</span> <span class="s2">&quot;7db452ea-1cae-4079-94a5-85dc76156e96&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;resilient_artifact_type&quot;</span><span class="p">:</span> <span class="s2">&quot;System Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;resilient_artifact_value&quot;</span><span class="p">:</span> <span class="s2">&quot;PAMSqlSv&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/entities&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/entities/7cc5b89b-7a07-55eb-cfb1-a8a8afd5c67e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;7cc5b89b-7a07-55eb-cfb1-a8a8afd5c67e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;accountName&quot;</span><span class="p">:</span> <span class="s2">&quot;sa&quot;</span><span class="p">,</span>
          <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;sa&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;resilient_artifact_type&quot;</span><span class="p">:</span> <span class="s2">&quot;User Account&quot;</span><span class="p">,</span>
        <span class="s2">&quot;resilient_artifact_value&quot;</span><span class="p">:</span> <span class="s2">&quot;sa&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/entities&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sentinel_incident_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_label&quot;</span><span class="p">:</span> <span class="s2">&quot;label1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">2788</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-microsoft-sentinel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10 14:08:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_number</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_profile</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_label</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">current_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">entities_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alert</span><span class="p">):</span>
      <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;sentinel_incident_entities&quot;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_dt</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;entity_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;entity_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kind&#39;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;entity_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;friendlyName&#39;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;entity_properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt;: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
      <span class="c1"># Create an artifact</span>
      <span class="n">desc</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;created from Sentinel entity: </span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;azureID&#39;</span><span class="p">):</span>
        <span class="n">desc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;azureID&#39;</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resilient_artifact_type&#39;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resilient_artifact_type&#39;</span><span class="p">),</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resilient_artifact_value&#39;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">desc</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sentinel Incident Sync failed with reason: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sentinel-update-incident">
<h2>Function - Sentinel Update Incident<a class="headerlink" href="#function-sentinel-update-incident" title="Link to this heading">¶</a></h2>
<p>Update / Close a Sentinel incident based on Sentinel field changes in the SOAR Incident.</p>
<p><img alt="screenshot: fn-sentinel-update-incident " src="../_images/fn-sentinel-update-incident.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IncidentID</span></code></p></td>
<td><p>SOAR Incident ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The ID of a Sentinel Incident.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Label give to the Sentinel server in the app.config. Example in app.config [fn_microsoft_sentinel:label1] the label here is label1.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sentinel_profile</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The Sentinel profile name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1f01df97-0000-0100-0000-6616d7020000</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/Incidents/b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;additionalData&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;alertProductNames&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;Azure Security Center&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;alertsCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;bookmarksCount&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;commentsCount&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;tactics&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;PreAttack&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;techniques&quot;</span><span class="p">:</span> <span class="p">[]</span>
      <span class="p">},</span>
      <span class="s2">&quot;createdTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T15:29:50.0960914Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Brute-force attack is a common attack technique for finding valid credentials to the database. By submitting many users/passwords combinations, an attacker can guess a correct one.</span><span class="se">\u00a0</span><span class="s2"> Once obtained, an attacker can have full access to the database. While this specific alert doesn</span><span class="se">\u0027</span><span class="s2">t indicate a successful brute-force, it is advised to take safety measures to protect your resource against this attack.</span><span class="se">\u00a0</span><span class="s2"> To investigate this suspected brute-force attempt, review it</span><span class="se">\u0027</span><span class="s2">s origin (based on the application name and IP/Location), and try to find out whether it</span><span class="se">\u0027</span><span class="s2">s recognized to you, or suspicious.</span><span class="se">\u00a0</span><span class="s2"> If you believe this to be an attack on your database, use firewall rules to limit the access to your resource, and make sure you use strong passwords and not well known user names.</span><span class="se">\u00a0</span><span class="s2"> Also, consider using only AAD authentication to further enhance your security posture.</span><span class="se">\u00a0</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;incidentNumber&quot;</span><span class="p">:</span> <span class="mi">4609</span><span class="p">,</span>
      <span class="s2">&quot;incidentUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;https://portal.azure.com/#asset/Microsoft_Azure_Security_Insights/Incident/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/Incidents/b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
      <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;labelName&quot;</span><span class="p">:</span> <span class="s2">&quot;test tag&quot;</span><span class="p">,</span>
          <span class="s2">&quot;labelType&quot;</span><span class="p">:</span> <span class="s2">&quot;User&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;labelName&quot;</span><span class="p">:</span> <span class="s2">&quot;another label&quot;</span><span class="p">,</span>
          <span class="s2">&quot;labelType&quot;</span><span class="p">:</span> <span class="s2">&quot;User&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;lastModifiedTimeUtc&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10T18:14:26.8445378Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;assignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;objectId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;ownerType&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">:</span> <span class="n">null</span>
      <span class="p">},</span>
      <span class="s2">&quot;providerIncidentId&quot;</span><span class="p">:</span> <span class="s2">&quot;4609&quot;</span><span class="p">,</span>
      <span class="s2">&quot;providerName&quot;</span><span class="p">:</span> <span class="s2">&quot;Azure Sentinel&quot;</span><span class="p">,</span>
      <span class="s2">&quot;relatedAnalyticRuleIds&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/demoassets/providers/Microsoft.OperationalInsights/workspaces/AzureSentinelDemo/providers/Microsoft.SecurityInsights/alertRules/14fefa89-3cdd-429f-923b-b524aa8c65c3&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Active&quot;</span><span class="p">,</span>
      <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspected brute-force attack attempt&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft.SecurityInsights/Incidents&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2121</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b3763ac5-6319-496b-b404-6c5000418a81&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_label&quot;</span><span class="p">:</span> <span class="s2">&quot;label1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">2209</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-microsoft-sentinel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-10 14:14:26&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_number</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_profile</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_profile</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">sentinel_label</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sentinel_label</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Activation Type</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sentinel: Comment Sync - Example (PB)</p></td>
<td><p>Sync an Incident note to a Sentinel Incident comment.</p></td>
<td><p>Automatic</p></td>
<td><p>note</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sentinel_incident_number</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">note.text</span> <span class="pre">not_contains</span> <span class="pre">From</span> <span class="pre">Sentinel</span> <span class="pre">AND</span> <span class="pre">object_added</span> <span class="pre">AND</span> <span class="pre">(incident.properties.sentinel_profile</span> <span class="pre">has_a_value</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_label</span> <span class="pre">has_a_value)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel: Get Incident Alerts - Example (PB)</p></td>
<td><p>Get alerts for a Sentinel Incident.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sentinel_incident_number</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">(incident.properties.sentinel_profile</span> <span class="pre">has_a_value</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_label</span> <span class="pre">has_a_value)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sentinel: Get Incident Comments - Example (PB)</p></td>
<td><p>Get Sentinel incident comments.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sentinel_incident_number</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">(incident.properties.sentinel_profile</span> <span class="pre">has_a_value</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_label</span> <span class="pre">has_a_value)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel: Get Incident Entities - Example (PB)</p></td>
<td><p>Get Entities for a Sentinel Incident.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sentinel_incident_number</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">(incident.properties.sentinel_profile</span> <span class="pre">has_a_value</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_label</span> <span class="pre">has_a_value)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sentinel: Incident Sync - Example (PB)</p></td>
<td><p>Sync SOAR incident with linked Sentinel incident.</p></td>
<td><p>Automatic</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sentinel_incident_number</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">object_added</span> <span class="pre">AND</span> <span class="pre">(incident.properties.sentinel_profile</span> <span class="pre">has_a_value</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_label</span> <span class="pre">has_a_value)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel: Update Incident - Example (PB)</p></td>
<td><p>Update SOAR incident with new information from the Sentinel incident.</p></td>
<td><p>Automatic</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sentinel_incident_number</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">(incident.description</span> <span class="pre">changed</span> <span class="pre">OR</span> <span class="pre">incident.name</span> <span class="pre">changed</span> <span class="pre">OR</span> <span class="pre">incident.resolution_id</span> <span class="pre">changed</span> <span class="pre">OR</span> <span class="pre">incident.resolution_summary</span> <span class="pre">changed</span> <span class="pre">OR</span> <span class="pre">incident.severity_code</span> <span class="pre">changed</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_incident_labels</span> <span class="pre">changed)</span> <span class="pre">AND</span> <span class="pre">(incident.properties.sentinel_profile</span> <span class="pre">has_a_value</span> <span class="pre">OR</span> <span class="pre">incident.properties.sentinel_label</span> <span class="pre">has_a_value)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="custom-layouts">
<h2>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Import the Data Tables and Custom Fields like the screenshot below:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts16.png" /></p>
<p>The Sentinel fields are used to capture information specific on a Sentinel Incident, including close incident information (Classification). The datatable, Sentinel Entities, is used to capture specific entity information. Another datatable, Sentinel Comment IDs, is used for tracking purposes and need not be added to a layout.</p>
</li>
</ul>
</section>
<section id="data-table-sentinel-incident-alerts">
<h2>Data Table - Sentinel Incident Alerts<a class="headerlink" href="#data-table-sentinel-incident-alerts" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-sentinel-incident-alerts" src="../_images/dt-sentinel-incident-alerts.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>sentinel_incident_alerts</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Alert Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>Date and time of the Sentinel Alert.</p></td>
</tr>
<tr class="row-odd"><td><p>Alert Id</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Sentinel Alert ID.</p></td>
</tr>
<tr class="row-even"><td><p>Alert Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Name of the Sentinel Alert.</p></td>
</tr>
<tr class="row-odd"><td><p>Alert Type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>The Type of Sentinel Alert.</p></td>
</tr>
<tr class="row-even"><td><p>Compromised Entity</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_compromised_entity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Compromised Entities on the Sentinel Alert.</p></td>
</tr>
<tr class="row-odd"><td><p>Confidence Level</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_confidence_level</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Confidence level of the Sentinel Alert.</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>Description of the Sentinel Alert.</p></td>
</tr>
<tr class="row-odd"><td><p>Link</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>URL link to the Sentinel Alert.</p></td>
</tr>
<tr class="row-even"><td><p>Remediation Steps</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_remediation_steps</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>Remediation steps from the Sentinel Alert.</p></td>
</tr>
<tr class="row-odd"><td><p>Report Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">report_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>Report date of the Sentinel Incident.</p></td>
</tr>
<tr class="row-even"><td><p>Severity</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_severity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Severity of the Sentinel Alert.</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Status of the Sentinel Alert.</p></td>
</tr>
<tr class="row-even"><td><p>Tactics</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_tactics</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Tactics of the Sentinel Alert.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-sentinel-incident-entities">
<h2>Data Table - Sentinel Incident Entities<a class="headerlink" href="#data-table-sentinel-incident-entities" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-sentinel-incident-entities" src="../_images/dt-sentinel-incident-entities.png" /></p>
<section id="id1">
<h3>API Name:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>sentinel_incident_entities</p>
</section>
<section id="id2">
<h3>Columns:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Alert ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>The Sentinel Alert ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Entity ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">entity_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>The Sentinel Entity ID.</p></td>
</tr>
<tr class="row-even"><td><p>Entity Properties</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">entity_properties</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>The properties of the Sentinel Entity.</p></td>
</tr>
<tr class="row-odd"><td><p>Entity Type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">entity_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>The type of the Sentinel Entity.</p></td>
</tr>
<tr class="row-even"><td><p>Entity Value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">entity_value</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>The value of the Sentinel Entity.</p></td>
</tr>
<tr class="row-odd"><td><p>Report Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">report_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>The reported date and time of the Sentinel Incident.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sentinel Incident Assigned To</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_assigned_to</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel Incident Classification</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_classification</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel Incident Classification Comment</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_classification_comment</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel Incident Classification Reason</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_classification_reason</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel Incident ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel Incident Labels</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_labels</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel Incident Number</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_number</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel Incident Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel Incident Tactics</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_tactics</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel Incident URL</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_incident_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel Server Label</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_label</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>Label give to the Sentinel server in the app.config. Example in app.config [fn_microsoft_sentinel:label1] the label here is label1.</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel Profile</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sentinel_profile</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="custom-templates">
<h2>Custom Templates<a class="headerlink" href="#custom-templates" title="Link to this heading">¶</a></h2>
<p>Below are examples of templates for creating, updating, and closing SOAR incidents. Customize these templates and refer to them in our app.config file.</p>
<p>Each template should be reviewed for correctness in your enterprise.
For instance, closing a SOAR incident may include additional custom fields which the default template
does not include. Or, remove the <code class="docutils literal notranslate"><span class="pre">owner_id</span></code> mapping entry entirely.</p>
<p>In addition, the <code class="docutils literal notranslate"><span class="pre">incident_creation_template</span></code> and <code class="docutils literal notranslate"><span class="pre">incident_update_template</span></code> includes the following
mapping:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span><span class="c1"># if Sentinel users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
  <span class="p">{</span><span class="c1"># {{ properties.owner.assignedTo|soar_substitute(&#39;{&quot;sentinel_user1@co.com&quot;: &quot;soar_user1@ent.com&quot;, &quot;sentinel_user2@co.com&quot;: &quot;soar_user2@ent.com&quot;}&#39;) }} #}</span>
  <span class="s2">&quot;owner_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.owner.assignedTo }}&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>If your Sentinel login users differ from SOAR users, modify the <code class="docutils literal notranslate"><span class="pre">owner_id</span></code> mapping to use a substitution map as indicated in the jinja comment.</p>
<section id="incident-create-template-jinja">
<h3>incident_create_template.jinja<a class="headerlink" href="#incident-create-template-jinja" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for creating a new SOAR incident from a Sentinel incident. #}</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sentinel Incident {{ properties.incidentNumber|e }} - {{ properties.title|replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;discovered_date&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">properties</span><span class="o">.</span><span class="n">createdTimeUtc</span><span class="o">|</span><span class="n">soar_datetimeformat</span> <span class="p">}},</span>
  <span class="s2">&quot;start_date&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">firstActivityTimeUtc</span> <span class="o">%</span><span class="p">}</span> <span class="p">{{</span> <span class="n">properties</span><span class="o">.</span><span class="n">firstActivityTimeUtc</span><span class="o">|</span><span class="n">soar_datetimeformat</span> <span class="p">}}</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="p">{{</span> <span class="n">properties</span><span class="o">.</span><span class="n">createdTimeUtc</span><span class="o">|</span><span class="n">soar_datetimeformat</span> <span class="p">}}</span> <span class="p">{</span><span class="o">%</span><span class="n">endif</span> <span class="o">%</span><span class="p">},</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">description</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
      <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.description|replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) }}&quot;</span>
    <span class="p">},</span>
  <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="c1"># if Sentinel users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
  <span class="p">{</span><span class="c1"># &quot;owner_id&quot;: &quot;{{ properties.owner.userPrincipalName|soar_substitute(&#39;{&quot;sentinel_user1@co.com&quot;: &quot;soar_user1@ent.com&quot;, &quot;sentinel_user2@co.com&quot;: &quot;soar_user2@ent.com&quot;, &quot;DEFAULT&quot;: &quot;default_user@ent.com&quot; }&#39;) }}&quot;, #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.status|soar_substitute(&#39;{&quot;</span><span class="n">Closed</span><span class="s2">&quot;: &quot;</span><span class="n">C</span><span class="s2">&quot;, &quot;</span><span class="n">Active</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">New</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.severity|soar_substitute(&#39;{&quot;</span><span class="n">Informational</span><span class="s2">&quot;: &quot;</span><span class="n">Low</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sentinel_incident_number&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ name|e }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.incidentNumber }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.status }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_url&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;{{ properties.incidentUrl }}&#39;&gt;Sentinel Incident&lt;/a&gt;&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">classification</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_incident_classification&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classification }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">classificationReason</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_incident_classification_reason&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classificationReason }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">classificationComment</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_incident_classification_comment&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classificationComment|replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">assignedTo</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_incident_assigned_to&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.owner.assignedTo }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">labels</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_incident_labels&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.labels | map(attribute=&#39;labelName&#39;) | join(&#39;,&#39;) | replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) | replace(&#39;</span><span class="se">\\</span><span class="s2">&#39;, &#39;</span><span class="se">\\\\</span><span class="s2">&#39;) }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">additionalData</span><span class="o">.</span><span class="n">tactics</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_incident_tactics&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.additionalData.tactics|join(&#39; &#39;) }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">soar_profile</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ soar_profile }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">resilient_profile</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_profile&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ resilient_profile }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">soar_label</span> <span class="o">%</span><span class="p">}</span>
      <span class="p">,</span><span class="s2">&quot;sentinel_label&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ soar_label }}&quot;</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;Closed&quot;</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">,</span>
    <span class="s2">&quot;resolution_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resolution_summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Closed by Sentinel&quot;</span>
  <span class="p">{</span><span class="o">%</span><span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">}</span>

</pre></div>
</div>
</section>
<section id="incident-update-template-jinja">
<h3>incident_update_template.jinja<a class="headerlink" href="#incident-update-template-jinja" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for updating a new SOAR incident from a Sentinel incident. #}</span>
  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.description|replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) }}&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span><span class="c1"># if Sentinel users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
  <span class="p">{</span><span class="c1"># &quot;owner_id&quot;: &quot;{{ properties.owner.userPrincipalName|soar_substitute(&#39;{&quot;sentinel_user1@co.com&quot;: &quot;soar_user1@ent.com&quot;, &quot;sentinel_user2@co.com&quot;: &quot;soar_user2@ent.com&quot;, &quot;DEFAULT&quot;: &quot;default_user@ent.com&quot; }&#39;) }}&quot;, #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.status|soar_substitute(&#39;{&quot;</span><span class="n">Closed</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">Active</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;, &quot;</span><span class="n">New</span><span class="s2">&quot;: &quot;</span><span class="n">A</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.severity|soar_substitute(&#39;{&quot;</span><span class="n">Informational</span><span class="s2">&quot;: &quot;</span><span class="n">Low</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sentinel_incident_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.status }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_classification&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classification }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_classification_reason&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classificationReason }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_classification_comment&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classificationComment|replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_assigned_to&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.owner.assignedTo }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_labels&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.labels | map(attribute=&#39;labelName&#39;) | join(&#39;,&#39;) | replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) | replace(&#39;</span><span class="se">\\</span><span class="s2">&#39;, &#39;</span><span class="se">\\\\</span><span class="s2">&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_tactics&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.additionalData.tactics|join(&#39; &#39;) }}&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="incident-close-template-jinja">
<h3>incident_close_template.jinja<a class="headerlink" href="#incident-close-template-jinja" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for closing a new SOAR incident from a Sentinel incident. #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
  <span class="s2">&quot;resolution_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;resolution_summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Closed by Sentinel&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sentinel_incident_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.status }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_classification&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classification }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_classification_reason&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classificationReason }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_classification_comment&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.classificationComment|safe }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_assigned_to&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.owner.assignedTo }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_labels&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.labels | map(attribute=&#39;labelName&#39;) | join(&#39;,&#39;) | replace(&#39;&quot;</span><span class="s1">&#39;, &#39;</span>\\<span class="s2">&quot;&#39;) | replace(&#39;</span><span class="se">\\</span><span class="s2">&#39;, &#39;</span><span class="se">\\\\</span><span class="s2">&#39;) }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sentinel_incident_tactics&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.additionalData.tactics|join(&#39; &#39;) }}&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="sentinel-close-incident-template-jinja">
<h3>sentinel_close_incident_template.jinja<a class="headerlink" href="#sentinel-close-incident-template-jinja" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="p">{</span><span class="c1"># JINJA template for closing a new Sentinel incident from a SOAR incident. #}</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ name|soar_splitpart(1)}}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ severity_code|string|soar_substitute(&#39;{&quot;</span><span class="n">Low</span><span class="s2">&quot;: &quot;</span><span class="n">Low</span><span class="s2">&quot;, &quot;</span><span class="n">Medium</span><span class="s2">&quot;: &quot;</span><span class="n">Medium</span><span class="s2">&quot;, &quot;</span><span class="n">High</span><span class="s2">&quot;: &quot;</span><span class="n">High</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Closed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;classification&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ resolution_id|string|soar_substitute(&#39;{&quot;</span><span class="n">Unresolved</span><span class="s2">&quot;: &quot;</span><span class="n">Undetermined</span><span class="s2">&quot;, &quot;</span><span class="n">Duplicate</span><span class="s2">&quot;: &quot;</span><span class="n">FalsePositive</span><span class="s2">&quot;, &quot;</span><span class="n">Not</span> <span class="n">an</span> <span class="n">Issue</span><span class="s2">&quot;: &quot;</span><span class="n">BenignPositive</span><span class="s2">&quot;, &quot;</span><span class="n">Resolved</span><span class="s2">&quot;: &quot;</span><span class="n">TruePositive</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;classificationReason&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ resolution_id|string|soar_substitute(&#39;{&quot;</span><span class="n">Unresolved</span><span class="s2">&quot;: &quot;&quot;, &quot;</span><span class="n">Duplicate</span><span class="s2">&quot;: &quot;</span><span class="n">InaccurateData</span><span class="s2">&quot;, &quot;</span><span class="n">Not</span> <span class="n">an</span> <span class="n">Issue</span><span class="s2">&quot;: &quot;</span><span class="n">SuspiciousButExpected</span><span class="s2">&quot;, &quot;</span><span class="n">Resolved</span><span class="s2">&quot;: &quot;</span><span class="n">SuspiciousActivity</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;classificationComment&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ resolution_summary|striptags|safe }}&quot;</span>
        <span class="p">{</span><span class="c1"># modify as necessary #}</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_labels</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="nb">set</span> <span class="n">label_list</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_labels</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">-%</span><span class="p">}</span>
            <span class="p">,</span><span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">label_list</span> <span class="o">%</span><span class="p">}</span>
                <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">label</span> <span class="o">%</span><span class="p">}</span>
                <span class="p">{</span>
                    <span class="s2">&quot;labelName&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">label</span> <span class="o">|</span> <span class="n">trim</span> <span class="o">|</span> <span class="n">json</span> <span class="p">}},</span>
                    <span class="s2">&quot;labelType&quot;</span><span class="p">:</span> <span class="s2">&quot;User&quot;</span>
                <span class="p">}</span>
                <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">loop</span><span class="o">.</span><span class="n">last</span> <span class="o">%</span><span class="p">},{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="sentinel-update-incident-template-jinja">
<h3>sentinel_update_incident_template.jinja<a class="headerlink" href="#sentinel-update-incident-template-jinja" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="p">{</span><span class="c1"># JINJA template for updating a new Sentinel incident from a SOAR incident. #}</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ name|soar_splitpart(1) }}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ severity_code|string|soar_substitute(&#39;{&quot;</span><span class="n">Low</span><span class="s2">&quot;: &quot;</span><span class="n">Low</span><span class="s2">&quot;, &quot;</span><span class="n">Medium</span><span class="s2">&quot;: &quot;</span><span class="n">Medium</span><span class="s2">&quot;, &quot;</span><span class="n">High</span><span class="s2">&quot;: &quot;</span><span class="n">High</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ properties.sentinel_incident_status }}&quot;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">description</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ description|striptags|safe }}&quot;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_labels</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="nb">set</span> <span class="n">label_list</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">sentinel_incident_labels</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">-%</span><span class="p">}</span>
            <span class="p">,</span><span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">label_list</span> <span class="o">%</span><span class="p">}</span>
                <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">label</span> <span class="o">%</span><span class="p">}</span>
                <span class="p">{</span>
                    <span class="s2">&quot;labelName&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">label</span> <span class="o">|</span> <span class="n">trim</span> <span class="o">|</span> <span class="n">json</span> <span class="p">}},</span>
                    <span class="s2">&quot;labelType&quot;</span><span class="p">:</span> <span class="s2">&quot;User&quot;</span>
                <span class="p">}</span>
                <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">loop</span><span class="o">.</span><span class="n">last</span> <span class="o">%</span><span class="p">},{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-poller-filter-template">
<h2>Custom poller filter template<a class="headerlink" href="#custom-poller-filter-template" title="Link to this heading">¶</a></h2>
<p>In version 2.0.0 the ability to use a jinja template for the poller filter was added.
The following is the example template that is provided with this integration. This template also shows other filter examples
that are commented out. The example template shows all Sentinel incident properties that can be filter for.</p>
<section id="poller-filters-template-jinja">
<h3>poller_filters_template.jinja<a class="headerlink" href="#poller-filters-template-jinja" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for filtering Sentinel Incidents. #}</span>
  <span class="p">{</span><span class="c1"># If the value equals true then it passed the filter. #}</span>
  <span class="p">{</span><span class="c1"># To add a filter for a property add an if else to that property where it equals true if it passes the filter. #}</span>
  <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># Example filter for title that will filter out Sentinel incidents that do not have the string &quot;TEST-&quot; in the title:</span>
  <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="s2">&quot;TEST-&quot;</span> <span class="ow">in</span> <span class="n">title</span> <span class="o">%</span><span class="p">}</span> <span class="n">true</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="n">false</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="c1">#}</span>
  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># If the severity of the Sentinel incident is High, or, Medium, or Low then the Sentinel incident will pass this filter. #}</span>
  <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">severity</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span> <span class="n">true</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="n">false</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">},</span>
  <span class="p">{</span><span class="c1"># If the status of the Sentinel incident is either New or Active than the Sentinel incident will pass this filter. #}</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;New&quot;</span><span class="p">,</span> <span class="s2">&quot;Active&quot;</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span> <span class="n">true</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="n">false</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">},</span>
  <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;assignedTo&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># Example filter for assignedTo that will test if the Sentinel incident is assigned to a user in the given list:</span>
  <span class="s2">&quot;assignedTo&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">assignedTo</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span> <span class="s2">&quot;sys admin&quot;</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span> <span class="n">true</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="n">false</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="c1">#}</span>
  <span class="s2">&quot;userPrincipalName&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># labels are equal to Tags on Sentinel #}</span>
  <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># Example of filtering labels for a specific labelName:</span>
  <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
  <span class="p">{</span><span class="o">%</span> <span class="nb">set</span> <span class="n">present</span> <span class="o">=</span> <span class="n">false</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">labels</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">tag</span><span class="o">.</span><span class="n">labelName</span> <span class="o">==</span> <span class="s2">&quot;tech3&quot;</span> <span class="o">%</span><span class="p">}</span>
      <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
  <span class="c1">#}</span>
  <span class="p">{</span><span class="c1"># If the alertsCount of the Sentinel incident is 0 or greater then the Sentinel incident will pass this filter. #}</span>
  <span class="s2">&quot;alertsCount&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">alertsCount</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">%</span><span class="p">}</span> <span class="n">true</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="n">false</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">},</span>
  <span class="s2">&quot;bookmarksCount&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;commentsCount&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;alertProductNames&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="p">{</span><span class="c1"># If the tactics property of the Sentinel incident is equal to PreAttack, or InitialAccess or blank then the Sentinel incident will pass this filter. #}</span>
  <span class="s2">&quot;tactics&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="s2">&quot;PreAttack&quot;</span> <span class="ow">in</span> <span class="n">tactics</span> <span class="ow">or</span> <span class="s2">&quot;InitialAccess&quot;</span> <span class="ow">in</span> <span class="n">tactics</span> <span class="ow">or</span> <span class="n">tactics</span> <span class="o">==</span> <span class="p">[]</span> <span class="o">%</span><span class="p">}</span> <span class="n">true</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span> <span class="n">false</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">},</span>
  <span class="s2">&quot;relatedAnalyticRuleIds&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;providerName&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is a IBM supported App. For assistance, see <a class="reference external" href="https://ibm.com/mysupport">https://ibm.com/mysupport</a>.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_misp/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">MISP</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_microsoft_security_graph/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Microsoft Security Graph Integration for SOAR</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Microsoft Sentinel</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li><a class="reference internal" href="#v2-1-1">v2.1.1</a></li>
<li><a class="reference internal" href="#v2-1-0">v2.1.0</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sentinel-configuration">Sentinel Configuration</a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-sentinel-add-incident-comment">Function - Sentinel Add Incident Comment</a></li>
<li><a class="reference internal" href="#function-sentinel-get-incident-alerts">Function - Sentinel Get Incident Alerts</a></li>
<li><a class="reference internal" href="#function-sentinel-get-incident-comments">Function - Sentinel Get Incident Comments</a></li>
<li><a class="reference internal" href="#function-sentinel-get-incident-entities">Function - Sentinel Get Incident Entities</a></li>
<li><a class="reference internal" href="#function-sentinel-update-incident">Function - Sentinel Update Incident</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
<li><a class="reference internal" href="#data-table-sentinel-incident-alerts">Data Table - Sentinel Incident Alerts</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-sentinel-incident-entities">Data Table - Sentinel Incident Entities</a><ul>
<li><a class="reference internal" href="#id1">API Name:</a></li>
<li><a class="reference internal" href="#id2">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#custom-templates">Custom Templates</a><ul>
<li><a class="reference internal" href="#incident-create-template-jinja">incident_create_template.jinja</a></li>
<li><a class="reference internal" href="#incident-update-template-jinja">incident_update_template.jinja</a></li>
<li><a class="reference internal" href="#incident-close-template-jinja">incident_close_template.jinja</a></li>
<li><a class="reference internal" href="#sentinel-close-incident-template-jinja">sentinel_close_incident_template.jinja</a></li>
<li><a class="reference internal" href="#sentinel-update-incident-template-jinja">sentinel_update_incident_template.jinja</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-poller-filter-template">Custom poller filter template</a><ul>
<li><a class="reference internal" href="#poller-filters-template-jinja">poller_filters_template.jinja</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>