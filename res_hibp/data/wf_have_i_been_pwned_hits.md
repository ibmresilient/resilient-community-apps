<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Have I Been Pwned Hits

## Function - Have I Been Pwned Get Breaches

### API Name
`have_i_been_pwned_get_breaches`

### Output Name
`None`

### Message Destination
`hibp`

### Pre-Processing Script
```python
inputs.email_address = artifact.value
```

### Post-Processing Script
```python
if results.success:
  if results.content:
    hit = []
    resp_data = results.content
    resp_dict = resp_data["Breaches"]
    dict_string = ""
    for breach in resp_dict:
        for dict_key, dict_value in breach.items():
          temp = ""
          aKey = str(dict_key)
          aValue = str(dict_value)
          temp = u"{}: {}".format(aKey, aValue)
          dict_string += temp
          dict_string += " || "
    hit = [
      {
        "name": "Number of Breached Sites", 
        "type": "number",
        "value": "{}".format(len(resp_data))
      },
      {
        "name": "Breached Sites", 
        "type": "string",
        "value": dict_string
      }
    ]
    artifact.addHit("HIBP Function hits added", hit)
else:
  incident.addNote("Have I Been Pwned has failed: {}".format(results.reason))

```

---

## Function - Have I Been Pwned Get Pastes

### API Name
`have_i_been_pwned_get_pastes`

### Output Name
`None`

### Message Destination
`hibp`

### Pre-Processing Script
```python
inputs.email_address = artifact.value
```

### Post-Processing Script
```python
if results.success:
  if results.content:
    hit = []
    resp_data = results.content
    resp_dict = resp_data["Pastes"]
    dict_string = ""
    for paste in resp_dict:
      for dict_key, dict_value in paste.items():
        temp = ""
        aKey = str(dict_key)
        aValue = str(dict_value)
        temp = u"{}: {} ; ".format(aKey, aValue)
        dict_string += temp
      dict_string += " || "
    hit = [
      {
        "name": "Pastes", 
        "type": "string",
        "value": dict_string,
      }
    ]
    artifact.addHit("HIBP Function hits added", hit)
else:
  incident.addNote(u"Have I Been Pwned has failed: {}".format(results.reason))

    
```

---

