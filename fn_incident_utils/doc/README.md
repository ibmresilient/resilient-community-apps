<!--
  This User README.md is generated by running:
  "resilient-sdk docgen -p fn_incident_utils --user-guide"

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)
-->

# **User Guide:** fn_incident_utils_v1.0.0

## Table of Contents
- [Key Features](#key-features)
- [Function - Incident Utils: Close Incident](#function---incident-utils-close-incident)
- [Rules](#rules)

---

## Key Features
<!--
  List the Key Features of the Integration
-->
* Close an Incident

---

## Function - Incident Utils: Close Incident
Function that takes an incident_id and a JSON String of field_name and field_value pairs to close an Incident.

 ![screenshot: fn-incident-utils-close-incident ](./screenshots/screenshot_1.png)

<details><summary>Inputs:</summary>
<p>

| Name | Type | Required | Example | Tooltip |
| ---- | :--: | :------: | ------- | ------- |
| `close_fields` | `text` | No | `-` | A JSON String of the fields required to close an Incident e.g.: {'resolution_id':'Resolved','resolution_summary':'closing'} |
| `incident_id` | `number` | Yes | `-` | - |

Make sure close_fields represents a JSON string. 
* use double quotes to surround key names and string values.
* use `true` or `false` for boolean values.
* use brackets to surround multi-select field values. Ex. ["some", "thing"].
* field types `datepicker` and `datetimepicker` need to be in epoch format in milliseconds. Ex. 1607533205000.
</p>
</details>

<details><summary>Outputs:</summary>
<p>

```python
results = {'version': '1.0', 'success': True, 'reason': None, 'content': {'success': True, 'title': None, 'message': None, 'hints': []}, 'raw': '{"success": true, "title": null, "message": null, "hints": []}', 'inputs': {'close_fields': '{"resolution_id":"Resolved", "resolution_summary":"closing"}', 'incident_id': 2112}, 'metrics': {'version': '1.0', 'package': 'fn-incident-utils', 'package_version': '1.0.0', 'host': 'Users-MacBook-Pro.local', 'execution_time_ms': 1021, 'timestamp': '2020-12-01 15:25:08'}}
```

</p>
</details>

<details><summary>Workflows</summary>

  <details><summary>Example Pre-Process Script:</summary>
  <p>

  ```python
  inputs.incident_id = incident.id
iu_close_fields = rule.properties.incident_utils_close_fields.content
inputs.close_fields = u"{}".format(iu_close_fields)
  ```

  </p>
  </details>

  <details><summary>Example Post-Process Script:</summary>
  <p>

  ```python
  note_text = "Result from Example: Close Incident on Incident {0}: <strong>{1}</strong>".format(results.inputs['incident_id'], \
"success" if results.success else "failure.<br>Reason: {}".format(results.reason))
incident.addNote(helper.createRichText(note_text))
  ```

  </p>
  </details>

</details>

---




## Rules
| Rule Name | Object | Workflow Triggered |
| --------- | ------ | ------------------ |
| Example: Close Incident | incident | `example_close_incident` |

---

<!--
## Inform Resilient Users
  Use this section to optionally provide additional information so that Resilient playbook 
  designer can get the maximum benefit of your integration.
-->