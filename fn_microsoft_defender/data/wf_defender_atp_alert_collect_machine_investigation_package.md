<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Defender ATP Alert Collect Machine Investigation Package

## Function - Defender Collect Machine Investigation Package

### API Name
`defender_collect_machine_investigation_package`

### Output Name
`None`

### Message Destination
`fn_microsoft_defender`

### Pre-Processing Script
```python
inputs.defender_machine_id = incident.properties.defender_machine_id
inputs.defender_description = rule.properties.defender_action_comment
```

### Post-Processing Script
```python
if results.success:
  msg = "Defender ATP Collect Machine Investigation Report Action: {}\nComment: {}\nStatus: {}\nStart Date: {}".format(
    results.content['type'],
    results.content['requestorComment'],
    results.content['status'],
    results.content['creationDateTimeUtc']
    )
else:
  msg = "Defender ATP Collect Machine Investigation Report Failure: {}".format(results.reason)

incident.addNote(helper.createPlainText(msg))
"""
    'type': 'CollectInvestigationPackage',
    'title': None,
    'requestor': 'f0dc3f88-f617-449c-960c-6b54818cd110',
    'requestorComment': 'ss',
    'status': 'Succeeded',
    'machineId': '2a94aaf80aa31094790ce40da6fdfc03a9a145c5',
    'computerDnsName': 'windowsvmos',
    'creationDateTimeUtc': '2021-08-12T18:53:06.5259227Z',
    'lastUpdateDateTimeUtc': '2021-08-12T18:54:20.4259984Z',
"""
  
```

---

