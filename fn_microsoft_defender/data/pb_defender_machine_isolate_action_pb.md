<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.0.4368
-->

# Playbook - Defender Machine Isolate Action (PB)

### API Name
`defender_machine_isolate_action_pb`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`defender_machines`

### Description
Isolate/Unisolate a Defender Machine


---
## Function - Defender Machine Isolation

### API Name
`defender_machine_isolation`

### Output Name
`machine_isolation`

### Message Destination
`fn_microsoft_defender`

### Function-Input Script
```python
inputs.defender_machine_id = row['machine_id']
inputs.defender_isolation_type = str(playbook.inputs.defender_isolation_type)
inputs.defender_description = playbook.inputs.defender_action_comment
inputs.defender_isolation_action = str(playbook.inputs.defender_isolation_action)
```

---

## Local script - post process

### Description


### Script Type
`Local script`

### Objet Type
`defender_machines`

### Script Content
```python
from datetime import datetime
results = playbook.functions.results.machine_isolation

if results.get("success"):
  row['report_date'] = int(datetime.now().timestamp()*1000)
  
  action_msg = "Action: {}\nComment: {}\nStatus: {}\nStart Date: {}".format(
    results.get("content", {}).get('type'),
    results.get("content", {}).get('requestorComment'),
    results.get("content", {}).get('status'),
    results.get("content", {}).get('creationDateTimeUtc')
    )
  row['machine_last_action'] = helper.createPlainText(action_msg)
else:
  msg = "Defender Isolate Action {}.\nMachine: {} ({})\nAction: {}\nType: {}\nComment: {}\nReason: {}"\
   .format("successful" if results.get("success") else "unsuccessful",
   row['machine_name'], row['machine_id'],
   str(playbook.inputs.defender_isolation_action),
   str(playbook.inputs.defender_isolation_type),
   playbook.inputs.defender_action_comment,
   results.get("reason"))

  incident.addNote(helper.createPlainText(msg))
```

---
