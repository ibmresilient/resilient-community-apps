<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Defender ATP Update Indicator

## Function - Defender Set Indicator

### API Name
`defender_set_indicator`

### Output Name
`None`

### Message Destination
`fn_msdefender`

### Pre-Processing Script
```python
inputs.defender_description = rule.properties.indicator_description
inputs.defender_title = rule.properties.indicator_title
inputs.defender_indicator_action = str(rule.properties.indicator_action)
inputs.defender_expiration_time = rule.properties.indicator_expiration
inputs.defender_severity = str(rule.properties.indicator_severity)
inputs.defender_indicator_type = row['ind_type']
inputs.defender_indicator_value = row['ind_value']
```

### Post-Processing Script
```python
import java.util.Date as Date

msg = u"Action {}.\nAction: {}\nArtifact: {}\nTitle: {}\nComment: {}\nSeverity: {}\nExpiration: {}"\
   .format("successful" if results.success else "unsuccessful",
           str(rule.properties.indicator_action),
           row['ind_value'],
           rule.properties.indicator_title,
           rule.properties.indicator_description,
           str(rule.properties.indicator_severity),
           rule.properties.indicator_expiration)
           
if not results.success:
    msg = u"{}\nReason: {}".format(msg, results.reason)

incident.addNote(msg)

if results.success:
    row['report_date'] = Date().getTime()
    row['ind_title'] = results.content['title']
    row['ind_description'] = results.content['description']
    row['ind_action'] = results.content['action']
    row['ind_severity'] = results.content['severity']
    row['ind_expiration_date'] = results.content['expirationTime_ts']

```

---

