<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Defender ATP Machine Isolation

## Function - Defender Machine Isolation

### API Name
`defender_machine_isolation`

### Output Name
`None`

### Message Destination
`fn_msdefender`

### Pre-Processing Script
```python
inputs.defender_machine_id = row['machine_id']
inputs.defender_isolation_type = str(rule.properties.defender_isolation_type)
inputs.defender_description = rule.properties.defender_action_comment
inputs.defender_isolation_action = str(rule.properties.defender_machine_action)
```

### Post-Processing Script
```python
msg = u"Action {}.\nAction: {}\nMachine: {}\nType: {}\nComment: {}"\
   .format("successful" if results.success else "unsuccessfull",
           str(rule.properties.defender_isolation_action),
           row['machine_id'],
           str(rule.properties.defender_isolation_type),
           rule.properties.defender_action_comment)
           
if not results.success:
    msg = u"{}\nReason: {}".format(msg, results.reason)

incident.addNote(msg)

```

---

