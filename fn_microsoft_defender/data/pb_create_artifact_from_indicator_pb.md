<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.0.4368
-->

# Playbook - Create Artifact from Indicator (PB)

### API Name
`create_artifact_from_indicator_pb`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`defender_indicators`

### Description
None


---

## Global script - Create Artifact from Indicator

### Description
Convert a Defender indicator to an Artifact for further enrichment or remediation

### Script Type
`Global script`

### Objet Type
`defender_indicators`

### Script Content
```python
# Convert a Defender ATP indicator to an artifact_type
# lookup for Defender indicator types to arttfact types
type_lookup = {
        "FileSha1": "Malware SHA-1 Hash",
        "FileSha256": "Malware SHA-256 Hash",
        "IpAddress": "IP Address",
        "DomainName": "DNS Name",
        "Url": "URL"
    }

artifact_type = type_lookup.get(row['ind_type'], "String")
artifact_description = f"{row['ind_title']}\n{row['ind_description'}"
incident.addArtifact(artifact_type, row['ind_value'], artifact_description)

msg = f"Defender Action successful.\nIndicator: {row['ind_value']}\nAction: Create Artifact"
incident.addNote(msg)
```

---
