<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v50.0.131
-->

# Playbook - Defender List Indicators (PB)

### API Name
`defender_list_indicators_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Indicator Field | `defender_indicator_field` | select | field to apply the filter | Optional |
| Indicator Filter | `defender_indicator_filter` | text | regex to apply  | Optional |

### Object Type
`incident`

### Description
Get a list of the indicators defined in Defender.


---
## Function - Defender List Indicators

### API Name
`defender_list_indicators`

### Output Name
`list_indicators`

### Message Destination
`fn_microsoft_defender`

### Function-Input Script
```python
inputs.defender_indicator_filter = playbook.inputs.defender_indicator_filter if playbook.inputs.get('defender_indicator_filter') else None
inputs.defender_indicator_field = playbook.inputs.defender_indicator_field if playbook.inputs.get('defender_indicator_field') else None
```

---

## Local script - post process

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
from datetime import datetime
results = playbook.functions.results.list_indicators

if results.get("success") and results.get("content", {}).get("value"):
  for indicator in results.get("content", {}).get("value"):
    row = incident.addRow("defender_indicators")
    row['report_date'] = int(datetime.now().timestamp()*1000)
    row['ind_id'] = indicator.get('id')
    row['ind_value'] = indicator.get('indicatorValue')
    row['ind_type'] = indicator.get('indicatorType')
    row['ind_title'] = indicator.get('title')
    row['ind_description'] = indicator.get('description')
    row['ind_action'] = indicator.get('action')
    row['ind_severity'] = indicator.get('severity')
    row['ind_created_by'] = indicator.get('createdByDisplayName')
    row['ind_creation_date'] = indicator.get('creationTimeDateTimeUtc_ts')
    row['ind_expiration_date'] = indicator.get('expirationTime_ts')
    row['status'] = 'Active'
else:
  msg = f"Defender ATP Action unsuccessful.\nAction: List indicators\nReason: {results.get('reason')}"
  incident.addNote(msg)
```

---

