<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.0.4368
-->

# Playbook - Defender List Indicators (PB)

### API Name
`defender_list_indicators_pb`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`incident`

### Description
Get a list of the indicators defined in Defender.


---
## Function - Defender List Indicators

### API Name
`defender_list_indicators`

### Output Name
`list_indicators`

### Message Destination
`fn_microsoft_defender`

### Function-Input Script
```python
inputs.defender_indicator_filter = playbook.inputs.defender_indicator_filter if playbook.inputs.get('defender_indicator_filter') else None
inputs.defender_indicator_field = playbook.inputs.defender_indicator_field if playbook.inputs.get('defender_indicator_field') else None
```

---

## Local script - post process

### Description


### Script Type
`Local script`

### Objet Type
`incident`

### Script Content
```python
from datetime import datetime
results = playbook.functions.results.list_indicators
if results.get("success") and results.get("content", {}).get("value"):
  for indicator in results.get("content", {}).get("value"):
    row = incident.addRow("defender_indicators")
    row['report_date'] = int(datetime.now().timestamp()*1000)
    row['ind_id'] = indicator['id']
    row['ind_value'] = indicator['indicatorValue']
    row['ind_type'] = indicator['indicatorType']
    row['ind_title'] = indicator['title']
    row['ind_description'] = indicator['description']
    row['ind_action'] = indicator['action']
    row['ind_severity'] = indicator['severity']
    row['ind_created_by'] = indicator['createdByDisplayName']
    row['ind_creation_date'] = indicator['creationTimeDateTimeUtc_ts']
    row['ind_expiration_date'] = indicator['expirationTime_ts']
    row['status'] = 'Active'
else:
  msg = f"Defender ATP Action unsuccessful.\nAction: List indicators\nReason: {results.get('reason')}"
  incident.addNote(msg)
```

---
