<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Defender ATP Alert App Execution Restriction

## Function - Defender App Execution

### API Name
`defender_app_execution`

### Output Name
`None`

### Message Destination
`fn_microsoft_defender`

### Pre-Processing Script
```python
inputs.defender_description = rule.properties.defender_action_comment
inputs.defender_machine_id = incident.properties.defender_machine_id
inputs.defender_restriction_type = str(rule.properties.defender_app_execution_action)

```

### Post-Processing Script
```python
msg = u"Defender ATP Action {}.\nAction: {}\nMachine: {}\nComment: {}"\
   .format("successful" if results.success else "unsuccessful",
           rule.properties.defender_app_execution_action,
           incident.properties.defender_machine_id,
           rule.properties.defender_action_comment)
           
if results.success:
  action_msg = "Action: {}\nComment: {}\nStatus: {}\nStart Date: {}".format(
    results.content['type'],
    results.content['requestorComment'],
    results.content['status'],
    results.content['creationDateTimeUtc']
    )
else:
  msg = u"{}\nReason: {}".format(msg, results.reason)

incident.addNote(helper.createPlainText(msg))

```

---

