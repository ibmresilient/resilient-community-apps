<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Defender List Indicators

## Function - Defender List Indicators

### API Name
`defender_list_indicators`

### Output Name
`None`

### Message Destination
`fn_microsoft_defender`

### Pre-Processing Script
```python
inputs.defender_indicator_filter = rule.properties.defender_indicator_filter if rule.properties.get('defender_indicator_filter') else None
inputs.defender_indicator_field = rule.properties.defender_indicator_field if rule.properties.get('defender_indicator_field') else None
```

### Post-Processing Script
```python
import java.util.Date as Date

if results.success and results.content.get("value"):
    for indicator in results.content.get("value"):
        row = incident.addRow("defender_indicators")
        row['report_date'] = Date().getTime()
        row['ind_id'] = indicator['id']
        row['ind_value'] = indicator['indicatorValue']
        row['ind_type'] = indicator['indicatorType']
        row['ind_title'] = indicator['title']
        row['ind_description'] = indicator['description']
        row['ind_action'] = indicator['action']
        row['ind_severity'] = indicator['severity']
        row['ind_created_by'] = indicator['createdByDisplayName']
        row['ind_creation_date'] = indicator['creationTimeDateTimeUtc_ts']
        row['ind_expiration_date'] = indicator['expirationTime_ts']
        row['status'] = 'Active'
else:
    msg = u"Defender ATP Action unsuccessful.\nAction: List indicators\nReason: {}".format(results.reason)
    incident.addNote(msg)
```

---

