<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="Microsoft Security Graph" href="../fn_microsoft_security_graph/README.html" /><link rel="prev" title="McAfee TIE" href="../fn_mcafee_tie/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Microsoft Defender - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pb_sans_isc_scan_ip/README.html">ISC SANS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">Anomali Staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">Amazon AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco AMP for Endpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">IBM SOAR LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">About MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">PhishTank Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">Remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watson_translate/README.html">Watson Translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="microsoft-defender">
<h1>Microsoft Defender<a class="headerlink" href="#microsoft-defender" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#resilient-platform"><span class="xref myst">Resilient platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
<li><p><a class="reference internal" href="#azure-app-configuration"><span class="xref myst">Azure App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#template-files"><span class="xref myst">Template files</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---defender-update-incident"><span class="xref myst">Function - Defender Update Incident</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-app-execution"><span class="xref myst">Function - Defender App Execution</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-find-machines-by-file"><span class="xref myst">Function - Defender Find Machines by File</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-machine-vulnerabilities"><span class="xref myst">Function - Defender Machine Vulnerabilities</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-machine-isolation"><span class="xref myst">Function - Defender Machine Isolation</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-alert-search"><span class="xref myst">Function - Defender Alert Search</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-list-indicators"><span class="xref myst">Function - Defender List Indicators</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-quarantine-file"><span class="xref myst">Function - Defender Quarantine File</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-get-related-alert-information"><span class="xref myst">Function - Defender Get Related Alert Information</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-machine-scan"><span class="xref myst">Function - Defender Machine Scan</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-set-indicator"><span class="xref myst">Function - Defender Set Indicator</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-get-file-information"><span class="xref myst">Function - Defender Get File Information</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-find-machines-by-filter"><span class="xref myst">Function - Defender Find machines by filter</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-delete-indicator"><span class="xref myst">Function - Defender Delete Indicator</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-get-incident"><span class="xref myst">Function - Defender Get Incident</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-find-machines-by-ip"><span class="xref myst">Function - Defender Find Machines by IP</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-update-alert"><span class="xref myst">Function - Defender Update Alert</span></a></p></li>
<li><p><a class="reference internal" href="#function---defender-collect-machine-investigation-package"><span class="xref myst">Function - Defender Collect Machine Investigation Package</span></a></p></li>
<li><p><a class="reference internal" href="#script---create-artifact-from-indicator"><span class="xref myst">Script - Create Artifact from Indicator</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---defender-machines"><span class="xref myst">Data Table - Defender Machines</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---defender-alerts"><span class="xref myst">Data Table - Defender Alerts</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---defender-indicators"><span class="xref myst">Data Table - Defender Indicators</span></a></p></li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p></li>
<li><p><a class="reference internal" href="#template-appendix"><span class="xref myst">Template Appendix</span></a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0.0</p></td>
<td><p>10/2021</p></td>
<td><p>Initial Release</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.1</p></td>
<td><p>3/2022</p></td>
<td><p>Bug fix for defender_update_incident</p></td>
</tr>
<tr class="row-even"><td><p>1.0.2</p></td>
<td><p>7/2022</p></td>
<td><p>Bug fix for defender_get_related_alert_information</p></td>
</tr>
<tr class="row-odd"><td><p>1.1.0</p></td>
<td><p>9/2022</p></td>
<td><p>Added filtering at the alert level</p></td>
</tr>
<tr class="row-even"><td><p>1.2.0</p></td>
<td><p>8/2023</p></td>
<td><p>Add playbooks</p></td>
</tr>
</tbody>
</table>
</div>
<section id="changes">
<h3>1.2.0 Changes<a class="headerlink" href="#changes" title="Link to this heading">¶</a></h3>
<p>In v1.2, the existing rules and workflows have been replaced with playbooks.
This change is made to support the ongoing, newer capabilities of playbooks.
Each playbook has the same functionality as the previous, corresponding rule/workflow.</p>
<p>If upgrading from a previous release, you’ll notice that the previous release’s rules/workflows remain in place. Both sets of rules and playbooks are active. For manual actions, playbooks have the same name as it’s corresponding rule, but with “(PB)” added at the end.
For automatic actions, the playbooks will be disabled by default.</p>
<p>You can continue to use the rules/workflows.
But migrating to playbooks provides greater functionality along with future app enhancements and bug fixes.</p>
</section>
<section id="v1-1-considerations">
<h3>V1.1 Considerations<a class="headerlink" href="#v1-1-considerations" title="Link to this heading">¶</a></h3>
</section>
</section>
<section id="see-section-app-configuration-for-the-new-app-config-setting-alert-filters-this-setting-must-be-manually-added-to-your-app-config-file-in-order-to-use-it-with-the-poller-to-filter-incident-creation">
<h2>See section <a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a> for the new app.config setting: <code class="docutils literal notranslate"><span class="pre">alert_filters</span></code>. This setting must be manually added to your app.config file in order to use it with the poller to filter incident creation.<a class="headerlink" href="#see-section-app-configuration-for-the-new-app-config-setting-alert-filters-this-setting-must-be-manually-added-to-your-app-config-file-in-order-to-use-it-with-the-poller-to-filter-incident-creation" title="Link to this heading">¶</a></h2>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p><strong>Resilient Circuits Components for ‘fn_microsoft_defender’</strong></p>
<p><img alt="screenshot: main" src="../_images/main30.png" /></p>
<p>Perform operations against Defender such as synchronize incidents and alerts, set indicators, isolate and quarantine machines, and block file execution.</p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>List, set, update and delete Defender indicators</p></li>
<li><p>Search for Defender machines by IP address</p></li>
<li><p>Search for Defender machines by file hash</p></li>
<li><p>Isolate/unisolate Defender machines</p></li>
<li><p>Restrict/unrestrict apps on a Defender machine</p></li>
<li><p>Run an antivirus scan on a Defender machine</p></li>
<li><p>Quarantine files on a Defender machine</p></li>
<li><p>Get file information</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="resilient-platform">
<h3>Resilient platform<a class="headerlink" href="#resilient-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (formerly App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an Edge Gateway, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">45.0.0</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">45.0.0</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=45.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Incident</p></td>
<td><p>Read, Create</p></td>
</tr>
<tr class="row-odd"><td><p>Edit Incident</p></td>
<td><p>Fields, Owner, Status, Notes</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= 1.4.</p></li>
<li><p>Cloud Pak is configured with an App Host.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security Knowledge Center table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Knowledge Center at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific Knowledge Center page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app supports a proxy server via the https_proxy and http_proxy app.config settings.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.6+ is supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>msal</p></li>
<li><p>rapidjson</p></li>
<li><p>resilient_circuits&gt;=37.0.0</p></li>
<li><p>resilient_lib&gt;=37.0.0</p></li>
<li><p>simplejson</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>Resilient platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>tenant_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">89d65-...-57bae1c2</span></code></p></td>
<td><p><em>Azure tenant Id.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>client_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">244ad4-...-3564fc4</span></code></p></td>
<td><p><em>Azure app id (client id).</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>app_secret</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">940c4d2-...-9d32e1b</span></code></p></td>
<td><p><em>Azure app secret.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>api_url</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://api.securitycenter.microsoft.com</span></code></p></td>
<td><p><em>API utl. This can be customized per Azure region.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_lookback</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">120</span></code></p></td>
<td><p><em>When resilient-circuits starts, number of minutes to look back for changes to Sentinel incidents.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_interval</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60</span></code></p></td>
<td><p><em>Number of seconds for the poller to run. Set to 0 to disable the poller</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>new_incident_filters</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;status&quot;:</span> <span class="pre">[&quot;New&quot;,</span> <span class="pre">&quot;Active&quot;],&quot;severity&quot;:</span> <span class="pre">[&quot;High&quot;,</span> <span class="pre">&quot;Medium&quot;,&quot;Low&quot;]</span></code></p></td>
<td><p><em>filters to apply for promoting Defender incidents to SOAR. All criteria need to match. For lists [], one value needs to match.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>alert_filters</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;serviceSource&quot;:</span> <span class="pre">[&quot;MicrosoftDefenderForEndpoint&quot;],&quot;severity&quot;:</span> <span class="pre">[&quot;High&quot;,</span> <span class="pre">&quot;Medium&quot;,&quot;Low&quot;]</span></code></p></td>
<td><p><em>Introduced in v1.1. Filters to apply for promoting Defender incidents to SOAR, based on the alerts associated within a Defender incident. The SOAR incident is created if all criteria is matched for at least one alert. For lists [], one value needs to match.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>create_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/to/incident_creation_template.jinja</p></td>
<td><p><em>custom template for incident creation</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/to/incident_update_template.jinja</p></td>
<td><p><em>custom template for incident updates</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>close_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/to/incident_close_template.jinja</p></td>
<td><p><em>custom template for closing a incident</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_defender_alert_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/to/defender_update_alert_template.jinja</p></td>
<td><p><em>custom template for updating an alert</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>verify</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>false</p></td>
<td><p><em>‘false’ to disable certificate verification or /path/to/client_certificate.pem</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>update_defender_incident_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/to/defender_update_incident_template.jinja</p></td>
<td><p><em>custom template for updating an alert</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>http_proxy https_proxy</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>https//proxy.com</p></td>
<td><p><em>url for proxy settings</em></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-layouts">
<h3>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Import the Data Tables and Custom Fields like the screenshot below:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts15.png" /></p>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="azure-app-configuration">
<h3>Azure App Configuration<a class="headerlink" href="#azure-app-configuration" title="Link to this heading">¶</a></h3>
<p>In order to use this app, an Azure app needs to be registered with the proper permissions for Defender and a client secret generated. Settings, in general are:</p>
<p>Application Type: Daemon with api calls enabled</p>
<p>API Permissions (Application type):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Alert.ReadAll
Alert.ReadWriteAll
File.Read.All
Incident.ReadWrite
Incident.ReadWrite.All
Ip.Read.All
Machine.CollectForensics
Machine.Isolate
Machine.Read.All
Machine.ReadWrite.All
Machine.RestrictExecution
Machine.Scan
Machine.StopAndQuarantine
Software.Read.All
Ti.Read.All
Ti.ReadWrite
Ti.ReadWrite.All
User.Read
User.Read.All
Url.Read.All
Vunerabilities.ReadAll
</pre></div>
</div>
<p><img alt="screenshot: Azure App Registration" src="../_images/azure_app_registration.png" /></p>
<p><img alt="screenshot: Azure App Permissions" src="../_images/azure_app_permissions.png" /></p>
<p><img alt="screenshot: Azure App Secrets" src="../_images/azure_app_secrets.png" /></p>
</section>
<hr class="docutils" />
<section id="template-files">
<h3>Template files<a class="headerlink" href="#template-files" title="Link to this heading">¶</a></h3>
<p>Templates are used during the syncronization of incidents and comments between Defender and IBM SOAR.
These templates provide the mapping between Defender incident and SOAR incident fields. The templates cover these scenarios:</p>
<ul class="simple">
<li><p>create a SOAR incident from a Defender incident</p></li>
<li><p>update an existing SOAR incident</p></li>
<li><p>close a SOAR incident when the cooresponding Defender incident closes</p></li>
<li><p>create a Defender incident comment</p></li>
<li><p>update a Defender incident alert</p></li>
</ul>
<p>There are cases where these template need to be modified for your environment. For instance, customers can
customize their close incident process with different required fields. In this example, the incident_close_template.jinja file needs to be updated and referenced in your app.config file as:</p>
<p>close_incident_template=/path/to/your/custom/close_incident_template.jinja</p>
<p>See the <a class="reference internal" href="#template-appendix"><span class="xref myst">Template Appendix</span></a> for copies of the existing templates which you can use to modify for your environment requirements.</p>
</section>
</section>
<section id="function-defender-update-incident">
<h2>Function - Defender Update Incident<a class="headerlink" href="#function-defender-update-incident" title="Link to this heading">¶</a></h2>
<p>Update a Defender Incident</p>
<details><summary>Inputs:</summary>
<p>
| Name | Type | Required | Example | Tooltip |
| ---- | :--: | :------: | ------- | ------- |
| `defender_classification` | `select` | No | `TruePositive` | Unknown, FalsePositive, TruePositive. |
| `defender_comment` | `text` | No | `-` | - |
| `defender_determination` | `select` | No | `Malware` | NotAvailable, Apt, Malware, SecurityPersonnel, SecurityTesting, UnwantedSoftware, Other. |
| `defender_incident_id` | `number` | No | `-` | - |
| `defender_incident_status` | `select` | No | `Active` | Active, Resolved, and Redirected. |
| `defender_tags` | `text` | No | `-` | comma separated list of defender incident tags |
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Incidents/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s1">&#39;incidentUri&#39;</span><span class="p">:</span> <span class="s1">&#39;https://security.microsoft.com/incidents/31?tid=50ad7d3e-b889-434d-802d-13b87c68047b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;redirectIncidentId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;incidentName&#39;</span><span class="p">:</span> <span class="s1">&#39;Multi-stage incident involving Initial access &amp; Discovery on one endpoint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;createdTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:55.0166667Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T01:12:39.9333333Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="s1">&#39;Defender 365&#39;</span><span class="p">,</span>
    <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s1">&#39;tagA&#39;</span><span class="p">,</span>
      <span class="s1">&#39;tagB&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;new comment from azure&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdBy&#39;</span><span class="p">:</span> <span class="s1">&#39;abc@swivrllc.onmicrosoft.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-22T20:53:53.9133333Z&#39;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;alertId&#39;</span><span class="p">:</span> <span class="s1">&#39;da637701781744658799_2045659800&#39;</span><span class="p">,</span>
        <span class="s1">&#39;providerAlertId&#39;</span><span class="p">:</span> <span class="s1">&#39;da637701781744658799_2045659800&#39;</span><span class="p">,</span>
        <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
        <span class="s1">&#39;serviceSource&#39;</span><span class="p">:</span> <span class="s1">&#39;MicrosoftDefenderForEndpoint&#39;</span><span class="p">,</span>
        <span class="s1">&#39;creationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:54.465905Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastUpdatedTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T01:12:39.9533333Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resolvedTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26T20:38:24.3646436Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;firstActivity&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:38.3176713Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastActivity&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:40.2929171Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious Task Scheduler activity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;A process involved in earlier malicious activity used Task Scheduler to create, modify, or delete a task. This might be an attempt launch malicious code automatically and establish persistence.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Persistence&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Resolved&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
        <span class="s1">&#39;investigationId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;investigationState&#39;</span><span class="p">:</span> <span class="s1">&#39;UnsupportedAlertType&#39;</span><span class="p">,</span>
        <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
        <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Other&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectionSource&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsDefenderAtp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectorId&#39;</span><span class="p">:</span> <span class="s1">&#39;446b23e1-48b0-41f9-ae7b-03655adcf941&#39;</span><span class="p">,</span>
        <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="s1">&#39;Automation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;actorName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;threatFamilyName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;mitreTechniques&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s1">&#39;T1053&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;devices&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;aadDeviceId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;deviceDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osPlatform&#39;</span><span class="p">:</span> <span class="s1">&#39;Windows10&#39;</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;20H2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osProcessor&#39;</span><span class="p">:</span> <span class="s1">&#39;x64&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osBuild&#39;</span><span class="p">:</span> <span class="mi">19042</span><span class="p">,</span>
            <span class="s1">&#39;healthStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
            <span class="s1">&#39;riskScore&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rbacGroupName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;firstSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-08-11T13:36:43.1619242Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span>

            <span class="p">],</span>
            <span class="s1">&#39;defenderAvStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Updated&#39;</span><span class="p">,</span>
            <span class="s1">&#39;onboardingStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Onboarded&#39;</span><span class="p">,</span>
            <span class="s1">&#39;vmMetadata&#39;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s1">&#39;vmId&#39;</span><span class="p">:</span> <span class="s1">&#39;55de7a4c-b77a-4748-9c4f-048b88c0f3aa&#39;</span><span class="p">,</span>
              <span class="s1">&#39;cloudProvider&#39;</span><span class="p">:</span> <span class="s1">&#39;Azure&#39;</span><span class="p">,</span>
              <span class="s1">&#39;resourceId&#39;</span><span class="p">:</span> <span class="s1">&#39;/subscriptions/a4b7e24a-c7aa-4d84-8dae-89e99b336784/resourceGroups/DEMOASSETS/providers/Microsoft.Compute/virtualMachines/WindowsVMOS&#39;</span><span class="p">,</span>
              <span class="s1">&#39;subscriptionId&#39;</span><span class="p">:</span> <span class="s1">&#39;a4b7e24a-c7aa-4d84-8dae-89e99b336784&#39;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;entityType&#39;</span><span class="p">:</span> <span class="s1">&#39;Process&#39;</span><span class="p">,</span>
            <span class="s1">&#39;evidenceCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:54.73Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;verdict&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious&#39;</span><span class="p">,</span>
            <span class="s1">&#39;remediationStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="s1">&#39;f5ee89bb1e4a0b1c3c7f1e8d05d0677f2b2b5919&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="s1">&#39;73a3c4aef5de385875339fc2eb7e58a9e8a47b6161bdc6436bf78a763537be70&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;powershell.exe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;filePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Windows</span><span class="se">\\</span><span class="s1">SysWOW64</span><span class="se">\\</span><span class="s1">WindowsPowerShell</span><span class="se">\\</span><span class="s1">v1.0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;processId&#39;</span><span class="p">:</span> <span class="mi">10212</span><span class="p">,</span>
            <span class="s1">&#39;processCommandLine&#39;</span><span class="p">:</span> <span class="s2">&quot;powershell.exe -W Hidden -Exec Bypass -Command cd /;$fileBase64Prefix = &#39;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;processCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:33.3686931Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessId&#39;</span><span class="p">:</span> <span class="mi">10452</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:11.4593785Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFileName&#39;</span><span class="p">:</span> <span class="s1">&#39;WINWORD.EXE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFilePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Program Files (x86)</span><span class="se">\\</span><span class="s1">Microsoft Office</span><span class="se">\\</span><span class="s1">root</span><span class="se">\\</span><span class="s1">Office16&#39;</span><span class="p">,</span>
            <span class="s1">&#39;accountName&#39;</span><span class="p">:</span> <span class="s1">&#39;userAccount&#39;</span><span class="p">,</span>
            <span class="s1">&#39;domainName&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsVMOS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;userSid&#39;</span><span class="p">:</span> <span class="s1">&#39;S-1-5-21-1542157044-1944968518-3635326852-500&#39;</span><span class="p">,</span>
            <span class="s1">&#39;aadUserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ae973ab4-1b5e-48b2-bf2f-c3bf1b3634a2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;userPrincipalName&#39;</span><span class="p">:</span> <span class="s1">&#39;def@swivrllc.onmicrosoft.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;detectionStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Detected&#39;</span><span class="p">,</span>
            <span class="s1">&#39;deviceId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_incident_id&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s1">&#39;defender_determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_tags&#39;</span><span class="p">:</span> <span class="s1">&#39;tagA,tagB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_incident_status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;Marks-MacBook-Pro.local&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">1950</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26 21:12:40&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># change as necessary. Value Defender values are:  Active, Resolved, and Redirected.</span>
<span class="n">LOOKUP_STATUS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;7&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span> <span class="c1"># Unresolved</span>
    <span class="s2">&quot;8&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span> <span class="c1"># Duplicate</span>
    <span class="s2">&quot;9&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span> <span class="c1"># Not an Issue</span>
    <span class="s2">&quot;10&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span> <span class="c1"># Resolved</span>
<span class="p">}</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">defender_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_incident_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_incident_status</span> <span class="o">=</span> <span class="n">LOOKUP_STATUS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span><span class="p">,</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_comment</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">resolution_summary</span><span class="o">.</span><span class="n">content</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_classification</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_classification</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_determination</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_determination</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-app-execution">
<h2>Function - Defender App Execution<a class="headerlink" href="#function-defender-app-execution" title="Link to this heading">¶</a></h2>
<p>Perform app restriction actions on a Microsoft Defender machine</p>
<p><img alt="screenshot: fn-defender-app-execution " src="../_images/fn-defender-app-execution.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_restriction_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>restrictCodeExecution, unrestrictCodeExecution</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#MachineActions/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;e345e07a-1621-4801-bb7d-42a6370354ee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;UnrestrictCodeExecution&#39;</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestor&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;requestorComment&#39;</span><span class="p">:</span> <span class="s1">&#39;unrestrict&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Succeeded&#39;</span><span class="p">,</span>
    <span class="s1">&#39;machineId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T17:57:23.430512Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T17:57:29.8458727Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cancellationRequestor&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationComment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationDateTimeUtc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;errorHResult&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestSource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;relatedFileInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;troubleshootInfo&#39;</span><span class="p">:</span> <span class="kc">None</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_restriction_type&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">305</span><span class="p">,</span>
      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;unrestrictCodeExecution&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;defender_description&#39;</span><span class="p">:</span> <span class="s1">&#39;unrestrict&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_machine_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57c5bb9c88-7gbcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">30909</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 17:57:53&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_restriction_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_app_execution_action</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Machine: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_app_execution_action</span><span class="p">,</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">],</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span><span class="p">)</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
  <span class="n">action_msg</span> <span class="o">=</span> <span class="s2">&quot;Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Status: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Start Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;requestorComment&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">]</span>
    <span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_last_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">action_msg</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-find-machines-by-file">
<h2>Function - Defender Find Machines by File<a class="headerlink" href="#function-defender-find-machines-by-file" title="Link to this heading">¶</a></h2>
<p>Find machines which match a given file hash</p>
<p><img alt="screenshot: fn-defender-find-machines-by-file " src="../_images/fn-defender-find-machines-by-file.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Files/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="s1">&#39;cc4934376adfa2c4d5c698791c51264d0080948b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="s1">&#39;455795fabfd3c2c246b4b9e37782db8dbac8c9957210d782331861b56010bb12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;md5&#39;</span><span class="p">:</span> <span class="s1">&#39;3912bbf391299d495109636a0ea47bcb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;globalPrevalence&#39;</span><span class="p">:</span> <span class="mi">10968</span><span class="p">,</span>
    <span class="s1">&#39;globalFirstObserved&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-08-23T07:26:58.0186152Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;globalLastObserved&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T12:53:07.9730547Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">192512</span><span class="p">,</span>
    <span class="s1">&#39;fileType&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;isPeFile&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;filePublisher&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;fileProductName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;signer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;issuer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;signerHash&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;isValidCertificate&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;determinationType&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
    <span class="s1">&#39;determinationValue&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_indicator_value&#39;</span><span class="p">:</span> <span class="s1">&#39;455795fabfd3c2c246b4b9e37782db8dbac8c9957210d782331861b56010bb12&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57c5bb9c88-7gbcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">649</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 18:15:39&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">machine</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;defender_atp_machines&quot;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;computerDnsName&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_platform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;osPlatform&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_firstseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;firstSeen_ts&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_lastseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;lastSeen_ts&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;lastIpAddress&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_file_hash&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_health_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;healthStatus&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_risk_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;riskScore&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_exposure_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exposureLevel&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;machineTags&#39;</span><span class="p">,</span> <span class="p">[]))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action unsuccessful.</span><span class="se">\n</span><span class="s2">Action: Find machines by file hash</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-machine-vulnerabilities">
<h2>Function - Defender Machine Vulnerabilities<a class="headerlink" href="#function-defender-machine-vulnerabilities" title="Link to this heading">¶</a></h2>
<p>Get vulnerabilities for a given Defender machine</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Collection(microsoft.windowsDefenderATP.api.PublicVulnerabilityDto)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;{&quot;@odata.context&quot;: &quot;https://api.securitycenter.microsoft.com/api/$metadata#Collection(microsoft.windowsDefenderATP.api.PublicVulnerabilityDto)&quot;, &quot;value&quot;: []}&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_machine_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57df779566-tkf5x&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">791</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 20:48:07&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd"> [</span>
<span class="sd">        {</span>
<span class="sd">            &quot;id&quot;: &quot;CVE-2019-1348&quot;,</span>
<span class="sd">            &quot;name&quot;: &quot;CVE-2019-1348&quot;,</span>
<span class="sd">            &quot;description&quot;: &quot;Git could allow a remote attacker to bypass security restrictions, caused by a flaw in the --export-marks option of git fast-import. By persuading a victim to import specially-crafted content, an attacker could exploit this vulnerability to overwrite arbitrary paths.&quot;,</span>
<span class="sd">            &quot;severity&quot;: &quot;Medium&quot;,</span>
<span class="sd">            &quot;cvssV3&quot;: 4.3,</span>
<span class="sd">            &quot;exposedMachines&quot;: 1,</span>
<span class="sd">            &quot;publishedOn&quot;: &quot;2019-12-13T00:00:00Z&quot;,</span>
<span class="sd">            &quot;updatedOn&quot;: &quot;2019-12-13T00:00:00Z&quot;,</span>
<span class="sd">            &quot;publicExploit&quot;: False,</span>
<span class="sd">            &quot;exploitVerified&quot;: False,</span>
<span class="sd">            &quot;exploitInKit&quot;: False,</span>
<span class="sd">            &quot;exploitTypes&quot;: [],</span>
<span class="sd">            &quot;exploitUris&quot;: []</span>
<span class="sd">        },</span>
<span class="sd">        {</span>
<span class="sd">            &quot;id&quot;: &quot;CVE-2019-1348&quot;,</span>
<span class="sd">            &quot;name&quot;: &quot;CVE-2019-1348-2&quot;,</span>
<span class="sd">            &quot;description&quot;: &quot;Git could allow a remote attacker to bypass security restrictions, caused by a flaw in the --export-marks option of git fast-import. By persuading a victim to import specially-crafted content, an attacker could exploit this vulnerability to overwrite arbitrary paths.&quot;,</span>
<span class="sd">            &quot;severity&quot;: &quot;Medium&quot;,</span>
<span class="sd">            &quot;cvssV3&quot;: 4.3,</span>
<span class="sd">            &quot;exposedMachines&quot;: 1,</span>
<span class="sd">            &quot;publishedOn&quot;: &quot;2019-12-13T00:00:00Z&quot;,</span>
<span class="sd">            &quot;updatedOn&quot;: &quot;2019-12-13T00:00:00Z&quot;,</span>
<span class="sd">            &quot;publicExploit&quot;: False,</span>
<span class="sd">            &quot;exploitVerified&quot;: False,</span>
<span class="sd">            &quot;exploitInKit&quot;: False,</span>
<span class="sd">            &quot;exploitTypes&quot;: [],</span>
<span class="sd">            &quot;exploitUris&quot;: []</span>
<span class="sd">        }</span>
<span class="sd">    ]</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">mk_note</span><span class="p">(</span><span class="n">list_of_notes</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;br&gt;---&lt;br&gt;&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">note</span><span class="p">)</span> <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">list_of_notes</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">format_line</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt;: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="n">vulnerabilities</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vulnerabilities</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;No machine vulnerabilities for: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">risk</span> <span class="ow">in</span> <span class="n">vulnerabilities</span><span class="p">:</span>
            <span class="n">note_info</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">]))</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Machine Id&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]))</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Vulnerability&quot;</span><span class="p">,</span> <span class="n">risk</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="n">risk</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]))</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Severity&quot;</span><span class="p">,</span> <span class="n">risk</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]))</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Published&quot;</span><span class="p">,</span> <span class="n">risk</span><span class="p">[</span><span class="s1">&#39;publishedOn&#39;</span><span class="p">]))</span>
            <span class="n">note_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_line</span><span class="p">(</span><span class="s2">&quot;Updated&quot;</span><span class="p">,</span> <span class="n">risk</span><span class="p">[</span><span class="s1">&#39;updatedOn&#39;</span><span class="p">]))</span>

            <span class="n">note</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note_info</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">mk_note</span><span class="p">(</span><span class="n">note</span><span class="p">)))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Defender Machine Vulnerabilities failed: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-machine-isolation">
<h2>Function - Defender Machine Isolation<a class="headerlink" href="#function-defender-machine-isolation" title="Link to this heading">¶</a></h2>
<p>Perform either an ‘isolate’ or ‘unisolate’ operation on a MS defender machine</p>
<p><img alt="screenshot: fn-defender-machine-isolation " src="../_images/fn-defender-app-execution.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_isolation_action</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>‘isolate’ or ‘unisolate’</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_isolation_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Type of operation to perform: ‘Full’ or ‘Selective’</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#MachineActions/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;38199c68-823c-4e6c-8a33-52a5f23ccdf1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Isolate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestor&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;requestorComment&#39;</span><span class="p">:</span> <span class="s1">&#39;full isolate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Succeeded&#39;</span><span class="p">,</span>
    <span class="s1">&#39;machineId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T20:55:07.8402983Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T20:55:41.5307443Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cancellationRequestor&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationComment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationDateTimeUtc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;errorHResult&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
    <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestSource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;relatedFileInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;troubleshootInfo&#39;</span><span class="p">:</span> <span class="kc">None</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_isolation_type&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">331</span><span class="p">,</span>
      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Full&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;defender_description&#39;</span><span class="p">:</span> <span class="s1">&#39;full isolate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_machine_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_isolation_action&#39;</span><span class="p">:</span> <span class="s1">&#39;isolate&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57df779566-tkf5x&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">61859</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 20:56:09&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_isolation_type</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_isolation_action</span> <span class="o">=</span> <span class="s1">&#39;unisolate&#39;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Date</span> <span class="k">as</span> <span class="nn">Date</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>
  <span class="n">action_msg</span> <span class="o">=</span> <span class="s2">&quot;Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Status: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Start Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;requestorComment&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">]</span>
    <span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_last_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">action_msg</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Unisolate Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Machine: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">Type: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">],</span>
           <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_isolation_type</span><span class="p">),</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span><span class="p">,</span>
           <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-alert-search">
<h2>Function - Defender Alert Search<a class="headerlink" href="#function-defender-alert-search" title="Link to this heading">¶</a></h2>
<p>Return Defender alerts based on a set of search criteria</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_lastseen</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Last Seen Alert Date</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_lastupdatetime</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Date when alert was last updated</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_result_max</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p>Number of top results to return</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_severity</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># TODO: Copy and paste an example of the Function Output within this code block.</span>
    <span class="c1"># To view the output of a Function, run resilient-circuits in DEBUG mode and invoke the Function.</span>
    <span class="c1"># The Function results will be printed in the logs: &quot;resilient-circuits run --loglevel=DEBUG&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-list-indicators">
<h2>Function - Defender List Indicators<a class="headerlink" href="#function-defender-list-indicators" title="Link to this heading">¶</a></h2>
<p>Get a list of all Defender indicators. Optionally, specify a regex filter to limit the responses.</p>
<p><img alt="screenshot: fn-defender-list-indicators " src="../_images/dt-defender-indicators.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_field</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Select which field to filter on</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>regex capability to limit list. ie: a.* for indicators starting with ‘a’</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span>
        <span class="s1">&#39;indicatorValue&#39;</span><span class="p">:</span> <span class="s1">&#39;45.146.164.110&#39;</span><span class="p">,</span>
        <span class="s1">&#39;indicatorType&#39;</span><span class="p">:</span> <span class="s1">&#39;IpAddress&#39;</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Allowed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdBy&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;application&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;educateUrl&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;bypassDurationHours&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;my indicator&#39;</span><span class="p">,</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;ip addr&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recommendedActions&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;creationTimeDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26T21:40:30.868013Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;expirationTime&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;lastUpdateTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T01:27:35.1627118Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastUpdatedBy&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rbacGroupNames&#39;</span><span class="p">:</span> <span class="p">[</span>

        <span class="p">],</span>
        <span class="s1">&#39;rbacGroupIds&#39;</span><span class="p">:</span> <span class="p">[</span>

        <span class="p">],</span>
        <span class="s1">&#39;notificationId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;notificationBody&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;mitreTechniques&#39;</span><span class="p">:</span> <span class="p">[</span>

        <span class="p">],</span>
        <span class="s1">&#39;historicalDetection&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;lookBackPeriod&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;generateAlert&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;additionalInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;createdByDisplayName&#39;</span><span class="p">:</span> <span class="s1">&#39;Defender 365&#39;</span><span class="p">,</span>
        <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;createdBySource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;certificateInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;creationTimeDateTimeUtc_ts&#39;</span><span class="p">:</span> <span class="mi">1635284430000</span><span class="p">,</span>
        <span class="s1">&#39;expirationTime_ts&#39;</span><span class="p">:</span> <span class="kc">None</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_indicator_field&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">236</span><span class="p">,</span>
      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;title&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;defender_indicator_filter&#39;</span><span class="p">:</span> <span class="s1">&#39;my&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;MacBook-Pro.local&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">925</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26 21:31:16&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_indicator_filter</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_field</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_indicator_field</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Date</span> <span class="k">as</span> <span class="nn">Date</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;defender_indicators&quot;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;indicatorValue&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;indicatorType&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_severity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_created_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;createdByDisplayName&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_creation_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;creationTimeDateTimeUtc_ts&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_expiration_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator</span><span class="p">[</span><span class="s1">&#39;expirationTime_ts&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Active&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action unsuccessful.</span><span class="se">\n</span><span class="s2">Action: List indicators</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-quarantine-file">
<h2>Function - Defender Quarantine File<a class="headerlink" href="#function-defender-quarantine-file" title="Link to this heading">¶</a></h2>
<p>Quarantine a SHA-1 file</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#MachineActions/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;15c5a0d4-6b9d-4751-87bf-e6e0b5e2170a&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;StopAndQuarantineFile&#39;</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestor&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;requestorComment&#39;</span><span class="p">:</span> <span class="s1">&#39;quarantine&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Succeeded&#39;</span><span class="p">,</span>
    <span class="s1">&#39;machineId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T18:24:35.8640423Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T18:24:58.758451Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cancellationRequestor&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationComment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationDateTimeUtc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;errorHResult&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestSource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;relatedFileInfo&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;fileIdentifier&#39;</span><span class="p">:</span> <span class="s1">&#39;5e1c8874b29de480a0513516fb542cad2b049cc3&#39;</span><span class="p">,</span>
      <span class="s1">&#39;fileIdentifierType&#39;</span><span class="p">:</span> <span class="s1">&#39;Sha1&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;troubleshootInfo&#39;</span><span class="p">:</span> <span class="kc">None</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;{&quot;@odata.context&quot;: &quot;https://api.securitycenter.microsoft.com/api/$metadata#MachineActions/$entity&quot;, &quot;id&quot;: &quot;15c5a0d4-6b9d-4751-87bf-e6e0b5e2170a&quot;, &quot;type&quot;: &quot;StopAndQuarantineFile&quot;, &quot;title&quot;: null, &quot;requestor&quot;: &quot;2578565a-7957-474e-b626-d290d93c7e38&quot;, &quot;requestorComment&quot;: &quot;quarantine&quot;, &quot;status&quot;: &quot;Succeeded&quot;, &quot;machineId&quot;: &quot;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&quot;, &quot;computerDnsName&quot;: &quot;windowsvmos&quot;, &quot;creationDateTimeUtc&quot;: &quot;2021-10-27T18:24:35.8640423Z&quot;, &quot;lastUpdateDateTimeUtc&quot;: &quot;2021-10-27T18:24:58.758451Z&quot;, &quot;cancellationRequestor&quot;: null, &quot;cancellationComment&quot;: null, &quot;cancellationDateTimeUtc&quot;: null, &quot;errorHResult&quot;: 0, &quot;scope&quot;: null, &quot;externalId&quot;: null, &quot;requestSource&quot;: &quot;PublicApi&quot;, &quot;relatedFileInfo&quot;: {&quot;fileIdentifier&quot;: &quot;5e1c8874b29de480a0513516fb542cad2b049cc3&quot;, &quot;fileIdentifierType&quot;: &quot;Sha1&quot;}, &quot;commands&quot;: [], &quot;troubleshootInfo&quot;: null}&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_description&#39;</span><span class="p">:</span> <span class="s1">&#39;quarantine&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_machine_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_indicator_value&#39;</span><span class="p">:</span> <span class="s1">&#39;5e1c8874b29de480a0513516fb542cad2b049cc3&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57c5bb9c88-7gbcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">32322</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 18:25:06&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_value</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_file_hash&#39;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
  <span class="n">action_msg</span> <span class="o">=</span> <span class="s2">&quot;Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Status: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Start Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;requestorComment&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">]</span>
    <span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_last_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">action_msg</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Quarantine file Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Machine: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">Type: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">],</span>
           <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_isolation_type</span><span class="p">),</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span><span class="p">,</span>
           <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-get-related-alert-information">
<h2>Function - Defender Get Related Alert Information<a class="headerlink" href="#function-defender-get-related-alert-information" title="Link to this heading">¶</a></h2>
<p>Get a Defender machine alert details</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_info</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">multiselect</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;General&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Alerts/$entity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;da637792709228082931_312545642&#39;</span><span class="p">,</span>
        <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span>
        <span class="s1">&#39;investigationId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;New&#39;</span><span class="p">,</span>
        <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;investigationState&#39;</span><span class="p">:</span> <span class="s1">&#39;UnsupportedAlertType&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectionSource&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsDefenderAtp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectorId&#39;</span><span class="p">:</span> <span class="s1">&#39;7f1c3609-a3ff-40e2-995b-c01770161d68&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Execution&#39;</span><span class="p">,</span>
        <span class="s1">&#39;threatFamilyName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious PowerShell command line&#39;</span><span class="p">,</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;A suspicious PowerShell activity was observed on the machine. </span><span class="se">\n</span><span class="s1">This behavior may indicate that PowerShell was used during installation, exploration, or in some cases in lateral movement activities which are used by attackers to invoke modules, download external payloads, or get more information about the system. Attackers usually use PowerShell to bypass security protection mechanisms by executing their payload in memory without touching the disk and leaving any trace.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;alertCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-02-01T00:08:42.8083243Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;firstEventTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-01-31T23:46:32.8126235Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastEventTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-01-31T23:46:32.8126235Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastUpdateTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-02-01T21:05:48.8466667Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resolvedTime&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;machineId&#39;</span><span class="p">:</span> <span class="s1">&#39;93dfc3af285816182861e0a5252624420bcc0484&#39;</span><span class="p">,</span>
        <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rbacGroupName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;aadTenantId&#39;</span><span class="p">:</span> <span class="s1">&#39;50ad7d3e-b889-434d-802d-13b87c68047b&#39;</span><span class="p">,</span>
        <span class="s1">&#39;threatName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;mitreTechniques&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s1">&#39;T1059.001&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;relatedUser&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;loggedOnUsers&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">],</span>
        <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">],</span>
        <span class="s1">&#39;evidence&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;entityType&#39;</span><span class="p">:</span> <span class="s1">&#39;Process&#39;</span><span class="p">,</span>
            <span class="s1">&#39;evidenceCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-02-01T00:08:43.0766667Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;powershell.exe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;filePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Windows</span><span class="se">\\</span><span class="s1">System32</span><span class="se">\\</span><span class="s1">WindowsPowerShell</span><span class="se">\\</span><span class="s1">v1.0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;processId&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;processCommandLine&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;C:</span><span class="se">\\</span><span class="s1">Windows</span><span class="se">\\</span><span class="s1">System32</span><span class="se">\\</span><span class="s1">WindowsPowerShell</span><span class="se">\\</span><span class="s1">v1.0</span><span class="se">\\</span><span class="s1">powershell.exe&quot; -W Hidden -Exec Bypass -Command cd /;$fileBase64Prefix = </span><span class="se">\&#39;\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">TVq</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">QAAM</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">AAAAE</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">AAAA</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">/</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">/</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix + </span><span class="se">\&#39;</span><span class="s1">8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAAZIYCAD/vl1oAAAAAAAAAAPAAIgALAjAAABQAAAAGAAAAAAAAAAAAAAAgAAAAAABAAQAAAAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAABgAAAAAgAAAAAAAAMAYIUAAEAAAAAAAABAAAAAAAAAAAAQAAAAAAAAIAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAABAAADMBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJDIAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><span class="se">\&#39;</span><span class="s1">;$fileBase64Prefix= $fileBase64Prefix&#39;</span><span class="p">,</span>
            <span class="s1">&#39;processCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-01-31T22:27:37.6696966Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessCreationTime&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFileName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFilePath&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;registryKey&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;registryHive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;registryValueType&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;registryValue&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;registryValueName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;accountName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;domainName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;userSid&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;aadUserId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;userPrincipalName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;detectionStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Detected&#39;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;domains&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s1">&#39;Devices&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Machines/$entity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;93dfc3af285816182861e0a5252624420bcc0484&#39;</span><span class="p">,</span>
        <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;firstSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-01-31T23:04:08.319Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-07-25T20:05:50.4642241Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osPlatform&#39;</span><span class="p">:</span> <span class="s1">&#39;Windows10&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osVersion&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;osProcessor&#39;</span><span class="p">:</span> <span class="s1">&#39;x64&#39;</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;21H2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastIpAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastExternalIpAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;13.90.197.104&#39;</span><span class="p">,</span>
        <span class="s1">&#39;agentVersion&#39;</span><span class="p">:</span> <span class="s1">&#39;10.8040.19041.1806&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osBuild&#39;</span><span class="p">:</span> <span class="mi">19044</span><span class="p">,</span>
        <span class="s1">&#39;healthStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
        <span class="s1">&#39;deviceValue&#39;</span><span class="p">:</span> <span class="s1">&#39;Normal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rbacGroupId&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;rbacGroupName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;riskScore&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
        <span class="s1">&#39;exposureLevel&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span>
        <span class="s1">&#39;isAadJoined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;aadDeviceId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;machineTags&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">],</span>
        <span class="s1">&#39;defenderAvStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Updated&#39;</span><span class="p">,</span>
        <span class="s1">&#39;onboardingStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Onboarded&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osArchitecture&#39;</span><span class="p">:</span> <span class="s1">&#39;64-bit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;managedBy&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
        <span class="s1">&#39;managedByStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ipAddresses&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.6&#39;</span><span class="p">,</span>
            <span class="s1">&#39;macAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;00224830591E&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Ethernet&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operationalStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Up&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;fe80::2d05:7c19:7f63:8827&#39;</span><span class="p">,</span>
            <span class="s1">&#39;macAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;00224830591E&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Ethernet&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operationalStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Up&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;macAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SoftwareLoopback&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operationalStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Up&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;::1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;macAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SoftwareLoopback&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operationalStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Up&#39;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;vmMetadata&#39;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s1">&#39;vmId&#39;</span><span class="p">:</span> <span class="s1">&#39;fe4b8cbd-759a-44c7-bf2b-d07bd1d1c542&#39;</span><span class="p">,</span>
          <span class="s1">&#39;cloudProvider&#39;</span><span class="p">:</span> <span class="s1">&#39;Azure&#39;</span><span class="p">,</span>
          <span class="s1">&#39;resourceId&#39;</span><span class="p">:</span> <span class="s1">&#39;/subscriptions/a4b7e24a-c7aa-4d84-8dae-89e99b336784/resourceGroups/DemoAssets/providers/Microsoft.Compute/virtualMachines/WindowsVMOS2&#39;</span><span class="p">,</span>
          <span class="s1">&#39;subscriptionId&#39;</span><span class="p">:</span> <span class="s1">&#39;a4b7e24a-c7aa-4d84-8dae-89e99b336784&#39;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s1">&#39;Domains&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Domains&#39;</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s1">&#39;Files&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Files&#39;</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s1">&#39;IPs&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Ips&#39;</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span>
          
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s1">&#39;Users&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">&#39;Forbidden&#39;</span><span class="p">,</span>
          <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;The application does not have any of the required application permissions (User.Read.All) to access the resource.&#39;</span><span class="p">,</span>
          <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;4416c3a8-64f6-4bcf-af36-bfd0e1f9808d&#39;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;defender_alert_info&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;All&#39;</span>
      <span class="p">],</span>
      <span class="s1">&#39;defender_alert_id&#39;</span><span class="p">:</span> <span class="s1">&#39;da637792709228082931_312545642&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
      <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
      <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.2&#39;</span><span class="p">,</span>
      <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;d1ce3546-4e5d-4925-9876-a14cb453f735-765669c8c9-4b45p&#39;</span><span class="p">,</span>
      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">3462</span><span class="p">,</span>
      <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2022-07-26 18:53:31&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-machine-scan">
<h2>Function - Defender Machine Scan<a class="headerlink" href="#function-defender-machine-scan" title="Link to this heading">¶</a></h2>
<p>Start a Defender Machine antivirus scan</p>
<p><img alt="screenshot: fn-defender-machine-scan " src="../_images/fn-defender-app-execution.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_scantype</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>antivirus scan type</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#MachineActions/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;c54022c7-7753-4fc4-8205-332449fe0771&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RunAntiVirusScan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestor&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;requestorComment&#39;</span><span class="p">:</span> <span class="s1">&#39;full scan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Succeeded&#39;</span><span class="p">,</span>
    <span class="s1">&#39;machineId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T18:27:10.78994Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T18:27:46.4231735Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cancellationRequestor&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationComment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationDateTimeUtc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;errorHResult&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
    <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestSource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;relatedFileInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;troubleshootInfo&#39;</span><span class="p">:</span> <span class="kc">None</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_description&#39;</span><span class="p">:</span> <span class="s1">&#39;full scan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_machine_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_machine_scantype&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">312</span><span class="p">,</span>
      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Full&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57c5bb9c88-7gbcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">61758</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 18:28:11&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_scantype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_machine_scantype</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
  <span class="n">action_msg</span> <span class="o">=</span> <span class="s2">&quot;Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Status: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Start Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;requestorComment&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">]</span>
    <span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_last_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">action_msg</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Scan Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Machine: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">Type: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">],</span>
           <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_isolation_type</span><span class="p">),</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span><span class="p">,</span>
           <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-set-indicator">
<h2>Function - Defender Set Indicator<a class="headerlink" href="#function-defender-set-indicator" title="Link to this heading">¶</a></h2>
<p>Set or update an indicator with exposure values</p>
<p><img alt="screenshot: fn-defender-set-indicator " src="../_images/fn-defender-set-indicator.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_expiration_time</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_action</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_severity</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_title</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Indicators/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span>
    <span class="s1">&#39;indicatorValue&#39;</span><span class="p">:</span> <span class="s1">&#39;45.146.164.110&#39;</span><span class="p">,</span>
    <span class="s1">&#39;indicatorType&#39;</span><span class="p">:</span> <span class="s1">&#39;IpAddress&#39;</span><span class="p">,</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Allowed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;createdBy&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span>
    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;application&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;educateUrl&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;bypassDurationHours&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;my indicator&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;ip addr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;recommendedActions&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;creationTimeDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26T21:40:30.868013Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;expirationTime&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T01:27:35.1627118Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdatedBy&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rbacGroupNames&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;rbacGroupIds&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;notificationId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;notificationBody&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;mitreTechniques&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;historicalDetection&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;lookBackPeriod&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;generateAlert&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;additionalInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;createdByDisplayName&#39;</span><span class="p">:</span> <span class="s1">&#39;Defender 365&#39;</span><span class="p">,</span>
    <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;createdBySource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;certificateInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;creationTimeDateTimeUtc_ts&#39;</span><span class="p">:</span> <span class="mi">1635284430000</span><span class="p">,</span>
    <span class="s1">&#39;expirationTime_ts&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateTime_ts&#39;</span><span class="p">:</span> <span class="mi">1635298055000</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_indicator_type&#39;</span><span class="p">:</span> <span class="s1">&#39;IP Address&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_title&#39;</span><span class="p">:</span> <span class="s1">&#39;my indicator&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_description&#39;</span><span class="p">:</span> <span class="s1">&#39;ip addr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_expiration_time&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;defender_indicator_action&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">251</span><span class="p">,</span>
      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Allowed&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;defender_severity&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">265</span><span class="p">,</span>
      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;defender_indicator_value&#39;</span><span class="p">:</span> <span class="s1">&#39;45.146.164.110&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;MacBook-Pro.local&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">1032</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26 21:27:35&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_type</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">type</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_description</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_expiration_time</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_expiration</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_title</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_title</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_severity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_severity</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_action</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_action</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Date</span> <span class="k">as</span> <span class="nn">Date</span>

<span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Artifact: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Title: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Severity: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Expiration: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_action</span><span class="p">),</span>
           <span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_title</span><span class="p">,</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_description</span><span class="p">,</span>
           <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_severity</span><span class="p">),</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">indicator_expiration</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;defender_indicators&quot;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;indicatorValue&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;indicatorType&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_severity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_created_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;createdByDisplayName&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_creation_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;creationTimeDateTimeUtc_ts&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_expiration_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;expirationTime_ts&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Active&#39;</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-get-file-information">
<h2>Function - Defender Get File Information<a class="headerlink" href="#function-defender-get-file-information" title="Link to this heading">¶</a></h2>
<p>Get additional information about a Defender SHA1 or SHA256 file reference.</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_file_hash</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>SHA1 or SHA256</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Files/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="s1">&#39;cc4934376adfa2c4d5c698791c51264d0080948b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="s1">&#39;455795fabfd3c2c246b4b9e37782db8dbac8c9957210d782331861b56010bb12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;md5&#39;</span><span class="p">:</span> <span class="s1">&#39;3912bbf391299d495109636a0ea47bcb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;globalPrevalence&#39;</span><span class="p">:</span> <span class="mi">10968</span><span class="p">,</span>
    <span class="s1">&#39;globalFirstObserved&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-08-23T07:26:58.0186152Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;globalLastObserved&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T12:53:07.9730547Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">192512</span><span class="p">,</span>
    <span class="s1">&#39;fileType&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;isPeFile&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;filePublisher&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;fileProductName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;signer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;issuer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;signerHash&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;isValidCertificate&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;determinationType&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
    <span class="s1">&#39;determinationValue&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_file_hash&#39;</span><span class="p">:</span> <span class="s1">&#39;cc4934376adfa2c4d5c698791c51264d0080948b&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57df779566-tkf5x&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">673</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 20:52:51&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_file_hash</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Get File Information failed: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">[</span><span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Get File Information:</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">info</span><span class="p">))</span>

<span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
    <span class="n">artifact</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">artifact</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">msg</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">{</span>
<span class="sd">    &quot;@odata.context&quot;: &quot;https://api.securitycenter.microsoft.com/api/$metadata#Files/$entity&quot;,</span>
<span class="sd">    &quot;sha1&quot;: &quot;4388963aaa83afe2042a46a3c017ad50bdcdafb3&quot;,</span>
<span class="sd">    &quot;sha256&quot;: &quot;413c58c8267d2c8648d8f6384bacc2ae9c929b2b96578b6860b5087cd1bd6462&quot;,</span>
<span class="sd">    &quot;globalPrevalence&quot;: 180022,</span>
<span class="sd">    &quot;globalFirstObserved&quot;: &quot;2017-09-19T03:51:27.6785431Z&quot;,</span>
<span class="sd">    &quot;globalLastObserved&quot;: &quot;2020-01-06T03:59:21.3229314Z&quot;,</span>
<span class="sd">    &quot;size&quot;: 22139496,</span>
<span class="sd">    &quot;fileType&quot;: &quot;APP&quot;,</span>
<span class="sd">    &quot;isPeFile&quot;: true,</span>
<span class="sd">    &quot;filePublisher&quot;: &quot;CHENGDU YIWO Tech Development Co., Ltd.&quot;,</span>
<span class="sd">    &quot;fileProductName&quot;: &quot;EaseUS MobiSaver for Android&quot;,</span>
<span class="sd">    &quot;signer&quot;: &quot;CHENGDU YIWO Tech Development Co., Ltd.&quot;,</span>
<span class="sd">    &quot;issuer&quot;: &quot;VeriSign Class 3 Code Signing 2010 CA&quot;,</span>
<span class="sd">    &quot;signerHash&quot;: &quot;6c3245d4a9bc0244d99dff27af259cbbae2e2d16&quot;,</span>
<span class="sd">    &quot;isValidCertificate&quot;: false,</span>
<span class="sd">    &quot;determinationType&quot;: &quot;Pua&quot;,</span>
<span class="sd">    &quot;determinationValue&quot;: &quot;PUA:Win32/FusionCore&quot;</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-find-machines-by-filter">
<h2>Function - Defender Find Machines by filter<a class="headerlink" href="#function-defender-find-machines-by-filter" title="Link to this heading">¶</a></h2>
<p>Find machines based on the OData filter capability of Defender.</p>
<p><img alt="screenshot: fn-defender-find-machines-by-filter " src="../_images/dt-defender-machines.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_filter_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_filter_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Machines&#39;</span><span class="p">,</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
        <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
        <span class="s1">&#39;firstSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-08-11T13:36:43.1619242Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T03:23:49.4008551Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osPlatform&#39;</span><span class="p">:</span> <span class="s1">&#39;Windows10&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osVersion&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;osProcessor&#39;</span><span class="p">:</span> <span class="s1">&#39;x64&#39;</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;20H2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastIpAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.5&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastExternalIpAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;52.188.18.234&#39;</span><span class="p">,</span>
        <span class="s1">&#39;agentVersion&#39;</span><span class="p">:</span> <span class="s1">&#39;10.7740.19041.1288&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osBuild&#39;</span><span class="p">:</span> <span class="mi">19042</span><span class="p">,</span>
        <span class="s1">&#39;healthStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
        <span class="s1">&#39;deviceValue&#39;</span><span class="p">:</span> <span class="s1">&#39;Normal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rbacGroupId&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;rbacGroupName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;riskScore&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
        <span class="s1">&#39;exposureLevel&#39;</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span>
        <span class="s1">&#39;isAadJoined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;aadDeviceId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;machineTags&#39;</span><span class="p">:</span> <span class="p">[</span>

        <span class="p">],</span>
        <span class="s1">&#39;defenderAvStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Updated&#39;</span><span class="p">,</span>
        <span class="s1">&#39;onboardingStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Onboarded&#39;</span><span class="p">,</span>
        <span class="s1">&#39;osArchitecture&#39;</span><span class="p">:</span> <span class="s1">&#39;64-bit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;managedBy&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ipAddresses&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;10.0.0.5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;macAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;000D3A5680FC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Ethernet&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operationalStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Up&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s1">&#39;ipAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;fe80::844e:e65d:bc36:4f8f&#39;</span><span class="p">,</span>
            <span class="s1">&#39;macAddress&#39;</span><span class="p">:</span> <span class="s1">&#39;000D3A5680FC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Ethernet&#39;</span><span class="p">,</span>
            <span class="s1">&#39;operationalStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Up&#39;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;vmMetadata&#39;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s1">&#39;vmId&#39;</span><span class="p">:</span> <span class="s1">&#39;55de7a4c-b77a-4748-9c4f-048b88c0f3aa&#39;</span><span class="p">,</span>
          <span class="s1">&#39;cloudProvider&#39;</span><span class="p">:</span> <span class="s1">&#39;Azure&#39;</span><span class="p">,</span>
          <span class="s1">&#39;resourceId&#39;</span><span class="p">:</span> <span class="s1">&#39;/subscriptions/a4b7e24a-c7aa-4d84-8dae-89e99b336784/resourceGroups/DEMOASSETS/providers/Microsoft.Compute/virtualMachines/WindowsVMOS&#39;</span><span class="p">,</span>
          <span class="s1">&#39;subscriptionId&#39;</span><span class="p">:</span> <span class="s1">&#39;a4b7e24a-c7aa-4d84-8dae-89e99b336784&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;firstSeen_ts&#39;</span><span class="p">:</span> <span class="mi">1628689003000</span><span class="p">,</span>
        <span class="s1">&#39;lastSeen_ts&#39;</span><span class="p">:</span> <span class="mi">1635305029000</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;{&quot;@odata.context&quot;: &quot;https://api.securitycenter.microsoft.com/api/$metadata#Machines&quot;, &quot;value&quot;: [{&quot;id&quot;: &quot;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&quot;, &quot;computerDnsName&quot;: &quot;windowsvmos&quot;, &quot;firstSeen&quot;: &quot;2021-08-11T13:36:43.1619242Z&quot;, &quot;lastSeen&quot;: &quot;2021-10-27T03:23:49.4008551Z&quot;, &quot;osPlatform&quot;: &quot;Windows10&quot;, &quot;osVersion&quot;: null, &quot;osProcessor&quot;: &quot;x64&quot;, &quot;version&quot;: &quot;20H2&quot;, &quot;lastIpAddress&quot;: &quot;10.0.0.5&quot;, &quot;lastExternalIpAddress&quot;: &quot;52.188.18.234&quot;, &quot;agentVersion&quot;: &quot;10.7740.19041.1288&quot;, &quot;osBuild&quot;: 19042, &quot;healthStatus&quot;: &quot;Active&quot;, &quot;deviceValue&quot;: &quot;Normal&quot;, &quot;rbacGroupId&quot;: 0, &quot;rbacGroupName&quot;: null, &quot;riskScore&quot;: &quot;High&quot;, &quot;exposureLevel&quot;: &quot;Low&quot;, &quot;isAadJoined&quot;: false, &quot;aadDeviceId&quot;: null, &quot;machineTags&quot;: [], &quot;defenderAvStatus&quot;: &quot;Updated&quot;, &quot;onboardingStatus&quot;: &quot;Onboarded&quot;, &quot;osArchitecture&quot;: &quot;64-bit&quot;, &quot;managedBy&quot;: &quot;Unknown&quot;, &quot;ipAddresses&quot;: [{&quot;ipAddress&quot;: &quot;10.0.0.5&quot;, &quot;macAddress&quot;: &quot;000D3A5680FC&quot;, &quot;type&quot;: &quot;Ethernet&quot;, &quot;operationalStatus&quot;: &quot;Up&quot;}, {&quot;ipAddress&quot;: &quot;fe80::844e:e65d:bc36:4f8f&quot;, &quot;macAddress&quot;: &quot;000D3A5680FC&quot;, &quot;type&quot;: &quot;Ethernet&quot;, &quot;operationalStatus&quot;: &quot;Up&quot;}], &quot;vmMetadata&quot;: {&quot;vmId&quot;: &quot;55de7a4c-b77a-4748-9c4f-048b88c0f3aa&quot;, &quot;cloudProvider&quot;: &quot;Azure&quot;, &quot;resourceId&quot;: &quot;/subscriptions/a4b7e24a-c7aa-4d84-8dae-89e99b336784/resourceGroups/DEMOASSETS/providers/Microsoft.Compute/virtualMachines/WindowsVMOS&quot;, &quot;subscriptionId&quot;: &quot;a4b7e24a-c7aa-4d84-8dae-89e99b336784&quot;}, &quot;firstSeen_ts&quot;: 1628689003000, &quot;lastSeen_ts&quot;: 1635305029000}]}&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_filter_value&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_filter_name&#39;</span><span class="p">:</span> <span class="s1">&#39;filter_by_name&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57c5bb9c88-7gbcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 18:36:18&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_filter_name</span> <span class="o">=</span> <span class="s2">&quot;filter_by_name&quot;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_filter_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">&quot;value&quot;: [</span>
<span class="sd">    {</span>
<span class="sd">        &quot;id&quot;: &quot;04c99d46599f078f1c3da3783cf5b95f01ac61bb&quot;,</span>
<span class="sd">        &quot;computerDnsName&quot;: &quot;&quot;,</span>
<span class="sd">        &quot;firstSeen&quot;: &quot;2017-07-06T01:25:04.9480498Z&quot;,</span>
<span class="sd">        &quot;osPlatform&quot;: &quot;Windows10&quot;,</span>
<span class="sd">    }</span>
<span class="sd">]</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">machine</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
      <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;defender_atp_machines&quot;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;lastExternalIpAddress&#39;</span><span class="p">]</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;computerDnsName&#39;</span><span class="p">]</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_platform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;osPlatform&#39;</span><span class="p">]</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_firstseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;firstSeen_ts&#39;</span><span class="p">]</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_lastseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;lastSeen_ts&#39;</span><span class="p">]</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_health_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;healthStatus&#39;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_risk_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;riskScore&#39;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_exposure_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exposureLevel&#39;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;machineTags&#39;</span><span class="p">,</span> <span class="p">[]))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action unsuccessful.</span><span class="se">\n</span><span class="s2">Action: Find machines by filter</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-delete-indicator">
<h2>Function - Defender Delete Indicator<a class="headerlink" href="#function-defender-delete-indicator" title="Link to this heading">¶</a></h2>
<p>Delete an indicator from Defender</p>
<p><img alt="screenshot: fn-defender-delete-indicator " src="../_images/fn-defender-delete-indicator.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>

  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_indicator_id&#39;</span><span class="p">:</span> <span class="s1">&#39;11&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;MacBook-Pro.local&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">665</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26 21:33:51&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Date</span> <span class="k">as</span> <span class="nn">Date</span>

<span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Action: Delete Indicator</span><span class="se">\n</span><span class="s2">Indicator: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_value&#39;</span><span class="p">],</span>
           <span class="p">)</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Inactive&#39;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-get-incident">
<h2>Function - Defender Get Incident<a class="headerlink" href="#function-defender-get-incident" title="Link to this heading">¶</a></h2>
<p>Get a Defender 365 Incident</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_result_max</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p>Number of top results to return</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Incidents/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s1">&#39;incidentUri&#39;</span><span class="p">:</span> <span class="s1">&#39;https://security.microsoft.com/incidents/31?tid=50ad7d3e-b889-434d-802d-13b87c68047b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;redirectIncidentId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;incidentName&#39;</span><span class="p">:</span> <span class="s1">&#39;Multi-stage incident involving Initial access &amp; Discovery on one endpoint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;createdTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:55.0166667Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T01:12:39.9333333Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="s1">&#39;Defender 365&#39;</span><span class="p">,</span>
    <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s1">&#39;tagA&#39;</span><span class="p">,</span>
      <span class="s1">&#39;tagB&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;new comment from azure&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdBy&#39;</span><span class="p">:</span> <span class="s1">&#39;abc@swivrllc.onmicrosoft.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-22T20:53:53.9133333Z&#39;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;alertId&#39;</span><span class="p">:</span> <span class="s1">&#39;da637701781744658799_2045659800&#39;</span><span class="p">,</span>
        <span class="s1">&#39;providerAlertId&#39;</span><span class="p">:</span> <span class="s1">&#39;da637701781744658799_2045659800&#39;</span><span class="p">,</span>
        <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
        <span class="s1">&#39;serviceSource&#39;</span><span class="p">:</span> <span class="s1">&#39;MicrosoftDefenderForEndpoint&#39;</span><span class="p">,</span>
        <span class="s1">&#39;creationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:54.465905Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastUpdatedTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T01:12:39.9533333Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resolvedTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26T20:38:24.3646436Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;firstActivity&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:38.3176713Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastActivity&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:40.2929171Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious Task Scheduler activity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;A process involved in earlier malicious activity used Task Scheduler to create, modify, or delete a task. This might be an attempt launch malicious code automatically and establish persistence.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Persistence&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Resolved&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
        <span class="s1">&#39;investigationId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;investigationState&#39;</span><span class="p">:</span> <span class="s1">&#39;UnsupportedAlertType&#39;</span><span class="p">,</span>
        <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
        <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Other&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectionSource&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsDefenderAtp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectorId&#39;</span><span class="p">:</span> <span class="s1">&#39;446b23e1-48b0-41f9-ae7b-03655adcf941&#39;</span><span class="p">,</span>
        <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="s1">&#39;Automation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;actorName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;threatFamilyName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;mitreTechniques&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s1">&#39;T1053&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;devices&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;aadDeviceId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;deviceDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osPlatform&#39;</span><span class="p">:</span> <span class="s1">&#39;Windows10&#39;</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;20H2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osProcessor&#39;</span><span class="p">:</span> <span class="s1">&#39;x64&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osBuild&#39;</span><span class="p">:</span> <span class="mi">19042</span><span class="p">,</span>
            <span class="s1">&#39;healthStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
            <span class="s1">&#39;riskScore&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rbacGroupName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;firstSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-08-11T13:36:43.1619242Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span>

            <span class="p">],</span>
            <span class="s1">&#39;defenderAvStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Updated&#39;</span><span class="p">,</span>
            <span class="s1">&#39;onboardingStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Onboarded&#39;</span><span class="p">,</span>
            <span class="s1">&#39;vmMetadata&#39;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s1">&#39;vmId&#39;</span><span class="p">:</span> <span class="s1">&#39;55de7a4c-b77a-4748-9c4f-048b88c0f3aa&#39;</span><span class="p">,</span>
              <span class="s1">&#39;cloudProvider&#39;</span><span class="p">:</span> <span class="s1">&#39;Azure&#39;</span><span class="p">,</span>
              <span class="s1">&#39;resourceId&#39;</span><span class="p">:</span> <span class="s1">&#39;/subscriptions/a4b7e24a-c7aa-4d84-8dae-89e99b336784/resourceGroups/DEMOASSETS/providers/Microsoft.Compute/virtualMachines/WindowsVMOS&#39;</span><span class="p">,</span>
              <span class="s1">&#39;subscriptionId&#39;</span><span class="p">:</span> <span class="s1">&#39;a4b7e24a-c7aa-4d84-8dae-89e99b336784&#39;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;entityType&#39;</span><span class="p">:</span> <span class="s1">&#39;Process&#39;</span><span class="p">,</span>
            <span class="s1">&#39;evidenceCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:54.73Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;verdict&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious&#39;</span><span class="p">,</span>
            <span class="s1">&#39;remediationStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="s1">&#39;f5ee89bb1e4a0b1c3c7f1e8d05d0677f2b2b5919&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="s1">&#39;73a3c4aef5de385875339fc2eb7e58a9e8a47b6161bdc6436bf78a763537be70&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;powershell.exe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;filePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Windows</span><span class="se">\\</span><span class="s1">SysWOW64</span><span class="se">\\</span><span class="s1">WindowsPowerShell</span><span class="se">\\</span><span class="s1">v1.0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;processId&#39;</span><span class="p">:</span> <span class="mi">10212</span><span class="p">,</span>
            <span class="s1">&#39;processCommandLine&#39;</span><span class="p">:</span> <span class="s2">&quot;powershell.exe -W Hidden -Exec Bypass -Command cd /;$fileBase64Prefix = &#39;&#39;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;processCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:33.3686931Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessId&#39;</span><span class="p">:</span> <span class="mi">10452</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:11.4593785Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFileName&#39;</span><span class="p">:</span> <span class="s1">&#39;WINWORD.EXE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFilePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Program Files (x86)</span><span class="se">\\</span><span class="s1">Microsoft Office</span><span class="se">\\</span><span class="s1">root</span><span class="se">\\</span><span class="s1">Office16&#39;</span><span class="p">,</span>
            <span class="s1">&#39;accountName&#39;</span><span class="p">:</span> <span class="s1">&#39;userAccount&#39;</span><span class="p">,</span>
            <span class="s1">&#39;domainName&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsVMOS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;userSid&#39;</span><span class="p">:</span> <span class="s1">&#39;S-1-5-21-1542157044-1944968518-3635326852-500&#39;</span><span class="p">,</span>
            <span class="s1">&#39;aadUserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ae973ab4-1b5e-48b2-bf2f-c3bf1b3634a2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;userPrincipalName&#39;</span><span class="p">:</span> <span class="s1">&#39;def@swivrllc.onmicrosoft.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;detectionStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Detected&#39;</span><span class="p">,</span>
            <span class="s1">&#39;deviceId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_incident_id&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s1">&#39;defender_determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_tags&#39;</span><span class="p">:</span> <span class="s1">&#39;tagA,tagB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_incident_status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;Marks-MacBook-Pro.local&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">1950</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-26 21:12:40&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_incident_id</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Date</span> <span class="k">as</span> <span class="nn">Date</span>

<span class="n">now</span> <span class="o">=</span> <span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>

<span class="n">resultz</span> <span class="o">=</span> <span class="n">results</span>

<span class="k">if</span> <span class="n">resultz</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="c1"># get max alert setting</span>
    <span class="n">max_alerts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">resultz</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;defender_alert_result_max&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">row_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">machine_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">resultz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alerts&#39;</span><span class="p">,</span> <span class="p">{}):</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;devices&#39;</span><span class="p">,</span> <span class="p">{}):</span>
            <span class="k">if</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">machine_list</span><span class="p">:</span>
                <span class="n">machine_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">])</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s1">&#39;defender_machines&#39;</span><span class="p">)</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">())</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;https://security.microsoft.com/machines/</span><span class="si">{}</span><span class="s2">/overview&#39;&gt;machine&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">])</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;deviceDnsName&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_platform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;osPlatform&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_firstseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;firstSeen_ts&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_health_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;healthStatus&#39;</span><span class="p">)</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_risk_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;riskScore&#39;</span><span class="p">)</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="p">[]))</span>

            <span class="k">if</span> <span class="n">row_count</span> <span class="o">&lt;</span> <span class="n">max_alerts</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">max_alerts</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;defender_alerts&quot;</span><span class="p">)</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;https://security.microsoft.com/alerts/</span><span class="si">{}</span><span class="s2">&#39;&gt;Alert&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;alertId&#39;</span><span class="p">])</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;alertId&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;assigned_to&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;assignedTo&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;mitre_techniques&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;mitreTechniques&#39;</span><span class="p">]))</span>

                <span class="c1"># include the machine inform</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;computer_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;deviceDnsName&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;risk_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;riskScore&#39;</span><span class="p">]</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;first_seen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;firstSeen&#39;</span><span class="p">]</span>
            <span class="n">row_count</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Get Incident unsuccessful.</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resultz</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-find-machines-by-internal-ip">
<h2>Function - Defender Find Machines by Internal IP<a class="headerlink" href="#function-defender-find-machines-by-internal-ip" title="Link to this heading">¶</a></h2>
<p>Find Defender Machine(s) by Internal IP address</p>
<p><img alt="screenshot: fn-defender-find-machines-by-ip " src="../_images/fn-defender-find-machines-by-ip.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_indicator_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_lookback_timeframe</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datepicker</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>This value must be within 30 days of current date</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># TODO: Copy and paste an example of the Function Output within this code block.</span>
    <span class="c1"># To view the output of a Function, run resilient-circuits in DEBUG mode and invoke the Function.</span>
    <span class="c1"># The Function results will be printed in the logs: &quot;resilient-circuits run --loglevel=DEBUG&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_indicator_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_lookback_timeframe</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_lookback_timeframe</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">&quot;value&quot;: [</span>
<span class="sd">    {</span>
<span class="sd">        &quot;id&quot;: &quot;04c99d46599f078f1c3da3783cf5b95f01ac61bb&quot;,</span>
<span class="sd">        &quot;computerDnsName&quot;: &quot;&quot;,</span>
<span class="sd">        &quot;firstSeen&quot;: &quot;2017-07-06T01:25:04.9480498Z&quot;,</span>
<span class="sd">        &quot;osPlatform&quot;: &quot;Windows10&quot;,</span>
<span class="sd">    }</span>
<span class="sd">]</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Find machines by IP Address unsuccessful.</span><span class="se">\n</span><span class="s2">Nothing found for </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">machine</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;defender_atp_machines&quot;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;computerDnsName&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_platform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;osPlatform&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_firstseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;firstSeen_ts&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_lastseen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="p">[</span><span class="s1">&#39;lastSeen_ts&#39;</span><span class="p">]</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_health_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;healthStatus&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_risk_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;riskScore&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_exposure_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exposureLevel&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">machine</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;machineTags&#39;</span><span class="p">,</span> <span class="p">[]))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action unsuccessful.</span><span class="se">\n</span><span class="s2">Action: Find machines by IP Address</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-update-alert">
<h2>Function - Defender Update Alert<a class="headerlink" href="#function-defender-update-alert" title="Link to this heading">¶</a></h2>
<p>Update a Defender Alert</p>
<p><img alt="screenshot: fn-defender-update-alert " src="../_images/fn-defender-update-alert.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_assigned_to</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_alert_status</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_classification</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_determination</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#Incidents/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s1">&#39;incidentUri&#39;</span><span class="p">:</span> <span class="s1">&#39;https://security.microsoft.com/incidents/31?tid=50ad7d3e-b889-434d-802d-13b87c68047b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;redirectIncidentId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;incidentName&#39;</span><span class="p">:</span> <span class="s1">&#39;Multi-stage incident involving Initial access &amp; Discovery on one endpoint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;createdTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:55.0166667Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T20:06:15.0466667Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="s1">&#39;Defender 365&#39;</span><span class="p">,</span>
    <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s1">&#39;tagA&#39;</span><span class="p">,</span>
      <span class="s1">&#39;tagB&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;new comment from azure&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdBy&#39;</span><span class="p">:</span> <span class="s1">&#39;MarkScherfling@swivrllc.onmicrosoft.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;createdTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-22T20:53:53.9133333Z&#39;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;alertId&#39;</span><span class="p">:</span> <span class="s1">&#39;da637701781744658799_2045659800&#39;</span><span class="p">,</span>
        <span class="s1">&#39;providerAlertId&#39;</span><span class="p">:</span> <span class="s1">&#39;da637701781744658799_2045659800&#39;</span><span class="p">,</span>
        <span class="s1">&#39;incidentId&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
        <span class="s1">&#39;serviceSource&#39;</span><span class="p">:</span> <span class="s1">&#39;MicrosoftDefenderForEndpoint&#39;</span><span class="p">,</span>
        <span class="s1">&#39;creationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:54.465905Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastUpdatedTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T20:06:15.07Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resolvedTime&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;firstActivity&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:38.3176713Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lastActivity&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:40.2929171Z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious Task Scheduler activity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;A process involved in earlier malicious activity used Task Scheduler to create, modify, or delete a task. This might be an attempt launch malicious code automatically and establish persistence.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Persistence&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;InProgress&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
        <span class="s1">&#39;investigationId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;investigationState&#39;</span><span class="p">:</span> <span class="s1">&#39;UnsupportedAlertType&#39;</span><span class="p">,</span>
        <span class="s1">&#39;classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
        <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Other&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectionSource&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsDefenderAtp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;detectorId&#39;</span><span class="p">:</span> <span class="s1">&#39;446b23e1-48b0-41f9-ae7b-03655adcf941&#39;</span><span class="p">,</span>
        <span class="s1">&#39;assignedTo&#39;</span><span class="p">:</span> <span class="s1">&#39;Automation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;actorName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;threatFamilyName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;mitreTechniques&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s1">&#39;T1053&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;devices&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;mdatpDeviceId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;aadDeviceId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;deviceDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osPlatform&#39;</span><span class="p">:</span> <span class="s1">&#39;Windows10&#39;</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;20H2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osProcessor&#39;</span><span class="p">:</span> <span class="s1">&#39;x64&#39;</span><span class="p">,</span>
            <span class="s1">&#39;osBuild&#39;</span><span class="p">:</span> <span class="mi">19042</span><span class="p">,</span>
            <span class="s1">&#39;healthStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span>
            <span class="s1">&#39;riskScore&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rbacGroupName&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;firstSeen&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-08-11T13:36:43.1619242Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="p">[</span>

            <span class="p">],</span>
            <span class="s1">&#39;defenderAvStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Updated&#39;</span><span class="p">,</span>
            <span class="s1">&#39;onboardingStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Onboarded&#39;</span><span class="p">,</span>
            <span class="s1">&#39;vmMetadata&#39;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s1">&#39;vmId&#39;</span><span class="p">:</span> <span class="s1">&#39;55de7a4c-b77a-4748-9c4f-048b88c0f3aa&#39;</span><span class="p">,</span>
              <span class="s1">&#39;cloudProvider&#39;</span><span class="p">:</span> <span class="s1">&#39;Azure&#39;</span><span class="p">,</span>
              <span class="s1">&#39;resourceId&#39;</span><span class="p">:</span> <span class="s1">&#39;/subscriptions/a4b7e24a-c7aa-4d84-8dae-89e99b336784/resourceGroups/DEMOASSETS/providers/Microsoft.Compute/virtualMachines/WindowsVMOS&#39;</span><span class="p">,</span>
              <span class="s1">&#39;subscriptionId&#39;</span><span class="p">:</span> <span class="s1">&#39;a4b7e24a-c7aa-4d84-8dae-89e99b336784&#39;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">&#39;entityType&#39;</span><span class="p">:</span> <span class="s1">&#39;Process&#39;</span><span class="p">,</span>
            <span class="s1">&#39;evidenceCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:22:54.73Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;verdict&#39;</span><span class="p">:</span> <span class="s1">&#39;Suspicious&#39;</span><span class="p">,</span>
            <span class="s1">&#39;remediationStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="s1">&#39;f5ee89bb1e4a0b1c3c7f1e8d05d0677f2b2b5919&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="s1">&#39;73a3c4aef5de385875339fc2eb7e58a9e8a47b6161bdc6436bf78a763537be70&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;powershell.exe&#39;</span><span class="p">,</span>
            <span class="s1">&#39;filePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Windows</span><span class="se">\\</span><span class="s1">SysWOW64</span><span class="se">\\</span><span class="s1">WindowsPowerShell</span><span class="se">\\</span><span class="s1">v1.0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;processId&#39;</span><span class="p">:</span> <span class="mi">10212</span><span class="p">,</span>
            <span class="s1">&#39;processCommandLine&#39;</span><span class="p">:</span> <span class="s2">&quot;powershell.exe&quot;</span><span class="p">,</span>
            <span class="s1">&#39;processCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:33.3686931Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessId&#39;</span><span class="p">:</span> <span class="mi">10452</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessCreationTime&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-18T18:19:11.4593785Z&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFileName&#39;</span><span class="p">:</span> <span class="s1">&#39;WINWORD.EXE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parentProcessFilePath&#39;</span><span class="p">:</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Program Files (x86)</span><span class="se">\\</span><span class="s1">Microsoft Office</span><span class="se">\\</span><span class="s1">root</span><span class="se">\\</span><span class="s1">Office16&#39;</span><span class="p">,</span>
            <span class="s1">&#39;accountName&#39;</span><span class="p">:</span> <span class="s1">&#39;edgarjohnson&#39;</span><span class="p">,</span>
            <span class="s1">&#39;domainName&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowsVMOS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;userSid&#39;</span><span class="p">:</span> <span class="s1">&#39;S-1-5-21-1542157044-1944968518-3635326852-500&#39;</span><span class="p">,</span>
            <span class="s1">&#39;aadUserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ae973ab4-1b5e-48b2-bf2f-c3bf1b3634a2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;userPrincipalName&#39;</span><span class="p">:</span> <span class="s1">&#39;edgarjohnson@swivrllc.onmicrosoft.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;detectionStatus&#39;</span><span class="p">:</span> <span class="s1">&#39;Detected&#39;</span><span class="p">,</span>
            <span class="s1">&#39;deviceId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_classification&#39;</span><span class="p">:</span> <span class="s1">&#39;TruePositive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_incident_id&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s1">&#39;defender_determination&#39;</span><span class="p">:</span> <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Action successful.</span><span class="se">\n</span><span class="s1">Action: Update Alert</span><span class="se">\n</span><span class="s1">Alert: da637701781744658799_2045659800</span><span class="se">\n</span><span class="s1">Machine: windowsvmos</span><span class="se">\n</span><span class="s1">Comment: Malware</span><span class="se">\n</span><span class="s1">Status: InProgress</span><span class="se">\n</span><span class="s1">Classification: TruePositive</span><span class="se">\n</span><span class="s1">Determination: Malware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_tags&#39;</span><span class="p">:</span> <span class="s1">&#39;tagA,tagB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_incident_status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57c5bb9c88-7gbcp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">1479</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 20:06:15&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_alert_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_id&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_classification</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">defender_classification</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_classification</span><span class="p">)</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_determination</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">defender_determination</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_determination</span><span class="p">)</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_status</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">defender_alert_status</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_status</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_alert_assigned_to</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_assigned_to</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Action </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Action: Update Alert</span><span class="se">\n</span><span class="s2">Alert: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Machine: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="s2">&quot;</span>\
   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;successful&quot;</span> <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span> <span class="k">else</span> <span class="s2">&quot;unsuccessful&quot;</span><span class="p">,</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;alert_id&#39;</span><span class="p">],</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;computer_name&#39;</span><span class="p">],</span>
           <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span><span class="p">)</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_assigned_to</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Assigned to: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_assigned_to</span><span class="p">)</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_status</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Status: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_status</span><span class="p">))</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_classification</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Classification: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_classification</span><span class="p">))</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_determination</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Determination: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_alert_determination</span><span class="p">))</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>

<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">alert</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;assigned_to&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;assignedTo&#39;</span><span class="p">]</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-defender-collect-machine-investigation-package">
<h2>Function - Defender Collect Machine Investigation Package<a class="headerlink" href="#function-defender-collect-machine-investigation-package" title="Link to this heading">¶</a></h2>
<p>Collect the machine investigation package</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">defender_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">defender_machine_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;@odata.context&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.securitycenter.microsoft.com/api/$metadata#MachineActions/$entity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;78680309-6688-4e5b-a863-57382c61ba68&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;CollectInvestigationPackage&#39;</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestor&#39;</span><span class="p">:</span> <span class="s1">&#39;2578565a-7957-474e-b626-d290d93c7e38&#39;</span><span class="p">,</span>
    <span class="s1">&#39;requestorComment&#39;</span><span class="p">:</span> <span class="s1">&#39;investigate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Succeeded&#39;</span><span class="p">,</span>
    <span class="s1">&#39;machineId&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;computerDnsName&#39;</span><span class="p">:</span> <span class="s1">&#39;windowsvmos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T20:31:39.226874Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lastUpdateDateTimeUtc&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27T20:33:29.9190697Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cancellationRequestor&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationComment&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;cancellationDateTimeUtc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;errorHResult&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;externalId&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;requestSource&#39;</span><span class="p">:</span> <span class="s1">&#39;PublicApi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;relatedFileInfo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="p">[</span>

    <span class="p">],</span>
    <span class="s1">&#39;troubleshootInfo&#39;</span><span class="p">:</span> <span class="kc">None</span>
  <span class="p">},</span>
  <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;defender_description&#39;</span><span class="p">:</span> <span class="s1">&#39;investigate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;defender_machine_id&#39;</span><span class="p">:</span> <span class="s1">&#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;</span>
  <span class="p">},</span>
  <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-microsoft-defender&#39;</span><span class="p">,</span>
    <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;a2875bae-fd94-432b-8395-2a59908315b3-57df779566-tkf5x&#39;</span><span class="p">,</span>
    <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">122480</span><span class="p">,</span>
    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-10-27 20:33:40&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">defender_machine_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_id&#39;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">defender_description</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">defender_action_comment</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Action: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Comment: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Status: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Start Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;requestorComment&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span>
    <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="s1">&#39;creationDateTimeUtc&#39;</span><span class="p">]</span>
    <span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;machine_last_action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createPlainText</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;report_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &#39;type&#39;: &#39;CollectInvestigationPackage&#39;,</span>
<span class="sd">    &#39;title&#39;: None,</span>
<span class="sd">    &#39;requestor&#39;: &#39;f0dc3f88-f617-449c-960c-6b54818cd110&#39;,</span>
<span class="sd">    &#39;requestorComment&#39;: &#39;ss&#39;,</span>
<span class="sd">    &#39;status&#39;: &#39;Succeeded&#39;,</span>
<span class="sd">    &#39;machineId&#39;: &#39;2a94aaf80aa31094790ce40da6fdfc03a9a145c5&#39;,</span>
<span class="sd">    &#39;computerDnsName&#39;: &#39;windowsvmos&#39;,</span>
<span class="sd">    &#39;creationDateTimeUtc&#39;: &#39;2021-08-12T18:53:06.5259227Z&#39;,</span>
<span class="sd">    &#39;lastUpdateDateTimeUtc&#39;: &#39;2021-08-12T18:54:20.4259984Z&#39;,</span>
<span class="sd">&quot;&quot;&quot;</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-create-artifact-from-indicator">
<h2>Script - Create Artifact from Indicator<a class="headerlink" href="#script-create-artifact-from-indicator" title="Link to this heading">¶</a></h2>
<p>Convert a Defender indicator to an Artifact for further enrichment or remediation</p>
<p><strong>Object:</strong> defender_indicators</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert a Defender indicator to an artifact_type</span>
<span class="c1"># lookup for Defender indicator types to arttfact types</span>
<span class="n">type_lookup</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;FileSha1&quot;</span><span class="p">:</span> <span class="s2">&quot;Malware SHA-1 Hash&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FileSha256&quot;</span><span class="p">:</span> <span class="s2">&quot;Malware SHA-256 Hash&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IpAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;IP Address&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DomainName&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Url&quot;</span><span class="p">:</span> <span class="s2">&quot;URL&quot;</span>
    <span class="p">}</span>

<span class="n">artifact_type</span> <span class="o">=</span> <span class="n">type_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_type&#39;</span><span class="p">],</span> <span class="s2">&quot;String&quot;</span><span class="p">)</span>
<span class="n">artifact_description</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_title&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_description&#39;</span><span class="p">])</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="n">artifact_type</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_value&#39;</span><span class="p">],</span> <span class="n">artifact_description</span><span class="p">)</span>

<span class="n">msg</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Defender Action successful.</span><span class="se">\n</span><span class="s2">Indicator: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Action: Create Artifact&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ind_value&#39;</span><span class="p">])</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="data-table-defender-machines">
<h2>Data Table - Defender Machines<a class="headerlink" href="#data-table-defender-machines" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-defender-machines" src="../_images/dt-defender-machines.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>defender_machines</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Exposure Level</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_exposure_level</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>File Hash</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_file_hash</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>First Seen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_firstseen</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Health Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_health_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Machine ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>IP Address</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_ip</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Last Action</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_last_action</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Last Seen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_lastseen</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Machine Link</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_link</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Machine Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Platform</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_platform</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Risk Score</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_risk_score</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Machine Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Report Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">report_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-defender-alerts">
<h2>Data Table - Defender Alerts<a class="headerlink" href="#data-table-defender-alerts" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-defender-alerts" src="../_images/dt-defender-alerts.png" /></p>
<section id="id1">
<h3>API Name:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>defender_alerts</p>
</section>
<section id="id2">
<h3>Columns:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Alert ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Alert Link</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alert_link</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Assigned To</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">assigned_to</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">category</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Classification</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">classification</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Computer Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">computer_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Determination</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">determination</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>First Seen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">first_seen</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Machine ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">machine_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Mitre Techniques</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mitre_techniques</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Report Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">report_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Risk Score</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">risk_score</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Severity</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">severity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Title</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">title</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-defender-indicators">
<h2>Data Table - Defender Indicators<a class="headerlink" href="#data-table-defender-indicators" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-defender-indicators" src="../_images/dt-defender-indicators.png" /></p>
<section id="id3">
<h3>API Name:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>defender_indicators</p>
</section>
<section id="id4">
<h3>Columns:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Action</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_action</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Created By</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_created_by</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Creation Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_creation_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Expiration Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_expiration_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Indicator ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Severity</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_severity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Title</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_title</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ind_value</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Report Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">report_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Defender Incident LastUpdateTime</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_incident_lastupdatetime</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datepicker</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Defender Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>comma separated list of Defender tags</p></td>
</tr>
<tr class="row-even"><td><p>Defender Incident Id</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_incident_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Defender Incident Url</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_incident_url</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Defender Incident CreateTime</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_incident_createtime</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Defender Classification</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_classification</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>Unknown, FalsePositive, TruePositive.</p></td>
</tr>
<tr class="row-even"><td><p>Defender Determination</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">defender_determination</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>NotAvailable, Apt, Malware, SecurityPersonnel, SecurityTesting, UnwantedSoftware, Other</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Create Artifact from Indicator (PB)</p></td>
<td><p>None</p></td>
<td><p>defender_indicators</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Close Incident (PB)</p></td>
<td><p>Close the corresponding Defender incident when the SOAR incident closes</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">disabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Find Machine by DNS name (PB)</p></td>
<td><p>Use Microsoft OData filters to find machines controlled by Defender. See app documentation for the filters supported.</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Find Machines by File Hash (PB)</p></td>
<td><p>Find Defender machines by SHA1 file hash. Results are returned in the Defender Machines datatable.</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Find Machines by Internal IP Address (PB)</p></td>
<td><p>Find Machines by internal IP address. Results returned in Defender Machines datatable</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Get File Information (PB)</p></td>
<td><p>Get more information about a file based on it’s SHA1 or SHA256 hash</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Get Incident (PB)</p></td>
<td><p>Get a Defender 365 Incident by incident id</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">disabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender List Indicators (PB)</p></td>
<td><p>Get a list of the indicators defined in Defender.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Machine App Execution Restriction (PB)</p></td>
<td><p>Restrict/un-restrict App execution on a Defender managed machine</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Machine Collect Investigation Package (PB)</p></td>
<td><p>Start a process to collect an investigation report</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Machine Isolate Action (PB)</p></td>
<td><p>Isolate/Unisolate a Defender Machine</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Machine Quarantine File (PB)</p></td>
<td><p>Quarantine a file on a given Defender ATP machine</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Machine Refresh Information (PB)</p></td>
<td><p>Refresh Defender machine information</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Machine Scan (PB)</p></td>
<td><p>Start an antivirus scan on a Defender machine</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Machine Update Information (PB)</p></td>
<td><p>Refresh Defender machine information</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">disabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Machine Vulnerabilities (PB)</p></td>
<td><p>Get Defender machine vulnerabilities</p></td>
<td><p>defender_machines</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Refresh Incident (PB)</p></td>
<td><p>Refresh incident, alert and artifact data from Defender</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Set Indicator (PB)</p></td>
<td><p>None</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Sync Comment (PB)</p></td>
<td><p>Sync Defender Incident with new IBM SOAR comments</p></td>
<td><p>note</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">disabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Defender Sync Incident (PB)</p></td>
<td><p>Sync SOAR Incident changes to the corresponding Defender Incident</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">disabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Defender Update Alert (PB)</p></td>
<td><p>Update a Defender Alert: Status, Classification, Assigned to, and Determination</p></td>
<td><p>defender_alerts</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Delete Indicator (PB)</p></td>
<td><p>Remove an indicator from Defender ATP</p></td>
<td><p>defender_indicators</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Update Indicator (PB)</p></td>
<td><p>Modify an existing Defender indicator</p></td>
<td><p>defender_indicators</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is a IBM Supported provided App. Use the SOAR Community https://ibm.biz/soarcommunity for app assistance and IBM Support for issue tracking https://ibm.com/mysupport.</p>
</section>
</section>
<section id="template-appendix">
<h2>Template Appendix<a class="headerlink" href="#template-appendix" title="Link to this heading">¶</a></h2>
<details><summary>incident_creation_template</summary>
<pre>
{
  {# JINJA template for creating a new Resilient incident from a Defender incident. #}
  "name": "Defender Incident - {{ incidentName|replace('"', '\\"') }}",
  "discovered_date": {{ createdTime|resilient_datetimeformat }},
  "start_date": {{ createdTime|resilient_datetimeformat }},
  {# if Defender alert users are different than SOAR users, consider using a mapping table using resilient_substitute: #}
  {# "owner_id": "{{ assignedTo|resilient_substitute('{"Automation": "soar_user1@ent.com", "defender_user2@co.com": "soar_user2@ent.com", "DEFAULT": "default_user@ent.com" }') }}", #}
  "plan_status": "{{ status|resilient_substitute('{"Resolved": "C", "Active": "A", "New": "A"}') }}",
  "severity_code": "{{ severity|resilient_substitute('{"Informational": "Low"}') }}",
  "properties": {
    "defender_incident_id": {{ incidentId }},
    "defender_incident_url": "<a target='blank' href='{{ incidentUri }}'>Defender Incident</a>",
    "defender_classification": "{{ classification|replace('"', '\\"') }}",
    "defender_determination": "{{ determination|replace('"', '\\"') }}",
    "defender_incident_createtime": {{ createdTime|resilient_datetimeformat }},
    "defender_incident_lastupdatetime": {{ lastUpdateTime|resilient_datetimeformat }},
    "defender_tags": "{{ tags | join(',') }}"
  },
  "artifacts": [
    {% for alert in alerts %}
     {% for item in alert.entities %}
      {% if item.deviceId %}
        {% set machine_comment = 'Associated with machine id: ' + item.deviceId %}
      {% else %}
        {% set machine_comment = '' %}
      {% endif %}
      {% set artifactFlg = False %}
      {% if item.entityType == 'Ip' %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "IP Address"
        },
        "value": "{{ item.ipAddress }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      }
      {% elif item.entityType == 'User' and item.userPrincipalName %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "User Account"
        },
        "value": "{{ item.userPrincipalName }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      }
      {% elif item.entityType == 'Process' and item.processCommandLine %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "Process Name"
        },
        "value": "{{ item.processCommandLine[:100]|replace('\\', '\\\\')|replace('"', '\\"') }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      }
      {% elif item.entityType == 'Process' and not item.processCommandLine and item.fileName %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "File Name"
        },
        "value": "{{ item.fileName|replace('\\', '\\\\')|replace('"', '\\"') }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\nFile Path: {{ item.filePath|replace('\\', '\\\\')|replace('"', '\\"') }}\n{{ machine_comment }}"
        }
      }
      {% elif item.entityType == 'Url' and item.url %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "URL"
        },
        "value": "{{ item.url }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      }
      {% elif item.entityType == 'File' %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "File Name"
        },
        "value": "{{ item.fileName }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\nfile path: {{ item.filePath|replace('\\', '\\\\') }}\n{{ machine_comment }}"
        }
      }
      {% if item.sha1 %}
      ,{
        "type": {
          "name": "Malware SHA-1 Hash"
        },
        "value": "{{ item.sha1 }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\nfile name: {{ item.fileName }}\n{{ machine_comment }}"
        }
      }
      {% endif %}
      {% if item.sha256 %}
      ,{
        "type": {
          "name": "Malware SHA-256 Hash"
        },
        "value": "{{ item.sha256 }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\nfile name: {{ item.fileName }}\n{{ machine_comment }}"
        }
      }
      {% endif %}
      {% elif item.entityType == 'Registry' %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "Registry Key"
        },
        "value": "{{ item.registryHive|lower }}\\{{ item.registryKey|replace('\\', '\\\\') }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }} }}\n{{ machine_comment }}"
        },
        "properties":[
          {
            "name": "{{ item.registryKey|replace('\\', '\\\\') }}",
            "value": "{{ item.registryValue|replace('\\', '\\\\')|replace('"', '\\"') }}"
          }
        ]
      }
      {% elif item.entityType == 'MailMessage' %}
      {% set artifactFlg = True %}
      {
        "type": {
          "name": "Email Sender"
        },
        "value": "{{ item.sender|replace('"', '\\"') }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      },
      {
        "type": {
          "name": "Email Recipient"
        },
        "value": "{{ item.recipient|replace('"', '\\"') }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      },
      {
        "type": {
          "name": "Email Subject"
        },
        "value": "{{ item.subject|replace('"', '\\"') }}",
        "description": {
          "format": "text",
          "content": "creation date: {{ item.evidenceCreationTime }}\n{{ machine_comment }}"
        }
      }
      {% endif %}
      ,
     {% endfor %}
     {% if artifactFlg and not loop.last %},{% endif %}
    {% endfor %}
  ],
  "comments": [
    {% for comment in comments %}
      {% if "Created by IBM SOAR" not in comment.comment %}
      {
        "text": {
          "format": "text",
          "content": "Defender Incident comment: {{ comment.createdTime }}\n{{ comment.comment|replace("<br>", "\n")|replace('"', '\\"') }}"
        }
      }
      {% if not loop.last %},{% endif %}
      {% endif %}
    {% endfor %}
  ]
}
</pre>
</details>
<details><summary>incident_update_template</summary>
<pre>
{
  {# JINJA template for creating a new Resilient incident from a Defender incident. #}
  "name": "Defender Incident - {{ incidentName|replace('"', '\\"') }}",
  "description": {
    "format": "text",
    "content": "{{ description|replace('"', '\\"') }}"
  },
  {# if Defender users are different than SOAR users, consider using a mapping table using resilient_substitute: #}
  {# "owner_id": "{{ assignedTo|resilient_substitute('{"Automation": "soar_user1@ent.com", "defender_user2@co.com": "soar_user2@ent.com", "DEFAULT": "default_user@ent.com" }') }}", #}
  "plan_status": "{{ status|resilient_substitute('{"Resolved": "C", "Active": "A", "New": "A"}') }}",
  "severity_code": "{{ severity|resilient_substitute('{"Informational": "Low"}') }}",
  "properties": {
    "defender_classification": "{{ classification|replace('"', '\\"') }}",
    "defender_determination": "{{ determination|replace('"', '\\"') }}",
    "defender_tags": "{{ tags | join(',') }}"
  }
}
</pre>
</details>
<details><summary>incident_close_template</summary>
<pre>
{
  {# JINJA template for closing a new Resilient incident from a Defender alert. #}
  "plan_status": "C",
  "resolution_id": "Resolved",
  "resolution_summary": "Closed from Defender: {{ investigationState }}",
  "severity_code": "{{ severity|resilient_substitute('{"Informational": "Low"}') }}",
  "properties": {
    "defender_classification": "{{ classification|replace('"', '\\"') }}",
    "defender_determination": "{{ determination|replace('"', '\\"') }}"
  }
}
</pre>
</details>
<details><summary>defender_update_alert_template</summary>
<pre>
{
    {# JINJA template for updating a Defender alert #}
    "properties": {
        "severity": "{{ severity_code|string|resilient_substitute('{"4": "Low", "5": "Medium", "6": "High"}') }}",
        "status": "{{ status }}",
        "classification": "{{ classification }}",
        "determination": "{{ determination }}",
        "assignedTo": "{{ assignedTo }}",
        "comment": "{{ comment }}"
    }
}
</pre>
</details>
<details><summary>defender_update_incident_template</summary>
<pre>
{
    {# JINJA template for updating a Defender incident from a Resilient incident. #}
    {% if defender_incident_status %}
      "status": "{{ defender_incident_status }}"
    {% endif %}
    {% if defender_classification %}
        ,"classification": "{{ defender_classification }}"
    {% endif %}
    {# "determine" is set only when classification is TruePositive. Change as necessary #}
    {% if defender_classification == "TruePositive" %}
      {% if defender_determination %}
        ,"determination": "{{ defender_determination }}"
      {% endif %}
    {% endif %}
    {% if defender_tags %}
        {% set tag_list = defender_tags.split(',') %}
        ,"tags": {{ tag_list| tojson }}
    {% endif %}
    {% if defender_comment %}
        ,"comment": "Created by IBM SOAR<br>{{ defender_comment|striptags|safe }}"
    {% endif %}
}
</pre>
</details></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_microsoft_security_graph/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Microsoft Security Graph</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_mcafee_tie/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">McAfee TIE</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Microsoft Defender</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li><a class="reference internal" href="#changes">1.2.0 Changes</a></li>
<li><a class="reference internal" href="#v1-1-considerations">V1.1 Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-section-app-configuration-for-the-new-app-config-setting-alert-filters-this-setting-must-be-manually-added-to-your-app-config-file-in-order-to-use-it-with-the-poller-to-filter-incident-creation">See section <span class="xref myst">App Configuration</span> for the new app.config setting: <code class="docutils literal notranslate"><span class="pre">alert_filters</span></code>. This setting must be manually added to your app.config file in order to use it with the poller to filter incident creation.</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#resilient-platform">Resilient platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
<li><a class="reference internal" href="#azure-app-configuration">Azure App Configuration</a></li>
<li><a class="reference internal" href="#template-files">Template files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-defender-update-incident">Function - Defender Update Incident</a></li>
<li><a class="reference internal" href="#function-defender-app-execution">Function - Defender App Execution</a></li>
<li><a class="reference internal" href="#function-defender-find-machines-by-file">Function - Defender Find Machines by File</a></li>
<li><a class="reference internal" href="#function-defender-machine-vulnerabilities">Function - Defender Machine Vulnerabilities</a></li>
<li><a class="reference internal" href="#function-defender-machine-isolation">Function - Defender Machine Isolation</a></li>
<li><a class="reference internal" href="#function-defender-alert-search">Function - Defender Alert Search</a></li>
<li><a class="reference internal" href="#function-defender-list-indicators">Function - Defender List Indicators</a></li>
<li><a class="reference internal" href="#function-defender-quarantine-file">Function - Defender Quarantine File</a></li>
<li><a class="reference internal" href="#function-defender-get-related-alert-information">Function - Defender Get Related Alert Information</a></li>
<li><a class="reference internal" href="#function-defender-machine-scan">Function - Defender Machine Scan</a></li>
<li><a class="reference internal" href="#function-defender-set-indicator">Function - Defender Set Indicator</a></li>
<li><a class="reference internal" href="#function-defender-get-file-information">Function - Defender Get File Information</a></li>
<li><a class="reference internal" href="#function-defender-find-machines-by-filter">Function - Defender Find Machines by filter</a></li>
<li><a class="reference internal" href="#function-defender-delete-indicator">Function - Defender Delete Indicator</a></li>
<li><a class="reference internal" href="#function-defender-get-incident">Function - Defender Get Incident</a></li>
<li><a class="reference internal" href="#function-defender-find-machines-by-internal-ip">Function - Defender Find Machines by Internal IP</a></li>
<li><a class="reference internal" href="#function-defender-update-alert">Function - Defender Update Alert</a></li>
<li><a class="reference internal" href="#function-defender-collect-machine-investigation-package">Function - Defender Collect Machine Investigation Package</a></li>
<li><a class="reference internal" href="#script-create-artifact-from-indicator">Script - Create Artifact from Indicator</a></li>
<li><a class="reference internal" href="#data-table-defender-machines">Data Table - Defender Machines</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-defender-alerts">Data Table - Defender Alerts</a><ul>
<li><a class="reference internal" href="#id1">API Name:</a></li>
<li><a class="reference internal" href="#id2">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-defender-indicators">Data Table - Defender Indicators</a><ul>
<li><a class="reference internal" href="#id3">API Name:</a></li>
<li><a class="reference internal" href="#id4">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#template-appendix">Template Appendix</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>