<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: MXToolbox MX query

## Function - MXToolbox

### API Name
`fn_mxtoolbox`

### Output Name
``

### Message Destination
`fn_mxtoolbox`

### Pre-Processing Script
```python
inputs.mx_argument = artifact.value
inputs.mx_param1 = None
```

### Post-Processing Script
```python
# Put the ReportingNameServer in a note
content = u'MxToolbox MX Query Result: Reporting Name Server: {}\n'.format(results['value']['ReportingNameServer'])
note = helper.createPlainText(content)
incident.addNote(note)

# Create artifacts for each IP Address
for info in results['value']['Information']:
  incident.addArtifact('IP Address', info['IP Address'], info['Hostname'])


#{
#   "UID": null,
#   "Command": "mx",
#   "IsTransitioned": false,
#   "CommandArgument": "gmail.com",
#   "TimeRecorded": "2018-10-31T07:29:35.3342201-05:00",
#   "ReportingNameServer": "ns1.google.com",
#   "TimeToComplete": "377",
#   "RelatedIP": null,
#   "IsEndpoint": false,
#   "HasSubscriptions": false,
#   "Failed": [],
#   "Warnings": [],
#   "Passed": [
#     {
#       "ID": 441,
#       "Name": "DMARC Record Published",
#       "Info": "DMARC Record found",
#       "Url": "https://lookup.mxtoolbox.com/Problem/mx/DMARC-Record-Published?page=prob_mx&showlogin=1&hidetoc=1&action=mx:gmail.com",
#       "PublicDescription": null,
#       "IsExcludedByUser": false
#     },
#     {
#       "ID": 506,
#       "Name": "DNS Record Published",
#       "Info": "DNS Record found",
#       "Url": "https://lookup.mxtoolbox.com/Problem/mx/DNS-Record-Published?page=prob_mx&showlogin=1&hidetoc=1&action=mx:gmail.com",
#       "PublicDescription": null,
#       "IsExcludedByUser": false
#     }
#   ],
#   "Timeouts": [],
#   "Errors": [],
#   "Information": [
#     {
#       "Pref": "5",
#       "Hostname": "gmail-smtp-in.l.google.com",
#       "IP Address": "173.194.205.27",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "5",
#       "Hostname": "gmail-smtp-in.l.google.com",
#       "IP Address": "2607:f8b0:400d:c02::1b",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "10",
#       "Hostname": "alt1.gmail-smtp-in.l.google.com",
#       "IP Address": "64.233.190.27",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "10",
#       "Hostname": "alt1.gmail-smtp-in.l.google.com",
#       "IP Address": "2800:3f0:4003:c01::1a",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "20",
#       "Hostname": "alt2.gmail-smtp-in.l.google.com",
#       "IP Address": "74.125.193.27",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "20",
#       "Hostname": "alt2.gmail-smtp-in.l.google.com",
#       "IP Address": "2a00:1450:400b:c01::1a",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "30",
#       "Hostname": "alt3.gmail-smtp-in.l.google.com",
#       "IP Address": "66.102.1.27",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "30",
#       "Hostname": "alt3.gmail-smtp-in.l.google.com",
#       "IP Address": "2a00:1450:400c:c06::1a",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "40",
#       "Hostname": "alt4.gmail-smtp-in.l.google.com",
#       "IP Address": "74.125.128.27",
#       "TTL": "60 min"
#     },
#     {
#       "Pref": "40",
#       "Hostname": "alt4.gmail-smtp-in.l.google.com",
#       "IP Address": "2a00:1450:4013:c02::1a",
#       "TTL": "60 min"
#     }
#   ],
#   "MultiInformation": [],
#   "IsBruteForce": false,
#   "Transcript": [
#     {
#       "TimeStamp": "\r\nLookupServerv2 377ms\r\n",
#       "Depth": "1",
#       "ServerName": "m.gtld-servers.net",
#       "ServerIP": "192.55.83.30",
#       "Authoritative": "NON-AUTH",
#       "ElapsedTime": "62 ms",
#       "Result": "Received 4 Referrals , rcode=NO_ERROR",
#       "Question": "",
#       "Answers": "gmail.com.\t172800\tIN\tNS\tns2.google.com,gmail.com.\t172800\tIN\tNS\tns1.google.com,gmail.com.\t172800\tIN\tNS\tns3.google.com,gmail.com.\t172800\tIN\tNS\tns4.google.com,"
#     },
#     {
#       "TimeStamp": "",
#       "Depth": "2",
#       "ServerName": "ns1.google.com",
#       "ServerIP": "216.239.32.10",
#       "Authoritative": "AUTH",
#       "ElapsedTime": "15 ms",
#       "Result": "Received 5 Answers , rcode=NO_ERROR",
#       "Question": "",
#       "Answers": "gmail.com.\t3600\tIN\tMX\t20 alt2.gmail-smtp-in.l.google.com,gmail.com.\t3600\tIN\tMX\t40 alt4.gmail-smtp-in.l.google.com,gmail.com.\t3600\tIN\tMX\t10 alt1.gmail-smtp-in.l.google.com,gmail.com.\t3600\tIN\tMX\t30 alt3.gmail-smtp-in.l.google.com,gmail.com.\t3600\tIN\tMX\t5 gmail-smtp-in.l.google.com,"
#     }
#   ],
#   "MxRep": 0,
#   "EmailServiceProvider": "Google",
#   "DnsServiceProvider": null,
#   "RelatedLookups": [
#     {
#       "Name": "dns lookup",
#       "URL": "https://lookup.mxtoolbox.com/api/v1/lookup/a/gmail.com",
#       "Command": "a",
#       "CommandArgument": "gmail.com"
#     },
#     {
#       "Name": "dns check",
#       "URL": "https://lookup.mxtoolbox.com/api/v1/lookup/dns/gmail.com",
#       "Command": "dns",
#       "CommandArgument": "gmail.com"
#     },
#     {
#       "Name": "spf lookup",
#       "URL": "https://lookup.mxtoolbox.com/api/v1/lookup/spf/gmail.com",
#       "Command": "spf",
#       "CommandArgument": "gmail.com"
#     },
#     {
#       "Name": "dns propagation",
#       "URL": "https://lookup.mxtoolbox.com/api/v1/lookup/mx/gmail.com:all",
#       "Command": "mx",
#       "CommandArgument": "gmail.com:all"
#     }
#   ]
# }
```

---

