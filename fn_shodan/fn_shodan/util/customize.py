# (c) Copyright IBM Corp. 2010, 2020. All Rights Reserved.
# -*- coding: utf-8 -*-

"""Generate the Resilient customizations required for fn_shodan"""

try:
    from resilient import ImportDefinition
except ImportError:
    # Support Apps running on resilient-circuits < v35.0.195
    from resilient_circuits.util import ImportDefinition


def codegen_reload_data():
    """
    Parameters required reload codegen for the fn_shodan package
    """
    return {
        "package": u"fn_shodan",
        "message_destinations": [u"fn_shodan"],
        "functions": [u"shodan_lookup"],
        "workflows": [u"example_shodan_host_lookup"],
        "actions": [u"Example: Shodan Host Lookup"],
        "incident_fields": [],
        "incident_artifact_types": [],
        "datatables": [],
        "automatic_tasks": [],
        "scripts": []
    }


def customization_data(client=None):
    """
    Returns a Generator of ImportDefinitions (Customizations).
    Install them using `resilient-circuits customize`

    Contents:
    - Message Destinations:
        - fn_shodan
    - Functions:
        - shodan_lookup
    - Workflows:
        - example_shodan_host_lookup
    - Rules:
        - Example: Shodan Host Lookup
    """

    yield ImportDefinition(u"""
eyJhY3Rpb25fb3JkZXIiOiBbXSwgImFjdGlvbnMiOiBbeyJhdXRvbWF0aW9ucyI6IFtdLCAiY29u
ZGl0aW9ucyI6IFt7ImV2YWx1YXRpb25faWQiOiBudWxsLCAiZmllbGRfbmFtZSI6ICJhcnRpZmFj
dC50eXBlIiwgIm1ldGhvZCI6ICJlcXVhbHMiLCAidHlwZSI6IG51bGwsICJ2YWx1ZSI6ICJJUCBB
ZGRyZXNzIn1dLCAiZW5hYmxlZCI6IHRydWUsICJleHBvcnRfa2V5IjogIkV4YW1wbGU6IFNob2Rh
biBIb3N0IExvb2t1cCIsICJpZCI6IDYzLCAibG9naWNfdHlwZSI6ICJhbGwiLCAibWVzc2FnZV9k
ZXN0aW5hdGlvbnMiOiBbXSwgIm5hbWUiOiAiRXhhbXBsZTogU2hvZGFuIEhvc3QgTG9va3VwIiwg
Im9iamVjdF90eXBlIjogImFydGlmYWN0IiwgInRhZ3MiOiBbXSwgInRpbWVvdXRfc2Vjb25kcyI6
IDg2NDAwLCAidHlwZSI6IDEsICJ1dWlkIjogIjIxYTRiOWZlLWZlOTItNDQyNi1iMzlkLTliOTA0
MzM3ODQzYiIsICJ2aWV3X2l0ZW1zIjogW10sICJ3b3JrZmxvd3MiOiBbImV4YW1wbGVfc2hvZGFu
X2hvc3RfbG9va3VwIl19XSwgImFwcHMiOiBbXSwgImF1dG9tYXRpY190YXNrcyI6IFtdLCAiZXhw
b3J0X2RhdGUiOiAxNTk5NDg0Mjk5NjcxLCAiZXhwb3J0X2Zvcm1hdF92ZXJzaW9uIjogMiwgImZp
ZWxkcyI6IFt7ImFsbG93X2RlZmF1bHRfdmFsdWUiOiBmYWxzZSwgImJsYW5rX29wdGlvbiI6IGZh
bHNlLCAiY2FsY3VsYXRlZCI6IGZhbHNlLCAiY2hhbmdlYWJsZSI6IHRydWUsICJjaG9zZW4iOiBm
YWxzZSwgImRlZmF1bHRfY2hvc2VuX2J5X3NlcnZlciI6IGZhbHNlLCAiZGVwcmVjYXRlZCI6IGZh
bHNlLCAiZXhwb3J0X2tleSI6ICJfX2Z1bmN0aW9uL3Nob2Rhbl9sb29rdXBob3N0IiwgImhpZGVf
bm90aWZpY2F0aW9uIjogZmFsc2UsICJpZCI6IDI4MiwgImlucHV0X3R5cGUiOiAidGV4dCIsICJp
bnRlcm5hbCI6IGZhbHNlLCAiaXNfdHJhY2tlZCI6IGZhbHNlLCAibmFtZSI6ICJzaG9kYW5fbG9v
a3VwaG9zdCIsICJvcGVyYXRpb25fcGVybXMiOiB7fSwgIm9wZXJhdGlvbnMiOiBbXSwgInBsYWNl
aG9sZGVyIjogIiIsICJwcmVmaXgiOiBudWxsLCAicmVhZF9vbmx5IjogZmFsc2UsICJyaWNoX3Rl
eHQiOiBmYWxzZSwgInRhZ3MiOiBbXSwgInRlbXBsYXRlcyI6IFtdLCAidGV4dCI6ICJzaG9kYW5f
bG9va3VwaG9zdCIsICJ0b29sdGlwIjogIiIsICJ0eXBlX2lkIjogMTEsICJ1dWlkIjogIjdiZDE1
MzRmLWU1ZGMtNGYwNS05MTc4LWE1ZWE0NjlhYmM1YiIsICJ2YWx1ZXMiOiBbXX0sIHsiZXhwb3J0
X2tleSI6ICJpbmNpZGVudC9pbnRlcm5hbF9jdXN0b21pemF0aW9uc19maWVsZCIsICJpZCI6IDAs
ICJpbnB1dF90eXBlIjogInRleHQiLCAiaW50ZXJuYWwiOiB0cnVlLCAibmFtZSI6ICJpbnRlcm5h
bF9jdXN0b21pemF0aW9uc19maWVsZCIsICJyZWFkX29ubHkiOiB0cnVlLCAidGV4dCI6ICJDdXN0
b21pemF0aW9ucyBGaWVsZCAoaW50ZXJuYWwpIiwgInR5cGVfaWQiOiAwLCAidXVpZCI6ICJiZmVl
YzJkNC0zNzcwLTExZTgtYWQzOS00YTAwMDQwNDRhYTEifV0sICJmdW5jdGlvbnMiOiBbeyJjcmVh
dG9yIjogeyJkaXNwbGF5X25hbWUiOiAiTG9jYWwgSW50ZWdyYXRpb24gU2VydmVyIiwgImlkIjog
NCwgIm5hbWUiOiAiYWQyNjFjMWYtZjFjYy00MTE1LWJiY2UtYTE1MWY4OGJhYzVlIiwgInR5cGUi
OiAiYXBpa2V5In0sICJkZXNjcmlwdGlvbiI6IHsiZm9ybWF0IjogInRleHQiLCAiY29udGVudCI6
ICJGdW5jdGlvbiB0byBsb29rIHVwIGFuIElQIEFkZHJlc3MgaW4gU2hvZGFuIn0sICJkZXN0aW5h
dGlvbl9oYW5kbGUiOiAiZm5fc2hvZGFuIiwgImRpc3BsYXlfbmFtZSI6ICJTaG9kYW4gTG9va3Vw
IiwgImV4cG9ydF9rZXkiOiAic2hvZGFuX2xvb2t1cCIsICJpZCI6IDMyLCAibGFzdF9tb2RpZmll
ZF9ieSI6IHsiZGlzcGxheV9uYW1lIjogIkFkbWluIFVzZXIiLCAiaWQiOiAxLCAibmFtZSI6ICJh
ZG1pbkBleGFtcGxlLmNvbSIsICJ0eXBlIjogInVzZXIifSwgImxhc3RfbW9kaWZpZWRfdGltZSI6
IDE1OTk0ODQyNjY1NTYsICJuYW1lIjogInNob2Rhbl9sb29rdXAiLCAidGFncyI6IFtdLCAidXVp
ZCI6ICI1OTM1ZWQ2OC1iZGJlLTQ3NDQtYTlhNy0wNDVjNzg5YTc2NTciLCAidmVyc2lvbiI6IDMs
ICJ2aWV3X2l0ZW1zIjogW3siY29udGVudCI6ICI3YmQxNTM0Zi1lNWRjLTRmMDUtOTE3OC1hNWVh
NDY5YWJjNWIiLCAiZWxlbWVudCI6ICJmaWVsZF91dWlkIiwgImZpZWxkX3R5cGUiOiAiX19mdW5j
dGlvbiIsICJzaG93X2lmIjogbnVsbCwgInNob3dfbGlua19oZWFkZXIiOiBmYWxzZSwgInN0ZXBf
bGFiZWwiOiBudWxsfV0sICJ3b3JrZmxvd3MiOiBbeyJhY3Rpb25zIjogW10sICJkZXNjcmlwdGlv
biI6IG51bGwsICJuYW1lIjogIkV4YW1wbGU6IFNob2RhbiBIb3N0IExvb2t1cCIsICJvYmplY3Rf
dHlwZSI6ICJhcnRpZmFjdCIsICJwcm9ncmFtbWF0aWNfbmFtZSI6ICJleGFtcGxlX3Nob2Rhbl9o
b3N0X2xvb2t1cCIsICJ0YWdzIjogW10sICJ1dWlkIjogbnVsbCwgIndvcmtmbG93X2lkIjogNDV9
XX1dLCAiZ2VvcyI6IG51bGwsICJncm91cHMiOiBudWxsLCAiaWQiOiA1LCAiaW5ib3VuZF9tYWls
Ym94ZXMiOiBudWxsLCAiaW5jaWRlbnRfYXJ0aWZhY3RfdHlwZXMiOiBbXSwgImluY2lkZW50X3R5
cGVzIjogW3sidXBkYXRlX2RhdGUiOiAxNTk5NDg0Mjk3OTczLCAiY3JlYXRlX2RhdGUiOiAxNTk5
NDg0Mjk3OTczLCAidXVpZCI6ICJiZmVlYzJkNC0zNzcwLTExZTgtYWQzOS00YTAwMDQwNDRhYTAi
LCAiZGVzY3JpcHRpb24iOiAiQ3VzdG9taXphdGlvbiBQYWNrYWdlcyAoaW50ZXJuYWwpIiwgImV4
cG9ydF9rZXkiOiAiQ3VzdG9taXphdGlvbiBQYWNrYWdlcyAoaW50ZXJuYWwpIiwgIm5hbWUiOiAi
Q3VzdG9taXphdGlvbiBQYWNrYWdlcyAoaW50ZXJuYWwpIiwgImVuYWJsZWQiOiBmYWxzZSwgInN5
c3RlbSI6IGZhbHNlLCAicGFyZW50X2lkIjogbnVsbCwgImhpZGRlbiI6IGZhbHNlLCAiaWQiOiAw
fV0sICJpbmR1c3RyaWVzIjogbnVsbCwgImxheW91dHMiOiBbXSwgImxvY2FsZSI6IG51bGwsICJt
ZXNzYWdlX2Rlc3RpbmF0aW9ucyI6IFt7ImFwaV9rZXlzIjogWyJhZDI2MWMxZi1mMWNjLTQxMTUt
YmJjZS1hMTUxZjg4YmFjNWUiXSwgImRlc3RpbmF0aW9uX3R5cGUiOiAwLCAiZXhwZWN0X2FjayI6
IHRydWUsICJleHBvcnRfa2V5IjogImZuX3Nob2RhbiIsICJuYW1lIjogImZuX3Nob2RhbiIsICJw
cm9ncmFtbWF0aWNfbmFtZSI6ICJmbl9zaG9kYW4iLCAidGFncyI6IFtdLCAidXNlcnMiOiBbXSwg
InV1aWQiOiAiZjBkODQxYWItMjYwOC00Nzk0LWFmYTMtMzk5NTI3MjgyMzM1In1dLCAibm90aWZp
Y2F0aW9ucyI6IG51bGwsICJvdmVycmlkZXMiOiBbXSwgInBoYXNlcyI6IFtdLCAicmVndWxhdG9y
cyI6IG51bGwsICJyb2xlcyI6IFtdLCAic2NyaXB0cyI6IFtdLCAic2VydmVyX3ZlcnNpb24iOiB7
ImJ1aWxkX251bWJlciI6IDM4LCAibWFqb3IiOiAzNywgIm1pbm9yIjogMiwgInZlcnNpb24iOiAi
MzcuMi4zOCJ9LCAidGFncyI6IFtdLCAidGFza19vcmRlciI6IFtdLCAidGltZWZyYW1lcyI6IG51
bGwsICJ0eXBlcyI6IFtdLCAid29ya2Zsb3dzIjogW3siYWN0aW9ucyI6IFtdLCAiY29udGVudCI6
IHsidmVyc2lvbiI6IDIsICJ3b3JrZmxvd19pZCI6ICJleGFtcGxlX3Nob2Rhbl9ob3N0X2xvb2t1
cCIsICJ4bWwiOiAiPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIj8+PGRl
ZmluaXRpb25zIHhtbG5zPVwiaHR0cDovL3d3dy5vbWcub3JnL3NwZWMvQlBNTi8yMDEwMDUyNC9N
T0RFTFwiIHhtbG5zOmJwbW5kaT1cImh0dHA6Ly93d3cub21nLm9yZy9zcGVjL0JQTU4vMjAxMDA1
MjQvRElcIiB4bWxuczpvbWdkYz1cImh0dHA6Ly93d3cub21nLm9yZy9zcGVjL0RELzIwMTAwNTI0
L0RDXCIgeG1sbnM6b21nZGk9XCJodHRwOi8vd3d3Lm9tZy5vcmcvc3BlYy9ERC8yMDEwMDUyNC9E
SVwiIHhtbG5zOnJlc2lsaWVudD1cImh0dHA6Ly9yZXNpbGllbnQuaWJtLmNvbS9icG1uXCIgeG1s
bnM6eHNkPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWFcIiB4bWxuczp4c2k9XCJo
dHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwiIHRhcmdldE5hbWVzcGFj
ZT1cImh0dHA6Ly93d3cuY2FtdW5kYS5vcmcvdGVzdFwiPjxwcm9jZXNzIGlkPVwiZXhhbXBsZV9z
aG9kYW5faG9zdF9sb29rdXBcIiBpc0V4ZWN1dGFibGU9XCJ0cnVlXCIgbmFtZT1cIkV4YW1wbGU6
IFNob2RhbiBIb3N0IExvb2t1cFwiPjxkb2N1bWVudGF0aW9uPkFuIGV4YW1wbGUgd29ya2Zsb3cg
dG8gbG9vayB1cCBhbmQgSVAgQWRkcmVzcyBpbiBTaG9kYW4uIEFkZHMgYSBOb3RlIHdpdGggdGhl
IHJlc3VsdDwvZG9jdW1lbnRhdGlvbj48c3RhcnRFdmVudCBpZD1cIlN0YXJ0RXZlbnRfMTU1YXN4
bVwiPjxvdXRnb2luZz5TZXF1ZW5jZUZsb3dfMXAxOTgybzwvb3V0Z29pbmc+PC9zdGFydEV2ZW50
PjxlbmRFdmVudCBpZD1cIkVuZEV2ZW50XzB5ZHFrdG9cIj48aW5jb21pbmc+U2VxdWVuY2VGbG93
XzBoN3hjZHI8L2luY29taW5nPjwvZW5kRXZlbnQ+PHNlcXVlbmNlRmxvdyBpZD1cIlNlcXVlbmNl
Rmxvd18xcDE5ODJvXCIgc291cmNlUmVmPVwiU3RhcnRFdmVudF8xNTVhc3htXCIgdGFyZ2V0UmVm
PVwiU2VydmljZVRhc2tfMWFwY3B4OFwiLz48c2VydmljZVRhc2sgaWQ9XCJTZXJ2aWNlVGFza18x
YXBjcHg4XCIgbmFtZT1cIlNob2RhbiBMb29rdXBcIiByZXNpbGllbnQ6dHlwZT1cImZ1bmN0aW9u
XCI+PGV4dGVuc2lvbkVsZW1lbnRzPjxyZXNpbGllbnQ6ZnVuY3Rpb24gdXVpZD1cIjU5MzVlZDY4
LWJkYmUtNDc0NC1hOWE3LTA0NWM3ODlhNzY1N1wiPntcImlucHV0c1wiOnt9LFwicHJlX3Byb2Nl
c3Npbmdfc2NyaXB0XCI6XCJpbnB1dHMuc2hvZGFuX2xvb2t1cGhvc3QgPSBhcnRpZmFjdC52YWx1
ZVwifTwvcmVzaWxpZW50OmZ1bmN0aW9uPjwvZXh0ZW5zaW9uRWxlbWVudHM+PGluY29taW5nPlNl
cXVlbmNlRmxvd18xcDE5ODJvPC9pbmNvbWluZz48b3V0Z29pbmc+U2VxdWVuY2VGbG93XzBoN3hj
ZHI8L291dGdvaW5nPjwvc2VydmljZVRhc2s+PHNlcXVlbmNlRmxvdyBpZD1cIlNlcXVlbmNlRmxv
d18waDd4Y2RyXCIgc291cmNlUmVmPVwiU2VydmljZVRhc2tfMWFwY3B4OFwiIHRhcmdldFJlZj1c
IkVuZEV2ZW50XzB5ZHFrdG9cIi8+PC9wcm9jZXNzPjxicG1uZGk6QlBNTkRpYWdyYW0gaWQ9XCJC
UE1ORGlhZ3JhbV8xXCI+PGJwbW5kaTpCUE1OUGxhbmUgYnBtbkVsZW1lbnQ9XCJ1bmRlZmluZWRc
IiBpZD1cIkJQTU5QbGFuZV8xXCI+PGJwbW5kaTpCUE1OU2hhcGUgYnBtbkVsZW1lbnQ9XCJTdGFy
dEV2ZW50XzE1NWFzeG1cIiBpZD1cIlN0YXJ0RXZlbnRfMTU1YXN4bV9kaVwiPjxvbWdkYzpCb3Vu
ZHMgaGVpZ2h0PVwiMzZcIiB3aWR0aD1cIjM2XCIgeD1cIjM5NlwiIHk9XCIxMjFcIi8+PGJwbW5k
aTpCUE1OTGFiZWw+PG9tZ2RjOkJvdW5kcyBoZWlnaHQ9XCIwXCIgd2lkdGg9XCI5MFwiIHg9XCIz
OTFcIiB5PVwiMTU2XCIvPjwvYnBtbmRpOkJQTU5MYWJlbD48L2JwbW5kaTpCUE1OU2hhcGU+PGJw
bW5kaTpCUE1OU2hhcGUgYnBtbkVsZW1lbnQ9XCJFbmRFdmVudF8weWRxa3RvXCIgaWQ9XCJFbmRF
dmVudF8weWRxa3RvX2RpXCI+PG9tZ2RjOkJvdW5kcyBoZWlnaHQ9XCIzNlwiIHdpZHRoPVwiMzZc
IiB4PVwiOTExXCIgeT1cIjEyMVwiLz48YnBtbmRpOkJQTU5MYWJlbD48b21nZGM6Qm91bmRzIGhl
aWdodD1cIjEzXCIgd2lkdGg9XCIwXCIgeD1cIjkyOVwiIHk9XCIxNjBcIi8+PC9icG1uZGk6QlBN
TkxhYmVsPjwvYnBtbmRpOkJQTU5TaGFwZT48YnBtbmRpOkJQTU5FZGdlIGJwbW5FbGVtZW50PVwi
U2VxdWVuY2VGbG93XzFwMTk4Mm9cIiBpZD1cIlNlcXVlbmNlRmxvd18xcDE5ODJvX2RpXCI+PG9t
Z2RpOndheXBvaW50IHg9XCI0MzJcIiB4c2k6dHlwZT1cIm9tZ2RjOlBvaW50XCIgeT1cIjEzOVwi
Lz48b21nZGk6d2F5cG9pbnQgeD1cIjYxMVwiIHhzaTp0eXBlPVwib21nZGM6UG9pbnRcIiB5PVwi
MTM5XCIvPjxicG1uZGk6QlBNTkxhYmVsPjxvbWdkYzpCb3VuZHMgaGVpZ2h0PVwiMTNcIiB3aWR0
aD1cIjBcIiB4PVwiNTIxLjVcIiB5PVwiMTE3LjVcIi8+PC9icG1uZGk6QlBNTkxhYmVsPjwvYnBt
bmRpOkJQTU5FZGdlPjxicG1uZGk6QlBNTlNoYXBlIGJwbW5FbGVtZW50PVwiU2VydmljZVRhc2tf
MWFwY3B4OFwiIGlkPVwiU2VydmljZVRhc2tfMWFwY3B4OF9kaVwiPjxvbWdkYzpCb3VuZHMgaGVp
Z2h0PVwiODBcIiB3aWR0aD1cIjEwMFwiIHg9XCI2MTFcIiB5PVwiOTlcIi8+PC9icG1uZGk6QlBN
TlNoYXBlPjxicG1uZGk6QlBNTkVkZ2UgYnBtbkVsZW1lbnQ9XCJTZXF1ZW5jZUZsb3dfMGg3eGNk
clwiIGlkPVwiU2VxdWVuY2VGbG93XzBoN3hjZHJfZGlcIj48b21nZGk6d2F5cG9pbnQgeD1cIjcx
MVwiIHhzaTp0eXBlPVwib21nZGM6UG9pbnRcIiB5PVwiMTM5XCIvPjxvbWdkaTp3YXlwb2ludCB4
PVwiOTExXCIgeHNpOnR5cGU9XCJvbWdkYzpQb2ludFwiIHk9XCIxMzlcIi8+PGJwbW5kaTpCUE1O
TGFiZWw+PG9tZ2RjOkJvdW5kcyBoZWlnaHQ9XCIxM1wiIHdpZHRoPVwiMFwiIHg9XCI4MTFcIiB5
PVwiMTE3XCIvPjwvYnBtbmRpOkJQTU5MYWJlbD48L2JwbW5kaTpCUE1ORWRnZT48L2JwbW5kaTpC
UE1OUGxhbmU+PC9icG1uZGk6QlBNTkRpYWdyYW0+PC9kZWZpbml0aW9ucz4ifSwgImNvbnRlbnRf
dmVyc2lvbiI6IDIsICJjcmVhdG9yX2lkIjogImFkbWluQGV4YW1wbGUuY29tIiwgImRlc2NyaXB0
aW9uIjogIkFuIGV4YW1wbGUgd29ya2Zsb3cgdG8gbG9vayB1cCBhbmQgSVAgQWRkcmVzcyBpbiBT
aG9kYW4uIEFkZHMgYSBOb3RlIHdpdGggdGhlIHJlc3VsdCIsICJleHBvcnRfa2V5IjogImV4YW1w
bGVfc2hvZGFuX2hvc3RfbG9va3VwIiwgImxhc3RfbW9kaWZpZWRfYnkiOiAiYWRtaW5AZXhhbXBs
ZS5jb20iLCAibGFzdF9tb2RpZmllZF90aW1lIjogMTU5OTQ4MzI2MTgyNiwgIm5hbWUiOiAiRXhh
bXBsZTogU2hvZGFuIEhvc3QgTG9va3VwIiwgIm9iamVjdF90eXBlIjogImFydGlmYWN0IiwgInBy
b2dyYW1tYXRpY19uYW1lIjogImV4YW1wbGVfc2hvZGFuX2hvc3RfbG9va3VwIiwgInRhZ3MiOiBb
XSwgInV1aWQiOiAiY2Y3NTJkOGQtZTlmZS00NGIxLWEzOTUtZTc3ZDUzMDA1NGQ5IiwgIndvcmtm
bG93X2lkIjogNDV9XSwgIndvcmtzcGFjZXMiOiBbXX0=
""")
