<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v50.1.262
-->

# Playbook - Example: Proofpoint TAP - Aggregate Forensics by Campaign ID (PB)

### API Name
`example_proofpoint_tap__aggregate_forensics_by_campaign_id_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type in ['String', 'proofpoint_campaign_id']`

### Object Type
`artifact`

### Description
Returns aggregate forensics for an entire campaign based on the given campaign identifier. Results are saved in a note and attachment.


---
## Function - Proofpoint TAP Get Forensics

### API Name
`fn_pp_forensics`

### Output Name
`forensics_results`

### Message Destination
`fn_proofpoint_tap`

### Function-Input Script
```python
inputs.incident_id = incident.id
inputs.proofpoint_campaign_id = artifact.value
```

---

## Local script - ProofPoint TAP: Write Aggregate Forensics by Campaign ID Results 

### Description
Write the results of Aggregate Forensics by Campaign ID Results to a note.

### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
results = playbook.functions.results.forensics_results

# results is a Dictionary and reports is a List
if results is not None:
  noteText = "<b>Proofpoint TAP - Aggregate Forensics by Campaign ID Results:</b>"
  
  if results.get("success") is True:
    num_reports = results.get("num_reports", 0)
    
    noteText = u"""{}
    <br>Found {} {} with forensic evidence for artifact {}. {}""".format(
      noteText,
      num_reports,
      "report" if num_reports == 1 else "reports",
      artifact.value,
      "Results are saved in an attachment." if num_reports > 0 else "")
  
  elif results.get("success") is False and results.get("note_err_text", None) is not None:
    noteText = u"""{} 
    <br>No Forensics found for Campaign ID '{}'. 
    <br>Error: {}.""".format(noteText, artifact.value, results.get("note_err_text"))
  
  else:
    noteText = u"""{} <br>No Malicious Forensics found for Campaign ID '{}'.""".format(noteText, artifact.value)
  
  incident.addNote(helper.createRichText(noteText))
```

---

