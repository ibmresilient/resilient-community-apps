<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="AWS IAM" href="../fn_aws_iam/README.html" /><link rel="prev" title="Siemplify" href="../fn_siemplify/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>VMware Carbon Black Cloud - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">Remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fn_algosec/README.html">IBM SOAR integration for AlgoSec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">Anomali Staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration Application for IBM Resilient.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#table-of-contents">Table of Contents -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#about-this-package">About this package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#use-cases">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#resilient-configurations">Resilient Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#rules">Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#run-application">Run Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#application-usage-and-details">Application Usage and Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#guardium-4a-list-parameter-names-by-report-name">Guardium: 4A. List Parameter Names By Report Name :</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#guardium-4b-search-all-guardium-reports">Guardium: 4B. Search All Guardium Reports :</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">IBM SOAR LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">Phish Tank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sumo_logic/README.html">Sumo Logic Cloud SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">fn_whois_rdap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <!--
  This README.md is generated by running:
  "resilient-sdk docgen -p fn_vmware_cbc"

  This file was generated with resilient-sdk v52.0.0.0.927

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  All fields followed by "::CHANGE_ME::"" should be manually edited

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)

  NOTE: If your app is available in the container-format only, there is no need to mention the integration server in this readme.
-->
<section id="vmware-carbon-black-cloud">
<h1>VMware Carbon Black Cloud<a class="headerlink" href="#vmware-carbon-black-cloud" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#vmware-carbon-black-cloud"><span class="xref myst">VMware Carbon Black Cloud</span></a></p>
<ul>
<li><p><a class="reference internal" href="#table-of-contents"><span class="xref myst">Table of Contents</span></a></p></li>
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
<li><p><a class="reference internal" href="#vmware-carbon-black-cloud-development-version"><span class="xref myst">VMware Carbon Black Cloud Development Version</span></a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisites"><span class="xref myst">Prerequisites</span></a></p></li>
<li><p><a class="reference internal" href="#permissions"><span class="xref myst">Permissions</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><code class="xref myst docutils literal notranslate"></code></a></p></li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
<li><p><a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a></p>
<ul>
<li><p><a class="reference internal" href="#poller-templates-for-soar-cases"><span class="xref myst">Poller Templates for SOAR Cases</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alert-filtering"><span class="xref myst">Alert Filtering</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#similar-to-alert-search-criteria-a-search-alert-exclusions-filter-can-be-specified-for-each-polling_filter_criteria_123"><span class="xref myst">Similar to alert search “criteria”, a search alert “exclusions” filter can be specified for each polling_filter_criteria_(1,2,3).</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-get-alert-by-id"><span class="xref myst">Function - VMware CBC: Get Alert By ID</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-get-cbc-notes"><span class="xref myst">Function - VMware CBC: Get CBC Notes</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-get-device-by-id"><span class="xref myst">Function - VMware CBC: Get Device By ID</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-post-alert-workflow-data"><span class="xref myst">Function - VMware CBC: Post Alert Workflow Data</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-post-device-action"><span class="xref myst">Function - VMware CBC: Post Device Action</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-post-note-to-cbc-alert"><span class="xref myst">Function - VMware CBC: Post Note to CBC Alert</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-post-observations-detail-job"><span class="xref myst">Function - VMware CBC: Post Observations Detail Job</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-post-reputation-override"><span class="xref myst">Function - VMware CBC: Post Reputation Override</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-post-tags"><span class="xref myst">Function - VMware CBC: Post Tags</span></a></p></li>
<li><p><a class="reference internal" href="#function---vmware-cbc-kill-process"><span class="xref myst">Function - VMware: CBC Kill Process</span></a></p></li>
<li><p><a class="reference internal" href="#script---convert-json-to-rich-text-v13"><span class="xref myst">Script - Convert JSON to rich text v1.3</span></a></p></li>
<li><p><a class="reference internal" href="#script---vmware-cbc-populate-cbc-device-row-from-alert"><span class="xref myst">Script - VMware CBC: Populate CBC Device Row from Alert</span></a></p></li>
<li><p><a class="reference internal" href="#script---vmware-cbc-populate-cbc-device-row-from-device"><span class="xref myst">Script - VMware CBC: Populate CBC Device Row from Device</span></a></p></li>
<li><p><a class="reference internal" href="#script---vmware-cbc-populate-observations-data-table"><span class="xref myst">Script - VMware CBC: Populate Observations Data Table</span></a></p></li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts-1"><span class="xref myst">Custom Layouts</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---cbc-device"><span class="xref myst">Data Table - CBC Device</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#data-table---observations"><span class="xref myst">Data Table - Observations</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name-1"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns-1"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#data-table---processes"><span class="xref myst">Data Table - Processes</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name-2"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns-2"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#templates-for-soar-cases"><span class="xref myst">Templates for SOAR Cases</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar_create_casejinja"><span class="xref myst">soar_create_case.jinja</span></a></p></li>
<li><p><a class="reference internal" href="#soar_close_casejinja"><span class="xref myst">soar_close_case.jinja</span></a></p></li>
<li><p><a class="reference internal" href="#soar_update_casejinja"><span class="xref myst">soar_update_case.jinja</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p>
<ul>
<li><p><a class="reference internal" href="#for-support"><span class="xref myst">For Support</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<!--
  Specify all changes in this release. Do not remove the release
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0.0</p></td>
<td><p>06/2024</p></td>
<td><p>Initial Release</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<!--
  Provide a high-level description of the function itself and its remote software or application.
  The text below is parsed from the "description" and "long_description" attributes in the setup.py file
-->
<p><strong>IBM SOAR app bidirectional synchronization and functions for VMware Carbon Black Cloud</strong></p>
<p><img alt="screenshot: main" src="../_images/main76.png" /></p>
<p>Provide bidirectional synchronization and functions for VMware Carbon Black Cloud<br></p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<!--
  List the Key Features of the Integration
-->
<ul class="simple">
<li><p>Poll Carbon Black Cloud alerts and create and update the corresponding cases in SOAR</p></li>
<li><p>Set the Carbon Black Cloud alert workflow information (determination, status, closure reason) from the corresponding case in SOAR</p></li>
<li><p>Create artifacts from an alert in the corresponding case in SOAR</p></li>
<li><p>Synchronize notes between Carbon Black Cloud alert and corresponding SOAR case</p></li>
<li><p>View alert device details in the CBC Device data table</p></li>
<li><p>View alert proceses details in the Processes data table</p></li>
<li><p>Perform the following remediation task from the CBC Device data table:</p>
<ul>
<li><p>Quarantine ON/OFF</p></li>
<li><p>Bypass ON/OFF</p></li>
<li><p>Background Scan ON/OFF</p></li>
</ul>
</li>
<li><p>Post tags on the alert from SOAR</p></li>
<li><p>Write the alert and device full JSON data from Carbon Black Cloud to a note in SOAR</p></li>
<li><p>Kill a running process on the device from the Processes data table</p></li>
<li><p>Override the reputation of an application to approve or ban it for an organization from the Processes data table or a SHA256 artifact</p></li>
<li><p>Get alert observations from Carbon Black Cloud and write the JSON to a note in SOAR</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<!--
  List any Requirements
-->
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (also known as App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">50.0.9097</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">50.0.9097</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient-circuits&gt;=51.0.1.1.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Incidents</p></td>
<td><p>Read, Create</p></td>
</tr>
<tr class="row-odd"><td><p>Edit Incidents</p></td>
<td><p>Fields, Status</p></td>
</tr>
<tr class="row-even"><td><p>Layouts</p></td>
<td><p>Read, Edit</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= <code class="docutils literal notranslate"><span class="pre">1.10.15</span></code>.</p></li>
<li><p>Cloud Pak is configured with an Edge Gateway.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.9 and 3.11 are officially supported. When deployed as an app, the app runs on Python 3.11.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>resilient-circuits&gt;=51.0.1.1.0</p></li>
</ul>
</section>
<section id="vmware-carbon-black-cloud-development-version">
<h3>VMware Carbon Black Cloud Development Version<a class="headerlink" href="#vmware-carbon-black-cloud-development-version" title="Link to this heading">¶</a></h3>
<p>This app has been implemented using:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Product Name</p></th>
<th class="head"><p>Product Version</p></th>
<th class="head"><p>API URL</p></th>
<th class="head"><p>API Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VMware Carbon Black Cloud</p></td>
<td><p>NA</p></td>
<td><p>Alerts</p></td>
<td><p>v7</p></td>
</tr>
<tr class="row-odd"><td><p>VMware Carbon Black Cloud</p></td>
<td><p>NA</p></td>
<td><p>Devices</p></td>
<td><p>v6</p></td>
</tr>
<tr class="row-even"><td><p>VMware Carbon Black Cloud</p></td>
<td><p>NA</p></td>
<td><p>Observations</p></td>
<td><p>v2</p></td>
</tr>
<tr class="row-odd"><td><p>VMware Carbon Black Cloud</p></td>
<td><p>NA</p></td>
<td><p>Job Service</p></td>
<td><p>v1</p></td>
</tr>
<tr class="row-even"><td><p>VMware Carbon Black Cloud</p></td>
<td><p>NA</p></td>
<td><p>Live Response</p></td>
<td><p>v6</p></td>
</tr>
</tbody>
</table>
</div>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h4>
<!--
List any prerequisites that are needed to use with this endpoint solution. Remove any section that is unnecessary.
-->
<ul class="simple">
<li><p>A Carbon Black Cloud account with and API key and secret.</p></li>
</ul>
</section>
<section id="permissions">
<h4>Permissions<a class="headerlink" href="#permissions" title="Link to this heading">¶</a></h4>
<!--
List any user permissions that are needed to use this endpoint. For example, list the API key permissions.
-->
<p>The following Carbon Black Cloud Access Level API Key Permissions must be granted to run this SOAR app:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>org.alerts.tags</p></td>
<td><p>CREATE, READ, DELETE</p></td>
</tr>
<tr class="row-odd"><td><p>org.xdr.metadata</p></td>
<td><p>READ</p></td>
</tr>
<tr class="row-even"><td><p>org.alerts.notes</p></td>
<td><p>CREATE, READ, UPDATE, DELETE</p></td>
</tr>
<tr class="row-odd"><td><p>org.alerts</p></td>
<td><p>READ</p></td>
</tr>
<tr class="row-even"><td><p>org.alerts.close</p></td>
<td><p>EXECUTE</p></td>
</tr>
<tr class="row-odd"><td><p>org.mdr.threathunts</p></td>
<td><p>READ</p></td>
</tr>
<tr class="row-even"><td><p>org.reputations</p></td>
<td><p>CREATE</p></td>
</tr>
<tr class="row-odd"><td><p>org.liveresponse.session</p></td>
<td><p>CREATE, READ, DELETE</p></td>
</tr>
<tr class="row-even"><td><p>org.liveresponse.process</p></td>
<td><p>READ, DELETE, EXECUTE</p></td>
</tr>
<tr class="row-odd"><td><p>org.search.events</p></td>
<td><p>READ, CREATE</p></td>
</tr>
<tr class="row-even"><td><p>device</p></td>
<td><p>READ</p></td>
</tr>
<tr class="row-odd"><td><p>device.quarantine</p></td>
<td><p>EXECUTE</p></td>
</tr>
<tr class="row-even"><td><p>device.bypass</p></td>
<td><p>EXECUTE</p></td>
</tr>
<tr class="row-odd"><td><p>device.bg-scan</p></td>
<td><p>EXECUTE</p></td>
</tr>
<tr class="row-even"><td><p>jobs.status</p></td>
<td><p>READ</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<p>
Create a custom access levels by going to Settings->API Access and selecting the Access Levels tab and hit the Add Access Level.  Edit the Access Level as shown below.  Then create an API key/secret with the created custom access level.
<p><img alt="screenshot: fn-vmware-cbc-api-key-1 " src="../_images/fn-vmware-cbc-api-key-1.png" /></p>
<p><img alt="screenshot: fn-vmware-cbc-api-key-2 " src="../_images/fn-vmware-cbc-api-key-2.png" /></p>
<p><img alt="screenshot: fn-vmware-cbc-api-key-3 " src="../_images/fn-vmware-cbc-api-key-3.png" /></p>
<p><img alt="screenshot: fn-vmware-cbc-api-key-4 " src="../_images/fn-vmware-cbc-api-key-4.png" /></p>
</section>
</section>
</section>
<section id="id1">
<h2><img alt="screenshot: fn-vmware-cbc-api-key-5 " src="../_images/fn-vmware-cbc-api-key-5.png" /><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>api_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xxx</span></code></p></td>
<td><p><em>VMware Carbon Black Cloud API ID.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>api_secret</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xxx</span></code></p></td>
<td><p><em>VMware Carbon Black Cloud API secret.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>hostname</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://xxx</span></code></p></td>
<td><p><em>VMware Carbon Black Cloud host name.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>org_key</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xxx</span></code></p></td>
<td><p><em>VMware Carbon Black Cloud organization key.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_filters_criteria_1</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(&quot;minimum_severity&quot;,3),(&quot;workflow_status&quot;,[&quot;OPEN&quot;,&quot;IN_PROGRESS&quot;,&quot;CLOSED&quot;])</span></code></p></td>
<td><p><em>First polling filter.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_filters_criteria_2</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(&quot;minimum_severity&quot;,4),(&quot;workflow_status&quot;,[&quot;OPEN&quot;,&quot;IN_PROGRESS&quot;,&quot;CLOSED&quot;])</span></code></p></td>
<td><p><em>Second polling filter.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_filters_criteria_3</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(&quot;minimum_severity&quot;,1),(&quot;workflow_status&quot;,[&quot;OPEN&quot;,&quot;IN_PROGRESS&quot;,&quot;CLOSED&quot;])</span></code></p></td>
<td><p>*Third polling filter.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_interval</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60</span></code></p></td>
<td><p><em>Poller interval time in seconds. Value of zero turns poller off.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_lookback</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">230400</span></code></p></td>
<td><p><em>Number of minutes to lookback for queries the first time the poller runs.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>soar_create_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/var/rescircuits/create_case.jinja</span></code></p></td>
<td><p><em>Path to override template for automatic case creation. See <a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a>.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>soar_update_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/var/rescircuits/update_case.jinja</span></code></p></td>
<td><p><em>Path to override template for automatic case updating. See <a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a>.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>soar_close_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/var/rescircuits/close_case.jinja</span></code></p></td>
<td><p><em>Path to override template for automatic case closing. See <a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a>.</em></p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section id="custom-layouts">
<h3>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">¶</a></h3>
<p>The app automatically creates a custom <code class="docutils literal notranslate"><span class="pre">Carbon</span> <span class="pre">Black</span> <span class="pre">Cloud</span></code> tab on first run after installation:</p>
<p><img alt="screenshot: custom_layouts " src="../_images/custom_layouts34.png" /></p>
</section>
<section id="poller-considerations">
<h3>Poller Considerations<a class="headerlink" href="#poller-considerations" title="Link to this heading">¶</a></h3>
<p>The poller is just one way to escalate Carbon Black Cloud alerts to SOAR cases. It’s also possible to send Carbon Black Cloud alert information to another SIEM, such as IBM QRadar, which would then correlate cases into Offenses. With the QRadar Plugin for SOAR, offenses can then be escalated to SOAR cases. As long as the Carbon Black Cloud alert is preserved in the custom case field <code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_id</span></code>, then all the remaining details about the case synchronize to the SOAR case. In the case of the QRadar Plugin for SOAR, you would modify the escalation templates to reference this custom field with the VMware Carbon Black Cloud Alert ID.</p>
<p>When using another source of Carbon Black Cloud alert escalation to IBM SOAR, disable the poller by changing the app.config setting to <code class="docutils literal notranslate"><span class="pre">poller_interval=0</span></code>.</p>
<section id="poller-templates-for-soar-cases">
<h4>Poller Templates for SOAR Cases<a class="headerlink" href="#poller-templates-for-soar-cases" title="Link to this heading">¶</a></h4>
<p>It may be necessary to modify the templates used to create, update, or close SOAR cases based on your required custom fields in SOAR.</p>
<p>This is especially relevant if you have required custom <code class="docutils literal notranslate"><span class="pre">close</span></code> fields that need to be filled when closing a case in SOAR. If that is the case, be sure to implement a custom <code class="docutils literal notranslate"><span class="pre">close_case_template</span></code> and reference those required close fields in the template.</p>
<p>When overriding the template in App Host, specify the file path for each file as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<p>Below are the default templates used which can be copied, modified, and used with app_config’s
<code class="docutils literal notranslate"><span class="pre">soar_create_case_template</span></code>, <code class="docutils literal notranslate"><span class="pre">soar_update_case_template</span></code>, and <code class="docutils literal notranslate"><span class="pre">soar_close_case_template</span></code> settings to override the default templates.</p>
</section>
</section>
<section id="alert-filtering">
<h3>Alert Filtering<a class="headerlink" href="#alert-filtering" title="Link to this heading">¶</a></h3>
<p>To limit the number of alerts escalated to SOAR, consider using the optional <code class="docutils literal notranslate"><span class="pre">polling_filters</span></code> parameter in the app configuration file. Each filter is a tuple in the following format: (“field”,”values”),
Where:</p>
<ul class="simple">
<li><p>“field” is the Carbon Black Cloud alert field to be queried</p></li>
<li><p>“values” is a comma separated string of values to include in the query results returned</p></li>
</ul>
<p>
If more than one filter is needed, separate each tuple with a comma.
<p>
Denote lists enclosed in square brackets [].
<p>
NOTE: See Carbon Black Cloud documentation here 
<p><a class="reference external" href="https://developer.carbonblack.com/reference/carbon-black-cloud/platform/latest/alert-search-fields">Carbon Black Alert Search Fields</a> for all possible searchable alert fields.</p>
<p>
Here are 3 polling filter criteria examples that add or update CBC alerts in SOAR 
<p><code class="docutils literal notranslate"><span class="pre">polling_filters_criteria_1</span> <span class="pre">=</span> <span class="pre">(&quot;group_results&quot;,False),(&quot;minimum_severity&quot;,4),(&quot;target_value&quot;,[&quot;LOW&quot;,&quot;MEDIUM&quot;]),(&quot;alert_type&quot;,[&quot;CB_ANALYTICS&quot;,&quot;WATCHLIST&quot;]),(&quot;workflow_status&quot;,[&quot;OPEN&quot;,&quot;IN_PROGRESS&quot;,&quot;CLOSED&quot;])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">polling_filters_criteria_2</span> <span class="pre">=</span> <span class="pre">(&quot;group_results&quot;,False),(&quot;minimum_severity&quot;,1),(&quot;target_value&quot;,[&quot;LOW&quot;,&quot;MEDIUM&quot;,&quot;HIGH&quot;,&quot;MISSION_CRITICAL&quot;]),(&quot;alert_type&quot;,[&quot;CB_ANALYTICS&quot;]),(&quot;reputation&quot;,[&quot;KNOWN_MALWARE&quot;,&quot;PUP&quot;,&quot;SUSPECT_MALWARE&quot;,&quot;COMPANY_BLACK_LIST&quot;]),(&quot;workflow_status&quot;,[&quot;OPEN&quot;,&quot;IN_PROGRESS&quot;,&quot;CLOSED&quot;])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">polling_filters_criteria_3</span> <span class="pre">=</span> <span class="pre">(&quot;group_results&quot;,False),(&quot;minimum_severity&quot;,1),(&quot;target_value&quot;,[&quot;LOW&quot;,&quot;MEDIUM&quot;,&quot;HIGH&quot;,&quot;MISSION_CRITICAL&quot;]),(&quot;alert_type&quot;,[&quot;CB_ANALYTICS&quot;]),(&quot;reason_code&quot;,[&quot;T_DETECT_SUSPECT&quot;,&quot;T_RUN_MALWARE&quot;,&quot;T_REP_VIRUS&quot;,&quot;T_RUN_VIRUS&quot;]),(&quot;workflow_status&quot;,[&quot;OPEN&quot;,&quot;IN_PROGRESS&quot;,&quot;CLOSED&quot;])</span></code></p>
<p><strong>NOTE:</strong> Each individual polling filter is first constructed by joining together the field and the desired values using OR statements. Each individual filter is then combined using AND.  In the example above, only alerts with target_value LOW,MEDIUM, HIGH, MISSION_CRITICAL AND those with workflow statuses OPEN, IN_PROGRESS,or CLOSED are pulled into SOAR as cases.</p>
</section>
</section>
<section id="similar-to-alert-search-criteria-a-search-alert-exclusions-filter-can-be-specified-for-each-polling-filter-criteria-1-2-3">
<h2>Similar to alert search “criteria”, a search alert “exclusions” filter can be specified for each polling_filter_criteria_(1,2,3).<a class="headerlink" href="#similar-to-alert-search-criteria-a-search-alert-exclusions-filter-can-be-specified-for-each-polling-filter-criteria-1-2-3" title="Link to this heading">¶</a></h2>
</section>
<section id="function-vmware-cbc-get-alert-by-id">
<h2>Function - VMware CBC: Get Alert By ID<a class="headerlink" href="#function-vmware-cbc-get-alert-by-id" title="Link to this heading">¶</a></h2>
<p>Get the alert JSON from VMware Carbon Black Cloud by alert ID.</p>
<p><img alt="screenshot: fn-vmware-cbc-get-alert-by-id " src="../_images/fn-vmware-cbc-get-alert-by-id.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;alert&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;alert_notes_present&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;alert_url&quot;</span><span class="p">:</span> <span class="s2">&quot;my-cbc.net/alerts?s[c][query_string]=id:0730b7bc-7d51-9d64-68b1-d3e01d28a716</span><span class="se">\u0026</span><span class="s2">orgKey=XXXXYYYY&quot;</span><span class="p">,</span>
      <span class="s2">&quot;asset_group&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;attack_tactic&quot;</span><span class="p">:</span> <span class="s2">&quot;TA0001&quot;</span><span class="p">,</span>
      <span class="s2">&quot;backend_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:16:50.606Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;backend_update_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:17:48.151Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;childproc_cmdline&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;childproc_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;childproc_username&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;detection_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:15:47.419Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;determination&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;change_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:16:50.606Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;changed_by&quot;</span><span class="p">:</span> <span class="s2">&quot;ALERT_CREATION&quot;</span><span class="p">,</span>
        <span class="s2">&quot;changed_by_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SYSTEM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;NONE&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;device_external_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;170.225.223.20&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_id&quot;</span><span class="p">:</span> <span class="mi">206046519</span><span class="p">,</span>
      <span class="s2">&quot;device_internal_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.87.128&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_location&quot;</span><span class="p">:</span> <span class="s2">&quot;OFFSITE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;winserver221&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_os&quot;</span><span class="p">:</span> <span class="s2">&quot;WINDOWS&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_os_version&quot;</span><span class="p">:</span> <span class="s2">&quot;Windows Server 2022 x64&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_policy_id&quot;</span><span class="p">:</span> <span class="mi">493371</span><span class="p">,</span>
      <span class="s2">&quot;device_target_value&quot;</span><span class="p">:</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_uem_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;device_username&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
      <span class="s2">&quot;first_event_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:15:45.021Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;0730b7bc-7d51-9d64-68b1-d3e01d28a716&quot;</span><span class="p">,</span>
      <span class="s2">&quot;is_updated&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;last_event_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:15:45.398Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;mdr_alert&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;mdr_alert_notes_present&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;mdr_threat_notes_present&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;org_key&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_cmdline&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_effective_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUSTED_WHITE_LIST&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE-0c480537-00000344-00000000-1da8f6c97aa305d&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_md5&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_name&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">windows</span><span class="se">\\</span><span class="s2">system32</span><span class="se">\\</span><span class="s2">services.exe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_pid&quot;</span><span class="p">:</span> <span class="mi">836</span><span class="p">,</span>
      <span class="s2">&quot;parent_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUSTED_WHITE_LIST&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;854780206e7abbf5a46704f1e75c5075881e4e914c7b44bea45fac1677781096&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parent_username&quot;</span><span class="p">:</span> <span class="s2">&quot;NT AUTHORITY</span><span class="se">\\</span><span class="s2">SYSTEM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;policy_applied&quot;</span><span class="p">:</span> <span class="s2">&quot;APPLIED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;primary_event_id&quot;</span><span class="p">:</span> <span class="s2">&quot;6f097307fda711eeb0bd491bae9facb0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_cmdline&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">C:</span><span class="se">\\</span><span class="s2">Program Files</span><span class="se">\\</span><span class="s2">Confer</span><span class="se">\\</span><span class="s2">RepMgr.exe</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_effective_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;IGNORE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE-0c480537-000008e8-00000000-1da8f6c9a23e47a&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_issuer&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Sectigo RSA Code Signing CA 2&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;process_md5&quot;</span><span class="p">:</span> <span class="s2">&quot;8a87acebc21e2cc5eeb24af602b32b30&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_name&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">program files</span><span class="se">\\</span><span class="s2">confer</span><span class="se">\\</span><span class="s2">repmgr.exe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_pid&quot;</span><span class="p">:</span> <span class="mi">2280</span><span class="p">,</span>
      <span class="s2">&quot;process_publisher&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Carbon Black, Inc.&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;process_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUSTED_WHITE_LIST&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;f6ec44f025c67ab18170da47c1c610a94a9c84741f3cdfceb20cee565579868a&quot;</span><span class="p">,</span>
      <span class="s2">&quot;process_username&quot;</span><span class="p">:</span> <span class="s2">&quot;NT AUTHORITY</span><span class="se">\\</span><span class="s2">SYSTEM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;A file (340s.exe) with a reputation of known malware was found on disk.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;reason_code&quot;</span><span class="p">:</span> <span class="s2">&quot;T_DETECT_MALWARE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;run_state&quot;</span><span class="p">:</span> <span class="s2">&quot;RAN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sensor_action&quot;</span><span class="p">:</span> <span class="s2">&quot;ALLOW&quot;</span><span class="p">,</span>
      <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;threat_id&quot;</span><span class="p">:</span> <span class="s2">&quot;32120969ccb74e5382fd587417e23e1c&quot;</span><span class="p">,</span>
      <span class="s2">&quot;threat_notes_present&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;ttps&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;DETECTED_MALWARE_APP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UNKNOWN_APP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;POLICY_DENY&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;CB_ANALYTICS&quot;</span><span class="p">,</span>
      <span class="s2">&quot;user_update_timestamp&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;workflow&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;change_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18T17:16:50.606Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;changed_by&quot;</span><span class="p">:</span> <span class="s2">&quot;ALERT_CREATION&quot;</span><span class="p">,</span>
        <span class="s2">&quot;changed_by_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SYSTEM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;closure_reason&quot;</span><span class="p">:</span> <span class="s2">&quot;NO_REASON&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;OPEN&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_alert_id&quot;</span><span class="p">:</span> <span class="s2">&quot;0730b7bc-7d51-9d64-68b1-d3e01d28a716&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">213</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myhost&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-19 10:53:10&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span> <span class="k">as</span> <span class="n">url_encode</span>

<span class="c1"># Map VMware CBC workflow closure_reason values SOAR resolution id values.</span>
<span class="n">MAPPING_CLOSURE_REASON</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;Resolved&quot;</span> <span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;No Reason&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Resolved Benign Known Good&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Duplicate Cleanup&quot;</span> <span class="p">:</span> <span class="s2">&quot;Duplicate&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Other&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span>
<span class="p">}</span>

<span class="c1"># Map VMware CBC determination values to SOAR resolution id values.</span>
<span class="n">MAPPING_DETERMINATION_ON_CLOSE</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;None&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;False positive&quot;</span><span class="p">:</span> <span class="s2">&quot;Not an Issue&quot;</span><span class="p">,</span>
  <span class="s2">&quot;True positive&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span>
<span class="p">}</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_alert_by_id_results</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Update Case Manual:&lt;/b&gt; Write Alert Custom Fields did NOT complete.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">alert</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">)</span>
        <span class="n">alert_url</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alert_url&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">alert_url</span><span class="p">:</span>
          <span class="c1"># url encode the bracket characters [] </span>
          <span class="n">alert_url_urlencoded</span> <span class="o">=</span> <span class="n">alert_url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;%5B&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;%5D&quot;</span><span class="p">)</span>
          <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_link</span> <span class="o">=</span> <span class="s2">&quot;&lt;a target=&#39;_blank&#39; href=&#39;https://</span><span class="si">{0}</span><span class="s2">&#39;&gt;Alert Link&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_url_urlencoded</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_type</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_reason_code</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason_code&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_threat_id</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threat_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">workflow</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;workflow&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">workflow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">closure_reason</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;closure_reason&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">workflow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;closure_reason&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_status</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">if</span> <span class="n">status</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_closure_reason</span> <span class="o">=</span> <span class="n">closure_reason</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">if</span> <span class="n">status</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">determination</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;determination&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">determination_value</span> <span class="o">=</span> <span class="n">determination</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">determination</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_determination_value</span> <span class="o">=</span> <span class="n">determination_value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">if</span> <span class="n">determination_value</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_tags</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_attack_tactic</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attack_tactic&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Update Case Manual:&lt;/b&gt; Write Alert Custom Fields completed.&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_status</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;closed&quot;</span><span class="p">:</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">plan_status</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span> <span class="o">=</span> <span class="n">MAPPING_CLOSURE_REASON</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_closure_reason</span><span class="p">,</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">)</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">resolution_summary</span> <span class="o">=</span> <span class="s2">&quot;Case </span><span class="si">{0}</span><span class="s2"> Closed in SOAR&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span> 
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Update Case Manual:&lt;/b&gt; Write Alert Custom Fields did NOT complete.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-get-cbc-notes">
<h2>Function - VMware CBC: Get CBC Notes<a class="headerlink" href="#function-vmware-cbc-get-cbc-notes" title="Link to this heading">¶</a></h2>
<p>Get the alert or threat notes of the specified Carbon Black Cloud alert or threat id.</p>
<p><img alt="screenshot: fn-vmware-cbc-get-cbc-notes " src="../_images/fn-vmware-cbc-get-cbc-notes.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Can be a CBC alert or threat ID</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_note_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_id&quot;</span><span class="p">:</span> <span class="s2">&quot;0730b7bc-7d51-9d64-68b1-d3e01d28a716&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_incident_id&quot;</span><span class="p">:</span> <span class="mi">2186</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_note_type&quot;</span><span class="p">:</span> <span class="s2">&quot;alert&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">56753</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myapphost.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-24 16:15:57&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_note_type</span> <span class="o">=</span> <span class="s2">&quot;alert&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_alert_notes_results</span>


<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Get Alert Notes&lt;/b&gt; playbook created </span><span class="si">{0}</span><span class="s2"> notes in SOAR&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Get Alert Notes&lt;/b&gt; function failed to get notes from Carbon Black Cloud&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Get Alert Notes&lt;/b&gt; function failed to get notes from Carbon Black Cloud&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-get-device-by-id">
<h2>Function - VMware CBC: Get Device By ID<a class="headerlink" href="#function-vmware-cbc-get-device-by-id" title="Link to this heading">¶</a></h2>
<p>Get the device information from Carbon Black Cloud by the specified device ID.</p>
<p><img alt="screenshot: fn-vmware-cbc-get-device-by-id " src="../_images/fn-vmware-cbc-get-device-by-id.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;activation_code&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;activation_code_expiry_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-22T19:31:18.358Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ad_group_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;appliance_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;appliance_uuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;asset_group&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;auto_scaling_group_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_ave_version&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_engine&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_last_scan_time&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_master&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;av_pack_version&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_product_version&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_status&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;AV_ACTIVE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ONDEMAND_SCAN_DISABLED&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;av_update_servers&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;av_vdf_version&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;base_device&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;cloud_provider_account_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;cloud_provider_resource_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;cloud_provider_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;cluster_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;compliance_status&quot;</span><span class="p">:</span> <span class="s2">&quot;NOT_ASSESSED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;current_sensor_policy_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
      <span class="s2">&quot;datacenter_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;deployment_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ENDPOINT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;deregistered_time&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;device_meta_data_item_list&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;key_name&quot;</span><span class="p">:</span> <span class="s2">&quot;OS_MAJOR_VERSION&quot;</span><span class="p">,</span>
          <span class="s2">&quot;key_value&quot;</span><span class="p">:</span> <span class="s2">&quot;Windows 11&quot;</span><span class="p">,</span>
          <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;key_name&quot;</span><span class="p">:</span> <span class="s2">&quot;SUBNET&quot;</span><span class="p">,</span>
          <span class="s2">&quot;key_value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.43.0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;device_owner_id&quot;</span><span class="p">:</span> <span class="mi">16421859</span><span class="p">,</span>
      <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
      <span class="s2">&quot;esx_host_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;esx_host_uuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;golden_device&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;golden_device_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">210476652</span><span class="p">,</span>
      <span class="s2">&quot;infrastructure_provider&quot;</span><span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_contact_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-10T17:31:19.521Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_device_policy_changed_time&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;last_device_policy_requested_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-10T17:06:42.474Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_external_ip_address&quot;</span><span class="p">:</span> <span class="s2">&quot;70.25.23.23&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_internal_ip_address&quot;</span><span class="p">:</span> <span class="s2">&quot;9.35.43.10&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_location&quot;</span><span class="p">:</span> <span class="s2">&quot;OFFSITE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;last_policy_updated_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-12-13T07:03:23.711Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_reported_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-10T17:11:52.177Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_reset_time&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;last_shutdown_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-10T17:06:03.515Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;login_user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;WINSERVER2022</span><span class="se">\\</span><span class="s2">Administrator&quot;</span><span class="p">,</span>
      <span class="s2">&quot;mac_address&quot;</span><span class="p">:</span> <span class="s2">&quot;00000a0b67eb&quot;</span><span class="p">,</span>
      <span class="s2">&quot;middle_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;winserver2022&quot;</span><span class="p">,</span>
      <span class="s2">&quot;nsx_distributed_firewall_policy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;nsx_enabled&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;organization_id&quot;</span><span class="p">:</span> <span class="mi">72676</span><span class="p">,</span>
      <span class="s2">&quot;organization_name&quot;</span><span class="p">:</span> <span class="s2">&quot;myorg.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;os&quot;</span><span class="p">:</span> <span class="s2">&quot;WINDOWS&quot;</span><span class="p">,</span>
      <span class="s2">&quot;os_version&quot;</span><span class="p">:</span> <span class="s2">&quot;Windows Server 2022 x64&quot;</span><span class="p">,</span>
      <span class="s2">&quot;passive_mode&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;policy_id&quot;</span><span class="p">:</span> <span class="mi">493371</span><span class="p">,</span>
      <span class="s2">&quot;policy_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
      <span class="s2">&quot;policy_override&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;quarantined&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;registered_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-10T16:59:59.563Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;scan_last_action_time&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;scan_last_complete_time&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;scan_status&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;sensor_gateway_url&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;sensor_gateway_uuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;sensor_kit_type&quot;</span><span class="p">:</span> <span class="s2">&quot;WINDOWS&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sensor_out_of_date&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;sensor_pending_update&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;sensor_states&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;ACTIVE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LIVE_RESPONSE_NOT_RUNNING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LIVE_RESPONSE_NOT_KILLED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LIVE_RESPONSE_DISABLED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CB_FIREWALL_INACTIVE&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;sensor_version&quot;</span><span class="p">:</span> <span class="s2">&quot;4.0.1.1428&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;REGISTERED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;target_priority&quot;</span><span class="p">:</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;uninstall_code&quot;</span><span class="p">:</span> <span class="s2">&quot;XXXX&quot;</span><span class="p">,</span>
      <span class="s2">&quot;vcenter_host_url&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vcenter_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vcenter_uuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vdi_base_device&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vdi_provider&quot;</span><span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;virtual_machine&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;virtual_private_cloud_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;virtualization_provider&quot;</span><span class="p">:</span> <span class="s2">&quot;OTHER&quot;</span><span class="p">,</span>
      <span class="s2">&quot;vm_ip&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vm_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vm_uuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;vulnerability_score&quot;</span><span class="p">:</span> <span class="mf">8.8</span><span class="p">,</span>
      <span class="s2">&quot;vulnerability_severity&quot;</span><span class="p">:</span> <span class="s2">&quot;IMPORTANT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;windows_platform&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_device_id&quot;</span><span class="p">:</span> <span class="s2">&quot;210476652&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">15881</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-10 13:34:09&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_device_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_device_by_id_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">device</span><span class="p">:</span>
      <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_quarantined</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;quarantined&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_status</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">sensor_states</span> <span class="o">=</span>  <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sensor_states&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
      <span class="n">row</span><span class="o">.</span><span class="n">cbc_sensor_state</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sensor_states</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_states</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
      <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Update complete.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Unable to get device data to update CBC Device data table.&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Unable to get device data to update CBC Device data table - no content.&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Unable to get device data to update CBC Device data table.&lt;br&gt; reason: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-post-alert-workflow-data">
<h2>Function - VMware CBC: Post Alert Workflow Data<a class="headerlink" href="#function-vmware-cbc-post-alert-workflow-data" title="Link to this heading">¶</a></h2>
<p>Update the alert workflow information in VMware Carbon Black Cloud.</p>
<p><img alt="screenshot: fn-vmware-cbc-post-alert-workflow-data " src="../_images/fn-vmware-cbc-post-alert-workflow-data.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_closure_reason</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Reason code for why the alert is being updated. Optional</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_determination</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_note_text</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Custom message to add to the note added to modified alert</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_status</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Alert workflow status in CBC</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;connector_id&quot;</span><span class="p">:</span> <span class="s2">&quot;FRIYZADN2K&quot;</span><span class="p">,</span>
    <span class="s2">&quot;create_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-29T15:09:30.535479Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">14374209</span><span class="p">,</span>
    <span class="s2">&quot;job_parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;job_parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;criteria&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;35081d68-29d0-7592-f408-33939ed01882&quot;</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;determination&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;IN_PROGRESS&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;userWorkflowDto&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;change_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-29T15:09:30.461Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;changed_by&quot;</span><span class="p">:</span> <span class="s2">&quot;FRZADN2KIK&quot;</span><span class="p">,</span>
          <span class="s2">&quot;changed_by_type&quot;</span><span class="p">:</span> <span class="s2">&quot;API&quot;</span><span class="p">,</span>
          <span class="s2">&quot;closure_reason&quot;</span><span class="p">:</span> <span class="s2">&quot;NO_REASON&quot;</span><span class="p">,</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;IN_PROGRESS&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;last_update_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-29T15:09:31.340546Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;org_key&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;progress&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Dismissal completed&quot;</span><span class="p">,</span>
      <span class="s2">&quot;num_completed&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;num_total&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;user_workflow_update&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_alert_id&quot;</span><span class="p">:</span> <span class="s2">&quot;35081d68-29d0-7592-f408-33939ed01882&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_closure_reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_determination&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE_POSITIVE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_note_text&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_status&quot;</span><span class="p">:</span> <span class="s2">&quot;IN_PROGRESS&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1599</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-29 11:09:31&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">STATUS_MAPPING</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;Unresolved&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOSED&quot;</span><span class="p">,</span>   <span class="c1"># Unresolved</span>
  <span class="s2">&quot;Duplicate&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOSED&quot;</span><span class="p">,</span>    <span class="c1"># Duplicate</span>
  <span class="s2">&quot;Not an Issue&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOSED&quot;</span><span class="p">,</span> <span class="c1"># Not an Issue</span>
  <span class="s2">&quot;Resolved&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOSED&quot;</span>      <span class="c1"># Resolved</span>
<span class="p">}</span>

<span class="n">CLOSURE_REASON_MAPPING</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;Unresolved&quot;</span><span class="p">:</span> <span class="s2">&quot;NO_REASON&quot;</span><span class="p">,</span>   <span class="c1"># Unresolved</span>
  <span class="s2">&quot;Duplicate&quot;</span><span class="p">:</span> <span class="s2">&quot;DUPLICATE_CLEANUP&quot;</span><span class="p">,</span>    <span class="c1"># Duplicate</span>
  <span class="s2">&quot;Not an Issue&quot;</span><span class="p">:</span> <span class="s2">&quot;RESOLVED_BENIGN_KNOWN_GOOD&quot;</span><span class="p">,</span> <span class="c1"># Not an Issue</span>
  <span class="s2">&quot;Resolved&quot;</span><span class="p">:</span> <span class="s2">&quot;RESOLVED&quot;</span>      <span class="c1"># Resolved</span>
<span class="p">}</span>


<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_status</span> <span class="o">=</span> <span class="n">STATUS_MAPPING</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span><span class="p">,</span> <span class="s2">&quot;CLOSED&quot;</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_closure_reason</span> <span class="o">=</span> <span class="n">CLOSURE_REASON_MAPPING</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span><span class="p">,</span> <span class="s2">&quot;NO_REASON&quot;</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_note_text</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">resolution_summary</span><span class="o">.</span><span class="n">content</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">resolution_summary</span><span class="o">.</span><span class="n">content</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Case </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> was closed in IBM QRadar SOAR&quot;</span>

<span class="c1"># Note determination is set to the custom field value.  Make sure to set determination before closing the case in SOAR</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_determination</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_determination_value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_determination_value</span> <span class="k">else</span> <span class="s2">&quot;NONE&quot;</span>

<span class="c1"># Set custom fields in SOAR with values sent to CBC.</span>
<span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_status</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_status</span>
<span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_status</span> <span class="o">==</span> <span class="s2">&quot;CLOSED&quot;</span> <span class="ow">and</span> <span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_closure_reason</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_workflow_closure_reason</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_closure_reason</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">close_alert_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Close Alert on Case Close:&lt;/b&gt; Closed alert in Carbon Black Cloud.&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Close Alert on Case Close:&lt;/b&gt; Failed function to set status. Reason = </span><span class="si">{reason}</span><span class="s2">&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-post-device-action">
<h2>Function - VMware CBC: Post Device Action<a class="headerlink" href="#function-vmware-cbc-post-device-action" title="Link to this heading">¶</a></h2>
<p>Post an action to the device monitored by Carbon Black Cloud.</p>
<p><img alt="screenshot: fn-vmware-cbc-post-device-action " src="../_images/fn-vmware-cbc-post-device-action.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_action</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_toggle</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;device_status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_device_action&quot;</span><span class="p">:</span> <span class="s2">&quot;QUARANTINE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_device_id&quot;</span><span class="p">:</span> <span class="s2">&quot;212389492&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_device_toggle&quot;</span><span class="p">:</span> <span class="s2">&quot;OFF&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">54545</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-31 12:31:34&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_device_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_device_action</span> <span class="o">=</span> <span class="s2">&quot;QUARANTINE&quot;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_device_toggle</span> <span class="o">=</span> <span class="s2">&quot;OFF&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">post_device_action_results</span>


<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Quarantine OFF:&lt;/b&gt; Post action to device successful.&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Quarantine OFF:&lt;/b&gt; Failed to post action Quarantine OFF: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-post-note-to-cbc-alert">
<h2>Function - VMware CBC: Post Note to CBC Alert<a class="headerlink" href="#function-vmware-cbc-post-note-to-cbc-alert" title="Link to this heading">¶</a></h2>
<p>Post a note to the specified Carbon Black Cloud alert in CBC.</p>
<p><img alt="screenshot: fn-vmware-cbc-post-note-to-cbc-alert " src="../_images/fn-vmware-cbc-post-note-to-cbc-alert.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_note_text</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Note</span> <span class="pre">text</span> <span class="pre">body</span> <span class="pre">to</span> <span class="pre">send</span> <span class="pre">to</span> <span class="pre">CBC</span> <span class="pre">alert.</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;FR6K2KN2K&quot;</span><span class="p">,</span>
    <span class="s2">&quot;create_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-26T20:30:03.905Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;50c323c1-8495-4fe4-815f-7bc411976ec9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_update_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-26T20:30:03.905Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;Created by IBM SOAR:  VMware CBC Update Case on Creation:  populated Process data table 2  artifact(s) added to the case.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;note_json_format&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOMER&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_alert_id&quot;</span><span class="p">:</span> <span class="s2">&quot;0730b7bc-7d51-9d64-68b1-d3e01d28a716&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_alert_note_text&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">b</span><span class="se">\u003e</span><span class="s2">VMware CBC Update Case on Creation:</span><span class="se">\u003c</span><span class="s2">/b</span><span class="se">\u003e</span><span class="s2"> populated Process data table</span><span class="se">\u003c</span><span class="s2">br /</span><span class="se">\u003e\u003c</span><span class="s2">b</span><span class="se">\u003e</span><span class="s2">2</span><span class="se">\u003c</span><span class="s2">/b</span><span class="se">\u003e</span><span class="s2"> artifact(s) added to the case.&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">19794</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;myapphost&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-26 16:30:04&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_alert_note_text</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">post_note_to_alert_results</span>

<span class="c1"># Edit note in SOAR to indicate it was sent to CBC alert</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="c1"># Get the current time</span>
  <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
  <span class="n">note</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&lt;b&gt;Post note to CBC alert at </span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;br&gt;</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
  
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-post-observations-detail-job">
<h2>Function - VMware CBC: Post Observations Detail Job<a class="headerlink" href="#function-vmware-cbc-post-observations-detail-job" title="Link to this heading">¶</a></h2>
<p>Creates an Observations details job and returns the result of the job. The details include information about the given event that’s not normally accessible during a search. The observations parameter is a JSON object converted to a string.  See the Carbon Black Cloud documentation on the Observation Detail Job: Create Detail Job request body.  The full JSON is defined :
{
“alert_id”: “<string>”,
“observation_ids”: [”<string>”],
“process_hash”: “<string>”,
“device_id”: <integer>,
“count_unique_devices”: <boolean>,
“max_rows”: <integer>
}</p>
<p><img alt="screenshot: fn-vmware-cbc-post-observations-detail-job " src="../_images/fn-vmware-cbc-post-observations-detail-job.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_observation</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>JSON value dumped to a string.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;alert_category&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;THREAT&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;alert_id&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;3680c6ba-c645-6779-3976-f9ed69326ca1&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;backend_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-06-12T14:35:37.015Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_external_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;170.225.223.22&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_group_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;device_id&quot;</span><span class="p">:</span> <span class="mi">212389492</span><span class="p">,</span>
        <span class="s2">&quot;device_installed_by&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_internal_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.34.190&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_location&quot;</span><span class="p">:</span> <span class="s2">&quot;OFFSITE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_name&quot;</span><span class="p">:</span> <span class="s2">&quot;cb-win221&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_os&quot;</span><span class="p">:</span> <span class="s2">&quot;WINDOWS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_os_version&quot;</span><span class="p">:</span> <span class="s2">&quot;Windows Server 2022 x64&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_policy_id&quot;</span><span class="p">:</span> <span class="mi">493371</span><span class="p">,</span>
        <span class="s2">&quot;device_sensor_version&quot;</span><span class="p">:</span> <span class="s2">&quot;4.0.0.1292&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_target_priority&quot;</span><span class="p">:</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-06-12T14:32:57.641Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;document_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;djeE5vZFSoS1Xar6Gn_S1A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enriched&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;enriched_event_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FILE_CREATE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;event_attack_stage&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;DELIVER_EXPLOIT&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;event_description&quot;</span><span class="p">:</span> <span class="s2">&quot;The file </span><span class="se">\&quot;</span><span class="s2">&lt;share&gt;&lt;link hash=</span><span class="se">\&quot;</span><span class="s2">761de33e1c3d08865f5f2d0cfc84c3b5401c7915a2953ca6b8c2fddbb007556b</span><span class="se">\&quot;</span><span class="s2">&gt;c:</span><span class="se">\\</span><span class="s2">users</span><span class="se">\\</span><span class="s2">administrator</span><span class="se">\\</span><span class="s2">downloads</span><span class="se">\\</span><span class="s2">temp4</span><span class="se">\\</span><span class="s2">340s.exe</span><span class="se">\\</span><span class="s2">340s.exe&lt;/link&gt;&lt;/share&gt;</span><span class="se">\&quot;</span><span class="s2"> was first detected on a local disk. The device was off the corporate network using the public address 170.225.223.22 (located in San Jose CA, United States). The file is not signed. The file was created by the application </span><span class="se">\&quot;</span><span class="s2">&lt;share&gt;&lt;link hash=</span><span class="se">\&quot;</span><span class="s2">f6ec44f025c67ab18170da47c1c610a94a9c84741f3cdfceb20cee565579868a</span><span class="se">\&quot;</span><span class="s2">&gt;c:</span><span class="se">\\</span><span class="s2">program files</span><span class="se">\\</span><span class="s2">confer</span><span class="se">\\</span><span class="s2">repmgr.exe&lt;/link&gt;&lt;/share&gt;</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;event_id&quot;</span><span class="p">:</span> <span class="s2">&quot;cda5cca328c811efb47ec103488c1130&quot;</span><span class="p">,</span>
        <span class="s2">&quot;event_threat_score&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="mi">3</span>
        <span class="p">],</span>
        <span class="s2">&quot;event_type&quot;</span><span class="p">:</span> <span class="s2">&quot;filemod&quot;</span><span class="p">,</span>
        <span class="s2">&quot;file_scan_result&quot;</span><span class="p">:</span> <span class="s2">&quot;/ZBot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;filemod_action&quot;</span><span class="p">:</span> <span class="s2">&quot;ACTION_FILE_CREATE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;filemod_hash&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;48cd89827939b3a8976d9bb0993bc338&quot;</span><span class="p">,</span>
          <span class="s2">&quot;761de33e1c3d08865f5f2d0cfc84c3b5401c7915a2953ca6b8c2fddbb007556b&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;filemod_issuer&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;jhjkkkaaaaaaaaaaa&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;filemod_name&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">users</span><span class="se">\\</span><span class="s2">administrator</span><span class="se">\\</span><span class="s2">downloads</span><span class="se">\\</span><span class="s2">temp4</span><span class="se">\\</span><span class="s2">340s.exe</span><span class="se">\\</span><span class="s2">340s.exe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;filemod_publisher&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;jhjkkkaaaaaaaaaaa&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;filemod_publisher_state&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;FILE_SIGNATURE_STATE_SIGNED&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;filemod_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;KNOWN_MALWARE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ingress_time&quot;</span><span class="p">:</span> <span class="mi">1718202925831</span><span class="p">,</span>
        <span class="s2">&quot;legacy&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;observation_description&quot;</span><span class="p">:</span> <span class="s2">&quot;A known virus (Trojan: ZBot) was detected in file c:</span><span class="se">\\</span><span class="s2">users</span><span class="se">\\</span><span class="s2">administrator</span><span class="se">\\</span><span class="s2">downloads</span><span class="se">\\</span><span class="s2">temp4</span><span class="se">\\</span><span class="s2">340s.exe</span><span class="se">\\</span><span class="s2">340s.exe.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;observation_id&quot;</span><span class="p">:</span> <span class="s2">&quot;cda5cca328c811efb47ec103488c1130:3680c6ba-c645-6779-3976-f9ed69326ca1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;observation_type&quot;</span><span class="p">:</span> <span class="s2">&quot;CB_ANALYTICS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;org_id&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_effective_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUSTED_WHITE_LIST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_effective_reputation_source&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOUD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE-0ca8ce74-00000318-00000000-1daac4e9610e992&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_hash&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;7477c64706110f4d0652b28c6618b8b83d27fef94ca9d112965f8c9a62ca3d7e&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;parent_issuer&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;Microsoft Windows Production PCA 2011&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;parent_name&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">windows</span><span class="se">\\</span><span class="s2">system32</span><span class="se">\\</span><span class="s2">services.exe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_pid&quot;</span><span class="p">:</span> <span class="mi">792</span><span class="p">,</span>
        <span class="s2">&quot;parent_publisher&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;Microsoft Windows Publisher&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;parent_publisher_state&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;FILE_SIGNATURE_STATE_VERIFIED&quot;</span><span class="p">,</span>
          <span class="s2">&quot;FILE_SIGNATURE_STATE_SIGNED&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;parent_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUSTED_WHITE_LIST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S-1-5-18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_username&quot;</span><span class="p">:</span> <span class="s2">&quot;NT AUTHORITY</span><span class="se">\\</span><span class="s2">SYSTEM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_cmdline&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">C:</span><span class="se">\\</span><span class="s2">Program Files</span><span class="se">\\</span><span class="s2">Confer</span><span class="se">\\</span><span class="s2">RepMgr.exe</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_cmdline_length&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="mi">36</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_effective_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;IGNORE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_effective_reputation_source&quot;</span><span class="p">:</span> <span class="s2">&quot;IGNORE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;7M9FP6WE-0ca8ce74-00000460-00000000-1daac5135bc76a4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_hash&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;8a87acebc21e2cc5eeb24af602b32b30&quot;</span><span class="p">,</span>
          <span class="s2">&quot;f6ec44f025c67ab18170da47c1c610a94a9c84741f3cdfceb20cee565579868a&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_issuer&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;Sectigo RSA Code Signing CA 2&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_name&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">program files</span><span class="se">\\</span><span class="s2">confer</span><span class="se">\\</span><span class="s2">repmgr.exe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_pid&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="mi">1120</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_publisher&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;Carbon Black, Inc.&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_publisher_state&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;FILE_SIGNATURE_STATE_VERIFIED&quot;</span><span class="p">,</span>
          <span class="s2">&quot;FILE_SIGNATURE_STATE_SIGNED&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;process_reputation&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUSTED_WHITE_LIST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;f6ec44f025c67ab18170da47c1c610a94a9c84741f3cdfceb20cee565579868a&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_start_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-22T14:06:15.472Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;S-1-5-18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process_username&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;NT AUTHORITY</span><span class="se">\\</span><span class="s2">SYSTEM&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;ttp&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;DETECTED_MALWARE_APP&quot;</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;num_found&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;num_available&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;approximate_unaggregated&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;num_aggregated&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;contacted&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s2">&quot;completed&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_observations&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">alert_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">3680c6ba-c645-6779-3976-f9ed69326ca1</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">95538</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-06-17 11:25:10&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;VMware CBC alert ID is required!&quot;</span><span class="p">)</span>

<span class="c1"># Note: Either observation_ids or alert_id is required however only one can be specified.</span>
<span class="c1"># This playbook specifies an alert_id.</span>
<span class="n">observations</span> <span class="o">=</span><span class="p">{</span>
  <span class="s2">&quot;alert_id&quot;</span><span class="p">:</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_alert_id</span>
<span class="p">}</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_observations</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">observation_detail_job_results</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">observation</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmware_cbc_observation&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  
<span class="n">header</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Observation Detail Job:&lt;/b&gt; </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>

<span class="n">json_note</span> <span class="o">=</span> <span class="p">{</span>
              <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.3&quot;</span><span class="p">,</span>
              <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">,</span> 
              <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
              <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="kc">False</span>
            <span class="p">}</span>
<span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">&#39;convert_json_to_rich_text&#39;</span><span class="p">,</span> <span class="n">json_note</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-post-reputation-override">
<h2>Function - VMware CBC: Post Reputation Override<a class="headerlink" href="#function-vmware-cbc-post-reputation-override" title="Link to this heading">¶</a></h2>
<p>Override the reputation of an application by adding a SHA-256 hash, a certificate signer or a path to a known IT tool application or directory of IT tools to an Approved or Banned list. The reputation override parameter is a JSON object converted to a string. See the Carbon Black Cloud documentation on Configure Reputation Override.</p>
<p><img alt="screenshot: fn-vmware-cbc-post-reputation-override " src="../_images/fn-vmware-cbc-post-reputation-override.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_reputation_override</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>JSON value dumped to a string.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;create_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-20T19:56:01.742Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created_by&quot;</span><span class="p">:</span> <span class="s2">&quot;FRIYZADN2K&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;fbf657a616e211efaf639b4554e04742&quot;</span><span class="p">,</span>
    <span class="s2">&quot;override_list&quot;</span><span class="p">:</span> <span class="s2">&quot;WHITE_LIST&quot;</span><span class="p">,</span>
    <span class="s2">&quot;override_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SHA256&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sha256_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;8f7c9555176248ea553d9ac4c8df5a4b5e36ba43d2b02c153e3ee322970877e0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;APP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source_ref&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_reputation_override&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">override_list</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">WHITE_LIST</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">override_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHA256</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">sha256_hash</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">8f7c9555176248ea553d9ac4c8df5a4b5e36ba43d2b02c153e3ee322970877e0</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">6481</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-20 15:56:01&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_process_sha256</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;SHA256 is required to override reputation&quot;</span><span class="p">)</span>

<span class="n">SHA256</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_process_sha256</span>

<span class="n">override_list</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_override_list</span>
<span class="n">description</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_description</span> <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_description</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_process_name</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_process_name</span> <span class="k">else</span> <span class="kc">None</span>

<span class="n">reputation</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;override_list&quot;</span><span class="p">:</span> <span class="n">override_list</span><span class="p">,</span>
  <span class="s2">&quot;override_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SHA256&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sha256_hash&quot;</span><span class="p">:</span> <span class="n">SHA256</span><span class="p">,</span>
  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
  <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">filename</span>
<span class="p">}</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_reputation_override</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">reputation</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">override_reputation_results</span>

<span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Override Reputation:&lt;/b&gt;&lt;br&gt;  </span><span class="si">{0}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Override Reputation:&lt;/b&gt; failed to post override_reputation - no content: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="k">else</span><span class="p">:</span>

    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Override Reputation:&lt;/b&gt; failed to post override reputation: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-post-tags">
<h2>Function - VMware CBC: Post Tags<a class="headerlink" href="#function-vmware-cbc-post-tags" title="Link to this heading">¶</a></h2>
<p>Post a list of tags to a CBC alert.</p>
<p><img alt="screenshot: fn-vmware-cbc-post-tags " src="../_images/fn-vmware-cbc-post-tags.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_tags</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_threat_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;tag1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tag2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tag3&quot;</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_tags&quot;</span><span class="p">:</span> <span class="s2">&quot;tag1, tag2, tag3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_threat_id&quot;</span><span class="p">:</span> <span class="s2">&quot;88f5fb3b8c2436b172fbb4c8fa1c4ff4&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1784</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-09 16:42:24&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_threat_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">vmware_cbc_threat_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_tags</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_tags</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">post_tags_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Post Tags:&lt;/b&gt;  </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_tags</span><span class="si">}</span><span class="s2"> added.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Post Tags&lt;/b&gt; failed to post tag(s) - no content.&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Post Tags&lt;/b&gt; failed to post tag(s) </span><span class="si">{reason}</span><span class="s2">.&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-vmware-cbc-kill-process">
<h2>Function - VMware: CBC Kill Process<a class="headerlink" href="#function-vmware-cbc-kill-process" title="Link to this heading">¶</a></h2>
<p>Kill the process on the specified Carbon Black Cloud device, given the process ID (pid) on the device.</p>
<p><strong>NOTE:</strong> This function uses the Carbon Black Live Response API to issue commands on a remote device.  All Live Response commands must be issued in the context of a session and the session must have an ACTIVE state. When using the <strong>VMware CBC: Kill Process</strong> playbook, there may be a delay when the session becomes ACTIVE and the resulting incident note instructs the user to “try again later”. It may take a number of minutes for the session to become ACTIVE.</p>
<p><img alt="screenshot: fn-vmware-cbc-kill-process " src="../_images/fn-vmware-cbc-kill-process.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_process_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;create_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-31T16:15:33Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;finish_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-31T16:15:33.377707Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span>
      <span class="s2">&quot;object&quot;</span><span class="p">:</span> <span class="mi">2264</span>
    <span class="p">},</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;result_code&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;result_desc&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;PENDING&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sub_keys&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;vmware_cbc_device_id&quot;</span><span class="p">:</span> <span class="s2">&quot;212389492&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vmware_cbc_process_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2264&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">40888</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-vmware-cbc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-05-31 12:15:47&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_device_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">vmware_cbc_process_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cbc_process_pid</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">kill_process_results</span>

<span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pid</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmware_cbc_process_id&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">inputs</span> <span class="k">else</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
          <span class="n">status</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">result_code</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result_code&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;COMPLETE&quot;</span> <span class="ow">and</span> <span class="n">result_code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Kill Process:&lt;/b&gt;  PID: </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> was terminated:&lt;br&gt;</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">.&quot;</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Kill Process:&lt;/b&gt;  ERROR: PID: </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> was not terminated:&lt;br&gt;</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&lt;br&gt;</span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Kill Process:&lt;/b&gt; Failed to kill PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> - no result: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Kill Process:&lt;/b&gt; Failed to kill PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> - no content: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Kill Process:&lt;/b&gt; Failed to kill PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-convert-json-to-rich-text-v1-3">
<h2>Script - Convert JSON to rich text v1.3<a class="headerlink" href="#script-convert-json-to-rich-text-v1-3" title="Link to this heading">¶</a></h2>
<p>This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident’s rich text (custom) field or an incident note. A workflow property is used to share the json to convert and identify parameters used on how to perform the conversion.
Typically, a function will create workflow property and this script will run after that function to perform the conversion.</p>
<p>Features:</p>
<ul class="simple">
<li><p>Display the hierarchical nature of json, presenting the json keys (sorted if specified) as bold labels</p></li>
<li><p>Provide links to found URLs</p></li>
<li><p>Create either an incident note or add results to an incident (custom) rich text field.</p></li>
</ul>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (c) Copyright IBM Corp. 2010, 2023. All Rights Reserved.</span>
<span class="n">VERSION</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident&#39;s rich text (custom) field or an incident note.</span>
<span class="sd">  A workflow property is used to define the json to convert and identify parameters used on how to perform the conversion.</span>
<span class="sd">  Typically, a function will create workflow property and this script will run after that function to perform the conversion.</span>
<span class="sd">  Features:</span>
<span class="sd">    * Display the hierarchical nature of json, presenting the json keys as bold labels</span>
<span class="sd">    * Provide links to found URLs</span>
<span class="sd">    * Create either an incident note or add results to an incident (custom) rich text field.</span>
<span class="sd">  </span>
<span class="sd">  In order to use this script, define a workflow property called: convert_json_to_rich_text, to define the json and parameters to use for the conversion.</span>
<span class="sd">  Workflow properties can be added using a command similar to this:</span>
<span class="sd">  workflow.addProperty(&#39;convert_json_to_rich_text&#39;, {</span>
<span class="sd">    &quot;version&quot;: 1.3,</span>
<span class="sd">    &quot;header&quot;: &quot;Artifact scan results for: {}&quot;.format(artifact.value),</span>
<span class="sd">    &quot;padding&quot;: 10,</span>
<span class="sd">    &quot;separator&quot;: u&quot;&lt;br /&gt;&quot;,</span>
<span class="sd">    &quot;sort&quot;: True,</span>
<span class="sd">    &quot;json&quot;: results.content,</span>
<span class="sd">    &quot;json_omit_list&quot;: [&quot;omit&quot;],</span>
<span class="sd">    &quot;incident_field&quot;: None</span>
<span class="sd">  })</span>
<span class="sd">  </span>
<span class="sd">  Format of workflow.property.convert_json_to_rich_text:</span>
<span class="sd">  { </span>
<span class="sd">    &quot;version&quot;: 1.3, [this is for future compatibility]</span>
<span class="sd">    &quot;header&quot;: str, [header line to add to converted json produced or None. Ex: Results from scanning artifact: xxx. The header may contain rich text tags]</span>
<span class="sd">    &quot;padding&quot;: 10, [padding for nested json elements, or defaults to 10]</span>
<span class="sd">    &quot;separator&quot;: u&quot;&lt;br /&gt;&quot;|list such as [&#39;&lt;span&gt;&#39;,&#39;&lt;/span&gt;&#39;], [html separator between json keys and lists or defaults to html break: &#39;&lt;br /&gt;&#39;. </span>
<span class="sd">                                                If a list, then the data is brackets by the pair specified]</span>
<span class="sd">    &quot;sort&quot;: True|False, [sort the json keys at each level when displayed]</span>
<span class="sd">    &quot;json&quot;: json, [required json to convert]</span>
<span class="sd">    &quot;json_omit_list&quot;: [list of json keys to exclude or None]</span>
<span class="sd">    &quot;incident_field&quot;: &quot;&lt;incident_field&gt;&quot; [indicates a builtin rich text incident field, such as &#39;description&#39; </span>
<span class="sd">                                          or a custom rich text field in the format: &#39;properties.&lt;field&gt;&#39;. default: create an incident note]</span>
<span class="sd">  }</span>

<span class="sd">  For playbooks, use playbook.addProperty() with the same format as workflow.addProperty()</span>

<span class="sd">  Playbooks can also use playbook.functions.results.convert_json_to_rich_text using the standard function output which contains the &#39;content&#39; json element.</span>
<span class="sd">  When using playbook.functions.results.convert_json_to_rich_text with standard function results, all the defaults for padding, separator, etc. are used.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># needed for python 3</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">unicode</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span> <span class="c1"># fails in py3</span>
    <span class="n">py2</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>
    <span class="n">py2</span> <span class="o">=</span> <span class="kc">False</span>


<span class="n">rc</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+#\?]|[!*\(\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ConvertJson</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to hold the conversion parameters and perform the conversion&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_keys</span><span class="o">=</span><span class="p">[],</span> <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omit_keys</span> <span class="o">=</span> <span class="n">omit_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="o">=</span> <span class="n">separator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort_keys</span> <span class="o">=</span> <span class="n">sort_keys</span>


    <span class="k">def</span> <span class="nf">format_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">          Find embedded urls (http(s)) and add html anchor tags to display as links</span>
<span class="sd">          Args:</span>
<span class="sd">              item ([string])</span>

<span class="sd">          Returns:</span>
<span class="sd">              [str]: None|original text if no links|text with html links</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formatted_item</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">if</span> <span class="n">py2</span><span class="p">:</span>
            <span class="n">num_type</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">item</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_type</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">item</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">item</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">num_type</span><span class="p">:</span>
            <span class="nb">list</span> <span class="o">=</span> <span class="n">rc</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">formatted_item</span> <span class="o">=</span> <span class="n">formatted_item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;</span><span class="si">{0}</span><span class="s2">&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">formatted_item</span>

    <span class="k">def</span> <span class="nf">expand_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_value</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">          convert items to html, adding indents to nested dictionaries.</span>
<span class="sd">          Args:</span>
<span class="sd">              list_value ([dict|list]): json element</span>

<span class="sd">          Returns:</span>
<span class="sd">              [str]: html converted code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_link</span><span class="p">(</span><span class="n">list_value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">list_value</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;None&lt;br&gt;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">items_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># this will ensure list starts on second line of key label</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_json_to_rich_text</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">is_list</span><span class="p">:</span>
                        <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand_list</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">is_list</span><span class="p">:</span>
                    <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format_link</span><span class="p">(</span><span class="n">unicode</span><span class="p">(</span><span class="n">item</span><span class="p">))))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format_link</span><span class="p">(</span><span class="n">unicode</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>

            <span class="n">expand_list_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_list</span> <span class="k">else</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                    <span class="n">items_list</span><span class="p">,</span>
                                                    <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_list</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;&lt;ul&gt;</span><span class="si">{}</span><span class="s2">&lt;/ul&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expand_list_result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;&lt;div style=&#39;padding:5px&#39;&gt;</span><span class="si">{}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expand_list_result</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_json_to_rich_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">          Walk dictionary tree and convert to html for better display</span>
<span class="sd">          Args:</span>
<span class="sd">              sub_dict ([type]): [description]</span>

<span class="sd">          Returns:</span>
<span class="sd">              [type]: [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">sub_dict</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_dict</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">expanded_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_list</span><span class="p">(</span><span class="n">sub_dict</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="n">expanded_list</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span> <span class="p">(</span><span class="n">sub_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_keys</span> <span class="k">else</span> <span class="n">sub_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">omit_keys</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">sub_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="n">is_list</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
                        <span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="sa">u</span><span class="s2">&quot;&lt;strong&gt;</span><span class="si">{0}</span><span class="s2">&lt;/strong&gt;: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="n">convert_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_json_to_rich_text</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">convert_result</span><span class="p">:</span>
                                <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&lt;div style=&#39;padding:</span><span class="si">{}</span><span class="s2">px&#39;&gt;</span><span class="si">{}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="n">convert_result</span><span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;None&lt;br&gt;&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand_list</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">))</span>

                        <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">make_unicode</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">item_list</span><span class="p">),</span> <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">))</span>

        <span class="n">result_notes</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result_notes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result_notes</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="sa">u</span><span class="s2">&quot;&lt;/div&gt;</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">),</span> <span class="sa">u</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">),</span> <span class="sa">u</span><span class="s2">&quot;&lt;/div&gt;&quot;</span>
            <span class="p">)</span>  <span class="c1"># tighten up result</span>

    <span class="k">def</span> <span class="nf">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        apply the separator to the data</span>
<span class="sd">        :param separator: None, str or list such as [&#39;&lt;span&gt;&#39;, &#39;&lt;/span&gt;&#39;]</span>
<span class="sd">        :param items: str or list to add separator</span>
<span class="sd">        :return: text with separator applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_items</span> <span class="o">=</span> <span class="n">items</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_items</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_items</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">_items</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">,</span> <span class="n">separator</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_items</span><span class="p">])</span>

        <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_items</span><span class="p">),</span> <span class="n">separator</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_list</span> <span class="k">else</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_unicode</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;None&#39;</span>

    <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">property_name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">playbook</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">playbook</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">workflow</span> <span class="ow">and</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">get_properties</span><span class="p">(</span><span class="n">property_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logic to collect the json and parameters from a workflow property.</span>
<span class="sd">    Args:</span>
<span class="sd">      property_name: workflow property to reference</span>
<span class="sd">    Returns:</span>
<span class="sd">      padding, separator, header, json_omit_list, incident_field, json, sort_keys</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result_properties</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result_properties</span><span class="p">:</span>
        <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;Playbook/workflow property not found: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">property_name</span><span class="p">))</span>

    <span class="n">padding</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;padding&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;list of separators should be specified as a pair such as [&#39;&lt;div&gt;&#39;, &#39;&lt;/div&gt;&#39;]: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="p">))</span>

    <span class="n">header</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">)</span>
    <span class="n">sort_keys</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="n">json_omit_list</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json_omit_list&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">json_omit_list</span><span class="p">:</span>
        <span class="n">json_omit_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">incident_field</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;incident_field&quot;</span><span class="p">)</span>
    
    <span class="c1"># workflow formatted content is &#39;json&#39;. Standard functions is &#39;content&#39;</span>
    <span class="n">json</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="n">json_err</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># is there an issue we need handle now?</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">json</span> <span class="ow">and</span> \
        <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">):</span>
        <span class="n">json_err</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">padding</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">json_omit_list</span><span class="p">,</span> <span class="n">incident_field</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">json_err</span><span class="p">,</span> <span class="n">sort_keys</span>


<span class="c1">## S T A R T</span>
<span class="n">padding</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">json_omit_list</span><span class="p">,</span> <span class="n">incident_field</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">json_err</span><span class="p">,</span> <span class="n">sort_keys</span> <span class="o">=</span> <span class="n">get_properties</span><span class="p">(</span><span class="s1">&#39;convert_json_to_rich_text&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">json_err</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;Result error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">json_err</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">hdr</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}{1}{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hdr</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span>

    <span class="n">convert</span> <span class="o">=</span> <span class="n">ConvertJson</span><span class="p">(</span><span class="n">omit_keys</span><span class="o">=</span><span class="n">json_omit_list</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="n">sort_keys</span><span class="p">)</span>
    <span class="n">converted_json</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convert_json_to_rich_text</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hdr</span><span class="p">,</span> <span class="n">converted_json</span> <span class="k">if</span> <span class="n">converted_json</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">None&quot;</span><span class="p">)</span>

<span class="n">rich_text_note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">if</span> <span class="n">incident_field</span><span class="p">:</span>
    <span class="n">incident</span><span class="p">[</span><span class="n">incident_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">rich_text_note</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">rich_text_note</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-vmware-cbc-populate-cbc-device-row-from-alert">
<h2>Script - VMware CBC: Populate CBC Device Row from Alert<a class="headerlink" href="#script-vmware-cbc-populate-cbc-device-row-from-alert" title="Link to this heading">¶</a></h2>
<p>Write the function results of get device into the data table in a new row.</p>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_alert_by_id_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>

    <span class="n">alert</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">device_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;vmware_cbc_device_dt&quot;</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_query_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_id</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_name</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_policy</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_policy&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_policy_id</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_policy_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_os_version</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_os_version&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_username</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_username&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_external_ip</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_external_ip&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_internal_ip</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_internal_ip&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">device_row</span><span class="o">.</span><span class="n">cbc_device_location</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_location&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Populate CBC Device Row from Alert:&lt;/b&gt; Update complete.&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Populate CBC Device Row from Alert:&lt;/b&gt; No alert found (no content).&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;bVMware CBC: Populate CBC Device Row from Alert:&lt;/b&gt; Update did not complete. Reason = </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-vmware-cbc-populate-cbc-device-row-from-device">
<h2>Script - VMware CBC: Populate CBC Device Row from Device<a class="headerlink" href="#script-vmware-cbc-populate-cbc-device-row-from-device" title="Link to this heading">¶</a></h2>
<p>Write the results of get device by ID function to the Device data table.</p>
<p><strong>Object:</strong> vmware_cbc_device_dt</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_device_by_id_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">device</span><span class="p">:</span>
      <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_quarantined</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;quarantined&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_status</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">sensor_states</span> <span class="o">=</span>  <span class="n">device</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sensor_states&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
      <span class="n">row</span><span class="o">.</span><span class="n">cbc_sensor_state</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sensor_states</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_states</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
      <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Update complete.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Unable to get device data to update CBC Device data table.&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Unable to get device data to update CBC Device data table - no content.&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Populate Device Row from Device:&lt;/b&gt; Unable to get device data to update CBC Device data table.&lt;br&gt; reason: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-vmware-cbc-populate-observations-data-table">
<h2>Script - VMware CBC: Populate Observations Data Table<a class="headerlink" href="#script-vmware-cbc-populate-observations-data-table" title="Link to this heading">¶</a></h2>
<p>Write observations function results to the Observations data table and create hash artifacts.</p>
<p><strong>Object:</strong> Incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">def</span> <span class="nf">hash_is_sha256</span><span class="p">(</span><span class="n">_hash</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_hash</span><span class="p">)</span> <span class="o">==</span> <span class="mi">64</span>

<span class="k">def</span> <span class="nf">hash_is_sha1</span><span class="p">(</span><span class="n">_hash</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_hash</span><span class="p">)</span> <span class="o">==</span> <span class="mi">40</span>

<span class="k">def</span> <span class="nf">hash_is_md5</span><span class="p">(</span><span class="n">_hash</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">_hash</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span>


<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">observation_detail_job_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
    <span class="n">observations</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">num_rows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_observations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
    <span class="n">num_artifacts</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">observation</span> <span class="ow">in</span> <span class="n">observations</span><span class="p">:</span>
      <span class="n">file_scan_result</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_scan_result&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="c1"># To limit results only add to the data table observations that have file scan results.</span>
      <span class="k">if</span> <span class="n">file_scan_result</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;vmware_cbc_observations_dt&quot;</span><span class="p">)</span>
        <span class="n">num_rows</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">row</span><span class="o">.</span><span class="n">cbc_query_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">row</span><span class="o">.</span><span class="n">cbc_device_time</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_timestamp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">cbc_filemod_name</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filemod_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">cbc_filemod_reputation</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filemod_reputation&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">cbc_file_scan_result</span> <span class="o">=</span> <span class="n">file_scan_result</span>
      
        <span class="n">filemod_hash</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filemod_hash&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">filemod_hash</span><span class="p">:</span>
          <span class="n">row</span><span class="o">.</span><span class="n">filemod_hash</span> <span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f_hash</span><span class="p">)</span> <span class="k">for</span> <span class="n">f_hash</span> <span class="ow">in</span> <span class="n">filemod_hash</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">f_hash</span> <span class="ow">in</span> <span class="n">filemod_hash</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hash_is_md5</span><span class="p">(</span><span class="n">f_hash</span><span class="p">):</span>
              <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s2">&quot;Malware MD5 Hash&quot;</span><span class="p">,</span> <span class="n">f_hash</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;VMware Carbon Black Observations: MD5 hash from from file </span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">cbc_filemod_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
              <span class="n">num_artifacts</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">hash_is_sha256</span><span class="p">(</span><span class="n">f_hash</span><span class="p">):</span>
              <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s2">&quot;Malware SHA-256 Hash&quot;</span><span class="p">,</span> <span class="n">f_hash</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;VMware Carbon Black Observations: SHA-256 hash from file </span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">cbc_filemod_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
              <span class="n">num_artifacts</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">hash_is_sha1</span><span class="p">(</span><span class="n">f_hash</span><span class="p">):</span>
              <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s2">&quot;Malware SHA-1 Hash&quot;</span><span class="p">,</span> <span class="n">f_hash</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;VMware Carbon Black Observations: SHA-1 hash from file </span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">cbc_filemod_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
              <span class="n">num_artifacts</span> <span class="o">+=</span> <span class="mi">1</span>
            
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;VMware CBC: Update Observation DT:&lt;/b&gt; Update complete:&lt;br&gt; </span><span class="si">{</span><span class="n">num_observations</span><span class="si">}</span><span class="s2"> observations found, </span><span class="si">{</span><span class="n">num_rows</span><span class="si">}</span><span class="s2"> rows added to data table and </span><span class="si">{</span><span class="n">num_artifacts</span><span class="si">}</span><span class="s2"> artifacts added.&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;bVMware CBC: Update Observation DT:&lt;/b&gt; Failed function to get observations for Observations data table - no content.&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;bVMware CBC: Update Observation DT:&lt;/b&gt; Failed function to get observations for Observations data table.&lt;br&gt;Reason = </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Activation Type</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VMware CBC: Background Scan OFF</p></td>
<td><p>Manual playbook to turn off background scan on a device from the CBC Device data table.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p>`vmware_cbc_device_dt.cbc_device_id has_a_value</p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Background Scan ON</p></td>
<td><p>Manual playbook to enable background scan on a device from the CBC Device data table.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_dt.cbc_device_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Bypass OFF</p></td>
<td><p>Manual playbook to turn OFF BYPASS on the device from the CBC Device data table.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_dt.cbc_device_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">vmware_cbc_device_dt.cbc_device_status</span> <span class="pre">contains</span> <span class="pre">BYPASS</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Bypass ON</p></td>
<td><p>Manual playbook to turn ON BYPASS on the device from the CBC Device data table.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_dt.cbc_device_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">vmware_cbc_device_dt.cbc_device_status</span> <span class="pre">not_contains</span> <span class="pre">BYPASS</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Close Alert on Case Close</p></td>
<td><p>Automatic playbook that updates the Workflow Status and Determination of the associated alert in VMware Carbon Black Cloud when the case is closed in SOAR.  The SOAR case resolution summary is written as a note to the Carbon Black Cloud alert.</p></td>
<td><p>Automatic</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">incident.resolution_id</span> <span class="pre">changed</span> <span class="pre">AND</span> <span class="pre">incident.resolution_summary</span> <span class="pre">not_contains</span> <span class="pre">Closed</span> <span class="pre">by</span> <span class="pre">VMware</span> <span class="pre">Carbon</span> <span class="pre">Black</span> <span class="pre">Cloud</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Kill Process</p></td>
<td><p>Kill the specified process from the row in the Processes data table. Write the results to a note.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_processes_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Override Reputation</p></td>
<td><p>Override reputation of a SHA256 hash from the Processes data table row.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_processes_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Override Reputation Artifact</p></td>
<td><p>Override reputation of a SHA256 hash from a SHA256 artifact.</p></td>
<td><p>Manual</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Post Note to CBC Alert</p></td>
<td><p>Manual playbook to post a note to CBC alert in Carbon Black Cloud.</p></td>
<td><p>Manual</p></td>
<td><p>note</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.plan_status</span> <span class="pre">equals</span> <span class="pre">Active</span> <span class="pre">AND</span> <span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">note.text</span> <span class="pre">not_contains</span> <span class="pre">Created</span> <span class="pre">by</span> <span class="pre">VMware</span> <span class="pre">CBC:</span> <span class="pre">AND</span> <span class="pre">note.text</span> <span class="pre">not_contains</span> <span class="pre">Post</span> <span class="pre">note</span> <span class="pre">to</span> <span class="pre">CBC</span> <span class="pre">alert</span> <span class="pre">at</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Post Tags</p></td>
<td><p>Manual playbook to add a list of tags to a Carbon Black Cloud alert in CBC.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">incident.properties.vmware_cbc_threat_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Quarantine OFF</p></td>
<td><p>Manual playbook to remove a device from  Quarantine from the CBC Device data table.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_dt.cbc_device_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">vmware_cbc_device_dt.cbc_device_quarantined</span> <span class="pre">equals</span> <span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Quarantine ON</p></td>
<td><p>Manual playbook to Quarantine a device from the CBC Device data table.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_dt.cbc_device_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">(vmware_cbc_device_dt.cbc_device_quarantined</span> <span class="pre">equals</span> <span class="pre">No</span> <span class="pre">OR</span> <span class="pre">vmware_cbc_device_dt.cbc_device_quarantined</span> <span class="pre">equals</span> <span class="pre">Unknown)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Refetch Device in Row</p></td>
<td><p>Get the device data on the device in this row and add to a new row in the data table.  Use to compare device query results over time.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Update Alert Workflow Data</p></td>
<td><p>Update the alert workflow information in VMware Carbon Black Cloud.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Update Case</p></td>
<td><p>Manual playbook to update a VMware Carbon Black Cloud case. Custom fields and comments are updated in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Update Case on Creation</p></td>
<td><p>Automatic playbook to update VMware Carbon Black Cloud case when the case is created. Custom fields, data tables and comments are updated in the SOAR case.</p></td>
<td><p>Automatic</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">object_added</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Update Device Row from Device</p></td>
<td><p>Automatic playbook to populate the columns of the CBC Device data table that from the devices endpoint. Note: Other columns of the CBC Device data table are populated from fields of the alert.</p></td>
<td><p>Automatic</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_device_dt.cbc_device_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">object_added</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Update Observations DT</p></td>
<td><p>Manual playbook to get the Observations of an alert and update the Observations data table.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Write Alert JSON to Note</p></td>
<td><p>Write the VMware Carbon Black Cloud alert JSON to an incident note in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>VMware CBC: Write Device JSON to Note</p></td>
<td><p>Write the VMware Carbon Black Cloud device JSON to an incident note in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>vmware_cbc_device_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VMware CBC: Write Observations JSON to Note</p></td>
<td><p>Write the VMware Carbon Black Cloud Observations of an alert JSON to an incident note in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.vmware_cbc_alert_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="id2">
<h2>Custom Layouts<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<!--
  Use this section to provide guidance on where the user should add any custom fields and data tables.
  You may wish to recommend a new incident tab.
  You should save a screenshot "custom_layouts.png" in the doc/screenshots directory and reference it here
-->
<ul>
<li><p>Import the Data Tables and Custom Fields like the screenshot below:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts34.png" /></p>
</li>
</ul>
</section>
<section id="data-table-cbc-device">
<h2>Data Table - CBC Device<a class="headerlink" href="#data-table-cbc-device" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-cbc-device" src="../_images/dt-cbc-device.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>vmware_cbc_device_dt</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Device ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>External IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_external_ip</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Internal IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_internal_ip</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Location</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_location</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>OS Version</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_os_version</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Policy</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_policy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Policy ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_policy_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Quarantined</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_quarantined</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Query Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_query_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sensor State</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_sensor_state</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Username</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_username</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-observations">
<h2>Data Table - Observations<a class="headerlink" href="#data-table-observations" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-observations" src="../_images/dt-observations.png" /></p>
<section id="id3">
<h3>API Name:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>vmware_cbc_observations_dt</p>
</section>
<section id="id4">
<h3>Columns:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Device Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>File Scan Result</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_file_scan_result</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Filemod Hash</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">filemod_hash</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Filemod Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_filemod_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Filemod Reputation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_filemod_reputation</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Query Date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_query_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-processes">
<h2>Data Table - Processes<a class="headerlink" href="#data-table-processes" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-processes" src="../_images/dt-processes.png" /></p>
<section id="id5">
<h3>API Name:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>vmware_cbc_processes_dt</p>
</section>
<section id="id6">
<h3>Columns:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CMD</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_cmd</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Device ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_device_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>PID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_pid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Process ID</p></td>
</tr>
<tr class="row-even"><td><p>Policy Action</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_policy_action</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Reputation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_effective_reputation</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Sha256</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_sha256</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Process type: Parent or Child</p></td>
</tr>
<tr class="row-even"><td><p>Username</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cbc_process_username</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CBC Alert ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>CBC Alert Link</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_link</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>CBC Alert Reason Code</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_reason_code</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>CBC Alert Type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_alert_type</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>CBC Attack Tactic</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_attack_tactic</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>CBC Determination</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_determination_value</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>CBC Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>CBC Threat ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_threat_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>CBC Workflow Closure Reason</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_workflow_closure_reason</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>CBC Workflow Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vmware_cbc_workflow_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section id="templates-for-soar-cases">
<h2>Templates for SOAR Cases<a class="headerlink" href="#templates-for-soar-cases" title="Link to this heading">¶</a></h2>
<p>It may necessary to modify the templates used to create or close SOAR cases based on a customer’s required custom fields. Below are the default templates used which can be copied, modified and used with app_config’s
<code class="docutils literal notranslate"><span class="pre">soar_create_case_template</span></code> and <code class="docutils literal notranslate"><span class="pre">soar_close_case_template</span></code> settings to override the default templates.</p>
<section id="soar-create-case-jinja">
<h3>soar_create_case.jinja<a class="headerlink" href="#soar-create-case-jinja" title="Link to this heading">¶</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">{</span>
<span class="x">  </span><span class="c">{# JINJA template for creating a new SOAR incident from an endpoint #}</span>
<span class="x">  </span><span class="c">{# See https://ibmresilient.github.io/resilient-python-api/pages/resilient-lib/resilient-lib.html#module-resilient_lib.components.templates_common</span>
<span class="c">     for details on available jinja methods. Examples for `soar_substitute` and more are included below.</span>
<span class="c">  #}</span>
<span class="x">  </span><span class="c">{# modify to specify your specific **data** fields #}</span>
<span class="x">  &quot;name&quot;: &quot;CBC Alert - </span><span class="cp">{{</span> <span class="nv">reason</span> <span class="o">|</span> <span class="nf">replace</span><span class="o">(</span><span class="s1">&#39;&quot;&#39;</span><span class="o">,</span> <span class="s1">&#39;\&#39;&#39;</span><span class="o">)</span> <span class="o">|</span> <span class="nf">replace</span><span class="o">(</span><span class="s1">&#39;\\&#39;</span><span class="o">,</span> <span class="s1">&#39;\\\\&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  &quot;description&quot;: &quot;Device: </span><span class="cp">{{</span> <span class="nv">device_name</span> <span class="o">|</span> <span class="nf">replace</span><span class="o">(</span><span class="s1">&#39;\\&#39;</span><span class="o">,</span> <span class="s1">&#39;\\\\&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&lt;br&gt;Alert type: </span><span class="cp">{{</span> <span class="nv">type</span> <span class="cp">}}</span><span class="x">&lt;br&gt;Reason Code: </span><span class="cp">{{</span> <span class="nv">reason_code</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  </span><span class="c">{# start_date cannot be after discovered_date #}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">start_date</span> <span class="o">=</span> <span class="nv">first_event_timestamp</span> <span class="k">if</span> <span class="nv">first_event_timestamp</span>  <span class="o">&lt;=</span> <span class="nv">detection_timestamp</span> <span class="k">else</span> <span class="nv">detection_timestamp</span> <span class="cp">%}</span>
<span class="x">  &quot;discovered_date&quot;: </span><span class="cp">{{</span> <span class="nv">detection_timestamp</span> <span class="o">|</span> <span class="nf">soar_datetimeformat</span><span class="o">(</span><span class="nv">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">,</span>
<span class="x">  &quot;start_date&quot;: </span><span class="cp">{{</span> <span class="nv">start_date</span> <span class="o">|</span> <span class="nf">soar_datetimeformat</span><span class="o">(</span><span class="nv">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">,</span>
<span class="x">  </span><span class="c">{# if alert users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
<span class="x">  </span><span class="c">{# &quot;owner_id&quot;: &quot;{{ **assignedTo** |soar_substitute(&#39;{&quot;Automation&quot;: &quot;soar_user1@example.com&quot;, &quot;default_user@example.com&quot;: &quot;soar_user2@example.com&quot;, &quot;DEFAULT&quot;: &quot;default_user@example.com&quot; }&#39;) }}&quot;, #}</span>
<span class="x">  &quot;plan_status&quot;: &quot;A&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">severity</span> <span class="o">&lt;</span> <span class="m">3</span> <span class="cp">%}</span>
<span class="x">    &quot;severity_code&quot;: &quot;Low&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">elif</span> <span class="nv">severity</span> <span class="o">&lt;</span> <span class="m">6</span><span class="cp">%}</span>
<span class="x">    &quot;severity_code&quot;: &quot;Medium&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">    &quot;severity_code&quot;: &quot;High&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">  </span><span class="c">{# specify your custom fields for your endpoint solution #}</span>
<span class="x">  &quot;properties&quot;: {</span>
<span class="x">    &quot;vmware_cbc_alert_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">id</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_alert_link&quot;: &quot;&lt;a target=&#39;_blank&#39; href=&#39;https://</span><span class="cp">{{</span> <span class="nv">alert_url.replace</span><span class="o">(</span><span class="s2">&quot;[&quot;</span><span class="o">,</span> <span class="s2">&quot;%5B&quot;</span><span class="o">)</span><span class="nv">.replace</span><span class="o">(</span><span class="s2">&quot;]&quot;</span><span class="o">,</span> <span class="s2">&quot;%5D&quot;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&#39;&gt;Link&lt;/a&gt;&quot;</span>
<span class="x">  }</span>
<span class="x">}</span>
</pre></div>
</div>
</section>
<section id="soar-close-case-jinja">
<h3>soar_close_case.jinja<a class="headerlink" href="#soar-close-case-jinja" title="Link to this heading">¶</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">{</span>
<span class="x">  </span><span class="c">{# JINJA template for closing a SOAR incident using endpoint data #}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">closure_reason_mapping</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{</span>
<span class="s1">    &quot;NO_REASON&quot;: &quot;Resolved&quot;, </span>
<span class="s1">    &quot;RESOLVED&quot;: &quot;Resolved&quot;,</span>
<span class="s1">    &quot;RESOLVED_BENIGN_KNOWN_GOOD&quot;: &quot;Resolved&quot;, </span>
<span class="s1">    &quot;DUPLICATE_CLEANUP&quot;: &quot;Duplicate&quot;,</span>
<span class="s1">    &quot;OTHER&quot;: &quot;Not an Issue&quot;</span>
<span class="s1">  }&#39;&#39;&#39;</span>
  <span class="cp">%}</span>
<span class="x">  &quot;plan_status&quot;: &quot;C&quot;,</span>
<span class="x">  &quot;resolution_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">workflow.closure_reason</span> <span class="o">|</span> <span class="nf">soar_substitute</span><span class="o">(</span><span class="nv">closure_reason_mapping</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  &quot;resolution_summary&quot;: &quot;Closed by VMware Carbon Black Cloud, Alert Determination: </span><span class="cp">{{</span> <span class="nv">determination.value.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)|</span><span class="nf">title</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">  </span><span class="c">{# add additional fields based on your &#39;on close&#39; field requirements #}</span>
<span class="x">  ,&quot;properties&quot;: {</span>
<span class="x">    &quot;vmware_cbc_workflow_status&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">workflow.status.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)|</span><span class="nf">title</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_workflow_closure_reason&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">workflow.closure_reason.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)|</span><span class="nf">title</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_determination_value&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">determination.value.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)|</span><span class="nf">title</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">  }</span>
<span class="x">}</span>
</pre></div>
</div>
</section>
<section id="soar-update-case-jinja">
<h3>soar_update_case.jinja<a class="headerlink" href="#soar-update-case-jinja" title="Link to this heading">¶</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">{</span>
<span class="x">  </span><span class="c">{# JINJA template for updating a new SOAR incident from an endpoint #}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">severity</span> <span class="o">&lt;</span> <span class="m">3</span> <span class="cp">%}</span>
<span class="x">    &quot;severity_code&quot;: &quot;Low&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">elif</span> <span class="nv">severity</span> <span class="o">&lt;</span> <span class="m">6</span><span class="cp">%}</span>
<span class="x">    &quot;severity_code&quot;: &quot;Medium&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
<span class="x">    &quot;severity_code&quot;: &quot;High&quot;,</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">  </span><span class="c">{# specify your custom fields for your endpoint solution #}</span>
<span class="x">  &quot;properties&quot;: {</span>
<span class="x">    &quot;vmware_cbc_alert_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">id</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_alert_type&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">type</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_alert_reason_code&quot; : &quot;</span><span class="cp">{{</span> <span class="nv">reason_code</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_alert_link&quot;: &quot;&lt;a target=&#39;_blank&#39; href=&#39;https://</span><span class="cp">{{</span> <span class="nv">alert_url.replace</span><span class="o">(</span><span class="s2">&quot;[&quot;</span><span class="o">,</span> <span class="s2">&quot;%5B&quot;</span><span class="o">)</span><span class="nv">.replace</span><span class="o">(</span><span class="s2">&quot;]&quot;</span><span class="o">,</span> <span class="s2">&quot;%5D&quot;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&#39;&gt;Link&lt;/a&gt;&quot;,</span>
<span class="x">    &quot;vmware_cbc_attack_tactic&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">attack_tactic</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_threat_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">threat_id</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_workflow_status&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">workflow.status.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)</span> <span class="o">|</span><span class="nf">lower</span><span class="o">|</span><span class="nf">title</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_workflow_closure_reason&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">workflow.closure_reason.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)</span> <span class="o">|</span><span class="nf">lower</span><span class="o">|</span><span class="nf">title</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;vmware_cbc_determination_value&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">determination.value.replace</span><span class="o">(</span><span class="s1">&#39;_&#39;</span><span class="o">,</span> <span class="s1">&#39; &#39;</span><span class="o">)</span> <span class="o">|</span><span class="nf">lower</span><span class="o">|</span><span class="nf">title</span><span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">tags</span> <span class="cp">%}</span>
<span class="x">    ,&quot;vmware_cbc_tags&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">tags</span> <span class="o">|</span> <span class="nf">join</span><span class="o">(</span><span class="s1">&#39;, &#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">  }</span>
<span class="x">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is an IBM supported app. Please search <a class="reference external" href="https://ibm.com/mysupport">ibm.com/mysupport</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_aws_iam/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">AWS IAM</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_siemplify/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Siemplify</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">VMware Carbon Black Cloud</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#vmware-carbon-black-cloud-development-version">VMware Carbon Black Cloud Development Version</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#permissions">Permissions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id1"></a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
<li><a class="reference internal" href="#poller-considerations">Poller Considerations</a><ul>
<li><a class="reference internal" href="#poller-templates-for-soar-cases">Poller Templates for SOAR Cases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alert-filtering">Alert Filtering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#similar-to-alert-search-criteria-a-search-alert-exclusions-filter-can-be-specified-for-each-polling-filter-criteria-1-2-3">Similar to alert search “criteria”, a search alert “exclusions” filter can be specified for each polling_filter_criteria_(1,2,3).</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-get-alert-by-id">Function - VMware CBC: Get Alert By ID</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-get-cbc-notes">Function - VMware CBC: Get CBC Notes</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-get-device-by-id">Function - VMware CBC: Get Device By ID</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-post-alert-workflow-data">Function - VMware CBC: Post Alert Workflow Data</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-post-device-action">Function - VMware CBC: Post Device Action</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-post-note-to-cbc-alert">Function - VMware CBC: Post Note to CBC Alert</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-post-observations-detail-job">Function - VMware CBC: Post Observations Detail Job</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-post-reputation-override">Function - VMware CBC: Post Reputation Override</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-post-tags">Function - VMware CBC: Post Tags</a></li>
<li><a class="reference internal" href="#function-vmware-cbc-kill-process">Function - VMware: CBC Kill Process</a></li>
<li><a class="reference internal" href="#script-convert-json-to-rich-text-v1-3">Script - Convert JSON to rich text v1.3</a></li>
<li><a class="reference internal" href="#script-vmware-cbc-populate-cbc-device-row-from-alert">Script - VMware CBC: Populate CBC Device Row from Alert</a></li>
<li><a class="reference internal" href="#script-vmware-cbc-populate-cbc-device-row-from-device">Script - VMware CBC: Populate CBC Device Row from Device</a></li>
<li><a class="reference internal" href="#script-vmware-cbc-populate-observations-data-table">Script - VMware CBC: Populate Observations Data Table</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#id2">Custom Layouts</a></li>
<li><a class="reference internal" href="#data-table-cbc-device">Data Table - CBC Device</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-observations">Data Table - Observations</a><ul>
<li><a class="reference internal" href="#id3">API Name:</a></li>
<li><a class="reference internal" href="#id4">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-processes">Data Table - Processes</a><ul>
<li><a class="reference internal" href="#id5">API Name:</a></li>
<li><a class="reference internal" href="#id6">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#templates-for-soar-cases">Templates for SOAR Cases</a><ul>
<li><a class="reference internal" href="#soar-create-case-jinja">soar_create_case.jinja</a></li>
<li><a class="reference internal" href="#soar-close-case-jinja">soar_close_case.jinja</a></li>
<li><a class="reference internal" href="#soar-update-case-jinja">soar_update_case.jinja</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>