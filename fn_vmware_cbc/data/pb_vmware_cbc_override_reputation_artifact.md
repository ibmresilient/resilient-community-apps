<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Playbook - VMware CBC: Override Reputation Artifact

### API Name
`vmware_cbc_override_reputation_artifact`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type equals Malware SHA-256 Hash AND incident.properties.vmware_cbc_alert_id has_a_value`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Description | `vmware_cbc_description` | text |  Justification for override | Optional |
| Override List | `vmware_cbc_override_list` | select | Override list to add the SHA256 artifact | Always |

### Object Type
`artifact`

### Description
Override reputation of a SHA256 hash from a SHA256 artifact. 


---
## Function - VMware CBC: Post Reputation Override

### API Name
`vmware_cbc_post_reputation_override`

### Output Name
`override_reputation_results`

### Message Destination
`vmware_carbon_black_cloud`

### Function-Input Script
```python
from json import dumps

override_list = playbook.inputs.vmware_cbc_override_list
description = playbook.inputs.vmware_cbc_description if playbook.inputs.vmware_cbc_description else None

reputation = {
  "override_list": override_list,
  "override_type": "SHA256",
  "sha256_hash": artifact.value,
  "description": description
}

inputs.vmware_cbc_reputation_override = dumps(reputation)
```

---

## Local script - VMware CBC: Write override reputation results to a note

### Description
Write the results of override reputation function results to a note.

### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
from json import dumps

results = playbook.functions.results.override_reputation_results

reason = results.get("reason")
if results.get("success"):
    content = results.get("content")
    if content:
        note_text = "<b>VMware CBC: Override Reputation Artifact:</b><br>  {0}.".format(dumps(content, indent=4))
    else:
        note_text = f"<b>VMware CBC: Override Reputation Artifact:</b> failed to post override_reputation - no content: {reason}."
else:

    note_text = f"<b>VMware CBC: Override Reputation Artifact:</b> failed to post override reputation: {reason}."
  
incident.addNote(note_text)
```

---

