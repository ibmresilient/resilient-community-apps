<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Playbook - VMware CBC: Override Reputation

### API Name
`vmware_cbc_override_reputation`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Description | `vmware_cbc_description` | text |  Justification for override | Optional |
| Override List | `vmware_cbc_override_list` | select |  The override list to add a new reputation | Always |

### Object Type
`vmware_cbc_processes_dt`

### Description
Override reputation of a SHA256 hash from the Processes data table row.


---
## Function - VMware CBC: Post Reputation Override

### API Name
`vmware_cbc_post_reputation_override`

### Output Name
`override_reputation_results`

### Message Destination
`vmware_carbon_black_cloud`

### Function-Input Script
```python
from json import dumps

if not row.cbc_process_sha256:
  helper.fail("SHA256 is required to override reputation")

SHA256 = row.cbc_process_sha256

override_list = playbook.inputs.vmware_cbc_override_list
description = playbook.inputs.vmware_cbc_description if playbook.inputs.vmware_cbc_description else None
filename = row.cbc_process_name if row.cbc_process_name else None

reputation = {
  "override_list": override_list,
  "override_type": "SHA256",
  "sha256_hash": SHA256,
  "description": description,
  "filename": filename
}

inputs.vmware_cbc_reputation_override = dumps(reputation)
```

---

## Local script - VMware CBC: Override Reputation

### Description
Write results of function Override Reputation to a note.

### Script Type
`Local script`

### Object Type
`vmware_cbc_processes_dt`

### Script Content
```python
from json import dumps

results = playbook.functions.results.override_reputation_results

reason = results.get("reason")
if results.get("success"):
    content = results.get("content")
    if content:
        note_text = "<b>VMware CBC: Override Reputation:</b><br>  {0}.".format(dumps(content, indent=4))
    else:
        note_text = f"<b>VMware CBC: Override Reputation:</b> failed to post override_reputation - no content: {reason}."
else:

    note_text = f"<b>VMware CBC: Override Reputation:</b> failed to post override reputation: {reason}."
  
incident.addNote(note_text)
```

---

