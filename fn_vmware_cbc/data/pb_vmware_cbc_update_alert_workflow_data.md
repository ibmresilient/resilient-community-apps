<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Playbook - VMware CBC: Update Alert Workflow Data

### API Name
`vmware_cbc_update_alert_workflow_data`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Closure Reason | `vmware_cbc_closure_reason` | select | - | Optional |
| Determination | `vmware_cbc_determination` | select | - | Optional |
| Status | `vmware_cbc_status` | select | - | Optional |

### Object Type
`incident`

### Description
Update the alert workflow information in VMware Carbon Black Cloud.


---
## Function - VMware CBC: Post Alert Workflow Data

### API Name
`vmware_cbc_post_alert_workflow_data`

### Output Name
`post_workflow_data_results`

### Message Destination
`vmware_carbon_black_cloud`

### Function-Input Script
```python
inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id
inputs.vmware_cbc_determination = playbook.inputs.vmware_cbc_determination.upper().replace(" ", "_")  if playbook.inputs.vmware_cbc_determination is not None else None
status = playbook.inputs.vmware_cbc_status
inputs.vmware_cbc_status = status.upper().replace(" ", "_")  if status else None
if inputs.vmware_cbc_status == "CLOSED":
  if playbook.inputs.vmware_cbc_closure_reason is not None:
    inputs.vmware_cbc_closure_reason = playbook.inputs.vmware_cbc_closure_reason.upper().replace(" ", "_")
  else:
    inputs.vmware_cbc_closure_reason = incident.properties.vmware_cbc_workflow_closure_reason
else:
  inputs.vmware_cbc_closure_reason = None
inputs.vmware_cbc_note_text = None

if not inputs.vmware_cbc_determination and not inputs.vmware_cbc_status:
  helper.fail("Fill-in at least one workflow item to set!")

```

---

## Local script - VMware CBC: write results of workflow information update

### Description
Write results of function post alert workflow data to CBC to a SOAR note. 

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
results = playbook.functions.results.post_workflow_data_results

if results.get("success"):
    note_text = f"<b>VMware CBC Set Alert Workflow Data in CBC: </b> set:<br>"
    if playbook.inputs.vmware_cbc_determination:
        incident.properties.vmware_cbc_determination_value = playbook.inputs.vmware_cbc_determination
        note_text = f"{note_text}<br>   Determination:  {playbook.inputs.vmware_cbc_determination}"
    if playbook.inputs.vmware_cbc_status:
        incident.properties.vmware_cbc_workflow_status = playbook.inputs.vmware_cbc_status
        note_text = f"{note_text}<br>   Status:         {playbook.inputs.vmware_cbc_status}"
    if playbook.inputs.vmware_cbc_closure_reason and playbook.inputs.vmware_cbc_status == 'Closed':
        incident.properties.vmware_cbc_workflow_closure_reason = playbook.inputs.vmware_cbc_closure_reason
        note_text = f"{note_text}<br>   Closure Reason: {playbook.inputs.vmware_cbc_closure_reason}"
else:
    reason = results.get("reason")
    note_text = f"<b>VMware CBC: Set Alert Workflow Data:</b> failed:<br>  {reason}"
  
incident.addNote(note_text)


```

---

