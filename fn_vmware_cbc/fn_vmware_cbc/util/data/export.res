{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1719862293187,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_reputation_override",
      "hide_notification": false,
      "id": 450,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_reputation_override",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_reputation_override",
      "tooltip": "",
      "type_id": 11,
      "uuid": "899bf3ba-1c83-4d4a-b179-0d1ff6e97f0a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_closure_reason",
      "hide_notification": false,
      "id": 430,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_closure_reason",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_closure_reason",
      "tooltip": " Reason code for why the alert is being updated. Optional",
      "type_id": 11,
      "uuid": "8ba0b234-200d-4820-b2e2-f907498a849b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_threat_id",
      "hide_notification": false,
      "id": 441,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_threat_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_threat_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "9b423bfa-36d7-47ad-82c8-40db72515b13",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_device_action",
      "hide_notification": false,
      "id": 446,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_device_action",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_device_action",
      "tooltip": "",
      "type_id": 11,
      "uuid": "9f765556-4a19-4488-8ce3-994d124937b1",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_device_id",
      "hide_notification": false,
      "id": 445,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_device_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_device_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "b134c794-89da-41f3-be98-a506167a41a2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_incident_id",
      "hide_notification": false,
      "id": 399,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "b150c347-0413-4e4b-937f-8e4d8d2f58dd",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_device_toggle",
      "hide_notification": false,
      "id": 447,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_device_toggle",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_device_toggle",
      "tooltip": "",
      "type_id": 11,
      "uuid": "f8fcc6c7-7932-4633-8a98-46bda8bc35f8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_determination",
      "hide_notification": false,
      "id": 428,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_determination",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_determination",
      "tooltip": "",
      "type_id": 11,
      "uuid": "05114f80-8c06-47ab-a718-a36e060f0e06",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_id",
      "hide_notification": false,
      "id": 400,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_id",
      "tooltip": "Can be a CBC alert or threat ID",
      "type_id": 11,
      "uuid": "0774b27a-4a09-4711-a510-22ba4e6a24ee",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_status",
      "hide_notification": false,
      "id": 429,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_status",
      "tooltip": "Alert workflow status in CBC",
      "type_id": 11,
      "uuid": "143cbfc5-fe07-41b6-875a-b5a4ae9d706c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_note_type",
      "hide_notification": false,
      "id": 401,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_note_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_note_type",
      "tooltip": "",
      "type_id": 11,
      "uuid": "2dee3df7-f142-47c3-8221-b3da6f9ebe69",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_process_id",
      "hide_notification": false,
      "id": 460,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_process_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_process_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "340255e8-980c-4b7c-938f-47d7b03aeeb9",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_note_text",
      "hide_notification": false,
      "id": 431,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_note_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_note_text",
      "tooltip": " \tCustom message to add to the note added to modified alert",
      "type_id": 11,
      "uuid": "4ad5aac7-f23e-4b00-b112-e521ec254b9a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_observations",
      "hide_notification": false,
      "id": 469,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_observations",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_observations",
      "tooltip": "JSON value dumped to a string.",
      "type_id": 11,
      "uuid": "4f67a9d9-976a-4e4e-a916-e2f508a31a4f",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_alert_note_text",
      "hide_notification": false,
      "id": 427,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_alert_note_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "Note text body to send to CBC alert.",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_alert_note_text",
      "tooltip": "",
      "type_id": 11,
      "uuid": "51e1d722-ccb0-4821-9b85-cc626d65eb9d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_tags",
      "hide_notification": false,
      "id": 442,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_tags",
      "tooltip": "",
      "type_id": 11,
      "uuid": "59108d7b-d13b-41bb-9421-40c02d126cec",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/vmware_cbc_alert_id",
      "hide_notification": false,
      "id": 395,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_alert_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "vmware_cbc_alert_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "653c87e5-9465-427e-aeb6-8de5d2a8bc0a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_workflow_closure_reason",
      "hide_notification": false,
      "id": 435,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_workflow_closure_reason",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Workflow Closure Reason",
      "tooltip": "",
      "type_id": 0,
      "uuid": "da1055bc-b865-4c69-b47b-8f1fd5c263e2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_tags",
      "hide_notification": false,
      "id": 394,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Tags",
      "tooltip": "",
      "type_id": 0,
      "uuid": "db20831a-dbb6-4d2e-9b81-79bd9a2fa946",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_workflow_status",
      "hide_notification": false,
      "id": 397,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_workflow_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Workflow Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "e82da184-dcd1-4b3e-8539-2f346b33b02c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_alert_type",
      "hide_notification": false,
      "id": 451,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_alert_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Alert Type",
      "tooltip": "",
      "type_id": 0,
      "uuid": "e83064c4-308e-4335-9140-add916f73e04",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_threat_id",
      "hide_notification": false,
      "id": 393,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_threat_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Threat ID",
      "tooltip": "",
      "type_id": 0,
      "uuid": "1918be00-3f74-4ad7-91d9-b9422e8dd5fb",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_attack_tactic",
      "hide_notification": false,
      "id": 402,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_attack_tactic",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Attack Tactic",
      "tooltip": "",
      "type_id": 0,
      "uuid": "40cf6f8c-6851-45db-900d-dafe8636418b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_alert_id",
      "hide_notification": false,
      "id": 391,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_alert_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Alert ID",
      "tooltip": "",
      "type_id": 0,
      "uuid": "468d42f5-bb2b-4d06-b2b7-df38e6ff4b59",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_alert_reason_code",
      "hide_notification": false,
      "id": 452,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_alert_reason_code",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Alert Reason Code",
      "tooltip": "",
      "type_id": 0,
      "uuid": "52d4e802-9158-4f0c-a7e6-c48dcfaab506",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_determination_value",
      "hide_notification": false,
      "id": 396,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_determination_value",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Determination",
      "tooltip": "",
      "type_id": 0,
      "uuid": "57a3af87-11a5-485f-8f1a-c3c87a24c7ac",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/vmware_cbc_alert_link",
      "hide_notification": false,
      "id": 392,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "vmware_cbc_alert_link",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": true,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "CBC Alert Link",
      "tooltip": "",
      "type_id": 0,
      "uuid": "63092556-a9d7-4bef-8362-6b930af3b956",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1713462809178,
      "description": {
        "content": "Get the alert JSON from VMware Carbon Black Cloud by alert ID.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Get Alert By ID",
      "export_key": "vmware_cbc_get_alert_by_id",
      "id": 18,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1713463587739,
      "name": "vmware_cbc_get_alert_by_id",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "3835f131-ada7-4a21-b056-4006d2a69123",
      "version": 1,
      "view_items": [
        {
          "content": "653c87e5-9465-427e-aeb6-8de5d2a8bc0a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1713901601995,
      "description": {
        "content": "Get the alert or threat notes of the specified Carbon Black Cloud alert or threat id.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Get CBC Notes",
      "export_key": "vmware_cbc_get_cbc_notes",
      "id": 19,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1713988974616,
      "name": "vmware_cbc_get_cbc_notes",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "3bdf0aef-91a4-4508-b087-a72d2f8946f7",
      "version": 5,
      "view_items": [
        {
          "content": "b150c347-0413-4e4b-937f-8e4d8d2f58dd",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0774b27a-4a09-4711-a510-22ba4e6a24ee",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "2dee3df7-f142-47c3-8221-b3da6f9ebe69",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1715354873479,
      "description": {
        "content": "Get the device information from Carbon Black Cloud by the specified device ID.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Get Device By ID",
      "export_key": "vmware_cbc_get_device_by_id",
      "id": 23,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1715354873479,
      "name": "vmware_cbc_get_device_by_id",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "6ca7b730-fb28-4be2-8825-3ab7e0e398c2",
      "version": 0,
      "view_items": [
        {
          "content": "b134c794-89da-41f3-be98-a506167a41a2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1716322180616,
      "description": {
        "content": "Kill the process on the specified Carbon Black Cloud device, given the process ID (pid) on the device.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware: CBC Kill Process",
      "export_key": "vmware_cbc_kill_process",
      "id": 26,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1716327873830,
      "name": "vmware_cbc_kill_process",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "86bd953c-0ed7-46d3-861b-6ff14f1ae5c6",
      "version": 2,
      "view_items": [
        {
          "content": "b134c794-89da-41f3-be98-a506167a41a2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "340255e8-980c-4b7c-938f-47d7b03aeeb9",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1714483935283,
      "description": {
        "content": "Update the alert workflow information in VMware Carbon Black Cloud.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Post Alert Workflow Data",
      "export_key": "vmware_cbc_post_alert_workflow_data",
      "id": 21,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1714484092356,
      "name": "vmware_cbc_post_alert_workflow_data",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "6d45af39-58b1-4a3c-9ac6-9fbd26a6c15e",
      "version": 2,
      "view_items": [
        {
          "content": "653c87e5-9465-427e-aeb6-8de5d2a8bc0a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "8ba0b234-200d-4820-b2e2-f907498a849b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "05114f80-8c06-47ab-a718-a36e060f0e06",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "143cbfc5-fe07-41b6-875a-b5a4ae9d706c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4ad5aac7-f23e-4b00-b112-e521ec254b9a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1715366522813,
      "description": {
        "content": "Post an action to the device monitored by Carbon Black Cloud.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Post Device Action",
      "export_key": "vmware_cbc_post_device_action",
      "id": 24,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1715366568943,
      "name": "vmware_cbc_post_device_action",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "12d0ecab-6779-4af7-ba67-2d6572f01dcb",
      "version": 1,
      "view_items": [
        {
          "content": "b134c794-89da-41f3-be98-a506167a41a2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9f765556-4a19-4488-8ce3-994d124937b1",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f8fcc6c7-7932-4633-8a98-46bda8bc35f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1714160215814,
      "description": {
        "content": "Post a note to the specified Carbon Black Cloud alert in CBC.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Post Note to CBC Alert",
      "export_key": "vmware_cbc_post_note_to_cbc_alert",
      "id": 20,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718138490348,
      "name": "vmware_cbc_post_note_to_cbc_alert",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "9d51157a-d37b-4230-bb7d-3f2e0073d321",
      "version": 3,
      "view_items": [
        {
          "content": "653c87e5-9465-427e-aeb6-8de5d2a8bc0a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "51e1d722-ccb0-4821-9b85-cc626d65eb9d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1718634511950,
      "description": {
        "content": "Creates an Observations details job and returns the result of the job. The details include information about the given event that\u2019s not normally accessible during a search. The observations parameter is a JSON object converted to a string.  See the Carbon Black Cloud documentation on the Observation Detail Job: Create Detail Job request body.  The full JSON is defined :\n{\n  \"alert_id\": \"\u003cstring\u003e\",\n  \"observation_ids\": [\"\u003cstring\u003e\"],\n  \"process_hash\": \"\u003cstring\u003e\",\n  \"device_id\": \u003cinteger\u003e,\n  \"count_unique_devices\": \u003cboolean\u003e,\n  \"max_rows\": \u003cinteger\u003e\n}",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Post Observations Detail Job",
      "export_key": "vmware_cbc_post_observations_detail_job",
      "id": 27,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718657289239,
      "name": "vmware_cbc_post_observations_detail_job",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "61ed2b9f-4de2-4489-8e34-5238a2a53867",
      "version": 3,
      "view_items": [
        {
          "content": "4f67a9d9-976a-4e4e-a916-e2f508a31a4f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1715717278046,
      "description": {
        "content": "Override the reputation of an application by adding a SHA-256 hash, a certificate signer or a path to a known IT tool application or directory of IT tools to an Approved or Banned list. The reputation override parameter is a JSON object converted to a string. See the Carbon Black Cloud documentation on Configure Reputation Override.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Post Reputation Override",
      "export_key": "vmware_cbc_post_reputation_override",
      "id": 25,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718657822734,
      "name": "vmware_cbc_post_reputation_override",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "c3ac9716-7119-47a0-8239-010c2f498cd6",
      "version": 3,
      "view_items": [
        {
          "content": "899bf3ba-1c83-4d4a-b179-0d1ff6e97f0a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1715278362996,
      "description": {
        "content": "Post a list of tags to a CBC alert.",
        "format": "text"
      },
      "destination_handle": "vmware_carbon_black_cloud",
      "display_name": "VMware CBC: Post Tags",
      "export_key": "vmware_cbc_post_tags",
      "id": 22,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1715278524650,
      "name": "vmware_cbc_post_tags",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "f46ee389-9bd8-43c0-929e-fef29a8e2b3b",
      "version": 1,
      "view_items": [
        {
          "content": "9b423bfa-36d7-47ad-82c8-40db72515b13",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "59108d7b-d13b-41bb-9421-40c02d126cec",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 293,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1719862291195,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1719862291195,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "ad261c1f-f1cc-4115-bbce-a151f88bac5e"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "vmware_carbon_black_cloud",
      "name": "VMware Carbon Black Cloud",
      "programmatic_name": "vmware_carbon_black_cloud",
      "tags": [],
      "users": [
        "admin@example.com"
      ],
      "uuid": "db301dcc-9359-40fc-aee1-803f727d8f0f"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 12,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_ececdc0d_2e87_455a_a989_3d94573bc95e\" isExecutable=\"true\" name=\"playbook_ececdc0d_2e87_455a_a989_3d94573bc95e\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0bpcwuv\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Device Action\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"12d0ecab-6779-4af7-ba67-2d6572f01dcb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_device_action = \\\"BACKGROUND_SCAN\\\"\\ninputs.vmware_cbc_device_toggle = \\\"OFF\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_device_action_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0bpcwuv\u003c/incoming\u003e\u003coutgoing\u003eFlow_090qysz\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0bpcwuv\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_015cxmy\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Background Scan OFF\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"b25f53f9-e4b6-488c-b97f-4fc446364592\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_090qysz\u003c/incoming\u003e\u003coutgoing\u003eFlow_1qo6xlt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_090qysz\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1qo6xlt\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_4\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1qo6xlt\u003c/incoming\u003e\u003coutgoing\u003eFlow_080i23n\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_080i23n\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_080i23n\u003c/incoming\u003e\u003coutgoing\u003eFlow_015cxmy\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_015cxmy\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_ececdc0d_2e87_455a_a989_3d94573bc95e\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_015cxmy\" id=\"Flow_015cxmy_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"622\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"664\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_080i23n\" id=\"Flow_080i23n_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"538\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1qo6xlt\" id=\"Flow_1qo6xlt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_090qysz\" id=\"Flow_090qysz_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0bpcwuv\" id=\"Flow_0bpcwuv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"664\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"538\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718112554145,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_ececdc0d_2e87_455a_a989_3d94573bc95e",
      "description": {
        "content": "Manual playbook to turn off background scan on a device from the CBC Device data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Background Scan OFF",
      "export_key": "vmware_cbc_background_scan_off",
      "field_type_handle": "playbook_ececdc0d_2e87_455a_a989_3d94573bc95e",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Background Scan OFF",
        "export_key": "playbook_ececdc0d_2e87_455a_a989_3d94573bc95e",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_ececdc0d_2e87_455a_a989_3d94573bc95e",
        "uuid": "4f125f27-f775-48e7-889d-3e0b659990da"
      },
      "has_logical_errors": false,
      "id": 59,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1719856961933,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718112554342,
          "description": "Write the results of post action to device to the Device data table and to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Background Scan OFF",
          "id": 83,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1719856903648,
          "name": "VMware CBC: Background Scan OFF",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_background_scan_off",
          "programmatic_name": "vmware_cbc_background_scan_off_vmware_cbc_background_scan_on_copy_vmware_cbc_write_enable_background_scan_results_to_data_table",
          "script_text": "results = playbook.functions.results.post_device_action_results\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC: Background Scan OFF:\u003c/b\u003e Post action BACKGROUND_SCAN OFF successful.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: Background Scan OFF:\u003c/b\u003e Failed to post action BACKGROUND_SCAN OFF: {reason}.\"\nincident.addNote(note_text)",
          "tags": [],
          "uuid": "b25f53f9-e4b6-488c-b97f-4fc446364592"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_background_scan_off",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_ececdc0d-2e87-455a-a989-3d94573bc95e",
        "id": 61,
        "name": "playbook_ececdc0d-2e87-455a-a989-3d94573bc95e",
        "type": "playbook",
        "uuid": "0dc4bea7-0f6d-4051-9099-726844626096"
      },
      "tags": [],
      "type": "default",
      "uuid": "ececdc0d-2e87-455a-a989-3d94573bc95e",
      "version": 15
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 16,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_8565af05_501d_4818_88b2_c0b4666fc0ec\" isExecutable=\"true\" name=\"playbook_8565af05_501d_4818_88b2_c0b4666fc0ec\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0bpcwuv\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Device Action\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"12d0ecab-6779-4af7-ba67-2d6572f01dcb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_device_action = \\\"BACKGROUND_SCAN\\\"\\ninputs.vmware_cbc_device_toggle = \\\"ON\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_device_action_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0bpcwuv\u003c/incoming\u003e\u003coutgoing\u003eFlow_090qysz\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0bpcwuv\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0rui1c8\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Background Scan ON\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"e2602c7b-ca75-45a4-bf50-2de6f1d83b73\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_090qysz\u003c/incoming\u003e\u003coutgoing\u003eFlow_1qo6xlt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_090qysz\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1qo6xlt\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_4\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1qo6xlt\u003c/incoming\u003e\u003coutgoing\u003eFlow_09wjmfs\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_09wjmfs\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_09wjmfs\u003c/incoming\u003e\u003coutgoing\u003eFlow_0rui1c8\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0rui1c8\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_8565af05_501d_4818_88b2_c0b4666fc0ec\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0rui1c8\" id=\"Flow_0rui1c8_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"622\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"674\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_09wjmfs\" id=\"Flow_09wjmfs_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"502\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"538\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1qo6xlt\" id=\"Flow_1qo6xlt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"418\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_090qysz\" id=\"Flow_090qysz_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0bpcwuv\" id=\"Flow_0bpcwuv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"674\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"418\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"538\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718111271817,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_8565af05_501d_4818_88b2_c0b4666fc0ec",
      "description": {
        "content": "Manual playbook to enable background scan on a device from the CBC Device data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Background Scan ON",
      "export_key": "vmware_cbc_background_scan_on",
      "field_type_handle": "playbook_8565af05_501d_4818_88b2_c0b4666fc0ec",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Background Scan ON",
        "export_key": "playbook_8565af05_501d_4818_88b2_c0b4666fc0ec",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_8565af05_501d_4818_88b2_c0b4666fc0ec",
        "uuid": "838df49c-deb9-47ba-a14d-b450bc18acd5"
      },
      "has_logical_errors": false,
      "id": 57,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1719857039920,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718111455157,
          "description": "Write the results of post action to device to the Device data table and to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Background Scan ON",
          "id": 81,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1719857020313,
          "name": "VMware CBC: Background Scan ON",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_background_scan_on",
          "programmatic_name": "vmware_cbc_background_scan_on_vmware_cbc_write_enable_background_scan_results_to_data_table",
          "script_text": "results = playbook.functions.results.post_device_action_results\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC: Background Scan ON:\u003c/b\u003e Post action BACKGROUND_SCAN ON successful.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: Background Scan ON:\u003c/b\u003e Failed to post action BACKGROUND_SCAN ON: {reason}.\"\nincident.addNote(note_text)",
          "tags": [],
          "uuid": "e2602c7b-ca75-45a4-bf50-2de6f1d83b73"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_background_scan_on",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_8565af05-501d-4818-88b2-c0b4666fc0ec",
        "id": 59,
        "name": "playbook_8565af05_501d_4818_88b2_c0b4666fc0ec",
        "type": "playbook",
        "uuid": "a5f35c22-9832-4c13-902f-848a39a1ae1b"
      },
      "tags": [],
      "type": "default",
      "uuid": "8565af05-501d-4818-88b2-c0b4666fc0ec",
      "version": 19
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 10,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d\" isExecutable=\"true\" name=\"playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_07l8xe9\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Device Action\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"12d0ecab-6779-4af7-ba67-2d6572f01dcb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_device_action = \\\"BYPASS\\\"\\ninputs.vmware_cbc_device_toggle = \\\"OFF\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_device_action_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_07l8xe9\u003c/incoming\u003e\u003coutgoing\u003eFlow_0a92rx0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_07l8xe9\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0o90smh\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: BYPASS Device OFF\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"e0555115-2ab1-49c1-a72d-e9661d1dd107\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0a92rx0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uocsgf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0a92rx0\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0uocsgf\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1qr3o1e\u003c/incoming\u003e\u003coutgoing\u003eFlow_0o90smh\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0o90smh\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uocsgf\u003c/incoming\u003e\u003coutgoing\u003eFlow_1qr3o1e\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1qr3o1e\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uocsgf\" id=\"Flow_0uocsgf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0a92rx0\" id=\"Flow_0a92rx0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_07l8xe9\" id=\"Flow_07l8xe9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0o90smh\" id=\"Flow_0o90smh_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"582\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"624\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1qr3o1e\" id=\"Flow_1qr3o1e_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"498\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"624\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"498\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718054347652,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d",
      "description": {
        "content": "Manual playbook to turn OFF BYPASS on the device from the CBC Device data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Bypass OFF",
      "export_key": "vmware_cbc_bypass_off",
      "field_type_handle": "playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d",
      "fields_type": {
        "actions": [],
        "display_name": "vmware_cbc_bypass_off",
        "export_key": "playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_6e937623_7e9b_44a4_b11b_8ada0cd4996d",
        "uuid": "8f0d7e74-0caa-4bd8-82da-951979639432"
      },
      "has_logical_errors": false,
      "id": 53,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718114005615,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718054347842,
          "description": "Write results of post action to  device function to a note.",
          "enabled": false,
          "export_key": "VMware CBC: BYPASS Device OFF",
          "id": 77,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718113105616,
          "name": "VMware CBC: BYPASS Device OFF",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_bypass_off",
          "programmatic_name": "vmware_cbc_bypass_off_vmware_bypass_on_copy_vmware_cbc_bypass_device_on",
          "script_text": "results = playbook.functions.results.post_device_action_results\n\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC: BYPASS OFF:\u003c/b\u003e Post action BYPASS OFF successful.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: BYPASS OFF:\u003c/b\u003e Failed to post action BYPASS OFF: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "e0555115-2ab1-49c1-a72d-e9661d1dd107"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_status",
              "method": "contains",
              "type": null,
              "value": "BYPASS"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_bypass_off",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_6e937623-7e9b-44a4-b11b-8ada0cd4996d",
        "id": 55,
        "name": "playbook_6e937623-7e9b-44a4-b11b-8ada0cd4996d",
        "type": "playbook",
        "uuid": "df9d2f77-dc89-44c4-9a78-9c720fc67a18"
      },
      "tags": [],
      "type": "default",
      "uuid": "6e937623-7e9b-44a4-b11b-8ada0cd4996d",
      "version": 14
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_c98ef12e_5373_4db7_9781_c80736d32e4c\" isExecutable=\"true\" name=\"playbook_c98ef12e_5373_4db7_9781_c80736d32e4c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_07l8xe9\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Device Action\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"12d0ecab-6779-4af7-ba67-2d6572f01dcb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_device_action = \\\"BYPASS\\\"\\ninputs.vmware_cbc_device_toggle = \\\"ON\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_device_action_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_07l8xe9\u003c/incoming\u003e\u003coutgoing\u003eFlow_0a92rx0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_07l8xe9\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0qfefft\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Bypass Device ON\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"ab6070c9-6ca3-44ff-bbd4-8671029ce27b\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0a92rx0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uocsgf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0a92rx0\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0uocsgf\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_139lteh\u003c/incoming\u003e\u003coutgoing\u003eFlow_0qfefft\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0qfefft\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uocsgf\u003c/incoming\u003e\u003coutgoing\u003eFlow_139lteh\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_139lteh\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_c98ef12e_5373_4db7_9781_c80736d32e4c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uocsgf\" id=\"Flow_0uocsgf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0a92rx0\" id=\"Flow_0a92rx0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_07l8xe9\" id=\"Flow_07l8xe9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0qfefft\" id=\"Flow_0qfefft_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"582\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"614\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_139lteh\" id=\"Flow_139lteh_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"498\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"614\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"498\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718054499840,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_c98ef12e_5373_4db7_9781_c80736d32e4c",
      "description": {
        "content": "Manual playbook to turn ON BYPASS on the device from the CBC Device data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Bypass ON",
      "export_key": "vmware_cbc_bypass_on",
      "field_type_handle": "playbook_c98ef12e_5373_4db7_9781_c80736d32e4c",
      "fields_type": {
        "actions": [],
        "display_name": "vmware_cbc_bypass_on",
        "export_key": "playbook_c98ef12e_5373_4db7_9781_c80736d32e4c",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_c98ef12e_5373_4db7_9781_c80736d32e4c",
        "uuid": "7fe6fe76-99fa-4c74-a3e6-088339a08474"
      },
      "has_logical_errors": false,
      "id": 54,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718114096519,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718054500005,
          "description": "Write results of post action to  device function to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Bypass Device ON",
          "id": 78,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718113141112,
          "name": "VMware CBC: Bypass Device ON",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_bypass_on",
          "programmatic_name": "vmware_cbc_bypass_on_vmware_bypass_on_vmware_cbc_quarantine_device_on",
          "script_text": "results = playbook.functions.results.post_device_action_results\n\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC: BYPASS ON:\u003c/b\u003e Post action BYPASS ON successful.\"\n    row.cbc_device_status = \"BYPASS\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: BYPASS ON:\u003c/b\u003e Failed to post action BYPASS ON: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "ab6070c9-6ca3-44ff-bbd4-8671029ce27b"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_status",
              "method": "not_contains",
              "type": null,
              "value": "BYPASS"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_bypass_on",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_c98ef12e-5373-4db7-9781-c80736d32e4c",
        "id": 56,
        "name": "playbook_c98ef12e-5373-4db7-9781-c80736d32e4c",
        "type": "playbook",
        "uuid": "86894ef3-58d7-4389-8e4a-52a470dc7666"
      },
      "tags": [],
      "type": "default",
      "uuid": "c98ef12e-5373-4db7-9781-c80736d32e4c",
      "version": 11
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_id",
              "method": "changed",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_summary",
              "method": "not_contains",
              "type": null,
              "value": "Closed by VMware Carbon Black Cloud"
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 24,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_63958e2a_f1bd_412d_9daf_946c3f388e90\" isExecutable=\"true\" name=\"playbook_63958e2a_f1bd_412d_9daf_946c3f388e90\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1xx0bud\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Alert Workflow Data\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6d45af39-58b1-4a3c-9ac6-9fbd26a6c15e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"STATUS_MAPPING = {\\n  \\\"Unresolved\\\": \\\"CLOSED\\\",   # Unresolved\\n  \\\"Duplicate\\\": \\\"CLOSED\\\",    # Duplicate\\n  \\\"Not an Issue\\\": \\\"CLOSED\\\", # Not an Issue\\n  \\\"Resolved\\\": \\\"CLOSED\\\"      # Resolved\\n}\\n\\nCLOSURE_REASON_MAPPING = {\\n  \\\"Unresolved\\\": \\\"NO_REASON\\\",   # Unresolved\\n  \\\"Duplicate\\\": \\\"DUPLICATE_CLEANUP\\\",    # Duplicate\\n  \\\"Not an Issue\\\": \\\"RESOLVED_BENIGN_KNOWN_GOOD\\\", # Not an Issue\\n  \\\"Resolved\\\": \\\"RESOLVED\\\"      # Resolved\\n}\\n\\n\\ninputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\\ninputs.vmware_cbc_status = STATUS_MAPPING.get(incident.resolution_id, \\\"CLOSED\\\")\\ninputs.vmware_cbc_closure_reason = CLOSURE_REASON_MAPPING.get(incident.resolution_id, \\\"NO_REASON\\\")\\ninputs.vmware_cbc_note_text = incident.resolution_summary.content if incident.resolution_summary.content else f\\\"Case {incident.id} was closed in IBM QRadar SOAR\\\"\\n\\n# Note determination is set to the custom field value.  Make sure to set determination before closing the case in SOAR\\ninputs.vmware_cbc_determination = incident.properties.vmware_cbc_determination_value.replace(\\\" \\\", \\\"_\\\").upper() if incident.properties.vmware_cbc_determination_value else \\\"NONE\\\"\\n\\n# Set custom fields in SOAR with values sent to CBC.\\nincident.properties.vmware_cbc_workflow_status = inputs.vmware_cbc_status\\nif incident.properties.vmware_cbc_workflow_status == \\\"CLOSED\\\" and inputs.vmware_cbc_closure_reason:\\n  incident.properties.vmware_cbc_workflow_closure_reason = inputs.vmware_cbc_closure_reason.replace(\\\" \\\", \\\"_\\\").title()\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"close_alert_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1xx0bud\u003c/incoming\u003e\u003coutgoing\u003eFlow_1x9lbva\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1xx0bud\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMware CBC: Write Close Alert on Case Close Results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"0a565527-cff0-487e-bf59-460a15f4fc0b\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1x9lbva\u003c/incoming\u003e\u003coutgoing\u003eFlow_0fc3cgh\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1x9lbva\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0fc3cgh\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0fc3cgh\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_63958e2a_f1bd_412d_9daf_946c3f388e90\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0fc3cgh\" id=\"Flow_0fc3cgh_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1x9lbva\" id=\"Flow_1x9lbva_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1xx0bud\" id=\"Flow_1xx0bud_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1714497391667,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_63958e2a_f1bd_412d_9daf_946c3f388e90",
      "description": {
        "content": "Automatic playbook that updates the Workflow Status and Determination of the associated alert in VMware Carbon Black Cloud when the case is closed in SOAR.  The SOAR case resolution summary is written as a note to the Carbon Black Cloud alert.",
        "format": "text"
      },
      "display_name": "VMware CBC: Close Alert on Case Close",
      "export_key": "vmware_cbc_close_alert_on_case_close",
      "field_type_handle": "playbook_63958e2a_f1bd_412d_9daf_946c3f388e90",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Close Alert on Case Close",
        "export_key": "playbook_63958e2a_f1bd_412d_9daf_946c3f388e90",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_63958e2a_f1bd_412d_9daf_946c3f388e90",
        "uuid": "236e03e2-4012-43bb-9f75-7873d86d8178"
      },
      "has_logical_errors": false,
      "id": 35,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1714761047693,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1714498553845,
          "description": "Write the results of updating workflow status and determination to alert in CBC.",
          "enabled": false,
          "export_key": "VMware CBC: Write Close Alert on Case Close Results",
          "id": 56,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1714760606082,
          "name": "VMware CBC: Write Close Alert on Case Close Results",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_close_alert_on_case_close",
          "programmatic_name": "vmware_cbc_close_alert_on_case_close_vmware_cbc_write_close_alert_on_case_close_results",
          "script_text": "results = playbook.functions.results.close_alert_results\n\nif results.get(\"success\"):\n  note_text = \"\u003cb\u003eVMware CBC: Close Alert on Case Close:\u003c/b\u003e Closed alert in Carbon Black Cloud.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = \"\u003cb\u003eVMware CBC: Close Alert on Case Close:\u003c/b\u003e Failed function to set status. Reason = {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "0a565527-cff0-487e-bf59-460a15f4fc0b"
        }
      ],
      "name": "vmware_cbc_close_alert_on_case_close",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_63958e2a-f1bd-412d-9daf-946c3f388e90",
        "id": 37,
        "name": "playbook_63958e2a_f1bd_412d_9daf_946c3f388e90",
        "type": "playbook",
        "uuid": "5787c76c-7bb7-4569-a312-34e7ce618dd3"
      },
      "tags": [],
      "type": "default",
      "uuid": "63958e2a-f1bd-412d-9daf-946c3f388e90",
      "version": 27
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 32,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_670cae7d_19f7_4502_9311_5419c38b3f5d\" isExecutable=\"true\" name=\"playbook_670cae7d_19f7_4502_9311_5419c38b3f5d\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_18c1lb0\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware: CBC Kill Process\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"86bd953c-0ed7-46d3-861b-6ff14f1ae5c6\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_process_id = row.cbc_process_pid\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"kill_process_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_18c1lb0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0fbgfzd\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_18c1lb0\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_00og0ir\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: write Kill Process results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"fbe61ec3-0653-4919-afa2-300d2ca5dbf0\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0fbgfzd\u003c/incoming\u003e\u003coutgoing\u003eFlow_00og0ir\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0fbgfzd\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_00og0ir\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_670cae7d_19f7_4502_9311_5419c38b3f5d\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_00og0ir\" id=\"Flow_00og0ir_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"404\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0fbgfzd\" id=\"Flow_0fbgfzd_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_18c1lb0\" id=\"Flow_18c1lb0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"404\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1716324546047,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_670cae7d_19f7_4502_9311_5419c38b3f5d",
      "description": {
        "content": "Kill the specified process from the row in the Processes data table.\nWrite the results to a note.",
        "format": "text"
      },
      "display_name": "VMware CBC: Kill Process",
      "export_key": "vmware_cbc_kill_process",
      "field_type_handle": "playbook_670cae7d_19f7_4502_9311_5419c38b3f5d",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Kill Process",
        "export_key": "playbook_670cae7d_19f7_4502_9311_5419c38b3f5d",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_670cae7d_19f7_4502_9311_5419c38b3f5d",
        "uuid": "2e1dde18-d4b5-4012-9f49-2ecff8571640"
      },
      "has_logical_errors": false,
      "id": 43,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1719417217186,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1716324829493,
          "description": "Write the results of the function to kill a process on a device to a note.",
          "enabled": false,
          "export_key": "VMware CBC: write Kill Process results to a note",
          "id": 66,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1719417213797,
          "name": "VMware CBC: write Kill Process results to a note",
          "object_type": "vmware_cbc_processes_dt",
          "playbook_handle": "vmware_cbc_kill_process",
          "programmatic_name": "vmware_cbc_kill_process_vmware_cbc_write_kill_process_results_to_a_note",
          "script_text": "results = playbook.functions.results.kill_process_results\n\nreason = results.get(\"reason\", None)\ninputs = results.get(\"inputs\", None)\npid = inputs.get(\"vmware_cbc_process_id\") if inputs else None\n\nif results.get(\"success\"):\n    content = results.get(\"content\", None)\n    if content:\n        result = content.get(\"result\", None)\n        if result:\n          status = result.get(\"status\", None)\n          result_code = result.get(\"result_code\", None)\n          if status == \"COMPLETE\" and result_code == 0:\n              note_text = f\"\u003cb\u003eVMware CBC: Kill Process:\u003c/b\u003e  PID: {pid} was terminated:\u003cbr\u003e{result}.\"\n          else:\n              note_text = f\"\u003cb\u003eVMware CBC: Kill Process:\u003c/b\u003e  ERROR: PID: {pid} was not terminated:\u003cbr\u003e{result}\u003cbr\u003e{reason}.\"\n        else:\n            note_text = f\"\u003cb\u003eVMware CBC: Kill Process:\u003c/b\u003e Failed to kill PID {pid} - no result: {reason}.\"\n    else:\n        note_text = f\"\u003cb\u003eVMware CBC: Kill Process:\u003c/b\u003e Failed to kill PID {pid} - no content: {reason}.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: Kill Process:\u003c/b\u003e Failed to kill PID {pid}: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "fbe61ec3-0653-4919-afa2-300d2ca5dbf0"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_kill_process",
      "object_type": "vmware_cbc_processes_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_670cae7d-19f7-4502-9311-5419c38b3f5d",
        "id": 45,
        "name": "playbook_670cae7d_19f7_4502_9311_5419c38b3f5d",
        "type": "playbook",
        "uuid": "5612174b-5479-4aa3-97c5-5e8ab28e5b14"
      },
      "tags": [],
      "type": "default",
      "uuid": "670cae7d-19f7-4502-9311-5419c38b3f5d",
      "version": 36
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 18,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db\" isExecutable=\"true\" name=\"playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1eoagd3\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Reputation Override\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c3ac9716-7119-47a0-8239-010c2f498cd6\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n\\nif not row.cbc_process_sha256:\\n  helper.fail(\\\"SHA256 is required to override reputation\\\")\\n\\nSHA256 = row.cbc_process_sha256\\n\\noverride_list = playbook.inputs.vmware_cbc_override_list\\ndescription = playbook.inputs.vmware_cbc_description if playbook.inputs.vmware_cbc_description else None\\nfilename = row.cbc_process_name if row.cbc_process_name else None\\n\\nreputation = {\\n  \\\"override_list\\\": override_list,\\n  \\\"override_type\\\": \\\"SHA256\\\",\\n  \\\"sha256_hash\\\": SHA256,\\n  \\\"description\\\": description,\\n  \\\"filename\\\": filename\\n}\\n\\ninputs.vmware_cbc_reputation_override = dumps(reputation)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"override_reputation_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1eoagd3\u003c/incoming\u003e\u003coutgoing\u003eFlow_0en9gce\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1eoagd3\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMware CBC: Override Reputation\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"3202ba51-5705-45c6-b469-7f4eb98e8aed\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0en9gce\u003c/incoming\u003e\u003coutgoing\u003eFlow_08zzm6f\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0en9gce\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_08zzm6f\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_08zzm6f\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_08zzm6f\" id=\"Flow_08zzm6f_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0en9gce\" id=\"Flow_0en9gce_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1eoagd3\" id=\"Flow_1eoagd3_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1715717581771,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
      "description": {
        "content": "Override reputation of a SHA256 hash from the Processes data table row.",
        "format": "text"
      },
      "display_name": "VMware CBC: Override Reputation",
      "export_key": "vmware_cbc_override_reputation",
      "field_type_handle": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Override Reputation",
        "export_key": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
        "fields": {
          "vmware_cbc_description": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db/vmware_cbc_description",
            "hide_notification": false,
            "id": 453,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_description",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Description",
            "tooltip": " Justification for override",
            "type_id": 1045,
            "uuid": "b74730c9-38c0-46ad-bd4e-b15a680f5f97",
            "values": []
          },
          "vmware_cbc_override_list": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db/vmware_cbc_override_list",
            "hide_notification": false,
            "id": 454,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_override_list",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Override List",
            "tooltip": " The override list to add a new reputation",
            "type_id": 1045,
            "uuid": "3c649f74-c2eb-4027-a31c-da8602f41bc4",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "BLACK_LIST",
                "properties": null,
                "uuid": "5fb25c3c-d951-4600-a0cc-14fe19a7e63a",
                "value": 352
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "WHITE_LIST",
                "properties": null,
                "uuid": "cf73fb65-908c-443c-8584-9cddaf65165c",
                "value": 353
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
        "uuid": "42ac9d76-cafa-4ef9-b6a5-8fecff8c6996"
      },
      "has_logical_errors": false,
      "id": 41,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1717102867862,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1715717834630,
          "description": "Write results of function Override Reputation to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Override Reputation",
          "id": 64,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1717102864864,
          "name": "VMware CBC: Override Reputation",
          "object_type": "vmware_cbc_processes_dt",
          "playbook_handle": "vmware_cbc_override_reputation",
          "programmatic_name": "vmware_cbc_override_reputation_vmware_cbc_override_reputation",
          "script_text": "from json import dumps\n\nresults = playbook.functions.results.override_reputation_results\n\nreason = results.get(\"reason\")\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        note_text = \"\u003cb\u003eVMware CBC: Override Reputation:\u003c/b\u003e\u003cbr\u003e  {0}.\".format(dumps(content, indent=4))\n    else:\n        note_text = f\"\u003cb\u003eVMware CBC: Override Reputation:\u003c/b\u003e failed to post override_reputation - no content: {reason}.\"\nelse:\n\n    note_text = f\"\u003cb\u003eVMware CBC: Override Reputation:\u003c/b\u003e failed to post override reputation: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "3202ba51-5705-45c6-b469-7f4eb98e8aed"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "3c649f74-c2eb-4027-a31c-da8602f41bc4",
            "element": "field_uuid",
            "field_type": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "b74730c9-38c0-46ad-bd4e-b15a680f5f97",
            "element": "field_uuid",
            "field_type": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "vmware_cbc_override_reputation",
      "object_type": "vmware_cbc_processes_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_9d05305c-8dc8-455c-8234-5b0a69d5d4db",
        "id": 43,
        "name": "playbook_9d05305c_8dc8_455c_8234_5b0a69d5d4db",
        "type": "playbook",
        "uuid": "d136b795-9430-43aa-adc4-f95206ca1c16"
      },
      "tags": [],
      "type": "default",
      "uuid": "9d05305c-8dc8-455c-8234-5b0a69d5d4db",
      "version": 23
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125\" isExecutable=\"true\" name=\"playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_16e83kk\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Reputation Override\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c3ac9716-7119-47a0-8239-010c2f498cd6\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n\\noverride_list = playbook.inputs.vmware_cbc_override_list\\ndescription = playbook.inputs.vmware_cbc_description if playbook.inputs.vmware_cbc_description else None\\n\\nreputation = {\\n  \\\"override_list\\\": override_list,\\n  \\\"override_type\\\": \\\"SHA256\\\",\\n  \\\"sha256_hash\\\": artifact.value,\\n  \\\"description\\\": description\\n}\\n\\ninputs.vmware_cbc_reputation_override = dumps(reputation)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"override_reputation_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_16e83kk\u003c/incoming\u003e\u003coutgoing\u003eFlow_1n16a1b\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_16e83kk\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_19b32zi\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Write override reputation results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"1d743c09-a9e6-4d01-8c64-efff1bc9551d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1n16a1b\u003c/incoming\u003e\u003coutgoing\u003eFlow_19b32zi\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1n16a1b\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_19b32zi\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_19b32zi\" id=\"Flow_19b32zi_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"402\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1n16a1b\" id=\"Flow_1n16a1b_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"318\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_16e83kk\" id=\"Flow_16e83kk_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"146\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"94\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"317.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718307210923,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
      "description": {
        "content": "Override reputation of a SHA256 hash from a SHA256 artifact. ",
        "format": "text"
      },
      "display_name": "VMware CBC: Override Reputation Artifact",
      "export_key": "vmware_cbc_override_reputation_artifact",
      "field_type_handle": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Override Reputation Artifact",
        "export_key": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
        "fields": {
          "vmware_cbc_description": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125/vmware_cbc_description",
            "hide_notification": false,
            "id": 467,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_description",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Description",
            "tooltip": " Justification for override",
            "type_id": 1064,
            "uuid": "8854cfc3-8e48-452a-822b-251a88dbf7ab",
            "values": []
          },
          "vmware_cbc_override_list": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125/vmware_cbc_override_list",
            "hide_notification": false,
            "id": 468,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_override_list",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Override List",
            "tooltip": "Override list to add the SHA256 artifact",
            "type_id": 1064,
            "uuid": "5039d4a4-61dd-44b5-abef-25e05f2f424b",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "BLACK_LIST",
                "properties": null,
                "uuid": "1cadb7a6-4a01-42ff-beea-1dd0de693b24",
                "value": 402
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "WHITE_LIST",
                "properties": null,
                "uuid": "240060a1-1964-466e-a109-7f32c49cbda6",
                "value": 403
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
        "uuid": "ec8c0c15-a184-477c-a494-85a4089ac947"
      },
      "has_logical_errors": false,
      "id": 60,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718308923576,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718307747744,
          "description": "Write the results of override reputation function results to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Write override reputation results to a note",
          "id": 84,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718307957399,
          "name": "VMware CBC: Write override reputation results to a note",
          "object_type": "artifact",
          "playbook_handle": "vmware_cbc_override_reputation_artifact",
          "programmatic_name": "vmware_cbc_override_reputation_artifact_vmware_cbc_write_override_reputation_results_to_a_note",
          "script_text": "from json import dumps\n\nresults = playbook.functions.results.override_reputation_results\n\nreason = results.get(\"reason\")\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        note_text = \"\u003cb\u003eVMware CBC: Override Reputation Artifact:\u003c/b\u003e\u003cbr\u003e  {0}.\".format(dumps(content, indent=4))\n    else:\n        note_text = f\"\u003cb\u003eVMware CBC: Override Reputation Artifact:\u003c/b\u003e failed to post override_reputation - no content: {reason}.\"\nelse:\n\n    note_text = f\"\u003cb\u003eVMware CBC: Override Reputation Artifact:\u003c/b\u003e failed to post override reputation: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "1d743c09-a9e6-4d01-8c64-efff1bc9551d"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Malware SHA-256 Hash"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "5039d4a4-61dd-44b5-abef-25e05f2f424b",
            "element": "field_uuid",
            "field_type": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "8854cfc3-8e48-452a-822b-251a88dbf7ab",
            "element": "field_uuid",
            "field_type": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "vmware_cbc_override_reputation_artifact",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_8bbd4c26-01bc-4b79-9085-ab4736aff125",
        "id": 62,
        "name": "playbook_8bbd4c26_01bc_4b79_9085_ab4736aff125",
        "type": "playbook",
        "uuid": "7123ed9d-176b-4097-9ca0-f99c42911e2e"
      },
      "tags": [],
      "type": "default",
      "uuid": "8bbd4c26-01bc-4b79-9085-ab4736aff125",
      "version": 14
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae\" isExecutable=\"true\" name=\"playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_08zbktn\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Note to  CBC Alert\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"9d51157a-d37b-4230-bb7d-3f2e0073d321\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\\ninputs.vmware_cbc_alert_note_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_note_to_alert_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_08zbktn\u003c/incoming\u003e\u003coutgoing\u003eFlow_119h39j\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_08zbktn\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMare CBC: Write post note results to CBC to a note in SOAR\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"27e1ed35-587b-40c3-8974-110edd36303c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_119h39j\u003c/incoming\u003e\u003coutgoing\u003eFlow_0x574z7\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_119h39j\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0x574z7\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0x574z7\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0x574z7\" id=\"Flow_0x574z7_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"372\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"434\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_119h39j\" id=\"Flow_119h39j_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"288\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_08zbktn\" id=\"Flow_08zbktn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"288\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"434\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1714160686305,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae",
      "description": {
        "content": "Manual playbook to post a note to CBC alert in Carbon Black Cloud.",
        "format": "text"
      },
      "display_name": "VMware CBC: Post Note to CBC Alert",
      "export_key": "vmware_cbc_post_note_to_cbc_alert",
      "field_type_handle": "playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Post Note to CBC Alert",
        "export_key": "playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae",
        "uuid": "4ad5854b-b7a6-4244-ac89-79933be309b6"
      },
      "has_logical_errors": false,
      "id": 33,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1714163357869,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1714161034520,
          "description": "Write results of post note to CBC alert to a SOAR note",
          "enabled": false,
          "export_key": "VMare CBC: Write post note results to CBC to a note in SOAR",
          "id": 54,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1714161034520,
          "name": "VMare CBC: Write post note results to CBC to a note in SOAR",
          "object_type": "note",
          "playbook_handle": "vmware_cbc_post_note_to_cbc_alert",
          "programmatic_name": "vmware_cbc_post_note_to_cbc_alert_vmare_cbc_write_post_note_results_to_cbc_to_a_note_in_soar",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.post_note_to_alert_results\n\n# Edit note in SOAR to indicate it was sent to CBC alert\nif results.get(\"success\"):\n  # Get the current time\n  now = datetime.now()\n  note.text = u\"\u003cb\u003ePost note to CBC alert at {0}\u003c/b\u003e\u003cbr\u003e{1}\".format(now, note.text.content)\n  ",
          "tags": [],
          "uuid": "27e1ed35-587b-40c3-8974-110edd36303c"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Created by VMware CBC:"
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Post note to CBC alert at"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_post_note_to_cbc_alert",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_3fbef68a-55ef-4ffa-af23-ee222e1d40ae",
        "id": 35,
        "name": "playbook_3fbef68a_55ef_4ffa_af23_ee222e1d40ae",
        "type": "playbook",
        "uuid": "c826e76b-fbe8-44fa-a4a0-4d5efe205b5e"
      },
      "tags": [],
      "type": "default",
      "uuid": "3fbef68a-55ef-4ffa-af23-ee222e1d40ae",
      "version": 8
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1\" isExecutable=\"true\" name=\"playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_12zto6d\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Tags\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f46ee389-9bd8-43c0-929e-fef29a8e2b3b\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_threat_id = incident.properties.vmware_cbc_threat_id\\ninputs.vmware_cbc_tags = playbook.inputs.vmware_cbc_tags\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_tags_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_12zto6d\u003c/incoming\u003e\u003coutgoing\u003eFlow_02bkw8b\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_12zto6d\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMware CBC: Post Tags results to note \"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"b4d3b390-40d2-4083-912a-a7debfb840b5\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02bkw8b\u003c/incoming\u003e\u003coutgoing\u003eFlow_0zmwl57\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_02bkw8b\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0zmwl57\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0zmwl57\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0zmwl57\" id=\"Flow_0zmwl57_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"464\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02bkw8b\" id=\"Flow_02bkw8b_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_12zto6d\" id=\"Flow_12zto6d_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"464\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1715282596953,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1",
      "description": {
        "content": "Manual playbook to add a list of tags to a Carbon Black Cloud alert in CBC.",
        "format": "text"
      },
      "display_name": "VMware CBC: Post Tags",
      "export_key": "vmware_cbc_post_tags",
      "field_type_handle": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Post Tags",
        "export_key": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1",
        "fields": {
          "vmware_cbc_tags": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1/vmware_cbc_tags",
            "hide_notification": false,
            "id": 444,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_tags",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Tag(s)",
            "tooltip": "Comma separated list of tags to add to the alert.",
            "type_id": 1042,
            "uuid": "f681e383-562c-45ae-9b25-118bfb35065f",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1",
        "uuid": "bd705d2c-bde3-4dbb-b029-18d7b352f464"
      },
      "has_logical_errors": false,
      "id": 38,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1715286295333,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1715282675331,
          "description": "Write the results of function Post Tags to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Post Tags results to note ",
          "id": 60,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1715286292774,
          "name": "VMware CBC: Post Tags results to note ",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_post_tags",
          "programmatic_name": "vmware_cbc_post_tags_vmware_cbc_post_tags_results_to_note_",
          "script_text": "results = playbook.functions.results.post_tags_results\n\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        note_text = f\"\u003cb\u003eVMware CBC: Post Tags:\u003c/b\u003e  {playbook.inputs.vmware_cbc_tags} added.\"\n    else:\n        note_text = \"\u003cb\u003eVMware CBC: Post Tags\u003c/b\u003e failed to post tag(s) - no content.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = \"\u003cb\u003eVMware CBC: Post Tags\u003c/b\u003e failed to post tag(s) {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "b4d3b390-40d2-4083-912a-a7debfb840b5"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_threat_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "f681e383-562c-45ae-9b25-118bfb35065f",
            "element": "field_uuid",
            "field_type": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "vmware_cbc_post_tags",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_f55068f7-1104-403a-9a36-4eeabdc88fa1",
        "id": 40,
        "name": "playbook_f55068f7_1104_403a_9a36_4eeabdc88fa1",
        "type": "playbook",
        "uuid": "66340bb7-bd7d-4d74-8b49-9a1ef88b27c8"
      },
      "tags": [],
      "type": "default",
      "uuid": "f55068f7-1104-403a-9a36-4eeabdc88fa1",
      "version": 12
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd\" isExecutable=\"true\" name=\"playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_07l8xe9\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Device Action\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"12d0ecab-6779-4af7-ba67-2d6572f01dcb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_device_action = \\\"QUARANTINE\\\"\\ninputs.vmware_cbc_device_toggle = \\\"OFF\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_device_action_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_07l8xe9\u003c/incoming\u003e\u003coutgoing\u003eFlow_0a92rx0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_07l8xe9\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1cbqf9q\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Quarantine Device OFF\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"cd853671-ffb4-448c-881a-dc02ee5d1c2d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0a92rx0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uocsgf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0a92rx0\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0uocsgf\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_4\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uocsgf\u003c/incoming\u003e\u003coutgoing\u003eFlow_06esysn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_06esysn\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_06esysn\u003c/incoming\u003e\u003coutgoing\u003eFlow_1cbqf9q\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1cbqf9q\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1cbqf9q\" id=\"Flow_1cbqf9q_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"612\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"644\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_06esysn\" id=\"Flow_06esysn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"482\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"528\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uocsgf\" id=\"Flow_0uocsgf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"398\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0a92rx0\" id=\"Flow_0a92rx0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_07l8xe9\" id=\"Flow_07l8xe9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"644\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"398\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"528\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718055284045,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd",
      "description": {
        "content": "Manual playbook to remove a device from  Quarantine from the CBC Device data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Quarantine OFF",
      "export_key": "vmware_cbc_quarantine_off",
      "field_type_handle": "playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd",
      "fields_type": {
        "actions": [],
        "display_name": "vmware_cbc_quarantine_off",
        "export_key": "playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_593176cf_220a_4b96_a7d1_07a7b49d2cbd",
        "uuid": "ea035418-7dfd-4322-896d-fad4d29fe764"
      },
      "has_logical_errors": false,
      "id": 56,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718115155529,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718055284225,
          "description": "Write results of quarantine device function to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Quarantine Device OFF",
          "id": 80,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718113654132,
          "name": "VMware CBC: Quarantine Device OFF",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_quarantine_off",
          "programmatic_name": "vmware_cbc_quarantine_off_vmware_quarantine_off_vmware_cbc_quarantine_device",
          "script_text": "results = playbook.functions.results.post_device_action_results\n\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC: Quarantine OFF:\u003c/b\u003e Post action to device successful.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: Quarantine OFF:\u003c/b\u003e Failed to post action Quarantine OFF: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "cd853671-ffb4-448c-881a-dc02ee5d1c2d"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_quarantined",
              "method": "equals",
              "type": null,
              "value": true
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_quarantine_off",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_593176cf-220a-4b96-a7d1-07a7b49d2cbd",
        "id": 58,
        "name": "playbook_593176cf-220a-4b96-a7d1-07a7b49d2cbd",
        "type": "playbook",
        "uuid": "0f3771fd-6366-412b-87ef-5be16c2640fc"
      },
      "tags": [],
      "type": "default",
      "uuid": "593176cf-220a-4b96-a7d1-07a7b49d2cbd",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 6,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_2d6fa795_3be1_4099_b222_eaed77c8771f\" isExecutable=\"true\" name=\"playbook_2d6fa795_3be1_4099_b222_eaed77c8771f\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_07l8xe9\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Device Action\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"12d0ecab-6779-4af7-ba67-2d6572f01dcb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\\ninputs.vmware_cbc_device_action = \\\"QUARANTINE\\\"\\ninputs.vmware_cbc_device_toggle = \\\"ON\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_device_action_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_07l8xe9\u003c/incoming\u003e\u003coutgoing\u003eFlow_0a92rx0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_07l8xe9\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1e28pkz\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Quarantine Device ON\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"31e2ded3-642c-4bcf-9a17-90ecd42255f9\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0a92rx0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uocsgf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0a92rx0\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0uocsgf\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0y8oi5i\u003c/incoming\u003e\u003coutgoing\u003eFlow_1e28pkz\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1e28pkz\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uocsgf\u003c/incoming\u003e\u003coutgoing\u003eFlow_0y8oi5i\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0y8oi5i\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_2d6fa795_3be1_4099_b222_eaed77c8771f\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0y8oi5i\" id=\"Flow_0y8oi5i_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"518\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1e28pkz\" id=\"Flow_1e28pkz_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"602\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"634\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uocsgf\" id=\"Flow_0uocsgf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"372\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0a92rx0\" id=\"Flow_0a92rx0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"288\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_07l8xe9\" id=\"Flow_07l8xe9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"634\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"288\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"518\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718055257634,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_2d6fa795_3be1_4099_b222_eaed77c8771f",
      "description": {
        "content": "Manual playbook to Quarantine a device from the CBC Device data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Quarantine ON",
      "export_key": "vmware_cbc_quarantine_on",
      "field_type_handle": "playbook_2d6fa795_3be1_4099_b222_eaed77c8771f",
      "fields_type": {
        "actions": [],
        "display_name": "vmware_cbc_quarantine_on",
        "export_key": "playbook_2d6fa795_3be1_4099_b222_eaed77c8771f",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_2d6fa795_3be1_4099_b222_eaed77c8771f",
        "uuid": "30cf942c-4732-423b-b1c7-3f0c5a135f17"
      },
      "has_logical_errors": false,
      "id": 55,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1719862206560,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718055257853,
          "description": "Write results of quarantine device function to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Quarantine Device ON",
          "id": 79,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718113849362,
          "name": "VMware CBC: Quarantine Device ON",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_quarantine_on",
          "programmatic_name": "vmware_cbc_quarantine_on_vmware_quarantine_on_vmware_cbc_quarantine_device",
          "script_text": "results = playbook.functions.results.post_device_action_results\n\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC: Quarantine ON:\u003c/b\u003e Post action Quarantine ON successful.\"\n    row.cbc_device_quarantined = \"True\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: Quarantine ON:\u003c/b\u003e Failed to post action Quarantine ON: {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "31e2ded3-642c-4bcf-9a17-90ecd42255f9"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 1,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 2,
              "field_name": "vmware_cbc_device_dt.cbc_device_quarantined",
              "method": "equals",
              "type": null,
              "value": false
            },
            {
              "evaluation_id": 3,
              "field_name": "vmware_cbc_device_dt.cbc_device_quarantined",
              "method": "equals",
              "type": null,
              "value": null
            }
          ],
          "custom_condition": "1 AND (2 OR 3)",
          "logic_type": "advanced"
        },
        "view_items": []
      },
      "name": "vmware_cbc_quarantine_on",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_2d6fa795-3be1-4099-b222-eaed77c8771f",
        "id": 57,
        "name": "playbook_2d6fa795-3be1-4099-b222-eaed77c8771f",
        "type": "playbook",
        "uuid": "2a8bfa1a-be08-4e66-895e-f7c26c545c1d"
      },
      "tags": [],
      "type": "default",
      "uuid": "2d6fa795-3be1-4099-b222-eaed77c8771f",
      "version": 9
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 34,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_738f4ce4_3126_4402_9033_66e8a7676c31\" isExecutable=\"true\" name=\"playbook_738f4ce4_3126_4402_9033_66e8a7676c31\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1nttp80\u003c/outgoing\u003e\u003c/startEvent\u003e\u003csequenceFlow id=\"Flow_1nttp80\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1sak65m\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"VMware CBC: Get Alert By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3835f131-ada7-4a21-b056-4006d2a69123\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1nttp80\u003c/incoming\u003e\u003coutgoing\u003eFlow_1jb20jb\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1jb20jb\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"VMware CBC: Update CBC Device data table with alert data\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"c9c5b543-a960-47f5-a295-28a28e61224b\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1jb20jb\u003c/incoming\u003e\u003coutgoing\u003eFlow_1fe4zny\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1fe4zny\" sourceRef=\"ScriptTask_5\" targetRef=\"ServiceTask_6\"/\u003e\u003cserviceTask id=\"ServiceTask_6\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1fe4zny\u003c/incoming\u003e\u003coutgoing\u003eFlow_0nfiorm\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0nfiorm\" sourceRef=\"ServiceTask_6\" targetRef=\"ScriptTask_7\"/\u003e\u003cscriptTask id=\"ScriptTask_7\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0nfiorm\u003c/incoming\u003e\u003coutgoing\u003eFlow_1sak65m\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1sak65m\" sourceRef=\"ScriptTask_7\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_738f4ce4_3126_4402_9033_66e8a7676c31\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1sak65m\" id=\"Flow_1sak65m_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"512\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"564\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0nfiorm\" id=\"Flow_0nfiorm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"428\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1fe4zny\" id=\"Flow_1fe4zny_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1jb20jb\" id=\"Flow_1jb20jb_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"162\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nttp80\" id=\"Flow_1nttp80_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"36\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"78\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"-16\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"564\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"78\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"187.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_6\" id=\"ServiceTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"307.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_7\" id=\"ScriptTask_7_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.325\" y=\"427.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1716476314316,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_738f4ce4_3126_4402_9033_66e8a7676c31",
      "description": {
        "content": "Get the device data on the device in this row and add to a new row in the data table.  Use to compare device query results over time.",
        "format": "text"
      },
      "display_name": "VMware CBC: Refetch Device in Row",
      "export_key": "vmware_cbc_refetch_device_in_row",
      "field_type_handle": "playbook_738f4ce4_3126_4402_9033_66e8a7676c31",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Refetch Device in Row",
        "export_key": "playbook_738f4ce4_3126_4402_9033_66e8a7676c31",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_738f4ce4_3126_4402_9033_66e8a7676c31",
        "uuid": "163f193f-d7ad-4d5c-8b6f-896dc629e105"
      },
      "has_logical_errors": false,
      "id": 44,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718052252250,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1716478420882,
          "description": "",
          "enabled": false,
          "export_key": "VMware CBC: Populate Device Row",
          "id": 68,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1716478420882,
          "name": "VMware CBC: Populate Device Row",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_refetch_device_in_row",
          "programmatic_name": "vmware_cbc_refetch_device_in_row_vmware_cbc_populate_device_row",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alert_by_id_result\n\nnote_text = f\"results = {results}\"\n\"\"\"\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n\n    alert = content.get(\"alert\", [])\n    device_row = incident.addRow(\"vmware_cbc_device_dt\")\n    device_row.cbc_query_date = datetime.now()\n    device_row.cbc_device_id = alert.get(\"device_id\", None)\n    device_row.cbc_device_name = alert.get(\"device_name\", None)\n    device_row.cbc_device_policy = alert.get(\"device_policy\", None)\n    device_row.cbc_device_policy_id = alert.get(\"device_policy_id\", None)\n    device_row.cbc_device_os_version = alert.get(\"device_os_version\", None)\n    device_row.cbc_device_username = alert.get(\"device_username\", None)\n    device_row.cbc_device_external_ip = alert.get(\"device_external_ip\", None)\n    device_row.cbc_device_internal_ip = alert.get(\"device_internal_ip\", None)\n    device_row.cbc_device_location = alert.get(\"device_location\", None)\n\n    note_text = \"\u003cb\u003eVMware CBC Populate Device Row in Device DT:\u003c/b\u003e Populate CBC Device Data Table complete.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC Populate Device Row in Device DT:\u003c/b\u003e No alert found (no content).\"\nelse:\n  note_text = \"\u003cbVMware CBC Populate Device Row in Device DT:\u003c/b\u003e Populate CBC Device Data Table did not complete. Reason = {0}\".format(results.get(\"reason\", None))\n\"\"\"\n    \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "aa5ad325-aa61-497b-bd69-65039838e7cf"
        },
        {
          "actions": [],
          "created_date": 1718049878643,
          "description": "Update the CBC Device data table with alert data and write on note.",
          "enabled": false,
          "export_key": "VMware CBC: Update CBC Device data table with alert data",
          "id": 73,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718052221442,
          "name": "VMware CBC: Update CBC Device data table with alert data",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_refetch_device_in_row",
          "programmatic_name": "vmware_cbc_refetch_device_in_row_vmware_cbc_update_cbc_device_data_table_with_alert_data",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alert_by_id_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", {})\n    if alert:\n      row.cbc_query_date = datetime.now()\n      row.cbc_device_id = str(alert.get(\"device_id\")) if alert.get(\"device_id\", None) else None\n      row.cbc_device_policy_id =   str(alert.get(\"device_policy_id\", None)) if alert.get(\"device_policy_id\", None) else None\n      row.cbc_device_name =        alert.get(\"device_name\", None)\n      row.cbc_device_policy =      alert.get(\"device_policy\", None)\n      row.cbc_device_os_version =  alert.get(\"device_os_version\", None)\n      row.cbc_device_username =    alert.get(\"device_username\", None)\n      row.cbc_device_external_ip = alert.get(\"device_external_ip\", None)\n      row.cbc_device_internal_ip = alert.get(\"device_internal_ip\", None)\n      row.cbc_device_location =    alert.get(\"device_location\", None)\n\n      note_text = \"\u003cb\u003eVMware CBC: Refetch CBC Device Row from Alert:\u003c/b\u003e Update complete.\"\n    else:\n      note_text = \"\u003cb\u003eVMware CBC: Refetch CBC Device Row from Alert:\u003c/b\u003e No alert found.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC: Refetch CBC Device Row from Alert:\u003c/b\u003e No alert found (no content).\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cbVMware CBC: Refetch CBC Device Row from Alert:\u003c/b\u003e Update did not complete. Reason: {reason}\"\n    \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "c9c5b543-a960-47f5-a295-28a28e61224b"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_refetch_device_in_row",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_738f4ce4-3126-4402-9033-66e8a7676c31",
        "id": 46,
        "name": "playbook_738f4ce4_3126_4402_9033_66e8a7676c31",
        "type": "playbook",
        "uuid": "06322a1a-c40c-405a-8055-51c312eec6e5"
      },
      "tags": [],
      "type": "default",
      "uuid": "738f4ce4-3126-4402-9033-66e8a7676c31",
      "version": 38
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 32,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38\" isExecutable=\"true\" name=\"playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0mvjxo0\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Alert Workflow Data\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6d45af39-58b1-4a3c-9ac6-9fbd26a6c15e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\\ninputs.vmware_cbc_determination = playbook.inputs.vmware_cbc_determination.upper().replace(\\\" \\\", \\\"_\\\")  if playbook.inputs.vmware_cbc_determination is not None else None\\nstatus = playbook.inputs.vmware_cbc_status\\ninputs.vmware_cbc_status = status.upper().replace(\\\" \\\", \\\"_\\\")  if status else None\\nif inputs.vmware_cbc_status == \\\"CLOSED\\\":\\n  if playbook.inputs.vmware_cbc_closure_reason is not None:\\n    inputs.vmware_cbc_closure_reason = playbook.inputs.vmware_cbc_closure_reason.upper().replace(\\\" \\\", \\\"_\\\")\\n  else:\\n    inputs.vmware_cbc_closure_reason = incident.properties.vmware_cbc_workflow_closure_reason\\nelse:\\n  inputs.vmware_cbc_closure_reason = None\\ninputs.vmware_cbc_note_text = None\\n\\nif not inputs.vmware_cbc_determination and not inputs.vmware_cbc_status:\\n  helper.fail(\\\"Fill-in at least one workflow item to set!\\\")\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_workflow_data_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0mvjxo0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0z50s2j\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0mvjxo0\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMware CBC: write results of workflow information update\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"0db479e4-89fd-4fe1-9bf1-50ec5885112d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0z50s2j\u003c/incoming\u003e\u003coutgoing\u003eFlow_1wky6h4\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1wky6h4\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1wky6h4\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003csequenceFlow id=\"Flow_0z50s2j\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0z50s2j\" id=\"Flow_0z50s2j_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"318\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1wky6h4\" id=\"Flow_1wky6h4_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"402\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"474\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0mvjxo0\" id=\"Flow_0mvjxo0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"318\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"474\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1714485060363,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
      "description": {
        "content": "Update the alert workflow information in VMware Carbon Black Cloud.",
        "format": "text"
      },
      "display_name": "VMware CBC: Update Alert Workflow Data",
      "export_key": "vmware_cbc_update_alert_workflow_data",
      "field_type_handle": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Update Alert Workflow Data",
        "export_key": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
        "fields": {
          "vmware_cbc_closure_reason": {
            "allow_default_value": false,
            "blank_option": true,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38/vmware_cbc_closure_reason",
            "hide_notification": false,
            "id": 436,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_closure_reason",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Closure Reason",
            "tooltip": "",
            "type_id": 1038,
            "uuid": "145411c2-360e-4e8a-81d1-68137fa27780",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Resolved",
                "properties": null,
                "uuid": "91da8953-2e18-418b-b840-8bbf17a00079",
                "value": 311
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "No Reason",
                "properties": null,
                "uuid": "fee510d6-cc06-4fcf-8e6c-225c3e6074c7",
                "value": 312
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Resolved Benign Known Good",
                "properties": null,
                "uuid": "411266eb-4683-4d1f-9ae9-508343e8f855",
                "value": 313
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Duplicate Cleanup",
                "properties": null,
                "uuid": "90528d2e-7209-4a78-9f00-c9a41bd07fcc",
                "value": 314
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Other",
                "properties": null,
                "uuid": "f10383f6-e2e2-4c39-a826-63dfbc3e194f",
                "value": 315
              }
            ]
          },
          "vmware_cbc_determination": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38/vmware_cbc_determination",
            "hide_notification": false,
            "id": 432,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_determination",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Determination",
            "tooltip": "",
            "type_id": 1038,
            "uuid": "7b455826-6899-43eb-964f-93ff2d581de6",
            "values": [
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "None",
                "properties": null,
                "uuid": "32f35831-1fdf-4e1c-8e24-4a2d1c912faa",
                "value": 302
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "True positive",
                "properties": null,
                "uuid": "ffaef1d9-2aab-4c81-b72a-628f162fbb80",
                "value": 303
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "False positive",
                "properties": null,
                "uuid": "d223c384-f587-48f6-9b8f-95739bf1a118",
                "value": 304
              }
            ]
          },
          "vmware_cbc_status": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38/vmware_cbc_status",
            "hide_notification": false,
            "id": 434,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "vmware_cbc_status",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Status",
            "tooltip": "",
            "type_id": 1038,
            "uuid": "ad8b2ded-958c-4f16-a02e-0e66ec290288",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Open",
                "properties": null,
                "uuid": "77ef7650-c744-4f7a-8940-46241dc9422a",
                "value": 308
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "In Progress",
                "properties": null,
                "uuid": "1fdc868a-4aa4-4449-ae61-bc50f529d65d",
                "value": 309
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Closed",
                "properties": null,
                "uuid": "542d2e36-87aa-4df0-a987-b2b52b2e036c",
                "value": 310
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
        "uuid": "f3128907-85a0-416d-aafb-4d1d8876ec91"
      },
      "has_logical_errors": false,
      "id": 34,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1715265743541,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1714485560882,
          "description": "Write results of function post alert workflow data to CBC to a SOAR note. ",
          "enabled": false,
          "export_key": "VMware CBC: write results of workflow information update",
          "id": 55,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1715265741296,
          "name": "VMware CBC: write results of workflow information update",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_alert_workflow_data",
          "programmatic_name": "vmware_cbc_update_alert_workflow_data_vmware_cbc_write_results_of_workflow_information_update",
          "script_text": "results = playbook.functions.results.post_workflow_data_results\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eVMware CBC Set Alert Workflow Data in CBC: \u003c/b\u003e set:\u003cbr\u003e\"\n    if playbook.inputs.vmware_cbc_determination:\n        incident.properties.vmware_cbc_determination_value = playbook.inputs.vmware_cbc_determination\n        note_text = f\"{note_text}\u003cbr\u003e   Determination:  {playbook.inputs.vmware_cbc_determination}\"\n    if playbook.inputs.vmware_cbc_status:\n        incident.properties.vmware_cbc_workflow_status = playbook.inputs.vmware_cbc_status\n        note_text = f\"{note_text}\u003cbr\u003e   Status:         {playbook.inputs.vmware_cbc_status}\"\n    if playbook.inputs.vmware_cbc_closure_reason and playbook.inputs.vmware_cbc_status == \u0027Closed\u0027:\n        incident.properties.vmware_cbc_workflow_closure_reason = playbook.inputs.vmware_cbc_closure_reason\n        note_text = f\"{note_text}\u003cbr\u003e   Closure Reason: {playbook.inputs.vmware_cbc_closure_reason}\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eVMware CBC: Set Alert Workflow Data:\u003c/b\u003e failed:\u003cbr\u003e  {reason}\"\n  \nincident.addNote(note_text)\n\n",
          "tags": [],
          "uuid": "0db479e4-89fd-4fe1-9bf1-50ec5885112d"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "7b455826-6899-43eb-964f-93ff2d581de6",
            "element": "field_uuid",
            "field_type": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "ad8b2ded-958c-4f16-a02e-0e66ec290288",
            "element": "field_uuid",
            "field_type": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "Select Closure Reason **ONLY** when selecting Closed Status. ",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "145411c2-360e-4e8a-81d1-68137fa27780",
            "element": "field_uuid",
            "field_type": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "vmware_cbc_update_alert_workflow_data",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_59cce8d2-7e80-4de2-a615-0ff77fc5bd38",
        "id": 36,
        "name": "playbook_59cce8d2_7e80_4de2_a615_0ff77fc5bd38",
        "type": "playbook",
        "uuid": "601ebd94-3ece-4a08-9a80-d94b51105c7f"
      },
      "tags": [],
      "type": "default",
      "uuid": "59cce8d2-7e80-4de2-a615-0ff77fc5bd38",
      "version": 37
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 78,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe\" isExecutable=\"true\" name=\"playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0wrf6dy\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0gvfrzo\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"VMware CBC: Get Alert By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3835f131-ada7-4a21-b056-4006d2a69123\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0wrf6dy\u003c/incoming\u003e\u003coutgoing\u003eFlow_1nf5wm9\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0wrf6dy\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_2\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Write Alert Custom Fields\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"3a2a6fa4-3eb1-4b66-bf5e-661cec811f3a\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1nf5wm9\u003c/incoming\u003e\u003coutgoing\u003eFlow_171a6r1\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1nf5wm9\" sourceRef=\"ServiceTask_2\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_171a6r1\" sourceRef=\"ScriptTask_3\" targetRef=\"ServiceTask_4\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"VMware CBC: Get CBC Notes\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3bdf0aef-91a4-4508-b087-a72d2f8946f7\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_id = incident.properties.vmware_cbc_alert_id\\ninputs.vmware_cbc_incident_id = incident.id\\ninputs.vmware_cbc_note_type = \\\"alert\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_notes_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_171a6r1\u003c/incoming\u003e\u003coutgoing\u003eFlow_01tjze6\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_01tjze6\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"VMware CBC: write alert notes\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7e3b2c97-2e01-41f8-bd0e-5422b4f75450\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_01tjze6\u003c/incoming\u003e\u003coutgoing\u003eFlow_0gvfrzo\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0gvfrzo\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_1\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0gvfrzo\" id=\"Flow_0gvfrzo_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"582\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"614\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_01tjze6\" id=\"Flow_01tjze6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"498\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_171a6r1\" id=\"Flow_171a6r1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"315\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nf5wm9\" id=\"Flow_1nf5wm9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"182\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"231\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wrf6dy\" id=\"Flow_0wrf6dy_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"98\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"614\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"98\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"231\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"498\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1713462454076,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe",
      "description": {
        "content": "Manual playbook to update a VMware Carbon Black Cloud case. Custom fields and comments are updated in SOAR.",
        "format": "text"
      },
      "display_name": "VMware CBC: Update Case",
      "export_key": "vmware_cbc_update_case",
      "field_type_handle": "playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Update Case",
        "export_key": "playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe",
        "uuid": "c8ed4617-4fb1-46a8-a92a-33d0191481b7"
      },
      "has_logical_errors": false,
      "id": 28,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1716488341769,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1714072891187,
          "description": "Write the device information in the CBC alert to the CBC Device DT. ",
          "enabled": false,
          "export_key": "VMware CBC: Populate Device Data DT",
          "id": 43,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1714147668132,
          "name": "VMware CBC: Populate Device Data DT",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case",
          "programmatic_name": "vmware_cbc_update_case_vmware_cbc_write_device_data_to_dt",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alert_by_id_result\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", [])\n    device_row = incident.addRow(\"vmware_cbc_device_dt\")\n    device_row.cbc_query_date = datetime.now()\n    device_row.cbc_device_id = alert.get(\"id\", None)\n    device_row.cbc_device_name = alert.get(\"device_name\", None)\n    device_row.cbc_device_policy = alert.get(\"device_policy\", None)\n    device_row.cbc_device_policy_id = alert.get(\"device_policy_id\", None)\n    device_row.cbc_device_os_version = alert.get(\"device_os_version\", None)\n    device_row.cbc_device_username = alert.get(\"device_username\", None)\n    device_row.cbc_device_external_ip = alert.get(\"device_external_ip\", None)\n    device_row.cbc_device_internal_ip = alert.get(\"device_internal_ip\", None)\n    device_row.cbc_device_location = alert.get(\"device_location\", None)\n    note_text = \"\u003cb\u003eVMware CBC Update Case:\u003c/b\u003e populated CBC Device data table.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC Update Case:\u003c/b\u003e No alert found (no content).\"\nelse:\n  note_text = \"\u003cbVMware CBC Update Case:\u003c/b\u003e Failed function to get alert. Reason = {0}\".format(results.get(\"reason\", None))\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "49cd6339-0fcb-4b58-9e23-7395aa5ef25f"
        },
        {
          "actions": [],
          "created_date": 1714147558103,
          "description": "Populate the Parent Process data table and create artifacts from the alert data.",
          "enabled": false,
          "export_key": "VMware CBC: Populate Parent Process DT",
          "id": 47,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1714153115023,
          "name": "VMware CBC: Populate Parent Process DT",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case",
          "programmatic_name": "vmware_cbc_update_case_vmware_cbc_populate_parent_process_dt",
          "script_text": "results = playbook.functions.results.get_alert_by_id_result\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", [])\n    parent_row = incident.addRow(\"vmware_cbc_parent_process_dt\")\n    parent_name = alert.get(\"parent_name\", None)\n    parent_row.cbc_parent_name = parent_name\n    parent_row.cbc_parent_guid = alert.get(\"parent_guid\", None)\n    parent_row.cbc_parent_pid = alert.get(\"parent_pid\", None)\n    parent_row.cbc_parent_cmd = alert.get(\"parent_cmdline\", None)\n    parent_row.cbc_parent_username = alert.get(\"parent_username\", None)\n    parent_row.cbc_parent_effective_reputation = alert.get(\"parent_effective_reputation\", None)\n    \n    num_artifact = 0\n    parent_sha256 = alert.get(\"parent_sha256\", None)\n    parent_md5 = alert.get(\"parent_md5\", None)\n    if parent_sha256:\n      incident.addArtifact(\"Malware SHA-256 Hash\", parent_sha256, \n                           f\"VMware Carbon Black: SHA-256 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n    if parent_md5:\n      incident.addArtifact(\"Malware MD5 Hash\", parent_md5, \n                           f\"VMware Carbon Black: MD5 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n      \n    note_text = f\"\u003cb\u003eVMware CBC Update Case:\u003c/b\u003e populated CBC Parent Process data table\u003cbr\u003e\u003cb\u003e{num_artifact}\u003c/b\u003e artifact(s) added to the case.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC Update Case:\u003c/b\u003e No alert found (no content) to populate Parent Process DT.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cbVMware CBC Update Case:\u003c/b\u003e Failed function to get alert to populate Parent Process DT.\u003cbr\u003eReason = {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "e30aecce-fd8b-4447-93ac-5d64da2efa6f"
        },
        {
          "actions": [],
          "created_date": 1714151477324,
          "description": "Populate the Process data table and add artifacts from the process.",
          "enabled": false,
          "export_key": "VMware CBC: Populate Processes DT",
          "id": 48,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1714764188014,
          "name": "VMware CBC: Populate Processes DT",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case",
          "programmatic_name": "vmware_cbc_update_case_vmware_cbc_populate_process_dt",
          "script_text": "results = playbook.functions.results.get_alert_by_id_result\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", [])\n    process_name = alert.get(\"process_name\", None)\n    if process_name:\n      process_row = incident.addRow(\"vmware_cbc_processes_dt\")\n      process_row.cbc_process_name = process_name\n      process_row.cbc_process_type = \"Child\"\n      process_row.cbc_process_guid = alert.get(\"process_guid\", None)\n      process_row.cbc_process_pid = alert.get(\"process_pid\", None)\n      process_row.cbc_process_cmd = alert.get(\"process_cmdline\", None)\n      process_row.cbc_process_username = alert.get(\"process_username\", None)\n      process_row.cbc_process_policy_action = alert.get(\"sensor_action\", None)\n      process_row.cbc_process_effective_reputation = alert.get(\"process_effective_reputation\", None)\n \n    parent_name = alert.get(\"parent_name\", None)\n    if parent_name:  \n      parent_process_row = incident.addRow(\"vmware_cbc_processes_dt\")\n      parent_process_row.cbc_process_name = parent_name\n      parent_process_row.cbc_process_type = \"Child\"\n      parent_process_row.cbc_process_guid = alert.get(\"parent_guid\", None)\n      parent_process_row.cbc_process_pid = alert.get(\"parent_pid\", None)\n      parent_process_row.cbc_process_cmd = alert.get(\"parent_cmdline\", None)\n      parent_process_row.cbc_process_username = alert.get(\"parent_username\", None)\n      parent_process_row.cbc_process_effective_reputation = alert.get(\"parent_effective_reputation\", None)   \n    \n    # Add artifacts from processes data\n    num_artifact = 0\n\n    process_sha256 = alert.get(\"process_sha256\", None)\n    process_md5 = alert.get(\"process_md5\", None)\n    if process_sha256:\n      incident.addArtifact(\"Malware SHA-256 Hash\", process_sha256, \n                           f\"VMware Carbon Black: SHA-256 hash of process file \u0027{process_name}\u0027.\")\n      num_artifact += 1\n    if process_md5:\n      incident.addArtifact(\"Malware MD5 Hash\", process_md5, \n                           f\"VMware Carbon Black: MD5 hash of process file \u0027{process_name}\u0027.\")\n      num_artifact += 1\n      \n    parent_sha256 = alert.get(\"parent_sha256\", None)\n    parent_md5 = alert.get(\"parent_md5\", None)\n    if parent_sha256:\n      incident.addArtifact(\"Malware SHA-256 Hash\", parent_sha256, \n                           f\"VMware Carbon Black: SHA-256 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n    if parent_md5:\n      incident.addArtifact(\"Malware MD5 Hash\", parent_md5, \n                           f\"VMware Carbon Black: MD5 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n    \n    note_text = f\"\u003cb\u003eVMware CBC Update Case:\u003c/b\u003e populated Processes data table\u003cbr\u003e\u003cb\u003e{num_artifact}\u003c/b\u003e artifact(s) added to the case.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC Update Case:\u003c/b\u003e No alert found (no content) to populate Processes DT.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cbVMware CBC Update Case:\u003c/b\u003e Failed function to get alert to populate Process DT.\u003cbr\u003eReason = {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "50b0128e-bfb3-4e45-89e6-5f1dd7706545"
        },
        {
          "actions": [],
          "created_date": 1713464801067,
          "description": "Write te results of function VMwareCBC: Get Alert By ID to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Write Alert Custom Fields",
          "id": 38,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1716488328748,
          "name": "VMware CBC: Write Alert Custom Fields",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case",
          "programmatic_name": "vmware_cbc_update_case_vmware_cbc_get_alert_by_id",
          "script_text": "from urllib.parse import quote as url_encode\n\n# Map VMware CBC workflow closure_reason values SOAR resolution id values.\nMAPPING_CLOSURE_REASON = {\n  \"Resolved\" : \"Resolved\",\n  \"No Reason\": \"Resolved\",\n  \"Resolved Benign Known Good\": \"Resolved\",\n  \"Duplicate Cleanup\" : \"Duplicate\",\n  \"Other\": \"Resolved\"\n}\n\n# Map VMware CBC determination values to SOAR resolution id values.\nMAPPING_DETERMINATION_ON_CLOSE = {\n  \"None\": \"Resolved\",\n  \"False positive\": \"Not an Issue\",\n  \"True positive\": \"Resolved\"\n}\n\nresults = playbook.functions.results.get_alert_by_id_results\n\nif not results.success:\n    incident.addNote(\"\u003cb\u003eVMware CBC: Update Case Manual:\u003c/b\u003e Write Alert Custom Fields did NOT complete.\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        alert = content.get(\"alert\")\n        alert_url = alert.get(\"alert_url\", None)\n        if alert_url:\n          # url encode the bracket characters [] \n          alert_url_urlencoded = alert_url.replace(\"[\", \"%5B\").replace(\"]\", \"%5D\")\n          incident.properties.vmware_cbc_alert_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027https://{0}\u0027\u003eAlert Link\u003c/a\u003e\".format(alert_url_urlencoded)\n        incident.properties.vmware_cbc_alert_type = alert.get(\"type\", None)\n        incident.properties.vmware_cbc_alert_reason_code = alert.get(\"reason_code\", None)\n        incident.properties.vmware_cbc_threat_id = alert.get(\"threat_id\", None)\n        workflow = alert.get(\"workflow\", None) or None\n        status = workflow.get(\"status\", None) if workflow.get(\"status\", None) else None\n        closure_reason = workflow.get(\"closure_reason\") if workflow.get(\"closure_reason\") else None\n        incident.properties.vmware_cbc_workflow_status = status.replace(\"_\", \" \").title() if status else None\n        incident.properties.vmware_cbc_workflow_closure_reason = closure_reason.replace(\"_\", \" \").title() if status else None\n        determination = alert.get(\"determination\", None)\n        determination_value = determination.get(\"value\") if determination.get(\"value\", None) else None\n        incident.properties.vmware_cbc_determination_value = determination_value.replace(\"_\", \" \").title() if determination_value else None\n        tags = alert.get(\"tags\", None)\n        incident.properties.vmware_cbc_tags = \", \".join(tags) if isinstance(tags, list) else None\n        incident.properties.vmware_cbc_attack_tactic = alert.get(\"attack_tactic\", None)\n        incident.addNote(\"\u003cb\u003eVMware CBC: Update Case Manual:\u003c/b\u003e Write Alert Custom Fields completed.\")\n        \n        if incident.properties.vmware_cbc_workflow_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_CLOSURE_REASON.get(incident.properties.vmware_cbc_workflow_closure_reason, \"Resolved\")\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n\n    else: \n        incident.addNote(\"\u003cb\u003eVMware CBC: Update Case Manual:\u003c/b\u003e Write Alert Custom Fields did NOT complete.\")",
          "tags": [],
          "uuid": "3a2a6fa4-3eb1-4b66-bf5e-661cec811f3a"
        },
        {
          "actions": [],
          "created_date": 1713902248937,
          "description": "Write the alert notes function results to a note.",
          "enabled": false,
          "export_key": "VMware CBC: write alert notes",
          "id": 42,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1713903302821,
          "name": "VMware CBC: write alert notes",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case",
          "programmatic_name": "vmware_cbc_update_case_vmware_cbc_write_alert_notes",
          "script_text": "results = playbook.functions.results.get_alert_notes_results\n\n\nif results.get(\"success\"):\n  content = results.get(\"content\")\n  if content:\n    note_text = \"\u003cb\u003eVMware CBC: Get Alert Notes\u003c/b\u003e playbook created {0} notes in SOAR\".format(content.get(\"count\"))\n  else:\n    note_text = \"\u003cb\u003eVMware CBC: Get Alert Notes\u003c/b\u003e function failed to get notes from Carbon Black Cloud\"\nelse:\n  note_text = \"\u003cb\u003eVMware CBC: Get Alert Notes\u003c/b\u003e function failed to get notes from Carbon Black Cloud\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "7e3b2c97-2e01-41f8-bd0e-5422b4f75450"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_update_case",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_9b246524-19f9-45a7-a1e8-4e9ef83357fe",
        "id": 30,
        "name": "playbook_9b246524_19f9_45a7_a1e8_4e9ef83357fe",
        "type": "playbook",
        "uuid": "fa2e2045-f301-4c91-94f2-f4f031565ad2"
      },
      "tags": [],
      "type": "default",
      "uuid": "9b246524-19f9-45a7-a1e8-4e9ef83357fe",
      "version": 82
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 34,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217\" isExecutable=\"true\" name=\"playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0wrf6dy\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0gvfrzo\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"VMware CBC: Get Alert By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3835f131-ada7-4a21-b056-4006d2a69123\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0wrf6dy\u003c/incoming\u003e\u003coutgoing\u003eFlow_1nf5wm9\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0wrf6dy\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_2\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: Write Alert Custom Fields\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d94e273d-1946-4c52-becf-0e2a5f656be9\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1nf5wm9\u003c/incoming\u003e\u003coutgoing\u003eFlow_171a6r1\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1nf5wm9\" sourceRef=\"ServiceTask_2\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_171a6r1\" sourceRef=\"ScriptTask_3\" targetRef=\"ScriptTask_9\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"VMware CBC: Get CBC Notes\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3bdf0aef-91a4-4508-b087-a72d2f8946f7\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_id = incident.properties.vmware_cbc_alert_id\\ninputs.vmware_cbc_incident_id = incident.id\\ninputs.vmware_cbc_note_type = \\\"alert\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_notes_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0gwng60\u003c/incoming\u003e\u003coutgoing\u003eFlow_01tjze6\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_01tjze6\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"VMware CBC: write alert notes\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d8e17b5c-0871-4d1f-9c1c-fbeae9eab561\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_01tjze6\u003c/incoming\u003e\u003coutgoing\u003eFlow_0gvfrzo\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0gvfrzo\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_1\"/\u003e\u003cscriptTask id=\"ScriptTask_8\" name=\"VMware CBC: Populate Processes DT\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"52a06d3c-776b-4707-8daa-0ee762704fdb\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1a5wlje\u003c/incoming\u003e\u003coutgoing\u003eFlow_0zaopfg\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0zaopfg\" sourceRef=\"ScriptTask_8\" targetRef=\"ServiceTask_11\"/\u003e\u003cscriptTask id=\"ScriptTask_9\" name=\"VMware CBC: Populate CBC Device Row from Alert\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"6e472039-5b92-453c-ba5c-47c70fa77a8f\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_171a6r1\u003c/incoming\u003e\u003coutgoing\u003eFlow_1a5wlje\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1a5wlje\" sourceRef=\"ScriptTask_9\" targetRef=\"ScriptTask_8\"/\u003e\u003cscriptTask id=\"ScriptTask_10\" name=\"VMware CBC: Populate Observations Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"892344cc-7208-4ae2-8453-111e5fa79d70\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0woxl3n\u003c/incoming\u003e\u003coutgoing\u003eFlow_0gwng60\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0gwng60\" sourceRef=\"ScriptTask_10\" targetRef=\"ServiceTask_4\"/\u003e\u003cserviceTask id=\"ServiceTask_11\" name=\"VMware CBC: Post Observations Detail Job\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"61ed2b9f-4de2-4489-8e34-5238a2a53867\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n\\n# Note: Either observation_ids or alert_id is required however only one can be specified.\\n# This playbook specifies an alert_id.\\nobservations ={\\n  \\\"alert_id\\\": incident.properties.vmware_cbc_alert_id\\n}\\n\\ninputs.vmware_cbc_observations = dumps(observations)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"observation_detail_job_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0zaopfg\u003c/incoming\u003e\u003coutgoing\u003eFlow_0woxl3n\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0woxl3n\" sourceRef=\"ServiceTask_11\" targetRef=\"ScriptTask_10\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0woxl3n\" id=\"Flow_0woxl3n_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"682\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"728\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0gwng60\" id=\"Flow_0gwng60_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"812\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"858\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1a5wlje\" id=\"Flow_1a5wlje_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"478\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0zaopfg\" id=\"Flow_0zaopfg_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"562\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"598\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0gvfrzo\" id=\"Flow_0gvfrzo_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"1052\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"1104\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_01tjze6\" id=\"Flow_01tjze6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"942\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"968\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_171a6r1\" id=\"Flow_171a6r1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"315\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nf5wm9\" id=\"Flow_1nf5wm9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"182\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"231\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wrf6dy\" id=\"Flow_0wrf6dy_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"98\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"1104\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"98\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"231\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"858\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"968\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_8\" id=\"ScriptTask_8_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"478\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_9\" id=\"ScriptTask_9_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.0476839237058\" y=\"358.1049046321526\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_10\" id=\"ScriptTask_10_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"728\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_11\" id=\"ServiceTask_11_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.6997245179064\" y=\"598.0247933884298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1714153493697,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217",
      "description": {
        "content": "Automatic playbook to update VMware Carbon Black Cloud case when the case is created. Custom fields, data tables and comments are updated in the SOAR case.",
        "format": "text"
      },
      "display_name": "VMware CBC: Update Case on Creation",
      "export_key": "vmware_cbc_update_case_on_creation",
      "field_type_handle": "playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Update Case on Creation",
        "export_key": "playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217",
        "uuid": "0ac82098-8cc5-4202-88ce-8dd648051df3"
      },
      "has_logical_errors": false,
      "id": 32,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718915337880,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1714153493792,
          "description": "Write the device information in the CBC alert to the CBC Device DT. ",
          "enabled": false,
          "export_key": "VMware CBC: Populate Device Data Table",
          "id": 49,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1715361367770,
          "name": "VMware CBC: Populate Device Data Table",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case_on_creation",
          "programmatic_name": "vmware_cbc_update_case_on_creation_vmware_cbc_populate_device_data_dt",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alert_by_id_result\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", [])\n    device_row = incident.addRow(\"vmware_cbc_device_dt\")\n    device_row.cbc_query_date = datetime.now()\n    device_row.cbc_device_id = alert.get(\"device_id\", None)\n    device_row.cbc_device_name = alert.get(\"device_name\", None)\n    device_row.cbc_device_policy = alert.get(\"device_policy\", None)\n    device_row.cbc_device_policy_id = alert.get(\"device_policy_id\", None)\n    device_row.cbc_device_os_version = alert.get(\"device_os_version\", None)\n    device_row.cbc_device_username = alert.get(\"device_username\", None)\n    device_row.cbc_device_external_ip = alert.get(\"device_external_ip\", None)\n    device_row.cbc_device_internal_ip = alert.get(\"device_internal_ip\", None)\n    device_row.cbc_device_location = alert.get(\"device_location\", None)\n    note_text = \"\u003cb\u003eVMware CBC Update Case on Creation:\u003c/b\u003e Populate CBC Device Data Table complete.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC Update Case on Creation:\u003c/b\u003e No alert found (no content).\"\nelse:\n  note_text = \"\u003cbVMware CBC Update Case on Creation:\u003c/b\u003e Populate CBC Device Data Table did not complete. Reason = {0}\".format(results.get(\"reason\", None))\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "7cfafaea-6fcb-4ff2-b5d6-0653ee1e9cf9"
        },
        {
          "actions": [],
          "created_date": 1714153493804,
          "description": "Populate the Parent Process data table and create artifacts from the alert data.",
          "enabled": false,
          "export_key": "VMware CBC: Populate Parent Process DT",
          "id": 50,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1714153628986,
          "name": "VMware CBC: Populate Parent Process DT",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case_on_creation",
          "programmatic_name": "vmware_cbc_update_case_on_creation_vmware_cbc_populate_parent_process_dt",
          "script_text": "results = playbook.functions.results.get_alert_by_id_result\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", [])\n    parent_row = incident.addRow(\"vmware_cbc_parent_process_dt\")\n    parent_name = alert.get(\"parent_name\", None)\n    parent_row.cbc_parent_name = parent_name\n    parent_row.cbc_parent_guid = alert.get(\"parent_guid\", None)\n    parent_row.cbc_parent_pid = alert.get(\"parent_pid\", None)\n    parent_row.cbc_parent_cmd = alert.get(\"parent_cmdline\", None)\n    parent_row.cbc_parent_username = alert.get(\"parent_username\", None)\n    parent_row.cbc_parent_effective_reputation = alert.get(\"parent_effective_reputation\", None)\n    \n    num_artifact = 0\n    parent_sha256 = alert.get(\"parent_sha256\", None)\n    parent_md5 = alert.get(\"parent_md5\", None)\n    if parent_sha256:\n      incident.addArtifact(\"Malware SHA-256 Hash\", parent_sha256, \n                           f\"VMware Carbon Black: SHA-256 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n    if parent_md5:\n      incident.addArtifact(\"Malware MD5 Hash\", parent_md5, \n                           f\"VMware Carbon Black: MD5 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n      \n    note_text = f\"\u003cb\u003eVMware CBC Update Case on Creation:\u003c/b\u003e populated CBC Parent Process data table\u003cbr\u003e\u003cb\u003e{num_artifact}\u003c/b\u003e artifact(s) added to the case.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC Update Case on Creation:\u003c/b\u003e No alert found (no content) to populate Parent Process DT.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cbVMware CBC Update Caseon Creation:\u003c/b\u003e Failed function to get alert to populate Parent Process DT.\u003cbr\u003eReason = {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "0cf5b2ee-8dd8-494e-82c8-62f03e4d9f3f"
        },
        {
          "actions": [],
          "created_date": 1714153493816,
          "description": "Populate the Process data table and add artifacts from the process.",
          "enabled": false,
          "export_key": "VMware CBC: Populate Processes DT",
          "id": 51,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718034462678,
          "name": "VMware CBC: Populate Processes DT",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case_on_creation",
          "programmatic_name": "vmware_cbc_update_case_on_creation_vmware_cbc_populate_process_dt",
          "script_text": "results = playbook.functions.results.get_alert_by_id_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert = content.get(\"alert\", [])\n    process_name = alert.get(\"process_name\", None)\n    if process_name:\n      process_row = incident.addRow(\"vmware_cbc_processes_dt\")\n      process_row.cbc_process_name = process_name\n      process_row.cbc_process_type = \"Child\"\n      process_row.cbc_process_sha256 = alert.get(\"process_sha256\", None)\n      process_row.cbc_process_pid = alert.get(\"process_pid\", None)\n      process_row.cbc_process_cmd = alert.get(\"process_cmdline\", None)\n      process_row.cbc_process_username = alert.get(\"process_username\", None)\n      process_row.cbc_process_policy_action = alert.get(\"sensor_action\", None)\n      process_row.cbc_process_effective_reputation = alert.get(\"process_effective_reputation\", None)\n      process_row.cbc_device_id = alert.get(\"device_id\", None)\n      \n    parent_name = alert.get(\"parent_name\", None)\n    if parent_name:  \n      parent_process_row = incident.addRow(\"vmware_cbc_processes_dt\")\n      parent_process_row.cbc_process_name = parent_name\n      parent_process_row.cbc_process_type = \"Parent\"\n      parent_process_row.cbc_process_sha256 = alert.get(\"parent_sha256\", None)\n      parent_process_row.cbc_process_pid = alert.get(\"parent_pid\", None)\n      parent_process_row.cbc_process_cmd = alert.get(\"parent_cmdline\", None)\n      parent_process_row.cbc_process_username = alert.get(\"parent_username\", None)\n      parent_process_row.cbc_process_effective_reputation = alert.get(\"parent_effective_reputation\", None)   \n      parent_process_row.cbc_device_id = alert.get(\"device_id\", None)\n      \n    # Add artifacts from processes data\n    num_artifact = 0\n\n    process_sha256 = alert.get(\"process_sha256\", None)\n    process_md5 = alert.get(\"process_md5\", None)\n    if process_sha256:\n      incident.addArtifact(\"Malware SHA-256 Hash\", process_sha256, \n                           f\"VMware Carbon Black: SHA-256 hash of process file \u0027{process_name}\u0027.\")\n      num_artifact += 1\n    if process_md5:\n      incident.addArtifact(\"Malware MD5 Hash\", process_md5, \n                           f\"VMware Carbon Black: MD5 hash of process file \u0027{process_name}\u0027.\")\n      num_artifact += 1\n      \n    parent_sha256 = alert.get(\"parent_sha256\", None)\n    parent_md5 = alert.get(\"parent_md5\", None)\n    if parent_sha256:\n      incident.addArtifact(\"Malware SHA-256 Hash\", parent_sha256, \n                           f\"VMware Carbon Black: SHA-256 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n    if parent_md5:\n      incident.addArtifact(\"Malware MD5 Hash\", parent_md5, \n                           f\"VMware Carbon Black: MD5 hash of parent process file \u0027{parent_name}\u0027.\")\n      num_artifact += 1\n    \n    note_text = f\"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e Populated Processes data table\u003cbr\u003e\u003cb\u003e{num_artifact}\u003c/b\u003e artifact(s) added to the case.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e No alert found (no content) to populate Processes data table.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cbVMware CBC: Update Case on Creation:\u003c/b\u003e Failed function to get alert to populate Processes data table.\u003cbr\u003eReason = {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "52a06d3c-776b-4707-8daa-0ee762704fdb"
        },
        {
          "actions": [],
          "created_date": 1714153493826,
          "description": "Write te results of function VMwareCBC: Get Alert By ID to a note.",
          "enabled": false,
          "export_key": "VMware CBC: Write Alert Custom Fields",
          "id": 52,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718034308319,
          "name": "VMware CBC: Write Alert Custom Fields",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case_on_creation",
          "programmatic_name": "vmware_cbc_update_case_on_creation_vmware_cbc_write_alert_custom_fields",
          "script_text": "from urllib.parse import quote as url_encode\n\n# Map VMware CBC workflow closure_reason values SOAR resolution id values.\nMAPPING_CLOSURE_REASON = {\n  \"Resolved\" : \"Resolved\",\n  \"No Reason\": \"Resolved\",\n  \"Resolved Benign Known Good\": \"Resolved\",\n  \"Duplicate Cleanup\" : \"Duplicate\",\n  \"Other\": \"Resolved\"\n}\n\n# Map VMware CBC determination values to SOAR resolution id values.\nMAPPING_DETERMINATION_ON_CLOSE = {\n  \"None\": \"Resolved\",\n  \"False positive\": \"Not an Issue\",\n  \"True positive\": \"Resolved\"\n}\n\nresults = playbook.functions.results.get_alert_by_id_results\n\nif not results.success:\n    incident.addNote(\"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e Unable to get case data to update custom fields.\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        alert = content.get(\"alert\")\n        alert_url = alert.get(\"alert_url\", None)\n        if alert_url:\n          # url encode the bracket characters [] \n          alert_url_urlencoded = alert_url.replace(\"[\", \"%5B\").replace(\"]\", \"%5D\")\n          incident.properties.vmware_cbc_alert_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027https://{0}\u0027\u003eAlert Link\u003c/a\u003e\".format(alert_url_urlencoded)\n        incident.properties.vmware_cbc_alert_type = alert.get(\"type\", None)\n        incident.properties.vmware_cbc_alert_reason_code = alert.get(\"reason_code\", None)\n        incident.properties.vmware_cbc_threat_id = alert.get(\"threat_id\", None)\n        workflow = alert.get(\"workflow\", None) or None\n        status = workflow.get(\"status\", None) if workflow.get(\"status\", None) else None\n        closure_reason = workflow.get(\"closure_reason\") if workflow.get(\"closure_reason\") else None\n        incident.properties.vmware_cbc_workflow_status = status.replace(\"_\", \" \").title() if status else None\n        incident.properties.vmware_cbc_workflow_closure_reason = closure_reason.replace(\"_\", \" \").title() if status else None\n        determination = alert.get(\"determination\", None)\n        determination_value = determination.get(\"value\") if determination.get(\"value\", None) else None\n        incident.properties.vmware_cbc_determination_value = determination_value.replace(\"_\", \" \").title() if determination_value else None\n        tags = alert.get(\"tags\", None)\n        incident.properties.vmware_cbc_tags = \", \".join(tags) if isinstance(tags, list) else None\n        incident.properties.vmware_cbc_attack_tactic = alert.get(\"attack_tactic\", None) or None\n        incident.addNote(\"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e Write Alert Custom Fields complete.\")\n\n        if incident.properties.vmware_cbc_workflow_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_CLOSURE_REASON.get(incident.properties.vmware_cbc_workflow_closure_reason, \"Resolved\")\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n      \n    else: \n        incident.addNote(\"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e Write Alert Custom Fields did NOT complete.\")",
          "tags": [],
          "uuid": "d94e273d-1946-4c52-becf-0e2a5f656be9"
        },
        {
          "actions": [],
          "created_date": 1714153493837,
          "description": "Write the alert notes function results to a note.",
          "enabled": false,
          "export_key": "VMware CBC: write alert notes",
          "id": 53,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718915335131,
          "name": "VMware CBC: write alert notes",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_case_on_creation",
          "programmatic_name": "vmware_cbc_update_case_on_creation_vmware_cbc_write_alert_notes",
          "script_text": "results = playbook.functions.results.get_alert_notes_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\")\n  if content:\n    note_text = \"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e created {0} notes in SOAR.\".format(content.get(\"count\"))\n  else:\n    note_text = \"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e function failed to get notes from Carbon Black Cloud.\"\nelse:\n  note_text = \"\u003cb\u003eVMware CBC: Update Case on Creation:\u003c/b\u003e function failed to get notes from Carbon Black Cloud.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "d8e17b5c-0871-4d1f-9c1c-fbeae9eab561"
        }
      ],
      "name": "vmware_cbc_update_case_on_creation",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_70ca7734-0ab4-4e93-8f21-9c1b5e943217",
        "id": 34,
        "name": "playbook_70ca7734_0ab4_4e93_8f21_9c1b5e943217",
        "type": "playbook",
        "uuid": "1d2d9ab8-6559-48e0-83f6-57c55272bcd7"
      },
      "tags": [],
      "type": "default",
      "uuid": "70ca7734-0ab4-4e93-8f21-9c1b5e943217",
      "version": 37
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "vmware_cbc_device_dt.cbc_device_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_015840da_da67_4bd4_8c5a_e8734cc525dc\" isExecutable=\"true\" name=\"playbook_015840da_da67_4bd4_8c5a_e8734cc525dc\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0pu96sf\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0pu96sf\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uekk0m\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0pu96sf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMware CBC: Populate CBC Device Row from Device\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3bca460-c6f0-4ad2-b691-1741615ead7c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uekk0m\u003c/incoming\u003e\u003coutgoing\u003eFlow_1hurx40\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0uekk0m\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1hurx40\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1hurx40\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_015840da_da67_4bd4_8c5a_e8734cc525dc\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1hurx40\" id=\"Flow_1hurx40_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"402\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"454\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uekk0m\" id=\"Flow_0uekk0m_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"318\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0pu96sf\" id=\"Flow_0pu96sf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"126\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"74\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"318\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"454\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718044247318,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_015840da_da67_4bd4_8c5a_e8734cc525dc",
      "description": {
        "content": "Automatic playbook to populate the columns of the CBC Device data table that from the devices endpoint. Note: Other columns of the CBC Device data table are populated from fields of the alert.",
        "format": "text"
      },
      "display_name": "VMware CBC: Update Device Row from Device",
      "export_key": "vmware_cbc_update_device_row_from_device",
      "field_type_handle": "playbook_015840da_da67_4bd4_8c5a_e8734cc525dc",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Update Device Row from Device",
        "export_key": "playbook_015840da_da67_4bd4_8c5a_e8734cc525dc",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_015840da_da67_4bd4_8c5a_e8734cc525dc",
        "uuid": "2ec1ef31-dc30-4bac-b121-3571cc7faded"
      },
      "has_logical_errors": false,
      "id": 48,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718044708022,
      "local_scripts": [],
      "name": "vmware_cbc_update_device_row_from_device",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_015840da-da67-4bd4-8c5a-e8734cc525dc",
        "id": 50,
        "name": "playbook_015840da_da67_4bd4_8c5a_e8734cc525dc",
        "type": "playbook",
        "uuid": "366bafd9-49fb-4b5c-9fa5-183d1f4f1437"
      },
      "tags": [],
      "type": "default",
      "uuid": "015840da-da67-4bd4-8c5a-e8734cc525dc",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 27,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_fbabad64_6aa1_431e_b087_a13caa6456d3\" isExecutable=\"true\" name=\"playbook_fbabad64_6aa1_431e_b087_a13caa6456d3\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_15vzsao\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Observations Detail Job\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"61ed2b9f-4de2-4489-8e34-5238a2a53867\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n\\n# Note: Either observation_ids or alert_id is required however only one can be specified.\\n# This playbook specifies an alert_id.\\nobservations ={\\n  \\\"alert_id\\\": incident.properties.vmware_cbc_alert_id\\n}\\n\\ninputs.vmware_cbc_observations = dumps(observations)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"observation_detail_job_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_15vzsao\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uslawc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_15vzsao\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_0uslawc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1mf5vbm\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"VMware CBC: Populate Observations Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"892344cc-7208-4ae2-8453-111e5fa79d70\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uslawc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1mf5vbm\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1mf5vbm\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_fbabad64_6aa1_431e_b087_a13caa6456d3\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mf5vbm\" id=\"Flow_1mf5vbm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"414\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uslawc\" id=\"Flow_0uslawc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15vzsao\" id=\"Flow_15vzsao_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"414\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"277.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718888712001,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_fbabad64_6aa1_431e_b087_a13caa6456d3",
      "description": {
        "content": "Manual playbook to get the Observations of an alert and update the Observations data table.",
        "format": "text"
      },
      "display_name": "VMware CBC: Update Observations DT",
      "export_key": "vmware_cbc_update_observations_dt",
      "field_type_handle": "playbook_fbabad64_6aa1_431e_b087_a13caa6456d3",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Update Observations DT",
        "export_key": "playbook_fbabad64_6aa1_431e_b087_a13caa6456d3",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_fbabad64_6aa1_431e_b087_a13caa6456d3",
        "uuid": "0bc689cd-d9f5-46d4-9c08-48c32f9497d6"
      },
      "has_logical_errors": false,
      "id": 63,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718910487948,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718888712077,
          "description": "Write observations detail job function results to a note",
          "enabled": false,
          "export_key": "VMware CBC: write observations detail job results to a note",
          "id": 87,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718888712077,
          "name": "VMware CBC: write observations detail job results to a note",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_update_observations_dt",
          "programmatic_name": "vmware_cbc_update_observations_dt_vmware_cbc_write_observations_detail_job_results_to_a_note",
          "script_text": "results = playbook.functions.results.observation_detail_job_results\ninputs = results.get(\"inputs\", None)\nobservation = inputs.get(\"vmware_cbc_observation\", None)\n  \nheader = u\"\u003cb\u003eVMware CBC: Observation Detail Job:\u003c/b\u003e {0}\".format(observation)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)\n",
          "tags": [],
          "uuid": "34e73b91-a5e0-4034-8fed-be363f906ced"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_update_observations_dt",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_fbabad64-6aa1-431e-b087-a13caa6456d3",
        "id": 65,
        "name": "playbook_fbabad64_6aa1_431e_b087_a13caa6456d3",
        "type": "playbook",
        "uuid": "6ca7d9f7-6578-4564-92f6-499fdf0216e8"
      },
      "tags": [],
      "type": "default",
      "uuid": "fbabad64-6aa1-431e-b087-a13caa6456d3",
      "version": 29
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 6,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_893b93d8_74c5_4c7e_9688_925f319fe939\" isExecutable=\"true\" name=\"playbook_893b93d8_74c5_4c7e_9688_925f319fe939\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1mq9p7s\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Get Alert By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3835f131-ada7-4a21-b056-4006d2a69123\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_alert_id = incident.properties.vmware_cbc_alert_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mq9p7s\u003c/incoming\u003e\u003coutgoing\u003eFlow_173p97w\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1mq9p7s\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_00q073p\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: write Get Alert by ID results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"c9faafbb-dc7e-4a2b-bb41-29ca31ac50cb\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_173p97w\u003c/incoming\u003e\u003coutgoing\u003eFlow_0w421ou\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_173p97w\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0w421ou\u003c/incoming\u003e\u003coutgoing\u003eFlow_00q073p\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0w421ou\" sourceRef=\"ScriptTask_3\" targetRef=\"ScriptTask_4\"/\u003e\u003csequenceFlow id=\"Flow_00q073p\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_893b93d8_74c5_4c7e_9688_925f319fe939\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_00q073p\" id=\"Flow_00q073p_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"482\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"534\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0w421ou\" id=\"Flow_0w421ou_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"398\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_173p97w\" id=\"Flow_173p97w_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mq9p7s\" id=\"Flow_1mq9p7s_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"96\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"44\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"534\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"398\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1713473881043,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_893b93d8_74c5_4c7e_9688_925f319fe939",
      "description": {
        "content": "Write the VMware Carbon Black Cloud alert JSON to an incident note in SOAR.",
        "format": "text"
      },
      "display_name": "VMware CBC: Write Alert JSON to Note",
      "export_key": "vmware_cbc_write_alert_json_to_note",
      "field_type_handle": "playbook_893b93d8_74c5_4c7e_9688_925f319fe939",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Write Alert JSON to Note",
        "export_key": "playbook_893b93d8_74c5_4c7e_9688_925f319fe939",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_893b93d8_74c5_4c7e_9688_925f319fe939",
        "uuid": "48b63efe-b725-4a6b-a77c-01df401dd109"
      },
      "has_logical_errors": false,
      "id": 29,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718910193971,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1713474059617,
          "description": "Write results from Get Alert By ID function to an incident note",
          "enabled": false,
          "export_key": "VMware CBC: write alert JSON to a note",
          "id": 39,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1713474059617,
          "name": "VMware CBC: write alert JSON to a note",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_write_alert_json_to_note",
          "programmatic_name": "vmware_cbc_write_alert_json_to_note_vmware_cbc_write_alert_json_to_a_note",
          "script_text": "results = 1",
          "tags": [],
          "uuid": "25c184f3-d626-44ee-a3ab-047e381a243d"
        },
        {
          "actions": [],
          "created_date": 1713474364215,
          "description": "Prepare alert results to pass to JSON conversion script",
          "enabled": false,
          "export_key": "VMware CBC: write Get Alert by ID results to a note",
          "id": 40,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1713474364215,
          "name": "VMware CBC: write Get Alert by ID results to a note",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_write_alert_json_to_note",
          "programmatic_name": "vmware_cbc_write_alert_json_to_note_vmware_cbc_write_get_alert_by_id_results_to_a_note",
          "script_text": "results = playbook.functions.results.get_alert_by_id_results\ninputs = results.get(\"inputs\", None)\nalert_id = inputs.get(\"vmware_cbc_alert_id\", None)\n  \nheader = u\"\u003cb\u003eVMware CBC: Get Device by ID:\u003c/b\u003e {0}\".format(alert_id)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "c9faafbb-dc7e-4a2b-bb41-29ca31ac50cb"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_write_alert_json_to_note",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_893b93d8-74c5-4c7e-9688-925f319fe939",
        "id": 31,
        "name": "playbook_893b93d8_74c5_4c7e_9688_925f319fe939",
        "type": "playbook",
        "uuid": "6e313a93-84b5-425f-9a80-efc71e074bd7"
      },
      "tags": [],
      "type": "default",
      "uuid": "893b93d8-74c5-4c7e-9688-925f319fe939",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047\" isExecutable=\"true\" name=\"playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1mq9p7s\u003c/outgoing\u003e\u003c/startEvent\u003e\u003csequenceFlow id=\"Flow_1mq9p7s\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_5\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_00q073p\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"VMware CBC: write Get Device by ID results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"2114e78a-eeb0-4a65-9924-7d79882cec86\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0hg6sod\u003c/incoming\u003e\u003coutgoing\u003eFlow_0w421ou\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0w421ou\u003c/incoming\u003e\u003coutgoing\u003eFlow_00q073p\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0w421ou\" sourceRef=\"ScriptTask_3\" targetRef=\"ScriptTask_4\"/\u003e\u003csequenceFlow id=\"Flow_00q073p\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"VMware CBC: Get Device By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6ca7b730-fb28-4be2-8825-3ab7e0e398c2\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.vmware_cbc_device_id = row.cbc_device_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_device_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mq9p7s\u003c/incoming\u003e\u003coutgoing\u003eFlow_0hg6sod\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0hg6sod\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hg6sod\" id=\"Flow_0hg6sod_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"222\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_00q073p\" id=\"Flow_00q073p_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"482\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"534\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0w421ou\" id=\"Flow_0w421ou_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"398\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mq9p7s\" id=\"Flow_1mq9p7s_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"138\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"534\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"398\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"137.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1715355124359,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047",
      "description": {
        "content": "Write the VMware Carbon Black Cloud device JSON to an incident note in SOAR.",
        "format": "text"
      },
      "display_name": "VMware CBC: Write Device JSON to Note",
      "export_key": "vmware_cbc_write_device_json_to_note",
      "field_type_handle": "playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Write Device JSON to Note",
        "export_key": "playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047",
        "uuid": "5ed5a642-56cd-41e4-80c7-e302c08e1316"
      },
      "has_logical_errors": false,
      "id": 39,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718910227608,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1715355124420,
          "description": "Write results from Get Alert By ID function to an incident note",
          "enabled": false,
          "export_key": "VMware CBC: write alert JSON to a note",
          "id": 61,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1715355391294,
          "name": "VMware CBC: write alert JSON to a note",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_write_device_json_to_note",
          "programmatic_name": "vmware_cbc_write_device_json_to_note_vmware_cbc_write_alert_json_to_a_note",
          "script_text": "results = 1",
          "tags": [],
          "uuid": "4c11b271-611f-487b-805a-da114fbb0cf2"
        },
        {
          "actions": [],
          "created_date": 1715355124430,
          "description": "Prepare device results to pass to JSON conversion script",
          "enabled": false,
          "export_key": "VMware CBC: write Get Device by ID results to a note",
          "id": 62,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1715355391294,
          "name": "VMware CBC: write Get Device by ID results to a note",
          "object_type": "vmware_cbc_device_dt",
          "playbook_handle": "vmware_cbc_write_device_json_to_note",
          "programmatic_name": "vmware_cbc_write_device_json_to_note_vmware_cbc_write_get_alert_by_id_results_to_a_note",
          "script_text": "results = playbook.functions.results.get_device_by_id_results\ninputs = results.get(\"inputs\", None)\ndevice_id = inputs.get(\"vmware_cbc_device_id\", None)\n  \nheader = u\"\u003cb\u003eVMware CBC: Get Device by ID:\u003c/b\u003e {0}\".format(device_id)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "2114e78a-eeb0-4a65-9924-7d79882cec86"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_write_device_json_to_note",
      "object_type": "vmware_cbc_device_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_183eae71-51c0-4e8e-b6aa-9a10095f6047",
        "id": 41,
        "name": "playbook_183eae71_51c0_4e8e_b6aa_9a10095f6047",
        "type": "playbook",
        "uuid": "f97083ed-37b3-45d1-9d89-50aadf1ad096"
      },
      "tags": [],
      "type": "default",
      "uuid": "183eae71-51c0-4e8e-b6aa-9a10095f6047",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3\" isExecutable=\"true\" name=\"playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_15vzsao\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"VMware CBC: Post Observations Detail Job\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"61ed2b9f-4de2-4489-8e34-5238a2a53867\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n\\n# Note: Either observation_ids or alert_id is required however only one can be specified.\\n# This playbook specifies an alert_id.\\nobservations ={\\n  \\\"alert_id\\\": incident.properties.vmware_cbc_alert_id\\n}\\n\\ninputs.vmware_cbc_observations = dumps(observations)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"observation_detail_job_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_15vzsao\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uslawc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_15vzsao\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"VMware CBC: write observations detail job results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"55eec050-a08f-4ba1-9d70-6a067cc87144\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uslawc\u003c/incoming\u003e\u003coutgoing\u003eFlow_0viq80l\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0uslawc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0fz7hgs\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0viq80l\" sourceRef=\"ScriptTask_2\" targetRef=\"ScriptTask_4\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0viq80l\u003c/incoming\u003e\u003coutgoing\u003eFlow_0fz7hgs\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0fz7hgs\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0fz7hgs\" id=\"Flow_0fz7hgs_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"512\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"574\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0viq80l\" id=\"Flow_0viq80l_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"372\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"428\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uslawc\" id=\"Flow_0uslawc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"288\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15vzsao\" id=\"Flow_15vzsao_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"288\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"574\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"428\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1718896050123,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3",
      "description": {
        "content": "Write the VMware Carbon Black Cloud Observations of an alert JSON to an incident note in SOAR.",
        "format": "text"
      },
      "display_name": "VMware CBC: Write Observations JSON to Note",
      "export_key": "vmware_cbc_write_observations_json_to_note",
      "field_type_handle": "playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3",
      "fields_type": {
        "actions": [],
        "display_name": "VMware CBC: Write Observations JSON to Note",
        "export_key": "playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3",
        "uuid": "46573d84-2f97-4005-8d45-7c2ea7de7533"
      },
      "has_logical_errors": false,
      "id": 64,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1718910364653,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1718896050185,
          "description": "Write observations detail job function results to a note",
          "enabled": false,
          "export_key": "VMware CBC: write observations detail job results to a note",
          "id": 89,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1718896050185,
          "name": "VMware CBC: write observations detail job results to a note",
          "object_type": "incident",
          "playbook_handle": "vmware_cbc_write_observations_json_to_note",
          "programmatic_name": "vmware_cbc_write_observations_json_to_note_vmware_cbc_write_observations_detail_job_results_to_a_note",
          "script_text": "results = playbook.functions.results.observation_detail_job_results\ninputs = results.get(\"inputs\", None)\nobservation = inputs.get(\"vmware_cbc_observation\", None)\n  \nheader = u\"\u003cb\u003eVMware CBC: Observation Detail Job:\u003c/b\u003e {0}\".format(observation)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)\n",
          "tags": [],
          "uuid": "55eec050-a08f-4ba1-9d70-6a067cc87144"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.vmware_cbc_alert_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "vmware_cbc_write_observations_json_to_note",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_4d2a6cff-71b4-43d2-9fd5-61d3e93253c3",
        "id": 66,
        "name": "playbook_4d2a6cff_71b4_43d2_9fd5_61d3e93253c3",
        "type": "playbook",
        "uuid": "e3631310-1cab-4c07-8cbd-fb137920877f"
      },
      "tags": [],
      "type": "default",
      "uuid": "4d2a6cff-71b4-43d2-9fd5-61d3e93253c3",
      "version": 7
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [
    {
      "actions": [],
      "created_date": 1709828236229,
      "description": "This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note. A workflow property is used to share the json to convert and identify parameters used on how to perform the conversion.\nTypically, a function will create workflow property and this script will run after that function to perform the conversion.\n\nFeatures:\n\n* Display the hierarchical nature of json, presenting the json keys (sorted if specified) as bold labels\n* Provide links to found URLs\n* Create either an incident note or add results to an incident (custom) rich text field.",
      "enabled": false,
      "export_key": "Convert JSON to rich text v1.3",
      "id": 24,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1709828236229,
      "name": "Convert JSON to rich text v1.3",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "convert_json_to_rich_text_13",
      "script_text": "# (c) Copyright IBM Corp. 2010, 2023. All Rights Reserved.\nVERSION = 1.3\n\"\"\"\n  This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note.\n  A workflow property is used to define the json to convert and identify parameters used on how to perform the conversion.\n  Typically, a function will create workflow property and this script will run after that function to perform the conversion.\n  Features:\n    * Display the hierarchical nature of json, presenting the json keys as bold labels\n    * Provide links to found URLs\n    * Create either an incident note or add results to an incident (custom) rich text field.\n  \n  In order to use this script, define a workflow property called: convert_json_to_rich_text, to define the json and parameters to use for the conversion.\n  Workflow properties can be added using a command similar to this:\n  workflow.addProperty(\u0027convert_json_to_rich_text\u0027, {\n    \"version\": 1.3,\n    \"header\": \"Artifact scan results for: {}\".format(artifact.value),\n    \"padding\": 10,\n    \"separator\": u\"\u003cbr /\u003e\",\n    \"sort\": True,\n    \"json\": results.content,\n    \"json_omit_list\": [\"omit\"],\n    \"incident_field\": None\n  })\n  \n  Format of workflow.property.convert_json_to_rich_text:\n  { \n    \"version\": 1.3, [this is for future compatibility]\n    \"header\": str, [header line to add to converted json produced or None. Ex: Results from scanning artifact: xxx. The header may contain rich text tags]\n    \"padding\": 10, [padding for nested json elements, or defaults to 10]\n    \"separator\": u\"\u003cbr /\u003e\"|list such as [\u0027\u003cspan\u003e\u0027,\u0027\u003c/span\u003e\u0027], [html separator between json keys and lists or defaults to html break: \u0027\u003cbr /\u003e\u0027. \n                                                If a list, then the data is brackets by the pair specified]\n    \"sort\": True|False, [sort the json keys at each level when displayed]\n    \"json\": json, [required json to convert]\n    \"json_omit_list\": [list of json keys to exclude or None]\n    \"incident_field\": \"\u003cincident_field\u003e\" [indicates a builtin rich text incident field, such as \u0027description\u0027 \n                                          or a custom rich text field in the format: \u0027properties.\u003cfield\u003e\u0027. default: create an incident note]\n  }\n\n  For playbooks, use playbook.addProperty() with the same format as workflow.addProperty()\n\n  Playbooks can also use playbook.functions.results.convert_json_to_rich_text using the standard function output which contains the \u0027content\u0027 json element.\n  When using playbook.functions.results.convert_json_to_rich_text with standard function results, all the defaults for padding, separator, etc. are used.\n\"\"\"\n\nimport re\n\n# needed for python 3\ntry:\n    unicode(\"abc\") # fails in py3\n    py2 = True\nexcept:\n    unicode = str\n    py2 = False\n\n\nrc = re.compile(r\u0027http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.\u0026+#\\?]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+\u0027)\n\nclass ConvertJson:\n    \"\"\"Class to hold the conversion parameters and perform the conversion\"\"\"\n\n    def __init__(self, omit_keys=[], padding=10, separator=u\"\u003cbr /\u003e\", sort_keys=False):\n        self.omit_keys = omit_keys\n        self.padding = padding\n        self.separator = separator\n        self.sort_keys = sort_keys\n\n\n    def format_link(self, item):\n        \"\"\"[summary]\n          Find embedded urls (http(s)) and add html anchor tags to display as links\n          Args:\n              item ([string])\n\n          Returns:\n              [str]: None|original text if no links|text with html links\n        \"\"\"\n        formatted_item = item\n        if py2:\n            num_type = bool(item and isinstance(item, (int, long, bool, float)))\n        else:\n            num_type = bool(item and isinstance(item, (int, bool, float)))\n\n        if item and not num_type:\n            list = rc.findall(item)\n            if list:\n                for link in list:\n                    formatted_item = formatted_item.replace(link, u\"\u003ca target=\u0027blank\u0027 href=\u0027{0}\u0027\u003e{0}\u003c/a\u003e\".format(link))\n\n        return formatted_item\n\n    def expand_list(self, list_value, is_list=False):\n        \"\"\"[summary]\n          convert items to html, adding indents to nested dictionaries.\n          Args:\n              list_value ([dict|list]): json element\n\n          Returns:\n              [str]: html converted code\n        \"\"\"\n        if not isinstance(list_value, list):\n            return self.format_link(list_value)\n        elif not list_value:\n            return u\"None\u003cbr\u003e\"\n\n        try:\n            items_list = []  # this will ensure list starts on second line of key label\n            for item in list_value:\n                if isinstance(item, dict):\n                    result = self.convert_json_to_rich_text(item)\n                    if is_list:\n                        items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(result))\n                    else:\n                        items_list.append(result)\n                elif isinstance(item, list):\n                    items_list.append(self.expand_list(item, is_list=True))\n                elif is_list:\n                    items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(self.format_link(unicode(item))))\n                else:\n                    items_list.append(self.format_link(unicode(item)))\n\n            expand_list_result = self.add_separator(self.separator if not is_list else u\"\",\n                                                    items_list,\n                                                    is_list=is_list)\n\n            if is_list:\n                return u\"\u003cul\u003e{}\u003c/ul\u003e\".format(expand_list_result)\n            else:\n                return u\"\u003cdiv style=\u0027padding:5px\u0027\u003e{}\u003c/div\u003e\".format(expand_list_result)\n        except Exception as err:\n            return str(err)\n\n    def convert_json_to_rich_text(self, sub_dict):\n        \"\"\"[summary]\n          Walk dictionary tree and convert to html for better display\n          Args:\n              sub_dict ([type]): [description]\n\n          Returns:\n              [type]: [description]\n        \"\"\"\n        notes = []\n        if sub_dict and isinstance(sub_dict, (list, dict)):\n            if isinstance(sub_dict, list):\n                expanded_list = self.expand_list(sub_dict, is_list=True)\n                notes.append(self.add_separator(self.separator, expanded_list))\n            else:\n                keys = sorted (sub_dict.keys()) if self.sort_keys else sub_dict.keys()\n\n                for key in keys:\n                    if key not in self.omit_keys:\n                        value = sub_dict[key]\n                        is_list = isinstance(value, list)\n                        item_list = [u\"\u003cstrong\u003e{0}\u003c/strong\u003e: \".format(key)]\n                        if isinstance(value, dict):\n                            convert_result = self.convert_json_to_rich_text(value)\n                            if convert_result:\n                                item_list.append(u\"\u003cdiv style=\u0027padding:{}px\u0027\u003e{}\u003c/div\u003e\".format(self.padding, convert_result))\n                            else:\n                                item_list.append(u\"None\u003cbr\u003e\")\n                        else:\n                            item_list.append(self.expand_list(value, is_list=is_list))\n\n                        notes.append(self.add_separator(self.separator, u\"\".join(make_unicode(v) for v in item_list), is_list=is_list))\n\n        result_notes = u\"\".join(notes)\n        if isinstance(self.separator, list):\n            return result_notes\n        else:\n            return result_notes.replace(\n                u\"\u003c/div\u003e{0}\".format(self.separator), u\"\u003c/div\u003e\").replace(\n                u\"{0}\u003c/div\u003e\".format(self.separator), u\"\u003c/div\u003e\"\n            )  # tighten up result\n\n    def add_separator(self, separator, items, is_list=False):\n        \"\"\"\n        apply the separator to the data\n        :param separator: None, str or list such as [\u0027\u003cspan\u003e\u0027, \u0027\u003c/span\u003e\u0027]\n        :param items: str or list to add separator\n        :return: text with separator applied\n        \"\"\"\n        _items = items\n\n        if not _items:\n            return \"\u003cbr\u003e\"\n\n        if not isinstance(_items, list):\n            _items = [_items]\n\n        if isinstance(separator, list):\n            return u\"\".join([u\"{}{}{}\".format(separator[0], item, separator[1]) for item in _items])\n\n        return u\"{}{}\".format(separator.join(_items), separator if not is_list else u\"\")\n\ndef make_unicode(value):\n    if value is None:\n        return \u0027None\u0027\n\n    return unicode(value)\n\ndef get_results(property_name):\n    if playbook and playbook.functions.results[property_name] is not None:\n        return playbook.functions.results[property_name]\n    elif playbook and playbook.properties[property_name] is not None:\n        return playbook.properties[property_name]\n    elif workflow and workflow.properties[property_name] is not None:\n        return workflow.properties[property_name]\n\n    return None\n\ndef get_properties(property_name):\n    \"\"\"\n    Logic to collect the json and parameters from a workflow property.\n    Args:\n      property_name: workflow property to reference\n    Returns:\n      padding, separator, header, json_omit_list, incident_field, json, sort_keys\n    \"\"\"\n    result_properties = get_results(property_name)\n    if not result_properties:\n        helper.fail(\"Playbook/workflow property not found: {}\".format(property_name))\n\n    padding = int(result_properties.get(\"padding\", 10))\n    separator = result_properties.get(\"separator\", u\"\u003cbr /\u003e\")\n    if isinstance(separator, list) and len(separator) != 2:\n        helper.fail(\"list of separators should be specified as a pair such as [\u0027\u003cdiv\u003e\u0027, \u0027\u003c/div\u003e\u0027]: {}\".format(separator))\n\n    header = result_properties.get(\"header\")\n    sort_keys = bool(result_properties.get(\"sort\", False))\n    json_omit_list = result_properties.get(\"json_omit_list\")\n    if not json_omit_list:\n        json_omit_list = []\n    incident_field = result_properties.get(\"incident_field\")\n    \n    # workflow formatted content is \u0027json\u0027. Standard functions is \u0027content\u0027\n    json = result_properties.get(\"json\") if result_properties.get(\"json\") else result_properties.get(\"content\")\n    json_err = None\n    # is there an issue we need handle now?\n    if not json and \\\n        result_properties.get(\"success\") == False and result_properties.get(\"reason\"):\n        json_err = result_properties.get(\"reason\")\n    \n    return padding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys\n\n\n## S T A R T\npadding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys = get_properties(\u0027convert_json_to_rich_text\u0027)\nif json_err:\n    result = \"Result error: {}\".format(json_err)\nelse:\n    if header:\n        if isinstance(separator, list):\n            hdr = u\"{0}{1}{2}\".format(separator[0], header, separator[1])\n        else:\n            hdr = u\"{0}{1}\".format(header, separator)\n    else:\n        hdr = u\"\"\n\n    convert = ConvertJson(omit_keys=json_omit_list, padding=padding, separator=separator, sort_keys=sort_keys)\n    converted_json = convert.convert_json_to_rich_text(json)\n    result = u\"{}{}\".format(hdr, converted_json if converted_json else \"\\nNone\")\n\nrich_text_note = helper.createRichText(result)\nif incident_field:\n    incident[incident_field] = rich_text_note\nelse:\n    incident.addNote(rich_text_note)\n",
      "tags": [],
      "uuid": "64d3e6da-8b56-4d19-9ce8-a75586f71dad"
    },
    {
      "actions": [],
      "created_date": 1716476610256,
      "description": "Write the function results of get device into the data table in a new row.",
      "enabled": false,
      "export_key": "VMware CBC: Populate CBC Device Row from Alert",
      "id": 67,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1718049368064,
      "name": "VMware CBC: Populate CBC Device Row from Alert",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "vmware_cbc_populate_device_row_in_device_dt",
      "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alert_by_id_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n\n    alert = content.get(\"alert\", [])\n    device_row = incident.addRow(\"vmware_cbc_device_dt\")\n    device_row.cbc_query_date = datetime.now()\n    device_row.cbc_device_id = alert.get(\"device_id\", None)\n    device_row.cbc_device_name = alert.get(\"device_name\", None)\n    device_row.cbc_device_policy = alert.get(\"device_policy\", None)\n    device_row.cbc_device_policy_id = alert.get(\"device_policy_id\", None)\n    device_row.cbc_device_os_version = alert.get(\"device_os_version\", None)\n    device_row.cbc_device_username = alert.get(\"device_username\", None)\n    device_row.cbc_device_external_ip = alert.get(\"device_external_ip\", None)\n    device_row.cbc_device_internal_ip = alert.get(\"device_internal_ip\", None)\n    device_row.cbc_device_location = alert.get(\"device_location\", None)\n\n    note_text = \"\u003cb\u003eVMware CBC: Populate CBC Device Row from Alert:\u003c/b\u003e Update complete.\"\n  else:\n    note_text = \"\u003cb\u003eVMware CBC: Populate CBC Device Row from Alert:\u003c/b\u003e No alert found (no content).\"\nelse:\n  note_text = \"\u003cbVMware CBC: Populate CBC Device Row from Alert:\u003c/b\u003e Update did not complete. Reason = {0}\".format(results.get(\"reason\", None))\n    \nincident.addNote(note_text)",
      "tags": [],
      "uuid": "6e472039-5b92-453c-ba5c-47c70fa77a8f"
    },
    {
      "actions": [],
      "created_date": 1718027220067,
      "description": "Write the results of get device by ID function to the Device data table.",
      "enabled": false,
      "export_key": "VMware CBC: Populate CBC Device Row from Device",
      "id": 70,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1719856958002,
      "name": "VMware CBC: Populate CBC Device Row from Device",
      "object_type": "vmware_cbc_device_dt",
      "playbook_handle": null,
      "programmatic_name": "vmware_cbc_refetch_device_in_row_vmware_cbc_populate_device_data_in_row",
      "script_text": "results = playbook.functions.results.get_device_by_id_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    device = content.get(\"device\", None)\n    if device:\n      row.cbc_device_quarantined = device.get(\"quarantined\", None)\n      row.cbc_device_status = device.get(\"status\", None)\n      sensor_states =  device.get(\"sensor_states\", None) \n      row.cbc_sensor_state = \", \".join(sensor_states) if isinstance(sensor_states, list) else None\n      note_text = f\"\u003cb\u003eVMware CBC: Populate Device Row from Device:\u003c/b\u003e Update complete.\"\n    else:\n      note_text = f\"\u003cb\u003eVMware CBC: Populate Device Row from Device:\u003c/b\u003e Unable to get device data to update CBC Device data table.\"\n  else:\n    note_text = f\"\u003cb\u003eVMware CBC: Populate Device Row from Device:\u003c/b\u003e Unable to get device data to update CBC Device data table - no content.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cb\u003eVMware CBC: Populate Device Row from Device:\u003c/b\u003e Unable to get device data to update CBC Device data table.\u003cbr\u003e reason: {reason}\"\n  \nincident.addNote(note_text)\n",
      "tags": [],
      "uuid": "f3bca460-c6f0-4ad2-b691-1741615ead7c"
    },
    {
      "actions": [],
      "created_date": 1718889042971,
      "description": "Write observations function results to the Observations data table and create hash artifacts.",
      "enabled": false,
      "export_key": "VMware CBC: Populate Observations Data Table",
      "id": 88,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1718914465485,
      "name": "VMware CBC: Populate Observations Data Table",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "vmware_cbc_update_observations_dt_vmware_cbc_update_observations_data_table",
      "script_text": "from datetime import datetime\n\ndef hash_is_sha256(_hash) -\u003e bool:\n    return len(_hash) == 64\n\ndef hash_is_sha1(_hash) -\u003e bool:\n    return len(_hash) == 40\n\ndef hash_is_md5(_hash) -\u003e bool:\n    return len(_hash) == 32\n\n\nresults = playbook.functions.results.observation_detail_job_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    observations = content.get(\"results\", [])\n    num_rows = 0\n    num_observations = len(observations)\n    num_artifacts = 0\n    for observation in observations:\n      file_scan_result = observation.get(\"file_scan_result\", None)\n      # To limit results only add to the data table observations that have file scan results.\n      if file_scan_result:\n        row = incident.addRow(\"vmware_cbc_observations_dt\")\n        num_rows += 1\n        row.cbc_query_date = datetime.now()\n        row.cbc_device_time = observation.get(\"device_timestamp\", None)\n        row.cbc_filemod_name = observation.get(\"filemod_name\", None)\n        row.cbc_filemod_reputation = observation.get(\"filemod_reputation\", None)\n        row.cbc_file_scan_result = file_scan_result\n      \n        filemod_hash = observation.get(\"filemod_hash\", [])\n        if filemod_hash:\n          row.filemod_hash =\u0027, \u0027.join(str(f_hash) for f_hash in filemod_hash)\n          for f_hash in filemod_hash:\n            if hash_is_md5(f_hash):\n              incident.addArtifact(\"Malware MD5 Hash\", f_hash, f\"VMware Carbon Black Observations: MD5 hash from from file {row.cbc_filemod_name}.\")\n              num_artifacts += 1\n            elif hash_is_sha256(f_hash):\n              incident.addArtifact(\"Malware SHA-256 Hash\", f_hash, f\"VMware Carbon Black Observations: SHA-256 hash from file {row.cbc_filemod_name}.\")\n              num_artifacts += 1\n            elif hash_is_sha1(f_hash):\n              incident.addArtifact(\"Malware SHA-1 Hash\", f_hash, f\"VMware Carbon Black Observations: SHA-1 hash from file {row.cbc_filemod_name}.\")\n              num_artifacts += 1\n            \n    note_text = f\"\u003cb\u003eVMware CBC: Update Observation DT:\u003c/b\u003e Update complete:\u003cbr\u003e {num_observations} observations found, {num_rows} rows added to data table and {num_artifacts} artifacts added.\"\n  else:\n    note_text = \"\u003cbVMware CBC: Update Observation DT:\u003c/b\u003e Failed function to get observations for Observations data table - no content.\"\nelse:\n  reason = results.get(\"reason\", None)\n  note_text = f\"\u003cbVMware CBC: Update Observation DT:\u003c/b\u003e Failed function to get observations for Observations data table.\u003cbr\u003eReason = {reason}\"\n  \nincident.addNote(note_text)",
      "tags": [],
      "uuid": "892344cc-7208-4ae2-8453-111e5fa79d70"
    }
  ],
  "server_version": {
    "build_number": 9097,
    "major": 50,
    "minor": 0,
    "version": "50.0.0"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "CBC Device",
      "export_key": "vmware_cbc_device_dt",
      "fields": {
        "cbc_device_external_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_external_ip",
          "hide_notification": false,
          "id": 403,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_external_ip",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "External IP",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "5ae3d525-5ca3-473f-ba04-383bdbc4690b",
          "values": [],
          "width": 86
        },
        "cbc_device_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_id",
          "hide_notification": false,
          "id": 457,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_id",
          "operation_perms": {},
          "operations": [],
          "order": 12,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Device ID",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "32114c24-2b43-47a9-a72b-111761cf85bf",
          "values": [],
          "width": 73
        },
        "cbc_device_internal_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_internal_ip",
          "hide_notification": false,
          "id": 405,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_internal_ip",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Internal IP",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "462fa543-5fed-4f63-8d84-1f78956f3991",
          "values": [],
          "width": 84
        },
        "cbc_device_location": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_location",
          "hide_notification": false,
          "id": 406,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_location",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Location",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "8c04fa7f-8c46-47c9-ba07-a7a75329e1d4",
          "values": [],
          "width": 65
        },
        "cbc_device_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_name",
          "hide_notification": false,
          "id": 407,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_name",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Name",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "08ad1d16-1c85-460b-8f47-6bec5e9f04c5",
          "values": [],
          "width": 44
        },
        "cbc_device_os_version": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_os_version",
          "hide_notification": false,
          "id": 408,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_os_version",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "OS Version",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "40fb8732-1e5e-4851-8e66-aa7371ba6758",
          "values": [],
          "width": 83
        },
        "cbc_device_policy": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_policy",
          "hide_notification": false,
          "id": 409,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_policy",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Policy",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "acf75a66-01e4-4372-8325-51a03b3dd690",
          "values": [],
          "width": 46
        },
        "cbc_device_policy_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_policy_id",
          "hide_notification": false,
          "id": 459,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_policy_id",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Policy ID",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "85b5ad03-8d35-4a23-a14f-5f805e4c4894",
          "values": [],
          "width": 68
        },
        "cbc_device_quarantined": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_quarantined",
          "hide_notification": false,
          "id": 462,
          "input_type": "boolean",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_quarantined",
          "operation_perms": {},
          "operations": [],
          "order": 9,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Quarantined",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "8fc89abd-4484-4b1e-8e4e-953db2ecda23",
          "values": [],
          "width": 95
        },
        "cbc_device_status": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_status",
          "hide_notification": false,
          "id": 465,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_status",
          "operation_perms": {},
          "operations": [],
          "order": 10,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Status",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "feb8ecdd-2873-48ea-a7b6-74750b48077e",
          "values": [],
          "width": 49
        },
        "cbc_device_username": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_device_username",
          "hide_notification": false,
          "id": 411,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_username",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Username",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "4c278df3-4306-44d4-acfb-744d9d5355e8",
          "values": [],
          "width": 77
        },
        "cbc_query_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_query_date",
          "hide_notification": false,
          "id": 413,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_query_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Query Date",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "07fb42be-dee2-4c6c-9db0-9a0b6eaf2b7b",
          "values": [],
          "width": 85
        },
        "cbc_sensor_state": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_device_dt/cbc_sensor_state",
          "hide_notification": false,
          "id": 463,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_sensor_state",
          "operation_perms": {},
          "operations": [],
          "order": 11,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Sensor State",
          "tooltip": "",
          "type_id": 1032,
          "uuid": "8b21e2fc-2863-41f7-98a1-84884583691a",
          "values": [],
          "width": 97
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "vmware_cbc_device_dt",
      "uuid": "4a8fc247-6077-44bf-a546-db5b4ced6e1a"
    },
    {
      "actions": [],
      "display_name": "Observations",
      "export_key": "vmware_cbc_observations_dt",
      "fields": {
        "cbc_device_time": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_observations_dt/cbc_device_time",
          "hide_notification": false,
          "id": 470,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_time",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Device Time",
          "tooltip": "",
          "type_id": 1067,
          "uuid": "b5b5ca25-805d-43ee-9c26-144725031c2a",
          "values": [],
          "width": 93
        },
        "cbc_file_scan_result": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_observations_dt/cbc_file_scan_result",
          "hide_notification": false,
          "id": 471,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_file_scan_result",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "File Scan Result",
          "tooltip": "",
          "type_id": 1067,
          "uuid": "3eb34f4f-66bb-41cc-a899-2426179a7c9f",
          "values": [],
          "width": 122
        },
        "cbc_filemod_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_observations_dt/cbc_filemod_name",
          "hide_notification": false,
          "id": 472,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_filemod_name",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Filemod Name",
          "tooltip": "",
          "type_id": 1067,
          "uuid": "3ccb0b48-6a89-4a71-bcdc-0dfc66ad9019",
          "values": [],
          "width": 110
        },
        "cbc_filemod_reputation": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_observations_dt/cbc_filemod_reputation",
          "hide_notification": false,
          "id": 473,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_filemod_reputation",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Filemod Reputation",
          "tooltip": "",
          "type_id": 1067,
          "uuid": "d3ceed14-0335-402d-b605-356d9ab43409",
          "values": [],
          "width": 150
        },
        "cbc_query_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_observations_dt/cbc_query_date",
          "hide_notification": false,
          "id": 474,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_query_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Query Date",
          "tooltip": "",
          "type_id": 1067,
          "uuid": "14031604-e766-4360-b4ee-59440fa2da6a",
          "values": [],
          "width": 85
        },
        "filemod_hash": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_observations_dt/filemod_hash",
          "hide_notification": false,
          "id": 475,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "filemod_hash",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Filemod Hash",
          "tooltip": "",
          "type_id": 1067,
          "uuid": "489468f1-b4fe-4ae3-9c2d-ea92c7e09ae9",
          "values": [],
          "width": 104
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "vmware_cbc_observations_dt",
      "uuid": "570b290f-22f4-454d-a71b-d2a7dd902e13"
    },
    {
      "actions": [],
      "display_name": "Processes",
      "export_key": "vmware_cbc_processes_dt",
      "fields": {
        "cbc_device_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_device_id",
          "hide_notification": false,
          "id": 461,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_device_id",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Device ID",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "9df8547f-e8ed-47be-815c-982c561633fb",
          "values": [],
          "width": 73
        },
        "cbc_process_cmd": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_cmd",
          "hide_notification": false,
          "id": 420,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_cmd",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "CMD",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "49e12d28-5a11-428a-8fa3-4d3a20a02ea3",
          "values": [],
          "width": 81
        },
        "cbc_process_effective_reputation": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_effective_reputation",
          "hide_notification": false,
          "id": 421,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_effective_reputation",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Reputation",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "1d596f36-1385-4071-a460-27f575d7db35",
          "values": [],
          "width": 89
        },
        "cbc_process_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_name",
          "hide_notification": false,
          "id": 423,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_name",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Name",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "f14818f6-4d96-44d5-bd75-e02669d71e65",
          "values": [],
          "width": 81
        },
        "cbc_process_pid": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_pid",
          "hide_notification": false,
          "id": 456,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_pid",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "PID",
          "tooltip": "Process ID",
          "type_id": 1035,
          "uuid": "11948a08-d088-430d-9aab-d32cb47511ef",
          "values": [],
          "width": 50
        },
        "cbc_process_policy_action": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_policy_action",
          "hide_notification": false,
          "id": 425,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_policy_action",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Policy Action",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "6d2397db-934f-4996-bcc1-cd5fd0f35fd4",
          "values": [],
          "width": 105
        },
        "cbc_process_sha256": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_sha256",
          "hide_notification": false,
          "id": 422,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_sha256",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Sha256",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "140e3305-7c9d-4606-9827-adcfdd10fa5f",
          "values": [],
          "width": 81
        },
        "cbc_process_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_type",
          "hide_notification": false,
          "id": 437,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_type",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Type",
          "tooltip": "Process type: Parent or Child",
          "type_id": 1035,
          "uuid": "9ed7b0ab-9ee2-42d3-9028-05cb475b9493",
          "values": [],
          "width": 58
        },
        "cbc_process_username": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "vmware_cbc_processes_dt/cbc_process_username",
          "hide_notification": false,
          "id": 426,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "cbc_process_username",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Username",
          "tooltip": "",
          "type_id": 1035,
          "uuid": "8bc9ee89-6a27-4e78-955d-735e0b3fbd23",
          "values": [],
          "width": 82
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "vmware_cbc_processes_dt",
      "uuid": "93958e50-6ad6-4309-b1f3-cc82f9c8a791"
    }
  ],
  "workflows": [],
  "workspaces": []
}
