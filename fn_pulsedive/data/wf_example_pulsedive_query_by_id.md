<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: Pulsedive Query by ID

## Function - Pulsedive: Query by ID

### API Name
`pulsedive_query_id`

### Output Name
``

### Message Destination
`fn_pulsedive`

### Pre-Processing Script
```python
inputs.incident_id = incident.id

# custom artifact of type integer
inputs.pulsedive_id = artifact.value

# id type: indicator, threat, or feed
inputs.pulsedive_query_type = rule.properties.pulsedive_query_type

# report type: recent info, links, summary, history 
inputs.pulsedive_id_report_type = rule.properties.pulsedive_id_report_type

# name of attachment for report details
inputs.attachment_name = rule.properties.attachment_name

# pretty print option
inputs.pulsedive_pretty = rule.properties.pulsedive_pretty
```

### Post-Processing Script
```python
# get summary info for notes

# id of indicator, threat or feed
pd_id = results.get("resp_json")["inputs"]["pulsedive_id"]

# query type
if results.get("resp_json")["inputs"]["pulsedive_query_type"]["name"] == "Indicator":
  pd_type = "Indicator"
elif results.get("resp_json")["inputs"]["pulsedive_query_type"]["name"] == "Threat":
  pd_type = "Threat"
else:
  pd_type = "Feed"
  
# report type
report = results.get("resp_json")["inputs"]["pulsedive_id_report_type"]["name"]

# set text parameters
note_text = u"<p><b>Pulsedive Query by ID Summary</b></p> \
<p><b>{} id:</b> {}</p> \
<p><b>Report type:</b> {}</p> \
For full dataset, see attachment '{}'".format(pd_type, pd_id, report, results.get("att_name"))

# Create note text
note = helper.createRichText(note_text)

# Create incident note
incident.addNote(note)

```

---

