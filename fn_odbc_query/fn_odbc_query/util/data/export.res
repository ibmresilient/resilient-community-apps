{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1716240872882,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sql_condition_value3",
      "hide_notification": false,
      "id": 1393,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sql_condition_value3",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sql_condition_value3",
      "tooltip": "",
      "type_id": 11,
      "uuid": "bfae970d-3466-4280-9d54-d830ea36a657",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sql_condition_value1",
      "hide_notification": false,
      "id": 1394,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sql_condition_value1",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sql_condition_value1",
      "tooltip": "",
      "type_id": 11,
      "uuid": "cf253679-c066-424b-a6c9-897b27dbd32c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/db_label",
      "hide_notification": false,
      "id": 1395,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "db_label",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "db_label",
      "tooltip": "Label given to the database you wish to use",
      "type_id": 11,
      "uuid": "dae6db5b-bc25-483b-932f-48a2025cef0d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sql_condition_value2",
      "hide_notification": false,
      "id": 1396,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sql_condition_value2",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sql_condition_value2",
      "tooltip": "",
      "type_id": 11,
      "uuid": "e3f3aebf-c49d-467f-8ed8-0051951adcc1",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sql_query",
      "hide_notification": false,
      "id": 1397,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "sql_query",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [
        {
          "id": 8,
          "name": "SELECT PostgreSQL",
          "template": {
            "content": "SELECT id AS sql_column_1, first_name AS sql_column_2, last_name AS sql_column_3 FROM mock_data WHERE id = ?",
            "format": "text"
          },
          "uuid": "2d922c38-0973-4780-a1f5-f8ffbedebe5c"
        },
        {
          "id": 9,
          "name": "UPDATE PostgreSQL",
          "template": {
            "content": "UPDATE mock_data SET id = ? WHERE first_name = ?",
            "format": "text"
          },
          "uuid": "6fdf3c0f-b2a6-4a4a-837e-0ed53ed15d56"
        },
        {
          "id": 10,
          "name": "INSERT PostgresSQL",
          "template": {
            "content": "INSERT into mock_data (id, first_name, last_name) values (?, ?, ?)",
            "format": "text"
          },
          "uuid": "ffca48c8-b424-4034-bf0c-2b1eb95dfd9e"
        },
        {
          "id": 11,
          "name": "DELETE PostgreSQL",
          "template": {
            "content": "DELETE from mock_data WHERE id = ?",
            "format": "text"
          },
          "uuid": "288b891b-35ff-42ef-9812-d0efb5821a44"
        }
      ],
      "text": "sql_query",
      "tooltip": "Predefined SQL statement",
      "type_id": 11,
      "uuid": "0070aa06-fe8b-4a46-9152-7077f5aacbd4",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1715090270602,
      "description": {
        "content": "A function that runs ODBC queries. Parameters are passed to the database separately, protecting against SQL injection attacks.\nInputs:\nsql_query: a SQL query with set parameters using a question mark as a place holder, SQL statements SELECT, INSERT, UPDATE and DELETE are supported\nsql_condition_value1: value for the question mark - condition value 1\nsql_condition_value2: value for the question mark - condition value 2\nsql_condition_value3: value for the question mark - condition value 3",
        "format": "text"
      },
      "destination_handle": "fn_odbc_query",
      "display_name": "fn_odbc_query",
      "export_key": "fn_odbc_query",
      "id": 97,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 7,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1715090270602,
      "name": "fn_odbc_query",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"entries\": null}, \"raw\": null, \"inputs\": {\"sql_condition_value1\": \"9\", \"sql_condition_value2\": \"Bob\", \"db_label\": \"database_label1\", \"sql_query\": \"UPDATE mock_data SET id = ? WHERE first_name = ?\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-odbc-query\", \"package_version\": \"1.1.0\", \"host\": \"local\", \"execution_time_ms\": 1107, \"timestamp\": \"2022-09-28 13:19:58\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"entries\": {}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"sql_condition_value1\": {\"type\": \"string\"}, \"sql_condition_value2\": {\"type\": \"string\"}, \"db_label\": {\"type\": \"string\"}, \"sql_query\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "9cd2dc7f-1099-4769-a00c-9864616c5795",
      "version": 0,
      "view_items": [
        {
          "content": "0070aa06-fe8b-4a46-9152-7077f5aacbd4",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "cf253679-c066-424b-a6c9-897b27dbd32c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "e3f3aebf-c49d-467f-8ed8-0051951adcc1",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "bfae970d-3466-4280-9d54-d830ea36a657",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "dae6db5b-bc25-483b-932f-48a2025cef0d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example ODBC DELETE PostgreSQL",
          "object_type": "artifact",
          "programmatic_name": "example_odbc_delete_postgresql",
          "tags": [],
          "uuid": null,
          "workflow_id": 85
        },
        {
          "actions": [],
          "description": null,
          "name": "Example ODBC INSERT PostgreSQL",
          "object_type": "artifact",
          "programmatic_name": "example_odbc_insert_postgresql",
          "tags": [],
          "uuid": null,
          "workflow_id": 84
        },
        {
          "actions": [],
          "description": null,
          "name": "Example ODBC SELECT PostgreSQL",
          "object_type": "artifact",
          "programmatic_name": "example_odbc_select_postgresql",
          "tags": [],
          "uuid": null,
          "workflow_id": 83
        },
        {
          "actions": [],
          "description": null,
          "name": "Example ODBC UPDATE PostgreSQL",
          "object_type": "artifact",
          "programmatic_name": "example_odbc_update_postgresql",
          "tags": [],
          "uuid": null,
          "workflow_id": 86
        }
      ]
    }
  ],
  "geos": null,
  "groups": null,
  "id": 17,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1716240870661,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1716240870661,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "ccdad623-21bf-4109-9a03-57b9d6e157e7"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_odbc_query",
      "name": "fn_odbc_query",
      "programmatic_name": "fn_odbc_query",
      "tags": [],
      "users": [],
      "uuid": "4a9c4ca0-5c9f-4e8f-854f-8036860d0a62"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 25,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_ce577c59_a119_422c_8e4a_ed78d350fa13\" isExecutable=\"true\" name=\"playbook_ce577c59_a119_422c_8e4a_ed78d350fa13\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_14fo865\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"fn_odbc_query\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"9cd2dc7f-1099-4769-a00c-9864616c5795\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.db_label = playbook.inputs.odbc_db_label\\ninputs.sql_query = playbook.inputs.odbc_sql_query.content\\nif getattr(playbook.inputs, \u0027odbc_sql_param_1\u0027):\\n  inputs.sql_condition_value1 = playbook.inputs.odbc_sql_param_1\\nif getattr(playbook.inputs, \u0027odbc_sql_param_2\u0027):\\n  inputs.sql_condition_value2 = playbook.inputs.odbc_sql_param_2\\nif getattr(playbook.inputs, \u0027odbc_sql_param_3\u0027):\\n  inputs.sql_condition_value3 = playbook.inputs.odbc_sql_param_3\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"odbc_query_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_14fo865\u003c/incoming\u003e\u003coutgoing\u003eFlow_0zqh8dn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_14fo865\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0e2bv9x\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0zqh8dn\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"odbc_query_results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"2ba32a3e-b5da-4d9b-8216-5efdb92927bd\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0zqh8dn\u003c/incoming\u003e\u003coutgoing\u003eFlow_0e2bv9x\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0e2bv9x\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_ce577c59_a119_422c_8e4a_ed78d350fa13\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0e2bv9x\" id=\"Flow_0e2bv9x_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0zqh8dn\" id=\"Flow_0zqh8dn_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14fo865\" id=\"Flow_14fo865_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.1875\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.21875\" x=\"656\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1715126377517,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 7,
        "name": "a@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
      "description": {
        "content": "Perform a simple select statement query with optional substitution values. Results are displayed in a note as a table (SOAR versions \u003e= 51.0.0).\nSubstitution parameters will use the question mark (?) in the sql_query field.",
        "format": "text"
      },
      "display_name": "ODBC Select (Example)",
      "export_key": "odbc_select_example",
      "field_type_handle": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
      "fields_type": {
        "actions": [],
        "display_name": "ODBC Select Example",
        "export_key": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
        "fields": {
          "odbc_db_label": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13/odbc_db_label",
            "hide_notification": false,
            "id": 1468,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "odbc_db_label",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "DB Label",
            "tooltip": "from app.config fn_odbc_query:\u003cdb_label\u003e",
            "type_id": 1066,
            "uuid": "a76deb60-ca3c-4cdf-a05c-4ebd66910881",
            "values": []
          },
          "odbc_sql_param_1": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13/odbc_sql_param_1",
            "hide_notification": false,
            "id": 1551,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "odbc_sql_param_1",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Parameter 1",
            "tooltip": "",
            "type_id": 1066,
            "uuid": "a47f9877-2459-4f00-82b2-7985fb728413",
            "values": []
          },
          "odbc_sql_param_2": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13/odbc_sql_param_2",
            "hide_notification": false,
            "id": 1552,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "odbc_sql_param_2",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Parameter 2",
            "tooltip": "",
            "type_id": 1066,
            "uuid": "34d31ac2-e788-4785-b767-ea793c1a27fa",
            "values": []
          },
          "odbc_sql_param_3": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13/odbc_sql_param_3",
            "hide_notification": false,
            "id": 1553,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "odbc_sql_param_3",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Paramater 3",
            "tooltip": "",
            "type_id": 1066,
            "uuid": "aee449fb-5b63-4601-8d6b-8721570b070c",
            "values": []
          },
          "odbc_sql_query": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13/odbc_sql_query",
            "hide_notification": false,
            "id": 1469,
            "input_type": "textarea",
            "internal": false,
            "is_tracked": false,
            "name": "odbc_sql_query",
            "operation_perms": {},
            "operations": [],
            "placeholder": "select * from dbo.table where id=5;",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SQL Query",
            "tooltip": "",
            "type_id": 1066,
            "uuid": "937e9bab-5742-467e-b776-70fef38c48ba",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
        "uuid": "c6e7c27c-87cc-4349-b34c-609675b32435"
      },
      "has_logical_errors": false,
      "id": 48,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 7,
        "name": "a@example.com",
        "type": "user"
      },
      "last_modified_time": 1716240729687,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1715127198891,
          "description": "",
          "enabled": false,
          "export_key": "odbc_query_results",
          "id": 39,
          "language": "python3",
          "last_modified_by": "a@example.com",
          "last_modified_time": 1715182753037,
          "name": "odbc_query_results",
          "object_type": "incident",
          "playbook_handle": "odbc_select_example",
          "programmatic_name": "odbc_select_example_odbc_query_results",
          "script_text": "def wrap_html(tag, value_list, style=None):\n  \"\"\" wrap item(s) in an html tag. tag should be a html element without the \u0027\u003c\u003e\u0027\n      ex. wrap_html(\"p\", \"some paragraph\")\n          wrap_html(\"li\", apply_tags(\"ul\", [\"item1\", \"item2\"]))\n  \"\"\"\n  new_list = [f\"\u003c{tag} style=\u0027{style}\u0027\u003e\"] + value_list if isinstance(value_list, list) else [value_list]\n  new_list += [f\"\u003c/{tag}\u003e\"]\n  return new_list\n\ndef apply_tags(tag, value, style=None):\n  \"\"\" apply html tabs to each value(s). tag should be a html element without the \u0027\u003c\u003e\u0027\n      ex. apply_tags(\"ul\", [\"item1\", \"item2\"])\n  \"\"\"\n  if isinstance(value, list):\n    return [apply_tags(tag, item, style=style) for item in value]\n\n  return f\"\u003c{tag} style=\u0027{style}\u0027\u003e{value}\u003c/{tag}\u003e\"\n\n# M A I N\nresults = playbook.functions.results.odbc_query_results\nif not results.success:\n  incident.addNote(f\"Query failed: {playbook.inputs.odbc_sql_query.content}\\nReason: {results.reason}\")\nelse:\n  entries = results.content.get(\"entries\", [])\n  if not entries:\n    table_str = \"No results returned\"\n  else:\n    columns_hdr = list(entries[0].keys())\n    # build the html headers\n    rows = wrap_html(\"tr\", apply_tags(\"th\", columns_hdr, style=\u0027border: 1px solid black\u0027), style=\u0027border: 1px solid black;border-collapse:collapse;\u0027)\n    \n    for n in range(0, len(entries)):\n      values = list(entries[n].values())\n      rows += wrap_html(\"tr\", apply_tags(\"td\", values, style=\u0027border: 1px solid black;\u0027), style=\u0027border: 1px solid black;border-collapse:collapse;\u0027)\n    \n    table = wrap_html(\"table\", rows, style=\u0027border-collapse:collapse;\u0027)\n    table_str = \"\".join(table)\n      \n      \n  incident.addNote(helper.createRichText(f\"Query success: {playbook.inputs.odbc_sql_query.content}\u003cbr\u003e{table_str}\"))\n",
          "tags": [],
          "uuid": "2ba32a3e-b5da-4d9b-8216-5efdb92927bd"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "a76deb60-ca3c-4cdf-a05c-4ebd66910881",
            "element": "field_uuid",
            "field_type": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "937e9bab-5742-467e-b776-70fef38c48ba",
            "element": "field_uuid",
            "field_type": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a47f9877-2459-4f00-82b2-7985fb728413",
            "element": "field_uuid",
            "field_type": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "34d31ac2-e788-4785-b767-ea793c1a27fa",
            "element": "field_uuid",
            "field_type": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "aee449fb-5b63-4601-8d6b-8721570b070c",
            "element": "field_uuid",
            "field_type": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "odbc_select_example",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_ce577c59-a119-422c-8e4a-ed78d350fa13",
        "id": 60,
        "name": "playbook_ce577c59_a119_422c_8e4a_ed78d350fa13",
        "type": "playbook",
        "uuid": "b03e294b-508c-4a38-b22d-6b78c112d7d7"
      },
      "tags": [],
      "type": "default",
      "uuid": "ce577c59-a119-422c-8e4a-ed78d350fa13",
      "version": 36
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 9340,
    "f": 0,
    "m": 0,
    "major": 0,
    "minor": 0,
    "r": 0,
    "v": 51,
    "version": "51.0.0.0.9340"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [],
  "workflows": [],
  "workspaces": []
}
