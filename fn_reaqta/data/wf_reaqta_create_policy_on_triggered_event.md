<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# ReaQta: Create Policy on Triggered Event

## Function - ReaQta: Create Policy

### API Name
`reaqta_create_policy`

### Output Name
`None`

### Message Destination
`fn_reaqta`

### Pre-Processing Script
```python
inputs.reaqta_sha256 = row['sha256_hash']
inputs.reaqta_policy_title = rule.properties.reaqta_policy_title
inputs.reaqta_policy_description = rule.properties.reaqta_policy_description or ''
inputs.reaqta_policy_included_groups = rule.properties.reaqta_policy_included_groups
inputs.reaqta_policy_excluded_groups = rule.properties.reaqta_policy_excluded_groups
inputs.reaqta_policy_enabled = True
inputs.reaqta_policy_block = rule.properties.reaqta_policy_block_when_triggered
inputs.reaqta_hives = incident.properties.reaqta_hive
```

### Post-Processing Script
```python
if results.success:
  policies = []
  policies.append("<br>Policy Parameters:<br>Hives: {}<br>Title: {}<br>Description: {}<br>Included Groups: {}<br>Excluded Groups: {}<br>Enabled: {}<br>Block when Triggered: {}<br>".\
                         format(rule.properties.hive_labels if rule.properties.hive_labels else incident.properties.reaqta_hive,
                                rule.properties.reaqta_policy_title,
                                rule.properties.reaqta_policy_description,
                                rule.properties.reaqta_policy_included_groups,
                                rule.properties.reaqta_policy_excluded_groups,
                                rule.properties.reaqta_policy_enabled,
                                rule.properties.reaqta_policy_block_when_triggered))
  for policy in results.content:
    policies.append('Hive: {0} <a href="{1}" target="blank">{1}</a>'.format(policy.get('policy_hive'), policy.get("policy_url")))
  incident.addNote(helper.createRichText("ReaQta Create Policies successful: {}".format("<br>".join(policies))))
else:
  incident.addNote(helper.createRichText("ReaQta Create Policy failed: {}".format(results.reason)))
```

---

