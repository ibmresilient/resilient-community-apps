<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - SEP: Add Artifact from Scan Result - Example (PB)

### API Name
`sep_add_artifact_from_scan_result`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`sep_eoc_scan_results.file_path has_a_value AND sep_eoc_scan_results.computer_name has_a_value AND sep_eoc_scan_results.scan_command_state contains Completed AND sep_eoc_scan_results.hash_value has_a_value AND (sep_eoc_scan_results.scan_result contains Hash match OR sep_eoc_scan_results.scan_result contains Full match)`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Artifact type - scan results | `sep_artifact_type_scan_results` | select | SOAR artifact types. | Optional |

### Object Type
`sep_eoc_scan_results`

### Description
add a SOAR artifact from a property of the 'Symantec SEP - EOC scan results' data-table.
The supported artifact types supported are: "File Path", "Malware SHA-256 Hash" and "System Name".


---

## Local script - sep_add_artifact_from_scan_results

### Description


### Script Type
`Local script`

### Object Type
`sep_eoc_scan_results`

### Script Content
```python
# Create a SOAR artifact based on a dropdown which selects the corresponding data-table field.
artifact_typ = playbook.inputs.sep_artifact_type_scan_results
FUNCTION_NAME = "fn_sep_scan_endpoints"

params = {
  "Malware SHA-256 Hash": row.hash_value,
  "System Name": row.computer_name,
  "File Path": row.file_path
}

desc = ''
if not params.get("System Name") or not params.get(artifact_typ):
  helper.fail(f'Required data-table field is missing or empty for artifact type: {fi}')

desc = f"Detected by Symantec SEP Eoc Scan for artifact of type '{row.artifact_type}' and value '{row.artifact_value}' by function '{FUNCTION_NAME}' for Symantec SEP."

incident.addArtifact(artifact_typ, params[artifact_typ], desc)
```

---

