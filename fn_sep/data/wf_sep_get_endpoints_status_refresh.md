<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example: SEP - Get Endpoints status summary (refresh)

## Function - SEP - Get Computers

### API Name
`fn_sep_get_computers`

### Output Name
`None`

### Message Destination
`fn_sep`

### Pre-Processing Script
```python
inputs.sep_status = True
```

### Post-Processing Script
```python
##  Symantec Endpoint Protection  - fn_sep_get_computers script ##
# Example result:
"""
Result: {'inputs': {u'sep_status': True},
         'metrics': {'package': 'fn-sep', 'timestamp': '2019-05-24 11:06:24', 'package_version': '1.0.0',
                    'host': 'myhost', 'version': '1.0', 'execution_time_ms': 1157},
         'success': True,
         'content': {'out_of_date': 0, 'hi_failed': 1, 'disabled': 0, 'up_to_date': 3, 'non_compliant': 1,
                     'total': 3, 'offline': 0},
         'raw': '{"out_of_date": 0, "hi_failed": 1, "disabled": 0, "up_to_date": 3, "non_compliant": 1,
                  "total": 3, "offline": 0}',
         'reason': None,
         'version': '1.0'
}
"""
#  Globals
# List of fields in datatable for "Get Endpoints status" workflow.
DATA_TBL_FIELDS = ["query_execution_date", "non_compliant", "up_to_date", "out_of_date", "total", "disabled",
                   "offline","hi_failed", ]
FN_NAME = "fn_sep_get_computers"
WF_NAME = "Get Endpoints status"
CONTENT = results.content
QUERY_EXECUTION_DATE = results["metrics"]["timestamp"]

# Processing

def main():
    note_text = ''
    
    if CONTENT is not None and CONTENT["total"] > 0:
        if CONTENT["total"] > 0:
          
            row.query_execution_date = QUERY_EXECUTION_DATE
            for f in DATA_TBL_FIELDS:
                if f == "query_execution_date":
                    continue
                row[f] = CONTENT[f]

        if CONTENT["non_compliant"] > 0:
            note_text = "Symantec SEP Integration: Workflow <b>{0}</b>: There were <b>{1}</b> non-compliant endpoints " \
                        "detected out of a total of <b>{2}</b> for Resilient function <b>{3}</b>"\
                .format(WF_NAME, CONTENT["non_compliant"], CONTENT["total"], FN_NAME)
        else:
            note_text = "Symantec SEP Integration: Workflow <b>{0}</b>: There were <b>no</b> non-compliant endpoints " \
                         "detected out of a total of <b>{1}</b> for Resilient function <b>{2}</b>" \
                .format(WF_NAME, CONTENT["total"], FN_NAME)
    else:
        note_text = "Symantec SEP Integration: Workflow <b>{0}</b>: There were <b>no</b> results returned for Resilient " \
                    "function <b>{1}</b>".format(WF_NAME, FN_NAME)

    incident.addNote(helper.createRichText(note_text))


if __name__ == "__main__":
    main()
```

---

