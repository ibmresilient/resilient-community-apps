<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - SEP: Assign Blacklist to lockdown group - Example (PB)

### API Name
`sep_assign_blacklist_to_lockdown_group`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`sep_groups.group_id has_a_value AND sep_groups.policyInheritanceEnabled equals`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Fingerprint list name | `sep_fingerprintlist_name` | select | Name of a SEP fingerprint list. | Optional |

### Object Type
`sep_groups`

### Description
Assign a blacklist fingerprint list to a group for system lockdown.


---
## Function - SEP - Get Fingerprint List

### API Name
`fn_sep_get_fingerprint_list`

### Output Name
`get_fingerprintlist_results`

### Message Destination
`fn_sep`

### Function-Input Script
```python
inputs.sep_domainid = row.domain_id
inputs.sep_fingerprintlist_name = playbook.inputs.sep_fingerprintlist_name
```

---
## Function - SEP - Assign Fingerprint List to Group

### API Name
`fn_sep_assign_fingerprint_list_to_group`

### Output Name
`assign_fingerprintlist_to_group_results`

### Message Destination
`fn_sep`

### Function-Input Script
```python
content = playbook.functions.results.get_fingerprintlist_results.get("content", {})
inputs.sep_fingerprintlist_id = content.get("id")
inputs.sep_groupid = row.group_id
```

---

## Local script - get fingerprintlist output

### Description


### Script Type
`Local script`

### Object Type
`sep_groups`

### Script Content
```python
## Symantec Endpoint Protection - fn_sep_get_fingerprint_list script ##
# Globals
# List of fields in datatable fn_sep_get_fingerprint_list script
FN_NAME = "fn_sep_get_fingerprint_list"
WF_NAME = "Assign Fingerprint List to lockdown group"
results = playbook.functions.results.get_fingerprintlist_results
content = results.get("content", {})
INPUTS = results.get("inputs", {})

# Processing
note_text = ''
if content:
  if isinstance(content, dict) and content.get("errorCode") and int(content.get("errorCode")) == 410:
    # The finger print list doesn't exist.
    note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThe fingerprint list <b>{1}</b> does not exist " \
                "for domain id <b>{2}</b> for SOAR function <b>{3}</b>"\
        .format(WF_NAME, INPUTS.get("sep_fingerprintlist_name"), INPUTS.get("sep_domainid"),
                FN_NAME)
else:
  noteText = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThere were <b>no</b> results returned for " \
             "fingerprint list <b>{1}</b> and domain id <b>{2}</b> for SOAR " \
             "function <b>{3}</b>".format(WF_NAME, INPUTS.get("sep_fingerprintlist_name"),
                                          INPUTS.get("sep_domainid"), FN_NAME)
if note_text:
  incident.addNote(helper.createRichText(note_text))
```

---
## Local script - Assign fingerprintlist to group output

### Description


### Script Type
`Local script`

### Object Type
`sep_groups`

### Script Content
```python
## Symantec Endpoint Protection - fn_sep_assign_fingerprint_list_to_group ##
# Globals
FN_NAME = "fn_sep_assign_fingerprint_list_to_group"
WF_NAME = "Assign Fingerprint List to lockdown group"
results = playbook.functions.results.assign_fingerprintlist_to_group_results
content = results.get("content", {})
INPUTS = results.get("inputs", {})
QUERY_EXECUTION_DATE = results.get("metrics", {}).get("timestamp")

# Processing
note_text = ''
if content:
  if isinstance(content, dict) and content.get("errorCode") and int(content.get("errorCode")) == 400:
    # The finger print list doesn't exist.
    note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThe fingerprint list <b>{1}</b> does not exist or is invalid " \
                "for domain id <b>{2}</b> for SOAR function <b>{3}</b>"\
        .format(WF_NAME, INPUTS.get("sep_fingerprintlist_name"), row.domain_id, FN_NAME)
  else:
    note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nSuccessfully assigned fingerprint list with id " \
                "<b>{1}</b> to group with id <b>{2}</b> for SOAR function <b>{3}</b>"\
        .format(WF_NAME, INPUTS.get("sep_fingerprintlist_id"), INPUTS.get("sep_groupid"), FN_NAME)

else:
  note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThere were <b>no</b> results returned " \
               "with fingerprint id <b>{1}</b> and group id <b>{2}</b> for SOAR function <b>{3}</b>"\
      .format(WF_NAME, INPUTS.get("sep_fingerprintlist_id"), INPUTS.get("sep_groupid"), FN_NAME)

incident.addNote(helper.createRichText(note_text))
```

---

