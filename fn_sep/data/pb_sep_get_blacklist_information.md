<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - SEP: Get Blacklist information - Example (PB)

### API Name
`sep_get_blacklist_information`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Domain name | `sep_domain_name` | select | SEP Domain Name | Optional |
| Fingerprint list name | `sep_fingerprintlist_name` | select | Name of a SEP fingerprint list. | Always |

### Object Type
`incident`

### Description
Get a blacklist fingerprint list information for a specified name.


---
## Function - SEP - Get Domains

### API Name
`fn_sep_get_domains`

### Output Name
`get_domains_results`

### Message Destination
`fn_sep`

### Function-Input Script
```python
None
```

---
## Function - SEP - Get Fingerprint List

### API Name
`fn_sep_get_fingerprint_list`

### Output Name
`get_fingerprintlist_results`

### Message Destination
`fn_sep`

### Function-Input Script
```python
domain_content = playbook.functions.results.get_domains_results.get("content", [])

for i in range(len(domain_content)):
  if domain_content[i].get("name") == playbook.inputs.sep_domain_name:
    inputs.sep_domainid = domain_content[i].get("id")
    break
inputs.sep_fingerprintlist_name = playbook.inputs.sep_fingerprintlist_name
```

---

## Local script - get domains output

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
fn_name = "fn_sep_get_domains"
wf_name = "SEP: Get Blacklist information - Example (PB)"
results = playbook.functions.results.get_domains_results
content = results.get("content", [])
domainid = None
for i in range(len(content)):
  if content[i].get("name") == playbook.inputs.sep_domain_name:
    domainid = content[i].get("id")
    break
if domainid:
  playbook.addProperty("domid_exists", {"exists": True})
else:
  note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThe domain name <b>{1}</b> was not found " \
              "for SOAR function <b>{2}</b>.".format(wf_name, playbook.inputs.sep_domain_name, fn_name)
  incident.addNote(helper.createRichText(note_text))
```

---
## Local script - get fingerprintlist output

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
## Symantec Endpoint Protection - fn_sep_get_fingerprint_list script ##
# Globals
# List of fields in datatable fn_sep_get_fingerprint_list script
DATA_TBL_FIELDS = ["domain_name", "list_name", "list_id", "list_description", "hash_values", "group_ids"]
FN_NAME = "fn_sep_get_fingerprint_list"
WF_NAME = "Get Fingerprint List"
results = playbook.functions.results.get_fingerprintlist_results
CONTENT = results.get("content", {})
INPUTS = results.get("inputs", {})
QUERY_EXECUTION_DATE = results.get("metrics", {}).get("timestamp")
DOMAIN_NAME = playbook.inputs.sep_domain_name
# Processing
note_text = ''

if CONTENT:
  if CONTENT.get("errorCode") and int(CONTENT.get("errorCode")) == 410:
    # The finger print list doesn't exist.
    note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThe fingerprint list <b>{1}</b> does not exist " \
                "for domain <b>{2}</b> for SOAR function <b>{3}</b>"\
        .format(WF_NAME, INPUTS.get("sep_fingerprintlist_name"), DOMAIN_NAME, FN_NAME)
  elif "errorCode" in CONTENT:
    note_text = f"Symantec SEP Integration:\nPlaybook <b>{WF_NAME}</b>:\n{CONTENT.get('errorMessage')}"
  else:
    note_text = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThere were <b>{1}</b> results returned for " \
                "fingerprint list <b>{2}</b> and domain <b>{3}</b> for SOAR function <b>{4}</b>"\
        .format(WF_NAME, len(CONTENT.get("data", [])), INPUTS.get("sep_fingerprintlist_name"),
                DOMAIN_NAME, FN_NAME)

    newrow = incident.addRow("sep_fingerprint_lists")
    newrow.query_execution_date = QUERY_EXECUTION_DATE
    newrow.domain_name = playbook.inputs.sep_domain_name
    newrow.list_name = CONTENT.get("name")
    newrow.list_id = CONTENT.get("id")
    newrow.list_description = CONTENT.get("description")
    newrow.hash_values = str(CONTENT.get("data"))
    newrow.group_ids = ', '.join(CONTENT.get("groupIds"))
else:
  noteText = "Symantec SEP Integration:\nPlaybook <b>{0}</b>:\nThere were <b>no</b> results returned  for " \
              "fingerprint list <b>{1}</b> and domain <b>{2}</b> for SOAR " \
              "function <b>{3}</b>".format(WF_NAME, INPUTS.get("sep_fingerprintlist_name"),
                                           DOMAIN_NAME, FN_NAME)

incident.addNote(helper.createRichText(note_text))
```

---

