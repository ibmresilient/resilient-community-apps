<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - SEP: Move Endpoint - Example (PB)

### API Name
`sep_move_endpoint`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`sep_endpoint_details.hardwareKey has_a_value AND sep_endpoint_details.uniqueId has_a_value`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Group Full path name | `sep_group_full_path_name` | select | The full path name of the group. | Always |

### Object Type
`sep_endpoint_details`

### Description
Move an endpoint to a different group.


---
## Function - SEP - Get Groups

### API Name
`fn_sep_get_groups`

### Output Name
`get_groups_results`

### Message Destination
`fn_sep`

### Function-Input Script
```python
inputs.sep_fullpathname = playbook.inputs.sep_group_full_path_name
inputs.sep_domain = row.domain_id
```

---
## Function - SEP - Move endpoint

### API Name
`fn_sep_move_endpoint`

### Output Name
`move_endpoint_results`

### Message Destination
`fn_sep`

### Function-Input Script
```python
content = playbook.functions.results.get_groups_results.get("content", {})
full_path_name = content.get("content", [])[0].get("fullPathName")
inputs.sep_hardwarekey = row.hardwareKey
inputs.sep_groupid = content.get("content", [])[0].get("id")
```

---

## Local script - get groups output

### Description


### Script Type
`Local script`

### Object Type
`sep_endpoint_details`

### Script Content
```python
## Symantec Endpoint Protection - fn_sep_get_groups script ##
results = playbook.functions.results.get_groups_results
content = results.get("content", {})
fn_name = "fn_symc_sep_get_groups"
wf_name = "Move Endpoint"
note_text = ''

if content and len(content.get("content")) > 0:
  groups = content.get("content", [])
  if len(groups) > 1:
    note_text = "Symantec SEP Integration:\nPlaybook: <b>{0}</b>:\nThere were too many results <b>{1}</b> returned " \
                "for SOAR function <b>{2}</b>".format(wf_name, len(groups), fn_name)
  else:
    playbook.addProperty("single_group", {"single_group": True})
    playbook.addProperty("sep_oldpathname", {"oldPathName": row.group_name})
    playbook.addProperty("sep_fullpathname", {"fullPathName": groups[0].get("fullPathName")})
else:
  note_text += "Symantec SEP Integration:\nPlaybook: <b>{0}</b>:\nThere were <b>no</b> results returned for SOAR " \
               "function <b>{1}</b>".format(wf_name, fn_name)
if note_text:
  incident.addNote(helper.createRichText(note_text))
```

---
## Local script - move endpoint output

### Description


### Script Type
`Local script`

### Object Type
`sep_endpoint_details`

### Script Content
```python
## Symantec Endpoint Protection - fn_sep_move_client script ##
# List of fields in datatable fn_amp_get_computers script
FN_NAME = "fn_set_move_client"
WF_NAME = "Move Endpoint"
results = playbook.functions.results.move_endpoint_results
CONTENT = results.get("content", [])
HW_KEY = results.get("inputs", {}).get("sep_hardwarekey")
GROUP_ID = results.get("inputs", {}).get("sep_groupid")
QUERY_EXECUTION_DATE = results.get("metrics", {}).get("timestamp")

note_text = ''
if CONTENT:
  response_msg = CONTENT[0].get("responseMessage")
  if response_msg == "OK":
    oldfullpath = playbook.properties.sep_oldpathname.get("oldPathName")
    fullpathname = playbook.properties.sep_fullpathname.get("fullPathName")
    note_text = "Symantec SEP Integration:\nPlaybook: <b>{0}</b>:\nSuccessfully moved computer <b>{1}</b> " \
               "from group <b>{2}</b> to group <b>{3}</b> for SOAR function <b>{4}</b>."\
        .format(WF_NAME, row.computerName, oldfullpath, fullpathname, FN_NAME)
    row.group_id = GROUP_ID
    if fullpathname:
      row.group_name = fullpathname
  else:
    note_text = "Symantec SEP Integration:\nPlaybook: <b>{0}</b>:\nUnsuccessful move of computer <b>{1}</b> " \
               "to group with id <b>{2}</b>. Received response <b>{3}</b> for SOAR function <b>{4}</b>."\
        .format(WF_NAME, row.computerName, GROUP_ID, response_msg, FN_NAME)
else:
  noteText = "Symantec SEP Integration:\nPlaybook: <b>{0}</b>:\nMove unsuccessful for computer with hardware id <b>{1}</b> " \
             "to group with id <b>{2}</b> for SOAR function <b>{3}</b>."\
      .format(WF_NAME, HW_KEY, GROUP_ID, FN_NAME)

incident.addNote(helper.createRichText(note_text))
```

---

