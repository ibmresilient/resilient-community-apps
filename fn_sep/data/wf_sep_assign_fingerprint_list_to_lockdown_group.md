<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example: SEP - Assign Blacklist to lockdown group

## Function - SEP - Get Fingerprint List

### API Name
`fn_sep_get_fingerprint_list`

### Output Name
`get_fingerprintlist_results`

### Message Destination
`fn_sep`

### Pre-Processing Script
```python
inputs.sep_domainid = row.domain_id
inputs.sep_fingerprintlist_name = rule.properties.sep_fingerprintlist_name
```

### Post-Processing Script
```python
##  Symantec Endpoint Protection  - fn_sep_get_fingerprint_list script ##
# Example result:
"""
Result:{'inputs': {u'sep_fingerprintlist_name': u'Blacklist_2', u'sep_domainid': u'908090000946C25D330E919313D23887'}, 
        'metrics': {'package': 'fn-sep', 'timestamp': '2019-05-28 16:23:05', 'package_version': '1.0.0', 
                    'host': 'myhost', 'version': '1.0', 'execution_time_ms': 1153}, 
        'success': True, 
        'content': {u'description': u'Hash of type Malware MD5 Hash', u'hashType': u'MD5', u'source': u'WEBSERVICE', 
                    u'groupIds': [u'7E4BB119A9FE9DC526EDABFB1EE261B8'], u'data': [u'482F9B6E0CC4C1DBBD772AAAF088CB3A'], 
                    u'id': u'E60B061FDD844EBF9778D4BD2AC3942A', u'name': u'Blacklist_2'}, 
        'raw': '{"description": "Hash of type Malware MD5 Hash", "hashType": "MD5", "source": "WEBSERVICE", '
               '"groupIds": ["7E4BB119A9FE9DC526EDABFB1EE261B8"], "data": ["482F9B6E0CC4C1DBBD772AAAF088CB3A"], '
               '"id": "E60B061FDD844EBF9778D4BD2AC3942A", "name": "Blacklist_2"}', 
        'reason': None, 
        'version': '1.0'
 }
"""
#  Globals
# List of fields in datatable fn_sep_get_fingerprint_list script
FN_NAME = "fn_sep_get_fingerprint_list"
WF_NAME = "Assign Fingerprint List to lockdown group"
CONTENT = results.content
INPUTS = results.inputs

# Processing


def main():
    note_text = ''

    if CONTENT is not None:
        if "errorCode" in CONTENT and int(CONTENT["errorCode"]) == 410:
            # The finger print list doesn't exist.
            note_text = "Symantec SEP Integration: Workflow <b>{0}</b>: The fingerprint list <b>{1}</b> does not exist " \
                        "for domain id <b>{2}</b> for Resilient function <b>{3}</b>"\
                .format(WF_NAME, INPUTS["sep_fingerprintlist_name"], INPUTS["sep_domainid"],
                        FN_NAME)
    else:
        noteText += "Symantec SEP Integration: Workflow <b>{0}</b>: There were <b>no</b> results returned  for " \
                    "fingerprint list <b>{1}</b> and domain id <b>{2}</b> for Resilient " \
                    "function <b>{3}</b>".format(WF_NAME, INPUTS["sep_fingerprintlist_name"],
                                                 INPUTS["sep_domainid"], FN_NAME)
    if note_text:
        incident.addNote(helper.createRichText(note_text))

if __name__ == "__main__":
    main()
```

---

## Function - SEP - Assign Fingerprint List to Group

### API Name
`fn_sep_assign_fingerprint_list_to_group`

### Output Name
``

### Message Destination
`fn_sep`

### Pre-Processing Script
```python
content = workflow.properties.get_fingerprintlist_results.content
inputs.sep_fingerprintlist_id = content["id"]
inputs.sep_groupid = row.group_id
```

### Post-Processing Script
```python
##  Symantec Endpoint Protection  - fn_sep_assign_fingerprint_list_to_group ##
# Example result:
"""
Result:{'inputs': {u'sep_fingerprintlist_id': u'E60B061FDD844EBF9778D4BD2AC3942A', u'sep_groupid': u'7E4BB119A9FE9DC526EDABFB1EE261B8'},
        'metrics': {'package': 'fn-sep', 'timestamp': '2019-05-28 17:53:52', 'package_version': '1.0.0', 'host': 'myhost',
                   'version': '1.0', 'execution_time_ms': 1225},
        'success': True,
        'content': '',
        'raw': '""',
        'reason': None,
        'version': '1.0'
 }
"""
#  Globals
FN_NAME = "fn_sep_assign_fingerprint_list_to_group"
WF_NAME = "Assign Fingerprint List to lockdown group"
DATA_TBL_FIELDS = ["domain_name", "list_name", "list_id", "list_description", "hash_values", "hash_type", "group_ids"]
CONTENT = results.content
INPUTS = results.inputs
QUERY_EXECUTION_DATE = results["metrics"]["timestamp"]

# Processing

def main():
    note_text = ''

    if CONTENT is not None:
        if "errorCode" in CONTENT and int(CONTENT["errorCode"]) == 400:
            # The finger print list doesn't exist.
            note_text = "Symantec SEP Integration: Workflow <b>{0}</b>: The fingerprint list <b>{1}</b> does not exist or is invalid " \
                        "for domain id <b>{2}</b> for Resilient function <b>{3}</b>"\
                .format( WF_NAME, INPUTS["sep_fingerprintlist_name"], row.domain_id, FN_NAME)
        else:
            note_text = "Symantec SEP Integration: Workflow <b>{0}</b>: Successfully assigned fingerprint list  with id " \
                        "<b>{1}</b> to group with id <b>{2}</b> for Resilient function <b>{3}</b>"\
                .format(WF_NAME, INPUTS["sep_fingerprintlist_id"], INPUTS["sep_groupid"], FN_NAME)

    else:
        note_text += "Symantec SEP Integration: Workflow <b>{0}</b>: There were <b>no</b> results returned " \
                     "with fingerprint id <b>{1}</b> and group id <b>{2}</b> for Resilient function <b>{3}</b>"\
            .format(WF_NAME, INPUTS["sep_fingerprintlist_id"], INPUTS["sep_groupid"], FN_NAME)

    incident.addNote(helper.createRichText(note_text))

if __name__ == "__main__":
    main()
```

---

