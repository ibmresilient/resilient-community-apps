<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="ThreatMiner" href="../fn_threatminer/README.html" /><link rel="prev" title="Task Utilities" href="../fn_task_utils/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Microsoft Teams - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">Remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmware_cbc/README.html">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_algosec/README.html">IBM SOAR integration for AlgoSec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">Anomali Staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration Application for IBM Resilient.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#table-of-contents">Table of Contents -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#about-this-package">About this package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#use-cases">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#resilient-configurations">Resilient Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#rules">Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#run-application">Run Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#application-usage-and-details">Application Usage and Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#guardium-4a-list-parameter-names-by-report-name">Guardium: 4A. List Parameter Names By Report Name :</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html#guardium-4b-search-all-guardium-reports">Guardium: 4B. Search All Guardium Reports :</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">IBM SOAR LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">Phish Tank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sumo_logic/README.html">Sumo Logic Cloud SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">fn_whois_rdap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="microsoft-teams">
<h1>Microsoft Teams<a class="headerlink" href="#microsoft-teams" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#microsoft-teams-for-ibm-qradar-soar"><span class="xref myst">Microsoft Teams for IBM QRadar SOAR</span></a></p>
<ul>
<li><p><a class="reference internal" href="#table-of-contents"><span class="xref myst">Table of Contents</span></a></p></li>
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
<li><p><a class="reference internal" href="#endpoint-developed-with"><span class="xref myst">Endpoint Developed With</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p></li>
<li><p><a class="reference internal" href="#endpoint-configuration"><span class="xref myst">Endpoint Configuration</span></a></p>
<ul>
<li><p><a class="reference internal" href="#register-a-new-application-using-the-azure-portal"><span class="xref myst">Register a new application using the Azure portal</span></a></p></li>
<li><p><a class="reference internal" href="#api-permissions"><span class="xref myst">API Permissions</span></a></p></li>
<li><p><a class="reference internal" href="#application-permission"><span class="xref myst">Application Permission</span></a></p></li>
<li><p><a class="reference internal" href="#delegated-permission"><span class="xref myst">Delegated Permission</span></a></p></li>
<li><p><a class="reference internal" href="#setting-up-api-permissions-both-permissions"><span class="xref myst">Setting up API Permissions (Both Permissions)</span></a></p></li>
<li><p><a class="reference internal" href="#list-of-required-permissions"><span class="xref myst">List of required permissions</span></a></p></li>
<li><p><a class="reference internal" href="#create-a-client-secret-value-both-permissions"><span class="xref myst">Create a client Secret Value (Both Permissions)</span></a></p></li>
<li><p><a class="reference internal" href="#setting-up-incoming-webhooks-both-permissions"><span class="xref myst">Setting up Incoming Webhooks (Both Permissions)</span></a></p></li>
<li><p><a class="reference internal" href="#setting-up-delegated-permissions-delegated-permissions"><span class="xref myst">Setting up Delegated permissions (Delegated permissions)</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration-both-permissions"><span class="xref myst">App Configuration (Both Permissions)</span></a></p></li>
<li><p><a class="reference internal" href="#ms-teams-workflows"><span class="xref myst">MS Teams Workflows</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---ms-teams-archive-team"><span class="xref myst">Function - MS Teams: Archive Team</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-create-channel"><span class="xref myst">Function - MS Teams: Create Channel</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-create-group"><span class="xref myst">Function - MS Teams: Create group</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-create-team"><span class="xref myst">Function - MS Teams: Create team</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-delete-channel"><span class="xref myst">Function - MS Teams: Delete Channel</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-delete-group"><span class="xref myst">Function - MS Teams: Delete Group</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-enable-team"><span class="xref myst">Function - MS Teams: Enable Team</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-post-message"><span class="xref myst">Function - MS Teams: Post Message</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-post-message-for-workflows"><span class="xref myst">Function - MS Teams: Post Message for Workflows</span></a></p></li>
<li><p><a class="reference internal" href="#function---ms-teams-read-message"><span class="xref myst">Function - MS Teams: Read Message</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p>
<ul>
<li><p><a class="reference internal" href="#data-table---ms-teams-approval-process"><span class="xref myst">Data Table - MS Teams Approval Process</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p>
<ul>
<li><p><a class="reference internal" href="#for-support"><span class="xref myst">For Support</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3.0.0</p></td>
<td><p>08/2024</p></td>
<td><p>Added Approval Request process and ability to work with MS Teams Workflows.</p></td>
</tr>
<tr class="row-odd"><td><p>2.1.0</p></td>
<td><p>05/2023</p></td>
<td><p>Add playbooks and removed workflows</p></td>
</tr>
<tr class="row-even"><td><p>2.0.1</p></td>
<td><p>12/2022</p></td>
<td><p>Bug fix in workflows for MS Teams: Enable Teams for Groups and MS Teams: Read messages</p></td>
</tr>
<tr class="row-odd"><td><p>2.0.0</p></td>
<td><p>12/2022</p></td>
<td><p>Added support for creating and deleting MS Groups, Teams and Channels</p></td>
</tr>
<tr class="row-even"><td><p>1.0.0</p></td>
<td><p>10/2019</p></td>
<td><p>Post Incident/task information to MS Teams</p></td>
</tr>
</tbody>
</table>
</div>
<section id="changes">
<h3>3.0.0 Changes<a class="headerlink" href="#changes" title="Link to this heading">¶</a></h3>
<!-->
<p>In v3.0, an approval request process has been added to make requests for process changes. Added is a datatable to track approval request with a poller to review changes in MS Teams based on approval or rejection replies. See <a class="reference internal" href="#v30-changes-for-poller"><span class="xref myst">V3.0 Changes for poller</span></a> for additional changes needed to the app.config file to enable this capability.
–&gt;
v3.0 supports MS Teams Workflows and Adaptive Cards. See the section <a class="reference internal" href="#ms-teams-workflows"><span class="xref myst">Setting up Workflows</span></a> for more information needed to configure this capability.</p>
</section>
<section id="id1">
<h3>2.1.0 Changes<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>In v2.1, the existing rules and workflows have been replaced with playbooks.
This change is made to support the ongoing, newer capabilities of playbooks.
Each playbook has the same functionality as the previous, corresponding rule/workflow.</p>
<p>If upgrading from a previous release, you’ll notice that the previous release’s rules/workflows remain in place. Both sets of rules and playbooks are active. For manual actions, playbooks have the same name as it’s corresponding rule, but with “(PB)” added at the end.
For automatic actions, the playbooks will be disabled by default.</p>
<p>You can continue to use the rules/workflows.
But migrating to playbooks provides greater functionality along with future app enhancements and bug fixes.</p>
<hr class="docutils" />
<p><img alt="screenshot: main.png" src="../_images/main71.png" /></p>
</section>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>This IBM Security QRadar SOAR application extends the meeting and collaboration functionality of Microsoft Teams. It includes the ability to create MS Teams Groups, Teams and Channels. Functionality also exists to post SOAR Incident or task information to a MS Teams Channel.</p>
<p>Microsoft 365 Groups are created with resources that members of the group share, including:</p>
<ul class="simple">
<li><p>Outlook conversations</p></li>
<li><p>Outlook calendar</p></li>
<li><p>SharePoint files</p></li>
<li><p>OneNote notebook</p></li>
<li><p>SharePoint team site</p></li>
<li><p>Planner plans</p></li>
<li><p>Intune device management</p></li>
</ul>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Create or delete Groups, Channels, and Teams, as well as archive or un-archive Teams. Incident and task members can be assigned to a Team.</p></li>
<li><p>It is now possible to create Groups, Teams, and Channels with members who are not a part of an incident or task but who have a functioning MS account that is a part of the same organization.</p></li>
<li><p>Post information about the Incident or task directly to a MS Channel.</p></li>
<li><p>Example rules/workflows are included that perform the aforementioned operations and store related information as a incident or a task note.</p></li>
</ul>
<!--
* In v3.0, support for approval requests including poller to received approval replies.
-->
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, App Host and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=45.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Incident</p></td>
<td><p>Read, Write</p></td>
</tr>
<tr class="row-odd"><td><p>Incident Private Tasks</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Group</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Users</p></td>
<td><p>Read</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>App Host Deployment Guide</em> or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= 1.10.</p></li>
<li><p>Cloud Pak is configured with an App Host.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Both Python 3.9 and Python 3.11 are supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>msal ~= 1.30</p></li>
<li><p>pymsteams ~= 0.2.3</p></li>
<li><p>resilient_circuits&gt;=50.0.0</p></li>
</ul>
</section>
<section id="endpoint-developed-with-ms-teams">
<h3>Endpoint Developed With MS Teams<a class="headerlink" href="#endpoint-developed-with-ms-teams" title="Link to this heading">¶</a></h3>
<p>This app has been implemented using:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Product Name</p></th>
<th class="head"><p>API URL</p></th>
<th class="head"><p>API Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Microsoft Graph REST API</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://graph.microsoft.com/</span></code></p></td>
<td><p>V1.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="endpoint-configuration">
<h2>Endpoint Configuration<a class="headerlink" href="#endpoint-configuration" title="Link to this heading">¶</a></h2>
<p>This application needs an access token from the Microsoft identity platform for use with Microsoft Graph APIs.
The access token includes details about the application and the permission it has to use the Microsoft Graph resources and APIs. The app needs to be registered with the Microsoft identity platform and given permission to access the required Microsoft Graph resources by a user or an administrator in order to obtain an access token.</p>
<section id="register-a-new-application-using-the-azure-portal">
<h3>Register a new application using the Azure portal<a class="headerlink" href="#register-a-new-application-using-the-azure-portal" title="Link to this heading">¶</a></h3>
<p>The application must be registered with the identity provider for the identity provider to be aware that a specific app is attempting to access user information. The configuration necessary for the application to interface with the Microsoft identity platform is then made available when it registers with Microsoft Entra ID (formally Azure AD). You can learn more about this at <a class="reference external" href="https://learn.microsoft.com/en-us/azure/active-directory/develop/application-model">learn.microsoft.com/application-model</a></p>
<ul class="simple">
<li><p>Sign in to the <a class="reference external" href="https://portal.azure.com">Azure portal</a> using either an enterprise account.</p></li>
<li><p>If your account gives you access to more than one tenant, select your account in the top right corner, and set your portal session to the Azure AD tenant that you want.</p></li>
<li><p>In the left-hand navigation pane, select the <code class="docutils literal notranslate"><span class="pre">Microsoft</span> <span class="pre">Entra</span> <span class="pre">ID</span></code>, and then select <code class="docutils literal notranslate"><span class="pre">App</span> <span class="pre">registrations</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">registration</span></code>.</p></li>
<li><p>When the Register an application page appears, enter your application’s registration information:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Name</span></code> - Enter a meaningful application name that will be displayed to users of the app.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Supported</span> <span class="pre">account</span> <span class="pre">types</span></code> - Select which accounts you would like your application to support.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Redirect</span> <span class="pre">URI</span></code> - Enter the redirect URI (or reply URL) for this application, i.e : <code class="docutils literal notranslate"><span class="pre">https://localhost:8080/callback</span></code></p></li>
</ul>
</li>
</ul>
<p><img alt="screenshot: app_registration_overview.png" src="../_images/app_registration_overview.png" /></p>
<ul class="simple">
<li><p>Note this information as this would be required later while setting up the application in the <strong>SOAR platform</strong>.</p></li>
<li><p>When finished, select Register.</p></li>
<li><p>In the left-hand navigation pane under the <code class="docutils literal notranslate"><span class="pre">Manage</span></code> section, select <code class="docutils literal notranslate"><span class="pre">Authentication</span></code>.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Yes</span></code> for <code class="docutils literal notranslate"><span class="pre">Enable</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">mobile</span> <span class="pre">and</span> <span class="pre">desktop</span> <span class="pre">flows</span></code> then click <code class="docutils literal notranslate"><span class="pre">Save</span></code>.</p></li>
</ul>
</section>
<section id="api-permissions">
<h3>API Permissions<a class="headerlink" href="#api-permissions" title="Link to this heading">¶</a></h3>
<p>The application requires admins consent to access a protected resource, such as user information and Team settings. Microsoft Graph exposes certain predetermined APIs and only accepts requests made to them. These predetermined APIs or permissions can be added to individual applications thereby limiting them to only make controlled changes to the objects they are exposed to. In this case, we require permission to operate on Groups, Teams, and to read User information. You can learn more about this concept at <a class="reference external" href="https://learn.microsoft.com/en-us/azure/active-directory/develop/scopes-oidc">learn.microsoft.com/scopes-oidc</a>.</p>
<p>This application requires two different types of permissions to access the required Graph Objects:</p>
<ul class="simple">
<li><p>Application permission</p></li>
<li><p>Delegated permission (Optional)</p></li>
</ul>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Permission Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Archive Team</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Create Channel</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Create Group</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Create Team</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Delete Channel</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Delete Group</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Enable Teams for Group</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Post Incident Information</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Application</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Read Channel Messages</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Delegated</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="application-permission">
<h3>Application Permission<a class="headerlink" href="#application-permission" title="Link to this heading">¶</a></h3>
<p>Application permissions, also called app roles, allow the app to access data on its own, without a signed-in user. In this access scenario, the application can interact with data on its own, without a signed in user. App-only access is used in scenarios such as automation, and is mostly used by apps that run as background services or daemons. It’s suitable when it’s undesirable to have a user signed in, or when the data required can’t be scoped to a single user.</p>
</section>
<section id="delegated-permission">
<h3>Delegated Permission<a class="headerlink" href="#delegated-permission" title="Link to this heading">¶</a></h3>
<p>This type of permission is optional and is only required for the <strong>Read Channel messages</strong> feature. If you wish to use the application without this feature (read channel messages), you can do so by leaving out the delegated permission setup process and following the remaining steps. Delegated permissions, also called scopes, allow the application to act on behalf of the signed-in user. In this access scenario, the user signs in on behalf of the application and provides it with the required permissions to call the Microsoft Graph API. Both the client and the user must be authorized to make the request. The Graph API’s <strong>read message</strong> method is one of Microsoft’s protected APIs since it has access to sensitive data. The user must grant this application permission to access their data in order for this application to function. This means that only the resources to which the user has access, such as channels and teams, will be available to this application.</p>
</section>
<section id="setting-up-api-permissions-both-permissions">
<h3>Setting up API Permissions (Both Permissions)<a class="headerlink" href="#setting-up-api-permissions-both-permissions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>In the left-hand navigation pane under the <code class="docutils literal notranslate"><span class="pre">Manage</span></code> section select <code class="docutils literal notranslate"><span class="pre">API</span> <span class="pre">Permission</span></code>.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">a</span> <span class="pre">permission</span></code>. On the Request API permission screen, select <code class="docutils literal notranslate"><span class="pre">Microsoft</span> <span class="pre">Graph</span></code>.</p></li>
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">Application</span> <span class="pre">permissions</span></code> option and search for all relevant permissions and add them as shown below.</p></li>
<li><p>An admin account is required to <code class="docutils literal notranslate"><span class="pre">Grant</span> <span class="pre">admin</span> <span class="pre">consent</span></code>, to enable these permissions.</p></li>
</ul>
</section>
<section id="list-of-required-permissions">
<h3>List of required permissions<a class="headerlink" href="#list-of-required-permissions" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>API/Permission</p></th>
<th class="head"><p>Permission Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Group</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Create</span></code></p></td>
<td><p>Application</p></td>
<td><p>Create groups</p></td>
</tr>
<tr class="row-odd"><td><p>Group</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadWrite.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Read and write all groups</p></td>
</tr>
<tr class="row-even"><td><p>GroupMember</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadWrite.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Read and write all group memberships</p></td>
</tr>
<tr class="row-odd"><td><p>Team</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Create</span></code></p></td>
<td><p>Application</p></td>
<td><p>Create teams</p></td>
</tr>
<tr class="row-even"><td><p>Team</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadBasic.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Get a list of all teams</p></td>
</tr>
<tr class="row-odd"><td><p>TeamMember</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadWrite.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Add and remove members from all teams</p></td>
</tr>
<tr class="row-even"><td><p>TeamMember</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadWriteNonOwnerRole.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Add and remove members with non-owner role</p></td>
</tr>
<tr class="row-odd"><td><p>TeamSettings</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadWrite.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Read and change all teams’ settings</p></td>
</tr>
<tr class="row-even"><td><p>User</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Read.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Read all users’ full profiles</p></td>
</tr>
<tr class="row-odd"><td><p>ChannelMessage</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Read.All</span></code></p></td>
<td><p>Application</p></td>
<td><p>Read all messages</p></td>
</tr>
<tr class="row-even"><td><p>ChannelMessage</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ReadWrite</span></code></p></td>
<td><p>Delegated</p></td>
<td><p>Read and write user channel messages</p></td>
</tr>
<tr class="row-odd"><td><p>ChannelMessage</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Send</span></code></p></td>
<td><p>Delegated</p></td>
<td><p>Send channel messages</p></td>
</tr>
<tr class="row-even"><td><p>offline_access</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--</span></code></p></td>
<td><p>Delegated</p></td>
<td><p>Maintain access to data you have given it access to</p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="screenshot: app_scopes_permissions.png" src="../_images/app_scopes_permissions.png" /></p>
</section>
<section id="create-a-client-secret-value-both-permissions">
<h3>Create a client Secret Value (Both Permissions)<a class="headerlink" href="#create-a-client-secret-value-both-permissions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>In the left-hand navigation pane under the <code class="docutils literal notranslate"><span class="pre">Manage</span></code> section, select <code class="docutils literal notranslate"><span class="pre">Certificate</span> <span class="pre">and</span> <span class="pre">secrets</span></code>.</p></li>
<li><p>Click on the <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">client</span> <span class="pre">secret</span></code> button.</p></li>
<li><p>Enter a name for the client secret and click on the <code class="docutils literal notranslate"><span class="pre">Add</span></code> button.</p></li>
<li><p>Note this information as this would be required later while setting up the application in the <strong>SOAR platform</strong>.</p></li>
</ul>
<p><img alt="screenshot: app_certificate_secrets.png" src="../_images/app_certificate_secrets.png" /></p>
</section>
<section id="setting-up-incoming-webhooks-both-permissions">
<h3>Setting up Incoming Webhooks (Both Permissions)<a class="headerlink" href="#setting-up-incoming-webhooks-both-permissions" title="Link to this heading">¶</a></h3>
<p>The <strong>SOAR Platform</strong> can share content in Microsoft channels using an incoming webhook.
The webhooks are utilized as tracking and notifying mechanisms. The webhooks offer a specific URL that can be used to transmit a JSON payload along with a card-format message. To configure webhooks for a channel, please refer to this documentation <a class="reference external" href="https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook">Create Incoming Webhooks</a>.</p>
<p><em>Note</em>: Webhooks are now replaced by MS Teams Workflows. Refer to <a class="reference internal" href="#ms-teams-workflows"><span class="xref myst">MS Teams Workflows</span></a> on how to start using this new capability.</p>
</section>
<section id="setting-up-delegated-permissions-delegated-permissions">
<h3>Setting up Delegated permissions (Delegated permissions)<a class="headerlink" href="#setting-up-delegated-permissions-delegated-permissions" title="Link to this heading">¶</a></h3>
<p>This setup process is to provide the application with delegated permissions which is required only for <strong>Read channel message</strong> feature. If you wish to use the application without this feature, you can do so by skipping this process.</p>
<p>To provide the application with the necessary permission, the <a class="reference external" href="https://exchange.xforce.ibmcloud.com/api/hub/extensionsNew/504c896aa38087ba897fa054bc79e598/README.pdf">OAuth Utilities Documentation</a> is to be used.</p>
<ul class="simple">
<li><p>This tool provides the user with means to login on behalf of the application and provide the application with the required permissions to act on behalf of the user.</p></li>
<li><p>The application_id, directory_id and secret_value are used to generate a unique <em>refresh_token</em>, which is later used in the app.conf file.</p></li>
<li><p>There are several ways to generate this <em>Refresh token</em> using the OAuth Utilities tool, please refer to the documentation <a class="reference external" href="https://exchange.xforce.ibmcloud.com/api/hub/extensionsNew/504c896aa38087ba897fa054bc79e598/README.pdf">OAuth Utilities Documentation</a></p></li>
<li><p>Once such method would be using the CLI. A sample command has been provided below:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oauth</span><span class="o">-</span><span class="n">utils</span> <span class="n">oauth2_generate_refresh_token</span> \
<span class="o">-</span><span class="n">tu</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">login</span><span class="o">.</span><span class="n">microsoftonline</span><span class="o">.</span><span class="n">com</span><span class="o">/&lt;</span><span class="n">DIRECTORY_ID</span><span class="o">&gt;/</span><span class="n">oauth2</span><span class="o">/</span><span class="n">v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">token</span> \
<span class="o">-</span><span class="n">au</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">login</span><span class="o">.</span><span class="n">microsoftonline</span><span class="o">.</span><span class="n">com</span><span class="o">/&lt;</span><span class="n">DIRECTORY_ID</span><span class="o">&gt;/</span><span class="n">oauth2</span><span class="o">/</span><span class="n">v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">authorize</span> \
<span class="o">-</span><span class="n">ci</span> <span class="o">&lt;</span><span class="n">APPLICATION_ID</span><span class="o">&gt;</span> \
<span class="o">-</span><span class="n">cs</span> <span class="o">&lt;</span><span class="n">SECRET_VALUE</span><span class="o">&gt;</span> \
<span class="o">-</span><span class="n">sc</span> <span class="s2">&quot;ChannelMessage.Send ChannelMessage.Read.All offline_access&quot;</span>
</pre></div>
</div>
<p>Upon successfully completing this process, you will be presented with a <strong>refresh_token</strong>.  Note this information as this is required later while setting up the application in the <strong>SOAR platform</strong>.</p>
</section>
<section id="app-configuration-both-permissions">
<h3>App Configuration (Both Permissions)<a class="headerlink" href="#app-configuration-both-permissions" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. These values are used by the SOAR platform to establish a secure connection with the Microsoft Endpoint. See the documentation discussed in the <a class="reference internal" href="#endpoint-configuration"><span class="xref myst">Endpoint Configuration</span></a> section for the procedure. If you have successfully configured that endpoint, you can find these values:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://portal.azure.com">Azure portal</a> -&gt; App registration -&gt; (Your application)</p></li>
</ul>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p>18d10049-72e3-4652-ac9f-d9b13f24303c</p></td>
<td><p>Overview -&gt; <code class="docutils literal notranslate"><span class="pre">Application</span> <span class="pre">(client)</span> <span class="pre">ID</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>directory_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p>1d8a5928-8678-408e-ab06-50ca7e01766a</p></td>
<td><p>Overview -&gt; <code class="docutils literal notranslate"><span class="pre">Directory</span> <span class="pre">(tenant)</span> <span class="pre">ID</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>secret_value</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p>oCN******************</p></td>
<td><p>Certificate &amp; secrets -&gt; <code class="docutils literal notranslate"><span class="pre">Secret</span> <span class="pre">Value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>refresh_token</strong></p></td>
<td class="text-center"><p>Optional</p></td>
<td><p>eyxn******************</p></td>
<td><p>Required only for delegated permissions</p></td>
</tr>
<tr class="row-even"><td><p><strong>&lt;channel_name&gt;</strong></p></td>
<td class="text-center"><p>Optional</p></td>
<td><p>****.webhook.office.com/webhookb2/</p></td>
<td><p>Webhook URL for a channel</p></td>
</tr>
<tr class="row-odd"><td><p><strong>selftest</strong></p></td>
<td class="text-center"><p>Optional</p></td>
<td><p>https://teams.microsoft.com/l/channel/xxx</p></td>
<td><p>Webhook URL for channel connectors to test posting of messages.  <strong>This capability is deprecated and selftest_workflows should be used starting with V3.0</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>selftest_workflows</strong></p></td>
<td class="text-center"><p>Optional</p></td>
<td><p>https://azure.com/workflows/xxx</p></td>
<td><p>Webhook URL for Teams Workflows to test posting of messages.</p></td>
</tr>
<tr class="row-odd"><td><p>*<strong><webhook label></strong></p></td>
<td class="text-center"><p>Optional</p></td>
<td><p>https://azure.com/workflows/xxx</p></td>
<td><p>Additional webhook URLs. Reference the <code class="docutils literal notranslate"><span class="pre">webhook</span> <span class="pre">label</span></code> used when post messaging via the functions which use the <code class="docutils literal notranslate"><span class="pre">teams_channel</span></code> input field.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ms-teams-workflows">
<h3>MS Teams Workflows<a class="headerlink" href="#ms-teams-workflows" title="Link to this heading">¶</a></h3>
<p>In V3.0, messages can be sent via the MS Teams Workflows capability. Although a powerful way to set up complex capabilities, the basic enablement can be performed via these steps:</p>
<ol class="arabic simple">
<li><p>Within the MS Teams app (either Windows or Mac), select the Workflows app
<img alt="screenshot: Workflows app" src="../_images/workflows_app.png" /></p></li>
<li><p>Add a workflow for <code class="docutils literal notranslate"><span class="pre">Post</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">channel</span> <span class="pre">when</span> <span class="pre">a</span> <span class="pre">webhook</span> <span class="pre">request</span> <span class="pre">is</span> <span class="pre">received</span></code>
<img alt="screenshot: Adding a Workflow" src="../_images/adding_a_workflow.png" /></p></li>
<li><p>At the minimum, the workflow will have steps to send Adaptive Cards to a channel
<img alt="screenshot: Workflow Steps" src="../_images/workflow_steps.png" />
<img alt="screenshot: Workflow Detail" src="../_images/workflow_detail.png" /></p></li>
</ol>
<p>The webhook request step contains the URL required to send Adaptive Cards to a teams channel.
Copy this value and add it your app.config settings using a label of your choosing. This label will then be referred to in any message sent to the MS Teams channel via this Workflow.</p>
<p><img alt="screenshot: Approval Playbook" src="../_images/approval_playbook.png" /></p>
<!--
#### V3.0 Changes for poller
If running the poller for approval requests, a new app.config section has been added, `fn_teams_approval_process`. If the `poller_interval` is non-zero, then the poller will 
execute, looking for pending approvals. 

If upgrading from a previous version of the MS Teams app, add the following section data
to your app.config and modify the approval_words and rejection_words as necessary.

```
[fn_teams_approval_process]
# if using the Approval Request process, enable the poller to check for approval request updates
# in seconds
#poller_interval=60
# Comma separated list of case-insensitive approval words
approval_words=accept, accepted, approve, approved, ok
# Comma separated list of case-insensitive rejection words
rejection_words=reject, rejected, deny, denied, no
```
-->
</section>
</section>
<hr class="docutils" />
<section id="function-ms-teams-post-message-for-workflows">
<h2>Function - MS Teams Post Message for Workflows<a class="headerlink" href="#function-ms-teams-post-message-for-workflows" title="Link to this heading">¶</a></h2>
<p>Post a message to a Microsoft Teams channel intended for Workflows</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2095</span></code></p></td>
<td><p>Incident id from which artifacts are to be fetched</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">teams_channel</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Lookup value to channel to post a message</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">teams_payload</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>string-encoded json of teams conversation message: See [Adaptive Cards]](https://adaptivecards.io/)</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
  <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;status_code&#39;</span><span class="p">:</span> <span class="mi">202</span><span class="p">},</span> 
  <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">ADAPTIVE_CARD_TYPE</span> <span class="o">=</span> <span class="s2">&quot;AdaptiveCard&quot;</span>
<span class="n">ADAPTIVE_CARD_VERSION</span> <span class="o">=</span> <span class="s2">&quot;1.4&quot;</span>

<span class="k">def</span> <span class="nf">create_textblock</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> 
                     <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">,</span> 
                     <span class="n">font_type</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">,</span>
                     <span class="n">font_size</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">,</span> 
                     <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">,</span> 
                     <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">,</span>
                     <span class="n">is_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextBlock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
    <span class="s2">&quot;wrap&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">font_weight</span><span class="p">,</span>
    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">,</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
    <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span>
    <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="n">is_visible</span>
  <span class="p">}</span>
  
<span class="k">def</span> <span class="nf">create_factset</span><span class="p">(</span><span class="n">separator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">facts</span><span class="o">=</span><span class="p">[],</span> <span class="n">is_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FactSet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;facts&quot;</span><span class="p">:</span> <span class="n">facts</span><span class="p">,</span>
    <span class="s2">&quot;separator&quot;</span><span class="p">:</span> <span class="n">separator</span><span class="p">,</span>
    <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="n">is_visible</span>
  <span class="p">}</span>
  
<span class="k">def</span> <span class="nf">create_fact</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span>
  <span class="p">}</span>


<span class="c1"># S T A R T</span>

<span class="n">body</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">create_textblock</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOAR Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bolder&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Attention&quot;</span><span class="p">),</span>
  <span class="n">create_factset</span><span class="p">(</span><span class="n">facts</span><span class="o">=</span><span class="p">[</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Owner&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">owner_id</span><span class="p">),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Types&quot;</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">incident_type_ids</span><span class="p">)),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;NIST Attack Vectors&quot;</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">nist_attack_vectors</span><span class="p">)),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Create Date&quot;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">create_date</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%c</span><span class="s1">&#39;</span><span class="p">)),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Date Occurred&quot;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">start_date</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%c</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">start_date</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Discovered Date&quot;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">discovered_date</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%c</span><span class="s1">&#39;</span><span class="p">)),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Confirmed&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">confirmed</span><span class="p">),</span>
    <span class="n">create_fact</span><span class="p">(</span><span class="s2">&quot;Severity&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">severity_code</span><span class="p">)</span>
  <span class="p">])</span>
<span class="p">]</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">teams_additional_comments</span><span class="p">:</span>
  <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_textblock</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">teams_additional_comments</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>

<span class="n">adaptive_card</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;application/vnd.microsoft.card.adaptive&quot;</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://adaptivecards.io/schemas/adaptive-card.json&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ADAPTIVE_CARD_TYPE</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">ADAPTIVE_CARD_VERSION</span><span class="p">,</span>
    <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">teams_payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">adaptive_card</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">teams_channel</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">teams_channel</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">ms_teams_post_result</span>

<span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
  <span class="c1">#</span>
  <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;msteams_approval_process&quot;</span><span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Pending&quot;</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;channel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">teams_channel</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;expiration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">approval_expiration</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">]</span> <span class="o">=</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">approval_message</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;soar_message_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">soar_message_id</span><span class="o">.</span><span class="n">message_id</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">teams_group</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;task_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">id</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;task_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">name</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MS Teams approval post to channel </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">teams_channel</span><span class="si">}</span><span class="s2"> failed with: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-archive-team">
<h2>Function - MS Teams: Archive Team<a class="headerlink" href="#function-ms-teams-archive-team" title="Link to this heading">¶</a></h2>
<p>This function allows for archiving or unarchiving a Microsoft Team. The <code class="docutils literal notranslate"><span class="pre">archive_operation</span></code> input parameter specifies if the team is to be archived or unarchived. Archiving does not delete the MS Team. To identify the team for archival or unarchival, one of the following inputs can be used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></li>
</ul>
<p><strong><ins>Note</ins></strong>: When multiple options are provided to locate the Graph object (Group or a Team), the <code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code> parameter will take precedence over <code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code>, and the <code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code> parameter will take precedence over the other two options.</p>
<p><img alt="screenshot: action_archive_team.png" src="../_images/action_archive_team.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">archive_operation</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">archive</span></code></p></td>
<td><p>Specify the operation to be performed</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span></code></p></td>
<td><p>Unique value, as no two MS Objects can have the same email ID. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4dfde5ae-4c27-4461</span></code></p></td>
<td><p>Unique id assigned to a MS Group or Team while being created</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span> <span class="pre">Team</span></code></p></td>
<td><p>Name assigned to the MS Group or Team while being created</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;https://graph.microsoft.com/v1.0/$metadata#groups/$entity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;87fd1ea0-6a3f-4078-b271-e4f8e6f8469e&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deletedDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;classification&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;createdDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T17:39:58Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;creationOptions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Team&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ExchangeProvisioningFlags:3552&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;task testing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;task testing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expirationDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;groupTypes&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Unified&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;isAssignableToRole&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;mail&quot;</span><span class="p">:</span> <span class="s2">&quot;tasktesting@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mailEnabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="s2">&quot;tasktesting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;membershipRule&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;membershipRuleProcessingState&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesDomainName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesLastSyncDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesNetBiosName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSamAccountName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSecurityIdentifier&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSyncEnabled&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredDataLocation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredLanguage&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;proxyAddresses&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;SMTP:tasktesting@example.com&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;renewedDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T17:39:58Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resourceBehaviorOptions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;HideGroupInOutlook&quot;</span><span class="p">,</span>
      <span class="s2">&quot;SubscribeMembersToCalendarEventsDisabled&quot;</span><span class="p">,</span>
      <span class="s2">&quot;WelcomeEmailDisabled&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;resourceProvisioningOptions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Team&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;securityEnabled&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;securityIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;S-1-12-1-2281512608-1081633343-4175720882-2655451366&quot;</span><span class="p">,</span>
    <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;Private&quot;</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesProvisioningErrors&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Successfully archived Team: task testing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teamsEnabled&quot;</span><span class="p">:</span> <span class="s2">&quot;Archived&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_groupteam_id&quot;</span><span class="p">:</span> <span class="s2">&quot;87fd1ea0-6a3f-4078-b271-e4f8e6f8469e&quot;</span><span class="p">,</span>
    <span class="s2">&quot;archive_operation&quot;</span><span class="p">:</span> <span class="s2">&quot;Archive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_group_mail_nickname&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_groupteam_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">2030</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 13:47:58&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">archive_operation</span> <span class="o">=</span> <span class="s2">&quot;Archive&quot;</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">archive_operation</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">archive_operation</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">archive_operation</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span>

<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>

<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;No input was provided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">archive_results</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to archive the Microsoft Team&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;b&gt;Microsoft Team Details:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">  &lt;br /&gt;The Team associated with this Group has now been </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;teamsEnabled&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.&lt;br /&gt;</span>
<span class="s2">  &lt;br /&gt;Name: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;displayName&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;Description: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;Teams Enabled: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;teamsEnabled&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;ID: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;Mail: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mail&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;Visibility: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;Group Types: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;groupTypes&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">  &lt;br /&gt;Created date and time: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createdDateTime&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;*Note the following users were unable to be added to the group: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unfoundUsers&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-create-channel">
<h2>Function - MS Teams: Create Channel<a class="headerlink" href="#function-ms-teams-create-channel" title="Link to this heading">¶</a></h2>
<p>This function creates a Microsoft Channel for a MS Team. A MS Team can have multiple channels.</p>
<p>To create a Channel for an MS Team, 3 key attributes are required, namely: teamId, displayName, and description. Out of these attributes, teamId is crucial as the MS Team must be properly identified before channel addition operation can take place. This function has the ability to find the required teamId using anyone of the below mentioned options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></li>
</ul>
<p><strong><ins>Note</ins></strong>: When multiple options are provided to locate the Graph object (Group or a Team), the <code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code> parameter will take precedence over <code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code>, and the <code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code> parameter will take precedence over the other two parameters.</p>
<p><img alt="screenshot: action_create_channel.png" src="../_images/action_create_channel.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_channel_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Team</span> <span class="pre">2</span></code></p></td>
<td><p>Name of the Microsoft Teams channel</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span> <span class="pre">SubTeam2</span></code></p></td>
<td><p>Description for the MS Graph Object (Group / Team / Channel) that is being created</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering2</span></code></p></td>
<td><p>Unique value, as no two MS Objects can have the same email ID. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4dfde5ae-4c27-4461</span></code></p></td>
<td><p>Unique id assigned to the MS Group or Team</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span></code></p></td>
<td><p>Name assigned to the MS Group or Team</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;https://graph.microsoft.com/v1.0/$metadata#teams(&#39;33333-450e-46d6-9338-f7e3b66a064c&#39;)/channels/$entity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;19:c875f7333fb843aeacb01d1cbfa52ae5@thread.tacv2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;createdDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:26:57.6422279Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;test 1234&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;test 1234&quot;</span><span class="p">,</span>
    <span class="s2">&quot;isFavoriteByDefault&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;webUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;https://teams.microsoft.com/l/channel/19</span><span class="si">%3a</span><span class="s2">c875f7333fb843aeacb01d1cbfa52ae5%40thread.tacv2/test+1234?groupId=33333-450e-46d6-9338-f7e3b66a064c&amp;tenantId=55555-b889-434d-802d-13b87c68047b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;membershipType&quot;</span><span class="p">:</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">201</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Successfully created channel: test 1234&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_groupteam_id&quot;</span><span class="p">:</span> <span class="s2">&quot;33333-450e-46d6-9338-f7e3b66a064c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_channel_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test 1234&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_description&quot;</span><span class="p">:</span> <span class="s2">&quot;test 1234&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">4593</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:26:57&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span> <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">content</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span>
<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>
<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;No input was provided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">create_channel_results</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to create Microsoft Group&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;a href=&quot;</span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;webUrl&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&gt;Click here&lt;/a&gt;</span>
<span class="s1">  &lt;b&gt;Microsoft Channel Details:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s1">  &lt;br /&gt;Name: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Web URL: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Description: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Teams Enabled: </span><span class="si">{</span><span class="kc">True</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;ID: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Mail: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;email&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Membership Type: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;membershipType&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-create-group">
<h2>Function - MS Teams: Create group<a class="headerlink" href="#function-ms-teams-create-group" title="Link to this heading">¶</a></h2>
<p>This function creates a Microsoft Group with the ability to add multiple owners by specifying their email addresses in a comma-separated list. At least one owner must be mentioned for group creation.</p>
<p>The function is developed to automatically add all members of an incident or a task to the MS Group. If the function is executed from within a task, in addition to task members, all incident members can also be automatically added if that option is selected. Apart from automatic member addition, individual members can be added by directly specifying their email addresses.</p>
<p><img alt="screenshot: action_create_group.png" src="../_images/action_create_group.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">add_members_from</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Incident/Task</span></code></p></td>
<td><p>Add incident or task members to Team/Group</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">additional_members</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user1&#64;example.com,</span> <span class="pre">user2&#64;example.com</span></code></p></td>
<td><p>Add additional Team members who are not members of this incident or task</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1098</span></code></p></td>
<td><p>Incident id of the current incident</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Description for the MS Group</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SOAR</span></code></p></td>
<td><p>Unique value, as no two MS Objects can have the same email ID. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SOAR</span></code></p></td>
<td><p>Name of the MS Group</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_owners_list</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AdminSoarMS&#64;.onmicrosoft.com</span></code></p></td>
<td><p>A list of owners for the Group</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Incident task id if creating a Group from a task.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3cde21c1-7e9c-4f6d-b986-06d879c43dad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deletedDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;classification&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;createdDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:13:38Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;creationOptions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expirationDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;groupTypes&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Unified&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;isAssignableToRole&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;mail&quot;</span><span class="p">:</span> <span class="s2">&quot;test1@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mailEnabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;membershipRule&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;membershipRuleProcessingState&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesDomainName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesLastSyncDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesNetBiosName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSamAccountName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSecurityIdentifier&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSyncEnabled&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredDataLocation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredLanguage&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;proxyAddresses&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;SMTP:test1@example.com&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;renewedDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:13:38Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resourceBehaviorOptions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;resourceProvisioningOptions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;securityEnabled&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;securityIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;S-1-12-1-1021190593-1332575900-3624306361-2906506361&quot;</span><span class="p">,</span>
    <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;Private&quot;</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesProvisioningErrors&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;teamsEnabled&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;unfoundUsers&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2122</span><span class="p">,</span>
    <span class="s2">&quot;additional_members&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_owners_list&quot;</span><span class="p">:</span> <span class="s2">&quot;markscherfling@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_group_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_group_mail_nickname&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;add_members_from&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
    <span class="s2">&quot;task_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;ms_description&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1560</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:13:39&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">task</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">task_id</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">id</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_owners_list</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_owners_list</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_owners_list</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">add_members_incident</span><span class="p">:</span>
  <span class="n">_value</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">add_members_incident</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">_value</span> <span class="o">==</span> <span class="s2">&quot;all incident members&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">add_members_from</span> <span class="o">=</span> <span class="s2">&quot;Incident&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">add_members_from</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">additional_members</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">additional_members</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">additional_members</span><span class="o">.</span><span class="n">content</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">description</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">content</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">create_group_results</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to create Microsoft Group&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;b&gt;Microsoft Group Details:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s1">  &lt;br /&gt;Name: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Description: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Teams Enabled: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;teamsEnabled&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;ID: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Mail: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mail&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Visibility: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visibility&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Group Types: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;groupTypes&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Created date and time: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;createdDateTime&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
  <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;br /&gt;*Note the following users were unable to be added to the group: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-create-team">
<h2>Function - MS Teams: Create team<a class="headerlink" href="#function-ms-teams-create-team" title="Link to this heading">¶</a></h2>
<p>This function creates a Microsoft Team with the ability to add multiple owners by specifying their email addresses in a comma-separated list. At least one owner must be mentioned for group creation.</p>
<p>The function is developed to automatically add all members of an incident or a task to the MS Team. If the function is executed from within a task, in addition to task members, all incident members can also be automatically added if that option is selected. Apart from automatic member addition, individual members can be added by directly specifying their email addresses.</p>
<p><img alt="screenshot: action_create_team.png" src="../_images/action_create_team.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">add_members_from</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Incident/Task</span></code></p></td>
<td><p>Allows for adding incident or task members to Team</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">additional_members</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user1&#64;example.com,</span> <span class="pre">user2&#64;example.com</span></code></p></td>
<td><p>Add members who are not members of this incident or task</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1098</span></code></p></td>
<td><p>Incident Id associate with this workflow/playbook</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_description</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Description for the MS Graph Team that is being created</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_owners_list</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AdminSoarMS&#64;.onmicrosoft.com</span></code></p></td>
<td><p>A comma separated list of owners for the group or team</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_team_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SoarTeam</span></code></p></td>
<td><p>Name of the Microsoft Team</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Incident task id if this Team is associated with a task</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;https://graph.microsoft.com/v1.0/$metadata#groups/$entity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;87fd1ea0-6a3f-4078-b271-e4f8e6f8469e&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deletedDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;classification&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;createdDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T17:39:58Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;creationOptions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Team&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ExchangeProvisioningFlags:3552&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;task testing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;task testing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expirationDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;groupTypes&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Unified&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;isAssignableToRole&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;mail&quot;</span><span class="p">:</span> <span class="s2">&quot;tasktesting@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mailEnabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="s2">&quot;tasktesting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;membershipRule&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;membershipRuleProcessingState&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesDomainName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesLastSyncDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesNetBiosName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSamAccountName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSecurityIdentifier&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSyncEnabled&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredDataLocation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredLanguage&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;proxyAddresses&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;SMTP:tasktesting@example.com&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;renewedDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T17:39:58Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resourceBehaviorOptions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;HideGroupInOutlook&quot;</span><span class="p">,</span>
      <span class="s2">&quot;SubscribeMembersToCalendarEventsDisabled&quot;</span><span class="p">,</span>
      <span class="s2">&quot;WelcomeEmailDisabled&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;resourceProvisioningOptions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Team&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;securityEnabled&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;securityIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;S-1-12-1-2281512608-1081633343-4175720882-2655451366&quot;</span><span class="p">,</span>
    <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;Private&quot;</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesProvisioningErrors&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;teamsEnabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;unfoundUsers&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_team_name&quot;</span><span class="p">:</span> <span class="s2">&quot;task testing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2120</span><span class="p">,</span>
    <span class="s2">&quot;additional_members&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_owners_list&quot;</span><span class="p">:</span> <span class="s2">&quot;markscherfling@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;add_members_from&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
    <span class="s2">&quot;task_id&quot;</span><span class="p">:</span> <span class="mi">126</span><span class="p">,</span>
    <span class="s2">&quot;ms_description&quot;</span><span class="p">:</span> <span class="s2">&quot;task testing&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">50594</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 13:40:47&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">task</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">task_id</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">id</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">ms_team_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_team_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_team_name</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_owners_list</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_owners_list</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_owners_list</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">add_members_incident</span><span class="p">:</span>
  <span class="n">_value</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">add_members_incident</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">_value</span> <span class="o">==</span> <span class="s2">&quot;all incident members&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">add_members_from</span> <span class="o">=</span> <span class="s2">&quot;Incident&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">add_members_from</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">additional_members</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">additional_members</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">additional_members</span><span class="o">.</span><span class="n">content</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">description</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">content</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_description</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">create_team</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to create Microsoft Team&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;b&gt;Microsoft Group Details:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s1">  &lt;br /&gt;Name: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Description: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Teams Enabled: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;teamsEnabled&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;ID: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Mail: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mail&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Visibility: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visibility&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Group Types: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;groupTypes&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Created date and time: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;createdDateTime&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
  <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;br /&gt;*Note the following users were unable to be added to the group: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-delete-channel">
<h2>Function - MS Teams: Delete Channel<a class="headerlink" href="#function-ms-teams-delete-channel" title="Link to this heading">¶</a></h2>
<p>This function deletes a MS Channel. A MS Team can be assigned to multiple channels. However, each MS Group can have only one Team. In order to delete an Channel, it’s MS Team/Group needs to be identified. To locate this team for this operation, one of the following inputs can be used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></li>
</ul>
<p><strong><ins>Note</ins></strong>: When multiple options are provided to locate the Graph object (Group or a Team), the <code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code> parameter will take precedence over <code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code>, and the <code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code> parameter will take precedence over the other two.</p>
<p><img alt="screenshot: action_delete_channel.png" src="../_images/action_delete_channel.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_channel_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span> <span class="pre">Channel</span></code></p></td>
<td><p>Name of the Microsoft Teams channel</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">engineeringTeam</span></code></p></td>
<td><p>Unique nickname for a group. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db7350fc-b6df-4041</span></code></p></td>
<td><p>Unique id assigned to a MS Group or Team while being created</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span> <span class="pre">Team</span></code></p></td>
<td><p>Name assigned to the MS Group or Team while being created</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">204</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Successfully deleted channel: Incident 2121 testing channels&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_groupteam_id&quot;</span><span class="p">:</span> <span class="s2">&quot;33333-450e-46d6-9338-f7e3b66a064c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_channel_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Incident 2121 testing channels&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">3172</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:09:04&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span>
<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>
<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;No input was provided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">delete_channel</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to delete Microsoft Channel&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;b&gt;Microsoft Channels:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">  &lt;br /&gt;</span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-delete-group">
<h2>Function - MS Teams: Delete Group<a class="headerlink" href="#function-ms-teams-delete-group" title="Link to this heading">¶</a></h2>
<p>This function deletes a MS Group. To identify this Group, one of the following inputs can be used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code></p></li>
</ul>
<p><strong><ins>Note</ins></strong>: When multiple parameters are provided to locate the Graph object (Group or a Team), the <code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code> parameter will take precedence over the <code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code>, and the <code class="docutils literal notranslate"><span class="pre">ms_group_id</span></code> parameter will take precedence over the other two.</p>
<p><img alt="screenshot: action_delete_group.png" src="../_images/action_delete_group.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db7350fc-b6df-4041</span></code></p></td>
<td><p>Unique id assigned to a group</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ProductionTeam</span></code></p></td>
<td><p>Unique nickname, as no two MS Objects can have the same email ID. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ProductionTeam</span></code></p></td>
<td><p>Name of the MS Group</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">204</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Successfully deleted Group: test1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_group_id&quot;</span><span class="p">:</span> <span class="s2">&quot;3cde21c1-7e9c-4f6d-b986-06d879c43dad&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">2032</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:15:02&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_id</span>

<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>

<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;Atleast one option must be specified to delete a group&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">delete_group</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to delete Microsoft Group&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;b&gt;Microsoft Groups:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s1">  &lt;br /&gt;</span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-enable-team">
<h2>Function - MS Teams: Enable Team<a class="headerlink" href="#function-ms-teams-enable-team" title="Link to this heading">¶</a></h2>
<p>This function enables an MS Team for a MS Group. When an MS Group is created, the teams’ functionality is not enabled by default. Use this function to enable this for an MS Group that was recently created or for an existing Group.</p>
<p>To identify the Group, one of the following inputs can be used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code></p></li>
</ul>
<p><strong><ins>Note</ins></strong>: When multiple parameters are provided to locate the Graph Group, the <code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code> parameter will take precedence over <code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code> and the <code class="docutils literal notranslate"><span class="pre">ms_group_id</span></code> parameter will take precedence over the other two.</p>
<p><img alt="screenshot: action_enable_teams.png" src="../_images/action_enable_teams.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">764a62f2-b759-4dd9</span></code></p></td>
<td><p>Group Unique id</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">engineeringTeam</span></code></p></td>
<td><p>Unique nickname, as no two MS Objects can have the same email ID. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Engineering</span> <span class="pre">Team</span></code></p></td>
<td><p>Name of the MS Group</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;https://graph.microsoft.com/v1.0/$metadata#groups/$entity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3cde21c1-7e9c-4f6d-b986-06d879c43dad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deletedDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;classification&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;createdDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:13:38Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;creationOptions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expirationDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;groupTypes&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;Unified&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;isAssignableToRole&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;mail&quot;</span><span class="p">:</span> <span class="s2">&quot;test1@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mailEnabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;mailNickname&quot;</span><span class="p">:</span> <span class="s2">&quot;test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;membershipRule&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;membershipRuleProcessingState&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesDomainName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesLastSyncDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesNetBiosName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSamAccountName&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSecurityIdentifier&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesSyncEnabled&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredDataLocation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;preferredLanguage&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;proxyAddresses&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;SMTP:test1@example.com&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;renewedDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:13:38Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;resourceBehaviorOptions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;resourceProvisioningOptions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;securityEnabled&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;securityIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;S-1-12-1-1021190593-1332575900-3624306361-2906506361&quot;</span><span class="p">,</span>
    <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;Private&quot;</span><span class="p">,</span>
    <span class="s2">&quot;onPremisesProvisioningErrors&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Successfully enabled Teams for Group: test1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teamsEnabled&quot;</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_group_id&quot;</span><span class="p">:</span> <span class="s2">&quot;3cde21c1-7e9c-4f6d-b986-06d879c43dad&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">4333</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:14:23&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_id</span>
<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>
<span class="k">elif</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_name</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;No input was provided.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">enable_team</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Could not enable Teams for this MS Group&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;b&gt;Microsoft Group Details:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s1">  &lt;br /&gt;Name: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Description: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Teams Enabled: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;teamsEnabled&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;ID: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Mail: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mail&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Visibility: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visibility&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Group Types: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;groupTypes&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="s1">  &lt;br /&gt;Created date and time: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;createdDateTime&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
  <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;br /&gt;*Note the following users were unable to be added to the group: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfoundUsers&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-post-message">
<h2>Function - MS Teams: Post Message<a class="headerlink" href="#function-ms-teams-post-message" title="Link to this heading">¶</a></h2>
<p>This application posts Incident or Task details to a MS Teams channel.  The channel name, specified by the <code class="docutils literal notranslate"><span class="pre">teams_channel</span></code> parameter, is used to lookup the appropriate channel webhook url maintained in app.config.</p>
<p><img alt="screenshot: output_post_teams.png" src="../_images/output_post_teams.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Unique id for the associated Incident</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Unique id for a task if task information will be posted</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">teams_channel</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Lookup value of channel to post a message</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">teams_mrkdown</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">teams_payload</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>String encoded JSON including incident or task information: sections, title, text, facts</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Information successfully posted in channel General&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;teams_channel&quot;</span><span class="p">:</span> <span class="s2">&quot;General&quot;</span><span class="p">,</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2121</span><span class="p">,</span>
    <span class="s2">&quot;teams_mrkdown&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;teams_payload&quot;</span><span class="p">:</span> <span class="s2">&quot;{ </span><span class="se">\&quot;</span><span class="s2">summary</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SOAR Incident</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">sections</span><span class="se">\&quot;</span><span class="s2">: [ </span><span class="se">\n</span><span class="s2">  { </span><span class="se">\&quot;</span><span class="s2">facts</span><span class="se">\&quot;</span><span class="s2">: [ </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">testing channels</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Description</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">-</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Id</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">2121</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Owner</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">i@example.com</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Types</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">NIST Attack Vectors</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Create Date</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">1684173230796</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Date Occurred</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">-</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Discovered Date</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">1684173210301</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Confirmed</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">True</span><span class="se">\&quot;</span><span class="s2"> }, </span><span class="se">\n</span><span class="s2">    { </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Severity</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Low</span><span class="se">\&quot;</span><span class="s2"> } </span><span class="se">\n</span><span class="s2">   ]</span><span class="se">\n</span><span class="s2">  }</span><span class="se">\n</span><span class="s2"> ] </span><span class="se">\n</span><span class="s2">} </span><span class="se">\n</span><span class="s2">&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">2038</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:21:57&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">format of a payload. * = optional</span>
<span class="sd">{ &quot;title&quot;*: xx,</span>
<span class="sd">  &quot;summary&quot;: xx,</span>
<span class="sd">  &quot;sections&quot;: [{ &quot;title&quot;*: yy, &quot;text&quot;*: yy,</span>
<span class="sd">                        &quot;facts&quot;*: [{&quot;name&quot;: zz, &quot;value&quot;: zz}]</span>
<span class="sd">              }]</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{{ &quot;summary&quot;: &quot;SOAR Incident&quot;, &quot;sections&quot;: [</span>
<span class="s1">  {{ &quot;facts&quot;: [</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Name&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Description&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Id&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Owner&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Types&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;NIST Attack Vectors&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Create Date&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Date Occurred&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Discovered Date&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Confirmed&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }},</span>
<span class="s1">    {{ &quot;name&quot;: &quot;Severity&quot;, &quot;value&quot;: &quot;</span><span class="si">{}</span><span class="s1">&quot; }}</span>
<span class="s1">   ]</span>
<span class="s1">  }}</span>
<span class="s1"> ]</span>
<span class="s1">}}</span>
<span class="s1">&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">owner_id</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">owner_id</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
  <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">incident_type_ids</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">nist_attack_vectors</span><span class="p">),</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">create_date</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">start_date</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">start_date</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">discovered_date</span><span class="p">,</span>
  <span class="s2">&quot;True&quot;</span> <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">confirmed</span> <span class="k">else</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>
  <span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">incident</span><span class="o">.</span><span class="n">severity_code</span> <span class="k">else</span> <span class="n">incident</span><span class="o">.</span><span class="n">severity_code</span><span class="p">)</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">teams_payload</span> <span class="o">=</span> <span class="n">payload</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">teams_channel</span> <span class="o">=</span> <span class="s2">&quot;General&quot;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">teams_mrkdown</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">post_message</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to Post message&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="n">text</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-ms-teams-read-message">
<h2>Function - MS Teams: Read Message<a class="headerlink" href="#function-ms-teams-read-message" title="Link to this heading">¶</a></h2>
<p>Read messages from a Teams Channel</p>
<p><img alt="screenshot: action_read_message.png" src="../_images/action_read_message.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_channel_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">abs7350fc-b6df-4041</span></code></p></td>
<td><p>Unique Id assigned to a channel while being created</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_channel_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">soarmessages</span></code></p></td>
<td><p>Name of the Microsoft Teams channel</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_group_mail_nickname</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">soarmailbox</span></code></p></td>
<td><p>Unique value, as no two MS Objects can have the same email ID. The mail address need not include the domain suffix (i.e. &#64;example.com)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db7350fc-b6df-4041</span></code></p></td>
<td><p>Unique id assigned to a MS Group or Team while being created</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ms_groupteam_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">soar</span></code></p></td>
<td><p>Name of the MS Team or Group</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms_message_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">111233344</span></code></p></td>
<td><p>Each message has a unique ID</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;1684173756348&quot;</span><span class="p">,</span>
      <span class="s2">&quot;replyToId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="s2">&quot;1684173756348&quot;</span><span class="p">,</span>
      <span class="s2">&quot;messageType&quot;</span><span class="p">:</span> <span class="s2">&quot;message&quot;</span><span class="p">,</span>
      <span class="s2">&quot;createdDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:02:36.348Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastModifiedDateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15T18:02:36.348Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastEditedDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;deletedDateTime&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;chatId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;importance&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
      <span class="s2">&quot;locale&quot;</span><span class="p">:</span> <span class="s2">&quot;en-us&quot;</span><span class="p">,</span>
      <span class="s2">&quot;webUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;https://teams.microsoft.com/l/message/19%3Aa62cab990d8648b6a9047787e030fa7e%40thread.tacv2/1684173756348?groupId=33333-450e-46d6-9338-f7e3b66a064c&amp;tenantId=55555-b889-434d-802d-13b87c68047b&amp;createdTime=1684173756348&amp;parentMessageId=1684173756348&quot;</span><span class="p">,</span>
      <span class="s2">&quot;policyViolation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;eventDetail&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;application&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#microsoft.graph.teamworkUserIdentity&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;43dd7b73-6a70-475e-88c3-609a9f30b514&quot;</span><span class="p">,</span>
          <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;Mark Scherfling&quot;</span><span class="p">,</span>
          <span class="s2">&quot;userIdentityType&quot;</span><span class="p">:</span> <span class="s2">&quot;aadUser&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tenantId&quot;</span><span class="p">:</span> <span class="s2">&quot;55555-b889-434d-802d-13b87c68047b&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;hello world&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;channelIdentity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;teamId&quot;</span><span class="p">:</span> <span class="s2">&quot;33333-450e-46d6-9338-f7e3b66a064c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;channelId&quot;</span><span class="p">:</span> <span class="s2">&quot;19:a62cab990d8648b6a9047787e030fa7e@thread.tacv2&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;mentions&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;reactions&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;ms_groupteam_id&quot;</span><span class="p">:</span> <span class="s2">&quot;33333-450e-46d6-9338-f7e3b66a064c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ms_channel_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Incident 2121 testing channels&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-teams&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">3707</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-05-15 14:06:30&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_message_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_message_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_message_id</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_id</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_channel_name</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_id</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_group_mail_nickname</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">ms_groupteam_name</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">read_message</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Unable to read messages from Microsoft Channel&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{</span><span class="n">fail_reason</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">text</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;b&gt;Microsoft Channels:&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">  Successfully retrieved &lt;b&gt;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/b&gt; messages &lt;br /&gt;&lt;br /&gt;&quot;&quot;&quot;</span>

  <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;a href=&quot;</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;webUrl&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&gt;Click here&lt;/a&gt;</span>
<span class="s1">    Message Id : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;</span>
<span class="s1">    Channel Id : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;channelIdentity&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;channelId&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;</span>
<span class="s1">    Team Id : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;channelIdentity&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;teamId&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">):</span>
      <span class="n">user_messages</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="p">{})</span>
      <span class="k">if</span> <span class="n">user_messages</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;From User : </span><span class="si">{</span><span class="n">user_messages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;&#39;</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;From Application : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;application&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;&#39;</span>

    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;Body Content : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;</span>
<span class="s1">    Content Type : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;contentType&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;</span>
<span class="s1">    Created Time : </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;createdDateTime&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> &lt;br /&gt;</span>
<span class="s1">    Web URL : </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1"> &lt;br /&gt;</span>
<span class="s1">    &lt;br /&gt;&#39;&#39;&#39;</span>

<span class="n">note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Activation Type</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MS Teams: Archive Team From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Archive Team (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Create Channel From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Create Channel (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Create Group From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Create Group (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Create Team From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Create Team (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Delete Channel From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Delete Channel (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Delete Group From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Delete Group (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Enable Teams for Group From Task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Enable Teams for Group (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Post Incident Information (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Post Message for Workflows</p></td>
<td><p>Post a message to a Teams channel using the new Workflows model</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Post Chat Message (using Workflows)</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Post Chat Task Message (using Workflows)</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Post Task Information (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Read Channel Messages From task (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Read Channel Messages (PB)</p></td>
<td><p>None</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MS Teams: Send Approval Request</p></td>
<td><p>Playbook to send an approval for change to a MS Teams channel. The status of the approval is tracked in the ‘MS Teams Approval Process’ datatable.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MS Teams: Send Approval Request for Tasks</p></td>
<td><p>Playbook to send an approval for change to a MS Teams channel. The status of the approval is tracked in the ‘MS Teams Approval Process’ datatable.</p></td>
<td><p>Manual</p></td>
<td><p>task</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<!--
## Custom Layouts
When the poller is enabled, a tab is enabled automatically: MS Teams Approval Process. This tab containers the Approval Request datatable which is used track pending requests as well as the responses received from MS Teams.

## Data Table - MS Teams Approval Process

 ![screenshot: dt-ms-teams-approval-process](./doc/screenshots/dt-ms-teams-approval-process.png)

#### API Name:
msteams_approval_process

#### Columns:
| Column Name | API Access Name | Type | Tooltip |
| ----------- | --------------- | ---- | ------- |
| Date | `date` | `datetimepicker` | Date the Approval request was submitted |
| Status | `status` | `text` | 'Pending', 'Approved', 'Rejected', 'Invalid', 'Expired' |
| Responder | `responder` | `text` | Name of person who responded to the approval request|
| Response Date | `response_date` | `datetimepicker` | Date when response was received |
| Response Comments | `response_comments` | `text` | Any additional comments added from the Responder|
| Group | `group` | `text` | Group for the channel where the Approval Request was submitted |
| Channel | `channel` | `text` | Channel where the Approval Request was submitted |
| Message | `message` | `text` | Message added with the Approval Request |
| Expiration | `expiration` | `datetimepicker` | Date when the approval will have expired |
| Task Name | `task_name` | `text` | If associated with a Task, the task name |
| Task Id | `task_id` | `text` |  If associated with a Task, the task_id |
| Channel Id | `channel_id` | `text` | Id of the channel for quick lookup |
| Group Id | `group_id` | `text` | Id of the group for quick lookup |
| Message Id | `message_id` | `text` | Id of the message for quick lookup |
| SOAR Message Id | `soar_message_id` | `text` | Internal Id of used to locate the approval request message |
-->
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is a IBM Community provided App. Please search the Community <a class="reference external" href="https://ibm.biz/soarcommunity">ibm.biz/soarcommunity</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_threatminer/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">ThreatMiner</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_task_utils/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Task Utilities</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Microsoft Teams</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li><a class="reference internal" href="#changes">3.0.0 Changes</a></li>
<li><a class="reference internal" href="#id1">2.1.0 Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#endpoint-developed-with-ms-teams">Endpoint Developed With MS Teams</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#endpoint-configuration">Endpoint Configuration</a><ul>
<li><a class="reference internal" href="#register-a-new-application-using-the-azure-portal">Register a new application using the Azure portal</a></li>
<li><a class="reference internal" href="#api-permissions">API Permissions</a></li>
<li><a class="reference internal" href="#application-permission">Application Permission</a></li>
<li><a class="reference internal" href="#delegated-permission">Delegated Permission</a></li>
<li><a class="reference internal" href="#setting-up-api-permissions-both-permissions">Setting up API Permissions (Both Permissions)</a></li>
<li><a class="reference internal" href="#list-of-required-permissions">List of required permissions</a></li>
<li><a class="reference internal" href="#create-a-client-secret-value-both-permissions">Create a client Secret Value (Both Permissions)</a></li>
<li><a class="reference internal" href="#setting-up-incoming-webhooks-both-permissions">Setting up Incoming Webhooks (Both Permissions)</a></li>
<li><a class="reference internal" href="#setting-up-delegated-permissions-delegated-permissions">Setting up Delegated permissions (Delegated permissions)</a></li>
<li><a class="reference internal" href="#app-configuration-both-permissions">App Configuration (Both Permissions)</a></li>
<li><a class="reference internal" href="#ms-teams-workflows">MS Teams Workflows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-ms-teams-post-message-for-workflows">Function - MS Teams Post Message for Workflows</a></li>
<li><a class="reference internal" href="#function-ms-teams-archive-team">Function - MS Teams: Archive Team</a></li>
<li><a class="reference internal" href="#function-ms-teams-create-channel">Function - MS Teams: Create Channel</a></li>
<li><a class="reference internal" href="#function-ms-teams-create-group">Function - MS Teams: Create group</a></li>
<li><a class="reference internal" href="#function-ms-teams-create-team">Function - MS Teams: Create team</a></li>
<li><a class="reference internal" href="#function-ms-teams-delete-channel">Function - MS Teams: Delete Channel</a></li>
<li><a class="reference internal" href="#function-ms-teams-delete-group">Function - MS Teams: Delete Group</a></li>
<li><a class="reference internal" href="#function-ms-teams-enable-team">Function - MS Teams: Enable Team</a></li>
<li><a class="reference internal" href="#function-ms-teams-post-message">Function - MS Teams: Post Message</a></li>
<li><a class="reference internal" href="#function-ms-teams-read-message">Function - MS Teams: Read Message</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>