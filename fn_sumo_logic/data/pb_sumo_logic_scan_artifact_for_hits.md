<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - Sumo Logic: Scan Artifact for Hits

### API Name
`sumo_logic_scan_artifact_for_hits`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type in ['IP Address', 'DNS Name', 'URL', 'User Account', 'Process Name', 'File Name', 'File Path', 'MAC Address', 'User Agent'] AND incident.properties.sumo_logic_insight_id has_a_value`

### Object Type
`artifact`

### Description
Scan artifacts added to Sumo Logic case and add hit if


---
## Function - Sumo Logic: Get Entity

### API Name
`sumo_logic_get_entity`

### Output Name
`get_entity_results`

### Message Destination
`fn_sumo_logic`

### Function-Input Script
```python
ARTIFACT_TYPE_MAPPING = {
  "DNS Name": "_hostname",
  "IP Address": "_ip",
  "File Path": "_file",
  "MAC Address": "_mac",
  "Process Name": "_process",
  "User Account": "_username",
  "User Agent": "_useragent",
  "URL": "_url"
}

inputs.sumo_logic_entity_type = ARTIFACT_TYPE_MAPPING.get(artifact.type, None)
if not inputs.sumo_logic_entity_type:
  helper.fail(f"Artifact {artifact.type} not mapped.")
inputs.sumo_logic_entity_value = artifact.value
```

---

## Local script - Sumo Logic: Add Hit

### Description
Check the results of function to get a Sumo Logic entity and add hits depending on the results.

### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
# Edit the following variable to change the minimum threshold at which a hit is added to an artifact.
MINIMUM_RECENT_SIGNAL_SEVERITY = 8
results = playbook.functions.results.get_entity_results

note_text = "<b>Sumo Logic Scan Artifact (Manual):</b><br>"
if results.get("success"):
    content = results.get("content")
    if content:
        data = content.get("data", {})
        if data:
            total = data.get("total", 0)
            if total >= 1:
                objects = data.get("objects", [])
                if total >= 1:
                    entity = objects[0]
                    recent_signal_severity = entity.get("recentSignalSeverity")
                    if recent_signal_severity >= MINIMUM_RECENT_SIGNAL_SEVERITY:
                        # Create a hit on the artifact.
                        hit = [
                          {
                            "name": "Artifact Value",
                            "type": "string",
                            "value": f"{artifact.value}"
                          }
                        ]
                        artifact.addHit(f"Sumo Logic: Signal Severity Total: {recent_signal_severity}.", hit)
                        note_text = f"{note_text} Hit added on {artifact.type} {artifact.value} with Signal Severity Total: {recent_signal_severity}."
                    else:
                        note_text = f"{note_text} No Hit added on {artifact.type} {artifact.value} with Signal Severity Total: {recent_signal_severity}."
                else:
                    note_text = f"{note_text} No Hit added on {artifact.type} {artifact.value} - no entity found."
            else:
                note_text = f"{note_text} No Hit added on {artifact.type} {artifact.value} - no entity found."
        else:
            note_text = f"{note_text} No Hit added on {artifact.type} {artifact.value} - no data found."
    else:
        note_text = f"{note_text} No Hit added on {artifact.type} {artifact.value} - no content found."
else:
    reason = results.get("reason", None)
    note_text = f"{note_text} No Hit added on {artifact.type} {artifact.value} - get entity function failed:<br>reason: {reason}."

incident.addNote(note_text)
```

---

