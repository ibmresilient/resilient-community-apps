{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1727726154841,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_comment_text",
      "hide_notification": false,
      "id": 436,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_comment_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_comment_text",
      "tooltip": "",
      "type_id": 11,
      "uuid": "b298e776-04c6-4a04-b05f-dd15e1eb73f8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_insight_tag",
      "hide_notification": false,
      "id": 441,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_tag",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_insight_tag",
      "tooltip": "",
      "type_id": 11,
      "uuid": "da22c2fd-6ef2-4aa3-aeca-c8e1ff9d1e80",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_incident_id",
      "hide_notification": false,
      "id": 435,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "e5c74af5-081c-4a0d-84be-2b4a95b6c51c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_entity_type",
      "hide_notification": false,
      "id": 460,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_entity_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_entity_type",
      "tooltip": "",
      "type_id": 11,
      "uuid": "0d44d1ef-3472-48ac-b499-bbc177e4a8ff",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_insight_resolution",
      "hide_notification": false,
      "id": 444,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_resolution",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_insight_resolution",
      "tooltip": "",
      "type_id": 11,
      "uuid": "0fcf0856-ed31-4ad2-9c71-2c9eb57d0faf",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_insight_id",
      "hide_notification": false,
      "id": 433,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_insight_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "2a7f33ae-7cdd-4693-aa61-3639a44c4b0d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_insight_status",
      "hide_notification": false,
      "id": 443,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_insight_status",
      "tooltip": "",
      "type_id": 11,
      "uuid": "6d2d2abf-8840-43ff-8d07-e51b126e2450",
      "values": [
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "New",
          "properties": null,
          "uuid": "9deb1487-5b95-4062-b283-864b19be3dfb",
          "value": 152
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "In Progress",
          "properties": null,
          "uuid": "f787cca2-8b60-44ad-b626-7e607415897c",
          "value": 153
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Closed",
          "properties": null,
          "uuid": "d952b750-0233-4ffc-b6e6-35e395a5becc",
          "value": 154
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_entity_value",
      "hide_notification": false,
      "id": 461,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_entity_value",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_entity_value",
      "tooltip": "",
      "type_id": 11,
      "uuid": "70198674-4c04-453e-b778-b4cdf91babea",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sumo_logic_signal_id",
      "hide_notification": false,
      "id": 457,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_signal_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sumo_logic_signal_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "71911fd6-1fe1-45c7-aa57-f8bc59639f79",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_global_confidence",
      "hide_notification": false,
      "id": 430,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_global_confidence",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Global Confidence",
      "tooltip": "",
      "type_id": 0,
      "uuid": "895d5c31-a827-4324-8fb8-24a3416682cb",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_id",
      "hide_notification": false,
      "id": 427,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight ID",
      "tooltip": "",
      "type_id": 0,
      "uuid": "91213782-92e8-4c0b-8028-5bdff5b91be9",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_tags",
      "hide_notification": false,
      "id": 428,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Tags",
      "tooltip": "",
      "type_id": 0,
      "uuid": "cab47b75-b1ba-4700-a2a6-0915941881e7",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_link",
      "hide_notification": false,
      "id": 429,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_link",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": true,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Link",
      "tooltip": "",
      "type_id": 0,
      "uuid": "ceda26cf-80a4-4b91-b2a8-d650a5584e07",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_status",
      "hide_notification": false,
      "id": 437,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "ee1f519a-de62-49a4-8833-998fbdad328d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_assignee",
      "hide_notification": false,
      "id": 440,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_assignee",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Assignee",
      "tooltip": "",
      "type_id": 0,
      "uuid": "095b2738-ef37-4ab5-b5cf-20d2d9adffb3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_source",
      "hide_notification": false,
      "id": 439,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_source",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Source",
      "tooltip": "",
      "type_id": 0,
      "uuid": "381b867e-c7f0-45ae-927f-bf171cf2740b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_readable_id",
      "hide_notification": false,
      "id": 438,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_readable_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Readable ID",
      "tooltip": "",
      "type_id": 0,
      "uuid": "52f07c7b-f21d-486e-9cf2-382cc75f6591",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_resolution",
      "hide_notification": false,
      "id": 431,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_resolution",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Resolution",
      "tooltip": "",
      "type_id": 0,
      "uuid": "75a7a856-11db-48e6-b243-d0dea2696a6a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sumo_logic_insight_sub_resolution",
      "hide_notification": false,
      "id": 432,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sumo_logic_insight_sub_resolution",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Insight Sub Resolution",
      "tooltip": "",
      "type_id": 0,
      "uuid": "7f456823-8d24-45bd-a352-90758ea567a7",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1722269572156,
      "description": {
        "content": "Post a comment to a Sumo Logic insight in Sumo Logic.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Add Comment to Insight",
      "export_key": "sumo_logic_add_comment_to_insight",
      "id": 21,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1722269572156,
      "name": "sumo_logic_add_comment_to_insight",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "8b5fda1a-87c8-4c96-8e7a-5253bdeadfc5",
      "version": 0,
      "view_items": [
        {
          "content": "2a7f33ae-7cdd-4693-aa61-3639a44c4b0d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "b298e776-04c6-4a04-b05f-dd15e1eb73f8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1722619882750,
      "description": {
        "content": "Add a tag to a Sumo Logic insight in Sumo Logic.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Add Tag to Insight",
      "export_key": "sumo_logic_add_tag_to_insight",
      "id": 22,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1722619882750,
      "name": "sumo_logic_add_tag_to_insight",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "5e5cd41b-464c-46bb-99a2-146d0cfa4b22",
      "version": 0,
      "view_items": [
        {
          "content": "2a7f33ae-7cdd-4693-aa61-3639a44c4b0d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "da22c2fd-6ef2-4aa3-aeca-c8e1ff9d1e80",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1724242088493,
      "description": {
        "content": "Query Sumo Logic to get details of an entity.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Get Entity",
      "export_key": "sumo_logic_get_entity",
      "id": 25,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724422329689,
      "name": "sumo_logic_get_entity",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "0a9aa950-d584-4133-92a5-785e9d3427eb",
      "version": 2,
      "view_items": [
        {
          "content": "0d44d1ef-3472-48ac-b499-bbc177e4a8ff",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "70198674-4c04-453e-b778-b4cdf91babea",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1722261673571,
      "description": {
        "content": "Get the details of a Sumo Logic insight given the insight ID.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Get Insight By ID",
      "export_key": "sumo_logic_get_insight_by_id",
      "id": 19,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724422439892,
      "name": "sumo_logic_get_insight_by_id",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "eee2701a-4f87-4317-89ef-c14be4bb096f",
      "version": 2,
      "view_items": [
        {
          "content": "2a7f33ae-7cdd-4693-aa61-3639a44c4b0d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1722265702902,
      "description": {
        "content": "Get comments from a Sumo Logic insight and add any new ones as notes to the corresponding SOAR case.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Get Insights Comments",
      "export_key": "sumo_logic_get_insights_comments",
      "id": 20,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1722265702902,
      "name": "sumo_logic_get_insights_comments",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "c6cd089a-ec5c-49e6-87b1-fcd0ebb5dd3c",
      "version": 0,
      "view_items": [
        {
          "content": "2a7f33ae-7cdd-4693-aa61-3639a44c4b0d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "e5c74af5-081c-4a0d-84be-2b4a95b6c51c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1723227842813,
      "description": {
        "content": "Get the details of a Sumo Logic signal given the signal ID.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Get Signal by ID",
      "export_key": "sumo_logic_get_signal_by_id",
      "id": 24,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724422500084,
      "name": "sumo_logic_get_signal_by_id",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "6fb47812-8acf-4ed0-a757-b2f36572ff90",
      "version": 1,
      "view_items": [
        {
          "content": "71911fd6-1fe1-45c7-aa57-f8bc59639f79",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1722623370497,
      "description": {
        "content": "Update the status of an insight in Sumo Logic.  If the status is set to closed, set the resolution reason.",
        "format": "text"
      },
      "destination_handle": "fn_sumo_logic",
      "display_name": "Sumo Logic: Update Insight Status",
      "export_key": "sumo_logic_update_insight_status",
      "id": 23,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1722629494032,
      "name": "sumo_logic_update_insight_status",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "afbace61-e67f-4c0e-84fd-45565a5beb92",
      "version": 1,
      "view_items": [
        {
          "content": "2a7f33ae-7cdd-4693-aa61-3639a44c4b0d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "6d2d2abf-8840-43ff-8d07-e51b126e2450",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0fcf0856-ed31-4ad2-9c71-2c9eb57d0faf",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 86,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1727726152981,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1727726152981,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_sumo_logic",
      "name": "Sumo Logic",
      "programmatic_name": "fn_sumo_logic",
      "tags": [],
      "users": [
        "admin@example.com"
      ],
      "uuid": "de560cff-613d-4c3f-abf3-2013377346a9"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe\" isExecutable=\"true\" name=\"playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1x5irmf\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Add Comment to Insight\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"8b5fda1a-87c8-4c96-8e7a-5253bdeadfc5\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\\ninputs.sumo_logic_comment_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_comment_to_insight_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1x5irmf\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ddp92g\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1x5irmf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0ldxo3w\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Sumo Logic: Add comment to insight\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"32c14608-6a6a-4f0b-b43f-4b0664ac0032\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ddp92g\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ldxo3w\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0ddp92g\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0ldxo3w\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1x5irmf\" id=\"Flow_1x5irmf_di\"\u003e\u003comgdi:waypoint x=\"740\" y=\"106\"/\u003e\u003comgdi:waypoint x=\"740\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ddp92g\" id=\"Flow_0ddp92g_di\"\u003e\u003comgdi:waypoint x=\"740\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"740\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ldxo3w\" id=\"Flow_0ldxo3w_di\"\u003e\u003comgdi:waypoint x=\"740\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"740\" y=\"374\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"659\" y=\"54\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"674\" y=\"374\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"642\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"642\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722270139870,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe",
      "description": {
        "content": "Manual playbook to add a comment to a Sumo Logic insight in Sumo Logic.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Add Comment to Insight",
      "export_key": "sumo_logic_add_comment_to_insight",
      "field_type_handle": "playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Add Comment to Insight",
        "export_key": "playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe",
        "uuid": "9ddcac52-d2f8-4589-bf4b-efe3fbba1357"
      },
      "has_logical_errors": false,
      "id": 11,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1722270567061,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722270370452,
          "description": "Write results of adding comment to Sumo Logic insight.",
          "enabled": false,
          "export_key": "Sumo Logic: Add comment to insight",
          "id": 14,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1722270370452,
          "name": "Sumo Logic: Add comment to insight",
          "object_type": "note",
          "playbook_handle": "sumo_logic_add_comment_to_insight",
          "programmatic_name": "sumo_logic_add_comment_to_insight_sumo_logic_add_comment_to_insight",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.add_comment_to_insight_results\n\n# Edit note in SOAR to indicate it was sent to CBC alert\nif results.get(\"success\"):\n  # Get the current time\n  now = datetime.now()\n  note.text = u\"\u003cb\u003ePost comment to Sumo Logic insight at {0}\u003c/b\u003e\u003cbr\u003e{1}\".format(now, note.text.content)",
          "tags": [],
          "uuid": "32c14608-6a6a-4f0b-b43f-4b0664ac0032"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sumo_logic_add_comment_to_insight",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_f16838ca-0807-4bb4-a424-bbbbe52f27fe",
        "id": 13,
        "name": "playbook_f16838ca_0807_4bb4_a424_bbbbe52f27fe",
        "type": "playbook",
        "uuid": "290a1271-3758-456e-a597-3ba1031fefeb"
      },
      "tags": [],
      "type": "default",
      "uuid": "f16838ca-0807-4bb4-a424-bbbbe52f27fe",
      "version": 8
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc\" isExecutable=\"true\" name=\"playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_00ljbz2\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Add Tag to Insight\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"5e5cd41b-464c-46bb-99a2-146d0cfa4b22\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\\ninputs.sumo_logic_insight_tag = playbook.inputs.sumo_logic_insight_tag\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_tag_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_00ljbz2\u003c/incoming\u003e\u003coutgoing\u003eFlow_0rllthv\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_00ljbz2\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0hymamx\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Sumo Logic: write add tag results to note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"691a4e7d-0450-489e-92f5-a2d5d9a47a3d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0rllthv\u003c/incoming\u003e\u003coutgoing\u003eFlow_0hymamx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0rllthv\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0hymamx\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hymamx\" id=\"Flow_0hymamx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"394\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0rllthv\" id=\"Flow_0rllthv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_00ljbz2\" id=\"Flow_00ljbz2_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"394\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722620290941,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc",
      "description": {
        "content": "Manual playbook to add a tag to a Sumo Logic insight.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Add Tag to Insight",
      "export_key": "sumo_logic_add_tag_to_insight",
      "field_type_handle": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Add Tag to Insight",
        "export_key": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc",
        "fields": {
          "sumo_logic_insight_tag": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc/sumo_logic_insight_tag",
            "hide_notification": false,
            "id": 442,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "sumo_logic_insight_tag",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Tag Name",
            "tooltip": "",
            "type_id": 1016,
            "uuid": "55c87df9-d3e4-4fa9-8e6d-519129d11380",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc",
        "uuid": "0bb519ca-764a-40f9-a677-449af7d1090d"
      },
      "has_logical_errors": false,
      "id": 15,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1722621333191,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722620708179,
          "description": "Write the results of add tag to insight function results to a SOAR note.",
          "enabled": false,
          "export_key": "Sumo Logic: write add tag results to note",
          "id": 21,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1722621325379,
          "name": "Sumo Logic: write add tag results to note",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_add_tag_to_insight",
          "programmatic_name": "sumo_logic_add_tag_to_insight_sumo_logic_write_add_tag_results_to_note",
          "script_text": "results = playbook.functions.results.add_tag_results\n\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        data = content.get(\"data\", None)\n        tags = data.get(\"tags\", None)\n        incident.properties.sumo_logic_insight_tags = \", \".join(tags) if isinstance(tags, list) else None\n        note_text = f\"\u003cb\u003eSumo Logic Add Tag to Insight:\u003c/b\u003e  {playbook.inputs.sumo_logic_insight_tag} added.\"\n    else:\n        note_text = \"\u003cb\u003eSumo Logic: Add Tag to Insight\u003c/b\u003e failed to post tag(s) - no content.\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = \"\u003cb\u003eVMware CBC: Add Tag to Insight\u003c/b\u003e failed to add tag(s) {reason}.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "691a4e7d-0450-489e-92f5-a2d5d9a47a3d"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "55c87df9-d3e4-4fa9-8e6d-519129d11380",
            "element": "field_uuid",
            "field_type": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "sumo_logic_add_tag_to_insight",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_e1ffcd57-ac60-442e-a4f9-cf44f6191abc",
        "id": 17,
        "name": "playbook_e1ffcd57_ac60_442e_a4f9_cf44f6191abc",
        "type": "playbook",
        "uuid": "c7eb1bbc-824e-4e55-af15-f42bb9df7534"
      },
      "tags": [],
      "type": "default",
      "uuid": "e1ffcd57-ac60-442e-a4f9-cf44f6191abc",
      "version": 7
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "changed_to",
              "type": null,
              "value": "Closed"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 19,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e\" isExecutable=\"true\" name=\"playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1vmql05\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Update Insight Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"afbace61-e67f-4c0e-84fd-45565a5beb92\"\u003e{\"inputs\":{},\"pre_processing_script\":\"RESOLUTION_LOOKUP = {\\n  \\\"Unresolved\\\": \\\"No Action\\\",   # Unresolved\\n  \\\"Duplicate\\\": \\\"Duplicate\\\",    # Duplicate\\n  \\\"Not an Issue\\\": \\\"False Positive\\\", # Not an Issue\\n  \\\"Resolved\\\": \\\"Resolved\\\"      # Resolved\\n}\\n\\ninputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\\ninputs.sumo_logic_insight_status = \\\"Closed\\\"\\ninputs.sumo_logic_insight_resolution = RESOLUTION_LOOKUP.get(incident.resolution_id, \\\"Resolved\\\")\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_insight_status_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uhl2cc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1d22zdp\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Sumo Logic: Write Update Status to SOAR Note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"2c0b0b3f-2d8a-4c66-9b25-82581665110d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1d22zdp\u003c/incoming\u003e\u003coutgoing\u003eFlow_1wy1xxl\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1wy1xxl\u003c/incoming\u003e\u003cincoming\u003eFlow_0nskvea\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1wy1xxl\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003csequenceFlow id=\"Flow_1d22zdp\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"Sumo Logic: Add Comment to Insight\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"8b5fda1a-87c8-4c96-8e7a-5253bdeadfc5\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\\ninputs.sumo_logic_comment_text = incident.resolution_summary.content if incident.resolution_summary.content else \\\"Case {0} was closed in QRadar SOAR\\\".format(incident.id)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_comment_to_insight_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1vmql05\u003c/incoming\u003e\u003coutgoing\u003eFlow_0lc64z1\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1vmql05\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/\u003e\u003cexclusiveGateway default=\"Flow_0xuso52\" id=\"ConditionPoint_5\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_0lc64z1\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uhl2cc\u003c/outgoing\u003e\u003coutgoing\u003eFlow_0xuso52\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003csequenceFlow id=\"Flow_0lc64z1\" sourceRef=\"ServiceTask_4\" targetRef=\"ConditionPoint_5\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Sumo Logic: Write Error Posting Comment to Insight\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"1057f893-a147-4aa2-8b7a-452fd736d594\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0xuso52\u003c/incoming\u003e\u003coutgoing\u003eFlow_0nskvea\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0nskvea\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_3\"/\u003e\u003csequenceFlow id=\"Flow_0uhl2cc\" name=\"test comment is post to insight\" sourceRef=\"ConditionPoint_5\" targetRef=\"ServiceTask_1\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"test comment is post to insight\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"results = playbook.functions.results.add_comment_to_insight_results\\nif results.get(\\\"success\\\"):\\n  result = True\\nelse:\\n  result = False\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_0xuso52\" name=\"Else\" sourceRef=\"ConditionPoint_5\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0xuso52\" id=\"Flow_0xuso52_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"347\"/\u003e\u003comgdi:waypoint x=\"860\" y=\"347\"/\u003e\u003comgdi:waypoint x=\"860\" y=\"388\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"779\" y=\"329\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uhl2cc\" id=\"Flow_0uhl2cc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"332\"/\u003e\u003comgdi:waypoint x=\"530\" y=\"332\"/\u003e\u003comgdi:waypoint x=\"530\" y=\"358\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"83\" x=\"584\" y=\"314\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0nskvea\" id=\"Flow_0nskvea_di\"\u003e\u003comgdi:waypoint x=\"860\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"860\" y=\"543\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"543\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"614\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0lc64z1\" id=\"Flow_0lc64z1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vmql05\" id=\"Flow_1vmql05_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1d22zdp\" id=\"Flow_1d22zdp_di\"\u003e\u003comgdi:waypoint x=\"530\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"530\" y=\"468\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1wy1xxl\" id=\"Flow_1wy1xxl_di\"\u003e\u003comgdi:waypoint x=\"628\" y=\"510\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"510\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"614\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"432\" y=\"358\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"432\" y=\"468\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"614\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_5\" id=\"ConditionPoint_5_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"599.5\" y=\"254\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"761.5\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722626009417,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e",
      "description": {
        "content": "Automatic playbook that updates the Status and Resolution of the associated insight in Sumo Logic  when the cases is closed in SOAR.  The SOAR case resolution summary is written as a comment to the Sumo Logic insight.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Close Insight on Case Close",
      "export_key": "sumo_logic_close_insight_on_case_close",
      "field_type_handle": "playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Close Insight on Case Close",
        "export_key": "playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e",
        "uuid": "51e3fcf5-8da1-4002-b44f-4d684c473ca4"
      },
      "has_logical_errors": false,
      "id": 16,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1727186828673,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722628600015,
          "description": "Write a note to SOAR case.",
          "enabled": false,
          "export_key": "Sumo Logic: Write Error Posting Comment to Insight",
          "id": 23,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1722628696696,
          "name": "Sumo Logic: Write Error Posting Comment to Insight",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_close_insight_on_case_close",
          "programmatic_name": "sumo_logic_close_insight_on_case_close_sumo_logic_error_posting_comment_to_insight",
          "script_text": "results = playbook.functions.results.add_comment_to_insight_results\n\nnote_text = \"Sumo Logic Automatic playbook \u003cb\u003eOn close from SOAR case\u003c/b\u003e failed to post comment to Sumo Logic insight: {0}\".format(results.get(\"reason\", None))\n\nincident.addNote(note_text)",
          "tags": [],
          "uuid": "1057f893-a147-4aa2-8b7a-452fd736d594"
        },
        {
          "actions": [],
          "created_date": 1722627305780,
          "description": "Write the results of update insight status function to a SOAR note. ",
          "enabled": false,
          "export_key": "Sumo Logic: Write Update Status to SOAR Note",
          "id": 22,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1727186825831,
          "name": "Sumo Logic: Write Update Status to SOAR Note",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_close_insight_on_case_close",
          "programmatic_name": "sumo_logic_close_insight_on_case_close_sumo_logic_write_update_status_ro_soar_note",
          "script_text": "results = playbook.functions.results.update_insight_status_results\n\nif results.get(\"success\"):\n  note_text = \"\u003cb\u003eSumo Logic: Update Status on Case Close:\u003c/b\u003e Closed insight in Sumo Logic\"\n  incident.properties.sumo_logic_insight_status = \"Closed\"\n  if results.get(\"content\").get(\"data\").get(\"resolution\"):\n      incident.properties.sumo_logic_insight_resolution = results.get(\"content\").get(\"data\").get(\"resolution\")\nelse:\n  reason = results.get(\"reason\")\n  if \"has already been closed\" in reason:\n      note_text = f\"\u003cb\u003eSumo Logic: Update Status on Case Close:\u003c/b\u003e Sumo Logic insight has already been closed.\"\n  else:\n      note_text = f\"\u003cb\u003eSumo Logic: Update Status on Case Close:\u003c/b\u003e Failed function to update insight status. Reason = {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "2c0b0b3f-2d8a-4c66-9b25-82581665110d"
        }
      ],
      "name": "sumo_logic_close_insight_on_case_close",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_a9e15dcf-0ec9-4a5c-9fcb-a83cd2a4c09e",
        "id": 18,
        "name": "playbook_a9e15dcf_0ec9_4a5c_9fcb_a83cd2a4c09e",
        "type": "playbook",
        "uuid": "8bc6c2e9-b075-4065-b389-1803728460ed"
      },
      "tags": [],
      "type": "default",
      "uuid": "a9e15dcf-0ec9-4a5c-9fcb-a83cd2a4c09e",
      "version": 23
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 11,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69\" isExecutable=\"true\" name=\"playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0rjvldm\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Get Entity\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"0a9aa950-d584-4133-92a5-785e9d3427eb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"ARTIFACT_TYPE_MAPPING = {\\n  \\\"DNS Name\\\": \\\"_hostname\\\",\\n  \\\"IP Address\\\": \\\"_ip\\\",\\n  \\\"File Path\\\": \\\"_file\\\",\\n  \\\"MAC Address\\\": \\\"_mac\\\",\\n  \\\"Process Name\\\": \\\"_process\\\",\\n  \\\"User Account\\\": \\\"_username\\\",\\n  \\\"User Agent\\\": \\\"_useragent\\\",\\n  \\\"URL\\\": \\\"_url\\\"\\n}\\n\\ninputs.sumo_logic_entity_type = ARTIFACT_TYPE_MAPPING.get(artifact.type, None)\\nif not inputs.sumo_logic_entity_type:\\n  helper.fail(f\\\"Artifact {artifact.type} not mapped.\\\")\\ninputs.sumo_logic_entity_value = artifact.value\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_entity_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0rjvldm\u003c/incoming\u003e\u003coutgoing\u003eFlow_01gbsca\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0rjvldm\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Sumo Logic: Add Hit\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"9b474bf0-420a-4ff1-a8b0-34078476ea82\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_01gbsca\u003c/incoming\u003e\u003coutgoing\u003eFlow_150ztsx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_01gbsca\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_150ztsx\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_150ztsx\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_150ztsx\" id=\"Flow_150ztsx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_01gbsca\" id=\"Flow_01gbsca_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0rjvldm\" id=\"Flow_0rjvldm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1724263309122,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69",
      "description": {
        "content": "Scan artifacts added to Sumo Logic case and add hit if",
        "format": "text"
      },
      "display_name": "Sumo Logic: Scan Artifact for Hits",
      "export_key": "sumo_logic_scan_artifact_for_hits",
      "field_type_handle": "playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Scan Artifact for Hits",
        "export_key": "playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69",
        "uuid": "f5fb9746-a585-41ca-abd2-33fd03fdd049"
      },
      "has_logical_errors": false,
      "id": 21,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1727289335817,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1724263309250,
          "description": "Check the results of function to get a Sumo Logic entity and add hits depending on the results.",
          "enabled": false,
          "export_key": "Sumo Logic: Add Hit",
          "id": 33,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1727289333363,
          "name": "Sumo Logic: Add Hit",
          "object_type": "artifact",
          "playbook_handle": "sumo_logic_scan_artifact_for_hits",
          "programmatic_name": "sumo_logic_scan_artifact_for_hits_sumo_logic_add_hit",
          "script_text": "# Edit the following variable to change the minimum threshold at which a hit is added to an artifact.\nMINIMUM_RECENT_SIGNAL_SEVERITY = 8\nresults = playbook.functions.results.get_entity_results\n\nnote_text = \"\u003cb\u003eSumo Logic Scan Artifact (Manual):\u003c/b\u003e\u003cbr\u003e\"\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        data = content.get(\"data\", {})\n        if data:\n            total = data.get(\"total\", 0)\n            if total \u003e= 1:\n                objects = data.get(\"objects\", [])\n                if total \u003e= 1:\n                    entity = objects[0]\n                    recent_signal_severity = entity.get(\"recentSignalSeverity\")\n                    if recent_signal_severity \u003e= MINIMUM_RECENT_SIGNAL_SEVERITY:\n                        # Create a hit on the artifact.\n                        hit = [\n                          {\n                            \"name\": \"Artifact Value\",\n                            \"type\": \"string\",\n                            \"value\": f\"{artifact.value}\"\n                          }\n                        ]\n                        artifact.addHit(f\"Sumo Logic: Signal Severity Total: {recent_signal_severity}.\", hit)\n                        note_text = f\"{note_text} Hit added on {artifact.type} {artifact.value} with Signal Severity Total: {recent_signal_severity}.\"\n                    else:\n                        note_text = f\"{note_text} No Hit added on {artifact.type} {artifact.value} with Signal Severity Total: {recent_signal_severity}.\"\n                else:\n                    note_text = f\"{note_text} No Hit added on {artifact.type} {artifact.value} - no entity found.\"\n            else:\n                note_text = f\"{note_text} No Hit added on {artifact.type} {artifact.value} - no entity found.\"\n        else:\n            note_text = f\"{note_text} No Hit added on {artifact.type} {artifact.value} - no data found.\"\n    else:\n        note_text = f\"{note_text} No Hit added on {artifact.type} {artifact.value} - no content found.\"\nelse:\n    reason = results.get(\"reason\", None)\n    note_text = f\"{note_text} No Hit added on {artifact.type} {artifact.value} - get entity function failed:\u003cbr\u003ereason: {reason}.\"\n\nincident.addNote(note_text)",
          "tags": [],
          "uuid": "9b474bf0-420a-4ff1-a8b0-34078476ea82"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "in",
              "type": null,
              "value": [
                "IP Address",
                "DNS Name",
                "URL",
                "User Account",
                "Process Name",
                "File Name",
                "File Path",
                "MAC Address",
                "User Agent"
              ]
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sumo_logic_scan_artifact_for_hits",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_4ef1504e-fd6e-405d-9963-653e9fe98d69",
        "id": 23,
        "name": "playbook_4ef1504e_fd6e_405d_9963_653e9fe98d69",
        "type": "playbook",
        "uuid": "d1956582-fdc4-4e82-b2bf-5270ad419f9b"
      },
      "tags": [],
      "type": "default",
      "uuid": "4ef1504e-fd6e-405d-9963-653e9fe98d69",
      "version": 14
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "in",
              "type": null,
              "value": [
                "IP Address",
                "DNS Name",
                "URL",
                "User Account",
                "Process Name",
                "File Name",
                "File Path",
                "MAC Address",
                "User Agent"
              ]
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c\" isExecutable=\"true\" name=\"playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0rjvldm\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Get Entity\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"0a9aa950-d584-4133-92a5-785e9d3427eb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"ARTIFACT_TYPE_MAPPING = {\\n  \\\"DNS Name\\\": \\\"_hostname\\\",\\n  \\\"IP Address\\\": \\\"_ip\\\",\\n  \\\"File Path\\\": \\\"_file\\\",\\n  \\\"MAC Address\\\": \\\"_mac\\\",\\n  \\\"Process Name\\\": \\\"_process\\\",\\n  \\\"User Account\\\": \\\"_username\\\",\\n  \\\"User Agent\\\": \\\"_useragent\\\",\\n  \\\"URL\\\": \\\"_url\\\"\\n}\\n\\ninputs.sumo_logic_entity_type = ARTIFACT_TYPE_MAPPING.get(artifact.type, None)\\nif not inputs.sumo_logic_entity_type:\\n  helper.fail(f\\\"Artifact {artifact.type} not mapped.\\\")\\ninputs.sumo_logic_entity_value = artifact.value\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_entity_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0rjvldm\u003c/incoming\u003e\u003coutgoing\u003eFlow_01gbsca\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0rjvldm\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Sumo Logic: Add Hit\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"9fef9dcf-de79-430b-bbbe-6304389f1d8a\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_01gbsca\u003c/incoming\u003e\u003coutgoing\u003eFlow_150ztsx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_01gbsca\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_150ztsx\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_150ztsx\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_150ztsx\" id=\"Flow_150ztsx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_01gbsca\" id=\"Flow_01gbsca_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0rjvldm\" id=\"Flow_0rjvldm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1724267087103,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c",
      "description": {
        "content": "Automatic playbook to scan artifacts added to Sumo Logic case and add hit on artifact if recent Signal Severity Total is greater than specified threshold value.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Scan Artifact for Hits Automatic",
      "export_key": "sumo_logic_scan_artifact_for_hits_automatic",
      "field_type_handle": "playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Scan Artifact for Hits Automatic",
        "export_key": "playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c",
        "uuid": "54527aff-d42c-4fa9-8a6a-44b6cb793d91"
      },
      "has_logical_errors": false,
      "id": 22,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1727287464026,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1724267087207,
          "description": "Check the results of function to get a Sumo Logic entity and add hits depending on the results.",
          "enabled": false,
          "export_key": "Sumo Logic: Add Hit",
          "id": 34,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1727287461096,
          "name": "Sumo Logic: Add Hit",
          "object_type": "artifact",
          "playbook_handle": "sumo_logic_scan_artifact_for_hits_automatic",
          "programmatic_name": "sumo_logic_scan_artifact_for_hits_automatic_sumo_logic_add_hit",
          "script_text": "# Edit the following variable to change the minimum threshold at which a hit is added to an artifact.\nMINIMUM_RECENT_SIGNAL_SEVERITY = 8\nresults = playbook.functions.results.get_entity_results\n\nnote_text = \"\u003cb\u003eSumo Logic Automatic Scan Artifact:\u003c/b\u003e\u003cbr\u003e\"\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        data = content.get(\"data\", {})\n        if data:\n            total = data.get(\"total\", 0)\n            if total \u003e= 1:\n                objects = data.get(\"objects\", [])\n                if total \u003e= 1:\n                    entity = objects[0]\n                    recent_signal_severity = entity.get(\"recentSignalSeverity\")\n                    if recent_signal_severity \u003e= MINIMUM_RECENT_SIGNAL_SEVERITY:\n                        # Create a hit on the artifact.\n                        hit = [\n                          {\n                            \"name\": \"Artifact Value\",\n                            \"type\": \"string\",\n                            \"value\": f\"{artifact.value}\"\n                          }\n                        ]\n                        artifact.addHit(f\"Sumo Logic: Signal Severity Total: {recent_signal_severity}.\", hit)\n                        note_text = f\"{note_text} Hit added on \u003cb\u003e{artifact.type} {artifact.value}\u003c/b\u003e with Signal Severity Total: \u003cb\u003e{recent_signal_severity}\u003c/b\u003e.\"\n\n                        incident.addNote(note_text)",
          "tags": [],
          "uuid": "9fef9dcf-de79-430b-bbbe-6304389f1d8a"
        }
      ],
      "name": "sumo_logic_scan_artifact_for_hits_automatic",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_c4ab9acf-f26a-464c-b79d-809b9cc5ee5c",
        "id": 24,
        "name": "playbook_c4ab9acf_f26a_464c_b79d_809b9cc5ee5c",
        "type": "playbook",
        "uuid": "3dee8d7d-4acf-403c-8be4-803197385e31"
      },
      "tags": [],
      "type": "default",
      "uuid": "c4ab9acf-f26a-464c-b79d-809b9cc5ee5c",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 72,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_1c198053_ee16_4569_8304_ef4330539366\" isExecutable=\"true\" name=\"playbook_1c198053_ee16_4569_8304_ef4330539366\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_14yxfn6\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Get Insight By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"eee2701a-4f87-4317-89ef-c14be4bb096f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_insight_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_14yxfn6\u003c/incoming\u003e\u003coutgoing\u003eFlow_1005szp\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_14yxfn6\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0mozs7i\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1005szp\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_7\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"Sumo Logic: Get Insights Comments\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c6cd089a-ec5c-49e6-87b1-fcd0ebb5dd3c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_incident_id = incident.id\\ninputs.sumo_logic_insight_id  = incident.properties.sumo_logic_insight_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_insight_comments_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0y52ie6\u003c/incoming\u003e\u003coutgoing\u003eFlow_02d5dqx\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_02d5dqx\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"Sumo Logic: Write Insight Comments to SOAR note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"88155d30-1bc8-4d5f-84a9-f2d589ffd9c5\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02d5dqx\u003c/incoming\u003e\u003coutgoing\u003eFlow_0mozs7i\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0mozs7i\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_2\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Sumo Logic: Add Artifacts from Insight\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"3b750611-5d9e-4fdb-9b29-15182b459e59\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_05u6l9x\u003c/incoming\u003e\u003coutgoing\u003eFlow_0y52ie6\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0y52ie6\" sourceRef=\"ScriptTask_6\" targetRef=\"ServiceTask_4\"/\u003e\u003cscriptTask id=\"ScriptTask_7\" name=\"Sumo Logic: Update Insight Custom Fields\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"be91b542-3bb1-47f0-9777-108b6962afd0\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1005szp\u003c/incoming\u003e\u003coutgoing\u003eFlow_05u6l9x\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_05u6l9x\" sourceRef=\"ScriptTask_7\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_1c198053_ee16_4569_8304_ef4330539366\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_05u6l9x\" id=\"Flow_05u6l9x_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"292\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"348\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0y52ie6\" id=\"Flow_0y52ie6_di\"\u003e\u003comgdi:waypoint x=\"719\" y=\"432\"/\u003e\u003comgdi:waypoint x=\"719\" y=\"478\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0mozs7i\" id=\"Flow_0mozs7i_di\"\u003e\u003comgdi:waypoint x=\"719\" y=\"682\"/\u003e\u003comgdi:waypoint x=\"719\" y=\"714\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02d5dqx\" id=\"Flow_02d5dqx_di\"\u003e\u003comgdi:waypoint x=\"719\" y=\"562\"/\u003e\u003comgdi:waypoint x=\"719\" y=\"598\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1005szp\" id=\"Flow_1005szp_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"172\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"208\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14yxfn6\" id=\"Flow_14yxfn6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"56\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"88\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"4\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"88\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"653\" y=\"714\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"621\" y=\"478\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"621\" y=\"598\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"621\" y=\"348\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_7\" id=\"ScriptTask_7_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"208\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722270694992,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_1c198053_ee16_4569_8304_ef4330539366",
      "description": {
        "content": "Manual playbook to update Sumo Logic case. Custom fields, data tables and comments are updated in the SOAR case.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Update Case",
      "export_key": "sumo_logic_update_case",
      "field_type_handle": "playbook_1c198053_ee16_4569_8304_ef4330539366",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Update Case",
        "export_key": "playbook_1c198053_ee16_4569_8304_ef4330539366",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_1c198053_ee16_4569_8304_ef4330539366",
        "uuid": "907d30e2-8802-4e4f-bddc-2998fb51764a"
      },
      "has_logical_errors": false,
      "id": 13,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1727726108436,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722270695083,
          "description": "Update the custom fields of a Sumo Logic case.",
          "enabled": false,
          "export_key": "Sumo Logic: update custom fields on creation",
          "id": 16,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1722624805048,
          "name": "Sumo Logic: update custom fields on creation",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_update_case",
          "programmatic_name": "sumo_logic_update_case_sumo_logic_update_custom_fields_on_creation",
          "script_text": "# Map Sumo Logic resultion values SOAR resolution id values.\n#    Duplicate \u2014 The insight has triggered before on the same entity and is a duplicate.\n#    False Positive\u2014An insight triggered and it is legitimate activity.\n#    No Action\u2014An insight triggered and it might not be an incident but is also not a false positive.\n#    Resolved \u2014 An incident occurred and was resolved.\n\nMAPPING_RESOLUTION = {\n  \"Duplicate\" : \"Duplicate\",\n  \"False Positive\": \"Resolved\",\n  \"No Action\": \"Resolved\",\n  \"Resolved\" : \"Resolved\"\n}\n\n# Map Sumo Logic subResolution values to SOAR resolution id values.\nMAPPING_SUB_RESOLUTION_ON_CLOSE = {\n  \"None\": \"Resolved\",\n  \"False positive\": \"Not an Issue\",\n  \"True positive\": \"Resolved\"\n}\nresults = playbook.functions.results.get_insight_by_id_results\n\nif not results.success:\n    incident.addNote(\"\u003cb\u003eSumo Logic: Update Case on Creation:\u003c/b\u003e Unable to get case data to update custom fields.\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        data = content.get(\"data\", None)\n        tags = data.get(\"tags\", None)\n        incident.properties.sumo_logic_insight_tags = \", \".join(tags) if isinstance(tags, list) else None\n        entity_url = content.get(\"entity_url\", None)\n        if entity_url:\n            incident.properties.sumo_logic_insight_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027{0}\u0027\u003eInsight\u003c/a\u003e\".format(entity_url)\n        incident.properties.sumo_logic_insight_global_confidence = int(data.get(\"confidence\") * 100) if data.get(\"confidence\") \u003c= 1 else None\n        incident.properties.sumo_logic_insight_readable_id = data.get(\"readableId\", None)\n        incident.properties.sumo_logic_insight_source = data.get(\"source\", None)\n        incident.properties.sumo_logic_insight_resolution = data.get(\"resolution\", None)\n        incident.properties.sumo_logic_insight_sub_resolution = data.get(\"subResolution\", None)\n        assignee = data.get(\"assignee\", None)\n        if assignee:\n            display_name = assignee.get(\"displayName\", \"\")\n            username     = assignee.get(\"username\", \"\")\n            incident.properties.sumo_logic_insight_assignee = f\"{display_name} ({username})\"\n        status = data.get(\"status\", None)\n        if status:\n            incident.properties.sumo_logic_insight_status = status.get(\"displayName\")\n\n        incident.addNote(f\"\u003cb\u003eSumo Logic: Update Case on Creation:\u003c/b\u003e Write Alert Custom Fields complete.\")\n        if incident.properties.sumo_logic_insight_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_RESOLUTION.get(incident.properties.sumo_logic_insight_resolution, \"Resolved\")\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n    else: \n        incident.addNote(\"\u003cb\u003eSumo Logic: Update Case on Creation:\u003c/b\u003e Write Insight Custom Fields did NOT complete.\")",
          "tags": [],
          "uuid": "af9b279b-3017-4dbc-a1b1-294b81502277"
        },
        {
          "actions": [],
          "created_date": 1723043891783,
          "description": "Update custom fields of a Sumo Logic Insight case and write results to a note.",
          "enabled": false,
          "export_key": "Sumo Logic: Update Insight Custom Fields",
          "id": 26,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1727726105242,
          "name": "Sumo Logic: Update Insight Custom Fields",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_update_case",
          "programmatic_name": "sumo_logic_update_case_sumo_logic_update_insight_custom_fields",
          "script_text": "# Map Sumo Logic resolution values to SOAR resolution id values.\n#    Duplicate \u2014 The insight has triggered before on the same entity and is a duplicate.\n#    False Positive\u2014An insight triggered and it is legitimate activity.\n#    No Action\u2014An insight triggered and it might not be an incident but is also not a false positive.\n#    Resolved \u2014 An incident occurred and was resolved.\n\nMAPPING_RESOLUTION = {\n  \"Duplicate\" : \"Duplicate\",\n  \"False Positive\": \"Resolved\",\n  \"No Action\": \"Resolved\",\n  \"Resolved\" : \"Resolved\"\n}\n\n# Map Sumo Logic subResolution values to SOAR resolution id values.\nMAPPING_SUB_RESOLUTION_ON_CLOSE = {\n  \"None\": \"Resolved\",\n  \"False positive\": \"Not an Issue\",\n  \"True positive\": \"Resolved\"\n}\nresults = playbook.functions.results.get_insight_by_id_results\n\nif not results.success:\n    reason = results.get(\"reason\", None) \n    incident.addNote(f\"\u003cb\u003eSumo Logic: Update Case:\u003c/b\u003e Unable to get case data to update custom fields.\u003cbr\u003e  {reason}\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        data = content.get(\"data\", None)\n        tags = data.get(\"tags\", None)\n        incident.properties.sumo_logic_insight_tags = \", \".join(tags) if isinstance(tags, list) else None\n        entity_url = content.get(\"entity_url\", None)\n        if entity_url:\n            incident.properties.sumo_logic_insight_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027{0}\u0027\u003eInsight\u003c/a\u003e\".format(entity_url)\n        confidence = data.get(\"confidence\", None)\n        incident.properties.sumo_logic_insight_global_confidence = int(confidence * 100) if confidence and (confidence \u003c= 1) else None\n        incident.properties.sumo_logic_insight_readable_id = data.get(\"readableId\", None)\n        incident.properties.sumo_logic_insight_source = data.get(\"source\", None)\n        incident.properties.sumo_logic_insight_resolution = data.get(\"resolution\", None)\n        incident.properties.sumo_logic_insight_sub_resolution = data.get(\"subResolution\", None)\n        assignee = data.get(\"assignee\", None)\n        if assignee:\n            display_name = assignee.get(\"displayName\", \"\")\n            username     = assignee.get(\"username\", \"\")\n            incident.properties.sumo_logic_insight_assignee = f\"{display_name} ({username})\"\n        status = data.get(\"status\", None)\n        if status:\n            incident.properties.sumo_logic_insight_status = status.get(\"displayName\")\n\n        incident.addNote(f\"\u003cb\u003eSumo Logic: Update Case:\u003c/b\u003e Update Insight Custom Fields complete.\")\n        if incident.properties.sumo_logic_insight_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_RESOLUTION.get(incident.properties.sumo_logic_insight_resolution, \"Resolved\")\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n    else: \n        incident.addNote(\"\u003cb\u003eSumo Logic: Update Case:\u003c/b\u003e Write Insight Custom Fields did NOT complete.\")",
          "tags": [],
          "uuid": "be91b542-3bb1-47f0-9777-108b6962afd0"
        },
        {
          "actions": [],
          "created_date": 1722534353399,
          "description": "Write the get insights comments function results to a SOAR note.",
          "enabled": false,
          "export_key": "Sumo Logic: Write Insight Comments to SOAR note",
          "id": 19,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1723044189329,
          "name": "Sumo Logic: Write Insight Comments to SOAR note",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_update_case",
          "programmatic_name": "sumo_logic_update_case_sumo_logic_write_get_insight_comment_to_soar_note",
          "script_text": "results = playbook.functions.results.get_insight_comments_results\n\nif results.get(\"success\"):\n    content = results.get(\"content\")\n    if content:\n        note_text = \"\u003cb\u003eSumo Logic: Update Case - Get Insight Comments\u003c/b\u003e function added {0} note(s) in SOAR.\".format(content.get(\"count\"))\n    else:\n        note_text = \"\u003cb\u003eSumo Logic: Update Case - Get Insight Comments\u003c/b\u003e function failed to get notes from Sumo Logic.\"\nelse:\n    note_text = \"\u003cb\u003eSumo Logic: Update Case - Get Insight Comments\u003c/b\u003e function failed to get notes from Sumo Logic.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "88155d30-1bc8-4d5f-84a9-f2d589ffd9c5"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sumo_logic_update_case",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_1c198053-ee16-4569-8304-ef4330539366",
        "id": 15,
        "name": "playbook_1c198053_ee16_4569_8304_ef4330539366",
        "type": "playbook",
        "uuid": "86a53459-1032-4306-9bb5-6ac335166dad"
      },
      "tags": [],
      "type": "default",
      "uuid": "1c198053-ee16-4569-8304-ef4330539366",
      "version": 74
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 32,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8\" isExecutable=\"true\" name=\"playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_14yxfn6\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Get Insight By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"eee2701a-4f87-4317-89ef-c14be4bb096f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_insight_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_14yxfn6\u003c/incoming\u003e\u003coutgoing\u003eFlow_1005szp\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_14yxfn6\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0e6jfhm\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Sumo Logic: update custom fields on case creation\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"92683821-f6a2-41c2-8536-4fd61fb2f0d5\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1005szp\u003c/incoming\u003e\u003coutgoing\u003eFlow_1itqtr9\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1005szp\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1itqtr9\" sourceRef=\"ScriptTask_3\" targetRef=\"ScriptTask_7\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"Sumo Logic: Get Insights Comments\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c6cd089a-ec5c-49e6-87b1-fcd0ebb5dd3c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_incident_id = incident.id\\ninputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_insights_comments_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1e7ejyt\u003c/incoming\u003e\u003coutgoing\u003eFlow_1j20s6k\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1j20s6k\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"Sumo Logic: Write Insight Comments to SOAR notes\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"ab401c3b-5998-4660-a962-e3a7d307ec69\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1j20s6k\u003c/incoming\u003e\u003coutgoing\u003eFlow_0e6jfhm\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0e6jfhm\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_2\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Sumo Logic: Add Artifacts from Insight\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"3b750611-5d9e-4fdb-9b29-15182b459e59\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1e919ep\u003c/incoming\u003e\u003coutgoing\u003eFlow_1e7ejyt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1e7ejyt\" sourceRef=\"ScriptTask_6\" targetRef=\"ServiceTask_4\"/\u003e\u003cscriptTask id=\"ScriptTask_7\" name=\"Sumo Logic: Populate Signals Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"83614eef-bda9-4afe-a160-7e6228d94e33\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1itqtr9\u003c/incoming\u003e\u003coutgoing\u003eFlow_1e919ep\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1e919ep\" sourceRef=\"ScriptTask_7\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1e919ep\" id=\"Flow_1e919ep_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"432\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"468\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1e7ejyt\" id=\"Flow_1e7ejyt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"552\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"588\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0e6jfhm\" id=\"Flow_0e6jfhm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"792\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"824\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1j20s6k\" id=\"Flow_1j20s6k_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"672\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"708\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1itqtr9\" id=\"Flow_1itqtr9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"323\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"348\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1005szp\" id=\"Flow_1005szp_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"212\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"239\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14yxfn6\" id=\"Flow_14yxfn6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"96\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"128\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"44\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"128\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"824\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"239\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"588\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"708\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"468\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_7\" id=\"ScriptTask_7_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"348\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722270642133,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8",
      "description": {
        "content": "Automatic playbook to update Sumo Logic case when the case is created. Custom fields, data tables and comments are updated in the SOAR case.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Update Case on Creation",
      "export_key": "sumo_logic_update_case_on_creation",
      "field_type_handle": "playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Update Case on Creation",
        "export_key": "playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8",
        "uuid": "dc1d846e-4f17-43ca-b14e-a931b10e8566"
      },
      "has_logical_errors": false,
      "id": 12,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1727723557478,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722270642241,
          "description": "Update the custom fields of a Sumo Logic case.",
          "enabled": false,
          "export_key": "Sumo Logic: update custom fields on case creation",
          "id": 15,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1727725618841,
          "name": "Sumo Logic: update custom fields on case creation",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_update_case_on_creation",
          "programmatic_name": "sumo_logic_update_case_on_creation_sumo_logic_update_custom_fields_on_creation",
          "script_text": "# Map Sumo Logic resolution values SOAR resolution id values.\n#    Duplicate \u2014 The insight has triggered before on the same entity and is a duplicate.\n#    False Positive\u2014An insight triggered and it is legitimate activity.\n#    No Action\u2014An insight triggered and it might not be an incident but is also not a false positive.\n#    Resolved \u2014 An incident occurred and was resolved.\n\nMAPPING_RESOLUTION = {\n  \"Duplicate\" : \"Duplicate\",\n  \"False Positive\": \"Resolved\",\n  \"No Action\": \"Resolved\",\n  \"Resolved\" : \"Resolved\"\n}\n\n# Map Sumo Logic subResolution values to SOAR resolution id values.\nMAPPING_SUB_RESOLUTION_ON_CLOSE = {\n  \"None\": \"Resolved\",\n  \"False positive\": \"Not an Issue\",\n  \"True positive\": \"Resolved\"\n}\nresults = playbook.functions.results.get_insight_by_id_results\n\nif not results.success:\n    incident.addNote(\"\u003cb\u003eSumo Logic: Update Case on Creation:\u003c/b\u003e Unable to get case data to update custom fields.\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        data = content.get(\"data\", None)\n        tags = data.get(\"tags\", None)\n        incident.properties.sumo_logic_insight_tags = \", \".join(tags) if isinstance(tags, list) else None\n        entity_url = content.get(\"entity_url\", None)\n        if entity_url:\n            incident.properties.sumo_logic_insight_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027{0}\u0027\u003eInsight\u003c/a\u003e\".format(entity_url)\n        confidence = data.get(\"confidence\", None)\n        incident.properties.sumo_logic_insight_global_confidence = int(confidence * 100) if confidence and (confidence \u003c= 1) else None\n        incident.properties.sumo_logic_insight_readable_id = data.get(\"readableId\", None)\n        incident.properties.sumo_logic_insight_source = data.get(\"source\", None)\n        incident.properties.sumo_logic_insight_resolution = data.get(\"resolution\", None)\n        incident.properties.sumo_logic_insight_sub_resolution = data.get(\"subResolution\", None)\n        assignee = data.get(\"assignee\", None)\n        if assignee:\n            display_name = assignee.get(\"displayName\", \"\")\n            username     = assignee.get(\"username\", \"\")\n            incident.properties.sumo_logic_insight_assignee = f\"{display_name} ({username})\"\n        status = data.get(\"status\", None)\n        if status:\n          incident.properties.sumo_logic_insight_status = status.get(\"displayName\")\n\n        incident.addNote(f\"\u003cb\u003eSumo Logic: Update Case on Creation:\u003c/b\u003e Write Alert Custom Fields complete.\")\n        if incident.properties.sumo_logic_insight_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_RESOLUTION.get(incident.properties.sumo_logic_insight_resolution, \"Resolved\")\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n    else: \n        incident.addNote(\"\u003cb\u003eSumo Logic: Update Case on Creation:\u003c/b\u003e Write Insight Custom Fields did NOT complete.\")",
          "tags": [],
          "uuid": "92683821-f6a2-41c2-8536-4fd61fb2f0d5"
        },
        {
          "actions": [],
          "created_date": 1722538840194,
          "description": "Write the results from get insights comments function results to a note in SOAR.",
          "enabled": false,
          "export_key": "Sumo Logic: Write Insight Comments to SOAR notes",
          "id": 20,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1723044466008,
          "name": "Sumo Logic: Write Insight Comments to SOAR notes",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_update_case_on_creation",
          "programmatic_name": "sumo_logic_update_case_on_creation_sumo_logic_write_get_insights_comments_to_soar_notes",
          "script_text": "results = playbook.functions.results.get_insights_comments_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\")\n  if content:\n    note_text = \"\u003cb\u003eSumo Logic: Update Case on Creation - Get Insight Comments\u003c/b\u003e function added {0} note(s) in SOAR.\".format(content.get(\"count\"))\n  else:\n    note_text = \"\u003cb\u003eSumo Logic: Update Case on Creation - Get Insight Comments\u003c/b\u003e function failed to get notes from Sumo Logic.\"\nelse:\n  note_text = \"\u003cb\u003eSumo Logic: Update Case on Creation - Get Insight Comments\u003c/b\u003e function failed to get notes from Sumo Logic.\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "ab401c3b-5998-4660-a962-e3a7d307ec69"
        }
      ],
      "name": "sumo_logic_update_case_on_creation",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_4a19a1c9-6389-4e0e-b437-a135d0f776d8",
        "id": 14,
        "name": "playbook_4a19a1c9_6389_4e0e_b437_a135d0f776d8",
        "type": "playbook",
        "uuid": "d01ac2c3-7f56-4039-bff0-2d0e827fe807"
      },
      "tags": [],
      "type": "default",
      "uuid": "4a19a1c9-6389-4e0e-b437-a135d0f776d8",
      "version": 34
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 11,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337\" isExecutable=\"true\" name=\"playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0zv0iea\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Update Insight Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"afbace61-e67f-4c0e-84fd-45565a5beb92\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\\ninputs.sumo_logic_insight_status = playbook.inputs.sumo_logic_insight_status\\ninputs.sumo_logic_insight_resolution = playbook.inputs.sumo_logic_insight_resolution\\n\\nif inputs.sumo_logic_insight_status == \\\"Closed\\\" and not playbook.inputs.sumo_logic_insight_resolution:\\n  helper.fail(\\\"Resolution musted be specified if status is Closed.\\\")\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_insight_status_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0zv0iea\u003c/incoming\u003e\u003coutgoing\u003eFlow_02uludo\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0zv0iea\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1uxg6wf\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_02uludo\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Sumo Logic: Write Update Insight Status results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"587cf7f4-6afa-42da-914e-6f64a2e223fc\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02uludo\u003c/incoming\u003e\u003coutgoing\u003eFlow_1uxg6wf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1uxg6wf\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1uxg6wf\" id=\"Flow_1uxg6wf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"434\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02uludo\" id=\"Flow_02uludo_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0zv0iea\" id=\"Flow_0zv0iea_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"434\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722631371002,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
      "description": {
        "content": "Manual playbook to update the status of an insight in Sumo Logic.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Update Insight Status",
      "export_key": "sumo_logic_update_insight_status",
      "field_type_handle": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Update Insight Status",
        "export_key": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
        "fields": {
          "sumo_logic_insight_resolution": {
            "allow_default_value": false,
            "blank_option": true,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337/sumo_logic_insight_resolution",
            "hide_notification": false,
            "id": 445,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sumo_logic_insight_resolution",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Resolution",
            "tooltip": "",
            "type_id": 1018,
            "uuid": "8b32aafd-50f4-4104-ad9f-757c100676f1",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Duplicate",
                "properties": null,
                "uuid": "0e5173ad-6f79-4250-9dab-375cfd79e77f",
                "value": 155
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Resolved",
                "properties": null,
                "uuid": "b84d4c2b-372c-4dd2-9800-e7f2e37dc33a",
                "value": 156
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "False Positive",
                "properties": null,
                "uuid": "19fec2eb-225d-4bde-a5c8-fd81d6a4c7e2",
                "value": 157
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "No Action",
                "properties": null,
                "uuid": "3ddc7cf1-d01f-4fd5-b6fc-e434564efbbc",
                "value": 158
              }
            ]
          },
          "sumo_logic_insight_status": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337/sumo_logic_insight_status",
            "hide_notification": false,
            "id": 446,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sumo_logic_insight_status",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Status",
            "tooltip": "",
            "type_id": 1018,
            "uuid": "e6d0d34e-3e10-465e-87e9-d7752648a648",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "New",
                "properties": null,
                "uuid": "054a1813-5de6-482b-a90a-0f160a9a43c2",
                "value": 159
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "In Progress",
                "properties": null,
                "uuid": "61a891a4-17a5-4229-820a-d2b271d29b9d",
                "value": 160
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Closed",
                "properties": null,
                "uuid": "090c15e3-a871-41b5-a5be-81bd9654742c",
                "value": 161
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
        "uuid": "222f4462-e7f8-4308-acd8-0b1f25fff052"
      },
      "has_logical_errors": false,
      "id": 17,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724187609283,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722879130414,
          "description": "Write results of Update Sumo Logic Status function results to a SOAR note. ",
          "enabled": false,
          "export_key": "Sumo Logic: Write Update Insight Status results",
          "id": 24,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1724187407547,
          "name": "Sumo Logic: Write Update Insight Status results",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_update_insight_status",
          "programmatic_name": "sumo_logic_update_insight_status_sumo_logic_write_update_insight_status_results",
          "script_text": "results = playbook.functions.results.update_insight_status_results\n\nif results.get(\"success\"):\n    note_text = f\"\u003cb\u003eSumo Logic: Update Insight Status: \u003c/b\u003e set:\u003cbr\u003e\"\n    if playbook.inputs.sumo_logic_insight_status:\n        incident.properties.sumo_logic_insight_status = playbook.inputs.sumo_logic_insight_status\n        note_text = f\"{note_text}\u003cbr\u003e   Status:  {playbook.inputs.sumo_logic_insight_status}\"\n    if playbook.inputs.sumo_logic_insight_resolution and playbook.inputs.sumo_logic_insight_status == \u0027Closed\u0027:\n        incident.properties.sumo_logic_insight_resolution = playbook.inputs.sumo_logic_insight_resolution\n        note_text = f\"{note_text}\u003cbr\u003e   Resolution: {playbook.inputs.sumo_logic_insight_resolution}\"\n    # Uncomment if sub_resolution is implemented.\n    #if playbook.inputs.sumo_logic_insight_sub_resolution and playbook.inputs.sumo_logic_insight_status == \u0027Closed\u0027:\n    #    incident.properties.sumo_logic_insight_sub_resolution = playbook.inputs.sumo_logic_insight_sub_resolution\n    #    note_text = f\"{note_text}\u003cbr\u003e   Sub Resolution: {playbook.inputs.sumo_logic_insight_sub_resolution\"\nelse:\n    reason = results.get(\"reason\")\n    note_text = f\"\u003cb\u003eSumo Logic: Update Insight Status: \u003c/b\u003e failed to update status to \u003cb\u003e{playbook.inputs.sumo_logic_insight_status}\u003c/b\u003e:\u003cbr\u003e  {reason}\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "587cf7f4-6afa-42da-914e-6f64a2e223fc"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "e6d0d34e-3e10-465e-87e9-d7752648a648",
            "element": "field_uuid",
            "field_type": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "Resolution must be specified when Status is \u003cb\u003eClosed\u003c/b\u003e:",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "8b32aafd-50f4-4104-ad9f-757c100676f1",
            "element": "field_uuid",
            "field_type": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "sumo_logic_update_insight_status",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_bd1cd7ec-9f52-4e9c-b62c-dd2a660eb337",
        "id": 19,
        "name": "playbook_bd1cd7ec_9f52_4e9c_b62c_dd2a660eb337",
        "type": "playbook",
        "uuid": "03b41560-8f70-4ed4-bc4f-fcecf1fc9d52"
      },
      "tags": [],
      "type": "default",
      "uuid": "bd1cd7ec-9f52-4e9c-b62c-dd2a660eb337",
      "version": 15
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 14,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_ef948d94_776a_4828_80c9_514ee659450b\" isExecutable=\"true\" name=\"playbook_ef948d94_776a_4828_80c9_514ee659450b\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0uynuqm\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Get Entity\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"0a9aa950-d584-4133-92a5-785e9d3427eb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"ARTIFACT_TYPE_MAPPING = {\\n  \\\"DNS Name\\\": \\\"_hostname\\\",\\n  \\\"IP Address\\\": \\\"_ip\\\",\\n  \\\"File Path\\\": \\\"_file\\\",\\n  \\\"MAC Address\\\": \\\"_mac\\\",\\n  \\\"Process Name\\\": \\\"_process\\\",\\n  \\\"User Account\\\": \\\"_username\\\",\\n  \\\"User Agent\\\": \\\"_useragent\\\",\\n  \\\"URL\\\": \\\"_url\\\"\\n}\\n\\ninputs.sumo_logic_entity_type  = ARTIFACT_TYPE_MAPPING.get(artifact.type, None)\\nif not inputs.sumo_logic_entity_type:\\n  helper.fail(f\\\"Artifact type {artifact.type} not specified\\\")\\ninputs.sumo_logic_entity_value = artifact.value\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_entity_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uynuqm\u003c/incoming\u003e\u003coutgoing\u003eFlow_0to9wsu\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0uynuqm\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Sumo Logic: Write Entity to Note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f4943732-6af3-4936-b580-48bf8ceb6474\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0to9wsu\u003c/incoming\u003e\u003coutgoing\u003eFlow_00ctmp1\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0to9wsu\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_00ctmp1\u003c/incoming\u003e\u003coutgoing\u003eFlow_1yv2a7x\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_00ctmp1\" sourceRef=\"ScriptTask_2\" targetRef=\"ScriptTask_3\"/\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1yv2a7x\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1yv2a7x\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_ef948d94_776a_4828_80c9_514ee659450b\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1yv2a7x\" id=\"Flow_1yv2a7x_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"514\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_00ctmp1\" id=\"Flow_00ctmp1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0to9wsu\" id=\"Flow_0to9wsu_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uynuqm\" id=\"Flow_0uynuqm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"514\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1724243582282,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_ef948d94_776a_4828_80c9_514ee659450b",
      "description": {
        "content": "Write the Sumo Logic entity information to a note.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Write Entity JSON to Note",
      "export_key": "sumo_logic_write_entity_json_to_note",
      "field_type_handle": "playbook_ef948d94_776a_4828_80c9_514ee659450b",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Write Entity JSON to Note",
        "export_key": "playbook_ef948d94_776a_4828_80c9_514ee659450b",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_ef948d94_776a_4828_80c9_514ee659450b",
        "uuid": "4e7c3681-84e9-426d-a2dd-aabe90307cdb"
      },
      "has_logical_errors": false,
      "id": 19,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724262292736,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1724243911966,
          "description": "Write the results of get entities function to a formatted note.",
          "enabled": false,
          "export_key": "Sumo Logic: Write Entity to Note",
          "id": 31,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1724253937432,
          "name": "Sumo Logic: Write Entity to Note",
          "object_type": "artifact",
          "playbook_handle": "sumo_logic_write_entity_json_to_note",
          "programmatic_name": "sumo_logic_write_entity_json_to_note_sumo_logic_write_entity_to_note",
          "script_text": "results = playbook.functions.results.get_entity_results\n\ninputs = inputs = results.get(\"inputs\", None)\nartifact_type  = inputs.get(\"sumo_logic_entity_type\", None)\nartifact_value = inputs.get(\"sumo_logic_entity_value\", None)\nheader = f\"\u003cb\u003eSumo Logic Entity: {artifact_type}-{artifact_value}\u003c/b\u003e\u003cbr\u003e\"\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "f4943732-6af3-4936-b580-48bf8ceb6474"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sumo_logic_write_entity_json_to_note",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_ef948d94-776a-4828-80c9-514ee659450b",
        "id": 21,
        "name": "playbook_ef948d94_776a_4828_80c9_514ee659450b",
        "type": "playbook",
        "uuid": "0546d711-f5ed-4af4-9bf4-525bce70f1a8"
      },
      "tags": [],
      "type": "default",
      "uuid": "ef948d94-776a-4828-80c9-514ee659450b",
      "version": 19
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9\" isExecutable=\"true\" name=\"playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1eyoeuc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Sumo Logic: Get Insight By ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"eee2701a-4f87-4317-89ef-c14be4bb096f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_insight_id = incident.properties.sumo_logic_insight_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_insight_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1eyoeuc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1f46v2y\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1eyoeuc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0hsyjuv\u003c/incoming\u003e\u003coutgoing\u003eFlow_1xdmodt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1f46v2y\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1xdmodt\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1xdmodt\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"Sumo Logic: Write Insight Results to Note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4bf0d320-21ac-488a-a478-7e67d73b49e9\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1f46v2y\u003c/incoming\u003e\u003coutgoing\u003eFlow_0hsyjuv\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0hsyjuv\" sourceRef=\"ScriptTask_4\" targetRef=\"ScriptTask_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hsyjuv\" id=\"Flow_0hsyjuv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1xdmodt\" id=\"Flow_1xdmodt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"514\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1f46v2y\" id=\"Flow_1f46v2y_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"215\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1eyoeuc\" id=\"Flow_1eyoeuc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"131\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"131\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"514\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1722262459345,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9",
      "description": {
        "content": "Write the Sumo Logic insight JSON to an incident note in SOAR.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Write Insight JSON to Note",
      "export_key": "sumo_logic_write_insight_json_to_note",
      "field_type_handle": "playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Write Insight JSON to Note",
        "export_key": "playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9",
        "uuid": "e8b72499-b4f7-467a-af5a-a68087be950c"
      },
      "has_logical_errors": false,
      "id": 8,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724264170155,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1722438385338,
          "description": "Format results from get insight by id to pass to JSON conversion script.",
          "enabled": false,
          "export_key": "Sumo Logic: Write Insight Results to Note",
          "id": 17,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1724264167419,
          "name": "Sumo Logic: Write Insight Results to Note",
          "object_type": "incident",
          "playbook_handle": "sumo_logic_write_insight_json_to_note",
          "programmatic_name": "sumo_logic_write_insight_json_to_note_sumo_logic_write_insight_results_to_note",
          "script_text": "results = playbook.functions.results.get_insight_by_id_results\ninputs = results.get(\"inputs\", None)\ninsight_id = inputs.get(\"sumo_logic_insight_id\", None)\n  \nheader = u\"\u003cb\u003eSumo Logic: Get Insight by ID:\u003c/b\u003e {0}\".format(insight_id)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "4bf0d320-21ac-488a-a478-7e67d73b49e9"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sumo_logic_insight_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sumo_logic_write_insight_json_to_note",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_b6ab2825-7293-4c94-9b6a-d485a9d189c9",
        "id": 10,
        "name": "playbook_b6ab2825_7293_4c94_9b6a_d485a9d189c9",
        "type": "playbook",
        "uuid": "8db6c1b8-46a7-4275-9f23-2403705d0730"
      },
      "tags": [],
      "type": "default",
      "uuid": "b6ab2825-7293-4c94-9b6a-d485a9d189c9",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144\" isExecutable=\"true\" name=\"playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1eyoeuc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003csequenceFlow id=\"Flow_1eyoeuc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1t2w1jb\u003c/incoming\u003e\u003coutgoing\u003eFlow_1xdmodt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1xdmodt\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1xdmodt\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"Sumo Logic: Get Signal by ID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6fb47812-8acf-4ed0-a757-b2f36572ff90\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.sumo_logic_signal_id = row.sumo_logic_signal_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_signal_by_id_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1eyoeuc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1m2mecz\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1m2mecz\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_6\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Sumo Logic: Write Signal Results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7f5f5a5f-0d31-4a58-b25f-b114bc8b54ce\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1m2mecz\u003c/incoming\u003e\u003coutgoing\u003eFlow_1t2w1jb\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1t2w1jb\" sourceRef=\"ScriptTask_6\" targetRef=\"ScriptTask_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1t2w1jb\" id=\"Flow_1t2w1jb_di\"\u003e\u003comgdi:waypoint x=\"714\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"714\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1m2mecz\" id=\"Flow_1m2mecz_di\"\u003e\u003comgdi:waypoint x=\"714\" y=\"202\"/\u003e\u003comgdi:waypoint x=\"714\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1xdmodt\" id=\"Flow_1xdmodt_di\"\u003e\u003comgdi:waypoint x=\"713\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"713\" y=\"514\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1eyoeuc\" id=\"Flow_1eyoeuc_di\"\u003e\u003comgdi:waypoint x=\"714\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"714\" y=\"118\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"620\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"615\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"647\" y=\"514\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"616\" y=\"118\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"616\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1723228563372,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144",
      "description": {
        "content": "Write the Sumo Logic signal JSON to an incident note in SOAR.",
        "format": "text"
      },
      "display_name": "Sumo Logic: Write Signal JSON to Note",
      "export_key": "sumo_logic_write_signal_json_to_note",
      "field_type_handle": "playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144",
      "fields_type": {
        "actions": [],
        "display_name": "Sumo Logic: Write Signal JSON to Note",
        "export_key": "playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144",
        "uuid": "607c6c85-3845-4965-99b2-bdea8ddf7a91"
      },
      "has_logical_errors": false,
      "id": 18,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1724264215727,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1723228563484,
          "description": "Format results from get insight by id to pass to JSON conversion script.",
          "enabled": false,
          "export_key": "Sumo Logic: Write Insight Results to Note",
          "id": 29,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1723229011517,
          "name": "Sumo Logic: Write Insight Results to Note",
          "object_type": "sumo_logic_insight_signals_dt",
          "playbook_handle": "sumo_logic_write_signal_json_to_note",
          "programmatic_name": "sumo_logic_write_signal_json_to_note_sumo_logic_write_insight_results_to_note",
          "script_text": "results = playbook.functions.results.get_insight_by_id_results\ninputs = results.get(\"inputs\", None)\ninsight_id = inputs.get(\"sumo_logic_insight_id\", None)\n  \nheader = u\"\u003cb\u003eSumno Logic: Get Insight by ID:\u003c/b\u003e {0}\".format(insight_id)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "9fa56f18-0876-4b93-86ea-2dd88a030c3d"
        },
        {
          "actions": [],
          "created_date": 1723228969045,
          "description": "Prepare to write signal results to a note using the Convert JSON to Rich Text Script ",
          "enabled": false,
          "export_key": "Sumo Logic: Write Signal Results to a note",
          "id": 30,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1724264193004,
          "name": "Sumo Logic: Write Signal Results to a note",
          "object_type": "sumo_logic_insight_signals_dt",
          "playbook_handle": "sumo_logic_write_signal_json_to_note",
          "programmatic_name": "sumo_logic_write_signal_json_to_note_sumo_logic_write_signal_results_to_a_note",
          "script_text": "results = playbook.functions.results.get_signal_by_id_results\ninputs = results.get(\"inputs\", None)\nsignal_id = inputs.get(\"sumo_logic_signal_id\", None)\n  \nheader = u\"\u003cb\u003eSumo Logic: Get Signal by ID:\u003c/b\u003e {0}\".format(signal_id)\n\njson_note = {\n              \"version\": \"1.3\",\n              \"header\": header, \n              \"json\": results.content,\n              \"sort\": False\n            }\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, json_note)",
          "tags": [],
          "uuid": "7f5f5a5f-0d31-4a58-b25f-b114bc8b54ce"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "sumo_logic_write_signal_json_to_note",
      "object_type": "sumo_logic_insight_signals_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_6fdd5ccd-cd7b-4030-bf6a-de526b5c1144",
        "id": 20,
        "name": "playbook_6fdd5ccd_cd7b_4030_bf6a_de526b5c1144",
        "type": "playbook",
        "uuid": "3f5f58f0-9b41-45fd-b94e-c3e619c04412"
      },
      "tags": [],
      "type": "default",
      "uuid": "6fdd5ccd-cd7b-4030-bf6a-de526b5c1144",
      "version": 15
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [
    {
      "actions": [],
      "created_date": 1721231485266,
      "description": "This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note. A workflow property is used to share the json to convert and identify parameters used on how to perform the conversion.\nTypically, a function will create workflow property and this script will run after that function to perform the conversion.\n\nFeatures:\n\n* Display the hierarchical nature of json, presenting the json keys (sorted if specified) as bold labels\n* Provide links to found URLs\n* Create either an incident note or add results to an incident (custom) rich text field.",
      "enabled": false,
      "export_key": "Convert JSON to rich text v1.3",
      "id": 3,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1721231485266,
      "name": "Convert JSON to rich text v1.3",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "convert_json_to_rich_text_13",
      "script_text": "# (c) Copyright IBM Corp. 2010, 2023. All Rights Reserved.\nVERSION = 1.3\n\"\"\"\n  This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note.\n  A workflow property is used to define the json to convert and identify parameters used on how to perform the conversion.\n  Typically, a function will create workflow property and this script will run after that function to perform the conversion.\n  Features:\n    * Display the hierarchical nature of json, presenting the json keys as bold labels\n    * Provide links to found URLs\n    * Create either an incident note or add results to an incident (custom) rich text field.\n  \n  In order to use this script, define a workflow property called: convert_json_to_rich_text, to define the json and parameters to use for the conversion.\n  Workflow properties can be added using a command similar to this:\n  workflow.addProperty(\u0027convert_json_to_rich_text\u0027, {\n    \"version\": 1.3,\n    \"header\": \"Artifact scan results for: {}\".format(artifact.value),\n    \"padding\": 10,\n    \"separator\": u\"\u003cbr /\u003e\",\n    \"sort\": True,\n    \"json\": results.content,\n    \"json_omit_list\": [\"omit\"],\n    \"incident_field\": None\n  })\n  \n  Format of workflow.property.convert_json_to_rich_text:\n  { \n    \"version\": 1.3, [this is for future compatibility]\n    \"header\": str, [header line to add to converted json produced or None. Ex: Results from scanning artifact: xxx. The header may contain rich text tags]\n    \"padding\": 10, [padding for nested json elements, or defaults to 10]\n    \"separator\": u\"\u003cbr /\u003e\"|list such as [\u0027\u003cspan\u003e\u0027,\u0027\u003c/span\u003e\u0027], [html separator between json keys and lists or defaults to html break: \u0027\u003cbr /\u003e\u0027. \n                                                If a list, then the data is brackets by the pair specified]\n    \"sort\": True|False, [sort the json keys at each level when displayed]\n    \"json\": json, [required json to convert]\n    \"json_omit_list\": [list of json keys to exclude or None]\n    \"incident_field\": \"\u003cincident_field\u003e\" [indicates a builtin rich text incident field, such as \u0027description\u0027 \n                                          or a custom rich text field in the format: \u0027properties.\u003cfield\u003e\u0027. default: create an incident note]\n  }\n\n  For playbooks, use playbook.addProperty() with the same format as workflow.addProperty()\n\n  Playbooks can also use playbook.functions.results.convert_json_to_rich_text using the standard function output which contains the \u0027content\u0027 json element.\n  When using playbook.functions.results.convert_json_to_rich_text with standard function results, all the defaults for padding, separator, etc. are used.\n\"\"\"\n\nimport re\n\n# needed for python 3\ntry:\n    unicode(\"abc\") # fails in py3\n    py2 = True\nexcept:\n    unicode = str\n    py2 = False\n\n\nrc = re.compile(r\u0027http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.\u0026+#\\?]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+\u0027)\n\nclass ConvertJson:\n    \"\"\"Class to hold the conversion parameters and perform the conversion\"\"\"\n\n    def __init__(self, omit_keys=[], padding=10, separator=u\"\u003cbr /\u003e\", sort_keys=False):\n        self.omit_keys = omit_keys\n        self.padding = padding\n        self.separator = separator\n        self.sort_keys = sort_keys\n\n\n    def format_link(self, item):\n        \"\"\"[summary]\n          Find embedded urls (http(s)) and add html anchor tags to display as links\n          Args:\n              item ([string])\n\n          Returns:\n              [str]: None|original text if no links|text with html links\n        \"\"\"\n        formatted_item = item\n        if py2:\n            num_type = bool(item and isinstance(item, (int, long, bool, float)))\n        else:\n            num_type = bool(item and isinstance(item, (int, bool, float)))\n\n        if item and not num_type:\n            list = rc.findall(item)\n            if list:\n                for link in list:\n                    formatted_item = formatted_item.replace(link, u\"\u003ca target=\u0027blank\u0027 href=\u0027{0}\u0027\u003e{0}\u003c/a\u003e\".format(link))\n\n        return formatted_item\n\n    def expand_list(self, list_value, is_list=False):\n        \"\"\"[summary]\n          convert items to html, adding indents to nested dictionaries.\n          Args:\n              list_value ([dict|list]): json element\n\n          Returns:\n              [str]: html converted code\n        \"\"\"\n        if not isinstance(list_value, list):\n            return self.format_link(list_value)\n        elif not list_value:\n            return u\"None\u003cbr\u003e\"\n\n        try:\n            items_list = []  # this will ensure list starts on second line of key label\n            for item in list_value:\n                if isinstance(item, dict):\n                    result = self.convert_json_to_rich_text(item)\n                    if is_list:\n                        items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(result))\n                    else:\n                        items_list.append(result)\n                elif isinstance(item, list):\n                    items_list.append(self.expand_list(item, is_list=True))\n                elif is_list:\n                    items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(self.format_link(unicode(item))))\n                else:\n                    items_list.append(self.format_link(unicode(item)))\n\n            expand_list_result = self.add_separator(self.separator if not is_list else u\"\",\n                                                    items_list,\n                                                    is_list=is_list)\n\n            if is_list:\n                return u\"\u003cul\u003e{}\u003c/ul\u003e\".format(expand_list_result)\n            else:\n                return u\"\u003cdiv style=\u0027padding:5px\u0027\u003e{}\u003c/div\u003e\".format(expand_list_result)\n        except Exception as err:\n            return str(err)\n\n    def convert_json_to_rich_text(self, sub_dict):\n        \"\"\"[summary]\n          Walk dictionary tree and convert to html for better display\n          Args:\n              sub_dict ([type]): [description]\n\n          Returns:\n              [type]: [description]\n        \"\"\"\n        notes = []\n        if sub_dict and isinstance(sub_dict, (list, dict)):\n            if isinstance(sub_dict, list):\n                expanded_list = self.expand_list(sub_dict, is_list=True)\n                notes.append(self.add_separator(self.separator, expanded_list))\n            else:\n                keys = sorted (sub_dict.keys()) if self.sort_keys else sub_dict.keys()\n\n                for key in keys:\n                    if key not in self.omit_keys:\n                        value = sub_dict[key]\n                        is_list = isinstance(value, list)\n                        item_list = [u\"\u003cstrong\u003e{0}\u003c/strong\u003e: \".format(key)]\n                        if isinstance(value, dict):\n                            convert_result = self.convert_json_to_rich_text(value)\n                            if convert_result:\n                                item_list.append(u\"\u003cdiv style=\u0027padding:{}px\u0027\u003e{}\u003c/div\u003e\".format(self.padding, convert_result))\n                            else:\n                                item_list.append(u\"None\u003cbr\u003e\")\n                        else:\n                            item_list.append(self.expand_list(value, is_list=is_list))\n\n                        notes.append(self.add_separator(self.separator, u\"\".join(make_unicode(v) for v in item_list), is_list=is_list))\n\n        result_notes = u\"\".join(notes)\n        if isinstance(self.separator, list):\n            return result_notes\n        else:\n            return result_notes.replace(\n                u\"\u003c/div\u003e{0}\".format(self.separator), u\"\u003c/div\u003e\").replace(\n                u\"{0}\u003c/div\u003e\".format(self.separator), u\"\u003c/div\u003e\"\n            )  # tighten up result\n\n    def add_separator(self, separator, items, is_list=False):\n        \"\"\"\n        apply the separator to the data\n        :param separator: None, str or list such as [\u0027\u003cspan\u003e\u0027, \u0027\u003c/span\u003e\u0027]\n        :param items: str or list to add separator\n        :return: text with separator applied\n        \"\"\"\n        _items = items\n\n        if not _items:\n            return \"\u003cbr\u003e\"\n\n        if not isinstance(_items, list):\n            _items = [_items]\n\n        if isinstance(separator, list):\n            return u\"\".join([u\"{}{}{}\".format(separator[0], item, separator[1]) for item in _items])\n\n        return u\"{}{}\".format(separator.join(_items), separator if not is_list else u\"\")\n\ndef make_unicode(value):\n    if value is None:\n        return \u0027None\u0027\n\n    return unicode(value)\n\ndef get_results(property_name):\n    if playbook and playbook.functions.results[property_name] is not None:\n        return playbook.functions.results[property_name]\n    elif playbook and playbook.properties[property_name] is not None:\n        return playbook.properties[property_name]\n    elif workflow and workflow.properties[property_name] is not None:\n        return workflow.properties[property_name]\n\n    return None\n\ndef get_properties(property_name):\n    \"\"\"\n    Logic to collect the json and parameters from a workflow property.\n    Args:\n      property_name: workflow property to reference\n    Returns:\n      padding, separator, header, json_omit_list, incident_field, json, sort_keys\n    \"\"\"\n    result_properties = get_results(property_name)\n    if not result_properties:\n        helper.fail(\"Playbook/workflow property not found: {}\".format(property_name))\n\n    padding = int(result_properties.get(\"padding\", 10))\n    separator = result_properties.get(\"separator\", u\"\u003cbr /\u003e\")\n    if isinstance(separator, list) and len(separator) != 2:\n        helper.fail(\"list of separators should be specified as a pair such as [\u0027\u003cdiv\u003e\u0027, \u0027\u003c/div\u003e\u0027]: {}\".format(separator))\n\n    header = result_properties.get(\"header\")\n    sort_keys = bool(result_properties.get(\"sort\", False))\n    json_omit_list = result_properties.get(\"json_omit_list\")\n    if not json_omit_list:\n        json_omit_list = []\n    incident_field = result_properties.get(\"incident_field\")\n    \n    # workflow formatted content is \u0027json\u0027. Standard functions is \u0027content\u0027\n    json = result_properties.get(\"json\") if result_properties.get(\"json\") else result_properties.get(\"content\")\n    json_err = None\n    # is there an issue we need handle now?\n    if not json and \\\n        result_properties.get(\"success\") == False and result_properties.get(\"reason\"):\n        json_err = result_properties.get(\"reason\")\n    \n    return padding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys\n\n\n## S T A R T\npadding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys = get_properties(\u0027convert_json_to_rich_text\u0027)\nif json_err:\n    result = \"Result error: {}\".format(json_err)\nelse:\n    if header:\n        if isinstance(separator, list):\n            hdr = u\"{0}{1}{2}\".format(separator[0], header, separator[1])\n        else:\n            hdr = u\"{0}{1}\".format(header, separator)\n    else:\n        hdr = u\"\"\n\n    convert = ConvertJson(omit_keys=json_omit_list, padding=padding, separator=separator, sort_keys=sort_keys)\n    converted_json = convert.convert_json_to_rich_text(json)\n    result = u\"{}{}\".format(hdr, converted_json if converted_json else \"\\nNone\")\n\nrich_text_note = helper.createRichText(result)\nif incident_field:\n    incident[incident_field] = rich_text_note\nelse:\n    incident.addNote(rich_text_note)\n",
      "tags": [],
      "uuid": "64d3e6da-8b56-4d19-9ce8-a75586f71dad"
    },
    {
      "actions": [],
      "created_date": 1723035570749,
      "description": "Create artifacts in SOAR from the Sumo Logic Get Insight by ID function and write the results to a note.",
      "enabled": false,
      "export_key": "Sumo Logic: Add Artifacts from Insight",
      "id": 25,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1724252767954,
      "name": "Sumo Logic: Add Artifacts from Insight",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "sumo_logic_update_case_on_creation_sumo_logic_add_artifacts_from_insight",
      "script_text": "ARTIFACT_TYPE_MAPPING = {\n  \"_ip\": \"IP Address\",\n  \"_hostname\": \"DNS Name\",\n  \"_file\": \"File Path\",\n  \"_mac\": \"MAC Address\",\n  \"_process\": \"Process Name\",\n  \"_username\": \"User Account\",\n  \"_useragent\": \"User Agent\",\n  \"_url\": \"URL\"\n}\n\nresults = playbook.functions.results.get_insight_by_id_results\n\nnote_text = \"\u003cb\u003eSumo Logic: Add Artifacts from Insight:\u003c/b\u003e\"\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n      data = content.get(\"data\", None)\n      if data:\n          involved_entities = data.get(\"involvedEntities\", [])\n          artifact_count = 0\n          for entity in involved_entities:\n              entity_type = ARTIFACT_TYPE_MAPPING.get(entity.get(\"entityType\"), None)\n              entity_value = entity.get(\"value\", None)\n              if entity_type and entity_value:\n                  incident.addArtifact(entity_type, entity_value, f\"Artifact created from Sumo Logic insight {incident.properties.sumo_logic_insight_readable_id}\")\n                  artifact_count += 1\n              else:\n                  note_text = f\"{note_text}\u003cbr\u003eUnable to create artifact from entity: {entity}\"\n          note_text = f\"{note_text}\u003cbr\u003e{artifact_count} artifact(s) created.\"\n      else:\n          note_text = f\"{note_text}\u003cbr\u003eno data found in insight results.\"\n  else:\n      note_text = f\"{note_text}\u003cbr\u003eno content found in insight results.\"\nelse:\n    note_text = f\"{note_text}\u003cbr\u003eresults found in insight results.\"\n\nincident.addNote(note_text)",
      "tags": [],
      "uuid": "3b750611-5d9e-4fdb-9b29-15182b459e59"
    },
    {
      "actions": [],
      "created_date": 1723225556761,
      "description": "Populate the Signals data table with results from get insight function.",
      "enabled": false,
      "export_key": "Sumo Logic: Populate Signals Data Table",
      "id": 28,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1723232026517,
      "name": "Sumo Logic: Populate Signals Data Table",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "sumo_logic_update_case_sumo_logic_populate_signals_data_table",
      "script_text": "results = playbook.functions.results.get_insight_by_id_results\nnote_text = f\"\u003cb\u003eSumo Logic: Populate Signals Data Table:\u003c/b\u003e\"\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n      data = content.get(\"data\", None)\n      if data:\n          signals = data.get(\"signals\", [])\n          for signal in signals:\n              signal_row = incident.addRow(\"sumo_logic_insight_signals_dt\")\n              signal_row.sumo_logic_signal_timestamp   = signal.get(\"timestamp\", None)\n              signal_row.sumo_logic_signal_id          = signal.get(\"id\", None)\n              signal_row.sumo_logic_signal_name        = signal.get(\"name\", None)\n              signal_row.sumo_logic_signal_stage       = signal.get(\"stage\", None)\n              signal_row.sumo_logic_signal_description = signal.get(\"description\", None)\n              signal_row.sumo_logic_signal_rule_id     = signal.get(\"ruleId\", None)\n              signal_row.sumo_logic_signal_severity = str(signal.get(\"severity\")) if signal.get(\"severity\", None) else None\n          num_signals = len(signals)\n          note_text = f\"{note_text} {num_signals} signal(s) written to Signals data table.\"\n      else:\n          note_text = f\"{note_text} Failed - no data found.\"\n  else:\n      note_text = f\"{note_text} Failed - no data content found.\"\nelse:\n    reason = results.get(\"reason\", \"No reason\")\n    note_text = f\"{note_text} Failed - {reason}\"\nincident.addNote(note_text)",
      "tags": [],
      "uuid": "83614eef-bda9-4afe-a160-7e6228d94e33"
    }
  ],
  "server_version": {
    "build_number": 9340,
    "f": 0,
    "m": 0,
    "major": 0,
    "minor": 0,
    "r": 0,
    "v": 51,
    "version": "51.0.0.0.9340"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "Signals",
      "export_key": "sumo_logic_insight_signals_dt",
      "fields": {
        "sumo_logic_signal_description": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_description",
          "hide_notification": false,
          "id": 455,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_description",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Description",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "d44b5e4d-8994-40ba-8543-acae51eef2d4",
          "values": [],
          "width": 88
        },
        "sumo_logic_signal_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_id",
          "hide_notification": false,
          "id": 450,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_id",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Signal ID",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "6f3d91a3-db2d-4faa-b0c0-a2177be01810",
          "values": [],
          "width": 110
        },
        "sumo_logic_signal_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_name",
          "hide_notification": false,
          "id": 451,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_name",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Name",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "a40a2493-2445-492b-ae6a-076e3b5ede41",
          "values": [],
          "width": 110
        },
        "sumo_logic_signal_rule_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_rule_id",
          "hide_notification": false,
          "id": 459,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_rule_id",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Rule ID",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "41621172-8737-445f-909d-b33eae515ae3",
          "values": [],
          "width": 57
        },
        "sumo_logic_signal_severity": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_severity",
          "hide_notification": false,
          "id": 452,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_severity",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Severity",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "bff37fac-01c0-418d-88c6-a42e2e5a495e",
          "values": [],
          "width": 110
        },
        "sumo_logic_signal_stage": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_stage",
          "hide_notification": false,
          "id": 453,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_stage",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Stage",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "92fd01d4-2498-4e47-81b1-8986fd7618df",
          "values": [],
          "width": 110
        },
        "sumo_logic_signal_timestamp": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sumo_logic_insight_signals_dt/sumo_logic_signal_timestamp",
          "hide_notification": false,
          "id": 456,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sumo_logic_signal_timestamp",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Timestamp",
          "tooltip": "",
          "type_id": 1019,
          "uuid": "7d3358e3-dcdf-411b-ac88-d082a13fcb02",
          "values": [],
          "width": 99
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "sumo_logic_insight_signals_dt",
      "uuid": "6b2b9bff-a2fb-421c-8c44-75c7074a343c"
    }
  ],
  "workflows": [],
  "workspaces": []
}
