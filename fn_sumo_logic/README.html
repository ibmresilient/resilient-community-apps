<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="Task Utilities" href="../fn_task_utils/README.html" /><link rel="prev" title="Splunk" href="../fn_splunk_integration/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Sumo Logic Cloud SIEM - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">Remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmware_cbc/README.html">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_algosec/README.html">AlgoSec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">Anomali Staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_low_code/README.html">SOAR Low Code App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Networks Panorama Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">Phish Tank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Sumo Logic Cloud SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html">watsonx.ai for SOAR Analysts<!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <!--
  This README.md is generated by running:
  "resilient-sdk docgen -p fn_sumo_logic"

  This file was generated with resilient-sdk v51.0.2.2.1096

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  All fields followed by "::CHANGE_ME::"" should be manually edited

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)

  NOTE: If your app is available in the container-format only, there is no need to mention the integration server in this readme.
-->
<section id="sumo-logic-cloud-siem">
<h1>Sumo Logic Cloud SIEM<a class="headerlink" href="#sumo-logic-cloud-siem" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#sumo-logic-cloud-siem"><span class="xref myst">Sumo Logic Cloud SIEM</span></a></p>
<ul>
<li><p><a class="reference internal" href="#table-of-contents"><span class="xref myst">Table of Contents</span></a></p></li>
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
<li><p><a class="reference internal" href="#sumo-logic-development-version"><span class="xref myst">Sumo Logic Development Version</span></a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisites"><span class="xref myst">Prerequisites</span></a></p></li>
<li><p><a class="reference internal" href="#configuration"><span class="xref myst">Configuration</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#generate-an-access-key-and-secret-in-sumo-log-analytics-platform"><span class="xref myst">Generate an Access Key and Secret in Sumo Log Analytics Platform</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#"><code class="xref myst docutils literal notranslate"></code></a></p></li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a></p></li>
<li><p><a class="reference internal" href="#insights-filtering"><span class="xref myst">Insights Filtering</span></a></p>
<ul>
<li><p><a class="reference internal" href="#polling-filter-examples"><span class="xref myst">Polling Filter Examples</span></a></p></li>
<li><p><a class="reference internal" href="#poller-templates-for-soar-cases"><span class="xref myst">Poller Templates for SOAR Cases</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---sumo-logic-add-comment-to-insight"><span class="xref myst">Function - Sumo Logic: Add Comment to Insight</span></a></p></li>
<li><p><a class="reference internal" href="#function---sumo-logic-add-tag-to-insight"><span class="xref myst">Function - Sumo Logic: Add Tag to Insight</span></a></p></li>
<li><p><a class="reference internal" href="#function---sumo-logic-get-entity"><span class="xref myst">Function - Sumo Logic: Get Entity</span></a></p></li>
<li><p><a class="reference internal" href="#function---sumo-logic-get-insight-by-id"><span class="xref myst">Function - Sumo Logic: Get Insight By ID</span></a></p></li>
<li><p><a class="reference internal" href="#function---sumo-logic-get-insights-comments"><span class="xref myst">Function - Sumo Logic: Get Insights Comments</span></a></p></li>
<li><p><a class="reference internal" href="#function---sumo-logic-get-signal-by-id"><span class="xref myst">Function - Sumo Logic: Get Signal by ID</span></a></p></li>
<li><p><a class="reference internal" href="#function---sumo-logic-update-insight-status"><span class="xref myst">Function - Sumo Logic: Update Insight Status</span></a></p></li>
<li><p><a class="reference internal" href="#script---convert-json-to-rich-text-v13"><span class="xref myst">Script - Convert JSON to rich text v1.3</span></a></p></li>
<li><p><a class="reference internal" href="#script---sumo-logic-add-artifacts-from-insight"><span class="xref myst">Script - Sumo Logic: Add Artifacts from Insight</span></a></p></li>
<li><p><a class="reference internal" href="#script---sumo-logic-populate-signals-data-table"><span class="xref myst">Script - Sumo Logic: Populate Signals Data Table</span></a></p></li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---signals"><span class="xref myst">Data Table - Signals</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p>
<ul>
<li><p><a class="reference internal" href="#for-support"><span class="xref myst">For Support</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<!--
  Specify all changes in this release. Do not remove the release
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0.0</p></td>
<td><p>08/2024</p></td>
<td><p>Initial Release</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<!--
  Provide a high-level description of the function itself and its remote software or application.
  The text below is parsed from the "description" and "long_description" attributes in the setup.py file
-->
<p><strong>IBM SOAR app - bidirectional synchronization and functions for Sumo Logic</strong></p>
<p><img alt="screenshot: main" src="../_images/main68.png" /></p>
<p>Bi-directional App for Sumo Logic Cloud SIEM. Query Sumo Logic for insights based on user-defined query parameters and create and update cases in SOAR.<br></p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<!--
  List the Key Features of the Integration
-->
<ul class="simple">
<li><p>Poll Sumo Logic insights and create and update the corresponding cases in SOAR</p></li>
<li><p>Allow user to specify insight polling filters to limit insights escalated to SOAR</p></li>
<li><p>Create artifacts in SOAR case from Sumo Logic entities</p></li>
<li><p>Create hits on SOAR artifacts based on the corresponding entity’s Signal Severity Total in Sumo Logic via automatic or manual playbooks</p></li>
<li><p>Synchronize comments and notes between Sumo Logic insight and corresponding SOAR case</p></li>
<li><p>View insight signal details in the Signals data table</p></li>
<li><p>Write the insight, signal and entity full JSON data from Sumo Logic to a note in SOAR</p></li>
<li><p>Post tags to an insight from SOAR</p></li>
<li><p>Sumo Logic custom incident tab that contains insight custom fields, a link back to the insight in Sumo Logic and the Signals data table</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<!--
  List any Requirements
-->
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (also known as App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0.0</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0.0</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient-circuits&gt;=51.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Incidents</p></td>
<td><p>Read, Create</p></td>
</tr>
<tr class="row-odd"><td><p>Edit Incidents</p></td>
<td><p>Fields, Status</p></td>
</tr>
<tr class="row-even"><td><p>Layouts</p></td>
<td><p>Read, Edit</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= <code class="docutils literal notranslate"><span class="pre">1.10</span></code>.</p></li>
<li><p>Cloud Pak is configured with an Edge Gateway.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.9, 3.11, and 3.12 are officially supported. When deployed as an app, the app runs on Python 3.11.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>resilient-circuits&gt;=51.0.0</p></li>
</ul>
</section>
<section id="sumo-logic-development-version">
<h3>Sumo Logic Development Version<a class="headerlink" href="#sumo-logic-development-version" title="Link to this heading">¶</a></h3>
<p>This app has been implemented using:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Product Name</p></th>
<th class="head"><p>Product Version</p></th>
<th class="head"><p>API URL</p></th>
<th class="head"><p>API Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sumo Logic Cloud SIEM</p></td>
<td><p>N/A</p></td>
<td><p>https://api.sumologic.com/api</p></td>
<td><p>v1</p></td>
</tr>
</tbody>
</table>
</div>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h4>
<!--
List any prerequisites that are needed to use with this endpoint solution. Remove any section that is unnecessary.
-->
<ul class="simple">
<li><p>A Sumo Logic Log Analytics Platform user account in which Cloud SIEM Enterprise is enabled.</p></li>
</ul>
</section>
<section id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h4>
<!--
List any steps that are needed to configure the endpoint to use this app.
-->
</section>
</section>
<section id="generate-an-access-key-and-secret-in-sumo-log-analytics-platform">
<h3>Generate an Access Key and Secret in Sumo Log Analytics Platform<a class="headerlink" href="#generate-an-access-key-and-secret-in-sumo-log-analytics-platform" title="Link to this heading">¶</a></h3>
<p>In the lower left corner of the Sumo Logic panel in the User Account Preferences menu item, Click on the <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">Add</span> <span class="pre">Access</span> <span class="pre">Key</span></code> blue button:</p>
<p><img alt="screenshot: fn-sumo-logic-access-id-key" src="../_images/fn-sumo-logic-access-id-key.png" /></p>
<p>In the <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">an</span> <span class="pre">Access</span> <span class="pre">Key</span></code> dialog, enter an <code class="docutils literal notranslate"><span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">Name</span></code> and Click the blue <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">Key</span></code> button.</p>
<p><img alt="screenshot: fn-sumo-logic-create-access-key" src="../_images/fn-sumo-logic-create-access-key.png" /></p>
<p>Copy the Access ID and Access Key for use in the app.config file.</p>
</section>
</section>
<section id="id1">
<h2><img alt="screenshot: fn-sumo-logic-access-id-key-dialog" src="../_images/fn-sumo-logic-access-id-key-dialog.png" /><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>access_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xxx</span></code></p></td>
<td><p><em>Sumo Logic Access ID.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>access_key</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xxx</span></code></p></td>
<td><p><em>Sumo Logic Access Key.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>api_endpoint_url</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://api.sumologic.com/api</span></code></p></td>
<td><p><em>Sumo Logic REST API endpoint URL. See Sumo Logic documentation to determine URL for your region: https://help.sumologic.com/docs/api/getting-started/#which-endpoint-should-i-should-use .</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>console_url</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://service.sumologic.com</span></code></p></td>
<td><p><em>Sumo Logic console URL - used to create links back to Sumo Logic Insight.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_interval</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">600</span></code></p></td>
<td><p><em>Poller interval time in seconds. Value of zero turns poller off.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_lookback</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">20160</span></code></p></td>
<td><p><em>Number of minutes to lookback for queries the first time the poller runs.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_add_case_url_comment_in_sumo_logic</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><em>Boolean flag indicating whether or not to add a comment in the Sumo Logic Insight that contains the URL link back to corresponding SOAR case.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_filters</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">status:in(&quot;inprogress&quot;,&quot;new&quot;,&quot;closed&quot;)</span> <span class="pre">confidence:&gt;=.70</span> <span class="pre">severity:&gt;=&quot;MEDIUM&quot;</span></code></p></td>
<td><p><em>Polling filters to limit escalated insights - Sumo Logic DSL query statement - each query parameter separated by a space.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>soar_create_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/var/rescircuits/create_case.jinja</span></code></p></td>
<td><p><em>Path to override template for automatic case creation. See <a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a>.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>soar_update_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/var/rescircuits/update_case.jinja</span></code></p></td>
<td><p><em>Path to override template for automatic case updating. See <a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a>.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>soar_close_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/var/rescircuits/close_case.jinja</span></code></p></td>
<td><p><em>Path to override template for automatic case closing. See <a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a>.</em></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="poller-considerations">
<h3>Poller Considerations<a class="headerlink" href="#poller-considerations" title="Link to this heading">¶</a></h3>
<p>When the poller is enabled, cases are automatically escalated from this app. Any updates are checked at the cadence defined by the value set for <code class="docutils literal notranslate"><span class="pre">polling_interval</span></code>. It is possible, however, to escalate cases from other sources.
In this scenario, the poller would be disabled by setting <code class="docutils literal notranslate"><span class="pre">polling_interval=0</span></code> and a separate source might capture a case from the endpoint and in turn create a case in SOAR. This app can still be useful for enrichment of that
newly created case even though it was not directly escalated from this app. As long as the reference ID (i.e. alert ID, event ID, etc…) for each case is preserved, all remaining details will synchronize to the SOAR case through this app automatically.</p>
<p>Sumo Logic REST API does not allow querying insights based on insight field <code class="docutils literal notranslate"><span class="pre">lastUpdated</span></code> timestamp. In order to implement bidirectional synchronization between Sumo Logic insights and SOAR cases, all Sumo Logic insights that have cases in SOAR are fetched and each case is updated on each polling interval.  Take this overhead into consideration when determining the <code class="docutils literal notranslate"><span class="pre">polling_interval</span></code>, especially if you have a large number of Sumo Logic cases in SOAR.</p>
</section>
<section id="insights-filtering">
<h3>Insights Filtering<a class="headerlink" href="#insights-filtering" title="Link to this heading">¶</a></h3>
<p>To limit the number of insights escalated to SOAR, consider using the optional <code class="docutils literal notranslate"><span class="pre">polling_filters</span></code> parameter in the app configuration file. The query string format is documented in Sumo Logic at: https://api.sumologic.com/docs/sec/#operation/GetInsights and below:</p>
<p>The search query string uses sumo logic custom DSL that is used to filter the results.</p>
<p>Each filter is in the format <code class="docutils literal notranslate"><span class="pre">field:operator:value</span></code>. Multiple filters are separated by a space.</p>
<p>Operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exampleField:&quot;bar&quot;</span></code>: The value of the field is equal to “bar”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exampleField:in(&quot;bar&quot;,</span> <span class="pre">&quot;baz&quot;,</span> <span class="pre">&quot;qux&quot;)</span></code>: The value of the field is equal to either “bar”, “baz”, or “qux”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exampleTextField:contains(&quot;foo</span> <span class="pre">bar&quot;)</span></code>: The value of the field contains the phrase “foo bar”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exampleNumField:&gt;5</span></code>: The value of the field is greater than 5. There are similar <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, and <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> operators.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exampleNumField:5..10</span></code>: The value of the field is between 5 and 10 (inclusive).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exampleDateField:&gt;2019-02-01T05:00:00+00:00</span></code>: The value of the date field is after 5 a.m. UTC time on February 2, 2019.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exampleDateField:2019-02-01T05:00:00+00:00..2019-02-01T08:00:00+00:00</span></code>: The value of the date field is between 5 a.m. and 8 a.m. UTC time on February 2, 2019.</p></li>
</ul>
<p>Fields:</p>
<ul class="simple">
<li><p>readableId</p></li>
<li><p>status</p></li>
<li><p>statusId</p></li>
<li><p>name</p></li>
<li><p>insightId</p></li>
<li><p>serialId</p></li>
<li><p>description</p></li>
<li><p>created</p></li>
<li><p>timestamp</p></li>
<li><p>closed</p></li>
<li><p>assignee</p></li>
<li><p>entity.id</p></li>
<li><p>entity.ip</p></li>
<li><p>entity.hostname</p></li>
<li><p>entity.username</p></li>
<li><p>entity.sensorZone</p></li>
<li><p>entity.type</p></li>
<li><p>entity.value</p></li>
<li><p>involvedEntities.id</p></li>
<li><p>involvedEntities.type,</p></li>
<li><p>involvedEntities.value</p></li>
<li><p>enrichment</p></li>
<li><p>sensorZone</p></li>
<li><p>tag</p></li>
<li><p>severity</p></li>
<li><p>resolution</p></li>
<li><p>subResolution</p></li>
<li><p>ruleId</p></li>
<li><p>records</p></li>
<li><p>confidence</p></li>
</ul>
<p>NOTE: The poller uses the <code class="docutils literal notranslate"><span class="pre">created</span></code> field to escalate new insights to SOAR, so this insight field should not be used to filter insights.</p>
<section id="polling-filter-examples">
<h4>Polling Filter Examples<a class="headerlink" href="#polling-filter-examples" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">polling_filters</span> <span class="o">=</span> <span class="n">status</span><span class="p">:</span><span class="ow">in</span><span class="p">(</span><span class="s2">&quot;inprogress&quot;</span><span class="p">,</span><span class="s2">&quot;new&quot;</span><span class="p">,</span><span class="s2">&quot;closed&quot;</span><span class="p">)</span> <span class="n">confidence</span><span class="p">:</span><span class="o">&gt;=</span><span class="mf">.85</span> <span class="n">severity</span><span class="p">:</span><span class="o">&gt;=</span><span class="s2">&quot;HIGH&quot;</span>
</pre></div>
</div>
<p>In this example, the query will return all insights with a status of either “inprogress”, “new”, and “closed” AND a confidence greater than or equal to .85 AND a severity greater than or equal to “HIGH” (which includes values “HIGH” or “CRITICAL”).</p>
</section>
<section id="poller-templates-for-soar-cases">
<h4>Poller Templates for SOAR Cases<a class="headerlink" href="#poller-templates-for-soar-cases" title="Link to this heading">¶</a></h4>
<p>It may be necessary to modify the templates used to create, update, or close SOAR cases based on your required custom fields in SOAR.</p>
<p>This is especially relevant if you have required custom <em>close</em> fields that need to be filled when closing a case in SOAR. If that is the case, be sure to implement a custom <code class="docutils literal notranslate"><span class="pre">close_case_template</span></code> and reference those required close fields in the template.</p>
<p>When overriding the template in App Host, specify the file path for each file as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<p>Below are the default templates used which can be copied, modified, and used with app_config’s
<code class="docutils literal notranslate"><span class="pre">soar_create_case_template</span></code>, <code class="docutils literal notranslate"><span class="pre">soar_update_case_template</span></code>, and <code class="docutils literal notranslate"><span class="pre">soar_close_case_template</span></code> settings to override the default templates.</p>
<details><summary>soar_create_case.jinja</summary>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">{</span>
<span class="x">  </span><span class="c">{# JINJA template for creating a new SOAR incident from an endpoint #}</span>
<span class="x">  </span><span class="c">{# See https://ibmresilient.github.io/resilient-python-api/pages/resilient-lib/resilient-lib.html#module-resilient_lib.components.templates_common</span>
<span class="c">     for details on available jinja methods. Examples for `soar_substitute` and more are included below.</span>
<span class="c">  #}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">severity_mapping</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{</span>
<span class="s1">    &quot;CRITICAL&quot;: &quot;High&quot;, </span>
<span class="s1">    &quot;HIGH&quot;: &quot;High&quot;, </span>
<span class="s1">    &quot;MEDIUM&quot;: &quot;Medium&quot;, </span>
<span class="s1">    &quot;LOW&quot;: &quot;Low&quot;</span>
<span class="s1">  }&#39;&#39;&#39;</span>
  <span class="cp">%}</span>
<span class="x">  </span><span class="c">{# modify to specify your specific **data** fields #}</span>
<span class="x">  &quot;name&quot;: &quot;Sumo Logic </span><span class="cp">{{</span> <span class="nv">readableId</span> <span class="cp">}}</span><span class="x"> - </span><span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  &quot;description&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">description</span> <span class="o">|</span> <span class="nf">replace</span><span class="o">(</span><span class="s1">&#39;&quot;&#39;</span><span class="o">,</span> <span class="s1">&#39;\\&quot;&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  </span><span class="c">{# start_date cannot be after discovered_date #}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">start_date</span> <span class="o">=</span> <span class="nv">created</span> <span class="k">if</span> <span class="nv">created</span> <span class="o">&lt;=</span> <span class="nv">created</span> <span class="k">else</span> <span class="nv">created</span> <span class="cp">%}</span>
<span class="x">  &quot;discovered_date&quot;: </span><span class="cp">{{</span> <span class="nv">created</span><span class="o">|</span> <span class="nf">soar_datetimeformat</span><span class="o">(</span><span class="nv">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">,</span>
<span class="x">  &quot;start_date&quot;: </span><span class="cp">{{</span> <span class="nv">start_date</span> <span class="o">|</span> <span class="nf">soar_datetimeformat</span><span class="o">(</span><span class="nv">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">,</span>
<span class="x">  </span><span class="c">{# if alert users are different than SOAR users, consider using a mapping table using soar_substitute: #}</span>
<span class="x">  </span><span class="c">{# &quot;owner_id&quot;: &quot;{{ **assignedTo** |soar_substitute(&#39;{&quot;Automation&quot;: &quot;soar_user1@example.com&quot;, &quot;default_user@example.com&quot;: &quot;soar_user2@example.com&quot;, &quot;DEFAULT&quot;: &quot;default_user@example.com&quot; }&#39;) }}&quot;, #}</span>
<span class="x">  &quot;plan_status&quot;: &quot;A&quot;,</span>
<span class="x">  &quot;severity_code&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">severity</span> <span class="o">|</span> <span class="nf">soar_substitute</span><span class="o">(</span><span class="nv">severity_mapping</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  </span><span class="c">{# specify your custom fields for your endpoint solution #}</span>
<span class="x">  &quot;properties&quot;: {</span>
<span class="x">    &quot;sumo_logic_insight_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">id</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">  }</span>
<span class="x">}</span>
</pre></div>
</div>
</details>
<details><summary>soar_update_case.jinja</summary>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">{</span>
<span class="x">  </span><span class="c">{# JINJA template for updating a new SOAR incident from an endpoint #}</span>
<span class="x">  </span><span class="c">{# modify to specify your specific **data** fields #}</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">severity_mapping</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;{</span>
<span class="s1">    &quot;CRITICAL&quot;: &quot;High&quot;, </span>
<span class="s1">    &quot;HIGH&quot;: &quot;High&quot;, </span>
<span class="s1">    &quot;MEDIUM&quot;: &quot;Medium&quot;, </span>
<span class="s1">    &quot;LOW&quot;: &quot;Low&quot;</span>
<span class="s1">  }&#39;&#39;&#39;</span>
  <span class="cp">%}</span>
<span class="x">  &quot;severity_code&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">severity</span> <span class="o">|</span> <span class="nf">soar_substitute</span><span class="o">(</span><span class="nv">severity_mapping</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  </span><span class="c">{# specify your custom fields for your endpoint solution #}</span>
<span class="x">  &quot;properties&quot;: {</span>
<span class="x">    &quot;sumo_logic_insight_global_confidence&quot;: </span><span class="cp">{{</span> <span class="o">(</span><span class="nv">confidence</span><span class="o">*</span><span class="m">100</span><span class="o">)|</span><span class="nf">int</span> <span class="cp">}}</span><span class="x">,</span>
<span class="x">    &quot;sumo_logic_insight_assignee&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">assignee.displayName</span> <span class="cp">}}</span><span class="x"> (</span><span class="cp">{{</span><span class="nv">assignee.username</span><span class="cp">}}</span><span class="x">)&quot;,</span>
<span class="x">    &quot;sumo_logic_insight_status&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">status.displayName</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;sumo_logic_insight_readable_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">readableId</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;sumo_logic_insight_resolution&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">resolution</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;sumo_logic_insight_source&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">source</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;sumo_logic_insight_sub_resolution&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">subResolution</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">    &quot;sumo_logic_insight_link&quot;: &quot;&lt;a target=&#39;_blank&#39; href=&#39;</span><span class="cp">{{</span> <span class="nv">entity_url</span> <span class="cp">}}</span><span class="x">&#39;&gt;Insight&lt;/a&gt;&quot;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">tags</span> <span class="cp">%}</span>
<span class="x">    ,&quot;sumo_logic_insight_tags&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">tags</span> <span class="o">|</span> <span class="nf">join</span><span class="o">(</span><span class="s1">&#39;, &#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="x">  }</span>
<span class="x">}</span>
</pre></div>
</div>
</details>
<details><summary>soar_close_case.jinja</summary>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">{</span>
<span class="x">  </span><span class="c">{# JINJA template for closing a SOAR incident using endpoint data #}</span>
<span class="x">  </span><span class="c">{# modify to specify your specific **data** fields #}</span>
<span class="x">  &quot;plan_status&quot;: &quot;C&quot;,</span>
<span class="x">  &quot;resolution_id&quot;: &quot;</span><span class="cp">{{</span> <span class="nv">resolution</span> <span class="o">|</span> <span class="nf">soar_substitute</span><span class="o">(</span><span class="s1">&#39;{&quot;False Positive&quot;: &quot;Not an Issue&quot;, &quot;Resolved&quot;: &quot;Resolved&quot;, &quot;Duplicate&quot;: &quot;Duplicate&quot;, &quot;No Action&quot;: &quot;Unresolved&quot; }&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;,</span>
<span class="x">  &quot;resolution_summary&quot;: &quot;Closed by Sumo Logic, Insight Status: </span><span class="cp">{{</span> <span class="nv">status.displayName</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">  </span><span class="c">{# add additional fields based on your &#39;on close&#39; field requirements #}</span>
<span class="x">  </span><span class="c">{#</span>
<span class="c">  ,&quot;properties&quot;: {</span>
<span class="c">      &quot;your_custom_field&quot;: &quot;value&quot;</span>
<span class="c">  }</span>
<span class="c">  #}</span>
<span class="x">}</span>
</pre></div>
</div>
</details>
</section>
</section>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-add-comment-to-insight">
<h2>Function - Sumo Logic: Add Comment to Insight<a class="headerlink" href="#function-sumo-logic-add-comment-to-insight" title="Link to this heading">¶</a></h2>
<p>Post a comment to a Sumo Logic insight in Sumo Logic.</p>
<p><img alt="screenshot: fn-sumo-logic-add-comment-to-insight " src="../_images/fn-sumo-logic-add-comment-to-insight.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_comment_text</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;admin@example.com&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Created by IBM SOAR:  Sumo Logic: Get Insight Comments  playbook created 1 notes in SOAR.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-01T20:05:28.833246&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_comment_text&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">b</span><span class="se">\u003e</span><span class="s2">Sumo Logic: Get Insight Comments</span><span class="se">\u003c</span><span class="s2">/b</span><span class="se">\u003e</span><span class="s2"> playbook created 1 notes in SOAR.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_insight_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2a8419c4-b84b-3b6c-8447-af4ccbfba9c6&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">9515</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-01 16:05:30&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_comment_text</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">add_comment_to_insight_results</span>

<span class="c1"># Edit note in SOAR to indicate it was sent to CBC alert</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="c1"># Get the current time</span>
  <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
  <span class="n">note</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&lt;b&gt;Post comment to Sumo Logic insight at </span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;br&gt;</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-add-tag-to-insight">
<h2>Function - Sumo Logic: Add Tag to Insight<a class="headerlink" href="#function-sumo-logic-add-tag-to-insight" title="Link to this heading">¶</a></h2>
<p>Add a tag to a Sumo Logic insight in Sumo Logic.</p>
<p><img alt="screenshot: fn-sumo-logic-add-tag-to-insight " src="../_images/fn-sumo-logic-add-tag-to-insight.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_tag</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;assignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;closed&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;closedBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
      <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T20:17:57.153553&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f741314d-34b6-3417-9c0a-426d547e345a&quot;</span><span class="p">,</span>
      <span class="s2">&quot;involvedEntities&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_process&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_process-sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip-9.108.160.132&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname-sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-01T13:18:50.606099&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastUpdatedBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
      <span class="s2">&quot;readableId&quot;</span><span class="p">:</span> <span class="s2">&quot;INSIGHT-2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;signals&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;allRecords&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;baseImage&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bro_dns_answers&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_file_bytes&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_file_connUids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_flow_service&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ftp_pendingCommands&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_cookieVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_origFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_origMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_request_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_http_request_proxied&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_response_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_http_response_respFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_response_respMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_uriVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_kerberos_clientCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_kerberos_serverCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_sip_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_sip_requestPath&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_sip_responsePath&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ssl_certChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ssl_clientCertChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;cseSignal&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
              <span class="s2">&quot;device_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;device_hostname_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;dstDevice_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;dstDevice_hostname_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;fieldTags&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;event_id&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd-failed-invalid-password&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source_port&quot;</span><span class="p">:</span> <span class="s2">&quot;53371&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ssh_version&quot;</span><span class="p">:</span> <span class="s2">&quot;ssh2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_message&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed password for root from 9.108.160.132 port 53371 ssh2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_process&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_process_id&quot;</span><span class="p">:</span> <span class="s2">&quot;35224&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;Jul 30 13:17:19&quot;</span><span class="p">,</span>
                <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
              <span class="p">},</span>
              <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
              <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
              <span class="s2">&quot;http_requestHeaders&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;listMatches&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;matchedItems&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;metadata_deviceEventId&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd-failed-invalid-password&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_mapperName&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Syslog - Process sshd - SSH Auth Failure Invalid Password&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_mapperUid&quot;</span><span class="p">:</span> <span class="s2">&quot;05445189-0e1e-425a-8f2b-5d1f41e9546e&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_parseTime&quot;</span><span class="p">:</span> <span class="mi">1722370665323</span><span class="p">,</span>
              <span class="s2">&quot;metadata_parser&quot;</span><span class="p">:</span> <span class="s2">&quot;/Parsers/System/Linux/Linux OS Syslog&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_product&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Syslog&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_productGuid&quot;</span><span class="p">:</span> <span class="s2">&quot;0e20c932-d992-4bd4-b276-c15119ca5c0b&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_receiptTime&quot;</span><span class="p">:</span> <span class="mi">1722370640</span><span class="p">,</span>
              <span class="s2">&quot;metadata_schemaVersion&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sensorId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sensorInformation&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;metadata_sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceBlockId&quot;</span><span class="p">:</span> <span class="s2">&quot;2295449033841068855&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceCategory&quot;</span><span class="p">:</span> <span class="s2">&quot;linux/system&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceMessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;-7272543713819412727&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux&quot;</span><span class="p">,</span>
              <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
              <span class="s2">&quot;normalizedAction&quot;</span><span class="p">:</span> <span class="s2">&quot;logon&quot;</span><span class="p">,</span>
              <span class="s2">&quot;objectClassification&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
              <span class="s2">&quot;objectType&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
              <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="mi">35224</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_ipv4IntValue&quot;</span><span class="p">:</span> <span class="mi">158113924</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_isInternal&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_version&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
              <span class="s2">&quot;srcPort&quot;</span><span class="p">:</span> <span class="mi">53371</span><span class="p">,</span>
              <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1722345439000</span><span class="p">,</span>
              <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="s2">&quot;aac19471-8442-5536-9742-bcc5aacc1e80&quot;</span><span class="p">,</span>
              <span class="s2">&quot;user_username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
              <span class="s2">&quot;user_username_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
              <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2024</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;RULE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Detects multiple failed login attempts for the same username over a 24 hour timeframe. This is designed to catch both slow and quick brute force type attacks. The threshold and time frame can be adjusted based on the customer</span><span class="se">\u0027</span><span class="s2">s environment.&quot;</span><span class="p">,</span>
          <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f16f0e84-66c4-50c7-a0b2-b02b5cbdd543&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Brute Force Attempt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;recordSearchDetails&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;_index=sec_record_* | json field=_raw </span><span class="se">\&quot;</span><span class="s2">resultType</span><span class="se">\&quot;</span><span class="s2"> as _unpacked__raw_resultType nodrop</span><span class="se">\n</span><span class="s2">| where (if (isNull(objectType), false, objectType == </span><span class="se">\&quot;</span><span class="s2">Authentication</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(normalizedAction), false, normalizedAction == </span><span class="se">\&quot;</span><span class="s2">logon</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(success), false, !(success)) and !(if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">Security-4776</span><span class="se">\&quot;</span><span class="s2">) and !isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">domain_controllers</span><span class="se">\&quot;</span><span class="s2">)) and !(if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Azure</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(_unpacked__raw_resultType), false, _unpacked__raw_resultType == </span><span class="se">\&quot;</span><span class="s2">700082</span><span class="se">\&quot;</span><span class="s2">)) and !(metadata_vendor in (</span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Intersect Alliance</span><span class="se">\&quot;</span><span class="s2">) and metadata_product in (</span><span class="se">\&quot;</span><span class="s2">Windows</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Snare Enterprise Agent for Windows</span><span class="se">\&quot;</span><span class="s2">) and user_username matches /^[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*</span><span class="se">\\</span><span class="s2">$[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*$/) and !(!isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">vuln_scanners</span><span class="se">\&quot;</span><span class="s2">)) and if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">sshd-failed-invalid-password</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Linux OS Syslog</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Linux</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(user_username), false, user_username == </span><span class="se">\&quot;</span><span class="s2">root</span><span class="se">\&quot;</span><span class="s2">))&quot;</span><span class="p">,</span>
            <span class="s2">&quot;queryEndTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T14:24:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;queryStartTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-29T14:24:00&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;recordTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;ruleId&quot;</span><span class="p">:</span> <span class="s2">&quot;THRESHOLD-S00096&quot;</span><span class="p">,</span>
          <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
          <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;ALGORITHM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;In Progress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;inprogress&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;subResolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;New tag&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;teamAssignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timeToDetection&quot;</span><span class="p">:</span> <span class="mf">25238.153553</span><span class="p">,</span>
      <span class="s2">&quot;timeToRemediation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timeToResponse&quot;</span><span class="p">:</span> <span class="mf">147653.411281</span><span class="p">,</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_insight_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f741314d-34b6-3417-9c0a-426d547e345a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_insight_tag&quot;</span><span class="p">:</span> <span class="s2">&quot;New tag&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">151744</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-02 13:49:08&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_tag</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_tag</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">add_tag_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_tags</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Sumo Logic Add Tag to Insight:&lt;/b&gt;  </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_tag</span><span class="si">}</span><span class="s2"> added.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Sumo Logic: Add Tag to Insight&lt;/b&gt; failed to post tag(s) - no content.&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;VMware CBC: Add Tag to Insight&lt;/b&gt; failed to add tag(s) </span><span class="si">{reason}</span><span class="s2">.&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-get-entity">
<h2>Function - Sumo Logic: Get Entity<a class="headerlink" href="#function-sumo-logic-get-entity" title="Link to this heading">¶</a></h2>
<p>Query Sumo Logic to get details of an entity.</p>
<p><img alt="screenshot: fn-sumo-logic-get-entity " src="../_images/fn-sumo-logic-get-entity.png" /></p>
<p>The <strong>Sumo Logic: Scan Artifact for Hits</strong> playbooks create hits on artifacts based on the Signal Severity score associated with Sumo Logic entities.</p>
<p>
NOTE: Edit the following playbook post-script variable to set the minimum threshold at which a hit is added to an artifact:
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MINIMUM_RECENT_SIGNAL_SEVERITY</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
<p><img alt="screenshot: fn-sumo-logic-get-entity " src="../_images/fn-sumo-logic-get-entity2.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_entity_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_entity_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;activityScore&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;criticality&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
      <span class="s2">&quot;firstSeen&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip-9.61.102.36&quot;</span><span class="p">,</span>
      <span class="s2">&quot;isSuppressed&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;lastSeen&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-20T08:39:03&quot;</span><span class="p">,</span>
      <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;9.61.102.36&quot;</span><span class="p">,</span>
      <span class="s2">&quot;recentSignalSeverity&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s2">&quot;reputation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.61.102.36&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_entity_type&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_entity_value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.61.102.36&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_insight_id&quot;</span><span class="p">:</span> <span class="s2">&quot;0b5f00b6-b14d-3492-9564-28bd98610a29&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">7397</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-21 11:39:58&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ARTIFACT_TYPE_MAPPING</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;DNS Name&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname&quot;</span><span class="p">,</span>
  <span class="s2">&quot;IP Address&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
  <span class="s2">&quot;File Path&quot;</span><span class="p">:</span> <span class="s2">&quot;_file&quot;</span><span class="p">,</span>
  <span class="s2">&quot;MAC Address&quot;</span><span class="p">:</span> <span class="s2">&quot;_mac&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Process Name&quot;</span><span class="p">:</span> <span class="s2">&quot;_process&quot;</span><span class="p">,</span>
  <span class="s2">&quot;User Account&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
  <span class="s2">&quot;User Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;_useragent&quot;</span><span class="p">,</span>
  <span class="s2">&quot;URL&quot;</span><span class="p">:</span> <span class="s2">&quot;_url&quot;</span>
<span class="p">}</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_entity_type</span> <span class="o">=</span> <span class="n">ARTIFACT_TYPE_MAPPING</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_entity_type</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Artifact </span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> not mapped.&quot;</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_entity_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Edit the following variable to change the minimum threshold at which a hit is added to an artifact.</span>
<span class="n">MINIMUM_RECENT_SIGNAL_SEVERITY</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_entity_results</span>

<span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Sumo Logic Automatic Scan Artifact:&lt;/b&gt;&lt;br&gt;&quot;</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">objects</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">entity</span> <span class="o">=</span> <span class="n">objects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">recent_signal_severity</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;recentSignalSeverity&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">recent_signal_severity</span> <span class="o">&gt;=</span> <span class="n">MINIMUM_RECENT_SIGNAL_SEVERITY</span><span class="p">:</span>
                        <span class="c1"># Create a hit on the artifact.</span>
                        <span class="n">hit</span> <span class="o">=</span> <span class="p">[</span>
                          <span class="p">{</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Artifact Value&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                          <span class="p">}</span>
                        <span class="p">]</span>
                        <span class="n">artifact</span><span class="o">.</span><span class="n">addHit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sumo Logic: Signal Severity Total: </span><span class="si">{</span><span class="n">recent_signal_severity</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">hit</span><span class="p">)</span>
                        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2"> Hit added on &lt;b&gt;</span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&lt;/b&gt; with Signal Severity Total: &lt;b&gt;</span><span class="si">{</span><span class="n">recent_signal_severity</span><span class="si">}</span><span class="s2">&lt;/b&gt;.&quot;</span>

                        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-get-insight-by-id">
<h2>Function - Sumo Logic: Get Insight By ID<a class="headerlink" href="#function-sumo-logic-get-insight-by-id" title="Link to this heading">¶</a></h2>
<p>Get the details of a Sumo Logic insight given the insight ID.</p>
<p><img alt="screenshot: fn-sumo-logic-get-insight-by-id " src="../_images/fn-sumo-logic-get-insight-by-id.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;assignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;closed&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;closedBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
      <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T20:17:57.153553&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f741314d-34b6-3417-9c0a-426d547e345a&quot;</span><span class="p">,</span>
      <span class="s2">&quot;involvedEntities&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_process&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_process-sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip-9.108.160.132&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname-sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T20:18:10.061087&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastUpdatedBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
      <span class="s2">&quot;readableId&quot;</span><span class="p">:</span> <span class="s2">&quot;INSIGHT-2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;recordSummaryFields&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;signals&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;allRecords&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;baseImage&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bro_dns_answers&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_file_bytes&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_file_connUids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_flow_service&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ftp_pendingCommands&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_cookieVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_origFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_origMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_request_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_http_request_proxied&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_response_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_http_response_respFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_response_respMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_uriVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_kerberos_clientCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_kerberos_serverCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_sip_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_sip_requestPath&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_sip_responsePath&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ssl_certChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ssl_clientCertChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;cseSignal&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
              <span class="s2">&quot;device_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;device_hostname_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;dstDevice_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;dstDevice_hostname_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;fieldTags&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;event_id&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd-failed-invalid-password&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;90.8.160.132&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source_port&quot;</span><span class="p">:</span> <span class="s2">&quot;53371&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ssh_version&quot;</span><span class="p">:</span> <span class="s2">&quot;ssh2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_message&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed password for root from 90.8.160.132 port 53371 ssh2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_process&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_process_id&quot;</span><span class="p">:</span> <span class="s2">&quot;35224&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;Jul 30 13:17:19&quot;</span><span class="p">,</span>
                <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
              <span class="p">},</span>
              <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
              <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
              <span class="s2">&quot;http_requestHeaders&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;listMatches&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;matchedItems&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;metadata_deviceEventId&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd-failed-invalid-password&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_mapperName&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Syslog - Process sshd - SSH Auth Failure Invalid Password&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_mapperUid&quot;</span><span class="p">:</span> <span class="s2">&quot;05445189-0e1e-425a-8f2b-5d1f41e9546e&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_parseTime&quot;</span><span class="p">:</span> <span class="mi">1722370665323</span><span class="p">,</span>
              <span class="s2">&quot;metadata_parser&quot;</span><span class="p">:</span> <span class="s2">&quot;/Parsers/System/Linux/Linux OS Syslog&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_product&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Syslog&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_productGuid&quot;</span><span class="p">:</span> <span class="s2">&quot;0e20c932-d992-4bd4-b276-c15119ca5c0b&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_receiptTime&quot;</span><span class="p">:</span> <span class="mi">1722370640</span><span class="p">,</span>
              <span class="s2">&quot;metadata_schemaVersion&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sensorId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sensorInformation&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;metadata_sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceBlockId&quot;</span><span class="p">:</span> <span class="s2">&quot;2295449033841068855&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceCategory&quot;</span><span class="p">:</span> <span class="s2">&quot;linux/system&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceMessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;-7272543713819412727&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux&quot;</span><span class="p">,</span>
              <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
              <span class="s2">&quot;normalizedAction&quot;</span><span class="p">:</span> <span class="s2">&quot;logon&quot;</span><span class="p">,</span>
              <span class="s2">&quot;objectClassification&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
              <span class="s2">&quot;objectType&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
              <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="mi">35224</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;90.8.160.132&quot;</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_ipv4IntValue&quot;</span><span class="p">:</span> <span class="mi">158113924</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_isInternal&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_version&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
              <span class="s2">&quot;srcPort&quot;</span><span class="p">:</span> <span class="mi">53371</span><span class="p">,</span>
              <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1722345439000</span><span class="p">,</span>
              <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="s2">&quot;aac19471-8442-5536-9742-bcc5aacc1e80&quot;</span><span class="p">,</span>
              <span class="s2">&quot;user_username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
              <span class="s2">&quot;user_username_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
              <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2024</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;RULE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Detects multiple failed login attempts for the same username over a 24 hour timeframe. This is designed to catch both slow and quick brute force type attacks. The threshold and time frame can be adjusted based on the customer</span><span class="se">\u0027</span><span class="s2">s environment.&quot;</span><span class="p">,</span>
          <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f16f0e84-66c4-50c7-a0b2-b02b5cbdd543&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Brute Force Attempt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;recordSearchDetails&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;_index=sec_record_* | json field=_raw </span><span class="se">\&quot;</span><span class="s2">resultType</span><span class="se">\&quot;</span><span class="s2"> as _unpacked__raw_resultType nodrop</span><span class="se">\n</span><span class="s2">| where (if (isNull(objectType), false, objectType == </span><span class="se">\&quot;</span><span class="s2">Authentication</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(normalizedAction), false, normalizedAction == </span><span class="se">\&quot;</span><span class="s2">logon</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(success), false, !(success)) and !(if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">Security-4776</span><span class="se">\&quot;</span><span class="s2">) and !isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">domain_controllers</span><span class="se">\&quot;</span><span class="s2">)) and !(if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Azure</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(_unpacked__raw_resultType), false, _unpacked__raw_resultType == </span><span class="se">\&quot;</span><span class="s2">700082</span><span class="se">\&quot;</span><span class="s2">)) and !(metadata_vendor in (</span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Intersect Alliance</span><span class="se">\&quot;</span><span class="s2">) and metadata_product in (</span><span class="se">\&quot;</span><span class="s2">Windows</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Snare Enterprise Agent for Windows</span><span class="se">\&quot;</span><span class="s2">) and user_username matches /^[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*</span><span class="se">\\</span><span class="s2">$[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*$/) and !(!isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">vuln_scanners</span><span class="se">\&quot;</span><span class="s2">)) and if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">sshd-failed-invalid-password</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Linux OS Syslog</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Linux</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(user_username), false, user_username == </span><span class="se">\&quot;</span><span class="s2">root</span><span class="se">\&quot;</span><span class="s2">))&quot;</span><span class="p">,</span>
            <span class="s2">&quot;queryEndTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T14:24:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;queryStartTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-29T14:24:00&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;recordTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;ruleId&quot;</span><span class="p">:</span> <span class="s2">&quot;THRESHOLD-S00096&quot;</span><span class="p">,</span>
          <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
          <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;ALGORITHM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;New&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;new&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;subResolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;teamAssignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timeToDetection&quot;</span><span class="p">:</span> <span class="mf">25238.153553</span><span class="p">,</span>
      <span class="s2">&quot;timeToRemediation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timeToResponse&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_insight_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f741314d-34b6-3417-9c0a-426d547e345a&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">7981</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-31 12:25:37&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Map Sumo Logic resolution values SOAR resolution id values.</span>
<span class="c1">#    Duplicate — The insight has triggered before on the same entity and is a duplicate.</span>
<span class="c1">#    False Positive—An insight triggered and it is legitimate activity.</span>
<span class="c1">#    No Action—An insight triggered and it might not be an incident but is also not a false positive.</span>
<span class="c1">#    Resolved — An incident occurred and was resolved.</span>

<span class="n">MAPPING_RESOLUTION</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;Duplicate&quot;</span> <span class="p">:</span> <span class="s2">&quot;Duplicate&quot;</span><span class="p">,</span>
  <span class="s2">&quot;False Positive&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;No Action&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Resolved&quot;</span> <span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span>
<span class="p">}</span>

<span class="c1"># Map Sumo Logic subResolution values to SOAR resolution id values.</span>
<span class="n">MAPPING_SUB_RESOLUTION_ON_CLOSE</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;None&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">,</span>
  <span class="s2">&quot;False positive&quot;</span><span class="p">:</span> <span class="s2">&quot;Not an Issue&quot;</span><span class="p">,</span>
  <span class="s2">&quot;True positive&quot;</span><span class="p">:</span> <span class="s2">&quot;Resolved&quot;</span>
<span class="p">}</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_insight_by_id_results</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Case on Creation:&lt;/b&gt; Unable to get case data to update custom fields.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_tags</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">entity_url</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entity_url&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">entity_url</span><span class="p">:</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_link</span> <span class="o">=</span> <span class="s2">&quot;&lt;a target=&#39;_blank&#39; href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;Insight&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entity_url</span><span class="p">)</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_global_confidence</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">confidence</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">confidence</span> <span class="ow">and</span> <span class="p">(</span><span class="n">confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_readable_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;readableId&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_source</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resolution&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_sub_resolution</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subResolution&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">assignee</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;assignee&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">assignee</span><span class="p">:</span>
            <span class="n">display_name</span> <span class="o">=</span> <span class="n">assignee</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">username</span>     <span class="o">=</span> <span class="n">assignee</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_assignee</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">display_name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
          <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;displayName&quot;</span><span class="p">)</span>

        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Case on Creation:&lt;/b&gt; Write Alert Custom Fields complete.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;closed&quot;</span><span class="p">:</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">plan_status</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">resolution_id</span> <span class="o">=</span> <span class="n">MAPPING_RESOLUTION</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span><span class="p">,</span> <span class="s2">&quot;Resolved&quot;</span><span class="p">)</span>
            <span class="n">incident</span><span class="o">.</span><span class="n">resolution_summary</span> <span class="o">=</span> <span class="s2">&quot;Case </span><span class="si">{0}</span><span class="s2"> Closed in SOAR&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Case on Creation:&lt;/b&gt; Write Insight Custom Fields did NOT complete.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-get-insights-comments">
<h2>Function - Sumo Logic: Get Insights Comments<a class="headerlink" href="#function-sumo-logic-get-insights-comments" title="Link to this heading">¶</a></h2>
<p>Get comments from a Sumo Logic insight and add any new ones as notes to the corresponding SOAR case.</p>
<p><img alt="screenshot: fn-sumo-logic-get-insights-comments " src="../_images/fn-sumo-logic-get-insights-comments.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_incident_id&quot;</span><span class="p">:</span> <span class="mi">2167</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_insight_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2a8419c4-b84b-3b6c-8447-af4ccbfba9c6&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">6625</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-01 14:26:04&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_insights_comments_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Case on Creation - Get Insight Comments&lt;/b&gt; function added </span><span class="si">{0}</span><span class="s2"> note(s) in SOAR.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Case on Creation - Get Insight Comments&lt;/b&gt; function failed to get notes from Sumo Logic.&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Case on Creation - Get Insight Comments&lt;/b&gt; function failed to get notes from Sumo Logic.&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-get-signal-by-id">
<h2>Function - Sumo Logic: Get Signal by ID<a class="headerlink" href="#function-sumo-logic-get-signal-by-id" title="Link to this heading">¶</a></h2>
<p>Get the details of a Sumo Logic signal given the signal ID.</p>
<p><img alt="screenshot: fn-sumo-logic-get-signal-by-id " src="../_images/fn-sumo-logic-get-signal-by-id.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;allRecords&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;login&quot;</span><span class="p">,</span>
          <span class="s2">&quot;baseImage&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/sbin/sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;bro_dns_answers&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_file_bytes&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;bro_file_connUids&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_flow_service&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_ftp_pendingCommands&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_cookieVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_origFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_origMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_request_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;bro_http_request_proxied&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_response_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;bro_http_response_respFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_response_respMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_http_uriVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_kerberos_clientCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;bro_kerberos_serverCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;bro_sip_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;bro_sip_requestPath&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_sip_responsePath&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_ssl_certChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;bro_ssl_clientCertChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;cseSignal&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
          <span class="s2">&quot;fieldTags&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;AUID&quot;</span><span class="p">:</span> <span class="s2">&quot;unset&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UID&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;acct&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addr&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.223.75&quot;</span><span class="p">,</span>
            <span class="s2">&quot;auid&quot;</span><span class="p">:</span> <span class="s2">&quot;4294967295&quot;</span><span class="p">,</span>
            <span class="s2">&quot;event_id&quot;</span><span class="p">:</span> <span class="s2">&quot;USER_LOGIN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exe&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/sbin/sshd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;audit(1723134275.877:33373):&quot;</span><span class="p">,</span>
            <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;login&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="s2">&quot;61267&quot;</span><span class="p">,</span>
            <span class="s2">&quot;res&quot;</span><span class="p">:</span> <span class="s2">&quot;failed&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ses&quot;</span><span class="p">:</span> <span class="s2">&quot;4294967295&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subj&quot;</span><span class="p">:</span> <span class="s2">&quot;kernel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syslog_message&quot;</span><span class="p">:</span> <span class="s2">&quot;type=USER_LOGIN msg=audit(1723134275.877:33373): pid=61267 uid=0 auid=4294967295 ses=4294967295 subj=kernel msg=</span><span class="se">\u0027</span><span class="s2">op=login acct=</span><span class="se">\&quot;</span><span class="s2">(unknown)</span><span class="se">\&quot;</span><span class="s2"> exe=</span><span class="se">\&quot;</span><span class="s2">/usr/sbin/sshd</span><span class="se">\&quot;</span><span class="s2"> hostname=? addr=9.30.223.75 terminal=ssh res=failed</span><span class="se">\u0027\u001d</span><span class="s2">UID=</span><span class="se">\&quot;</span><span class="s2">root</span><span class="se">\&quot;</span><span class="s2"> AUID=</span><span class="se">\&quot;</span><span class="s2">unset</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syslog_process&quot;</span><span class="p">:</span> <span class="s2">&quot;systemdjournal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syslog_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;1723134275.877&quot;</span><span class="p">,</span>
            <span class="s2">&quot;terminal&quot;</span><span class="p">:</span> <span class="s2">&quot;ssh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;USER_LOGIN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
          <span class="s2">&quot;http_requestHeaders&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;listMatches&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;matchedItems&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;metadata_deviceEventId&quot;</span><span class="p">:</span> <span class="s2">&quot;USER_LOGIN&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_mapperName&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Systemd Journal - Login Events&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_mapperUid&quot;</span><span class="p">:</span> <span class="s2">&quot;0e5cbfbb-91ac-4658-918c-709c76d53f1e&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_parseTime&quot;</span><span class="p">:</span> <span class="mi">1723134354974</span><span class="p">,</span>
          <span class="s2">&quot;metadata_parser&quot;</span><span class="p">:</span> <span class="s2">&quot;/Parsers/System/Linux/Linux OS Syslog&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_product&quot;</span><span class="p">:</span> <span class="s2">&quot;Systemd Journal&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_productGuid&quot;</span><span class="p">:</span> <span class="s2">&quot;5be5af82-c248-4c4c-a485-0571025f242c&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_receiptTime&quot;</span><span class="p">:</span> <span class="mi">1723134278</span><span class="p">,</span>
          <span class="s2">&quot;metadata_schemaVersion&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
          <span class="s2">&quot;metadata_sensorId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_sensorInformation&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;metadata_sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_sourceBlockId&quot;</span><span class="p">:</span> <span class="s2">&quot;1864672286443784304&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_sourceCategory&quot;</span><span class="p">:</span> <span class="s2">&quot;linux/system&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_sourceMessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;-6870926605261705032&quot;</span><span class="p">,</span>
          <span class="s2">&quot;metadata_vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux&quot;</span><span class="p">,</span>
          <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
          <span class="s2">&quot;normalizedAction&quot;</span><span class="p">:</span> <span class="s2">&quot;logon&quot;</span><span class="p">,</span>
          <span class="s2">&quot;objectClassification&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
          <span class="s2">&quot;objectType&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
          <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="mi">61267</span><span class="p">,</span>
          <span class="s2">&quot;srcDevice_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.223.75&quot;</span><span class="p">,</span>
          <span class="s2">&quot;srcDevice_ip_ipv4IntValue&quot;</span><span class="p">:</span> <span class="mi">153018187</span><span class="p">,</span>
          <span class="s2">&quot;srcDevice_ip_isInternal&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;srcDevice_ip_version&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
          <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
          <span class="s2">&quot;targetUser_username&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;targetUser_username_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1723134275877</span><span class="p">,</span>
          <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="s2">&quot;6c825674-ab7b-5cf1-9250-ba35c9746835&quot;</span><span class="p">,</span>
          <span class="s2">&quot;user_username&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;user_username_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2024</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;RULE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-08T16:25:58.534000&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Detects multiple failed login attempts for the same username over a 24 hour timeframe. This is designed to catch both slow and quick brute force type attacks. The threshold and time frame can be adjusted based on the customer</span><span class="se">\u0027</span><span class="s2">s environment.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-(unknown)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;328c96b1-02a1-5c01-af94-364a90b9c0d6&quot;</span><span class="p">,</span>
      <span class="s2">&quot;involvedEntities&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip-9.30.223.75&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.223.75&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.223.75&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip-9.30.48.247&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.48.247&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.30.48.247&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_process&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_process-/usr/sbin/sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/sbin/sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/sbin/sshd&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-(unknown)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;(unknown)&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Brute Force Attempt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;recordSearchDetails&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;_index=sec_record_* | json field=_raw </span><span class="se">\&quot;</span><span class="s2">resultType</span><span class="se">\&quot;</span><span class="s2"> as _unpacked__raw_resultType nodrop</span><span class="se">\n</span><span class="s2">| where (if (isNull(objectType), false, objectType == </span><span class="se">\&quot;</span><span class="s2">Authentication</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(normalizedAction), false, normalizedAction == </span><span class="se">\&quot;</span><span class="s2">logon</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(success), false, !(success)) and !(if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">Security-4776</span><span class="se">\&quot;</span><span class="s2">) and !isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">domain_controllers</span><span class="se">\&quot;</span><span class="s2">)) and !(if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Azure</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(_unpacked__raw_resultType), false, _unpacked__raw_resultType == </span><span class="se">\&quot;</span><span class="s2">700082</span><span class="se">\&quot;</span><span class="s2">)) and !(metadata_vendor in (</span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Intersect Alliance</span><span class="se">\&quot;</span><span class="s2">) and metadata_product in (</span><span class="se">\&quot;</span><span class="s2">Windows</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Snare Enterprise Agent for Windows</span><span class="se">\&quot;</span><span class="s2">) and user_username matches /^[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*</span><span class="se">\\</span><span class="s2">$[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*$/) and !(!isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">vuln_scanners</span><span class="se">\&quot;</span><span class="s2">)) and if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">USER_LOGIN</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Systemd Journal</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Linux</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(user_username), false, user_username == </span><span class="se">\&quot;</span><span class="s2">(unknown)</span><span class="se">\&quot;</span><span class="s2">))&quot;</span><span class="p">,</span>
        <span class="s2">&quot;queryEndTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-08T19:12:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;queryStartTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-07T19:12:00&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;recordTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;ruleId&quot;</span><span class="p">:</span> <span class="s2">&quot;THRESHOLD-S00096&quot;</span><span class="p">,</span>
      <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiple failed login attempts for user: (unknown)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;suppressed&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;threatIntelIndicatorIds&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-08T16:24:35.877000&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_signal_id&quot;</span><span class="p">:</span> <span class="s2">&quot;328c96b1-02a1-5c01-af94-364a90b9c0d6&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">19139</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-09 14:56:09&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_signal_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">sumo_logic_signal_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_signal_by_id_results</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">signal_id</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sumo_logic_signal_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
  
<span class="n">header</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Get Signal by ID:&lt;/b&gt; </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">signal_id</span><span class="p">)</span>

<span class="n">json_note</span> <span class="o">=</span> <span class="p">{</span>
              <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.3&quot;</span><span class="p">,</span>
              <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">,</span> 
              <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
              <span class="s2">&quot;sort&quot;</span><span class="p">:</span> <span class="kc">False</span>
            <span class="p">}</span>
<span class="n">playbook</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">&#39;convert_json_to_rich_text&#39;</span><span class="p">,</span> <span class="n">json_note</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-sumo-logic-update-insight-status">
<h2>Function - Sumo Logic: Update Insight Status<a class="headerlink" href="#function-sumo-logic-update-insight-status" title="Link to this heading">¶</a></h2>
<p>Update the status of an insight in Sumo Logic.  If the status is set to closed, set the resolution reason.</p>
<p><img alt="screenshot: fn-sumo-logic-update-insight-status " src="../_images/fn-sumo-logic-update-insight-status.png" /></p>
<p>Dialog box to set an Insight’s status through a manual playbook:</p>
<p><img alt="screenshot: fn-sumo-logic-update-insight-status " src="../_images/fn-sumo-logic-update-insight-status-2.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_resolution</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_status</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;assignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;assignee&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;closed&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;closedBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
      <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T20:17:57.153553&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f741314d-34b6-3417-9c0a-426d547e345a&quot;</span><span class="p">,</span>
      <span class="s2">&quot;involvedEntities&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_process&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_process-sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_ip-9.108.160.132&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname&quot;</span><span class="p">,</span>
          <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_hostname-sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-02T20:50:41.638872&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastUpdatedBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
      <span class="s2">&quot;orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
      <span class="s2">&quot;readableId&quot;</span><span class="p">:</span> <span class="s2">&quot;INSIGHT-2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;signals&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;allRecords&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;baseImage&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bro_dns_answers&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_file_bytes&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_file_connUids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_flow_service&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ftp_pendingCommands&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_cookieVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_origFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_origMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_request_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_http_request_proxied&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_response_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_http_response_respFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_response_respMimeTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_http_uriVars&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_kerberos_clientCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_kerberos_serverCert&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_sip_headers&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;bro_sip_requestPath&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_sip_responsePath&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ssl_certChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;bro_ssl_clientCertChainFuids&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;cseSignal&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
              <span class="s2">&quot;device_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;device_hostname_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;dstDevice_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;dstDevice_hostname_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;fieldTags&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;event_id&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd-failed-invalid-password&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source_port&quot;</span><span class="p">:</span> <span class="s2">&quot;53371&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ssh_version&quot;</span><span class="p">:</span> <span class="s2">&quot;ssh2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;sumologic1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_message&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed password for root from 9.108.160.132 port 53371 ssh2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_process&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_process_id&quot;</span><span class="p">:</span> <span class="s2">&quot;35224&quot;</span><span class="p">,</span>
                <span class="s2">&quot;syslog_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;Jul 30 13:17:19&quot;</span><span class="p">,</span>
                <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
              <span class="p">},</span>
              <span class="s2">&quot;friendlyName&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
              <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
              <span class="s2">&quot;http_requestHeaders&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;listMatches&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;matchedItems&quot;</span><span class="p">:</span> <span class="p">[],</span>
              <span class="s2">&quot;metadata_deviceEventId&quot;</span><span class="p">:</span> <span class="s2">&quot;sshd-failed-invalid-password&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_mapperName&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Syslog - Process sshd - SSH Auth Failure Invalid Password&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_mapperUid&quot;</span><span class="p">:</span> <span class="s2">&quot;05445189-0e1e-425a-8f2b-5d1f41e9546e&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_orgId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_parseTime&quot;</span><span class="p">:</span> <span class="mi">1722370665323</span><span class="p">,</span>
              <span class="s2">&quot;metadata_parser&quot;</span><span class="p">:</span> <span class="s2">&quot;/Parsers/System/Linux/Linux OS Syslog&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_product&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux OS Syslog&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_productGuid&quot;</span><span class="p">:</span> <span class="s2">&quot;0e20c932-d992-4bd4-b276-c15119ca5c0b&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_receiptTime&quot;</span><span class="p">:</span> <span class="mi">1722370640</span><span class="p">,</span>
              <span class="s2">&quot;metadata_schemaVersion&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sensorId&quot;</span><span class="p">:</span> <span class="s2">&quot;0000000000BD6D7C&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sensorInformation&quot;</span><span class="p">:</span> <span class="p">{},</span>
              <span class="s2">&quot;metadata_sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceBlockId&quot;</span><span class="p">:</span> <span class="s2">&quot;2295449033841068855&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceCategory&quot;</span><span class="p">:</span> <span class="s2">&quot;linux/system&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_sourceMessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;-7272543713819412727&quot;</span><span class="p">,</span>
              <span class="s2">&quot;metadata_vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux&quot;</span><span class="p">,</span>
              <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
              <span class="s2">&quot;normalizedAction&quot;</span><span class="p">:</span> <span class="s2">&quot;logon&quot;</span><span class="p">,</span>
              <span class="s2">&quot;objectClassification&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
              <span class="s2">&quot;objectType&quot;</span><span class="p">:</span> <span class="s2">&quot;Authentication&quot;</span><span class="p">,</span>
              <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="mi">35224</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;9.108.160.132&quot;</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_ipv4IntValue&quot;</span><span class="p">:</span> <span class="mi">158113924</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_isInternal&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;srcDevice_ip_version&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
              <span class="s2">&quot;srcPort&quot;</span><span class="p">:</span> <span class="mi">53371</span><span class="p">,</span>
              <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1722345439000</span><span class="p">,</span>
              <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="s2">&quot;aac19471-8442-5536-9742-bcc5aacc1e80&quot;</span><span class="p">,</span>
              <span class="s2">&quot;user_username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
              <span class="s2">&quot;user_username_raw&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
              <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">2024</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="s2">&quot;artifacts&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;contentType&quot;</span><span class="p">:</span> <span class="s2">&quot;RULE&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span><span class="p">,</span>
          <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Detects multiple failed login attempts for the same username over a 24 hour timeframe. This is designed to catch both slow and quick brute force type attacks. The threshold and time frame can be adjusted based on the customer</span><span class="se">\u0027</span><span class="s2">s environment.&quot;</span><span class="p">,</span>
          <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;_username&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;_username-root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;macAddress&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensorZone&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f16f0e84-66c4-50c7-a0b2-b02b5cbdd543&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Brute Force Attempt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;recordSearchDetails&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;_index=sec_record_* | json field=_raw </span><span class="se">\&quot;</span><span class="s2">resultType</span><span class="se">\&quot;</span><span class="s2"> as _unpacked__raw_resultType nodrop</span><span class="se">\n</span><span class="s2">| where (if (isNull(objectType), false, objectType == </span><span class="se">\&quot;</span><span class="s2">Authentication</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(normalizedAction), false, normalizedAction == </span><span class="se">\&quot;</span><span class="s2">logon</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(success), false, !(success)) and !(if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">Security-4776</span><span class="se">\&quot;</span><span class="s2">) and !isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">domain_controllers</span><span class="se">\&quot;</span><span class="s2">)) and !(if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Azure</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(_unpacked__raw_resultType), false, _unpacked__raw_resultType == </span><span class="se">\&quot;</span><span class="s2">700082</span><span class="se">\&quot;</span><span class="s2">)) and !(metadata_vendor in (</span><span class="se">\&quot;</span><span class="s2">Microsoft</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Intersect Alliance</span><span class="se">\&quot;</span><span class="s2">) and metadata_product in (</span><span class="se">\&quot;</span><span class="s2">Windows</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">Snare Enterprise Agent for Windows</span><span class="se">\&quot;</span><span class="s2">) and user_username matches /^[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*</span><span class="se">\\</span><span class="s2">$[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">S]*$/) and !(!isBlank(listMatches) AND jsonArrayContains(listMatches, </span><span class="se">\&quot;</span><span class="s2">vuln_scanners</span><span class="se">\&quot;</span><span class="s2">)) and if (isNull(metadata_deviceEventId), false, metadata_deviceEventId == </span><span class="se">\&quot;</span><span class="s2">sshd-failed-invalid-password</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_product), false, metadata_product == </span><span class="se">\&quot;</span><span class="s2">Linux OS Syslog</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(metadata_vendor), false, metadata_vendor == </span><span class="se">\&quot;</span><span class="s2">Linux</span><span class="se">\&quot;</span><span class="s2">) and if (isNull(user_username), false, user_username == </span><span class="se">\&quot;</span><span class="s2">root</span><span class="se">\&quot;</span><span class="s2">))&quot;</span><span class="p">,</span>
            <span class="s2">&quot;queryEndTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T14:24:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;queryStartTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-29T14:24:00&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;recordTypes&quot;</span><span class="p">:</span> <span class="p">[],</span>
          <span class="s2">&quot;ruleId&quot;</span><span class="p">:</span> <span class="s2">&quot;THRESHOLD-S00096&quot;</span><span class="p">,</span>
          <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
          <span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;Initial Access&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;ALGORITHM&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;displayName&quot;</span><span class="p">:</span> <span class="s2">&quot;New&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;new&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;subResolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;AnnMarie-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AnnMarie tag&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0006&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTactic:TA0008&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1078&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1110.002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_mitreAttackTechnique:T1586&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;teamAssignedTo&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timeToDetection&quot;</span><span class="p">:</span> <span class="mf">25238.153553</span><span class="p">,</span>
      <span class="s2">&quot;timeToRemediation&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;timeToResponse&quot;</span><span class="p">:</span> <span class="mf">147653.411281</span><span class="p">,</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-07-30T13:17:19&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;sumo_logic_insight_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f741314d-34b6-3417-9c0a-426d547e345a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_insight_resolution&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;sumo_logic_insight_status&quot;</span><span class="p">:</span> <span class="s2">&quot;New&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">64088</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;my.app.host&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-sumo-logic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-08-02 16:51:21&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Input Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span>

<span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span> <span class="o">==</span> <span class="s2">&quot;Closed&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span><span class="p">:</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;Resolution musted be specified if status is Closed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Function Post Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">update_insight_status_results</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Insight Status: &lt;/b&gt; set:&lt;br&gt;&quot;</span>
    <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;   Status:  </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span> <span class="o">==</span> <span class="s1">&#39;Closed&#39;</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;   Resolution: </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_resolution</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="c1"># Uncomment if sub_resolution is implemented.</span>
    <span class="c1">#if playbook.inputs.sumo_logic_insight_sub_resolution and playbook.inputs.sumo_logic_insight_status == &#39;Closed&#39;:</span>
    <span class="c1">#    incident.properties.sumo_logic_insight_sub_resolution = playbook.inputs.sumo_logic_insight_sub_resolution</span>
    <span class="c1">#    note_text = f&quot;{note_text}&lt;br&gt;   Sub Resolution: {playbook.inputs.sumo_logic_insight_sub_resolution&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Update Insight Status: &lt;/b&gt; failed to update status to &lt;b&gt;</span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">sumo_logic_insight_status</span><span class="si">}</span><span class="s2">&lt;/b&gt;:&lt;br&gt;  </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span>
  
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-convert-json-to-rich-text-v1-3">
<h2>Script - Convert JSON to rich text v1.3<a class="headerlink" href="#script-convert-json-to-rich-text-v1-3" title="Link to this heading">¶</a></h2>
<p>This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident’s rich text (custom) field or an incident note. A workflow property is used to share the json to convert and identify parameters used on how to perform the conversion.
Typically, a function will create workflow property and this script will run after that function to perform the conversion.</p>
<p>Features:</p>
<ul class="simple">
<li><p>Display the hierarchical nature of json, presenting the json keys (sorted if specified) as bold labels</p></li>
<li><p>Provide links to found URLs</p></li>
<li><p>Create either an incident note or add results to an incident (custom) rich text field.</p></li>
</ul>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (c) Copyright IBM Corp. 2010, 2023. All Rights Reserved.</span>
<span class="n">VERSION</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident&#39;s rich text (custom) field or an incident note.</span>
<span class="sd">  A workflow property is used to define the json to convert and identify parameters used on how to perform the conversion.</span>
<span class="sd">  Typically, a function will create workflow property and this script will run after that function to perform the conversion.</span>
<span class="sd">  Features:</span>
<span class="sd">    * Display the hierarchical nature of json, presenting the json keys as bold labels</span>
<span class="sd">    * Provide links to found URLs</span>
<span class="sd">    * Create either an incident note or add results to an incident (custom) rich text field.</span>
<span class="sd">  </span>
<span class="sd">  In order to use this script, define a workflow property called: convert_json_to_rich_text, to define the json and parameters to use for the conversion.</span>
<span class="sd">  Workflow properties can be added using a command similar to this:</span>
<span class="sd">  workflow.addProperty(&#39;convert_json_to_rich_text&#39;, {</span>
<span class="sd">    &quot;version&quot;: 1.3,</span>
<span class="sd">    &quot;header&quot;: &quot;Artifact scan results for: {}&quot;.format(artifact.value),</span>
<span class="sd">    &quot;padding&quot;: 10,</span>
<span class="sd">    &quot;separator&quot;: u&quot;&lt;br /&gt;&quot;,</span>
<span class="sd">    &quot;sort&quot;: True,</span>
<span class="sd">    &quot;json&quot;: results.content,</span>
<span class="sd">    &quot;json_omit_list&quot;: [&quot;omit&quot;],</span>
<span class="sd">    &quot;incident_field&quot;: None</span>
<span class="sd">  })</span>
<span class="sd">  </span>
<span class="sd">  Format of workflow.property.convert_json_to_rich_text:</span>
<span class="sd">  { </span>
<span class="sd">    &quot;version&quot;: 1.3, [this is for future compatibility]</span>
<span class="sd">    &quot;header&quot;: str, [header line to add to converted json produced or None. Ex: Results from scanning artifact: xxx. The header may contain rich text tags]</span>
<span class="sd">    &quot;padding&quot;: 10, [padding for nested json elements, or defaults to 10]</span>
<span class="sd">    &quot;separator&quot;: u&quot;&lt;br /&gt;&quot;|list such as [&#39;&lt;span&gt;&#39;,&#39;&lt;/span&gt;&#39;], [html separator between json keys and lists or defaults to html break: &#39;&lt;br /&gt;&#39;. </span>
<span class="sd">                                                If a list, then the data is brackets by the pair specified]</span>
<span class="sd">    &quot;sort&quot;: True|False, [sort the json keys at each level when displayed]</span>
<span class="sd">    &quot;json&quot;: json, [required json to convert]</span>
<span class="sd">    &quot;json_omit_list&quot;: [list of json keys to exclude or None]</span>
<span class="sd">    &quot;incident_field&quot;: &quot;&lt;incident_field&gt;&quot; [indicates a builtin rich text incident field, such as &#39;description&#39; </span>
<span class="sd">                                          or a custom rich text field in the format: &#39;properties.&lt;field&gt;&#39;. default: create an incident note]</span>
<span class="sd">  }</span>

<span class="sd">  For playbooks, use playbook.addProperty() with the same format as workflow.addProperty()</span>

<span class="sd">  Playbooks can also use playbook.functions.results.convert_json_to_rich_text using the standard function output which contains the &#39;content&#39; json element.</span>
<span class="sd">  When using playbook.functions.results.convert_json_to_rich_text with standard function results, all the defaults for padding, separator, etc. are used.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="c1"># needed for python 3</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">unicode</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span> <span class="c1"># fails in py3</span>
    <span class="n">py2</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>
    <span class="n">py2</span> <span class="o">=</span> <span class="kc">False</span>


<span class="n">rc</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+#\?]|[!*\(\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+&#39;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ConvertJson</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to hold the conversion parameters and perform the conversion&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omit_keys</span><span class="o">=</span><span class="p">[],</span> <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omit_keys</span> <span class="o">=</span> <span class="n">omit_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="o">=</span> <span class="n">separator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort_keys</span> <span class="o">=</span> <span class="n">sort_keys</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">format_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">          Find embedded urls (http(s)) and add html anchor tags to display as links</span>
<span class="sd">          Args:</span>
<span class="sd">              item ([string])</span>

<span class="sd">          Returns:</span>
<span class="sd">              [str]: None|original text if no links|text with html links</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formatted_item</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">if</span> <span class="n">py2</span><span class="p">:</span>
            <span class="n">num_type</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">item</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_type</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">item</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">item</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">num_type</span><span class="p">:</span>
            <span class="nb">list</span> <span class="o">=</span> <span class="n">rc</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">formatted_item</span> <span class="o">=</span> <span class="n">formatted_item</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&lt;a target=&#39;blank&#39; href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;</span><span class="si">{0}</span><span class="s2">&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">formatted_item</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">expand_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_value</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">          convert items to html, adding indents to nested dictionaries.</span>
<span class="sd">          Args:</span>
<span class="sd">              list_value ([dict|list]): json element</span>

<span class="sd">          Returns:</span>
<span class="sd">              [str]: html converted code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_link</span><span class="p">(</span><span class="n">list_value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">list_value</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;None&lt;br&gt;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">items_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># this will ensure list starts on second line of key label</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_json_to_rich_text</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">is_list</span><span class="p">:</span>
                        <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand_list</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">is_list</span><span class="p">:</span>
                    <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&lt;li&gt;</span><span class="si">{}</span><span class="s2">&lt;/li&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format_link</span><span class="p">(</span><span class="n">unicode</span><span class="p">(</span><span class="n">item</span><span class="p">))))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">items_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format_link</span><span class="p">(</span><span class="n">unicode</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>

            <span class="n">expand_list_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_list</span> <span class="k">else</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                    <span class="n">items_list</span><span class="p">,</span>
                                                    <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_list</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;&lt;ul&gt;</span><span class="si">{}</span><span class="s2">&lt;/ul&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expand_list_result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;&lt;div style=&#39;padding:5px&#39;&gt;</span><span class="si">{}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expand_list_result</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_json_to_rich_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">          Walk dictionary tree and convert to html for better display</span>
<span class="sd">          Args:</span>
<span class="sd">              sub_dict ([type]): [description]</span>

<span class="sd">          Returns:</span>
<span class="sd">              [type]: [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">sub_dict</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_dict</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">expanded_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_list</span><span class="p">(</span><span class="n">sub_dict</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="n">expanded_list</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span> <span class="p">(</span><span class="n">sub_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_keys</span> <span class="k">else</span> <span class="n">sub_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">omit_keys</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">sub_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                        <span class="n">is_list</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
                        <span class="n">item_list</span> <span class="o">=</span> <span class="p">[</span><span class="sa">u</span><span class="s2">&quot;&lt;strong&gt;</span><span class="si">{0}</span><span class="s2">&lt;/strong&gt;: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                            <span class="n">convert_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_json_to_rich_text</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">convert_result</span><span class="p">:</span>
                                <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&lt;div style=&#39;padding:</span><span class="si">{}</span><span class="s2">px&#39;&gt;</span><span class="si">{}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="n">convert_result</span><span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;None&lt;br&gt;&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand_list</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">))</span>

                        <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">make_unicode</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">item_list</span><span class="p">),</span> <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">))</span>

        <span class="n">result_notes</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result_notes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result_notes</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="sa">u</span><span class="s2">&quot;&lt;/div&gt;</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">),</span> <span class="sa">u</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator</span><span class="p">),</span> <span class="sa">u</span><span class="s2">&quot;&lt;/div&gt;&quot;</span>
            <span class="p">)</span>  <span class="c1"># tighten up result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        apply the separator to the data</span>
<span class="sd">        :param separator: None, str or list such as [&#39;&lt;span&gt;&#39;, &#39;&lt;/span&gt;&#39;]</span>
<span class="sd">        :param items: str or list to add separator</span>
<span class="sd">        :return: text with separator applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_items</span> <span class="o">=</span> <span class="n">items</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_items</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;br&gt;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_items</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">_items</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">,</span> <span class="n">separator</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_items</span><span class="p">])</span>

        <span class="k">return</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_items</span><span class="p">),</span> <span class="n">separator</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_list</span> <span class="k">else</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">make_unicode</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;None&#39;</span>

    <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_results</span><span class="p">(</span><span class="n">property_name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">playbook</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">playbook</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">playbook</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">workflow</span> <span class="ow">and</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">property_name</span><span class="p">]</span>

    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_properties</span><span class="p">(</span><span class="n">property_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logic to collect the json and parameters from a workflow property.</span>
<span class="sd">    Args:</span>
<span class="sd">      property_name: workflow property to reference</span>
<span class="sd">    Returns:</span>
<span class="sd">      padding, separator, header, json_omit_list, incident_field, json, sort_keys</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result_properties</span> <span class="o">=</span> <span class="n">get_results</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result_properties</span><span class="p">:</span>
        <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;Playbook/workflow property not found: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">property_name</span><span class="p">))</span>

    <span class="n">padding</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;padding&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s2">&quot;list of separators should be specified as a pair such as [&#39;&lt;div&gt;&#39;, &#39;&lt;/div&gt;&#39;]: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="p">))</span>

    <span class="n">header</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">)</span>
    <span class="n">sort_keys</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="n">json_omit_list</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json_omit_list&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">json_omit_list</span><span class="p">:</span>
        <span class="n">json_omit_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">incident_field</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;incident_field&quot;</span><span class="p">)</span>
    
    <span class="c1"># workflow formatted content is &#39;json&#39;. Standard functions is &#39;content&#39;</span>
    <span class="n">json</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="n">json_err</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># is there an issue we need handle now?</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">json</span> <span class="ow">and</span> \
        <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">):</span>
        <span class="n">json_err</span> <span class="o">=</span> <span class="n">result_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">padding</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">json_omit_list</span><span class="p">,</span> <span class="n">incident_field</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">json_err</span><span class="p">,</span> <span class="n">sort_keys</span>


<span class="c1">## S T A R T</span>
<span class="n">padding</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">json_omit_list</span><span class="p">,</span> <span class="n">incident_field</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">json_err</span><span class="p">,</span> <span class="n">sort_keys</span> <span class="o">=</span> <span class="n">get_properties</span><span class="p">(</span><span class="s1">&#39;convert_json_to_rich_text&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">json_err</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;Result error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">json_err</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">hdr</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}{1}{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">separator</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hdr</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;</span>

    <span class="n">convert</span> <span class="o">=</span> <span class="n">ConvertJson</span><span class="p">(</span><span class="n">omit_keys</span><span class="o">=</span><span class="n">json_omit_list</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="n">sort_keys</span><span class="p">)</span>
    <span class="n">converted_json</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convert_json_to_rich_text</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hdr</span><span class="p">,</span> <span class="n">converted_json</span> <span class="k">if</span> <span class="n">converted_json</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">None&quot;</span><span class="p">)</span>

<span class="n">rich_text_note</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">if</span> <span class="n">incident_field</span><span class="p">:</span>
    <span class="n">incident</span><span class="p">[</span><span class="n">incident_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">rich_text_note</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">rich_text_note</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-sumo-logic-add-artifacts-from-insight">
<h2>Script - Sumo Logic: Add Artifacts from Insight<a class="headerlink" href="#script-sumo-logic-add-artifacts-from-insight" title="Link to this heading">¶</a></h2>
<p>Create artifacts in SOAR from the Sumo Logic Get Insight by ID function and write the results to a note.</p>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ARTIFACT_TYPE_MAPPING</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;IP Address&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Name&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_file&quot;</span><span class="p">:</span> <span class="s2">&quot;File Path&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_mac&quot;</span><span class="p">:</span> <span class="s2">&quot;MAC Address&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_process&quot;</span><span class="p">:</span> <span class="s2">&quot;Process Name&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_username&quot;</span><span class="p">:</span> <span class="s2">&quot;User Account&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_useragent&quot;</span><span class="p">:</span> <span class="s2">&quot;User Agent&quot;</span><span class="p">,</span>
  <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;URL&quot;</span>
<span class="p">}</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_insight_by_id_results</span>

<span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Sumo Logic: Add Artifacts from Insight:&lt;/b&gt;&quot;</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
      <span class="n">data</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
          <span class="n">involved_entities</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;involvedEntities&quot;</span><span class="p">,</span> <span class="p">[])</span>
          <span class="n">artifact_count</span> <span class="o">=</span> <span class="mi">0</span>
          <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">involved_entities</span><span class="p">:</span>
              <span class="n">entity_type</span> <span class="o">=</span> <span class="n">ARTIFACT_TYPE_MAPPING</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entityType&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">entity_value</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="k">if</span> <span class="n">entity_type</span> <span class="ow">and</span> <span class="n">entity_value</span><span class="p">:</span>
                  <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="n">entity_type</span><span class="p">,</span> <span class="n">entity_value</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Artifact created from Sumo Logic insight </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">sumo_logic_insight_readable_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                  <span class="n">artifact_count</span> <span class="o">+=</span> <span class="mi">1</span>
              <span class="k">else</span><span class="p">:</span>
                  <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;Unable to create artifact from entity: </span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span>
          <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;</span><span class="si">{</span><span class="n">artifact_count</span><span class="si">}</span><span class="s2"> artifact(s) created.&quot;</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;no data found in insight results.&quot;</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;no content found in insight results.&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2">&lt;br&gt;results found in insight results.&quot;</span>

<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="script-sumo-logic-populate-signals-data-table">
<h2>Script - Sumo Logic: Populate Signals Data Table<a class="headerlink" href="#script-sumo-logic-populate-signals-data-table" title="Link to this heading">¶</a></h2>
<p>Populate the Signals data table with results from get insight function.</p>
<p><strong>Object:</strong> incident</p>
<details><summary>Script Text:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get_insight_by_id_results</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;Sumo Logic: Populate Signals Data Table:&lt;/b&gt;&quot;</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">content</span><span class="p">:</span>
      <span class="n">data</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
          <span class="n">signals</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;signals&quot;</span><span class="p">,</span> <span class="p">[])</span>
          <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">signals</span><span class="p">:</span>
              <span class="n">signal_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;sumo_logic_insight_signals_dt&quot;</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_timestamp</span>   <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_id</span>          <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_name</span>        <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_stage</span>       <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stage&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_description</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_rule_id</span>     <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ruleId&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="n">signal_row</span><span class="o">.</span><span class="n">sumo_logic_signal_severity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">signal</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
          <span class="n">num_signals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>
          <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">num_signals</span><span class="si">}</span><span class="s2"> signal(s) written to Signals data table.&quot;</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2"> Failed - no data found.&quot;</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2"> Failed - no data content found.&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="s2">&quot;No reason&quot;</span><span class="p">)</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_text</span><span class="si">}</span><span class="s2"> Failed - </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Activation Type</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sumo Logic: Add Comment to Insight</p></td>
<td><p>Manual playbook to add a comment to a Sumo Logic insight in Sumo Logic.</p></td>
<td><p>Manual</p></td>
<td><p>note</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sumo Logic: Add Tag to Insight</p></td>
<td><p>Manual playbook to add a tag to a Sumo Logic insight.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sumo Logic: Close Insight on Case Close</p></td>
<td><p>Automatic playbook that updates the Status and Resolution of the associated insight in Sumo Logic  when the cases is closed in SOAR.  The SOAR case resolution summary is written as a comment to the Sumo Logic insight.</p></td>
<td><p>Automatic</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.plan_status</span> <span class="pre">changed_to</span> <span class="pre">Closed</span> <span class="pre">AND</span> <span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sumo Logic: Scan Artifact for Hits</p></td>
<td><p>Scan artifacts added to Sumo Logic case and add hit if</p></td>
<td><p>Manual</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">artifact.type</span> <span class="pre">in</span> <span class="pre">['IP</span> <span class="pre">Address',</span> <span class="pre">'DNS</span> <span class="pre">Name',</span> <span class="pre">'URL',</span> <span class="pre">'User</span> <span class="pre">Account',</span> <span class="pre">'Process</span> <span class="pre">Name',</span> <span class="pre">'File</span> <span class="pre">Name',</span> <span class="pre">'File</span> <span class="pre">Path',</span> <span class="pre">'MAC</span> <span class="pre">Address',</span> <span class="pre">'User</span> <span class="pre">Agent']</span> <span class="pre">AND</span> <span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sumo Logic: Scan Artifact for Hits Automatic</p></td>
<td><p>Automatic playbook to scan artifacts added to Sumo Logic case and add hit on artifact if recent Signal Severity Total is greater than specified threshold value.</p></td>
<td><p>Automatic</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">artifact.type</span> <span class="pre">in</span> <span class="pre">['IP</span> <span class="pre">Address',</span> <span class="pre">'DNS</span> <span class="pre">Name',</span> <span class="pre">'URL',</span> <span class="pre">'User</span> <span class="pre">Account',</span> <span class="pre">'Process</span> <span class="pre">Name',</span> <span class="pre">'File</span> <span class="pre">Name',</span> <span class="pre">'File</span> <span class="pre">Path',</span> <span class="pre">'MAC</span> <span class="pre">Address',</span> <span class="pre">'User</span> <span class="pre">Agent']</span> <span class="pre">AND</span> <span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">object_added</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sumo Logic: Update Case</p></td>
<td><p>Manual playbook to update Sumo Logic case. Custom fields, data tables and comments are updated in the SOAR case.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sumo Logic: Update Case on Creation</p></td>
<td><p>Automatic playbook to update Sumo Logic case when the case is created. Custom fields, data tables and comments are updated in the SOAR case.</p></td>
<td><p>Automatic</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">object_added</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sumo Logic: Update Insight Status</p></td>
<td><p>Manual playbook to update the status of an insight in Sumo Logic.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sumo Logic: Write Entity JSON to Note</p></td>
<td><p>Write the Sumo Logic entity JSON to an incident note in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Sumo Logic: Write Insight JSON to Note</p></td>
<td><p>Write the Sumo Logic insight JSON to an incident note in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">incident.properties.sumo_logic_insight_id</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sumo Logic: Write Signal JSON to Note</p></td>
<td><p>Write the Sumo Logic signal JSON to an incident note in SOAR.</p></td>
<td><p>Manual</p></td>
<td><p>sumo_logic_insight_signals_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="custom-layouts">
<h2>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">¶</a></h2>
<!--
  Use this section to provide guidance on where the user should add any custom fields and data tables.
  You may wish to recommend a new incident tab.
  You should save a screenshot "custom_layouts.png" in the doc/screenshots directory and reference it here
-->
<p>A custom layout Sumo Logic tab is included that contains Custom Fields and Signals Data Tables and Custom Fields like the screenshot below:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts32.png" /></p>
<p>Sumo Logic Incident tab example:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts210.png" /></p>
</section>
<section id="data-table-signals">
<h2>Data Table - Signals<a class="headerlink" href="#data-table-signals" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-signals" src="../_images/dt-signals.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>sumo_logic_insight_signals_dt</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Description</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_description</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Rule ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_rule_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Severity</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_severity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Signal ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Stage</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_stage</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Timestamp</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_signal_timestamp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Insight Assignee</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_assignee</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Insight Global Confidence</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_global_confidence</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Insight ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Insight Link</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_link</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Insight Readable ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_readable_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Insight Resolution</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_resolution</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Insight Source</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_source</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Insight Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Insight Sub Resolution</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_sub_resolution</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Insight Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sumo_logic_insight_tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is an IBM supported app. Please search <a class="reference external" href="https://ibm.com/mysupport">ibm.com/mysupport</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_task_utils/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Task Utilities</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_splunk_integration/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Splunk</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Sumo Logic Cloud SIEM</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#sumo-logic-development-version">Sumo Logic Development Version</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generate-an-access-key-and-secret-in-sumo-log-analytics-platform">Generate an Access Key and Secret in Sumo Log Analytics Platform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1"></a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
<li><a class="reference internal" href="#poller-considerations">Poller Considerations</a></li>
<li><a class="reference internal" href="#insights-filtering">Insights Filtering</a><ul>
<li><a class="reference internal" href="#polling-filter-examples">Polling Filter Examples</a></li>
<li><a class="reference internal" href="#poller-templates-for-soar-cases">Poller Templates for SOAR Cases</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#function-sumo-logic-add-comment-to-insight">Function - Sumo Logic: Add Comment to Insight</a></li>
<li><a class="reference internal" href="#function-sumo-logic-add-tag-to-insight">Function - Sumo Logic: Add Tag to Insight</a></li>
<li><a class="reference internal" href="#function-sumo-logic-get-entity">Function - Sumo Logic: Get Entity</a></li>
<li><a class="reference internal" href="#function-sumo-logic-get-insight-by-id">Function - Sumo Logic: Get Insight By ID</a></li>
<li><a class="reference internal" href="#function-sumo-logic-get-insights-comments">Function - Sumo Logic: Get Insights Comments</a></li>
<li><a class="reference internal" href="#function-sumo-logic-get-signal-by-id">Function - Sumo Logic: Get Signal by ID</a></li>
<li><a class="reference internal" href="#function-sumo-logic-update-insight-status">Function - Sumo Logic: Update Insight Status</a></li>
<li><a class="reference internal" href="#script-convert-json-to-rich-text-v1-3">Script - Convert JSON to rich text v1.3</a></li>
<li><a class="reference internal" href="#script-sumo-logic-add-artifacts-from-insight">Script - Sumo Logic: Add Artifacts from Insight</a></li>
<li><a class="reference internal" href="#script-sumo-logic-populate-signals-data-table">Script - Sumo Logic: Populate Signals Data Table</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
<li><a class="reference internal" href="#data-table-signals">Data Table - Signals</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>