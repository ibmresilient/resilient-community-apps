<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: ZIA: Get URL Categories

## Function - ZIA: Get URL Categories

### API Name
`funct_zia_get_url_categories`

### Output Name
`None`

### Message Destination
`zia`

### Pre-Processing Script
```python
inputs.zia_custom_only = rule.properties.zia_custom_only
inputs.zia_category_id = rule.properties.zia_category_id_input
```

### Post-Processing Script
```python
##  ZIA - wf_zia_get_url_categories post processing script ##

#  Globals
FN_NAME = "funct_zia_get_url_categories"
WF_NAME = "Example: ZIA: Get URL Categories"
CONTENT = results.content
INPUTS = results.inputs
QUERY_EXECUTION_DATE = results["metrics"]["timestamp"]
note_text = ''
DATA_TBL_FIELDS = ["configuredName", "superCategory", "keywords", "urls", "customCategory",  "editable", "type", "customUrlsCount"]
#Processing
def main():
    note_text = u''
    if CONTENT:
        note_text = u"ZIA Integration: Workflow <b>{0}</b>: There were <b>{1}</b> URL categories (s) returned for " \
                        u"SOAR function <b>{2}</b>.".format(WF_NAME, len(CONTENT), FN_NAME)
        for cat in CONTENT:
            newrow = incident.addRow("zia_url_categories")
            newrow.query_execution_date = QUERY_EXECUTION_DATE
            newrow.cat_id = cat["id"]
            for f in DATA_TBL_FIELDS:
              if isinstance(cat[f], list):
                  newrow[f]  = "{}".format(", ".join(cat[f]))
              else:
                  newrow[f]  = "{}".format(cat[f])
    else:
        note_text += u"ZIA Integration: Workflow <b>{0}</b>: There were <b>no</b> results returned " \
                     u"for SOAR function <b>{1}</b>."\
            .format(WF_NAME, FN_NAME)

    incident.addNote(helper.createRichText(note_text))

main()

```

---

