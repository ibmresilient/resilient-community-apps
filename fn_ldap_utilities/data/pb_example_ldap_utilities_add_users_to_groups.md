<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.1.0.695
-->

# Playbook - Example: LDAP Utilities: Add User(s) to Group(s) (PB)

### API Name
`example_ldap_utilities_add_users_to_groups`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type equals String`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| LDAP Domain Name | `ldap_domain_name` | text | Domain name label given to server in app.config | Optional |
| LDAP Multiple User DN | `ldap_multiple_user_dn` | text | A string representation of a List of user DN's | Always |
| LDAP multiple_group_dn | `ldap_multiple_group_dn` | text | A string representation of a list of group DN's | Always |

### Object Type
`artifact`

### Description
add multiple users to multiple groups


---
## Function - LDAP Utilities: Add to Group(s)

### API Name
`ldap_utilities_add_to_groups`

### Output Name
`add_groups_results`

### Message Destination
`fn_ldap_utilities`

### Function-Input Script
```python
# Both inputs must be a string representation of a List

## Example of multiple entries
# inputs.ldap_multiple_user_dn = "['dn=user1,dc=example,dc=com', 'dn=user2,dc=example,dc=com']"
# inputs.ldap_multiple_group_dn = "['dn=Accounts Group,dc=example,dc=com', 'dn=IT Group,dc=example,dc=com']"

# Both inputs must be a string representation of a List
inputs.ldap_multiple_user_dn = getattr(playbook.inputs, "ldap_multiple_user_dn", None)
inputs.ldap_multiple_group_dn = getattr(playbook.inputs, "ldap_multiple_group_dn", None)

# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value
if incident.properties.ldap_domain_name:
  inputs.ldap_domain_name = incident.properties.ldap_domain_name
# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value
if getattr(playbook.inputs, "ldap_domain_name", None):
  inputs.ldap_domain_name = getattr(playbook.inputs, "ldap_domain_name", None)
```

---

## Local script - LDAP Utilities Add Users to Groups post-process

### Description


### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
results = playbook.functions.results.add_groups_results
inputs = results.get('inputs', {})
# If the function is successful in adding the users to said groups, a note is added to the incident
if results.get("success"):
  noteText = f"""<br><i style="color: #979ca3"> LDAP Utilities: Add User(s) to Group(s) <u>complete</u>:</i>
                <b>User(s):</b> {inputs.get('ldap_multiple_user_dn')}
                <b>Group(s):</b> {inputs.get('ldap_multiple_group_dn')}"""

  incident.addNote(helper.createRichText(noteText))
```

---

