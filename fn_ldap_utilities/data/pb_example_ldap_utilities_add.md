<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.1.0.695
-->

# Playbook - Example: LDAP Utilities: Add (PB)

### API Name
`example_ldap_utilities_add`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| LDAP Attribute Name Values | `ldap_attribute_name_values` | text | 'objectClass': 'Users', 'givenName': 'Sam', 'department': 'IT' | Optional |
| LDAP Domain Name | `ldap_domain_name` | text | Domain name label given to server in app.config | Optional |
| LDAP Group(s) | `ldap_groups` | text | Optional when adding users | Optional |
| LDAP User Info | `ldap_user_info` | text | cn=user1,ou=test-ou,dc=example,dc=com | Always |

### Object Type
`incident`

### Description
Add users, groups, organizational units to LDAP


---
## Function - LDAP Utilities: Add

### API Name
`ldap_utilities_add`

### Output Name
`add_results`

### Message Destination
`fn_ldap_utilities`

### Function-Input Script
```python
# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value
if incident.properties.ldap_domain_name:
  inputs.ldap_domain_name = incident.properties.ldap_domain_name
# If a value is given by the user field then set ldap_domain_name to that value
if getattr(playbook.inputs, "ldap_domain_name", None):
  inputs.ldap_domain_name = getattr(playbook.inputs, "ldap_domain_name", None)

inputs.ldap_dn = getattr(playbook.inputs, "ldap_user_info", None)
inputs.ldap_multiple_group_dn = getattr(playbook.inputs, "ldap_groups", None) if getattr(playbook.inputs, "ldap_groups", None) else '[]'
inputs.ldap_attribute_name_values = getattr(playbook.inputs, "ldap_attribute_name_values", None)
```

---

## Local script - LDAP Utilities Add post-process

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
results = playbook.functions.results.add_results
ldap_dn = results.get('inputs', {}).get('ldap_dn')
if results.get("success"):
  incident.addNote(f"LDAP Add operation successful for: {ldap_dn}")
else:
  incident.addNote(f"LDAP Add operation unsuccessful for: {ldap_dn}. Reason: {results.get('reason')}")
```

---

