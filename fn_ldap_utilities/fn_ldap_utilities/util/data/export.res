{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "export_date": 1694440227682,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_new_auto_password_len",
      "hide_notification": false,
      "id": 4680,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_new_auto_password_len",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_new_auto_password_len",
      "tooltip": "Length of password to generate",
      "type_id": 11,
      "uuid": "91b1cdc7-457b-4c8b-8f35-b9faffcb8c6d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_search_filter",
      "hide_notification": false,
      "id": 4681,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_search_filter",
      "operation_perms": {},
      "operations": [],
      "placeholder": "(\u0026(objectClass=person)(mail=*%ldap_param%))",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_search_filter",
      "tooltip": "The filter of the LDAP search request",
      "type_id": 11,
      "uuid": "a550e011-318e-4b7c-a4ee-7ec011ee0447",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_toggle_access",
      "hide_notification": false,
      "id": 4682,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_toggle_access",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_toggle_access",
      "tooltip": "Either enable or disable the user",
      "type_id": 11,
      "uuid": "aa0f6b18-30f9-4e15-ac83-9fce34525947",
      "values": [
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Enable",
          "properties": null,
          "uuid": "a9a1571e-b734-4cbe-84d7-277ce397c0de",
          "value": 1102
        },
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "Disable",
          "properties": null,
          "uuid": "938bd462-d9e0-4887-8ef1-670120e419ad",
          "value": 1103
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_attribute_name",
      "hide_notification": false,
      "id": 4683,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_attribute_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_attribute_name",
      "tooltip": "The name of the LDAP attribute",
      "type_id": 11,
      "uuid": "ad229bf3-14fe-4f0d-aae1-ee339da733dc",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_search_cookies",
      "hide_notification": false,
      "id": 4684,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_search_cookies",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_search_cookies",
      "tooltip": "Search cookies from last paged search",
      "type_id": 11,
      "uuid": "b2a37dbd-dabe-49fa-8909-1e117078cac4",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_search_param",
      "hide_notification": false,
      "id": 4685,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_search_param",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_search_param",
      "tooltip": "Parameter used in search filter",
      "type_id": 11,
      "uuid": "b85e3696-97b0-48b3-a7d6-b72728b11f45",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_attribute_values",
      "hide_notification": false,
      "id": 4686,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_attribute_values",
      "operation_perms": {},
      "operations": [],
      "placeholder": "\"[\u0027value1\u0027, \u0027value2\u0027, \u0027value3\u0027]\"",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_attribute_values",
      "tooltip": "List (as a string representation) of the new attribute values",
      "type_id": 11,
      "uuid": "bec44d02-2902-4619-a3ad-c5fe9fb9231c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_domain_name",
      "hide_notification": false,
      "id": 4687,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_domain_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_domain_name",
      "tooltip": "",
      "type_id": 11,
      "uuid": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_dn",
      "hide_notification": false,
      "id": 4688,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_dn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_dn",
      "tooltip": "Distinguished Name of entry you want to access",
      "type_id": 11,
      "uuid": "c276dce4-c3c6-420e-8430-85ba7e388cf8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_return_new_password",
      "hide_notification": false,
      "id": 4689,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_return_new_password",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_return_new_password",
      "tooltip": "",
      "type_id": 11,
      "uuid": "c886d097-52d8-4281-a68a-988496f28d11",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_search_attributes",
      "hide_notification": false,
      "id": 4690,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_search_attributes",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_search_attributes",
      "tooltip": "A single attribute or a list of attributes to be returned by the LDAP search ",
      "type_id": 11,
      "uuid": "d449aa53-20e8-4af0-bb61-525f4208b07b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_multiple_group_dn",
      "hide_notification": false,
      "id": 4691,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_multiple_group_dn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "\"[\u0027dn=Accounts Group,dc=example,dc=com\u0027, \u0027dn=IT Group,dc=example,dc=com\u0027]\"",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_multiple_group_dn",
      "tooltip": "List (represented as a string) of each DN of the related groups",
      "type_id": 11,
      "uuid": "d862b2fe-1199-43d2-86ec-cff4b45e01f3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_search_base",
      "hide_notification": false,
      "id": 4692,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_search_base",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_search_base",
      "tooltip": "The base of the LDAP search request.",
      "type_id": 11,
      "uuid": "e72e469e-342e-4ef9-8863-d84dee27758a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_new_password",
      "hide_notification": false,
      "id": 4693,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_new_password",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_new_password",
      "tooltip": "The new password you want to set for the entry",
      "type_id": 11,
      "uuid": "ed5de6d6-1e81-4774-ab3a-033b05b2efc8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_attribute_name_values",
      "hide_notification": false,
      "id": 4694,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_attribute_name_values",
      "operation_perms": {},
      "operations": [],
      "placeholder": "\"attribute1\": \"value1\", \"attribute2\": \"value2\"",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_attribute_name_values",
      "tooltip": "comma separated name value pairs",
      "type_id": 11,
      "uuid": "409ae0b5-2ebf-4340-b964-5f82828e36ee",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/ldap_multiple_user_dn",
      "hide_notification": false,
      "id": 4695,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_multiple_user_dn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "\"[\u0027dn=tom smith,dc=example,dc=com\u0027, \u0027dn=ted smith,dc=example,dc=com\u0027]\"",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "ldap_multiple_user_dn",
      "tooltip": "List (represented as a string) of each DN of the users",
      "type_id": 11,
      "uuid": "463e020a-d36c-46d8-bcb5-dbd4d950b09d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/ldap_base_dn",
      "hide_notification": false,
      "id": 4672,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_base_dn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "DC=example,DC=com",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "LDAP Base DN",
      "tooltip": "",
      "type_id": 0,
      "uuid": "cbbaeed3-20a6-4bd8-a293-a0ab05c5e887",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/ldap_domain_name",
      "hide_notification": false,
      "id": 4673,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "ldap_domain_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "LDAP Domain Name",
      "tooltip": "Domain name label given to the LDAP server you wish to use",
      "type_id": 0,
      "uuid": "4201f42b-e7a0-49c6-a8d5-ac16649f40a5",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1691578414202,
      "description": {
        "content": "Add users, groups, organizational units to LDAP",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Add",
      "export_key": "ldap_utilities_add",
      "id": 110,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414258,
      "name": "ldap_utilities_add",
      "tags": [],
      "uuid": "673a09d5-acf2-4c3d-8e48-4647cf91be6f",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c276dce4-c3c6-420e-8430-85ba7e388cf8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "409ae0b5-2ebf-4340-b964-5f82828e36ee",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "d862b2fe-1199-43d2-86ec-cff4b45e01f3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1691578414264,
      "description": {
        "content": "A function that allows adding multiple users to multiple groups",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Add to Group(s)",
      "export_key": "ldap_utilities_add_to_groups",
      "id": 111,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414301,
      "name": "ldap_utilities_add_to_groups",
      "tags": [],
      "uuid": "b602d316-c3b6-4b36-8813-eb81fd381bba",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "463e020a-d36c-46d8-bcb5-dbd4d950b09d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "d862b2fe-1199-43d2-86ec-cff4b45e01f3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1691578414306,
      "description": {
        "content": "A function that allows you to remove multiple from multiple groups",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Remove from Group(s)",
      "export_key": "ldap_utilities_remove_from_groups",
      "id": 112,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414342,
      "name": "ldap_utilities_remove_from_groups",
      "tags": [],
      "uuid": "9ba21139-a5f0-4710-983d-83190f4bdc6c",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "463e020a-d36c-46d8-bcb5-dbd4d950b09d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "d862b2fe-1199-43d2-86ec-cff4b45e01f3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1691578414346,
      "description": {
        "content": "SOAR Function to do a search or query against an LDAP server.",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Search",
      "export_key": "ldap_utilities_search",
      "id": 113,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414384,
      "name": "ldap_utilities_search",
      "tags": [],
      "uuid": "892075c1-64ba-46c9-aba1-f1f1aa040bb7",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "e72e469e-342e-4ef9-8863-d84dee27758a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a550e011-318e-4b7c-a4ee-7ec011ee0447",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "d449aa53-20e8-4af0-bb61-525f4208b07b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "b85e3696-97b0-48b3-a7d6-b72728b11f45",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "b2a37dbd-dabe-49fa-8909-1e117078cac4",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1691578414389,
      "description": {
        "content": "A function that allows you to set a new password for an LDAP entry given the entry\u0027s DN",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Set Password",
      "export_key": "ldap_utilities_set_password",
      "id": 114,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414426,
      "name": "ldap_utilities_set_password",
      "tags": [],
      "uuid": "b75c2ee2-759b-4d01-9649-6ec46f6a646e",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c276dce4-c3c6-420e-8430-85ba7e388cf8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ed5de6d6-1e81-4774-ab3a-033b05b2efc8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "91b1cdc7-457b-4c8b-8f35-b9faffcb8c6d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c886d097-52d8-4281-a68a-988496f28d11",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1691578414431,
      "description": {
        "content": "A function that allows an LDAP user, with the correct privileges to enable or disable another account given their DN",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Toggle Access",
      "export_key": "ldap_utilities_toggle_access",
      "id": 115,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414470,
      "name": "ldap_utilities_toggle_access",
      "tags": [],
      "uuid": "b912c17d-5be2-4dfa-9c8d-2d2b5d9abb08",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c276dce4-c3c6-420e-8430-85ba7e388cf8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "aa0f6b18-30f9-4e15-ac83-9fce34525947",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1691578414476,
      "description": {
        "content": "A function that updates the attribute of a DN with a new value",
        "format": "text"
      },
      "destination_handle": "fn_ldap_utilities",
      "display_name": "LDAP Utilities: Update",
      "export_key": "ldap_utilities_update",
      "id": 116,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578414514,
      "name": "ldap_utilities_update",
      "tags": [],
      "uuid": "dfe0fab8-c425-48fc-95ab-a23f722f77bc",
      "version": 1,
      "view_items": [
        {
          "content": "bf1fbfd3-3b2d-4919-a4e2-0a22449d0921",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c276dce4-c3c6-420e-8430-85ba7e388cf8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ad229bf3-14fe-4f0d-aae1-ee339da733dc",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "bec44d02-2902-4619-a3ad-c5fe9fb9231c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 86,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1694440226156,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1694440226156,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "industries": null,
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_ldap_utilities",
      "name": "fn_ldap_utilities",
      "programmatic_name": "fn_ldap_utilities",
      "tags": [],
      "users": [
        "f@example.com"
      ],
      "uuid": "253d5df1-2f84-4be2-97cb-1c43cada5a32"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867\" isExecutable=\"true\" name=\"playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1013ih3\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Add\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"673a09d5-acf2-4c3d-8e48-4647cf91be6f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given by the user field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n  inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\\n\\ninputs.ldap_dn = playbook.inputs.ldap_user_info\\ninputs.ldap_multiple_group_dn = playbook.inputs.ldap_groups if playbook.inputs.ldap_groups else \u0027[]\u0027\\ninputs.ldap_attribute_name_values = playbook.inputs.ldap_attribute_name_values\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1013ih3\u003c/incoming\u003e\u003coutgoing\u003eFlow_1mj3jex\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1013ih3\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"5b3c78b0-189a-4dff-ac7c-c4f7d64dedda\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mj3jex\u003c/incoming\u003e\u003coutgoing\u003eFlow_1khnrsg\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1mj3jex\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1khnrsg\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1khnrsg\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1khnrsg\" id=\"Flow_1khnrsg_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"372\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"414\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mj3jex\" id=\"Flow_1mj3jex_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"288\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1013ih3\" id=\"Flow_1013ih3_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"288\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"414\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578414829,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
      "description": {
        "content": "Add users, groups, organizational units to LDAP",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Add (PB)",
      "export_key": "example_ldap_utilities_add",
      "field_type_handle": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Add (PB)",
        "export_key": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
        "fields": {
          "ldap_attribute_name_values": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867/ldap_attribute_name_values",
            "hide_notification": false,
            "id": 4696,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_attribute_name_values",
            "operation_perms": {},
            "operations": [],
            "placeholder": "\u0027objectClass\u0027: \u0027Users\u0027, \u0027givenName\u0027: \u0027Sam\u0027, \u0027department\u0027: \u0027IT\u0027",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Attribute Name Values",
            "tooltip": "\u0027objectClass\u0027: \u0027Users\u0027, \u0027givenName\u0027: \u0027Sam\u0027, \u0027department\u0027: \u0027IT\u0027",
            "type_id": 1081,
            "uuid": "86376006-71da-4578-86c9-453d8d502a71",
            "values": []
          },
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867/ldap_domain_name",
            "hide_notification": false,
            "id": 4697,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1081,
            "uuid": "10e6a068-40e7-4822-ae6e-7c53438aea6b",
            "values": []
          },
          "ldap_groups": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867/ldap_groups",
            "hide_notification": false,
            "id": 4698,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_groups",
            "operation_perms": {},
            "operations": [],
            "placeholder": "[\u0027dn=Accounts Group,dc=example,dc=com\u0027, \u0027dn=IT Group,dc=example,dc=com\u0027]",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Group(s)",
            "tooltip": "Optional when adding users",
            "type_id": 1081,
            "uuid": "39ee9fb5-97ec-45e0-a0fe-d58e02dc2929",
            "values": []
          },
          "ldap_user_info": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867/ldap_user_info",
            "hide_notification": false,
            "id": 4699,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_user_info",
            "operation_perms": {},
            "operations": [],
            "placeholder": "cn=user1,ou=test-ou,dc=example,dc=com",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP User Info",
            "tooltip": "cn=user1,ou=test-ou,dc=example,dc=com",
            "type_id": 1081,
            "uuid": "7fb6eeeb-4369-4f23-9793-b336bfbf0a57",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
        "uuid": "d94a173c-15fd-435d-bdda-f60e443409aa"
      },
      "has_logical_errors": false,
      "id": 69,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578415292,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578414993,
          "description": "",
          "enabled": false,
          "export_key": "post-process",
          "id": 91,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578415012,
          "name": "post-process",
          "object_type": "incident",
          "playbook_handle": "example_ldap_utilities_add",
          "programmatic_name": "example_ldap_utilities_add_post_process",
          "script_text": "results = playbook.functions.results.add_results\nldap_dn = results.get(\u0027inputs\u0027, {}).get(\u0027ldap_dn\u0027)\nif results.get(\"success\"):\n  incident.addNote(f\"LDAP Add operation successful for: {ldap_dn}\")\nelse:\n  incident.addNote(f\"LDAP Add operation unsuccessful for: {ldap_dn}. Reason: {results.get(\u0027reason\u0027)}\")",
          "tags": [],
          "uuid": "5b3c78b0-189a-4dff-ac7c-c4f7d64dedda"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "10e6a068-40e7-4822-ae6e-7c53438aea6b",
            "element": "field_uuid",
            "field_type": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "7fb6eeeb-4369-4f23-9793-b336bfbf0a57",
            "element": "field_uuid",
            "field_type": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "86376006-71da-4578-86c9-453d8d502a71",
            "element": "field_uuid",
            "field_type": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "39ee9fb5-97ec-45e0-a0fe-d58e02dc2929",
            "element": "field_uuid",
            "field_type": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_add",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_d9790869-2c5a-41b6-afdb-c2252ddb9867",
        "id": 72,
        "name": "playbook_d9790869_2c5a_41b6_afdb_c2252ddb9867",
        "type": "playbook",
        "uuid": "be57de8e-9c07-415f-b0de-36984ded1d88"
      },
      "tags": [],
      "type": "default",
      "uuid": "d9790869-2c5a-41b6-afdb-c2252ddb9867",
      "version": 3
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_a86f6adc_7be4_49ef_89d4_b663639b0726\" isExecutable=\"true\" name=\"playbook_a86f6adc_7be4_49ef_89d4_b663639b0726\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0jk6izh\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Add to Group(s)\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"b602d316-c3b6-4b36-8813-eb81fd381bba\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Both inputs must be a string representation of a List\\n\\n## Example of multiple entries\\n# inputs.ldap_multiple_user_dn = \\\"[\u0027dn=user1,dc=example,dc=com\u0027, \u0027dn=user2,dc=example,dc=com\u0027]\\\"\\n# inputs.ldap_multiple_group_dn = \\\"[\u0027dn=Accounts Group,dc=example,dc=com\u0027, \u0027dn=IT Group,dc=example,dc=com\u0027]\\\"\\n\\n# Both inputs must be a string representation of a List\\ninputs.ldap_multiple_user_dn = playbook.inputs.ldap_multiple_user_dn\\ninputs.ldap_multiple_group_dn = playbook.inputs.ldap_multiple_group_dn\\n\\n# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n  inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_groups_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0jk6izh\u003c/incoming\u003e\u003coutgoing\u003eFlow_1w2wqt1\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0jk6izh\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4104510b-d24d-49cb-a22f-616af3b3102b\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1w2wqt1\u003c/incoming\u003e\u003coutgoing\u003eFlow_1wswf14\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1w2wqt1\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1wswf14\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1wswf14\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_a86f6adc_7be4_49ef_89d4_b663639b0726\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1wswf14\" id=\"Flow_1wswf14_di\"\u003e\u003comgdi:waypoint x=\"1400\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"1400\" y=\"494\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1w2wqt1\" id=\"Flow_1w2wqt1_di\"\u003e\u003comgdi:waypoint x=\"1400\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"1400\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0jk6izh\" id=\"Flow_0jk6izh_di\"\u003e\u003comgdi:waypoint x=\"1400\" y=\"226\"/\u003e\u003comgdi:waypoint x=\"1400\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"1309\" y=\"174\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1302\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1302\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"1334\" y=\"494\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578415302,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
      "description": {
        "content": "add multiple users to multiple groups",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Add User(s) to Group(s) (PB)",
      "export_key": "example_ldap_utilities_add_users_to_groups",
      "field_type_handle": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Add User(s) to Group(s) (PB)",
        "export_key": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
        "fields": {
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726/ldap_domain_name",
            "hide_notification": false,
            "id": 4700,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1082,
            "uuid": "b6981cc2-48bf-4969-8046-35072813a39d",
            "values": []
          },
          "ldap_multiple_group_dn": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726/ldap_multiple_group_dn",
            "hide_notification": false,
            "id": 4701,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_multiple_group_dn",
            "operation_perms": {},
            "operations": [],
            "placeholder": "[\u0027cn=TestGroup5,cn=users,DC=exmaple,DC=com\u0027, \u0027cn=TestGroup3,cn=users,DC=exmaple,DC=com\u0027]",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP multiple_group_dn",
            "tooltip": "A string repersenation of a list of group DN\u0027s",
            "type_id": 1082,
            "uuid": "5abd5da1-b33d-44d3-bce7-fcfa4221e752",
            "values": []
          },
          "ldap_multiple_user_dn": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726/ldap_multiple_user_dn",
            "hide_notification": false,
            "id": 4702,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_multiple_user_dn",
            "operation_perms": {},
            "operations": [],
            "placeholder": "[\u0027dn=user1,dc=example,dc=com\u0027, \u0027dn=user2,dc=example,dc=com\u0027]",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Multiple User DN",
            "tooltip": "A string representation of a List of user DN\u0027s",
            "type_id": 1082,
            "uuid": "118ba175-04d1-47a6-ad92-b3d1aa609cf2",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
        "uuid": "f6e9e926-a604-44c3-a78f-7289b1c5ddb8"
      },
      "has_logical_errors": false,
      "id": 70,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578415847,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578415449,
          "description": "",
          "enabled": false,
          "export_key": "post-process",
          "id": 92,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578415467,
          "name": "post-process",
          "object_type": "artifact",
          "playbook_handle": "example_ldap_utilities_add_users_to_groups",
          "programmatic_name": "example_ldap_utilities_add_users_to_groups_post_process",
          "script_text": "results = playbook.functions.results.add_groups_results\ninputs = results.get(\u0027inputs\u0027, {})\n# If the function is successful in adding the users to said groups, a note is added to the incident\nif results.get(\"success\"):\n  noteText = f\"\"\"\u003cbr\u003e\u003ci style=\"color: #979ca3\"\u003e LDAP Utilities: Add User(s) to Group(s) \u003cu\u003ecomplete\u003c/u\u003e:\u003c/i\u003e\n                \u003cb\u003eUser(s):\u003c/b\u003e {inputs.get(\u0027ldap_multiple_user_dn\u0027)}\n                \u003cb\u003eGroup(s):\u003c/b\u003e {inputs.get(\u0027ldap_multiple_group_dn\u0027)}\"\"\"\n\n  incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "4104510b-d24d-49cb-a22f-616af3b3102b"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "String"
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "b6981cc2-48bf-4969-8046-35072813a39d",
            "element": "field_uuid",
            "field_type": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "118ba175-04d1-47a6-ad92-b3d1aa609cf2",
            "element": "field_uuid",
            "field_type": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "5abd5da1-b33d-44d3-bce7-fcfa4221e752",
            "element": "field_uuid",
            "field_type": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_add_users_to_groups",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_a86f6adc-7be4-49ef-89d4-b663639b0726",
        "id": 73,
        "name": "playbook_a86f6adc_7be4_49ef_89d4_b663639b0726",
        "type": "playbook",
        "uuid": "29e86896-a775-4c25-a027-670efdb6466e"
      },
      "tags": [],
      "type": "default",
      "uuid": "a86f6adc-7be4-49ef-89d4-b663639b0726",
      "version": 4
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8\" isExecutable=\"true\" name=\"playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0qxe1xr\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Remove from Group(s)\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"9ba21139-a5f0-4710-983d-83190f4bdc6c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Both inputs must be a string representation of a List\\n\\n## Example of multiple entries\\n# inputs.ldap_multiple_user_dn = \\\"[\u0027dn=user1,dc=example,dc=com\u0027, \u0027dn=user2,dc=example,dc=com\u0027]\\\"\\n# inputs.ldap_multiple_group_dn = \\\"[\u0027dn=Accounts Group,dc=example,dc=com\u0027, \u0027dn=IT Group,dc=example,dc=com\u0027]\\\"\\n\\n# Both inputs must be a string representation of a List\\ninputs.ldap_multiple_user_dn = playbook.inputs.ldap_multiple_user_dn\\ninputs.ldap_multiple_group_dn = playbook.inputs.ldap_multiple_group_dn\\n\\n# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n  inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"remove_groups_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0qxe1xr\u003c/incoming\u003e\u003coutgoing\u003eFlow_17sok9f\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0qxe1xr\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"896db300-cae5-4222-8cbd-9d7858cfd1b4\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_17sok9f\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ffu14u\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_17sok9f\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1ffu14u\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1ffu14u\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ffu14u\" id=\"Flow_1ffu14u_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"404\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_17sok9f\" id=\"Flow_17sok9f_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0qxe1xr\" id=\"Flow_0qxe1xr_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"404\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578415825,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
      "description": {
        "content": "remove multiple users from a group",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Remove User(s) from Group(s) (PB)",
      "export_key": "example_ldap_utilities_remove_users_from_groups",
      "field_type_handle": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Remove User(s) from Group(s) (PB)",
        "export_key": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
        "fields": {
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8/ldap_domain_name",
            "hide_notification": false,
            "id": 4703,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1083,
            "uuid": "bc4ebc70-5227-4970-94b4-52b1cb3612be",
            "values": []
          },
          "ldap_multiple_group_dn": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8/ldap_multiple_group_dn",
            "hide_notification": false,
            "id": 4704,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_multiple_group_dn",
            "operation_perms": {},
            "operations": [],
            "placeholder": "[\u0027cn=TestGroup5,cn=users,DC=exmaple,DC=com\u0027, \u0027cn=TestGroup3,cn=users,DC=exmaple,DC=com\u0027]",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Multiple Group DN",
            "tooltip": "A string repersenation of a list of group DN\u0027s",
            "type_id": 1083,
            "uuid": "3af024c9-78f3-46a5-b074-931a0a92c6c1",
            "values": []
          },
          "ldap_multiple_user_dn": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8/ldap_multiple_user_dn",
            "hide_notification": false,
            "id": 4705,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_multiple_user_dn",
            "operation_perms": {},
            "operations": [],
            "placeholder": "[\u0027dn=user1,dc=example,dc=com\u0027, \u0027dn=user2,dc=example,dc=com\u0027]",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Multiple User DN",
            "tooltip": "A string representation of a List of user DN\u0027s",
            "type_id": 1083,
            "uuid": "2da596a3-d4f9-4020-ba2e-c4f5c27fe90d",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
        "uuid": "80593600-a711-4b49-9caf-d5844c41828b"
      },
      "has_logical_errors": false,
      "id": 71,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578416426,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578415979,
          "description": "",
          "enabled": false,
          "export_key": "post-process",
          "id": 93,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578415999,
          "name": "post-process",
          "object_type": "artifact",
          "playbook_handle": "example_ldap_utilities_remove_users_from_groups",
          "programmatic_name": "example_ldap_utilities_remove_users_from_groups_post_process",
          "script_text": "results = playbook.functions.results.remove_groups_results\ninputs = results.get(\"inputs\", {})\n# If the function is successful in removing the users from said groups, a note is added to the incident\nif results.get(\"success\"):\n  if not results.get(\"content\", {}).get(\"users_dn\"):\n    noteText = \"\"\"\u003cbr\u003e\u003ci style=\"color: #979ca3\"\u003e LDAP Utilities: Remove User from Group(s) \u003cu\u003ecomplete\u003c/u\u003e:\u003c/i\u003e\n                  \u003cb\u003eNo users found. Check inputted user DN\u0027s\u003c/b\u003e\"\"\"\n  else:\n    noteText = f\"\"\"\u003cbr\u003e\u003ci style=\"color: #979ca3\"\u003e LDAP Utilities: Remove User from Group(s) \u003cu\u003ecomplete\u003c/u\u003e:\u003c/i\u003e\n                  \u003cb\u003eUser(s):\u003c/b\u003e {inputs.get(\u0027ldap_multiple_user_dn\u0027)}\n                  \u003cb\u003eGroup(s):\u003c/b\u003e {inputs.get(\u0027ldap_multiple_group_dn\u0027)}\"\"\"\n\n  incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "896db300-cae5-4222-8cbd-9d7858cfd1b4"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "String"
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "bc4ebc70-5227-4970-94b4-52b1cb3612be",
            "element": "field_uuid",
            "field_type": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "2da596a3-d4f9-4020-ba2e-c4f5c27fe90d",
            "element": "field_uuid",
            "field_type": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "3af024c9-78f3-46a5-b074-931a0a92c6c1",
            "element": "field_uuid",
            "field_type": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_remove_users_from_groups",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_677981fc-2339-4ac8-93ad-7f6e19acbea8",
        "id": 74,
        "name": "playbook_677981fc_2339_4ac8_93ad_7f6e19acbea8",
        "type": "playbook",
        "uuid": "cb7d7d04-1437-44f4-9269-356f374d8765"
      },
      "tags": [],
      "type": "default",
      "uuid": "677981fc-2339-4ac8-93ad-7f6e19acbea8",
      "version": 4
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3\" isExecutable=\"true\" name=\"playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1brwefy\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# If search filters are given\\nif playbook.inputs.ldap_search_filter:\\n  inputs.ldap_search_filter = playbook.inputs.ldap_search_filter\\n# If filters not given then set them to example filters\\nelse:\\n  inputs.ldap_search_filter = \\\"(\u0026amp;(objectClass=person)(mail=*%ldap_param%))\\\"\\n\\n# If search attributes are given\\nif playbook.inputs.ldap_search_attributes:\\n  inputs.ldap_search_attributes = playbook.inputs.ldap_search_attributes\\n# If search attributes not given then set them to example attributes\\nelse:\\n  inputs.ldap_search_attributes = \\\"*\\\"\\n\\ninputs.ldap_search_param = artifact.value\\n# If the incident field ldap_base_dn contains a value then set ldap_search_base to that value\\nif incident.properties.ldap_base_dn:\\n  inputs.ldap_search_base = incident.properties.ldap_base_dn\\n# If a value is given in the rule ldap_search_base field then set ldap_search_base to that value\\nif playbook.inputs.ldap_search_base:\\n  inputs.ldap_search_base = playbook.inputs.ldap_search_base\\n\\n# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n  inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1brwefy\u003c/incoming\u003e\u003coutgoing\u003eFlow_1vxukq1\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1brwefy\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"bef60ef8-b743-4622-9cb2-6538b78358c8\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1vxukq1\u003c/incoming\u003e\u003coutgoing\u003eFlow_0rb5vyh\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1vxukq1\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0rb5vyh\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0rb5vyh\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0rb5vyh\" id=\"Flow_0rb5vyh_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"364\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vxukq1\" id=\"Flow_1vxukq1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"232\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1brwefy\" id=\"Flow_1brwefy_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"148\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"148\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"364\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578416396,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
      "description": {
        "content": "runs a person query against an LDAP server using the person\u0027s email address",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Search (PB)",
      "export_key": "example_ldap_utilities_search",
      "field_type_handle": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Search (PB)",
        "export_key": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
        "fields": {
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3/ldap_domain_name",
            "hide_notification": false,
            "id": 4706,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1084,
            "uuid": "b4c6fccf-6b97-4bb3-87d3-d1147466f20f",
            "values": []
          },
          "ldap_search_attributes": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3/ldap_search_attributes",
            "hide_notification": false,
            "id": 4707,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_search_attributes",
            "operation_perms": {},
            "operations": [],
            "placeholder": "uid,cn,sn,mail,telephoneNumber or *",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Search Attributes",
            "tooltip": "Attributes for the search to return",
            "type_id": 1084,
            "uuid": "2c47ef23-1ae7-4828-b23d-2b27b97752de",
            "values": []
          },
          "ldap_search_base": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3/ldap_search_base",
            "hide_notification": false,
            "id": 4708,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_search_base",
            "operation_perms": {},
            "operations": [],
            "placeholder": "DC=dev,DC=example,DC=com",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Search Base",
            "tooltip": "Search base",
            "type_id": 1084,
            "uuid": "ca57cb7d-e87e-4f0e-ae21-38fc68d86123",
            "values": []
          },
          "ldap_search_filter": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3/ldap_search_filter",
            "hide_notification": false,
            "id": 4709,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_search_filter",
            "operation_perms": {},
            "operations": [],
            "placeholder": "(\u0026(objectClass=person)(mail=*%ldap_param%))",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Search Filter",
            "tooltip": "Search filters",
            "type_id": 1084,
            "uuid": "4abeba68-c299-4377-874b-7deb8b3a80b6",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
        "uuid": "d8d95246-e6be-4172-8754-8299f0e9a0ce"
      },
      "has_logical_errors": false,
      "id": 72,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578417096,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578416615,
          "description": "",
          "enabled": false,
          "export_key": "post-process",
          "id": 94,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578416638,
          "name": "post-process",
          "object_type": "artifact",
          "playbook_handle": "example_ldap_utilities_search",
          "programmatic_name": "example_ldap_utilities_search_post_process",
          "script_text": "results = playbook.functions.results.search_results\nENTRY_TO_DATATABLE_MAP = {\n  \"uid\": \"uid\",\n  \"cn\": \"fullname\",\n  \"sn\": \"surname\",\n  \"mail\": \"email_address\",\n  \"telephoneNumber\": \"telephone_number\"\n}\n\n# Processing if the function is a success\nif results.get(\"success\"):\n  for entry in results.get(\"content\", {}).get(\"entries\"):\n    row = incident.addRow(\"ldap_query_results\") # Add Row\n    for k in ENTRY_TO_DATATABLE_MAP:\n      # If Handle for Active Directory else Handle for OpenLdap\n      row[ENTRY_TO_DATATABLE_MAP[k]] = \"N/A\" if not entry.get(k) else \",\".join(entry.get(k)) if isinstance(entry[k], list) else entry.get(k)",
          "tags": [],
          "uuid": "bef60ef8-b743-4622-9cb2-6538b78358c8"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Recipient"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Sender"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "String"
            }
          ],
          "logic_type": "any"
        },
        "view_items": [
          {
            "content": "b4c6fccf-6b97-4bb3-87d3-d1147466f20f",
            "element": "field_uuid",
            "field_type": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "ca57cb7d-e87e-4f0e-ae21-38fc68d86123",
            "element": "field_uuid",
            "field_type": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "4abeba68-c299-4377-874b-7deb8b3a80b6",
            "element": "field_uuid",
            "field_type": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "2c47ef23-1ae7-4828-b23d-2b27b97752de",
            "element": "field_uuid",
            "field_type": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_search",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_0b961651-a9db-4bf6-b5cf-957fd057abd3",
        "id": 75,
        "name": "playbook_0b961651_a9db_4bf6_b5cf_957fd057abd3",
        "type": "playbook",
        "uuid": "1e119aa5-7eaf-48df-b28a-cfe9018784c6"
      },
      "tags": [],
      "type": "default",
      "uuid": "0b961651-a9db-4bf6-b5cf-957fd057abd3",
      "version": 4
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_53558c49_4278_4e05_954d_61a71d88f720\" isExecutable=\"true\" name=\"playbook_53558c49_4278_4e05_954d_61a71d88f720\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1yg0ig5\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Set Password\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"b75c2ee2-759b-4d01-9649-6ec46f6a646e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"results = playbook.functions.results.search_results\\n# Once the LDAP Utilities: Search completes, get the DN of the first entry\\n# which will be the DN of the account you want to set a Set a New Password for\\ninputs.ldap_domain_name = results.get(\\\"inputs\\\", {}).get(\\\"ldap_domain_name\\\")\\ninputs.ldap_dn = results.get(\\\"content\\\", {}).get(\\\"entries\\\", [])[0][\\\"dn\\\"]\\ninputs.ldap_new_password = playbook.inputs.ldap_user_new_password\\npass_len = playbook.inputs.ldap_new_auto_password_length\\nif pass_len:\\n  inputs.ldap_new_auto_password_len = pass_len\\ninputs.ldap_return_new_password = playbook.inputs.ldap_return_new_password\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"pass_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0nfw787\u003c/incoming\u003e\u003coutgoing\u003eFlow_04cx373\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"660de09d-1730-4761-b480-141ab608a9c3\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_04cx373\u003c/incoming\u003e\u003coutgoing\u003eFlow_13o7neh\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_04cx373\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_13o7neh\u003c/incoming\u003e\u003cincoming\u003eFlow_1xeywpz\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_13o7neh\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Set the ldap_search_base and ldap_search_filter\\n# using the ldap_param wildcard then get the email\\n# address the user you want to set a new password for from the artifact\u0027s value\\ninputs.ldap_search_filter = \\\"(\u0026amp;(objectClass=person)(mail=%ldap_param%))\\\"\\ninputs.ldap_search_param =  artifact.value\\n\\n# If the incident field ldap_base_dn contains a value then set ldap_search_base to that value\\nif incident.properties.ldap_base_dn:\\n  inputs.ldap_search_base = incident.properties.ldap_base_dn\\n# If a value is given in the rule ldap_search_base field then set ldap_search_base to that value\\nif playbook.inputs.ldap_search_base:\\n  inputs.ldap_search_base = playbook.inputs.ldap_search_base\\n\\n# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n    inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1yg0ig5\u003c/incoming\u003e\u003coutgoing\u003eFlow_01yxuaw\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1yg0ig5\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/\u003e\u003cexclusiveGateway default=\"Flow_1mrqn4f\" id=\"ConditionPoint_5\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_01yxuaw\u003c/incoming\u003e\u003coutgoing\u003eFlow_0nfw787\u003c/outgoing\u003e\u003coutgoing\u003eFlow_1mrqn4f\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003csequenceFlow id=\"Flow_01yxuaw\" sourceRef=\"ServiceTask_4\" targetRef=\"ConditionPoint_5\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"No search results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4546bfdd-a324-47b2-9f14-0b6a466374e8\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mrqn4f\u003c/incoming\u003e\u003coutgoing\u003eFlow_1xeywpz\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1xeywpz\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_3\"/\u003e\u003csequenceFlow id=\"Flow_0nfw787\" name=\"if_results\" sourceRef=\"ConditionPoint_5\" targetRef=\"ServiceTask_1\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"if_results\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"results = playbook.functions.results.search_results\\nif results.get(\\\"success\\\"):\\n  result = True\\nelse:\\n  result = False\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_1mrqn4f\" name=\"Else\" sourceRef=\"ConditionPoint_5\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_53558c49_4278_4e05_954d_61a71d88f720\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mrqn4f\" id=\"Flow_1mrqn4f_di\"\u003e\u003comgdi:waypoint x=\"822\" y=\"360\"/\u003e\u003comgdi:waypoint x=\"1070\" y=\"360\"/\u003e\u003comgdi:waypoint x=\"1070\" y=\"478\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"944\" y=\"338\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0nfw787\" id=\"Flow_0nfw787_di\"\u003e\u003comgdi:waypoint x=\"700\" y=\"386\"/\u003e\u003comgdi:waypoint x=\"700\" y=\"478\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"46\" x=\"677\" y=\"415\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1xeywpz\" id=\"Flow_1xeywpz_di\"\u003e\u003comgdi:waypoint x=\"1070\" y=\"562\"/\u003e\u003comgdi:waypoint x=\"1070\" y=\"850\"/\u003e\u003comgdi:waypoint x=\"766\" y=\"850\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_01yxuaw\" id=\"Flow_01yxuaw_di\"\u003e\u003comgdi:waypoint x=\"700\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"700\" y=\"334\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1yg0ig5\" id=\"Flow_1yg0ig5_di\"\u003e\u003comgdi:waypoint x=\"700\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"700\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_13o7neh\" id=\"Flow_13o7neh_di\"\u003e\u003comgdi:waypoint x=\"700\" y=\"742\"/\u003e\u003comgdi:waypoint x=\"700\" y=\"824\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_04cx373\" id=\"Flow_04cx373_di\"\u003e\u003comgdi:waypoint x=\"700\" y=\"562\"/\u003e\u003comgdi:waypoint x=\"700\" y=\"658\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"609\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"602\" y=\"478\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"602\" y=\"658\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"634\" y=\"824\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"602\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_5\" id=\"ConditionPoint_5_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"578\" y=\"334\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"972\" y=\"478\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578417073,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
      "description": {
        "content": "searches for a user using their email address, gets their DN and sets a new password for that user",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Set Password (PB)",
      "export_key": "example_ldap_utilities_set_password",
      "field_type_handle": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Set Password (PB)",
        "export_key": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
        "fields": {
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_53558c49_4278_4e05_954d_61a71d88f720/ldap_domain_name",
            "hide_notification": false,
            "id": 4710,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1085,
            "uuid": "ef262c14-0ac4-44d1-bb85-41f54d02fff6",
            "values": []
          },
          "ldap_new_auto_password_length": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_53558c49_4278_4e05_954d_61a71d88f720/ldap_new_auto_password_length",
            "hide_notification": false,
            "id": 4711,
            "input_type": "number",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_new_auto_password_length",
            "operation_perms": {},
            "operations": [],
            "placeholder": "12",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP New Auto Password Length",
            "tooltip": "Length of auto generated password",
            "type_id": 1085,
            "uuid": "37c275c9-4100-4f9a-9ecb-b78d3f5048fe",
            "values": []
          },
          "ldap_return_new_password": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_53558c49_4278_4e05_954d_61a71d88f720/ldap_return_new_password",
            "hide_notification": false,
            "id": 4712,
            "input_type": "boolean",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_return_new_password",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Return New Password",
            "tooltip": "",
            "type_id": 1085,
            "uuid": "f02c7152-faea-4091-a0ce-b1cda9ce344b",
            "values": []
          },
          "ldap_search_base": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_53558c49_4278_4e05_954d_61a71d88f720/ldap_search_base",
            "hide_notification": false,
            "id": 4713,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_search_base",
            "operation_perms": {},
            "operations": [],
            "placeholder": "DC=dev,DC=example,DC=com",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Search Base",
            "tooltip": "Search base",
            "type_id": 1085,
            "uuid": "735fa598-f0ce-4815-9cb8-d83a1a5d6f2d",
            "values": []
          },
          "ldap_user_new_password": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_53558c49_4278_4e05_954d_61a71d88f720/ldap_user_new_password",
            "hide_notification": false,
            "id": 4714,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_user_new_password",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP User New Password",
            "tooltip": "If this field is empty password will be autogenerated",
            "type_id": 1085,
            "uuid": "853d54e9-049b-4e66-955f-982d303c990f",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
        "uuid": "9c77da51-bf05-4b29-b97d-9fb7db674af2"
      },
      "has_logical_errors": false,
      "id": 73,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578417781,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578417292,
          "description": "",
          "enabled": false,
          "export_key": "post-process",
          "id": 95,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578417316,
          "name": "post-process",
          "object_type": "artifact",
          "playbook_handle": "example_ldap_utilities_set_password",
          "programmatic_name": "example_ldap_utilities_set_password_post_process",
          "script_text": "results = playbook.functions.results.pass_results\ncontent = results.get(\"content\", {})\n# If the function is successful in changing the users password, a note is added to the incident\nif results.get(\"success\"):\n  noteText = f\"\"\"\u003cbr\u003e\u003ci style=\"color: #979ca3\"\u003e LDAP MultiDomain Utilities: Set Password workflow \u003cu\u003ecomplete\u003c/u\u003e:\u003c/i\u003e\n                A New Password has been set for:\n                \u003cb\u003eEmail:\u003c/b\u003e \u003cu style=\"color: #7fb0ff\"\u003e{artifact.value}\u003c/u\u003e\n                \u003cb\u003eDN:\u003c/b\u003e \u0027{content.get(\u0027user_dn\u0027)}\u0027\n                \u003cb\u003eNew password:\u003c/b\u003e \u0027{content.get(\u0027ldap_new_password\u0027)}\u0027\"\"\"\n\n  incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "660de09d-1730-4761-b480-141ab608a9c3"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Recipient"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Sender"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "String"
            }
          ],
          "logic_type": "any"
        },
        "view_items": [
          {
            "content": "ef262c14-0ac4-44d1-bb85-41f54d02fff6",
            "element": "field_uuid",
            "field_type": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "735fa598-f0ce-4815-9cb8-d83a1a5d6f2d",
            "element": "field_uuid",
            "field_type": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "853d54e9-049b-4e66-955f-982d303c990f",
            "element": "field_uuid",
            "field_type": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "37c275c9-4100-4f9a-9ecb-b78d3f5048fe",
            "element": "field_uuid",
            "field_type": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "f02c7152-faea-4091-a0ce-b1cda9ce344b",
            "element": "field_uuid",
            "field_type": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_set_password",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_53558c49-4278-4e05-954d-61a71d88f720",
        "id": 76,
        "name": "playbook_53558c49_4278_4e05_954d_61a71d88f720",
        "type": "playbook",
        "uuid": "9d42561f-1634-4fef-83a0-a1662a43b5ce"
      },
      "tags": [],
      "type": "default",
      "uuid": "53558c49-4278-4e05-954d-61a71d88f720",
      "version": 4
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74\" isExecutable=\"true\" name=\"playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_10pcx7n\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Set the ldap_search_base and ldap_search_filter\\n# using the ldap_param wildcard then get the email\\n# address the user you want to toggle access for from the artifact\u0027s value\\ninputs.ldap_search_filter = \\\"(\u0026amp;(mail=%ldap_param%))\\\"\\ninputs.ldap_search_param =  artifact.value\\n\\n# If the incident field ldap_base_dn contains a value then set ldap_search_base to that value\\nif incident.properties.ldap_base_dn:\\n  inputs.ldap_search_base = incident.properties.ldap_base_dn\\n# If a value is given in the rule ldap_search_base field then set ldap_search_base to that value\\nif playbook.inputs.ldap_search_base:\\n  inputs.ldap_search_base = playbook.inputs.ldap_search_base\\n\\n# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n  inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_10pcx7n\u003c/incoming\u003e\u003coutgoing\u003eFlow_0w3ojl7\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_10pcx7n\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cexclusiveGateway default=\"Flow_0z3yx83\" id=\"ConditionPoint_2\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_0w3ojl7\u003c/incoming\u003e\u003coutgoing\u003eFlow_02t4yus\u003c/outgoing\u003e\u003coutgoing\u003eFlow_0z3yx83\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003csequenceFlow id=\"Flow_0w3ojl7\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"LDAP Utilities: Toggle Access\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"b912c17d-5be2-4dfa-9c8d-2d2b5d9abb08\"\u003e{\"inputs\":{\"c276dce4-c3c6-420e-8430-85ba7e388cf8\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"aa0f6b18-30f9-4e15-ac83-9fce34525947\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"938bd462-d9e0-4887-8ef1-670120e419ad\"}},\"bf1fbfd3-3b2d-4919-a4e2-0a22449d0921\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}}},\"pre_processing_script\":\"results = playbook.functions.results.search_results\\n# Once the LDAP Utilities: Search completes, get the DN of the first entry\\n# which will be the DN of the account you want to set a Toggle Access for\\ninputs.ldap_domain_name = results.get(\\\"inputs\\\", {}).get(\\\"ldap_domain_name\\\")\\ninputs.ldap_dn = results.get(\\\"content\\\", {}).get(\\\"entries\\\", [])[0][\\\"dn\\\"]\\ninputs.ldap_toggle_access = playbook.inputs.ldap_toggle_access\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"toggle_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02t4yus\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uddq53\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0z102rq\u003c/incoming\u003e\u003cincoming\u003eFlow_0wlzdtm\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"toogle access post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"ffffdb68-d41c-45d8-9f7e-304d3c9945d4\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uddq53\u003c/incoming\u003e\u003coutgoing\u003eFlow_0z102rq\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0uddq53\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_5\"/\u003e\u003csequenceFlow id=\"Flow_0z102rq\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_4\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"No search results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4546bfdd-a324-47b2-9f14-0b6a466374e8\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0z3yx83\u003c/incoming\u003e\u003coutgoing\u003eFlow_0wlzdtm\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0wlzdtm\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_4\"/\u003e\u003csequenceFlow id=\"Flow_02t4yus\" name=\"if_results_returned\" sourceRef=\"ConditionPoint_2\" targetRef=\"ServiceTask_3\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"if_results_returned\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"results = playbook.functions.results.search_results\\nif results.get(\\\"success\\\"):\\n  result = True\\nelse:\\n  result = False\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_0z3yx83\" name=\"Else\" sourceRef=\"ConditionPoint_2\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0z3yx83\" id=\"Flow_0z3yx83_di\"\u003e\u003comgdi:waypoint x=\"692\" y=\"-100\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"-100\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"-12\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"780\" y=\"-122\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02t4yus\" id=\"Flow_02t4yus_di\"\u003e\u003comgdi:waypoint x=\"570\" y=\"-74\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"-12\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"82\" x=\"529\" y=\"-64\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wlzdtm\" id=\"Flow_0wlzdtm_di\"\u003e\u003comgdi:waypoint x=\"870\" y=\"72\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"290\"/\u003e\u003comgdi:waypoint x=\"636\" y=\"290\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0z102rq\" id=\"Flow_0z102rq_di\"\u003e\u003comgdi:waypoint x=\"570\" y=\"212\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"264\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uddq53\" id=\"Flow_0uddq53_di\"\u003e\u003comgdi:waypoint x=\"570\" y=\"72\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"128\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0w3ojl7\" id=\"Flow_0w3ojl7_di\"\u003e\u003comgdi:waypoint x=\"570\" y=\"-188\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"-126\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_10pcx7n\" id=\"Flow_10pcx7n_di\"\u003e\u003comgdi:waypoint x=\"570\" y=\"-334\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"-272\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"479\" y=\"-386\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"472\" y=\"-272\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_2\" id=\"ConditionPoint_2_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"448\" y=\"-126\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"472\" y=\"-12\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"504\" y=\"264\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"472.20000000000005\" y=\"128\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"772\" y=\"-12\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578417756,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
      "description": {
        "content": "enable/disable an Active Directory user account",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Toggle Access (PB)",
      "export_key": "example_ldap_utilities_toggle_access",
      "field_type_handle": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Toggle Access (PB)",
        "export_key": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
        "fields": {
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74/ldap_domain_name",
            "hide_notification": false,
            "id": 4715,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1086,
            "uuid": "64be66e1-4454-441c-8c29-53b34db1331f",
            "values": []
          },
          "ldap_search_base": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74/ldap_search_base",
            "hide_notification": false,
            "id": 4716,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_search_base",
            "operation_perms": {},
            "operations": [],
            "placeholder": "DC=dev,DC=example,DC=com",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Search Base",
            "tooltip": "Search base",
            "type_id": 1086,
            "uuid": "bd68ed0f-830d-47a6-bacb-a974dd389bda",
            "values": []
          },
          "ldap_toggle_access": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74/ldap_toggle_access",
            "hide_notification": false,
            "id": 4717,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_toggle_access",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Toggle Access",
            "tooltip": "",
            "type_id": 1086,
            "uuid": "15deb006-8b0a-4fcd-9338-46a8aad4bc89",
            "values": [
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "Disable",
                "properties": null,
                "uuid": "0d5d250e-39ef-492e-ad1c-47315d96678d",
                "value": 1104
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Enable",
                "properties": null,
                "uuid": "a380e682-8a40-49e7-968e-f05cca031f5d",
                "value": 1105
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
        "uuid": "dc784996-050c-437b-950f-9b5435b26cd9"
      },
      "has_logical_errors": false,
      "id": 74,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578418404,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578417930,
          "description": "",
          "enabled": false,
          "export_key": "toogle access post-process",
          "id": 96,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578417951,
          "name": "toogle access post-process",
          "object_type": "artifact",
          "playbook_handle": "example_ldap_utilities_toggle_access",
          "programmatic_name": "example_ldap_utilities_toggle_access_post_process",
          "script_text": "results = playbook.functions.results.toggle_results\ncontent = results.get(\"content\", {})\n# If the function is successful in updating users access rights, a note is added to the incident\nif results.get(\"success\"):\n  color = \"#45bc27\" #green\n  if (content.get(\"user_status\") == \"Disable\"):\n    color = \"#ff402b\" #red\n\n  noteText = f\"\"\"\u003cbr\u003e\u003ci style=\"color: #979ca3\"\u003e LDAP Utilities: Toggle Access workflow \u003cu\u003ecomplete\u003c/u\u003e:\u003c/i\u003e\n                \u003cb\u003eEmail:\u003c/b\u003e \u003cu style=\"color: #7fb0ff\"\u003e{artifact.value}\u003c/u\u003e\n                \u003cb\u003eStatus:\u003c/b\u003e \u003cb style=\"color: {color}\"\u003e{content.get(\u0027user_status\u0027)}\u003c/b\u003e\n                \u003cb\u003eDN:\u003c/b\u003e \u0027{content.get(\u0027user_dn\u0027)}\u0027\"\"\"\n\n  incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "ffffdb68-d41c-45d8-9f7e-304d3c9945d4"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Recipient"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Sender"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "String"
            }
          ],
          "logic_type": "any"
        },
        "view_items": [
          {
            "content": "64be66e1-4454-441c-8c29-53b34db1331f",
            "element": "field_uuid",
            "field_type": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "bd68ed0f-830d-47a6-bacb-a974dd389bda",
            "element": "field_uuid",
            "field_type": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "15deb006-8b0a-4fcd-9338-46a8aad4bc89",
            "element": "field_uuid",
            "field_type": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_toggle_access",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_fdee38c3-7f6e-4504-a9c7-a0711ac67d74",
        "id": 77,
        "name": "playbook_fdee38c3_7f6e_4504_a9c7_a0711ac67d74",
        "type": "playbook",
        "uuid": "6a9de5b5-4260-4435-af09-a1e9f2cdfb6f"
      },
      "tags": [],
      "type": "default",
      "uuid": "fdee38c3-7f6e-4504-a9c7-a0711ac67d74",
      "version": 4
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 1,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_8d137863_56e4_4751_96aa_9cc6a01c515f\" isExecutable=\"true\" name=\"playbook_8d137863_56e4_4751_96aa_9cc6a01c515f\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1vvbahh\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Set the ldap_search_base and ldap_search_filter\\n# using the ldap_param wildcard then get the email\\n# address the user you want to update from the artifact\u0027s value\\ninputs.ldap_search_filter = \\\"(\u0026amp;(mail=%ldap_param%))\\\"\\ninputs.ldap_search_param =  artifact.value\\n\\n# If the incident field ldap_base_dn contains a value then set ldap_search_base to that value\\nif incident.properties.ldap_base_dn:\\n  inputs.ldap_search_base = incident.properties.ldap_base_dn\\n# If a value is given in the rule ldap_search_base field then set ldap_search_base to that value\\nif playbook.inputs.ldap_search_base:\\n  inputs.ldap_search_base = playbook.inputs.ldap_search_base\\n\\n# If the incident field ldap_domain_name contains a value then set ldap_domain_name to that value\\nif incident.properties.ldap_domain_name:\\n  inputs.ldap_domain_name = incident.properties.ldap_domain_name\\n# If a value is given in the rule ldap_domain_name field then set ldap_domain_name to that value\\nif playbook.inputs.ldap_domain_name:\\n  inputs.ldap_domain_name = playbook.inputs.ldap_domain_name\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1vvbahh\u003c/incoming\u003e\u003coutgoing\u003eFlow_1mrs5vn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1vvbahh\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cexclusiveGateway default=\"Flow_016batd\" id=\"ConditionPoint_2\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_1mrs5vn\u003c/incoming\u003e\u003coutgoing\u003eFlow_0kny2mn\u003c/outgoing\u003e\u003coutgoing\u003eFlow_016batd\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003csequenceFlow id=\"Flow_1mrs5vn\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"LDAP Utilities: Update\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"dfe0fab8-c425-48fc-95ab-a23f722f77bc\"\u003e{\"inputs\":{},\"pre_processing_script\":\"results = playbook.functions.results.search_results\\n# Once the LDAP Utilities: Search completes, get the DN of the first entry\\n# which will be the DN of the account you want to update. Then set\\n# the name of the attribute to update and list the values\\ninputs.ldap_domain_name = results.get(\\\"inputs\\\", {}).get(\\\"ldap_domain_name\\\")\\ninputs.ldap_dn = results.get(\\\"content\\\", {}).get(\\\"entries\\\", [])[0][\\\"dn\\\"]\\ninputs.ldap_attribute_name = playbook.inputs.ldap_update_attribute_name\\ninputs.ldap_attribute_values = playbook.inputs.ldap_attribute_update_value\\n# inputs.ldap_attribute_values = \\\"[\u0027081111111\u0027, \u0027082222222\u0027]\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0kny2mn\u003c/incoming\u003e\u003coutgoing\u003eFlow_1vgp7uu\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"post-process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"6f9f4889-3741-4a88-80c5-416da6ed45bf\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1vgp7uu\u003c/incoming\u003e\u003coutgoing\u003eFlow_0p90k7b\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1vgp7uu\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_5\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0p90k7b\u003c/incoming\u003e\u003cincoming\u003eFlow_1yeg68u\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0p90k7b\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_5\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"No search results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4546bfdd-a324-47b2-9f14-0b6a466374e8\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_016batd\u003c/incoming\u003e\u003coutgoing\u003eFlow_1yeg68u\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1yeg68u\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_5\"/\u003e\u003csequenceFlow id=\"Flow_0kny2mn\" name=\"if_results_returned\" sourceRef=\"ConditionPoint_2\" targetRef=\"ServiceTask_3\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"if_results_returned\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"results = playbook.functions.results.search_results\\nif results.get(\\\"success\\\"):\\n  result = True\\nelse:\\n  result = False\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_016batd\" name=\"Else\" sourceRef=\"ConditionPoint_2\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_8d137863_56e4_4751_96aa_9cc6a01c515f\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_016batd\" id=\"Flow_016batd_di\"\u003e\u003comgdi:waypoint x=\"1272\" y=\"370\"/\u003e\u003comgdi:waypoint x=\"1510\" y=\"370\"/\u003e\u003comgdi:waypoint x=\"1510\" y=\"468\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"1391\" y=\"348\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0kny2mn\" id=\"Flow_0kny2mn_di\"\u003e\u003comgdi:waypoint x=\"1150\" y=\"396\"/\u003e\u003comgdi:waypoint x=\"1150\" y=\"468\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"82\" x=\"1109\" y=\"416\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1yeg68u\" id=\"Flow_1yeg68u_di\"\u003e\u003comgdi:waypoint x=\"1510\" y=\"552\"/\u003e\u003comgdi:waypoint x=\"1510\" y=\"760\"/\u003e\u003comgdi:waypoint x=\"1216\" y=\"760\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0p90k7b\" id=\"Flow_0p90k7b_di\"\u003e\u003comgdi:waypoint x=\"1150\" y=\"692\"/\u003e\u003comgdi:waypoint x=\"1150\" y=\"734\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vgp7uu\" id=\"Flow_1vgp7uu_di\"\u003e\u003comgdi:waypoint x=\"1150\" y=\"552\"/\u003e\u003comgdi:waypoint x=\"1150\" y=\"608\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mrs5vn\" id=\"Flow_1mrs5vn_di\"\u003e\u003comgdi:waypoint x=\"1150\" y=\"292\"/\u003e\u003comgdi:waypoint x=\"1150\" y=\"344\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vvbahh\" id=\"Flow_1vvbahh_di\"\u003e\u003comgdi:waypoint x=\"1150\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"1150\" y=\"208\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"1059\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1052\" y=\"208\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_2\" id=\"ConditionPoint_2_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"1028\" y=\"344\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1052\" y=\"468\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1052\" y=\"608\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_5\" id=\"EndPoint_5_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"1084\" y=\"734\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1412\" y=\"468\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1691578418379,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
      "description": {
        "content": "updates the value of a DN\u0027s attribute with the given value(s)",
        "format": "text"
      },
      "display_name": "Example: LDAP Utilities: Update (PB)",
      "export_key": "example_ldap_utilities_update",
      "field_type_handle": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
      "fields_type": {
        "actions": [],
        "display_name": "Example: LDAP Utilities: Update (PB)",
        "export_key": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
        "fields": {
          "ldap_attribute_update_value": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f/ldap_attribute_update_value",
            "hide_notification": false,
            "id": 4718,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_attribute_update_value",
            "operation_perms": {},
            "operations": [],
            "placeholder": "[\u0027081111111\u0027]",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Attribute Update Value",
            "tooltip": "A string respresentation of a list of values",
            "type_id": 1087,
            "uuid": "b3bd8981-29e4-42c4-acc7-ed500c688854",
            "values": []
          },
          "ldap_domain_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f/ldap_domain_name",
            "hide_notification": false,
            "id": 4719,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_domain_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "Domain1",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Domain Name",
            "tooltip": "Domain name label given to server in app.config",
            "type_id": 1087,
            "uuid": "bd59fc5a-6fe1-475c-8315-acfa55547420",
            "values": []
          },
          "ldap_search_base": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f/ldap_search_base",
            "hide_notification": false,
            "id": 4720,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_search_base",
            "operation_perms": {},
            "operations": [],
            "placeholder": "DC=dev,DC=example,DC=com",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Search Base",
            "tooltip": "Search base",
            "type_id": 1087,
            "uuid": "a14c81e4-d368-43d4-acd2-57ee5ed7eab3",
            "values": []
          },
          "ldap_update_attribute_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f/ldap_update_attribute_name",
            "hide_notification": false,
            "id": 4721,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "ldap_update_attribute_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "homePhone",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "LDAP Update Attribute Name",
            "tooltip": "Name of an attribute to update",
            "type_id": 1087,
            "uuid": "09102b13-d16e-4b21-a993-9df343dfbde9",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
        "uuid": "c1a5e600-1e99-4354-8078-d6c4c8d9f232"
      },
      "has_logical_errors": false,
      "id": 75,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 42,
        "name": "f@example.com",
        "type": "user"
      },
      "last_modified_time": 1691578419023,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1691578418581,
          "description": "",
          "enabled": false,
          "export_key": "post-process",
          "id": 97,
          "language": "python3",
          "last_modified_by": "f@example.com",
          "last_modified_time": 1691578418606,
          "name": "post-process",
          "object_type": "artifact",
          "playbook_handle": "example_ldap_utilities_update",
          "programmatic_name": "example_ldap_utilities_update_post_process",
          "script_text": "results = playbook.functions.results.update_results\ncontent = results.get(\"content\", {})\n# If the function is successful in updating the value of the attribute, a note is added to the incident\nif results.get(\"success\"):\n  noteText = f\"\"\"\u003cbr\u003e\u003ci style=\"color: #979ca3\"\u003e LDAP Utilities: Update workflow \u003cu\u003ecomplete\u003c/u\u003e:\u003c/i\u003e\n                An LDAP Attribute has been updated\n                \u003cb\u003eAttribute:\u003c/b\u003e {content.get(\u0027attribute_name\u0027)}\n                \u003cb\u003eNew Value(s):\u003c/b\u003e {content.get(\u0027attribute_values\u0027)}\n                \u003cb\u003eDN:\u003c/b\u003e \u0027{content.get(\u0027user_dn\u0027)}\u0027\"\"\"\n\n  incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "6f9f4889-3741-4a88-80c5-416da6ed45bf"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Recipient"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "Email Sender"
            },
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "String"
            }
          ],
          "logic_type": "any"
        },
        "view_items": [
          {
            "content": "bd59fc5a-6fe1-475c-8315-acfa55547420",
            "element": "field_uuid",
            "field_type": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a14c81e4-d368-43d4-acd2-57ee5ed7eab3",
            "element": "field_uuid",
            "field_type": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "09102b13-d16e-4b21-a993-9df343dfbde9",
            "element": "field_uuid",
            "field_type": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "b3bd8981-29e4-42c4-acc7-ed500c688854",
            "element": "field_uuid",
            "field_type": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "example_ldap_utilities_update",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_8d137863-56e4-4751-96aa-9cc6a01c515f",
        "id": 78,
        "name": "playbook_8d137863_56e4_4751_96aa_9cc6a01c515f",
        "type": "playbook",
        "uuid": "dfd48181-220b-4650-b4bd-43a42b7dfa26"
      },
      "tags": [],
      "type": "default",
      "uuid": "8d137863-56e4-4751-96aa-9cc6a01c515f",
      "version": 4
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [
    {
      "actions": [],
      "created_date": 1691578413539,
      "description": "",
      "enabled": false,
      "export_key": "No search results",
      "id": 90,
      "language": "python3",
      "last_modified_by": "f@example.com",
      "last_modified_time": 1691578413558,
      "name": "No search results",
      "object_type": "artifact",
      "playbook_handle": null,
      "programmatic_name": "example_ldap_utilities_toggle_access_no_search_results",
      "script_text": "incident.addNote(f\"No entries found for {artifact.value}\")",
      "tags": [],
      "uuid": "4546bfdd-a324-47b2-9f14-0b6a466374e8"
    }
  ],
  "server_version": {
    "build_number": 7899,
    "major": 45,
    "minor": 0,
    "version": "45.0.7899"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "LDAP Query results",
      "export_key": "ldap_query_results",
      "fields": {
        "email_address": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "ldap_query_results/email_address",
          "hide_notification": false,
          "id": 4675,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "email_address",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Email address",
          "tooltip": "",
          "type_id": 1080,
          "uuid": "398592cb-4d52-473e-926f-32c7d12ca11c",
          "values": [],
          "width": 132
        },
        "fullname": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "ldap_query_results/fullname",
          "hide_notification": false,
          "id": 4676,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "fullname",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Fullname",
          "tooltip": "",
          "type_id": 1080,
          "uuid": "b469d0fe-ab32-4100-bba5-9d40212fd127",
          "values": [],
          "width": 113
        },
        "surname": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "ldap_query_results/surname",
          "hide_notification": false,
          "id": 4677,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "surname",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Surname",
          "tooltip": "",
          "type_id": 1080,
          "uuid": "595f9641-46c6-485d-8005-8af98eb2a96c",
          "values": [],
          "width": 113
        },
        "telephone_number": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "ldap_query_results/telephone_number",
          "hide_notification": false,
          "id": 4678,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "telephone_number",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Telephone Number",
          "tooltip": "",
          "type_id": 1080,
          "uuid": "26e46025-166c-4505-a051-dee46e16df98",
          "values": [],
          "width": 172
        },
        "uid": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "ldap_query_results/uid",
          "hide_notification": false,
          "id": 4679,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "uid",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "UID",
          "tooltip": "",
          "type_id": 1080,
          "uuid": "94595e20-41c8-4e37-adff-70e949aa8ddc",
          "values": [],
          "width": 113
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "ldap_query_results",
      "uuid": "edf0fcb2-77d3-433d-8143-10588b6a3948"
    }
  ],
  "workflows": [],
  "workspaces": []
}
