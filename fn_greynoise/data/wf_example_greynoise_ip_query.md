<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Example: GreyNoise IP Query

## Function - GreyNoise IP Query

### API Name
`greynoise_ip_query`

### Output Name
`None`

### Message Destination
`fn_greynoise`

### Pre-Processing Script
```python
inputs.greynoise_value = artifact.value
```

### Post-Processing Script
```python
if results['success']:
  note = """<div>Seen: <b>{}</b></div>
<div>IP: <b>{}</b></div>
<div>Classification: <b>{}</b></div>
<div>Tags: <b>{}</b></div>
<div>First seen: <b>{}</b></div>
<div>Last seen: <b>{}</b></div>
<div>Reverse DNS: <b>{}</b></div>""".format('True' if results.content['seen'] else 'False', results.content['ip'], results.content.get('classification'), 
                                          str(results.content.get('tags')), 
                                          results.content.get('first_seen'), results.content.get('last_seen'),
                                          results.content.get('metadata', {}).get('rdns'))
  if results.content.get('code'):
    code_lookup = { 
      "0x00": "Never Observed",
      "0x01": "Observed",
      "0x02": "Observed, but incomplete",
      "0x03": "Adjacent to another observed",
      "0x04": "Reserved",
      "0x05": "Commonly Spoofed",
      "0x06": "Noise",
      "0x07": "Invalid setting",
      "0x08": "Not observed in last 60 days"
    }
    note = note + "<div>Code: <b>{}</b></div>".format(code_lookup[results.content['code']])
  incident.addNote(helper.createRichText(note))
else:
  incident.addNote(str(results.content))

"""
{'content': {'code': '0x01', 'ip': '23.129.64.159', 'noise': True}, 'success': True}
{
  'content': {
    'classification': 'malicious',
    'tags': [
      'CHINANET SSH Bruteforcer',
      'Go SSH Scanner',
      'HNAP Crawler',
      'HTTP Alt Scanner',
      'Nmap',
      'SSH Bruteforcer',
      'SSH Scanner',
      'SSH Worm',
      'TLS/SSL Crawler',
      'Tor',
      'VNC Bruteforcer',
      'VNC Scanner',
      'Web Crawler',
      'Web Scanner'
    ],
    'ip': u'23.129.64.159',
    'actor': 'unknown',
    'raw_data': {
      'web': {
        'paths': [
          '/HNAP1/'
        ],
        'useragents': [
          'Mozilla/5.0 (Windows NT 5.1; rv:9.0.1) Gecko/20100101 Firefox/9.0.1'
        ]
      },
      'ja3': [
        {
          'port': 443,
          'fingerprint': '95d6f221c32953590c3a85cbee0d9e61'
        },
        {
          'port': 8443,
          'fingerprint': '97f7c02d49f8b261f4b7157e38945459'
        },
        {
          'port': 10000,
          'fingerprint': '0d85f6adde9dc6aa98804d6cfa2f90c1'
        },
        {
          'port': 8080,
          'fingerprint': 'ac8cb78cabd066a9ce1e90848a0ba5d9'
        }
      ],
      'scan': [
        {
          'protocol': 'TCP',
          'port': 22
        },
        {
          'protocol': 'TCP',
          'port': 443
        },
        {
          'protocol': 'TCP',
          'port': 1027
        },
        {
          'protocol': 'TCP',
          'port': 1028
        },
        {
          'protocol': 'TCP',
          'port': 5000
        },
        {
          'protocol': 'TCP',
          'port': 5800
        },
        {
          'protocol': 'TCP',
          'port': 5900
        },
        {
          'protocol': 'TCP',
          'port': 5905
        },
        {
          'protocol': 'TCP',
          'port': 8000
        },
        {
          'protocol': 'TCP',
          'port': 8080
        },
        {
          'protocol': 'TCP',
          'port': 8443
        },
        {
          'protocol': 'TCP',
          'port': 10000
        },
        {
          'protocol': 'TCP',
          'port': 32768
        },
        {
          'protocol': 'TCP',
          'port': 41798
        },
        {
          'protocol': 'TCP',
          'port': 43719
        },
        {
          'protocol': 'TCP',
          'port': 49152
        },
        {
          'protocol': 'TCP',
          'port': 49153
        },
        {
          'protocol': 'TCP',
          'port': 49154
        },
        {
          'protocol': 'TCP',
          'port': 49157
        }
      ]
    },
    'seen': True,
    'first_seen': '2019-04-23',
    'metadata': {
      'category': 'business',
      'city': 'Seattle',
      'tor': True,
      'country': 'United States',
      'country_code': 'US',
      'organization': 'Emerald Onion',
      'os': 'FreeBSD',
      'asn': 'AS396507'
    },
    'last_seen': '2019-10-10'
  },
  'success': True
}
"""
```

---

