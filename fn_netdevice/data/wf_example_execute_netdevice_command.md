<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: Execute Netdevice Commands

## Function - fn_netdevice_query

### API Name
`fn_netdevice_query`

### Output Name
``

### Message Destination
`fn_netdevice`

### Pre-Processing Script
```python
inputs.netdevice_ids = rule.properties.device_ids
inputs.netdevice_send_cmd = rule.properties.send_command
inputs.netdevice_use_textfsm = rule.properties.use_textfsm_template
```

### Post-Processing Script
```python
import re

pp = '(\\x1b\[\w*\d*(;\d*)*m)'

note = u""
for host in results['content']:
  note = note + u"Host: {}\n".format(host)
  if results['content'][host].get('send_result') and isinstance(results['content'][host]['send_result'], list):
    note = note + u"Cmd: {}\nResult: {}\n".format(results['content'][host]['send_command'], results['content'][host]['send_result'])
  else:
    note = note + u"Cmd: {}\nResult: {}\n".format(results['content'][host]['send_command'], re.sub(pp, '', results['content'][host].get('send_result', '')))
  
  if results['content'][host]['status'] == 'failure':
    note = note + u"Failure: {}\n".format(results['content'][host]['reason'])
    
  note = note + "\n"
    
note_text = helper.createPlainText(note)
incident.addNote(note_text)
```

---

