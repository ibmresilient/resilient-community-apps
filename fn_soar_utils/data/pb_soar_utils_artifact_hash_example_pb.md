<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - SOAR Utils: Artifact Hash- Example (PB)

### API Name
`soar_utils_artifact_hash_example_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.attachment has_a_value`

### Object Type
`artifact`

### Description
An example playbook that calculates hash from an artifact attachment.


---
## Function - SOAR Utilities Artifact Hash

### API Name
`soar_utils_artifact_hash`

### Output Name
`artifact_hash_result`

### Message Destination
`fn_soar_utils`

### Function-Input Script
```python
inputs.incident_id = incident.id
inputs.artifact_id = artifact.id
```

---

## Local script - SOAR Utils: calculate hash from an artifact attachment

### Description
Calculate hash from an artifact attachment.

### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
results = playbook.functions.results.artifact_hash_result
file_name = str(results.get("filename", ""))
artifact_value = artifact.value

hash_types = {
    "sha256": "Malware SHA-256 Hash",
    "sha1": "Malware SHA-1 Hash",
    "md5": "Malware MD5 Hash"
}

success = False

for hash_key, artifact_type in hash_types.items():
    hash_value = results.get(hash_key)
    if hash_value:
        incident.addArtifact(artifact_type, hash_value, f"{hash_key.upper()} hash of '{artifact_value}'")
        note_text = f"<b>SOAR Utils: Artifact Hash - Example (PB)</b> File {file_name} converted to {hash_key.upper()} successfully."
        incident.addNote(note_text)
        success = True

if not success:
    note_text = f"<b>SOAR Utils: Artifact Hash - Example (PB)</b> Failed: {results.get('reason', 'Unknown reason')}"
    incident.addNote(note_text)


```

---

