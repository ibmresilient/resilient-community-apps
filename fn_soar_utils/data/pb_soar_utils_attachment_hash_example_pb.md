<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - SOAR Utils: Attachment Hash- Example (PB)

### API Name
`soar_utils_attachment_hash_example_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Object Type
`attachment`

### Description
An example playbook that calculates hash from an attachment.


---
## Function - SOAR Utilities: Attachment Hash

### API Name
`soar_utils_attachment_hash`

### Output Name
`attachment_hash_result`

### Message Destination
`fn_soar_utils`

### Function-Input Script
```python
inputs.incident_id = incident.id
inputs.attachment_id = attachment.id

# If this is a "task attachment" then we will additionally have a task-id
if task is not None:
  inputs.task_id = task.id
```

---

## Local script - SOAR Utils: calculate hash from an attachment

### Description
Calculate hash from an attachment.

### Script Type
`Local script`

### Object Type
`attachment`

### Script Content
```python
results = playbook.functions.results.attachment_hash_result
file_name = str(results.get("filename", ""))
attachment_name = attachment.name

hash_types = {
    "sha256": "Malware SHA-256 Hash",
    "sha1": "Malware SHA-1 Hash",
    "md5": "Malware MD5 Hash"
}

success = False

for hash_key, artifact_type in hash_types.items():
    hash_value = results.get(hash_key)
    if hash_value:
        incident.addArtifact(artifact_type, hash_value, f"{hash_key.upper()} hash of '{attachment_name}'")
        note_text = f"<b>SOAR Utils: Attachment Hash - Example (PB)</b> File {file_name} converted to {hash_key.upper()} successfully."
        incident.addNote(note_text)
        success = True

if not success:
    note_text = f"<b>SOAR Utils: Attachment Hash - Example (PB)</b> Failed: {results.get('reason', 'Unknown reason')}"
    incident.addNote(note_text)


```

---

