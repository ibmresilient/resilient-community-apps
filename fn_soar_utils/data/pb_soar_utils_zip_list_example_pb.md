<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - SOAR Utils: Zip List - Example (PB)

### API Name
`soar_utils_zip_list_example_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`attachment.name contains .zip`

### Object Type
`attachment`

### Description
An example playbook showing how to list the contents of a ZIP file attachment.


---
## Function - SOAR Utilities: Attachment Zip List

### API Name
`soar_utils_attachment_zip_list`

### Output Name
`zip_list_result`

### Message Destination
`fn_soar_utils`

### Function-Input Script
```python
inputs.incident_id = incident.id
inputs.attachment_id = attachment.id

# If this is a "task attachment" then we will additionally have a task-id
if task is not None:
  inputs.task_id = task.id
```

---

## Local script - SOAR Utils: Display content of Zip file

### Description
Display the content of zip file.

### Script Type
`Local script`

### Object Type
`attachment`

### Script Content
```python
results = playbook.functions.results.zip_list_result

# Note with the list of filenames in the ZIP
namelist_html = (
    f"<div><p><b>SOAR Utils: Zip List - Example (PB):</b></p>"
    f"<p><b>Contents of {attachment.name}:</b></p>"
)
namelist_html += "".join(f"{filename}<br>" for filename in results.namelist)
namelist_html += "</div>"

incident.addNote(namelist_html)

# Note with detailed information for each file in the ZIP
infolist_html = (
    f"<div><p><b>SOAR Utils: Zip List - Example (PB):</b></p>"
    f"<p><b>Detailed contents of {attachment.name}:</b></p>"
)
for fileinfo in results.infolist:
    filename = fileinfo.get("filename", "Unknown")
    file_size = fileinfo.get("file_size", "N/A")
    compress_size = fileinfo.get("compress_size", "N/A")
    comment = fileinfo.get("comment", "")
    
    infolist_html += (
        f"{filename} ({file_size} bytes, {compress_size} compressed) {comment}<br>"
    )
infolist_html += "</div>"

incident.addNote(infolist_html)

```

---

