<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# (Example) NetWitness Retrieve PCAP File

## Function - NetWitness Query

### API Name
`netwitness_query`

### Output Name
`nw_query`

### Message Destination
`rsa_netwitness_message_destination`

### Pre-Processing Script
```python
inputs.nw_query = rule.properties.netwitness_query
```

### Post-Processing Script
```python
None
```

---

## Function - NetWitness Retrieve PCAP Data

### API Name
`netwitness_retrieve_pcap_data`

### Output Name
``

### Message Destination
`rsa_netwitness_message_destination`

### Pre-Processing Script
```python
# Pull session IDs out of results and convert into comma seperated string
session_id_list = [str(workflow.properties.nw_query.content.results.id1), str(workflow.properties.nw_query.content.results.id2)]
session_id_str = ", ".join(session_id_list)

inputs.nw_event_session_ids = session_id_str
inputs.incident_id = incident.id
```

### Post-Processing Script
```python
incident.addNote("Added PCAP file for sessions {} as an attachment to the Incident.".format(results.inputs.nw_event_session_ids))
```

---

