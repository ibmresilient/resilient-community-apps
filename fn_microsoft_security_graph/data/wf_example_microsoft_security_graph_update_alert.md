<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example: Microsoft Security Graph Update Alert

## Function - Microsoft Security Graph Update Alert

### API Name
`microsoft_security_graph_update_alert`

### Output Name
``

### Message Destination
`microsoft_security_graph_message_destination`

### Pre-Processing Script
```python
import java.util.Date as Date

inputs.microsoft_security_graph_alert_id = incident.properties.microsoft_security_graph_alert_id

assignedTo = rule.properties.microsoft_security_graph_alert_assignedto if rule.properties.microsoft_security_graph_alert_assignedto else ""

closedDateTime = ""
if rule.properties.microsoft_security_graph_alert_closeddatetime:
  time_stamp = rule.properties.microsoft_security_graph_alert_closeddatetime
  epoch_time = Date(time_stamp)
  closedDateTime = "\"closedDateTime\": \"{0}\",".format(str(epoch_time.toInstant()))
  
comment = rule.properties.microsoft_security_graph_alert_comment if rule.properties.microsoft_security_graph_alert_comment else ""

feedback = ""
if rule.properties.microsoft_security_graph_alert_feedback:
  feedback = rule.properties.microsoft_security_graph_alert_feedback
elif workflow.properties.msg_alert_details.content.feedback:
  feedback = workflow.properties.msg_alert_details.content.feedback

status = rule.properties.microsoft_security_graph_alert_status if rule.properties.microsoft_security_graph_alert_status else workflow.properties.msg_alert_details.content.status
tags = rule.properties.microsoft_security_graph_alert_tags if rule.properties.microsoft_security_graph_alert_tags else ""

provider = workflow.properties.msg_alert_details.content.vendorInformation.provider
vendor = workflow.properties.msg_alert_details.content.vendorInformation.vendor

all_comments = [""]
if workflow.properties.msg_alert_details.content.comments:
  all_comments = list(workflow.properties.msg_alert_details.content.comments)
all_comments = all_comments + [comment]

all_tags = [""]
if workflow.properties.msg_alert_details.content.tags:
  all_tags = workflow.properties.msg_alert_details.content.tags
all_tags = all_tags + [tags]

#["{5}"]
data = u'''{{
        "assignedTo": "{0}",
        {1}
        "comments": {2},
        "feedback": "{3}",
        "status": "{4}",
        "tags": {5},
        "vendorInformation":
        {{
            "provider": "{6}",
            "vendor": "{7}"
        }}
    }}'''.format(assignedTo, closedDateTime, all_comments, feedback, status, all_tags, provider, vendor)

inputs.microsoft_security_graph_alert_data = data
```

### Post-Processing Script
```python
# Put the results json into a workflow property so we can call the
# convert_json_to_rich_text script to print readable formatted json in an incident note.
json_note = {"version": "1.0.",
             "header": "Microsoft Security Graph Update Alert",
             "json": results.content}

workflow.addProperty('convert_json_to_rich_text', json_note)
```

---

## Function - Microsoft Security Graph Get Alert Details

### API Name
`microsoft_security_graph_get_alert_details`

### Output Name
`msg_alert_details`

### Message Destination
`microsoft_security_graph_message_destination`

### Pre-Processing Script
```python
inputs.microsoft_security_graph_alert_id = incident.properties.microsoft_security_graph_alert_id
```

### Post-Processing Script
```python
None
```

---

