<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example Send Task Email HTML2

## Function - Outbound Email: Send Email 2

### API Name
`send_email2`

### Output Name
`outbound_email_results`

### Message Destination
`email_outbound`

### Pre-Processing Script
```python
import hashlib
import time
from datetime import datetime

MESSAGE_ID_DOMAIN = "qradarsoar.ibm.com"

inputs.mail_from = rule.properties.mail_from
if rule.properties.get('mail_message_id'):
  # generate a message-id
  seed_value = str(int(time.time()*1000))
  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()
  msg_id = "{}-{}-{}-{}-{}".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])
  inputs.mail_message_id = "{}@{}".format(msg_id, MESSAGE_ID_DOMAIN)
  
if rule.properties.mail_in_reply_to and incident.properties.email_message_id:
  inputs.mail_in_reply_to = incident.properties.email_message_id
  
if rule.properties.get('mail_importance'):
  inputs.mail_importance = rule.properties.mail_importance if rule.properties.mail_importance else None
  
inputs.mail_to = rule.properties.mail_to
inputs.mail_cc = rule.properties.mail_cc
inputs.mail_attachments = rule.properties.mail_attachments
inputs.mail_incident_id = incident.id
inputs.mail_subject = u"[{0}] {1} Task: {2}".format(incident.id, incident.name, task.name)

creation_date = datetime.fromtimestamp( incident.create_date/1000)
type_ids = u", ".join(incident.incident_type_ids)
sev_code = u"{}".format(incident.severity_code)
current_plan = u"{}".format(incident.plan_status)

if rule.properties.get('mail_template_select'):
  inputs.mail_template_label = rule.properties.mail_template_select
else:
  inputs.mail_inline_template = u"""
<h2>Incident Summary</h2>
    Severity Code: {0}
<br>
    Plan Status: {1}
<br>
    Created: {2}
<br>
    Incident Type: {3}
<br>
    Incident Link: <a target='_blank' href='{{{{ template_helper.generate_incident_url({5}) }}}}'>{5}</a>
<br>
    Task: <a target='_blank' href='{{{{ template_helper.generate_task_url({5},{6}) }}}}'>{4}</a>
<br>
    Instructions: 
<br>
{7}
""".format(sev_code, current_plan, creation_date, type_ids, task.name, incident.id, task.id, task.instructions.get("content") if task.instructions else '-')

```

### Post-Processing Script
```python
None
```

---

