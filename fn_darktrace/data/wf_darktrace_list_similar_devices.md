<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Darktrace: List Similar Devices

## Function - Darktrace: List Similar Devices

### API Name
`darktrace_list_similar_devices`

### Output Name
`None`

### Message Destination
`fn_darktrace`

### Pre-Processing Script
```python
inputs.darktrace_device_id = row.darktrace_device_dt_id.get("content")
inputs.darktrace_device_count = rule.properties.darktrace_device_count
```

### Post-Processing Script
```python
URL_FORMATTER = "<a target='_blank' href='{0}'>{1}</a>"

if results.success:
  original_device = results.inputs.get("darktrace_device_id")
  similar_devices_list = results.content.get("similar_devices")
  if similar_devices_list:
    link_base = results.content.get("base_url") + "/#device/"
    device_ids = [str(device.get("did")) for device in similar_devices_list]
    similar_devices = ", ".join(URL_FORMATTER.format(link_base + device, device) for device in device_ids)
    
    incident.addNote("Found {0} device(s) similar to device {1}: {2}".format(len(similar_devices_list), original_device, similar_devices))
  else:
    incident.addNote("No similar devices found for device {0}".format(original_device))
else:
  incident.addNote("Failed to list similar devices for device {0}. Error: {1}".format(original_device, results.reason))
```

---

