{"groups": null, "locale": null, "workflows": [{"description": "Create an MISP event attribute based on an artifact value. This only works on incidents already submitted to MISP.", "workflow_id": 421, "tags": [], "object_type": "artifact", "export_key": "example_misp_create_attribute", "uuid": "1efb0442-b486-4cb2-a3cc-5f2e5fb83aa4", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_create_attribute\" isExecutable=\"true\" name=\"Example: MISP Create Attribute\"><documentation>Create an MISP event attribute based on an artifact value. This only works on incidents already submitted to MISP.</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_0gg7h6t</outgoing></startEvent><serviceTask id=\"ServiceTask_0vgvbl2\" name=\"MISP Create Attribute\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"f5c4aae2-135e-41ac-8bbc-082b00677ecb\">{\"inputs\":{},\"post_processing_script\":\"# Result: {'success': True, 'content': [{'Attribute': {'id': '3', 'event_id': '3', 'object_id': '0', 'object_relation': None, 'category': 'Network activity', 'type': 'ip-dst', 'value1': '8.8.8.8', 'value2': '', 'to_ids': False, 'uuid': '666a6890-fddd-4a5d-a474-22c85c6a1ce5', 'timestamp': '1553352781', 'distribution': '5', 'sharing_group_id': '0', 'comment': '', 'deleted': False, 'disable_correlation': False, 'value': '8.8.8.8'}}]}\\n# Result: {'success': True, 'content': [{'name': 'Could not add Attribute', 'message': 'Could not add Attribute', 'url': '/attributes/add', 'errors': {'value': ['A similar attribute already exists for this event.']}}]}\\nexisting_description = artifact.description.content+'\\\\n' if artifact.description else \\\"\\\"\\n\\nif results.content[0].get('errors'):\\n  artifact.description = u\\\"{}MISP Attribute failure: {}\\\".format(existing_description, results.content[0]['errors']['value'])\\nelse:\\n  artifact.description = u\\\"{}MISP Attribute created: {}\\\".format(existing_description, results.content[0]['Attribute']['category'])\",\"pre_processing_script\":\"inputs.misp_attribute_value = artifact.value\\ninputs.misp_event_id = incident.properties.misp_event_id\\n\\n\\nresilient_to_misp_map = { \\n    \\\"DNS Name\\\": \\\"domain\\\",\\n    \\\"Email Attachment\\\": \\\"email-attachment\\\",\\n    \\\"Email Body\\\": \\\"email-body\\\",\\n    \\\"Email Recipient\\\": \\\"email-dst\\\",\\n    \\\"Email Sender\\\": \\\"email-src\\\",\\n    \\\"Email subject\\\": \\\"email-subject\\\",\\n    \\\"File Name\\\": \\\"filename\\\",\\n    \\\"DNS Name\\\": \\\"hostname\\\",\\n    \\\"MAC Address\\\": \\\"mac-address\\\",\\n    \\\"Malware MD5 Hash\\\": \\\"md5\\\",\\n    \\\"Port\\\": \\\"port\\\",\\n    \\\"Malware SHA-1 Hash\\\": \\\"sha1\\\",\\n    \\\"Malware SHA-256 Hash\\\": \\\"sha256\\\",\\n    \\\"URI Path\\\": \\\"uri\\\",\\n    \\\"URL\\\": \\\"url\\\",\\n    \\\"Threat CVE ID\\\": \\\"vulnerability\\\",\\n    \\\"IP Address\\\": \\\"ip-dst\\\"\\n}\\n\\ntry:\\n  misp_type = resilient_to_misp_map[artifact.type]\\n  inputs.misp_attribute_type = misp_type\\nexcept Exception, e:\\n  helper.fail(u\\\"You do not have this artifact type {} mapped to a type in MISP - Ask your Admin\\\".format(artifact.value))\\n  raise e \\n\\n\"}</resilient:function></extensionElements><incoming>SequenceFlow_0gg7h6t</incoming><outgoing>SequenceFlow_17ot1aj</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_0gg7h6t\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_0vgvbl2\"/><endEvent id=\"EndEvent_0wdicne\"><incoming>SequenceFlow_17ot1aj</incoming></endEvent><sequenceFlow id=\"SequenceFlow_17ot1aj\" sourceRef=\"ServiceTask_0vgvbl2\" targetRef=\"EndEvent_0wdicne\"/><textAnnotation id=\"TextAnnotation_0okuf3v\"><text>Updates the artifact description with results of the operation</text></textAnnotation><association id=\"Association_12wl9ri\" sourceRef=\"ServiceTask_0vgvbl2\" targetRef=\"TextAnnotation_0okuf3v\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_0vgvbl2\" id=\"ServiceTask_0vgvbl2_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"275\" y=\"166\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0gg7h6t\" id=\"SequenceFlow_0gg7h6t_di\"><omgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"275\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"236.5\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_0wdicne\" id=\"EndEvent_0wdicne_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"429\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"447\" y=\"227\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_17ot1aj\" id=\"SequenceFlow_17ot1aj_di\"><omgdi:waypoint x=\"375\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"429\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"402\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_0okuf3v\" id=\"TextAnnotation_0okuf3v_di\"><omgdc:Bounds height=\"67\" width=\"270\" x=\"356\" y=\"83\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_12wl9ri\" id=\"Association_12wl9ri_di\"><omgdi:waypoint x=\"375\" xsi:type=\"omgdc:Point\" y=\"179\"/><omgdi:waypoint x=\"429\" xsi:type=\"omgdc:Point\" y=\"150\"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_create_attribute", "version": 1}, "creator_id": "integrations@example.com", "last_modified_by": "integrations@example.com", "last_modified_time": 1556810630196, "content_version": 1, "programmatic_name": "example_misp_create_attribute", "name": "Example: MISP Create Attribute"}, {"description": "Identify other MISP events with the same attribute", "workflow_id": 423, "tags": [], "object_type": "artifact", "export_key": "example_misp_search_attribute", "uuid": "5067cc2b-4022-46fb-ae30-28ddce334ac8", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_search_attribute\" isExecutable=\"true\" name=\"Example: MISP Search Attribute\"><documentation>Identify other MISP events with the same attribute</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_0afh11q</outgoing></startEvent><serviceTask id=\"ServiceTask_0heg8h6\" name=\"MISP Search Attribute\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"c248bc7c-b60f-4d36-9a2e-294ee78a5981\">{\"inputs\":{},\"post_processing_script\":\"# Result: {\\\"response\\\": {\\\"Attribute\\\": [{\\\"id\\\":\\\"3\\\",\\\"event_id\\\":\\\"3\\\",\\\"object_id\\\":\\\"0\\\",\\\"object_relation\\\":null,\\\"category\\\":\\\"Network activity\\\",\\\"type\\\":\\\"ip-dst\\\",\\\"to_ids\\\":false,\\\"uuid\\\":\\\"666a6890-fddd-4a5d-a474-22c85c6a1ce5\\\",\\\"timestamp\\\":\\\"1553352781\\\",\\\"distribution\\\":\\\"5\\\",\\\"sharing_group_id\\\":\\\"0\\\",\\\"comment\\\":\\\"\\\",\\\"deleted\\\":false,\\\"disable_correlation\\\":false,\\\"value\\\":\\\"8.8.8.8\\\",\\\"Event\\\":{\\\"org_id\\\":\\\"1\\\",\\\"distribution\\\":\\\"0\\\",\\\"id\\\":\\\"3\\\",\\\"info\\\":\\\"misp\\\",\\\"orgc_id\\\":\\\"1\\\",\\\"uuid\\\":\\\"5c96443b-1dcc-42fc-910a-01afac110002\\\"}}]}}\\nexisting_description = artifact.description.content+'\\\\n' if artifact.description else \\\"\\\"\\n\\nif not results.success:\\n  artifact.description = u\\\"{}No matching attribute found\\\".format(existing_description)\\nelse:\\n  matched = []\\n  for match in results.content:\\n      matched.append(u\\\"Event: {}, ID: {}, Tags: {}\\\".format(match['Event']['info'], match['Event']['id'], results.tags))\\n\\n  artifact.description = u\\\"{} Attribute Search Matches:\\\\n {}\\\".format(existing_description, '\\\\n'.join(matched))\",\"pre_processing_script\":\"inputs.misp_attribute_value = artifact.value\"}</resilient:function></extensionElements><incoming>SequenceFlow_0afh11q</incoming><outgoing>SequenceFlow_0ha7d1u</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_0afh11q\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_0heg8h6\"/><endEvent id=\"EndEvent_0k4iuta\"><incoming>SequenceFlow_0ha7d1u</incoming></endEvent><sequenceFlow id=\"SequenceFlow_0ha7d1u\" sourceRef=\"ServiceTask_0heg8h6\" targetRef=\"EndEvent_0k4iuta\"/><textAnnotation id=\"TextAnnotation_1kxxiyt\"><text>Start your workflow here</text></textAnnotation><association id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/><textAnnotation id=\"TextAnnotation_01w1sk7\"><text>The artifact description is appended with the search results</text></textAnnotation><association id=\"Association_1xmpfxo\" sourceRef=\"ServiceTask_0heg8h6\" targetRef=\"TextAnnotation_01w1sk7\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"><omgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"><omgdi:waypoint x=\"169\" xsi:type=\"omgdc:Point\" y=\"220\"/><omgdi:waypoint x=\"153\" xsi:type=\"omgdc:Point\" y=\"254\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"ServiceTask_0heg8h6\" id=\"ServiceTask_0heg8h6_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"281\" y=\"166\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0afh11q\" id=\"SequenceFlow_0afh11q_di\"><omgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"281\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"239.5\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_0k4iuta\" id=\"EndEvent_0k4iuta_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"467\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"485\" y=\"227\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0ha7d1u\" id=\"SequenceFlow_0ha7d1u_di\"><omgdi:waypoint x=\"381\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"467\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"424\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_01w1sk7\" id=\"TextAnnotation_01w1sk7_di\"><omgdc:Bounds height=\"63\" width=\"233\" x=\"364\" y=\"75\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1xmpfxo\" id=\"Association_1xmpfxo_di\"><omgdi:waypoint x=\"379\" xsi:type=\"omgdc:Point\" y=\"174\"/><omgdi:waypoint x=\"434\" xsi:type=\"omgdc:Point\" y=\"138\"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_search_attribute", "version": 31}, "creator_id": "integrations@example.com", "last_modified_by": "craig.roberts@uk.ibm.com", "last_modified_time": 1570544206819, "content_version": 31, "programmatic_name": "example_misp_search_attribute", "name": "Example: MISP Search Attribute"}, {"description": "Creates a tag on an attribute in MISP - such as TLP, MITRE Attack or Threat Actor", "workflow_id": 518, "tags": [], "object_type": "artifact", "export_key": "example_misp_create_tag_on_attribute", "uuid": "f60c4f10-0557-4b6a-b85f-3dca316baa3e", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_create_tag_on_attribute\" isExecutable=\"true\" name=\"Example: MISP Create Tag on Attribute\"><documentation>Creates a tag on an attribute in MISP - such as TLP, MITRE Attack or Threat Actor</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_0d4msev</outgoing></startEvent><serviceTask id=\"ServiceTask_1wr8txf\" name=\"MISP Create Tag\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"71d3fed2-0eec-49af-a418-8e8178e5a458\">{\"inputs\":{\"a201dc94-d7f0-4b09-9e9e-7c4ba5a7a5da\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"05c7115d-cf34-4da2-b04c-857394325938\"}}},\"pre_processing_script\":\"inputs.misp_attribute_value = artifact.value\\ninputs.misp_event_id = incident.properties.misp_event_id\\ninputs.misp_tag_name = \\\"tlp:white\\\"\"}</resilient:function></extensionElements><incoming>SequenceFlow_0d4msev</incoming><outgoing>SequenceFlow_14q7i19</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_0d4msev\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1wr8txf\"/><endEvent id=\"EndEvent_1qtida7\"><incoming>SequenceFlow_14q7i19</incoming></endEvent><sequenceFlow id=\"SequenceFlow_14q7i19\" sourceRef=\"ServiceTask_1wr8txf\" targetRef=\"EndEvent_1qtida7\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"268\" y=\"176\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"263\" y=\"211\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1wr8txf\" id=\"ServiceTask_1wr8txf_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"399\" y=\"154\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0d4msev\" id=\"SequenceFlow_0d4msev_di\"><omgdi:waypoint x=\"304\" xsi:type=\"omgdc:Point\" y=\"194\"/><omgdi:waypoint x=\"399\" xsi:type=\"omgdc:Point\" y=\"194\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"351.5\" y=\"172\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_1qtida7\" id=\"EndEvent_1qtida7_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"607\" y=\"176\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"625\" y=\"215\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_14q7i19\" id=\"SequenceFlow_14q7i19_di\"><omgdi:waypoint x=\"499\" xsi:type=\"omgdc:Point\" y=\"194\"/><omgdi:waypoint x=\"607\" xsi:type=\"omgdc:Point\" y=\"194\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"553\" y=\"172\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_create_tag_on_attribute", "version": 6}, "creator_id": "craig.roberts@uk.ibm.com", "last_modified_by": "craig.roberts@uk.ibm.com", "last_modified_time": 1570542332650, "content_version": 6, "programmatic_name": "example_misp_create_tag_on_attribute", "name": "Example: MISP Create Tag on Attribute"}, {"description": "Create a MISP Sighting from an artifact", "workflow_id": 420, "tags": [], "object_type": "artifact", "export_key": "example_misp_create_sighting", "uuid": "b90d1cc2-f1a4-4aa6-ab71-2dfaed5668f7", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_create_sighting\" isExecutable=\"true\" name=\"Example: MISP Create Sighting\"><documentation>Create a MISP Sighting from an artifact</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_1yawm45</outgoing></startEvent><serviceTask id=\"ServiceTask_0djokm5\" name=\"MISP Create Sighting\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"e9df792b-a3af-4d67-ae90-e48aabca138c\">{\"inputs\":{},\"post_processing_script\":\"# Result: {'success': True, 'content': {'message': 'Sighting added'}}\\nexisting_description = artifact.description.content+'\\\\n' if artifact.description else \\\"\\\"\\n\\n#if results.content[0].get('errors'):\\n#  artifact.description = u\\\"{}MISP Attribute failure: {}\\\".format(existing_description, results.content[0]['errors']['value'])\\n#else:\\nartifact.description = u\\\"{}MISP Attribute created: {}\\\".format(existing_description, results.content['message'])\",\"pre_processing_script\":\"\\n\\ninputs.misp_sighting = artifact.value\"}</resilient:function></extensionElements><incoming>SequenceFlow_1yawm45</incoming><outgoing>SequenceFlow_0xhc93t</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_1yawm45\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_0djokm5\"/><endEvent id=\"EndEvent_0tvhhum\"><incoming>SequenceFlow_0xhc93t</incoming></endEvent><sequenceFlow id=\"SequenceFlow_0xhc93t\" sourceRef=\"ServiceTask_0djokm5\" targetRef=\"EndEvent_0tvhhum\"/><textAnnotation id=\"TextAnnotation_04ong7g\"><text>The artifact description is updated with the result</text></textAnnotation><association id=\"Association_1r8l5rk\" sourceRef=\"ServiceTask_0djokm5\" targetRef=\"TextAnnotation_04ong7g\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_0djokm5\" id=\"ServiceTask_0djokm5_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"294\" y=\"166\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1yawm45\" id=\"SequenceFlow_1yawm45_di\"><omgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"294\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"246\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_0tvhhum\" id=\"EndEvent_0tvhhum_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"482\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"500\" y=\"227\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0xhc93t\" id=\"SequenceFlow_0xhc93t_di\"><omgdi:waypoint x=\"394\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"482\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"438\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_04ong7g\" id=\"TextAnnotation_04ong7g_di\"><omgdc:Bounds height=\"59\" width=\"204\" x=\"387\" y=\"81\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1r8l5rk\" id=\"Association_1r8l5rk_di\"><omgdi:waypoint x=\"392\" xsi:type=\"omgdc:Point\" y=\"174\"/><omgdi:waypoint x=\"445\" xsi:type=\"omgdc:Point\" y=\"140\"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_create_sighting", "version": 1}, "creator_id": "integrations@example.com", "last_modified_by": "integrations@example.com", "last_modified_time": 1556810630046, "content_version": 1, "programmatic_name": "example_misp_create_sighting", "name": "Example: MISP Create Sighting"}, {"description": "Creates a tag on an event in MISP - such as TLP, MITRE Attack or Threat Actor", "workflow_id": 519, "tags": [], "object_type": "incident", "export_key": "example_misp_create_tag_on_event", "uuid": "6b83e86b-d3c6-47b1-bd68-483cf84cff20", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_create_tag_on_event\" isExecutable=\"true\" name=\"Example: MISP Create Tag on Event\"><documentation>Creates a tag on an event in MISP - such as TLP, MITRE Attack or Threat Actor</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_1hntziy</outgoing></startEvent><serviceTask id=\"ServiceTask_1icn34r\" name=\"MISP Create Tag\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"71d3fed2-0eec-49af-a418-8e8178e5a458\">{\"inputs\":{\"a201dc94-d7f0-4b09-9e9e-7c4ba5a7a5da\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"56caee47-eded-45b5-b2dd-ce4c5a7dd1ae\"}}},\"pre_processing_script\":\"inputs.misp_tag_name = \\\"tlp:white\\\"\\n\\ninputs.misp_event_id = incident.properties.misp_event_id\"}</resilient:function></extensionElements><incoming>SequenceFlow_1hntziy</incoming><outgoing>SequenceFlow_1dknfic</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_1hntziy\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1icn34r\"/><endEvent id=\"EndEvent_15f8vdq\"><incoming>SequenceFlow_1dknfic</incoming></endEvent><sequenceFlow id=\"SequenceFlow_1dknfic\" sourceRef=\"ServiceTask_1icn34r\" targetRef=\"EndEvent_15f8vdq\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"242\" y=\"130\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"237\" y=\"165\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1icn34r\" id=\"ServiceTask_1icn34r_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"392\" y=\"108\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1hntziy\" id=\"SequenceFlow_1hntziy_di\"><omgdi:waypoint x=\"278\" xsi:type=\"omgdc:Point\" y=\"148\"/><omgdi:waypoint x=\"392\" xsi:type=\"omgdc:Point\" y=\"148\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"335\" y=\"126\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_15f8vdq\" id=\"EndEvent_15f8vdq_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"610\" y=\"130\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"628\" y=\"169\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1dknfic\" id=\"SequenceFlow_1dknfic_di\"><omgdi:waypoint x=\"492\" xsi:type=\"omgdc:Point\" y=\"148\"/><omgdi:waypoint x=\"610\" xsi:type=\"omgdc:Point\" y=\"148\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"551\" y=\"126\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_create_tag_on_event", "version": 6}, "creator_id": "craig.roberts@uk.ibm.com", "last_modified_by": "craig.roberts@uk.ibm.com", "last_modified_time": 1570542307872, "content_version": 6, "programmatic_name": "example_misp_create_tag_on_event", "name": "Example: MISP Create Tag on Event"}, {"description": "Find sightings associated with a given event", "workflow_id": 424, "tags": [], "object_type": "incident", "export_key": "example_misp_sighting_list", "uuid": "7886aa2a-7ea7-4d39-a57e-0b35a0669a1f", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_sighting_list\" isExecutable=\"true\" name=\"Example: MISP Sighting List\"><documentation>Find sightings associated with a given event</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_1nhn6ej</outgoing></startEvent><serviceTask id=\"ServiceTask_0kbrdrx\" name=\"MISP Sighting List\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"8b531827-741d-40e8-90a5-1ec99cb1710d\">{\"inputs\":{},\"post_processing_script\":\"content = results.content\\nincident.addNote(u\\\"Sightings for associated event.\\\\n{}\\\".format(content))\",\"pre_processing_script\":\"inputs.misp_event_id = incident.properties.misp_event_id\"}</resilient:function></extensionElements><incoming>SequenceFlow_1nhn6ej</incoming><outgoing>SequenceFlow_1atokox</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_1nhn6ej\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_0kbrdrx\"/><endEvent id=\"EndEvent_0yrp9ky\"><incoming>SequenceFlow_1atokox</incoming></endEvent><sequenceFlow id=\"SequenceFlow_1atokox\" sourceRef=\"ServiceTask_0kbrdrx\" targetRef=\"EndEvent_0yrp9ky\"/><textAnnotation id=\"TextAnnotation_1kxxiyt\"><text>Start your workflow here</text></textAnnotation><association id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/><textAnnotation id=\"TextAnnotation_0xg4j2u\"><text>Sightings found placed in an Incident Note</text></textAnnotation><association id=\"Association_0h4q6ty\" sourceRef=\"ServiceTask_0kbrdrx\" targetRef=\"TextAnnotation_0xg4j2u\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"><omgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"><omgdi:waypoint x=\"169\" xsi:type=\"omgdc:Point\" y=\"220\"/><omgdi:waypoint x=\"153\" xsi:type=\"omgdc:Point\" y=\"254\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"ServiceTask_0kbrdrx\" id=\"ServiceTask_0kbrdrx_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"258\" y=\"166\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1nhn6ej\" id=\"SequenceFlow_1nhn6ej_di\"><omgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"258\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"228\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_0yrp9ky\" id=\"EndEvent_0yrp9ky_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"417\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"435\" y=\"227\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1atokox\" id=\"SequenceFlow_1atokox_di\"><omgdi:waypoint x=\"358\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"417\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"387.5\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_0xg4j2u\" id=\"TextAnnotation_0xg4j2u_di\"><omgdc:Bounds height=\"52\" width=\"155\" x=\"346\" y=\"81\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_0h4q6ty\" id=\"Association_0h4q6ty_di\"><omgdi:waypoint x=\"351\" xsi:type=\"omgdc:Point\" y=\"169\"/><omgdi:waypoint x=\"394\" xsi:type=\"omgdc:Point\" y=\"133\"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_sighting_list", "version": 1}, "creator_id": "integrations@example.com", "last_modified_by": "integrations@example.com", "last_modified_time": 1556810630560, "content_version": 1, "programmatic_name": "example_misp_sighting_list", "name": "Example: MISP Sighting List"}, {"description": "Create a MISP event from an incident", "workflow_id": 422, "tags": [], "object_type": "incident", "export_key": "example_misp_create_event", "uuid": "fed08a3c-16db-4360-8921-0e50315d4eed", "actions": [], "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"example_misp_create_event\" isExecutable=\"true\" name=\"Example: MISP Create Event\"><documentation>Create a MISP event from an incident</documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_0rsfled</outgoing></startEvent><serviceTask id=\"ServiceTask_00er4jk\" name=\"MISP Create Event\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"8f9b7c45-9d4e-4d35-8bdd-eb2e2923413a\">{\"inputs\":{\"347b5506-f5ae-4597-a918-e36e9fdfb79a\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"number_value\":0}},\"1dcf6488-6e2d-4062-bb74-16be4bb4fbdd\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"number_value\":2}},\"a4929691-12e6-4c36-b151-bb81579c8a76\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"number_value\":1}}},\"post_processing_script\":\"# {'success': True, 'content': {'Event': {'id': '4', 'orgc_id': '1', 'org_id': '1', 'date': '2019-03-23', 'threat_level_id': '1', 'info': 'misp 2', 'published': False, 'uuid': '5c96475a-3170-48e7-b0b5-0138ac110002', 'attribute_count': '0', 'analysis': '2', 'timestamp': '1553352538', 'distribution': '0', 'proposal_email_lock': False, 'locked': False, 'publish_timestamp': '0', 'sharing_group_id': '0', 'disable_correlation': False, 'extends_uuid': '', 'event_creator_email': 'admin@admin.test', 'Org': {'id': '1', 'name': 'ORGNAME', 'uuid': '5c963124-caa0-4dee-a783-00b6ac110002'}, 'Orgc': {'id': '1', 'name': 'ORGNAME', 'uuid': '5c963124-caa0-4dee-a783-00b6ac110002'}, 'Attribute': [], 'ShadowAttribute': [], 'RelatedEvent': [], 'Galaxy': [], 'Object': []}}}\\nincident.properties.misp_event_id = results.content['Event']['id']\",\"pre_processing_script\":\"#inputs.misp_analysis_level = 0\\n#inputs.misp_distribution = 0\\n#inputs.misp_threat_level = 2\\ninputs.misp_event_name = incident.name\"}</resilient:function></extensionElements><incoming>SequenceFlow_0rsfled</incoming><outgoing>SequenceFlow_1onbcb4</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_0rsfled\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_00er4jk\"/><endEvent id=\"EndEvent_1xv42ul\"><incoming>SequenceFlow_1onbcb4</incoming></endEvent><sequenceFlow id=\"SequenceFlow_1onbcb4\" sourceRef=\"ServiceTask_00er4jk\" targetRef=\"EndEvent_1xv42ul\"/><textAnnotation id=\"TextAnnotation_1petxji\"><text>Returns the misp_event_id for ongoing reference</text></textAnnotation><association id=\"Association_0p8tc8t\" sourceRef=\"ServiceTask_00er4jk\" targetRef=\"TextAnnotation_1petxji\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_00er4jk\" id=\"ServiceTask_00er4jk_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"287\" y=\"166\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0rsfled\" id=\"SequenceFlow_0rsfled_di\"><omgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"287\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"242.5\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_1xv42ul\" id=\"EndEvent_1xv42ul_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"466\" y=\"188\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"484\" y=\"227\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1onbcb4\" id=\"SequenceFlow_1onbcb4_di\"><omgdi:waypoint x=\"387\" xsi:type=\"omgdc:Point\" y=\"206\"/><omgdi:waypoint x=\"466\" xsi:type=\"omgdc:Point\" y=\"206\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"426.5\" y=\"184\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1petxji\" id=\"TextAnnotation_1petxji_di\"><omgdc:Bounds height=\"62\" width=\"181\" x=\"387\" y=\"75\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_0p8tc8t\" id=\"Association_0p8tc8t_di\"><omgdi:waypoint x=\"384\" xsi:type=\"omgdc:Point\" y=\"173\"/><omgdi:waypoint x=\"434\" xsi:type=\"omgdc:Point\" y=\"137\"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "example_misp_create_event", "version": 1}, "creator_id": "integrations@example.com", "last_modified_by": "integrations@example.com", "last_modified_time": 1556810630344, "content_version": 1, "programmatic_name": "example_misp_create_event", "name": "Example: MISP Create Event"}], "actions": [{"timeout_seconds": 86400, "object_type": "artifact", "type": 1, "name": "Example: Create MISP Attribute", "tags": [], "view_items": [], "enabled": true, "workflows": ["example_misp_create_attribute"], "logic_type": "all", "export_key": "Example: Create MISP Attribute", "uuid": "b800b845-0522-4150-a22f-03e086656ada", "automations": [], "conditions": [{"type": null, "evaluation_id": null, "field_name": "incident.properties.misp_event_id", "method": "has_a_value", "value": null}], "id": 1460, "message_destinations": []}, {"timeout_seconds": 86400, "object_type": "incident", "type": 1, "name": "Example: Create MISP Event", "tags": [], "view_items": [], "enabled": true, "workflows": ["example_misp_create_event"], "logic_type": "all", "export_key": "Example: Create MISP Event", "uuid": "ddbfd14a-fa8c-49cf-8202-453f2b1c6c36", "automations": [], "conditions": [{"type": null, "evaluation_id": null, "field_name": "incident.properties.misp_event_id", "method": "not_has_a_value", "value": null}], "id": 1461, "message_destinations": []}, {"timeout_seconds": 86400, "object_type": "artifact", "type": 1, "name": "Example: Create MISP Sighting", "tags": [], "view_items": [], "enabled": true, "workflows": ["example_misp_create_sighting"], "logic_type": "all", "export_key": "Example: Create MISP Sighting", "uuid": "0222536e-d5df-44a7-a578-9e745d2030cf", "automations": [], "conditions": [], "id": 1462, "message_destinations": []}, {"timeout_seconds": 86400, "object_type": "artifact", "type": 1, "name": "Example: MISP Search Attribute", "tags": [], "view_items": [], "enabled": true, "workflows": ["example_misp_search_attribute"], "logic_type": "all", "export_key": "Example: MISP Search Attribute", "uuid": "7aa1e034-cf42-4581-9173-55b31fb9a28d", "automations": [], "conditions": [], "id": 1463, "message_destinations": []}, {"timeout_seconds": 86400, "object_type": "incident", "type": 1, "name": "Example: MISP Sighting List", "tags": [], "view_items": [], "enabled": true, "workflows": ["example_misp_sighting_list"], "logic_type": "all", "export_key": "Example: MISP Sighting List", "uuid": "57a0a03c-f92a-493f-a257-5c2ac951b7d3", "automations": [], "conditions": [{"type": null, "evaluation_id": null, "field_name": "incident.properties.misp_event_id", "method": "has_a_value", "value": null}], "id": 1464, "message_destinations": []}], "layouts": [], "export_format_version": 2, "id": 172, "industries": null, "functions": [{"display_name": "MISP Create Attribute", "description": {"content": "Create a MISP attribute from an incident artifact", "format": "text"}, "creator": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "view_items": [{"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "21760030-8ddf-43da-84e8-5b0c63362b47", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "bde8e83c-060d-4c5a-928d-d999a97cfda0", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "d957c2b0-75fe-41b7-ac06-1ce0a7a7b251", "step_label": null}], "tags": [], "export_key": "misp_create_attribute", "uuid": "f5c4aae2-135e-41ac-8bbc-082b00677ecb", "last_modified_by": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "version": 2, "workflows": [{"programmatic_name": "example_misp_create_attribute", "tags": [], "object_type": "artifact", "uuid": null, "actions": [], "name": "Example: MISP Create Attribute", "workflow_id": 421, "description": null}], "last_modified_time": 1556810629762, "destination_handle": "fn_misp", "id": 238, "name": "misp_create_attribute"}, {"display_name": "MISP Create Event", "description": {"content": "Create a MISP event from an incident", "format": "text"}, "creator": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "view_items": [{"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "cce1ad61-1368-4bbd-ba36-5a79bfdec88c", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "347b5506-f5ae-4597-a918-e36e9fdfb79a", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "1dcf6488-6e2d-4062-bb74-16be4bb4fbdd", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "a4929691-12e6-4c36-b151-bb81579c8a76", "step_label": null}], "tags": [], "export_key": "misp_create_event", "uuid": "8f9b7c45-9d4e-4d35-8bdd-eb2e2923413a", "last_modified_by": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "version": 2, "workflows": [{"programmatic_name": "example_misp_create_event", "tags": [], "object_type": "incident", "uuid": null, "actions": [], "name": "Example: MISP Create Event", "workflow_id": 422, "description": null}], "last_modified_time": 1556810629762, "destination_handle": "fn_misp", "id": 239, "name": "misp_create_event"}, {"display_name": "MISP Create Sighting", "description": {"content": "Create a MISP sighting from an incident artifact", "format": "text"}, "creator": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "view_items": [{"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "2e9a8d2b-9fd1-4a42-a61e-45ce8213feb7", "step_label": null}], "tags": [], "export_key": "misp_create_sighting", "uuid": "e9df792b-a3af-4d67-ae90-e48aabca138c", "last_modified_by": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "version": 2, "workflows": [{"programmatic_name": "example_misp_create_sighting", "tags": [], "object_type": "artifact", "uuid": null, "actions": [], "name": "Example: MISP Create Sighting", "workflow_id": 420, "description": null}], "last_modified_time": 1556810629762, "destination_handle": "fn_misp", "id": 240, "name": "misp_create_sighting"}, {"display_name": "MISP Create Tag", "description": {"content": "Creates a Tag", "format": "text"}, "creator": {"type": "user", "display_name": "Craig Roberts", "id": 1, "name": "craig.roberts@uk.ibm.com"}, "view_items": [{"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "a201dc94-d7f0-4b09-9e9e-7c4ba5a7a5da", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "6fdb895f-e66f-47e8-958c-3c7227218f0d", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "bde8e83c-060d-4c5a-928d-d999a97cfda0", "step_label": null}, {"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "21760030-8ddf-43da-84e8-5b0c63362b47", "step_label": null}], "tags": [], "export_key": "misp_create_tag", "uuid": "71d3fed2-0eec-49af-a418-8e8178e5a458", "last_modified_by": {"type": "user", "display_name": "Craig Roberts", "id": 1, "name": "craig.roberts@uk.ibm.com"}, "version": 1, "workflows": [{"programmatic_name": "example_misp_create_tag_on_attribute", "tags": [], "object_type": "artifact", "uuid": null, "actions": [], "name": "Example: MISP Create Tag on Attribute", "workflow_id": 518, "description": null}, {"programmatic_name": "example_misp_create_tag_on_event", "tags": [], "object_type": "incident", "uuid": null, "actions": [], "name": "Example: MISP Create Tag on Event", "workflow_id": 519, "description": null}], "last_modified_time": 1569399557137, "destination_handle": "fn_misp", "id": 325, "name": "misp_create_tag"}, {"display_name": "MISP Search Attribute", "description": {"content": "Search MISP event attributes for a given match on an artifact", "format": "text"}, "creator": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "view_items": [{"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "bde8e83c-060d-4c5a-928d-d999a97cfda0", "step_label": null}], "tags": [], "export_key": "misp_search_attribute", "uuid": "c248bc7c-b60f-4d36-9a2e-294ee78a5981", "last_modified_by": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "version": 2, "workflows": [{"programmatic_name": "example_misp_search_attribute", "tags": [], "object_type": "artifact", "uuid": null, "actions": [], "name": "Example: MISP Search Attribute", "workflow_id": 423, "description": null}, {"programmatic_name": "misp_search_attack", "tags": [], "object_type": "artifact", "uuid": null, "actions": [], "name": "misp_search_attack", "workflow_id": 525, "description": null}], "last_modified_time": 1556810629762, "destination_handle": "fn_misp", "id": 241, "name": "misp_search_attribute"}, {"display_name": "MISP Sighting List", "description": {"content": "List all sightings associated with an event", "format": "text"}, "creator": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "view_items": [{"show_if": null, "field_type": "__function", "show_link_header": false, "element": "field_uuid", "content": "21760030-8ddf-43da-84e8-5b0c63362b47", "step_label": null}], "tags": [], "export_key": "misp_sighting_list", "uuid": "8b531827-741d-40e8-90a5-1ec99cb1710d", "last_modified_by": {"type": "user", "display_name": "Orchestration Engine", "id": 5, "name": "integrations@example.com"}, "version": 2, "workflows": [{"programmatic_name": "example_misp_sighting_list", "tags": [], "object_type": "incident", "uuid": null, "actions": [], "name": "Example: MISP Sighting List", "workflow_id": 424, "description": null}], "last_modified_time": 1556810629762, "destination_handle": "fn_misp", "id": 242, "name": "misp_sighting_list"}], "action_order": [], "geos": null, "tags": [], "task_order": [], "types": [], "timeframes": null, "workspaces": [], "inbound_mailboxes": null, "automatic_tasks": [], "phases": [], "notifications": null, "regulators": null, "incident_types": [{"update_date": 1570547608558, "create_date": 1570547608558, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "enabled": false, "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "system": false, "parent_id": null, "hidden": false, "id": 0, "name": "Customization Packages (internal)"}], "scripts": [], "server_version": {"major": 33, "version": "33.0.5087", "build_number": 5087, "minor": 0}, "message_destinations": [{"programmatic_name": "fn_misp", "tags": [], "export_key": "fn_misp", "uuid": "4d83ca86-3993-4271-ab8b-7632e96c1ee1", "expect_ack": true, "destination_type": 0, "users": ["integrations@example.com"], "api_keys": ["0b155c34-4ad8-46ea-81c5-053c410f2dd4", "a676650c-8c6b-4741-b346-5cef095819a6"], "name": "fn_misp"}], "incident_artifact_types": [], "roles": [], "fields": [{"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_tag_name", "blank_option": false, "prefix": null, "changeable": true, "id": 4535, "read_only": false, "uuid": "6fdb895f-e66f-47e8-958c-3c7227218f0d", "chosen": false, "input_type": "text", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_tag_name", "hide_notification": false, "placeholder": "", "name": "misp_tag_name", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_distribution", "blank_option": false, "prefix": null, "changeable": true, "id": 3313, "read_only": false, "uuid": "347b5506-f5ae-4597-a918-e36e9fdfb79a", "chosen": false, "input_type": "number", "tooltip": "Organization only=0", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_distribution", "hide_notification": false, "placeholder": "", "name": "misp_distribution", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_attribute_value", "blank_option": false, "prefix": null, "changeable": true, "id": 3317, "read_only": false, "uuid": "bde8e83c-060d-4c5a-928d-d999a97cfda0", "chosen": false, "input_type": "text", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_attribute_value", "hide_notification": false, "placeholder": "", "name": "misp_attribute_value", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_event_name", "blank_option": false, "prefix": null, "changeable": true, "id": 3312, "read_only": false, "uuid": "cce1ad61-1368-4bbd-ba36-5a79bfdec88c", "chosen": false, "input_type": "text", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_event_name", "hide_notification": false, "placeholder": "", "name": "misp_event_name", "deprecated": false, "calculated": false, "required": "always", "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_threat_level", "blank_option": false, "prefix": null, "changeable": true, "id": 3314, "read_only": false, "uuid": "a4929691-12e6-4c36-b151-bb81579c8a76", "chosen": false, "input_type": "number", "tooltip": "high=1, medium=2, low=3", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_threat_level", "hide_notification": false, "placeholder": "", "name": "misp_threat_level", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_event_id", "blank_option": false, "prefix": null, "changeable": true, "id": 3316, "read_only": false, "uuid": "21760030-8ddf-43da-84e8-5b0c63362b47", "chosen": false, "input_type": "number", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_event_id", "hide_notification": false, "placeholder": "", "name": "misp_event_id", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_tag_type", "blank_option": false, "prefix": null, "changeable": true, "id": 4534, "read_only": false, "uuid": "a201dc94-d7f0-4b09-9e9e-7c4ba5a7a5da", "chosen": false, "input_type": "select", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_tag_type", "hide_notification": false, "placeholder": "", "name": "misp_tag_type", "deprecated": false, "calculated": false, "values": [{"uuid": "56caee47-eded-45b5-b2dd-ce4c5a7dd1ae", "default": true, "enabled": true, "value": 6400, "label": "Event", "hidden": false, "properties": null}, {"uuid": "05c7115d-cf34-4da2-b04c-857394325938", "default": false, "enabled": true, "value": 6401, "label": "Attribute", "hidden": false, "properties": null}], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_attribute_type", "blank_option": false, "prefix": null, "changeable": true, "id": 3318, "read_only": false, "uuid": "d957c2b0-75fe-41b7-ac06-1ce0a7a7b251", "chosen": false, "input_type": "text", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_attribute_type", "hide_notification": false, "placeholder": "", "name": "misp_attribute_type", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_sighting", "blank_option": false, "prefix": null, "changeable": true, "id": 3320, "read_only": false, "uuid": "2e9a8d2b-9fd1-4a42-a61e-45ce8213feb7", "chosen": false, "input_type": "text", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_sighting", "hide_notification": false, "placeholder": "", "name": "misp_sighting", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 11, "operation_perms": {}, "text": "misp_analysis_level", "blank_option": false, "prefix": null, "changeable": true, "id": 3315, "read_only": false, "uuid": "1dcf6488-6e2d-4062-bb74-16be4bb4fbdd", "chosen": false, "input_type": "number", "tooltip": "initial =0, ongoing=1, complete=2", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "__function/misp_analysis_level", "hide_notification": false, "placeholder": "", "name": "misp_analysis_level", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}, {"operations": [], "type_id": 0, "operation_perms": {}, "text": "MISP Event Id", "blank_option": false, "prefix": "properties", "changeable": true, "id": 3319, "read_only": false, "uuid": "d17faed0-2202-4026-8f56-a127a8d4a980", "chosen": false, "input_type": "text", "tooltip": "", "internal": false, "rich_text": false, "templates": [], "tags": [], "allow_default_value": false, "export_key": "incident/misp_event_id", "hide_notification": false, "placeholder": "", "name": "misp_event_id", "deprecated": false, "calculated": false, "values": [], "default_chosen_by_server": false}], "overrides": [], "export_date": 1570547591980}