<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Cisco ASA Add Artifact to Network Object Group

## Function - Cisco ASA Add Artifact to Network Object Group

### API Name
`cisco_asa_add_artifact_to_network_object_group`

### Output Name
`None`

### Message Destination
`fn_cisco_asa`

### Pre-Processing Script
```python
# Parse the firewall name and network object group from the colon separated string
firewall_group_pair = rule.properties.cisco_asa_firewall_network_object_group

# Parse the firewall group pair, which is a string in "firewall:network_object_group" format
firewall_group_pair_list = firewall_group_pair.split(":")
inputs.cisco_asa_firewall = firewall_group_pair_list[0]
inputs.cisco_asa_network_object_group = firewall_group_pair_list[1]

# Get input from the artifact type and value
inputs.cisco_asa_network_object_value = artifact.value
inputs.cisco_asa_artifact_type = artifact.type

# Optional network object description
if rule.properties.cisco_asa_network_object_description:
  inputs.cisco_asa_network_object_description = rule.properties.cisco_asa_network_object_description
  
# Option params for IP netmask or end IP for IP range
inputs.cisco_asa_end_range = rule.properties.cisco_asa_end_range
if rule.properties.cisco_asa_ipv4_netmask:
  inputs.cisco_asa_netmask = rule.properties.cisco_asa_ipv4_netmask
elif rule.properties.cisco_asa_ipv6_prefix_length:
  inputs.cisco_asa_netmask = rule.properties.cisco_asa_ipv6_prefix_length

# FQDN version
if rule.properties.cisco_asa_fqdn_ip_version:
  inputs.cisco_asa_fqdn_ip_version = rule.properties.cisco_asa_fqdn_ip_version
  
# IPv4FQDN and IPv4Range require a name as input.
if rule.properties.cisco_asa_network_object_name_required:
  inputs.cisco_asa_network_object_name = rule.properties.cisco_asa_network_object_name_required
else:
  inputs.cisco_asa_network_object_name = rule.properties.cisco_asa_network_object_name

```

### Post-Processing Script
```python
from java.util import Date

success = results.get("success")
content = results.get("content")
firewall = content.get("firewall")
if success:
  network_object_group = content.get("network_object_group")
  network_object_kind = content.get("network_object_kind")
  network_object_value = content.get("network_object_value")
  network_object_name = content.get("network_object_name")
  network_object_description = content.get("network_object_description")
  # Add each email as a row in the query results data table
  network_object_row = incident.addRow("cisco_asa_network_object_dt")
  network_object_row.cisco_asa_query_date = Date()
  network_object_row.cisco_asa_firewall = firewall
  network_object_row.cisco_asa_network_object_group = network_object_group
  network_object_row.cisco_asa_network_object_kind = network_object_kind
  network_object_row.cisco_asa_network_object_value = network_object_value
  network_object_row.cisco_asa_network_object_id = network_object_name
  network_object_row.cisco_asa_network_object_description = network_object_description  
  # Update status field
  status_text = u"""<p style= "color:{color}">{status}</p>""".format(color="green", status="Active")
  network_object_row.cisco_asa_status = helper.createRichText(status_text)
else:

  network_object_group = content.get("network_object_group")
  network_object_value = content.get("network_object_value")
  status_message = content.get("status_message")
  note = u"Cisco ASA {0}: Artifact {1} was not added to network object group {2}\n\n{3}.".format(firewall, network_object_value, network_object_group, status_message)
  incident.addNote(helper.createPlainText(note))
```

---

