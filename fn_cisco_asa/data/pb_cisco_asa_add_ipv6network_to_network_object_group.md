<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v50.0.151
-->

# Playbook - Cisco ASA: Add IPv6Network to Network Object Group (PB)

### API Name
`cisco_asa_add_ipv6network_to_network_object_group`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type equals String`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Firewall Network Object Group | `cisco_asa_firewall_network_object_group` | select | - | Always |
| IPv6 Prefix Length | `cisco_asa_ipv6_prefix_length` | text | Prefix length in bits (greater than 8 and less than or equal to 128). | Always |
| Network Object Description | `cisco_asa_network_object_description` | text | - | Optional |
| Network Object Name | `cisco_asa_network_object_name` | text | Objects must have unique names that are limited to 64 characters, including letters and numbers. Space and these special characters: .!@#$%^&()-_{} are NOT permitted.  Object names are case-sensitive. | Optional |

### Object Type
`artifact`

### Description
Add in IPv6 IP network to a Cisco ASA network object group.  If an error occurs write it to an incident note.


---
## Function - Cisco ASA Add Artifact to Network Object Group

### API Name
`cisco_asa_add_artifact_to_network_object_group`

### Output Name
`add_artifact_results`

### Message Destination
`fn_cisco_asa`

### Function-Input Script
```python
# Parse the firewall name and network object group from the colon separated string
firewall_group_pair = playbook.inputs.cisco_asa_firewall_network_object_group

# Parse the firewall group pair, which is a string in "firewall:network_object_group" format
firewall_group_pair_list = firewall_group_pair.split(":")
inputs.cisco_asa_firewall = firewall_group_pair_list[0]
inputs.cisco_asa_network_object_group = firewall_group_pair_list[1]

# Get input from the artifact type and value
inputs.cisco_asa_network_object_value = artifact.value
inputs.cisco_asa_artifact_type = artifact.type

# Optional network object description and object name
if playbook.inputs.cisco_asa_network_object_description:
  inputs.cisco_asa_network_object_description = playbook.inputs.cisco_asa_network_object_description
  
if playbook.inputs.cisco_asa_network_object_name:
  inputs.cisco_asa_network_object_name = playbook.inputs.cisco_asa_network_object_name

if playbook.inputs.cisco_asa_ipv6_prefix_length:
  inputs.cisco_asa_netmask = playbook.inputs.cisco_asa_ipv6_prefix_length

  
```

---

## Global script - Cisco ASA: Write Artifact to Network Object data table

### Description
Write the network object to the Network Object data table or write an incident note if there was an error.

### Script Type
`Global script`

### Object Type
`artifact`

### Script Content
```python
from datetime import datetime

results = playbook.functions.results.add_artifact_results
success = results.get("success")
content = results.get("content")
firewall = content.get("firewall")
network_object_group = content.get("network_object_group")
network_object_value = content.get("network_object_value")
network_object_name = content.get("network_object_name")
network_object_kind = content.get("network_object_kind")
if success:
  network_object_description = content.get("network_object_description")
  # Add network object as a row in the network Cisco ASA network objects data table
  network_object_row = incident.addRow("cisco_asa_network_object_dt")
  network_object_row.cisco_asa_query_date = datetime.now()
  network_object_row.cisco_asa_firewall = firewall
  network_object_row.cisco_asa_network_object_group = network_object_group
  network_object_row.cisco_asa_network_object_kind = network_object_kind
  network_object_row.cisco_asa_network_object_value = network_object_value
  network_object_row.cisco_asa_network_object_id = network_object_name
  network_object_row.cisco_asa_network_object_description = network_object_description  
  # Update status field
  status_text = u"""<p style= "color:{color}">{status}</p>""".format(color="green", status="Active")
  network_object_row.cisco_asa_status = helper.createRichText(status_text)
else:
  # Artifact not added to the group so add a note with the reason.
  reason = content.get("reason")
  note = u"Cisco ASA Add Artifact to Network Object Group Results:\n    Artifact value: {0}\n    Object Name: {1} \n    Object Kind: {2} was not added to Firewall: {3}, Network Object Group: {4}\n\n{5}"
  note = note.format(network_object_value, network_object_name, network_object_kind, firewall, network_object_group, reason)
  incident.addNote(helper.createPlainText(note))
```

---

