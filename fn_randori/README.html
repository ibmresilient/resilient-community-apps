<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="QRadar EDR (formally IBM ReaQta)" href="../fn_reaqta/README.html" /><link rel="prev" title="TOR" href="../fn_query_tor_network/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Randori - IBM SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">IBM SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">IBM SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Summaries</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../docs/all_objects/index.html">All Objects</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of All Objects</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../docs/all_objects/all_functions.html">All Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/all_objects/all_playbooks.html">All Playbooks</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB Function for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">Alien Vault OTX Search Function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_anomali_staxx/README.html">fn_anomali_staxx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible Integration Function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">fn-ansible-tower Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">Amazon AWS GuardDuty Integration for Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">fn-aws-iam Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite Functions for IBM Security SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">fn_cisco_amp4ep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement Function Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Resilient Function - fn_cisco_umbrella_inv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">fn_clamav</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">fn-cloud-foundry Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">Component Files for App Host</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx Functions for IBM Security SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search Function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Function Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">fn_exchange_online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding Functions for Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">fn_google_cloud_dlp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing Function for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">fn_grpc_interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Resilient Integration with Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">fn_html2pdf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser Function v2 for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">Resilient Integration with IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">fn-isitphishing Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira App for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis Function for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">SOAR LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360 Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence for QRadar Soar <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">Resilient Functions Integration to McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">fn-mcafee-esm Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">fn_misp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">fn_mitre_integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">About MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities Function for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html#remote-windows-commands">Remote Windows commands:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">fn_odbc_query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">fn_pa_panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities Function for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal Function for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_ai/README.html">Phish.AI Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">PhishTank Lookup Function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl Function for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint Targeted Attack Protection (TAP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">fn-proofpoint-trap Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">fn-pulsedive Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_query_tor_network/README.html">TOR</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR (formally IBM ReaQta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_remedy/README.html">fn_remedy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">Resilient Circuits Components for function: fn_rsa_netwitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html#release-notes">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Function Utilities for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection Integration for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_service_now/README.html">IBM Security QRadar SOAR App for ServiceNow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify App for IBM QRadar SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_spamhaus_query/README.html">Spamhaus Lookup for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">fn-task-utils Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams for IBM QRadar SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Resilient Function - Twilio Send SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Resilient Integration with Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS Function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus Integration for Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utility Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmray_analyzer/README.html">VMRay Sandbox Analyzer Function for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watson_translate/README.html">fn_watson_translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex for IBM QRadar SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Resilient Integration with WHOIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">fn-whois-rdap Functions for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">fn-wiki for IBM Resilient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">fn_xforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access (ZIA) Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feed ODBCFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk HTTP Event Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <!--
  This README.md is generated by running:
  "resilient-sdk docgen -p fn_randori"

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  All fields followed by "::CHANGE_ME::"" should be manually edited

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)

  NOTE: If your app is available in the container-format only, there is no need to mention the integration server in this readme.
-->
<section id="randori">
<h1>Randori<a class="headerlink" href="#randori" title="Link to this heading">#</a></h1>
<section id="table-of-contents">
<h2>Table of Contents <!-- omit in toc --><a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#randori"><span class="xref myst">Randori</span></a></p>
<ul>
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
<li><p><a class="reference internal" href="#randori-development-version"><span class="xref myst">Randori Development Version</span></a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisites"><span class="xref myst">Prerequisites</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#poller-considerations"><span class="xref myst">Poller Considerations</span></a></p>
<ul>
<li><p><a class="reference internal" href="#target-filtering"><span class="xref myst">Target Filtering</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---randori-clear-data-table"><span class="xref myst">Function - Randori: Clear Data Table</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-get-detections-of-target"><span class="xref myst">Function - Randori: Get Detections of Target</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-get-paths"><span class="xref myst">Function - Randori: Get Paths</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-get-target"><span class="xref myst">Function - Randori: Get Target</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-send-note-as-comment-to-target"><span class="xref myst">Function - Randori: Send Note as Comment to Target</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-update-notes-from-randori-target"><span class="xref myst">Function - Randori: Update Notes from Randori Target</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-update-target-impact-score"><span class="xref myst">Function - Randori: Update Target Impact Score</span></a></p></li>
<li><p><a class="reference internal" href="#function---randori-update-target-status"><span class="xref myst">Function - Randori: Update Target Status</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---detections"><span class="xref myst">Data Table - Detections</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---discovery-path"><span class="xref myst">Data Table - Discovery Path</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#templates-for-soar-cases"><span class="xref myst">Templates for SOAR Cases</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar_create_casejinja"><span class="xref myst">soar_create_case.jinja</span></a></p></li>
<li><p><a class="reference internal" href="#soar_close_casejinja"><span class="xref myst">soar_close_case.jinja</span></a></p></li>
<li><p><a class="reference internal" href="#soar_update_casejinja"><span class="xref myst">soar_update_case.jinja</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p>
<ul>
<li><p><a class="reference internal" href="#for-support"><span class="xref myst">For Support</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">#</a></h2>
<!--
  Specify all changes in this release. Do not remove the release 
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0.0</p></td>
<td><p>12/2022</p></td>
<td><p>Initial Release</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<!--
  Provide a high-level description of the function itself and its remote software or application.
  The text below is parsed from the "description" and "long_description" attributes in the setup.py file
-->
<p><strong>IBM SOAR app bidirectional synchronization and functions for Randori</strong></p>
<p>Randori Recon is an Attack Surface Management (ASM) solution which helps to identify externally-facing customer assets that could be targeted and lead to a breach.</p>
<p><img alt="screenshot: main" src="../_images/main46.png" /></p>
<p>Bidirectional app for Randori for IBM SOAR. Query Randori for targets based on user-defined query parameters and create and update cases in SOAR.  The app will poll Randori for Targets that meet one of the two criteria:</p>
<ol class="arabic simple">
<li><p>Net new Targets on the customer attack surface</p></li>
<li><p>Change in Target Temptation for existing Targets on the attack surface</p></li>
</ol>
<p><img alt="screenshot: main" src="../_images/randori-functions.png" /></p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">#</a></h3>
<!--
  List the Key Features of the Integration
-->
<ul class="simple">
<li><p>Randori SOAR cases contain Target details that require further investigation including Service information, location, discovery path and artifacts</p></li>
<li><p>Randori Priority and Temptation scoring and link back to categorical Guidance to help with remediation and mitigation activities</p></li>
<li><p>Sync Randori Targets to SOAR cases via user defined filter criteria</p></li>
<li><p>Sync Randori Target comments to notes in SOAR</p></li>
<li><p>Set the Target Impact Score in Randori from SOAR</p></li>
<li><p>Set the Target Status in Randori from SOAR</p></li>
<li><p>List the Discovery Path of a Target with links back to Randori</p></li>
<li><p>List the Detections of a Target in SOAR</p></li>
<li><p>Add Detection data as artifacts in SOAR for the following types:</p>
<ul>
<li><p>DNS Name</p></li>
<li><p>File Path</p></li>
<li><p>IP Address</p></li>
<li><p>Port</p></li>
</ul>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">#</a></h2>
<!--
  List any Requirements 
--> 
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">#</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, App Host and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">45.0.7899</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">45.0.7899</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient-circuits&gt;=47.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-even"><td><p>Incidents</p></td>
<td><p>Read, Create</p></td>
</tr>
<tr class="row-odd"><td><p>Edit Incidents</p></td>
<td><p>Fields, Status</p></td>
</tr>
<tr class="row-even"><td><p>Layouts</p></td>
<td><p>Read, Edit</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>App Host Deployment Guide</em> or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">#</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= 1.4.</p></li>
<li><p>Cloud Pak is configured with an App Host.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">#</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">#</a></h3>
<p>Python 3.6 and 3.9 are supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>resilient-circuits&gt;=47.0.0</p></li>
</ul>
</section>
<section id="randori-development-version">
<h3>Randori Development Version<a class="headerlink" href="#randori-development-version" title="Link to this heading">#</a></h3>
<p>This app has been implemented using:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Product Name</p></th>
<th class="head"><p>API URL</p></th>
<th class="head"><p>API Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Randori</p></td>
<td><p>https://app.randori.io</p></td>
<td><p>v1</p></td>
</tr>
</tbody>
</table>
</div>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h4>
<!--
List any prerequisites that are needed to use with this endpoint solution. Remove any section that is unnecessary.
-->
<ul class="simple">
<li><p>Randori account</p></li>
<li><p>Randori API Token</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">#</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>api_token</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xxx</span></code></p></td>
<td><p><em>Randori API token.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>api_version</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">v1</span></code></p></td>
<td><p><em>Randori REST API version.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>endpoint_url</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://app.randori.io</span></code></p></td>
<td><p><em>Randori endpoint URL.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_interval</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">600</span></code></p></td>
<td><p><em>Poller interval time in seconds. Value of zero to turn poller off.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>polling_lookback</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1200</span></code></p></td>
<td><p><em>Number of minutes to look back for target updates. Value is only used on the first time polling when the app starts.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>organization_name</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">organization-name</span></code></p></td>
<td><p><em>Your organization name in Randori.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>verify</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><em>Boolean indicating whether to verify the Randori client certificate.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>polling_filters</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>(“target_temptation”,”greater_or_equal”,40)</p></td>
<td><p><em>Query filters: Comma separated tuples (“field”,”operator”,”value)</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>soar_create_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/soar_create_case_template.jinja</p></td>
<td><p><em>Path to custom create case jinja template.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>soar_close_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/soar_close_case_template.jinja</p></td>
<td><p><em>Path to custom close case jinja template.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>soar_update_case_template</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>/path/soar_close_case_template.jinja</p></td>
<td><p><em>Path to custom update case jinja template.</em></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-layouts">
<h3>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">#</a></h3>
<!--
  Use this section to provide guidance on where the user should add any custom fields and data tables.
  You may wish to recommend a new incident tab.
  You should save a screenshot "custom_layouts.png" in the doc/screenshots directory and reference it here
-->
<p>The following Randori Tab custom layout is included in the app:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts24.png" /></p>
</section>
</section>
<section id="poller-considerations">
<h2>Poller Considerations<a class="headerlink" href="#poller-considerations" title="Link to this heading">#</a></h2>
<p>The poller is just one way to escalate Randori Targets to SOAR cases. It’s also possible to send target information to a SIEM, such as IBM QRadar, which would then coorelate Targets into Offenses. With the QRadar Plugin for SOAR, offenses can then be escalated to SOAR cases. As long as the Randori Target ID is preserved in the custom case field <code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code>, then all the remaining details about the target will synchronize to the SOAR case. In the case of the QRadar Plugin for SOAR, you would modify the escalation templates to reference this custom field with the Randori Target ID.</p>
<p>
<p>When using another source of Randori Target escalation to IBM SOAR, disable the poller by changing the app.config setting to <code class="docutils literal notranslate"><span class="pre">polling_interval=0</span></code>.</p>
<p>
<section id="target-filtering">
<h3>Target Filtering<a class="headerlink" href="#target-filtering" title="Link to this heading">#</a></h3>
<p>To limit the number of Targets escalated to SOAR, consider using the optional <code class="docutils literal notranslate"><span class="pre">polling_filter</span></code> parameter in the app configuration file. Each filter is a tuple in the following format: (“field”,”operator”,”value”),
Where:</p>
<ul class="simple">
<li><p>“field” is the Randori Target field to be queried</p></li>
<li><p>“operator” is a string operator performed in query</p></li>
<li><p>“value” is the value to be compared against in the query</p></li>
</ul>
<p>
If more than one filter is needed, separate each tuple with a comma. Enclose string values in quotes.
<p>
Here is an polling filter example that adds or updates targets that have a "target_temptation" greater or equal to 50 AND whose status is "Needs Investigation", "Needs Resolution", "Needs Review", or "None":
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>polling_filters=(&quot;target_temptation&quot;,&quot;greater_or_equal&quot;,50),(&quot;status&quot;,&quot;equal&quot;,[&quot;Needs Investigation&quot;,&quot;Needs Resolution&quot;,&quot;Needs Review&quot;,&quot;None&quot;])
</pre></div>
</div>
<p>The list of Randori supported JQuery <code class="docutils literal notranslate"><span class="pre">operators</span></code>:</p>
<ul class="simple">
<li><p>begins_with</p></li>
<li><p>between</p></li>
<li><p>contains</p></li>
<li><p>ends_with</p></li>
<li><p>equal</p></li>
<li><p>greater</p></li>
<li><p>greater_or_equal</p></li>
<li><p>greater_or_equal_utc_seconds_ago</p></li>
<li><p>greater_utc_seconds_ago</p></li>
<li><p>icontains</p></li>
<li><p>in</p></li>
<li><p>is_empty</p></li>
<li><p>is_not_empty</p></li>
<li><p>is_not_null</p></li>
<li><p>is_null</p></li>
<li><p>less</p></li>
<li><p>less_or_equal</p></li>
<li><p>less_or_equal_utc_seconds_ago</p></li>
<li><p>less_utc_seconds_ago</p></li>
<li><p>not_begins_with</p></li>
<li><p>not_contains</p></li>
<li><p>not_ends_with</p></li>
<li><p>not_equal</p></li>
<li><p>not_icontains</p></li>
<li><p>not_in</p></li>
<li><p>contained_by</p></li>
<li><p>contains</p></li>
<li><p>equal</p></li>
<li><p>has_key</p></li>
<li><p>is_empty</p></li>
<li><p>is_not_empty</p></li>
<li><p>is_not_null</p></li>
<li><p>is_null</p></li>
<li><p>not_contained_by</p></li>
<li><p>not_contains</p></li>
<li><p>not_equal</p></li>
<li><p>not_has_key</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="function-randori-clear-data-table">
<h2>Function - Randori: Clear Data Table<a class="headerlink" href="#function-randori-clear-data-table" title="Link to this heading">#</a></h2>
<p>Clear the specified Randori data table.</p>
<p><img alt="screenshot: fn-randori-clear-data-table " src="../_images/fn-randori-clear-data-table.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">randori_data_table_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;hints&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2640</span><span class="p">,</span>
    <span class="s2">&quot;randori_data_table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;randori_detections_dt&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">10072</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-07 08:18:51&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">randori_data_table_name</span> <span class="o">=</span> <span class="s2">&quot;randori_detections_dt&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script to Fill the Data Table:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">calendar</span>

<span class="k">def</span> <span class="nf">soar_datetimeformat</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S&quot;</span><span class="p">,</span> <span class="n">split_at</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom jinja filter to convert UTC dates to epoch format</span>

<span class="sd">    Args:</span>
<span class="sd">        value ([str]): [jinja provided field value]</span>
<span class="sd">        date_format (str, optional): [conversion format]. Defaults to &quot;%Y-%m-%dT%H:%M:%S&quot;.</span>
<span class="sd">        split_at (str, optional): [character to split the date field to scope the date field.]</span>
<span class="sd">            examples: split_at=&#39;.&#39; to remove milliseconds for &quot;2021-10-22T20:53:53.913Z&quot;,</span>
<span class="sd">                      split_at=&#39;+&#39; tp remove tz information &quot;2021-10-22T20:53:53+00:00&quot;,</span>
<span class="sd">    Returns:</span>
<span class="sd">        [int]: [epoch value of datetime, in milliseconds]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">if</span> <span class="n">split_at</span><span class="p">:</span>
        <span class="n">utc_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">[:</span><span class="n">value</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">split_at</span><span class="p">)],</span> <span class="n">date_format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utc_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">utc_time</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>
<span class="c1">############################################################################################   </span>

<span class="n">detection_data</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">detection_data</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">detection_data</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Unable to update Detections data table - error getting detections data.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">clear_table_output</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">clear_table_output</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">clear_table_output</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: ERROR - Unable to clear the Detections data table before updating it.&quot;</span><span class="p">)</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">detection_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="n">detection_list</span> <span class="o">=</span> <span class="n">detection_data</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;detection_list&quot;</span><span class="p">,</span> <span class="p">[])</span>
  <span class="k">for</span> <span class="n">detection</span> <span class="ow">in</span> <span class="n">detection_list</span><span class="p">:</span>
    <span class="n">detection_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;randori_detections_dt&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_date_added&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_hostname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hostname&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_first_seen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soar_datetimeformat</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;first_seen&quot;</span><span class="p">),</span> <span class="n">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_last_seen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soar_datetimeformat</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last_seen&quot;</span><span class="p">),</span> <span class="n">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: manual playbook updated Detections data table with </span><span class="si">{}</span><span class="s2"> detections&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detection_list</span><span class="p">)))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-get-detections-of-target">
<h2>Function - Randori: Get Detections of Target<a class="headerlink" href="#function-randori-get-detections-of-target" title="Link to this heading">#</a></h2>
<p>Get the list detections of a specified Randori target given it’s target Id.</p>
<p><img alt="screenshot: fn-randori-get-detections-of-target " src="../_images/fn-randori-get-detections-of-target.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;detection_list&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;affiliation_state&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
        <span class="s2">&quot;applicability&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;attack_note&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;authority&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;authority_distance&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;authority_override&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;authorization_state&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
        <span class="s2">&quot;banners_uuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;cert_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;0caabe31-4ede-4e24-9507-f9ebc106951f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;characteristic_tags&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;DefaultPage&quot;</span><span class="p">,</span>
          <span class="s2">&quot;NoCSS&quot;</span><span class="p">,</span>
          <span class="s2">&quot;OldCopyright&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;characteristics_count&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
        <span class="s2">&quot;cpe&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;cpe_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3&quot;</span><span class="p">,</span>
          <span class="s2">&quot;edition&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;part&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
          <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="s2">&quot;tomcat&quot;</span><span class="p">,</span>
          <span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;cpe:2.3:a:apache:tomcat:7.0.76:*:*:*:*:*:*:*&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sw_edition&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;target_hw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;target_sw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;update&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;apache&quot;</span><span class="p">,</span>
          <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;7.0.76&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;criticality&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;deleted&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Apache Tomcat, often referred to as Tomcat Server, is an open-source Java Servlet Container developed by the Apache Software Foundation.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;detection_criteria&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;http&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;ferrari.demo.webernets.online&quot;</span><span class="p">,</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">1.1</span>
          <span class="p">},</span>
          <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;34.149.126.94&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">4</span>
          <span class="p">},</span>
          <span class="s2">&quot;tcp&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">443</span>
          <span class="p">},</span>
          <span class="s2">&quot;tls&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">3.3</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;detection_relevance&quot;</span><span class="p">:</span> <span class="mi">1130</span><span class="p">,</span>
        <span class="s2">&quot;enumerability&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;exploitability&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;first_seen&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-07T02:05:22.741389+00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;headers_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;047cf2ed-c1ff-4bbf-9501-8e0b6b736093&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;ferrari.demo.webernets.online&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hostname_id&quot;</span><span class="p">:</span> <span class="s2">&quot;82ca6db1-344b-4d12-a7db-5e229e3630d1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f814e5ef-76d9-41c1-b6e8-52b5c0daeb16,5dbcb688-8591-4574-ad18-6cbc27a1941c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;impact_score&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;34.149.126.94&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5b3beaa8-d24c-4861-97de-27dc3b5f9bf2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip_str&quot;</span><span class="p">:</span> <span class="s2">&quot;34.149.126.94&quot;</span><span class="p">,</span>
        <span class="s2">&quot;last_seen&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-10-31T11:22:49.122136+00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lens_id&quot;</span><span class="p">:</span> <span class="s2">&quot;08a90512-fb94-4766-9cc7-7a945e934638&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lens_view&quot;</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Tomcat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;org_id&quot;</span><span class="p">:</span> <span class="s2">&quot;923af5dd-50ce-4d80-a55f-707dfe08411e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
        <span class="s2">&quot;perspective&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;perspective_name&quot;</span><span class="p">:</span> <span class="s2">&quot;PUBLIC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;poc_email&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;poc_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">443</span><span class="p">,</span>
        <span class="s2">&quot;post_exploit&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;priority_impact_factor&quot;</span><span class="p">:</span> <span class="mf">0.084375</span><span class="p">,</span>
        <span class="s2">&quot;priority_score&quot;</span><span class="p">:</span> <span class="mf">135.0</span><span class="p">,</span>
        <span class="s2">&quot;priority_status_factor&quot;</span><span class="p">:</span> <span class="mf">0.1125</span><span class="p">,</span>
        <span class="s2">&quot;priority_tags_factor&quot;</span><span class="p">:</span> <span class="mf">0.253125</span><span class="p">,</span>
        <span class="s2">&quot;private_weakness&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;public_weakness&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;randori_notes&quot;</span><span class="p">:</span> <span class="s2">&quot;This version of Apache Tomcat has multiple medium and high risk vulnerabilities associated with it including potential remote code execution risks as described in CVE-2020-9484, CVE-2020-1938, and CVE-2019-0232. Apache Tomcat may be vulnerable to the Log4j 2 Remote Code Execution vulnerabilities - CVE-2021-44228 CVE-2021-45046 CVE-2021-45105 CVE-2021-44832 - https://logging.apache.org/log4j/2.x/security.html. Proof-of-Concept exploit code is available for these CVEs. Tomcat does not include Log4J 2 by default, but can be configured to optionally use Log4J 2. Users should check their Log4J 2 configuration and apply mitigations as described in either the above article or per their vendor guidance.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reference&quot;</span><span class="p">:</span> <span class="s2">&quot;http://tomcat.apache.org&quot;</span><span class="p">,</span>
        <span class="s2">&quot;research&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;screenshot_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;5afc7cfb-9ab8-4231-a296-909eb7d918e2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;service_id&quot;</span><span class="p">:</span> <span class="s2">&quot;15d7435d-3469-450f-8ef9-f9e12dde6f68&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Needs Investigation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_confidence&quot;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
        <span class="s2">&quot;target_first_seen&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-07T07:18:22.029485+00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5dbcb688-8591-4574-ad18-6cbc27a1941c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_last_seen&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-10-31T11:32:10.769721+00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_num_detections&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;target_temptation&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
        <span class="s2">&quot;tech_category&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;App Servers&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;temptation_last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-03-31T18:10:37.913851+00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;thumbnail_uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;50adc897-252f-4388-89bb-7ef034b68320&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_tags&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Unknown - By Qualys&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Unknown - By Tenable&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Wildcard Cert&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Apache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;7.0.76&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5dbcb688-8591-4574-ad18-6cbc27a1941c&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">167</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-02 16:57:13&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script to Fill Detections Data Table:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">calendar</span>

<span class="k">def</span> <span class="nf">soar_datetimeformat</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S&quot;</span><span class="p">,</span> <span class="n">split_at</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom jinja filter to convert UTC dates to epoch format</span>

<span class="sd">    Args:</span>
<span class="sd">        value ([str]): [jinja provided field value]</span>
<span class="sd">        date_format (str, optional): [conversion format]. Defaults to &quot;%Y-%m-%dT%H:%M:%S&quot;.</span>
<span class="sd">        split_at (str, optional): [character to split the date field to scope the date field.]</span>
<span class="sd">            examples: split_at=&#39;.&#39; to remove milliseconds for &quot;2021-10-22T20:53:53.913Z&quot;,</span>
<span class="sd">                      split_at=&#39;+&#39; tp remove tz information &quot;2021-10-22T20:53:53+00:00&quot;,</span>
<span class="sd">    Returns:</span>
<span class="sd">        [int]: [epoch value of datetime, in milliseconds]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">if</span> <span class="n">split_at</span><span class="p">:</span>
        <span class="n">utc_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">[:</span><span class="n">value</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">split_at</span><span class="p">)],</span> <span class="n">date_format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utc_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">utc_time</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>
<span class="c1">############################################################################################   </span>

<span class="n">detection_data</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">detection_data</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">detection_data</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Get Target Data: Unable to get target data from Randori&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">detection_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="n">detection_list</span> <span class="o">=</span> <span class="n">detection_data</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;detection_list&quot;</span><span class="p">,</span> <span class="p">[])</span>
  <span class="k">for</span> <span class="n">detection</span> <span class="ow">in</span> <span class="n">detection_list</span><span class="p">:</span>
    <span class="n">detection_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;randori_detections_dt&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_date_added&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_hostname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hostname&quot;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_first_seen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soar_datetimeformat</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;first_seen&quot;</span><span class="p">),</span> <span class="n">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">detection_row</span><span class="p">[</span><span class="s1">&#39;randori_dt_last_seen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soar_datetimeformat</span><span class="p">(</span><span class="n">detection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last_seen&quot;</span><span class="p">),</span> <span class="n">split_at</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: automatic playbook updated Detections data table with </span><span class="si">{}</span><span class="s2"> detections&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detection_list</span><span class="p">)))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-get-paths">
<h2>Function - Randori: Get Paths<a class="headerlink" href="#function-randori-get-paths" title="Link to this heading">#</a></h2>
<p>Get the paths data for a Randori target.</p>
<p><img alt="screenshot: fn-randori-get-paths " src="../_images/fn-randori-get-paths.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;329a6ff4-4e2a-4932-b39c-32c5d847e3c0&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;b4a3b681-c96b-49ba-a0d5-7a576996e703&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;329a6ff4-4e2a-4932-b39c-32c5d847e3c0&quot;</span><span class="p">,</span>
          <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;f62ab0f7-954c-4205-a39d-5f170f6131b7&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Passive DNS Records&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;afd6c37d-1280-48ac-bf2d-46ae4286c54b&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">,</span>
          <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Detection-Target connection&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;7d52abd6-f390-4f7b-8312-6367011b1d93&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;a5f818c5-68c4-40ec-a574-60bfae787651&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;7d52abd6-f390-4f7b-8312-6367011b1d93&quot;</span><span class="p">,</span>
          <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;b4a3b681-c96b-49ba-a0d5-7a576996e703&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Record&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;be5f636f-1189-49ee-906c-2a5aff984283&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{},</span>
          <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">,</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;be5f636f-1189-49ee-906c-2a5aff984283&quot;</span><span class="p">,</span>
          <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;a5f818c5-68c4-40ec-a574-60bfae787651&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Port Scan&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ip_str&quot;</span><span class="p">:</span> <span class="s2">&quot;52.90.36.58&quot;</span><span class="p">,</span>
            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span>
            <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;detection&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;a5f818c5-68c4-40ec-a574-60bfae787651&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ip_str&quot;</span><span class="p">:</span> <span class="s2">&quot;52.90.36.58&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a5f818c5-68c4-40ec-a574-60bfae787651&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ip&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;afd6c37d-1280-48ac-bf2d-46ae4286c54b&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;telnetd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;afd6c37d-1280-48ac-bf2d-46ae4286c54b&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;target&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;b4a3b681-c96b-49ba-a0d5-7a576996e703&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;telnet.webernets.online&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;b4a3b681-c96b-49ba-a0d5-7a576996e703&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hostname&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;f62ab0f7-954c-4205-a39d-5f170f6131b7&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;webernets.online&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f62ab0f7-954c-4205-a39d-5f170f6131b7&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hostname&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span>
          <span class="s2">&quot;4be17e67-cc0f-4e28-b39f-3844edb09b68&quot;</span><span class="p">,</span>
          <span class="s2">&quot;be5f636f-1189-49ee-906c-2a5aff984283&quot;</span><span class="p">,</span>
          <span class="s2">&quot;7d52abd6-f390-4f7b-8312-6367011b1d93&quot;</span><span class="p">,</span>
          <span class="s2">&quot;329a6ff4-4e2a-4932-b39c-32c5d847e3c0&quot;</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;base_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://app.randori.io/myorg&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;afd6c37d-1280-48ac-bf2d-46ae4286c54b&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">6479</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-09 18:42:30&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script to Fill Data Table:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">def</span> <span class="nf">add_node_to_dt</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">randori_base_url</span><span class="p">):</span>
  
  <span class="n">content</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

  <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;randori_discovery_path_dt&quot;</span><span class="p">)</span>
  <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_date_added&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span> 
  
  <span class="c1"># For each node type formatting is different.</span>
  <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span>
    <span class="n">target_name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
    <span class="n">target_version</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_discovery_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">target_version</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;hostname&quot;</span><span class="p">:</span>
    <span class="n">hostname</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hostname&quot;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_discovery_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>
    <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/hostnames/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randori_base_url</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
    <span class="n">ref_html</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;a href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;View Details&lt;/a&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_link&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">ref_html</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;ip&quot;</span><span class="p">:</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip_str&quot;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_discovery_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
    <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">/ips/</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randori_base_url</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
    <span class="n">ref_html</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;a href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;View Details&lt;/a&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_link&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">ref_html</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;detection&quot;</span><span class="p">:</span>
    <span class="n">hostname</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hostname&quot;</span><span class="p">)</span>
    <span class="n">ip</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ip_str&quot;</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_discovery_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;detection: </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span>

    
<span class="c1">#########################################################################################</span>
<span class="n">paths_data</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">paths_data</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">paths_data</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Unable to get paths data to populate Discovery Path data table.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>

  <span class="n">paths_data_content</span> <span class="o">=</span> <span class="n">paths_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
  <span class="n">randori_base_url</span> <span class="o">=</span> <span class="n">paths_data_content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base_url&quot;</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">paths_data_content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
  <span class="n">edges</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;edges&quot;</span><span class="p">)</span>
  <span class="n">nodes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes&quot;</span><span class="p">)</span>
  <span class="n">paths_list_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paths&quot;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">path_list</span> <span class="ow">in</span> <span class="n">paths_list_list</span><span class="p">:</span>
    <span class="n">edge</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_list</span><span class="p">:</span>
      <span class="n">edge</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
      <span class="n">dst</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dst&quot;</span><span class="p">)</span>
      <span class="n">node</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
      
      <span class="c1"># Add node to the data table</span>
      <span class="n">add_node_to_dt</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">randori_base_url</span><span class="p">)</span>
  
      <span class="c1"># Add edge type to the data table</span>
      <span class="n">row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;randori_discovery_path_dt&quot;</span><span class="p">)</span>
      <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_date_added&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span> 
      <span class="n">row</span><span class="p">[</span><span class="s2">&quot;randori_dt_discovery_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">))</span>
      
    <span class="k">if</span> <span class="n">edge</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="c1"># Last node is the src</span>
      <span class="n">src</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
      <span class="n">node</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
      <span class="n">add_node_to_dt</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">randori_base_url</span><span class="p">)</span>
  
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Discovery Path table refreshed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-get-target">
<h2>Function - Randori: Get Target<a class="headerlink" href="#function-randori-get-target" title="Link to this heading">#</a></h2>
<p>Get the target data for a single Randori target instance.</p>
<p><img alt="screenshot: fn-randori-get-target " src="../_images/fn-randori-get-target.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;affiliation_state&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
      <span class="s2">&quot;applicability&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;attack_note&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;authority&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;authority_distance&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;authority_override&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;authorization_state&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
      <span class="s2">&quot;characteristic_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
      <span class="s2">&quot;cpe&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;cpe_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;edition&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;part&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="s2">&quot;vcenter_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;str&quot;</span><span class="p">:</span> <span class="s2">&quot;cpe:2.3:a:vmware:vcenter_server:*:*:*:*:*:*:*:*&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sw_edition&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;target_hw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;target_sw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;update&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;vmware&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">null</span>
      <span class="p">},</span>
      <span class="s2">&quot;criticality&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;deleted&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;VMware vCenter is the management component of VMware vSphere&quot;</span><span class="p">,</span>
      <span class="s2">&quot;enumerability&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;first_seen&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-09-10T07:49:26.858689+00:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;2755b843-9d38-457e-b4a3-3a8d27c47a9c&quot;</span><span class="p">,</span>
      <span class="s2">&quot;impact_score&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
      <span class="s2">&quot;last_seen&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-29T20:13:48.701719+00:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lens_id&quot;</span><span class="p">:</span> <span class="s2">&quot;6e8476e5-ead9-4ca2-914c-3bc1732ca0fb&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lens_view&quot;</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vCenter&quot;</span><span class="p">,</span>
      <span class="s2">&quot;org_id&quot;</span><span class="p">:</span> <span class="s2">&quot;e0c553a8-88f1-4991-8970-f058a82542e8&quot;</span><span class="p">,</span>
      <span class="s2">&quot;perspective&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
      <span class="s2">&quot;perspective_name&quot;</span><span class="p">:</span> <span class="s2">&quot;PUBLIC&quot;</span><span class="p">,</span>
      <span class="s2">&quot;post_exploit&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;priority_impact_factor&quot;</span><span class="p">:</span> <span class="mf">0.02625</span><span class="p">,</span>
      <span class="s2">&quot;priority_score&quot;</span><span class="p">:</span> <span class="mf">39.375</span><span class="p">,</span>
      <span class="s2">&quot;priority_status_factor&quot;</span><span class="p">:</span> <span class="mf">0.065625</span><span class="p">,</span>
      <span class="s2">&quot;priority_tags_factor&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
      <span class="s2">&quot;private_weakness&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;public_weakness&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;randori_notes&quot;</span><span class="p">:</span> <span class="s2">&quot;VMware vSphere (and associated services - vCenter) may be vulnerable to the Log4j 2 Remote Code Execution vulnerabilities - CVE-2021-44228 CVE-2021-45046 CVE-2021-45105 CVE-2021-44832 - https://logging.apache.org/log4j/2.x/security.html.  Proof-of-Concept exploit code is available for these CVEs. Users should check their Log4J 2 configuration and apply mitigations as described in either the above article or per their vendor guidance https://www.vmware.com/security/advisories/VMSA-2021-0028.html&quot;</span><span class="p">,</span>
      <span class="s2">&quot;reference&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;research&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;service_id&quot;</span><span class="p">:</span> <span class="s2">&quot;44096166-3213-43c9-8c0e-27945a7fd8ce&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Needs Investigation&quot;</span><span class="p">,</span>
      <span class="s2">&quot;target_temptation&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
      <span class="s2">&quot;tech_category&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Network Services&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;temptation_last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-04-07T20:59:44.451528+00:00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;user_tags&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Cert Expire 60&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Google&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Wildcard Cert&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;VMware&quot;</span><span class="p">,</span>
      <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;entity_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://app.randori.io/xxxx/targets/2755b843-9d38-457e-b4a3-3a8d27c47a9c&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2755b843-9d38-457e-b4a3-3a8d27c47a9c&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">29154</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-12-01 10:05:54&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script to Update Custom Fields:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">map_temptation</span><span class="p">(</span><span class="n">temptation_score</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">temptation_score</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;In Review&quot;</span>

  <span class="k">if</span> <span class="n">temptation_score</span> <span class="o">&lt;=</span> <span class="mi">14</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Low&quot;</span>
  <span class="k">elif</span> <span class="n">temptation_score</span> <span class="o">&gt;=</span> <span class="mi">15</span> <span class="ow">and</span> <span class="n">temptation_score</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Medium&quot;</span>
  <span class="k">elif</span> <span class="n">temptation_score</span> <span class="o">&gt;=</span> <span class="mi">30</span> <span class="ow">and</span> <span class="n">temptation_score</span> <span class="o">&lt;=</span> <span class="mi">39</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;High&quot;</span>
  <span class="k">elif</span> <span class="n">temptation_score</span> <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Critical&quot;</span>

<span class="n">target_data</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">target_data</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">target_data</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Update custom fields: Unable to get target data to update custom fields.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">target_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">target_data</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{})</span>
  <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
    <span class="c1"># Update custom fields with Randori target data</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_status</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_impact_score</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;impact_score&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_temptation</span> <span class="o">=</span> <span class="n">map_temptation</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;target_temptation&quot;</span><span class="p">))</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_vendor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vendor&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_version</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_authority</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;authority&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_affiliation_state</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;affiliation_state&quot;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_perspective_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;perspective_name&quot;</span><span class="p">)</span>
    <span class="n">entity_url</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entity_url&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">entity_url</span><span class="p">:</span>
      <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_link</span> <span class="o">=</span> <span class="s2">&quot;&lt;a target=&#39;_blank&#39; href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;Link&lt;/a&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entity_url</span><span class="p">)</span>

    <span class="n">tech_category</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tech_category&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="n">tech_category</span><span class="p">:</span>
      <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_tech_category</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tech_category</span><span class="p">)</span>

    <span class="n">user_tags</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_tags&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="n">user_tags</span><span class="p">:</span>
      <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_user_tags</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">user_tags</span><span class="p">)</span>
        
    <span class="n">characteristic_tags</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;characteristic_tags&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="n">user_tags</span><span class="p">:</span>
      <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_characteristic_tags</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">characteristic_tags</span><span class="p">)</span>
    
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Update Target Data in SOAR script updated custom fields in SOAR.&quot;</span><span class="p">)</span>
    
    <span class="c1"># Add Randori note</span>
    <span class="n">randori_notes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;randori_notes&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">randori_notes</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Created by Randori:&lt;/b&gt;&lt;br&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randori_notes</span><span class="p">)))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-send-note-as-comment-to-target">
<h2>Function - Randori: Send Note as Comment to Target<a class="headerlink" href="#function-randori-send-note-as-comment-to-target" title="Link to this heading">#</a></h2>
<p>Post a SOAR note as a comment in the corresponding Randori target.</p>
<p><img alt="screenshot: fn-randori-send-note-as-comment-to-target " src="../_images/fn-randori-send-note-as-comment-to-target.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_comment_text</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Added note from Randori Target&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-02T17:37:25.576771+00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;af217af0-b6d6-4659-86b0-5fc876eac7e8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;is_author&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;is_bulk_applied&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;QRadar SOAR Development&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rel_id&quot;</span><span class="p">:</span> <span class="s2">&quot;16543836-9b71-4614-8c73-4a5b440a8c62&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ACTIVE&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_comment_text&quot;</span><span class="p">:</span> <span class="s2">&quot;Added note from Randori Target&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5dbcb688-8591-4574-ad18-6cbc27a1941c&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">10124</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-02 13:37:29&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">None</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-update-notes-from-randori-target">
<h2>Function - Randori: Update Notes from Randori Target<a class="headerlink" href="#function-randori-update-notes-from-randori-target" title="Link to this heading">#</a></h2>
<p>Query Randori target and add any new notes to the SOAR case.</p>
<p><img alt="screenshot: fn-randori-update-notes-from-randori-target " src="../_images/fn-randori-update-notes-from-randori-target.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incident_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="mi">2675</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;80c039c4-625b-42fb-a8f1-3888db45d29e&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">262</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-07 11:28:54&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">incident_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_id</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">note_data</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">note_data</span>

<span class="c1"># Edit note in SOAR to indicate it was sent to Randori</span>
<span class="k">if</span> <span class="n">note_data</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="c1"># Get the current time</span>
  <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
  <span class="n">note</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&lt;b&gt;Sent to Randori at </span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;br&gt;</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-update-target-impact-score">
<h2>Function - Randori: Update Target Impact Score<a class="headerlink" href="#function-randori-update-target-impact-score" title="Link to this heading">#</a></h2>
<p>Update the specified target in Randori with the specified target impact score.</p>
<p><img alt="screenshot: fn-randori-update-target-impact-score " src="../_images/fn-randori-update-target-impact-score.png" /></p>
<p>The following activation pop-up dialog box prompts the user for input for updating the target impact score in Randori and allows for input of an optional note to be post to Randori as a target comment.</p>
<p><img alt="screenshot: fn-randori-update-target-impact-score " src="../_images/update-impact-score.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_note</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_impact_score</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_note&quot;</span><span class="p">:</span> <span class="s2">&quot;from SOAR&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5dbcb688-8591-4574-ad18-6cbc27a1941c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_impact_score&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">626</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-07 13:08:40&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_impact_score</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_impact_score</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">randori_note</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_note</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">target_impact_score</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">target_impact_score</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">target_impact_score</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: ERROR: Unable to Update Target Impact Score to &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_impact_score</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_impact_score</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_impact_score</span> <span class="o">=</span> <span class="n">target_impact_score</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_impact_score</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Updated Target Impact Score to &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt; in Randori&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_impact_score</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-randori-update-target-status">
<h2>Function - Randori: Update Target Status<a class="headerlink" href="#function-randori-update-target-status" title="Link to this heading">#</a></h2>
<p>Update the specified target in Randori with the specified target status and /or impact score.</p>
<p><img alt="screenshot: fn-randori-update-target-status " src="../_images/fn-randori-update-target-status.png" /></p>
<p>The following activation pop-up dialog box prompts the user for input for updating the target status in Randori and allows for input of an optional note to be post in Randori as a target comment.</p>
<p><img alt="screenshot: update-target-status " src="../_images/update-target-status.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_note</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">randori_target_status</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_note&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">div class=</span><span class="se">\&quot;</span><span class="s2">rte</span><span class="se">\&quot;\u003e\u003c</span><span class="s2">div</span><span class="se">\u003e</span><span class="s2">marking as resolved from SOAR</span><span class="se">\u003c</span><span class="s2">/div</span><span class="se">\u003e\u003c</span><span class="s2">/div</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5dbcb688-8591-4574-ad18-6cbc27a1941c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_status&quot;</span><span class="p">:</span> <span class="s2">&quot;Accepted&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">704</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;MacBook-Pro.local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-randori&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-07 13:14:30&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mf">2.0</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_id</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_status</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_status</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">randori_note</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_note</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">target_status</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">target_status</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">target_status</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: ERROR: Unable to Update Target Status to &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_status</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_status</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_status</span> <span class="o">=</span> <span class="n">target_status</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">randori_target_status</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;Randori: Updated Target Status to &lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt; in Randori&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">randori_target_status</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="data-table-detections">
<h2>Data Table - Detections<a class="headerlink" href="#data-table-detections" title="Link to this heading">#</a></h2>
<p>The Detections data table displays the detections found for a target.  A Detection describes one of possibly many ways an attacker could navigate to a specific Target.</p>
<p><img alt="screenshot: dt-detections" src="../_images/dt-detections.png" /></p>
</section>
<section id="data-table-discovery-path">
<h2>Data Table - Discovery Path<a class="headerlink" href="#data-table-discovery-path" title="Link to this heading">#</a></h2>
<p>The Discovery Path data table replicates the Discovery Path table found in Randori.  The discovery path shows exact research steps taken by Randori, or an attacker, to find an entity.  The <strong>View Details</strong> link takes you to Randori for more information on that entity.</p>
<p><img alt="screenshot: dt-discovery-path" src="../_images/dt-discovery-path.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">#</a></h3>
<p>randori_detections_dt</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Date Added</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_date_added</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>First Seen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_first_seen</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Hostname</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_hostname</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_ip</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Last Seen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_last_seen</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Path</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_path</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Port</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_dt_port</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">#</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Affiliation State</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_affiliation_state</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Authority</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_authority</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Characteristic Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_characteristic_tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Target ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Impact Score</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_impact_score</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Link to Target</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_link</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Perspective Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_perspective_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Service Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Service Vendor</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_vendor</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Service Version</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_version</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Target Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>User Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_user_tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Tech Category</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_tech_category</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Target Temptation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">randori_target_temptation</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">#</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Randori: Automatic Add Artifacts of Detections</p></td>
<td><p>Automatic playbook to add artifacts of a detection as artifacts in SOAR.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Randori: Automatic Add Detections to Detections Data Table</p></td>
<td><p>Automatic playbook to add detections to Detections data tables.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Randori: Automatic Add Target Notes</p></td>
<td><p>Automatic playbook to add Randori notes to the case on case creation.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Randori: Automatic Close Target</p></td>
<td><p>Close a target in Randori if the Case is closed in SOAR.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Randori: Create Artifacts from Detection</p></td>
<td><p>Add the column values of the Detections data table row as artifacts in SOAR. Types created are File Path, IP Address, Port and DNS Name.</p></td>
<td><p>randori_detections_dt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Randori: Send SOAR Note to Randori Target</p></td>
<td><p>Send a SOAR note to the corresponding target as a comment in Randori. Edit the note in SOAR to incident was sent to Randori so the note is not sent more than once.</p></td>
<td><p>note</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Randori: Update Detections Data Table</p></td>
<td><p>Update the Detections data table. Get the detections data from Randori, clear the data table and then update with the data.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Randori: Automatic Update Target Data in SOAR</p></td>
<td><p>Automatic playbook to update the Randori target custom field data in SOAR.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Randori: Update Target Impact Score in Randori</p></td>
<td><p>Update the Impact Score of the target in Randori.  If an optional note is specified post that as a comment in the Randori target.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Randori: Update Target in SOAR</p></td>
<td><p>Manual Playbook to update the Randori target custom field data in SOAR.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Randori: Update Target Notes</p></td>
<td><p>Update notes in SOAR with comments from the corresponding target in Randori.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Randori: Update Target Status in Randori</p></td>
<td><p>Update the status of the specified Randori target in Randori.  Add optional note as a comment in Randori.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="templates-for-soar-cases">
<h2>Templates for SOAR Cases<a class="headerlink" href="#templates-for-soar-cases" title="Link to this heading">#</a></h2>
<p>It may necessary to modify the templates used to create or close SOAR cases based on a customer’s required custom fields. Below are the default templates used which can be copied, modified and used with app_config’s
<code class="docutils literal notranslate"><span class="pre">soar_create_case_template</span></code> and <code class="docutils literal notranslate"><span class="pre">soar_close_case_template</span></code> settings to override the default templates.</p>
<section id="soar-create-case-jinja">
<h3>soar_create_case.jinja<a class="headerlink" href="#soar-create-case-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{
  {# JINJA template for creating a new SOAR case from an endpoint #}
  {# See https://ibmresilient.github.io/resilient-python-api/pages/resilient-lib/resilient-lib.html#module-resilient_lib.components.templates_common
     for details on available jinja methods. Examples for `soar_substitute` and more are included below.
  #}
  &quot;name&quot;: &quot;Randori Target - {{ vendor }}, {{ name }} {{ version }}&quot;,
  &quot;description&quot;: &quot;{{ description | replace(&#39;&quot;&#39;, &#39;\\&quot;&#39;) }}&quot;,
  {# start_date cannot be after discovered_date #}
  {% set start_date = first_seen if first_seen &lt;= target_first_seen else target_first_seen %}
  &quot;discovered_date&quot;: {{ target_first_seen | soar_datetimeformat(split_at=&#39;.&#39;) }},
  &quot;start_date&quot;: {{ start_date| soar_datetimeformat(split_at=&#39;.&#39;) }},
  {# if alert users are different than SOAR users, consider using a mapping table using soar_substitute: #}
  &quot;plan_status&quot;: &quot;A&quot;,
  {% if priority_score &lt;= 20 %}
    &quot;severity_code&quot;: &quot;Low&quot;,
  {% elif priority_score &lt;= 29.98%}
    &quot;severity_code&quot;: &quot;Medium&quot;,
  {% else %}
    &quot;severity_code&quot;: &quot;High&quot;,
  {% endif %}
  {# specify your custom fields for your endpoint solution #}
  &quot;properties&quot;: {
    &quot;randori_target_id&quot;: &quot;{{ target_id }}&quot;,
    {% if target_temptation is not none %}
        {% if target_temptation &lt;= 14 %}
          &quot;randori_target_temptation&quot;: &quot;Low&quot;,
        {% elif target_temptation &gt;= 15 and target_temptation &lt;= 29 %}
          &quot;randori_target_temptation&quot;: &quot;Medium&quot;,
        {% elif target_temptation &gt;= 30 and target_temptation &lt;= 39 %}
          &quot;randori_target_temptation&quot;: &quot;High&quot;,
        {% elif target_temptation &gt;= 40 %}
          &quot;randori_target_temptation&quot;: &quot;Critical&quot;,
        {% endif %}
    {% else %}
        &quot;randori_target_temptation&quot;: &quot;In Review&quot;,
    {% endif %}

    &quot;randori_target_status&quot;: &quot;{{ status }}&quot;,
    &quot;randori_target_link&quot;: &quot;&lt;a target=&#39;_blank&#39; href=&#39;{{ entity_url }}&#39;&gt;Link&lt;/a&gt;&quot;
  }
}
</pre></div>
</div>
</section>
<section id="soar-close-case-jinja">
<h3>soar_close_case.jinja<a class="headerlink" href="#soar-close-case-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for closing a SOAR case using endpoint data #}</span>
  <span class="s2">&quot;plan_status&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
  <span class="s2">&quot;resolution_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status | soar_substitute(&#39;{&quot;</span><span class="n">Accepted</span><span class="s2">&quot;: &quot;</span><span class="n">Not</span> <span class="n">an</span> <span class="n">Issue</span><span class="s2">&quot;, &quot;</span><span class="n">Mitigated</span><span class="s2">&quot;: &quot;</span><span class="n">Resolved</span><span class="s2">&quot;}&#39;) }}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;resolution_summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Closed by Randori, Target Status: {{ status }}&quot;</span>
  <span class="p">{</span><span class="c1"># add additional fields based on your &#39;on close&#39; field requirements #}</span>
  <span class="p">{</span><span class="c1">#</span>
  <span class="p">,</span><span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;randori_target_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status }}&quot;</span>
  <span class="p">}</span>
  <span class="c1">#}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="soar-update-case-jinja">
<h3>soar_update_case.jinja<a class="headerlink" href="#soar-update-case-jinja" title="Link to this heading">#</a></h3>
<p>When overriding the template in App Host, specify the file path as <code class="docutils literal notranslate"><span class="pre">/var/rescircuits</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="p">{</span><span class="c1"># JINJA template for updating a new SOAR case from an endpoint #}</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">priority_score</span> <span class="o">&lt;=</span> <span class="mi">20</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">priority_score</span> <span class="o">&lt;=</span> <span class="mf">29.98</span><span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
  <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;severity_code&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
  <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;randori_target_affiliation_state&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ affiliation_state }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_authority&quot;</span><span class="p">:</span> <span class="p">{{</span> <span class="n">authority</span> <span class="o">|</span> <span class="n">lower</span> <span class="p">}},</span>

    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">target_temptation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">none</span> <span class="o">%</span><span class="p">}</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">target_temptation</span> <span class="o">&lt;=</span> <span class="mi">14</span> <span class="o">%</span><span class="p">}</span>
          <span class="s2">&quot;randori_target_temptation&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">target_temptation</span> <span class="o">&gt;=</span> <span class="mi">15</span> <span class="ow">and</span> <span class="n">target_temptation</span> <span class="o">&lt;=</span> <span class="mi">29</span> <span class="o">%</span><span class="p">}</span>
          <span class="s2">&quot;randori_target_temptation&quot;</span><span class="p">:</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">target_temptation</span> <span class="o">&gt;=</span> <span class="mi">30</span> <span class="ow">and</span> <span class="n">target_temptation</span> <span class="o">&lt;=</span> <span class="mi">39</span> <span class="o">%</span><span class="p">}</span>
          <span class="s2">&quot;randori_target_temptation&quot;</span><span class="p">:</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">target_temptation</span> <span class="o">&gt;=</span> <span class="mi">40</span> <span class="o">%</span><span class="p">}</span>
          <span class="s2">&quot;randori_target_temptation&quot;</span><span class="p">:</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
          <span class="s2">&quot;randori_target_temptation&quot;</span><span class="p">:</span> <span class="s2">&quot;In Review&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>

    <span class="s2">&quot;randori_target_status&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ status }}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;randori_target_impact_score&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ impact_score }}&quot;</span><span class="p">,</span>

    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">tech_category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">none</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;randori_target_tech_category&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ tech_category | join(&#39;, &#39;) }}&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>

    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">user_tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">none</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;randori_target_user_tags&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ user_tags | join(&#39;, &#39;) }}&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>

    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">characteristic_tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">none</span> <span class="o">%</span><span class="p">}</span>
    <span class="s2">&quot;randori_target_characteristic_tags&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ characteristic_tags | join(&#39;, &#39;) }}&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>

    <span class="s2">&quot;randori_target_perspective_name&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ perspective_name }}&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">#</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">#</a></h3>
<p>This is an IBM supported app. Please search <a class="reference external" href="https://ibm.com/mysupport">ibm.com/mysupport</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_reaqta/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">QRadar EDR (formally IBM ReaQta)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_query_tor_network/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">TOR</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, IBM Security QRadar SOAR
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Randori</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents <!-- omit in toc --></a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#randori-development-version">Randori Development Version</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#poller-considerations">Poller Considerations</a><ul>
<li><a class="reference internal" href="#target-filtering">Target Filtering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-randori-clear-data-table">Function - Randori: Clear Data Table</a></li>
<li><a class="reference internal" href="#function-randori-get-detections-of-target">Function - Randori: Get Detections of Target</a></li>
<li><a class="reference internal" href="#function-randori-get-paths">Function - Randori: Get Paths</a></li>
<li><a class="reference internal" href="#function-randori-get-target">Function - Randori: Get Target</a></li>
<li><a class="reference internal" href="#function-randori-send-note-as-comment-to-target">Function - Randori: Send Note as Comment to Target</a></li>
<li><a class="reference internal" href="#function-randori-update-notes-from-randori-target">Function - Randori: Update Notes from Randori Target</a></li>
<li><a class="reference internal" href="#function-randori-update-target-impact-score">Function - Randori: Update Target Impact Score</a></li>
<li><a class="reference internal" href="#function-randori-update-target-status">Function - Randori: Update Target Status</a></li>
<li><a class="reference internal" href="#data-table-detections">Data Table - Detections</a></li>
<li><a class="reference internal" href="#data-table-discovery-path">Data Table - Discovery Path</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#templates-for-soar-cases">Templates for SOAR Cases</a><ul>
<li><a class="reference internal" href="#soar-create-case-jinja">soar_create_case.jinja</a></li>
<li><a class="reference internal" href="#soar-close-case-jinja">soar_close_case.jinja</a></li>
<li><a class="reference internal" href="#soar-update-case-jinja">soar_update_case.jinja</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>