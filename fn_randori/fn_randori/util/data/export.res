{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "export_date": 1670886395667,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": true,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/randori_target_status",
      "hide_notification": false,
      "id": 296,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "randori_target_status",
      "tooltip": "",
      "type_id": 11,
      "uuid": "abc484a9-2a33-4162-9f39-873b2f917bcf",
      "values": [
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Needs Investigation",
          "properties": null,
          "uuid": "fcc2bebe-b4bc-4966-84bc-38db1453b4e9",
          "value": 70
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Needs Resolution",
          "properties": null,
          "uuid": "0f3b66ba-6059-4941-bb6d-ba7d4cfc73e6",
          "value": 65
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Needs Review",
          "properties": null,
          "uuid": "6bf87a6f-7d40-435b-8363-7a53408f5934",
          "value": 66
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Accepted",
          "properties": null,
          "uuid": "00cbff45-02c2-4be8-a152-5164064cc6d2",
          "value": 56
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Mitigated",
          "properties": null,
          "uuid": "29137b00-448c-4ccc-a851-1dcf14ab2560",
          "value": 57
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "None",
          "properties": null,
          "uuid": "31114efd-c83b-471f-883a-8e8a2a490427",
          "value": 52
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/incident_id",
      "hide_notification": false,
      "id": 300,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "e1b5b365-9c80-4c0c-ad07-d4fed4828ddc",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/randori_note",
      "hide_notification": false,
      "id": 306,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_note",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "randori_note",
      "tooltip": "",
      "type_id": 11,
      "uuid": "0ae88277-12b1-452e-a4c8-314a7e1d031b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/randori_comment_text",
      "hide_notification": false,
      "id": 301,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_comment_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "randori_comment_text",
      "tooltip": "",
      "type_id": 11,
      "uuid": "0c6b82c0-14fb-4baa-a632-b60119408539",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/randori_data_table_name",
      "hide_notification": false,
      "id": 304,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_data_table_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "randori_data_table_name",
      "tooltip": "",
      "type_id": 11,
      "uuid": "22117ece-1b1e-4828-8da7-01849dfdf093",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/randori_target_impact_score",
      "hide_notification": false,
      "id": 295,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_impact_score",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "randori_target_impact_score",
      "tooltip": "",
      "type_id": 11,
      "uuid": "23ab668c-a95d-454d-abb5-7fa32fb4b3c8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/randori_target_id",
      "hide_notification": false,
      "id": 283,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "randori_target_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "24621a5a-cb1b-43af-8110-01013dbb3b19",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_authority",
      "hide_notification": false,
      "id": 273,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_authority",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Authority",
      "tooltip": "",
      "type_id": 0,
      "uuid": "a4314fa2-8d15-42df-8301-5463c6a05928",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_id",
      "hide_notification": false,
      "id": 274,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Target ID",
      "tooltip": "",
      "type_id": 0,
      "uuid": "a861c8f2-8aab-4f03-a379-ecf8a0680cbe",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_tech_category",
      "hide_notification": false,
      "id": 275,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_tech_category",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Tech Category",
      "tooltip": "",
      "type_id": 0,
      "uuid": "b2e4775e-98f2-4041-9b81-33482ce3bbf2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_perspective_name",
      "hide_notification": false,
      "id": 276,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_perspective_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Perspective Name",
      "tooltip": "",
      "type_id": 0,
      "uuid": "b73a8ef7-402e-49fd-8f55-5a439b0ae97e",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_link",
      "hide_notification": false,
      "id": 277,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_link",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": true,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Link to Target",
      "tooltip": "",
      "type_id": 0,
      "uuid": "d1470448-7bb8-4d02-bfc9-af342ab91761",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_affiliation_state",
      "hide_notification": false,
      "id": 278,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_affiliation_state",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Affiliation State",
      "tooltip": "",
      "type_id": 0,
      "uuid": "d9c41965-38ce-439c-b4ea-25f548810bc0",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_name",
      "hide_notification": false,
      "id": 319,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Service Name",
      "tooltip": "",
      "type_id": 0,
      "uuid": "f49dd3fd-e8a4-4245-9a8f-dc4a5d625624",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_vendor",
      "hide_notification": false,
      "id": 317,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_vendor",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Service Vendor",
      "tooltip": "",
      "type_id": 0,
      "uuid": "0635f6c7-303c-4c10-8a29-436c1361703f",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_characteristic_tags",
      "hide_notification": false,
      "id": 323,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_characteristic_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Characteristic Tags",
      "tooltip": "",
      "type_id": 0,
      "uuid": "1811258b-44dc-47c4-90aa-6f5a86ee3a7f",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_status",
      "hide_notification": false,
      "id": 299,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Target Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "1a4730da-3333-48c4-a4bc-211b4a0dc061",
      "values": [
        {
          "default": false,
          "enabled": false,
          "hidden": false,
          "label": "Needs Investigation",
          "properties": null,
          "uuid": "87f83841-466d-431f-b8d6-29c6cef4484a",
          "value": 77
        },
        {
          "default": false,
          "enabled": false,
          "hidden": false,
          "label": "None",
          "properties": null,
          "uuid": "6d14bf9c-e1ce-4828-8654-50125742d582",
          "value": 82
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_user_tags",
      "hide_notification": false,
      "id": 280,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_user_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "User Tags",
      "tooltip": "",
      "type_id": 0,
      "uuid": "2b21d499-cd74-49c2-a0ff-78e8326f5223",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_impact_score",
      "hide_notification": false,
      "id": 302,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_impact_score",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Impact Score",
      "tooltip": "",
      "type_id": 0,
      "uuid": "37a8637d-28e2-487d-9697-019847901ec4",
      "values": [
        {
          "default": false,
          "enabled": false,
          "hidden": false,
          "label": "None",
          "properties": null,
          "uuid": "307b54c2-b21b-4979-be66-62891b0f785a",
          "value": 83
        },
        {
          "default": false,
          "enabled": false,
          "hidden": false,
          "label": "Medium",
          "properties": null,
          "uuid": "8e443006-f9d4-46d4-a748-c319a784f43b",
          "value": 85
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_temptation",
      "hide_notification": false,
      "id": 281,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_temptation",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Target Temptation",
      "tooltip": "",
      "type_id": 0,
      "uuid": "66b82f38-f8bb-483c-bb8a-d79a3f46cedf",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/randori_target_version",
      "hide_notification": false,
      "id": 318,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "randori_target_version",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "Service Version",
      "tooltip": "",
      "type_id": 0,
      "uuid": "70e4c4a1-0c3c-4c3b-8234-b3f5a7e94e4e",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1667764529539,
      "description": {
        "content": "Clear the specified Randori data table",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Clear Data Table",
      "export_key": "randori_clear_data_table",
      "id": 9,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667827035559,
      "name": "randori_clear_data_table",
      "tags": [],
      "uuid": "007634bb-7d7f-4e62-b201-fd3563f827be",
      "version": 3,
      "view_items": [
        {
          "content": "e1b5b365-9c80-4c0c-ad07-d4fed4828ddc",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "22117ece-1b1e-4828-8da7-01849dfdf093",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1666894519376,
      "description": {
        "content": "Get the list detections of a specified Randori target given it\u0027s target Id.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Get Detections of Target",
      "export_key": "randori_get_detections_of_target",
      "id": 2,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1666894519396,
      "name": "randori_get_detections_of_target",
      "tags": [],
      "uuid": "42164ffc-b935-400a-9e25-ce20ca262c3c",
      "version": 1,
      "view_items": [
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1667939126437,
      "description": {
        "content": "The the paths data of a Randori target.  The paths data is displayed in the Discovery Path table in Randori and SOAR.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Get Paths",
      "export_key": "randori_get_paths",
      "id": 10,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1668106920561,
      "name": "randori_get_paths",
      "tags": [],
      "uuid": "a5177e7c-d677-4607-ae54-201b85301437",
      "version": 3,
      "view_items": [
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1666882474677,
      "description": {
        "content": "Get the target data for a single Randori target instance.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Get Target",
      "export_key": "randori_get_target",
      "id": 1,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1666882474733,
      "name": "randori_get_target",
      "tags": [],
      "uuid": "46339b52-4027-4e57-b854-0fbc457c8924",
      "version": 1,
      "view_items": [
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1667400054625,
      "description": {
        "content": "Post a SOAR note as a comment in the corresponding Randori target.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Send Note as Comment to Target",
      "export_key": "randori_send_note_as_comment_to_target",
      "id": 6,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667400054648,
      "name": "randori_send_note_as_comment_to_target",
      "tags": [],
      "uuid": "a56db20b-20c7-4751-9b74-bd82ec4c2d71",
      "version": 1,
      "view_items": [
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0c6b82c0-14fb-4baa-a632-b60119408539",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1667315059669,
      "description": {
        "content": "Query Randori target and add any new notes to the SOAR case.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Update Notes from Randori Target",
      "export_key": "randori_update_notes_from_randori_target",
      "id": 5,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667315059689,
      "name": "randori_update_notes_from_randori_target",
      "tags": [],
      "uuid": "7deecb02-2324-46a0-9b5b-79b43daabd6c",
      "version": 1,
      "view_items": [
        {
          "content": "e1b5b365-9c80-4c0c-ad07-d4fed4828ddc",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1667419767826,
      "description": {
        "content": "Update the specified target in Randori with the specified target impact score.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Update Target Impact Score",
      "export_key": "randori_update_target_impact_score",
      "id": 7,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667757137583,
      "name": "randori_update_target_impact_score",
      "tags": [],
      "uuid": "fc52d83b-ee18-405b-a819-c56aef3cdbcf",
      "version": 2,
      "view_items": [
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "23ab668c-a95d-454d-abb5-7fa32fb4b3c8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0ae88277-12b1-452e-a4c8-314a7e1d031b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1667229918635,
      "description": {
        "content": "Update the specified target in Randori with the specified target status and /or impact score.",
        "format": "text"
      },
      "destination_handle": "fn_randori",
      "display_name": "Randori: Update Target Status",
      "export_key": "randori_update_target_status",
      "id": 4,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667757118819,
      "name": "randori_update_target_status",
      "tags": [],
      "uuid": "f452d8b8-5f75-4b6b-9cde-40f496695abb",
      "version": 3,
      "view_items": [
        {
          "content": "24621a5a-cb1b-43af-8110-01013dbb3b19",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "abc484a9-2a33-4162-9f39-873b2f917bcf",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0ae88277-12b1-452e-a4c8-314a7e1d031b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 115,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1670886393553,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1670886393553,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "industries": null,
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_randori",
      "name": "fn_randori",
      "programmatic_name": "fn_randori",
      "tags": [],
      "users": [
        "admin@example.com"
      ],
      "uuid": "f6f9a8eb-164b-4838-8a26-23509603f77a"
    }
  ],
  "notifications": null,
  "overrides": [],
  "phases": [],
  "playbooks": [
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 1,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": 2,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 3,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "custom_condition": "(1 AND 2 AND 3)",
          "logic_type": "advanced"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 14,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_beae0dcd_063c_4523_8efb_04e30f399c34\" isExecutable=\"true\" name=\"playbook_beae0dcd_063c_4523_8efb_04e30f399c34\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1wef8tk\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Detections of Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"42164ffc-b935-400a-9e25-ce20ca262c3c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"detection_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1wef8tk\u003c/incoming\u003e\u003coutgoing\u003eFlow_1te1obp\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1wef8tk\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Randori: Add Detection Data as Artifacts\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"a7651621-c72c-4100-b787-fe29ceb21d74\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1te1obp\u003c/incoming\u003e\u003coutgoing\u003eFlow_0x7kfjf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1te1obp\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0x7kfjf\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0x7kfjf\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_beae0dcd_063c_4523_8efb_04e30f399c34\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0x7kfjf\" id=\"Flow_0x7kfjf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"534\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1te1obp\" id=\"Flow_1te1obp_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1wef8tk\" id=\"Flow_1wef8tk_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"198\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"534\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1666971484025,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_beae0dcd_063c_4523_8efb_04e30f399c34",
      "description": {
        "content": "Automatic playbook to add artifacts of a detection as artifacts in SOAR.",
        "format": "text"
      },
      "display_name": "Randori: Automatic Add Artifacts of Detections",
      "export_key": "randori_add_artifacts_of_detections",
      "field_type_handle": "playbook_beae0dcd_063c_4523_8efb_04e30f399c34",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Automatic Add Artifacts of Detections",
        "export_key": "playbook_beae0dcd_063c_4523_8efb_04e30f399c34",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_beae0dcd_063c_4523_8efb_04e30f399c34",
        "uuid": "ea578464-04e5-4a42-9857-dd1c968e12ae"
      },
      "has_logical_errors": false,
      "id": 5,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670340999365,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1666971909795,
          "description": "Add the Randori detections artifacts as artifacts in SOAR.",
          "enabled": false,
          "export_key": "Randori: Add Detection Data as Artifacts",
          "id": 6,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670014660676,
          "name": "Randori: Add Detection Data as Artifacts",
          "object_type": "incident",
          "playbook_handle": "randori_add_artifacts_of_detections",
          "programmatic_name": "randori_add_artifacts_of_detections_randori_add_detection_data_as_artifacts",
          "script_text": "detection_data = playbook.functions.results.detection_data\n\nif not detection_data.success:\n  incident.addNote(\"Randori: Get Target Data: Unable to get target data from Randori to create artifacts.\")\nelse:\n  content = detection_data.get(\"content\", {})\n  detection_list = detection_data.content.get(\"detection_list\", [])\n  for detection in detection_list:\n    \n    # Add artifacts\n    ip = detection.get(\"ip\")\n    if ip:\n      incident.addArtifact(\"IP Address\", ip, \"Artifact from Randori.\")\n      \n    port = detection.get(\"port\")\n    if port:\n      incident.addArtifact(\"Port\", str(port), \"Artifact from Randori.\")\n\n    hostname = detection.get(\"hostname\")\n    if hostname:\n      incident.addArtifact(\"DNS Name\", hostname, \"Artifact from Randori.\")\n      \n    path = detection.get(\"path\")\n    if path:\n      incident.addArtifact(\"File Path\", path, \"Artifact from Randori.\")\n      \n    service_name = detection.get(\"name\")\n    if service_name:\n      incident.addArtifact(\"Service\", service_name, \"Artifact from Randori.\")\n      \n  incident.addNote(\"Randori: automatic playbook added artifacts from {} detections\".format(len(detection_list)))",
          "tags": [],
          "uuid": "a7651621-c72c-4100-b787-fe29ceb21d74"
        }
      ],
      "name": "randori_add_artifacts_of_detections",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_beae0dcd-063c-4523-8efb-04e30f399c34",
        "id": 5,
        "name": "playbook_beae0dcd_063c_4523_8efb_04e30f399c34",
        "type": "playbook",
        "uuid": "ece545a0-ab5d-441c-8248-0b98cc382102"
      },
      "tags": [],
      "type": "default",
      "uuid": "beae0dcd-063c-4523-8efb-04e30f399c34",
      "version": 19
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 1,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": 2,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 3,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "custom_condition": "(1 AND 2 AND 3)",
          "logic_type": "advanced"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 24,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77\" isExecutable=\"true\" name=\"playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0z28n8w\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Detections of Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"42164ffc-b935-400a-9e25-ce20ca262c3c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"detection_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0z28n8w\u003c/incoming\u003e\u003coutgoing\u003eFlow_0wbstou\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0z28n8w\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Randori: Add Detections to Detections Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"65ad90ef-98d0-4d89-9cc6-830c1a38537d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ivmdvu\u003c/incoming\u003e\u003coutgoing\u003eFlow_16p18oq\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0wbstou\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_4\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_16p18oq\u003c/incoming\u003e\u003cincoming\u003eFlow_1k1lf9n\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_16p18oq\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003cexclusiveGateway default=\"Flow_01kgm31\" id=\"ConditionPoint_4\" resilient:documentation=\"Test Detections Success\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_0wbstou\u003c/incoming\u003e\u003coutgoing\u003eFlow_0h2o2lz\u003c/outgoing\u003e\u003coutgoing\u003eFlow_01kgm31\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"Randori: Clear Data Table\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"007634bb-7d7f-4e62-b201-fd3563f827be\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.incident_id = incident.id\\ninputs.randori_data_table_name = \\\"randori_detections_dt\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"clear_table_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0h2o2lz\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ivmdvu\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0ivmdvu\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_2\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Randori: unable to update Detections data table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"292047d4-baa9-4144-8c4f-f2bb960567e9\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_01kgm31\u003c/incoming\u003e\u003coutgoing\u003eFlow_1k1lf9n\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1k1lf9n\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_3\"/\u003e\u003csequenceFlow id=\"Flow_0h2o2lz\" name=\"Test if Detections data is success.\" sourceRef=\"ConditionPoint_4\" targetRef=\"ServiceTask_5\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"Test if Detections data is success.\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"result = playbook.functions.results.detection_data.success\\n\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_01kgm31\" name=\"Else\" sourceRef=\"ConditionPoint_4\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_01kgm31\" id=\"Flow_01kgm31_di\"\u003e\u003comgdi:waypoint x=\"779\" y=\"336\"/\u003e\u003comgdi:waypoint x=\"779\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"920\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"920\" y=\"428\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"838\" y=\"364\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0h2o2lz\" id=\"Flow_0h2o2lz_di\"\u003e\u003comgdi:waypoint x=\"779\" y=\"336\"/\u003e\u003comgdi:waypoint x=\"779\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"388\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"87\" x=\"646\" y=\"344\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1k1lf9n\" id=\"Flow_1k1lf9n_di\"\u003e\u003comgdi:waypoint x=\"920\" y=\"512\"/\u003e\u003comgdi:waypoint x=\"920\" y=\"610\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"610\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"644\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ivmdvu\" id=\"Flow_0ivmdvu_di\"\u003e\u003comgdi:waypoint x=\"600\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"508\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_16p18oq\" id=\"Flow_16p18oq_di\"\u003e\u003comgdi:waypoint x=\"600\" y=\"592\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"620\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"620\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"644\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wbstou\" id=\"Flow_0wbstou_di\"\u003e\u003comgdi:waypoint x=\"750\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"284\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0z28n8w\" id=\"Flow_0z28n8w_di\"\u003e\u003comgdi:waypoint x=\"750\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"646\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"652\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"502\" y=\"508\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"684\" y=\"644\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_4\" id=\"ConditionPoint_4_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"301.45\" x=\"628\" y=\"283.8000030517578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"502\" y=\"387.8000030517578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"822\" y=\"427.8000030517578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1666972112178,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77",
      "description": {
        "content": "Automatic playbook to add detections to Detections data tables.",
        "format": "text"
      },
      "display_name": "Randori: Automatic Add Detections to Detections Data Table",
      "export_key": "randori_add_detections_to_detections_data_table",
      "field_type_handle": "playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Automatic Add Detections to Detections Data Table",
        "export_key": "playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77",
        "uuid": "4f598c34-724b-4780-a581-6bf93a269e48"
      },
      "has_logical_errors": false,
      "id": 6,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670341025329,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1666972735149,
          "description": "Add detections data to Randori Detections data table.",
          "enabled": false,
          "export_key": "Randori: Add Detections to Detections Data Table",
          "id": 7,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670014941727,
          "name": "Randori: Add Detections to Detections Data Table",
          "object_type": "incident",
          "playbook_handle": "randori_add_detections_to_detections_data_table",
          "programmatic_name": "randori_add_detections_to_detections_data_table_randori_add_detections_to_detections_data_table",
          "script_text": "from datetime import datetime\nimport time\nimport calendar\n\ndef soar_datetimeformat(value, date_format=\"%Y-%m-%dT%H:%M:%S\", split_at=None):\n    \"\"\"Custom jinja filter to convert UTC dates to epoch format\n\n    Args:\n        value ([str]): [jinja provided field value]\n        date_format (str, optional): [conversion format]. Defaults to \"%Y-%m-%dT%H:%M:%S\".\n        split_at (str, optional): [character to split the date field to scope the date field.]\n            examples: split_at=\u0027.\u0027 to remove milliseconds for \"2021-10-22T20:53:53.913Z\",\n                      split_at=\u0027+\u0027 tp remove tz information \"2021-10-22T20:53:53+00:00\",\n    Returns:\n        [int]: [epoch value of datetime, in milliseconds]\n    \"\"\"\n    if not value:\n        return value\n\n    if split_at:\n        utc_time = time.strptime(value[:value.rfind(split_at)], date_format)\n    else:\n        utc_time = time.strptime(value, date_format)\n    return calendar.timegm(utc_time)*1000\n############################################################################################   \n\ndetection_data = playbook.functions.results.detection_data\n\nif not detection_data.success:\n  incident.addNote(\"Randori: Get Target Data: Unable to get target data from Randori\")\nelse:\n  content = detection_data.get(\"content\", {})\n  detection_list = detection_data.content.get(\"detection_list\", [])\n  for detection in detection_list:\n    detection_row = incident.addRow(\"randori_detections_dt\")\n    detection_row[\u0027randori_dt_date_added\u0027] = datetime.now()\n    detection_row[\u0027randori_dt_path\u0027] = detection.get(\"path\")\n    detection_row[\u0027randori_dt_port\u0027] = detection.get(\"port\")\n    detection_row[\u0027randori_dt_ip\u0027] = detection.get(\"ip\")\n    detection_row[\u0027randori_dt_hostname\u0027] = detection.get(\"hostname\")\n    detection_row[\u0027randori_dt_first_seen\u0027] = soar_datetimeformat(detection.get(\"first_seen\"), split_at=\u0027.\u0027)\n    detection_row[\u0027randori_dt_last_seen\u0027] = soar_datetimeformat(detection.get(\"last_seen\"), split_at=\u0027.\u0027)\n  incident.addNote(\"Randori: automatic playbook updated Detections data table with {} detections\".format(len(detection_list)))",
          "tags": [],
          "uuid": "65ad90ef-98d0-4d89-9cc6-830c1a38537d"
        },
        {
          "actions": [],
          "created_date": 1669911751720,
          "description": "",
          "enabled": false,
          "export_key": "Randori: unable to update Detections data table",
          "id": 24,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1669911751764,
          "name": "Randori: unable to update Detections data table",
          "object_type": "incident",
          "playbook_handle": "randori_add_detections_to_detections_data_table",
          "programmatic_name": "randori_add_detections_to_detections_data_table_randori_unable_to_update_detections_data_table",
          "script_text": "incident.addNote(\"Randori: Unable to update Detections data table.\")",
          "tags": [],
          "uuid": "292047d4-baa9-4144-8c4f-f2bb960567e9"
        }
      ],
      "name": "randori_add_detections_to_detections_data_table",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_a96f711c-09fc-4f05-8da6-8ee64ef5bc77",
        "id": 6,
        "name": "playbook_a96f711c_09fc_4f05_8da6_8ee64ef5bc77",
        "type": "playbook",
        "uuid": "b666857a-a7df-4fa4-82f6-ef0d024071b6"
      },
      "tags": [],
      "type": "default",
      "uuid": "a96f711c-09fc-4f05-8da6-8ee64ef5bc77",
      "version": 31
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 1,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": 2,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 3,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "custom_condition": "(1 AND 2 AND 3)",
          "logic_type": "advanced"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 15,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6\" isExecutable=\"true\" name=\"playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_180aswe\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Update Notes from Randori Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"7deecb02-2324-46a0-9b5b-79b43daabd6c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.incident_id = incident.id\\ninputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"note_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_180aswe\u003c/incoming\u003e\u003coutgoing\u003eFlow_1rjvxqo\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_180aswe\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_11pe46r\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1rjvxqo\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Randori: Check function to add new Randori notes\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"569ed600-2404-4987-9c67-43ef50b7fdda\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1rjvxqo\u003c/incoming\u003e\u003coutgoing\u003eFlow_11pe46r\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_11pe46r\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_11pe46r\" id=\"Flow_11pe46r_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"422\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"484\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1rjvxqo\" id=\"Flow_1rjvxqo_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"338\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_180aswe\" id=\"Flow_180aswe_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"484\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"337.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667564819743,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6",
      "description": {
        "content": "Automatic playbook to add Randori notes to the case on case creation.",
        "format": "text"
      },
      "display_name": "Randori: Automatic Add Target Notes",
      "export_key": "randori_add_target_notes",
      "field_type_handle": "playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Automatic Add Target Notes",
        "export_key": "playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6",
        "uuid": "6fe7ab13-3a86-4a5d-a06b-a975d68470c7"
      },
      "has_logical_errors": false,
      "id": 13,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670341050478,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667565852426,
          "description": "Check the status of function to add new notes from Randori.",
          "enabled": false,
          "export_key": "Randori: Check function to add new Randori notes",
          "id": 14,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667585616142,
          "name": "Randori: Check function to add new Randori notes",
          "object_type": "incident",
          "playbook_handle": "randori_add_target_notes",
          "programmatic_name": "randori_add_target_notes_randori_check_function_to_add_new_randori_notes",
          "script_text": "note_data = playbook.functions.results.note_data\n\nif note_data.success:\n  incident.addNote(\"Randori: automatic playbook added {} notes from Randori\".format(note_data.content.count))\nelse:\n  incident.addNote(\"Randori: ERROR in automatic playbook to get Randori notes - function not succcessful.\")",
          "tags": [],
          "uuid": "569ed600-2404-4987-9c67-43ef50b7fdda"
        }
      ],
      "name": "randori_add_target_notes",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_089ad55b-a0c3-4268-89c0-328b4d6dbef6",
        "id": 13,
        "name": "playbook_089ad55b_a0c3_4268_89c0_328b4d6dbef6",
        "type": "playbook",
        "uuid": "5200ddcc-2f2a-4c9d-bbba-b91adec8d61c"
      },
      "tags": [],
      "type": "default",
      "uuid": "089ad55b-a0c3-4268-89c0-328b4d6dbef6",
      "version": 20
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_id",
              "method": "changed",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_summary",
              "method": "not_contains",
              "type": null,
              "value": "Closed by Randori"
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 17,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec\" isExecutable=\"true\" name=\"playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0nx5nk0\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Update Target Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f452d8b8-5f75-4b6b-9cde-40f496695abb\"\u003e{\"inputs\":{\"24621a5a-cb1b-43af-8110-01013dbb3b19\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"abc484a9-2a33-4162-9f39-873b2f917bcf\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"STATUS_LOOKUP = {\\n  \u0027Unresolved\u0027: \\\"Accepted\\\",   # Unresolved\\n  \u0027Duplicate\u0027: \\\"Accepted\\\",   # Duplicate\\n  \u0027Not an Issue\u0027: \\\"Accepted\\\",   # Not an Issue\\n  \u0027Resolved\u0027: \\\"Mitigated\\\"  # Resolved\\n}\\n\\ninputs.randori_target_id = incident.properties.randori_target_id\\ninputs.randori_note = incident.resolution_summary.content\\ninputs.randori_target_status = STATUS_LOOKUP.get(incident.resolution_id, \\\"Accepted\\\")\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"status_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0nx5nk0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ligbmq\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0nx5nk0\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_06c6j95\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0ligbmq\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Randori: confirm status changed.\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"20150bfb-ea9c-4cbe-98c9-c388bdd1bc71\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ligbmq\u003c/incoming\u003e\u003coutgoing\u003eFlow_06c6j95\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_06c6j95\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_06c6j95\" id=\"Flow_06c6j95_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"412\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"484\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ligbmq\" id=\"Flow_0ligbmq_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"328\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0nx5nk0\" id=\"Flow_0nx5nk0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"198\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"484\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"327.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667755698494,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec",
      "description": {
        "content": "Close a target in Randori if the Case is closed in SOAR.",
        "format": "text"
      },
      "display_name": "Randori: Automatic Close Target",
      "export_key": "randori_close_target",
      "field_type_handle": "playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Automatic Close Target",
        "export_key": "playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec",
        "uuid": "81b50d4b-100a-431f-b0a2-253e88048e5b"
      },
      "has_logical_errors": false,
      "id": 16,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667858402625,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667834500252,
          "description": "Test if target status was successfully updated in Randori and output a note if it was not.",
          "enabled": false,
          "export_key": "Randori: confirm status changed.",
          "id": 18,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667857067817,
          "name": "Randori: confirm status changed.",
          "object_type": "incident",
          "playbook_handle": "randori_close_target",
          "programmatic_name": "randori_close_target_randori_confirm_status_changed",
          "script_text": "status_data = playbook.functions.results.status_data\n\nif not status_data.success:\n  incident.addNote(\"ERROR: unable to update target status in Randori\")\nelse:\n  incident.properties.randori_target_status = status_data.inputs.randori_target_status",
          "tags": [],
          "uuid": "20150bfb-ea9c-4cbe-98c9-c388bdd1bc71"
        }
      ],
      "name": "randori_close_target",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_e3cc0241-b468-4765-a1a1-45fadd2df1ec",
        "id": 16,
        "name": "playbook_e3cc0241_b468_4765_a1a1_45fadd2df1ec",
        "type": "playbook",
        "uuid": "d7051159-2b35-4aad-9459-c9036fe88eb9"
      },
      "tags": [],
      "type": "default",
      "uuid": "e3cc0241-b468-4765-a1a1-45fadd2df1ec",
      "version": 22
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 1,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": 2,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 3,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "custom_condition": "(1 AND 2 AND 3)",
          "logic_type": "advanced"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 10,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8\" isExecutable=\"true\" name=\"playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0iqfcxe\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Paths\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"a5177e7c-d677-4607-ae54-201b85301437\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"paths_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0iqfcxe\u003c/incoming\u003e\u003coutgoing\u003eFlow_1f0gipg\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0iqfcxe\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1xz4tyl\u003c/incoming\u003e\u003cincoming\u003eFlow_1u7yl3v\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Randori: Update the Discovery Path data table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"12209084-4c3d-43ef-aba6-8b1e2cbf776f\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1j1hfqo\u003c/incoming\u003e\u003coutgoing\u003eFlow_1xz4tyl\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1f0gipg\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_4\"/\u003e\u003csequenceFlow id=\"Flow_1xz4tyl\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003cexclusiveGateway default=\"Flow_1rbpcmt\" id=\"ConditionPoint_4\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_1f0gipg\u003c/incoming\u003e\u003coutgoing\u003eFlow_1pq2cbt\u003c/outgoing\u003e\u003coutgoing\u003eFlow_1rbpcmt\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"Randori: Clear Data Table\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"007634bb-7d7f-4e62-b201-fd3563f827be\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.incident_id = incident.id\\ninputs.randori_data_table_name = \\\"randori_discovery_path_dt\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"clear_table_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1pq2cbt\u003c/incoming\u003e\u003coutgoing\u003eFlow_1j1hfqo\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1j1hfqo\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Randori: Unable to update Discovery Pat data table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"891843cd-7dc5-4212-871c-a1e48e8637f6\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1rbpcmt\u003c/incoming\u003e\u003coutgoing\u003eFlow_1u7yl3v\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1u7yl3v\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_2\"/\u003e\u003csequenceFlow id=\"Flow_1pq2cbt\" name=\"Test Get Paths Success\" sourceRef=\"ConditionPoint_4\" targetRef=\"ServiceTask_5\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"Test Get Paths Success\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"result = playbook.functions.results.paths_data.success\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_1rbpcmt\" name=\"Else\" sourceRef=\"ConditionPoint_4\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1rbpcmt\" id=\"Flow_1rbpcmt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"357\"/\u003e\u003comgdi:waypoint x=\"920\" y=\"357\"/\u003e\u003comgdi:waypoint x=\"920\" y=\"388\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"809\" y=\"339\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1pq2cbt\" id=\"Flow_1pq2cbt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"332\"/\u003e\u003comgdi:waypoint x=\"540\" y=\"332\"/\u003e\u003comgdi:waypoint x=\"540\" y=\"358\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"75\" x=\"593\" y=\"314\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1u7yl3v\" id=\"Flow_1u7yl3v_di\"\u003e\u003comgdi:waypoint x=\"920\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"920\" y=\"523\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"523\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"574\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1j1hfqo\" id=\"Flow_1j1hfqo_di\"\u003e\u003comgdi:waypoint x=\"540\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"540\" y=\"468\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1xz4tyl\" id=\"Flow_1xz4tyl_di\"\u003e\u003comgdi:waypoint x=\"638\" y=\"510\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"510\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"574\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1f0gipg\" id=\"Flow_1f0gipg_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"222\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0iqfcxe\" id=\"Flow_0iqfcxe_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"96\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"138\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"44\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"138\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"684\" y=\"574\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"442\" y=\"468\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_4\" id=\"ConditionPoint_4_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"599\" y=\"253.8000030517578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"442\" y=\"357.8000030517578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"822\" y=\"387.8000030517578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1668089353387,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8",
      "description": {
        "content": "Update the Discovery Path data table on case creation.",
        "format": "text"
      },
      "display_name": "Randori: Automatic Update Discovery Path Data Table",
      "export_key": "randori_automatic_update_discovery_path_data_table",
      "field_type_handle": "playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Automatic Update Discovery Path Data Table",
        "export_key": "playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8",
        "uuid": "46f8c2c5-de88-48bb-bb2f-e3760f935fc3"
      },
      "has_logical_errors": false,
      "id": 21,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670437736125,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1669919370974,
          "description": "Write a note indicating data table cannot be refreshed.",
          "enabled": false,
          "export_key": "Randori: Unable to update Discovery Pat data table",
          "id": 26,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1669919371013,
          "name": "Randori: Unable to update Discovery Pat data table",
          "object_type": "incident",
          "playbook_handle": "randori_automatic_update_discovery_path_data_table",
          "programmatic_name": "randori_automatic_update_discovery_path_data_table_randori_unable_to_update_discovery_pat_data_table",
          "script_text": "incident.addNote(\"Randori: Unable to update Discovery Paths data table.\")",
          "tags": [],
          "uuid": "891843cd-7dc5-4212-871c-a1e48e8637f6"
        },
        {
          "actions": [],
          "created_date": 1669914650837,
          "description": "",
          "enabled": false,
          "export_key": "Randori: Unable to update Discovery Paths data table",
          "id": 25,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1669914650886,
          "name": "Randori: Unable to update Discovery Paths data table",
          "object_type": "incident",
          "playbook_handle": "randori_automatic_update_discovery_path_data_table",
          "programmatic_name": "randori_automatic_update_discovery_path_data_table_randori_unable_to_update_discovery_paths_data_table",
          "script_text": "incident.addNote(\"Randori: Unable to update Discovery Paths data table.\")",
          "tags": [],
          "uuid": "038debf7-1645-46ed-b336-9bcd07b6296d"
        },
        {
          "actions": [],
          "created_date": 1668089689967,
          "description": "Update the Discovery Path data table when the case is created.",
          "enabled": false,
          "export_key": "Randori: Update the Discovery Path data table",
          "id": 22,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670437462836,
          "name": "Randori: Update the Discovery Path data table",
          "object_type": "incident",
          "playbook_handle": "randori_automatic_update_discovery_path_data_table",
          "programmatic_name": "randori_automatic_update_discovery_path_data_table_randori_update_the_discovery_path_data_table",
          "script_text": "from datetime import datetime\n\n\ndef add_node_to_dt(node, randori_base_url):\n  \n  content = node.get(\"content\")\n\n  paths_dt_row = incident.addRow(\"randori_discovery_path_dt\")\n  paths_dt_row[\"randori_dt_date_added\"] = int(datetime.now().timestamp()*1000) \n    \n  if node.get(\"type\") == \"target\":\n    target_name = content.get(\"name\")\n    target_version = content.get(\"version\")\n    paths_dt_row[\"randori_dt_discovery_step\"] = \"{} {}\".format(target_name, target_version)\n  elif node.get(\"type\") == \"hostname\":\n    hostname = content.get(\"hostname\")\n    paths_dt_row[\"randori_dt_discovery_step\"] = \"{}\".format(hostname)\n    link = \"{}/hostnames/{}\".format(randori_base_url, node.get(\"id\"))\n    ref_html = u\"\"\"\u003ca href=\u0027{0}\u0027\u003eView Details\u003c/a\u003e\"\"\".format(link)\n    paths_dt_row[\"randori_dt_link\"] = helper.createRichText(ref_html)\n  elif node.get(\"type\") == \"ip\":\n    ip = content.get(\"ip_str\")\n    paths_dt_row[\"randori_dt_discovery_step\"] = \"{}\".format(ip)\n    link = \"{}/ips/{}\".format(randori_base_url, node.get(\"id\"))\n    ref_html = u\"\"\"\u003ca href=\u0027{0}\u0027\u003eView Details\u003c/a\u003e\"\"\".format(link)\n    paths_dt_row[\"randori_dt_link\"] = helper.createRichText(ref_html)\n  elif node.get(\"type\") == \"detection\":\n    hostname = content.get(\"hostname\")\n    ip = content.get(\"ip_str\")\n    paths_dt_row[\"randori_dt_discovery_step\"] = \"detection: {} {}\".format(hostname, ip)\n\n    \n#########################################################################################\npaths_data = playbook.functions.results.paths_data\n\nif not paths_data.success:\n  incident.addNote(\"Randori: Unable to get paths data to populate Discovery Path data table.\")\nelse:\n\n  paths_data_content = paths_data.get(\"content\")\n  randori_base_url = paths_data_content.get(\"base_url\")\n  data = paths_data_content.get(\u0027data\u0027)\n  edges = data.get(\"edges\")\n  nodes = data.get(\"nodes\")\n  paths_list_list = data.get(\"paths\")\n\n  for path_list in paths_list_list:\n    edge = None\n    for path in path_list:\n      edge = edges.get(path)\n      dst = edge.get(\"dst\")\n      node = nodes.get(dst)\n    \n      add_node_to_dt(node, randori_base_url)\n  \n      # Add edge type to the data table\n      paths_dt_row = incident.addRow(\"randori_discovery_path_dt\")\n      paths_dt_row[\"randori_dt_date_added\"] = int(datetime.now().timestamp()*1000) \n      paths_dt_row[\"randori_dt_discovery_step\"] = \"{}\".format(edge.get(\"type\"))\n\n    if edge is not None:\n      # Last node is the src\n      src = edge.get(\"src\")\n      node = nodes.get(src)\n      add_node_to_dt(node, randori_base_url)\n  \n  incident.addNote(\"Randori: Automatic playbook updated Discovery Path data table\")",
          "tags": [],
          "uuid": "12209084-4c3d-43ef-aba6-8b1e2cbf776f"
        }
      ],
      "name": "randori_automatic_update_discovery_path_data_table",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_18ae9bc1-7506-4e6e-851c-c0d2c980e5b8",
        "id": 21,
        "name": "playbook_18ae9bc1_7506_4e6e_851c_c0d2c980e5b8",
        "type": "playbook",
        "uuid": "408d3881-d65f-41b1-943c-815061813378"
      },
      "tags": [],
      "type": "default",
      "uuid": "18ae9bc1-7506-4e6e-851c-c0d2c980e5b8",
      "version": 14
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": 1,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": 2,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 4,
              "field_name": "incident.properties.randori_target_temptation",
              "method": "changed",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": 3,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "custom_condition": "(1 AND 2 AND 3) OR (1 AND 2 AND 4)",
          "logic_type": "advanced"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 31,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413\" isExecutable=\"true\" name=\"playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_043ls5x\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"46339b52-4027-4e57-b854-0fbc457c8924\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"target_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_043ls5x\u003c/incoming\u003e\u003coutgoing\u003eFlow_1i7ulx4\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_043ls5x\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_009pwov\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Randori: Update Target Data in SOAR\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"17beabef-9423-4f3e-b40c-9b48da36085c\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1i7ulx4\u003c/incoming\u003e\u003coutgoing\u003eFlow_009pwov\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1i7ulx4\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_009pwov\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_009pwov\" id=\"Flow_009pwov_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"554\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1i7ulx4\" id=\"Flow_1i7ulx4_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_043ls5x\" id=\"Flow_043ls5x_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"198\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"554\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1666886525354,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413",
      "description": {
        "content": "Automatic playbook to update the Randori target custom field data in SOAR.",
        "format": "text"
      },
      "display_name": "Randori: Automatic Update Target Data in SOAR",
      "export_key": "randori_update_target_data_in_soar",
      "field_type_handle": "playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Automatic Update Target Data in SOAR",
        "export_key": "playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413",
        "uuid": "1aee798f-dd03-4db9-a5d2-1f8b8b367f21"
      },
      "has_logical_errors": false,
      "id": 2,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670525752972,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1666886864836,
          "description": "Update the Randori target related custom fields and the randori notes in SOAR.",
          "enabled": false,
          "export_key": "Randori: Update Target Data in SOAR",
          "id": 3,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670525750626,
          "name": "Randori: Update Target Data in SOAR",
          "object_type": "incident",
          "playbook_handle": "randori_update_target_data_in_soar",
          "programmatic_name": "randori_update_target_data_in_soar_randori_update_target_data_in_soar",
          "script_text": "def map_temptation(temptation_score):\n  if not isinstance(temptation_score, int):\n    return \"In Review\"\n    \n  if temptation_score \u003c= 14:\n    return \"Low\"\n  elif temptation_score \u003e= 15 and temptation_score \u003c= 29:\n    return \"Medium\"\n  elif temptation_score \u003e= 30 and temptation_score \u003c= 39:\n    return \"High\"\n  elif temptation_score \u003e= 40:\n    return \"Critical\"\n    \ntarget_data = playbook.functions.results.target_data\n\nif not target_data.success:\n  incident.addNote(\"Randori: Update custom fields: Unable to get target data to update custom fields.\")\nelse:\n  content = target_data.get(\"content\", {})\n  data = target_data.content.get(\"data\", {})\n  if data:\n    # Update custom fields with Randori target data\n    if data.get(\"status\"):\n      incident.properties.randori_target_status = data.get(\"status\")\n    if data.get(\"impact_score\"):\n      incident.properties.randori_target_impact_score = data.get(\"impact_score\")\n    incident.properties.randori_target_temptation = map_temptation(data.get(\"target_temptation\"))\n    incident.properties.randori_target_name = data.get(\"name\")\n    incident.properties.randori_target_vendor = data.get(\"vendor\")\n    incident.properties.randori_target_version = data.get(\"version\")\n    incident.properties.randori_target_authority = data.get(\"authority\")\n    incident.properties.randori_target_affiliation_state = data.get(\"affiliation_state\")\n    incident.properties.randori_target_perspective_name = data.get(\"perspective_name\")\n    entity_url = content.get(\"entity_url\")\n    if entity_url:\n      incident.properties.randori_target_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027{0}\u0027\u003eLink\u003c/a\u003e\".format(entity_url)\n      \n    tech_category = data.get(\"tech_category\", [])\n    if tech_category:\n      incident.properties.randori_target_tech_category = \", \".join(tech_category)\n      \n    user_tags = data.get(\"user_tags\", [])\n    if user_tags:\n      incident.properties.randori_target_user_tags = \", \".join(user_tags)\n        \n    characteristic_tags = data.get(\"characteristic_tags\", [])\n    if user_tags:\n      incident.properties.randori_target_characteristic_tags = \", \".join(characteristic_tags)\n      \n    incident.addNote(\"Randori: Update Target Data in SOAR script updated custom fields in SOAR.\")\n    \n    # Add Randori note\n    randori_notes = data.get(\"randori_notes\")\n    if randori_notes:\n        incident.addNote(helper.createRichText(\"\u003cb\u003eCreated by Randori:\u003c/b\u003e\u003cbr\u003e {}\".format(randori_notes)))\n",
          "tags": [],
          "uuid": "17beabef-9423-4f3e-b40c-9b48da36085c"
        }
      ],
      "name": "randori_update_target_data_in_soar",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_ad15e092-fe90-43f6-8038-40ac9dd6a413",
        "id": 2,
        "name": "playbook_ad15e092_fe90_43f6_8038_40ac9dd6a413",
        "type": "playbook",
        "uuid": "5fc6b7a6-5c06-4d5c-a5cf-f02811282d11"
      },
      "tags": [],
      "type": "default",
      "uuid": "ad15e092-fe90-43f6-8038-40ac9dd6a413",
      "version": 37
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_c2b62754_313d_44e4_b02e_bbacb1243369\" isExecutable=\"true\" name=\"playbook_c2b62754_313d_44e4_b02e_bbacb1243369\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_04xlhm2\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cscriptTask id=\"ScriptTask_1\" name=\"Add Artifacts from Detections\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"499b3a6b-e1bf-4b34-b7ed-1077eb1c66a0\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_04xlhm2\u003c/incoming\u003e\u003coutgoing\u003eFlow_0w82nrt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0w82nrt\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_04xlhm2\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ScriptTask_1\"/\u003e\u003csequenceFlow id=\"Flow_0w82nrt\" sourceRef=\"ScriptTask_1\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_c2b62754_313d_44e4_b02e_bbacb1243369\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0w82nrt\" id=\"Flow_0w82nrt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"364\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_04xlhm2\" id=\"Flow_04xlhm2_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_1\" id=\"ScriptTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"364\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667505365599,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_c2b62754_313d_44e4_b02e_bbacb1243369",
      "description": {
        "content": "Add the column values of the Detections data table row as artifacts in SOAR. Types created are File Path, IP Address, Port and DNS Name. ",
        "format": "text"
      },
      "display_name": "Randori: Create Artifacts from Detection",
      "export_key": "randori_create_artifacts_from_detection",
      "field_type_handle": "playbook_c2b62754_313d_44e4_b02e_bbacb1243369",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Create Artifacts from Detection",
        "export_key": "playbook_c2b62754_313d_44e4_b02e_bbacb1243369",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_c2b62754_313d_44e4_b02e_bbacb1243369",
        "uuid": "eb27b4c7-5769-4630-a3bc-3e789607eed2"
      },
      "has_logical_errors": false,
      "id": 12,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670014872952,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667506692064,
          "description": "Create artifacts from the row in the Detections data table.",
          "enabled": false,
          "export_key": "Add Artifacts from Detections",
          "id": 13,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670014870100,
          "name": "Add Artifacts from Detections",
          "object_type": "randori_detections_dt",
          "playbook_handle": "randori_create_artifacts_from_detection",
          "programmatic_name": "randori_create_artifacts_from_detection_add_artifacts_from_detections",
          "script_text": "artifact_description = \"Artifact from Randori\"\nip = row.randori_dt_ip\nport = row.randori_dt_port\nhostname = row.randori_dt_hostname\npath = row.randori_dt_path\n\nif ip:\n  incident.addArtifact(\"IP Address\", ip, \"Artifact from Randori.\")\n      \nif port:\n  incident.addArtifact(\"Port\", str(port), \"Artifact from Randori.\")\n\nif hostname:\n  incident.addArtifact(\"DNS Name\", hostname, \"Artifact from Randori.\")\n      \nif path:\n  incident.addArtifact(\"File Path\", path, \"Artifact from Randori.\")\n\nservice_name = incident.properties.randori_target_name\nif service_name:\n  incident.addArtifact(\"Service\", service_name, \"Artifact from Randori.\")",
          "tags": [],
          "uuid": "499b3a6b-e1bf-4b34-b7ed-1077eb1c66a0"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "randori_create_artifacts_from_detection",
      "object_type": "randori_detections_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_c2b62754-313d-44e4-b02e-bbacb1243369",
        "id": 12,
        "name": "playbook_c2b62754_313d_44e4_b02e_bbacb1243369",
        "type": "playbook",
        "uuid": "ecf14bd3-50ac-460f-87c9-beb0efc38976"
      },
      "tags": [],
      "type": "default",
      "uuid": "c2b62754-313d-44e4-b02e-bbacb1243369",
      "version": 12
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 14,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_f2656efd_e403_4205_9e37_ded29a525928\" isExecutable=\"true\" name=\"playbook_f2656efd_e403_4205_9e37_ded29a525928\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1hwpe2p\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Send Note as Comment to Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"a56db20b-20c7-4751-9b74-bd82ec4c2d71\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\\ninputs.randori_comment_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"note_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1hwpe2p\u003c/incoming\u003e\u003coutgoing\u003eFlow_0pb55w0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1hwpe2p\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1fvy4m1\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0pb55w0\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Update SOAR Note to Indicate Sent to Randori\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"92c7afc4-eaab-4ed7-a904-e30eae913736\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0pb55w0\u003c/incoming\u003e\u003coutgoing\u003eFlow_1fvy4m1\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1fvy4m1\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_f2656efd_e403_4205_9e37_ded29a525928\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1fvy4m1\" id=\"Flow_1fvy4m1_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"432\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"524\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0pb55w0\" id=\"Flow_0pb55w0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"348\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1hwpe2p\" id=\"Flow_1hwpe2p_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"198\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"524\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"347.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667400100612,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_f2656efd_e403_4205_9e37_ded29a525928",
      "description": {
        "content": "Send a SOAR note to the corresponding target as a comment in Randori. Edit the note in SOAR to incident was sent to Randori so the note is not sent more than once.",
        "format": "text"
      },
      "display_name": "Randori: Send SOAR Note to Randori Target",
      "export_key": "randori_send_soar_note_to_randori_target",
      "field_type_handle": "playbook_f2656efd_e403_4205_9e37_ded29a525928",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Send SOAR Note to Randori Target",
        "export_key": "playbook_f2656efd_e403_4205_9e37_ded29a525928",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_f2656efd_e403_4205_9e37_ded29a525928",
        "uuid": "b0b3c6f4-30bb-432c-b70d-4b15cef0c4c0"
      },
      "has_logical_errors": false,
      "id": 10,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670883663820,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667410309883,
          "description": "Update SOAR Note to Indicate Sent to Randori.",
          "enabled": false,
          "export_key": "Update SOAR Note to Indicate Sent to Randori",
          "id": 11,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670883660654,
          "name": "Update SOAR Note to Indicate Sent to Randori",
          "object_type": "note",
          "playbook_handle": "randori_send_soar_note_to_randori_target",
          "programmatic_name": "randori_send_soar_note_to_randori_target_update_soar_note_to_indicate_sent_to_randori",
          "script_text": "from datetime import datetime\n\nnote_data = playbook.functions.results.note_data\n\n# Edit note in SOAR to indicate it was sent to Randori\nif note_data.success:\n  # Get the current time\n  now = datetime.now()\n  note.text = u\"\u003cb\u003eCreated by IBM SOAR: at {0}\u003c/b\u003e\u003cbr\u003e{1}\".format(now, note.text.content)",
          "tags": [],
          "uuid": "92c7afc4-eaab-4ed7-a904-e30eae913736"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Sent to Randori"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "randori_send_soar_note_to_randori_target",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_f2656efd-e403-4205-9e37-ded29a525928",
        "id": 10,
        "name": "playbook_f2656efd_e403_4205_9e37_ded29a525928",
        "type": "playbook",
        "uuid": "f4ce72cb-9d89-4543-925c-2d9207795cd4"
      },
      "tags": [],
      "type": "default",
      "uuid": "f2656efd-e403-4205-9e37-ded29a525928",
      "version": 20
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 20,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04\" isExecutable=\"true\" name=\"playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_11ruejc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Detections of Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"42164ffc-b935-400a-9e25-ce20ca262c3c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"detection_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_11ruejc\u003c/incoming\u003e\u003coutgoing\u003eFlow_045shtv\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_11ruejc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cexclusiveGateway default=\"Flow_0d4uxr0\" id=\"ConditionPoint_2\" resilient:documentation=\"Test Detections Success\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_045shtv\u003c/incoming\u003e\u003coutgoing\u003eFlow_0d4uxr0\u003c/outgoing\u003e\u003coutgoing\u003eFlow_1k8ftmw\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003csequenceFlow id=\"Flow_045shtv\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"Randori: Clear Data Table\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"007634bb-7d7f-4e62-b201-fd3563f827be\"\u003e{\"inputs\":{},\"pre_processing_script\":\"\\ninputs.incident_id = incident.id\\ninputs.randori_data_table_name = \\\"randori_detections_dt\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"clear_table_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1k8ftmw\u003c/incoming\u003e\u003coutgoing\u003eFlow_052cdpt\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_18fio3q\u003c/incoming\u003e\u003cincoming\u003eFlow_1u0ql2a\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"Update Detections Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"971b01ac-6362-4f5e-9716-c86c28f5acfc\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_052cdpt\u003c/incoming\u003e\u003coutgoing\u003eFlow_18fio3q\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_052cdpt\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_5\"/\u003e\u003csequenceFlow id=\"Flow_18fio3q\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_4\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Randori: Add unable to update Detections data table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"70a8cc2f-25ea-4eda-8644-be2f936ac1f1\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0d4uxr0\u003c/incoming\u003e\u003coutgoing\u003eFlow_1u0ql2a\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1u0ql2a\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_4\"/\u003e\u003csequenceFlow id=\"Flow_1k8ftmw\" name=\"Test if getting target Detections data is success.\" sourceRef=\"ConditionPoint_2\" targetRef=\"ServiceTask_3\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"Test if getting target Detections data is success.\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"result = playbook.functions.results.detection_data.success\\n\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_0d4uxr0\" name=\"Else\" sourceRef=\"ConditionPoint_2\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0d4uxr0\" id=\"Flow_0d4uxr0_di\"\u003e\u003comgdi:waypoint x=\"750\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"410\"/\u003e\u003comgdi:waypoint x=\"911\" y=\"410\"/\u003e\u003comgdi:waypoint x=\"911\" y=\"508\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"895\" y=\"455\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1k8ftmw\" id=\"Flow_1k8ftmw_di\"\u003e\u003comgdi:waypoint x=\"750\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"412\"/\u003e\u003comgdi:waypoint x=\"620\" y=\"412\"/\u003e\u003comgdi:waypoint x=\"620\" y=\"448\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"40\" width=\"86\" x=\"647\" y=\"370\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1u0ql2a\" id=\"Flow_1u0ql2a_di\"\u003e\u003comgdi:waypoint x=\"911\" y=\"592\"/\u003e\u003comgdi:waypoint x=\"911\" y=\"700\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"700\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"734\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_18fio3q\" id=\"Flow_18fio3q_di\"\u003e\u003comgdi:waypoint x=\"620\" y=\"662\"/\u003e\u003comgdi:waypoint x=\"620\" y=\"698\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"698\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"734\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_052cdpt\" id=\"Flow_052cdpt_di\"\u003e\u003comgdi:waypoint x=\"620\" y=\"532\"/\u003e\u003comgdi:waypoint x=\"620\" y=\"578\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_045shtv\" id=\"Flow_045shtv_di\"\u003e\u003comgdi:waypoint x=\"750\" y=\"202\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_11ruejc\" id=\"Flow_11ruejc_di\"\u003e\u003comgdi:waypoint x=\"750\" y=\"66\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"118\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"656\" y=\"14\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"652\" y=\"118\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_2\" id=\"ConditionPoint_2_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"301.45\" x=\"599\" y=\"254\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"522\" y=\"448\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"684\" y=\"734\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"522\" y=\"578\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"812.6040554962647\" y=\"507.50160085378866\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667764647505,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04",
      "description": {
        "content": "Update the Detections data table.\nGet the detections data from Randori, clear the data table and then update with the data. ",
        "format": "text"
      },
      "display_name": "Randori: Update Detections Data Table",
      "export_key": "randori_update_detections_data_table",
      "field_type_handle": "playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Update Detections Data Table",
        "export_key": "playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04",
        "uuid": "56bf5c0b-0e43-430f-8e8b-9b815eedc8de"
      },
      "has_logical_errors": false,
      "id": 17,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670352597064,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667766424897,
          "description": "",
          "enabled": false,
          "export_key": "Populate Detections data table",
          "id": 16,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667766424912,
          "name": "Populate Detections data table",
          "object_type": "incident",
          "playbook_handle": "randori_update_detections_data_table",
          "programmatic_name": "randori_update_detections_data_table_populate_detections_data_table",
          "script_text": "detections_data = playbook.functions.results.detections_data\n\n\n",
          "tags": [],
          "uuid": "f917c702-85b7-4b0a-b283-860bf6c52b0c"
        },
        {
          "actions": [],
          "created_date": 1667849127493,
          "description": "Add unable to update Detections data table.",
          "enabled": false,
          "export_key": "Randori: Add unable to update Detections data table",
          "id": 19,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667849127506,
          "name": "Randori: Add unable to update Detections data table",
          "object_type": "incident",
          "playbook_handle": "randori_update_detections_data_table",
          "programmatic_name": "randori_update_detections_data_table_randori_add_unable_to_update_detections_data_table",
          "script_text": "incident.addNote(\"Randori: Unable to update Detections data table.\")",
          "tags": [],
          "uuid": "70a8cc2f-25ea-4eda-8644-be2f936ac1f1"
        },
        {
          "actions": [],
          "created_date": 1667766670350,
          "description": "",
          "enabled": false,
          "export_key": "Update Detections Data Table",
          "id": 17,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670351888017,
          "name": "Update Detections Data Table",
          "object_type": "incident",
          "playbook_handle": "randori_update_detections_data_table",
          "programmatic_name": "randori_update_detections_data_table_update_detections_data_table",
          "script_text": "from datetime import datetime\nimport time\nimport calendar\n\ndef soar_datetimeformat(value, date_format=\"%Y-%m-%dT%H:%M:%S\", split_at=None):\n    \"\"\"Custom jinja filter to convert UTC dates to epoch format\n\n    Args:\n        value ([str]): [jinja provided field value]\n        date_format (str, optional): [conversion format]. Defaults to \"%Y-%m-%dT%H:%M:%S\".\n        split_at (str, optional): [character to split the date field to scope the date field.]\n            examples: split_at=\u0027.\u0027 to remove milliseconds for \"2021-10-22T20:53:53.913Z\",\n                      split_at=\u0027+\u0027 tp remove tz information \"2021-10-22T20:53:53+00:00\",\n    Returns:\n        [int]: [epoch value of datetime, in milliseconds]\n    \"\"\"\n    if not value:\n        return value\n\n    if split_at:\n        utc_time = time.strptime(value[:value.rfind(split_at)], date_format)\n    else:\n        utc_time = time.strptime(value, date_format)\n    return calendar.timegm(utc_time)*1000\n############################################################################################   \n\ndetection_data = playbook.functions.results.detection_data\n\nif not detection_data.success:\n  incident.addNote(\"Randori: Unable to update Detections data table - error getting detections data.\")\nelse:\n  clear_table_output = playbook.functions.results.clear_table_output\n  if not clear_table_output.success:\n    incident.addNote(\"Randori: ERROR - Unable to clear the Detections data table before updating it.\")\n  content = detection_data.get(\"content\", {})\n  detection_list = detection_data.content.get(\"detection_list\", [])\n  for detection in detection_list:\n    detection_row = incident.addRow(\"randori_detections_dt\")\n    detection_row[\u0027randori_dt_date_added\u0027] = datetime.now()\n    detection_row[\u0027randori_dt_path\u0027] = detection.get(\"path\")\n    detection_row[\u0027randori_dt_port\u0027] = detection.get(\"port\")\n    detection_row[\u0027randori_dt_ip\u0027] = detection.get(\"ip\")\n    detection_row[\u0027randori_dt_hostname\u0027] = detection.get(\"hostname\")\n    detection_row[\u0027randori_dt_first_seen\u0027] = soar_datetimeformat(detection.get(\"first_seen\"), split_at=\u0027.\u0027)\n    detection_row[\u0027randori_dt_last_seen\u0027] = soar_datetimeformat(detection.get(\"last_seen\"), split_at=\u0027.\u0027)\n  incident.addNote(\"Randori: manual playbook updated Detections data table with {} detections\".format(len(detection_list)))",
          "tags": [],
          "uuid": "971b01ac-6362-4f5e-9716-c86c28f5acfc"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "randori_update_detections_data_table",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_f6af091f-0d6b-4f64-b067-6602a8a80d04",
        "id": 17,
        "name": "playbook_f6af091f_0d6b_4f64_b067_6602a8a80d04",
        "type": "playbook",
        "uuid": "075e0ac6-cbab-4d67-a8a4-648f01a40c5a"
      },
      "tags": [],
      "type": "default",
      "uuid": "f6af091f-0d6b-4f64-b067-6602a8a80d04",
      "version": 25
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 52,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e\" isExecutable=\"true\" name=\"playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1fjqr98\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Paths\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"a5177e7c-d677-4607-ae54-201b85301437\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"paths_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1fjqr98\u003c/incoming\u003e\u003coutgoing\u003eFlow_1nydplc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1fjqr98\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_04o0o2j\u003c/incoming\u003e\u003cincoming\u003eFlow_1udknlb\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Randori: Populate the Discovery Path Data Table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"87b284a5-08ba-4efb-9b5c-a37b83d15c01\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1cfwcdg\u003c/incoming\u003e\u003coutgoing\u003eFlow_04o0o2j\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1nydplc\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_4\"/\u003e\u003csequenceFlow id=\"Flow_04o0o2j\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003cexclusiveGateway default=\"Flow_1jy4hez\" id=\"ConditionPoint_4\" resilient:documentation=\"Test Get Paths Success\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_1nydplc\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ei0yp8\u003c/outgoing\u003e\u003coutgoing\u003eFlow_1jy4hez\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003cserviceTask id=\"ServiceTask_5\" name=\"Randori: Clear Data Table\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"007634bb-7d7f-4e62-b201-fd3563f827be\"\u003e{\"inputs\":{},\"pre_processing_script\":\"\\ninputs.incident_id = incident.id\\ninputs.randori_data_table_name = \\\"randori_discovery_path_dt\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"clear_table_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ei0yp8\u003c/incoming\u003e\u003coutgoing\u003eFlow_1cfwcdg\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1cfwcdg\" sourceRef=\"ServiceTask_5\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Randori: Unable to update Discovery Paths data table\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"50759108-060c-48d1-8d06-9ab8e0734176\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1jy4hez\u003c/incoming\u003e\u003coutgoing\u003eFlow_1udknlb\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1udknlb\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_2\"/\u003e\u003csequenceFlow id=\"Flow_0ei0yp8\" name=\"Test Paths Data Success\" sourceRef=\"ConditionPoint_4\" targetRef=\"ServiceTask_5\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"Test Paths Data Success\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"result = playbook.functions.results.paths_data.success\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_1jy4hez\" name=\"Else\" sourceRef=\"ConditionPoint_4\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1jy4hez\" id=\"Flow_1jy4hez_di\"\u003e\u003comgdi:waypoint x=\"715\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"715\" y=\"370\"/\u003e\u003comgdi:waypoint x=\"940\" y=\"370\"/\u003e\u003comgdi:waypoint x=\"940\" y=\"428\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"794\" y=\"353\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ei0yp8\" id=\"Flow_0ei0yp8_di\"\u003e\u003comgdi:waypoint x=\"710\" y=\"306\"/\u003e\u003comgdi:waypoint x=\"710\" y=\"367\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"367\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"418\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"81\" x=\"603.9999999999999\" y=\"353.99999999999994\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1udknlb\" id=\"Flow_1udknlb_di\"\u003e\u003comgdi:waypoint x=\"940\" y=\"512\"/\u003e\u003comgdi:waypoint x=\"940\" y=\"580\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"580\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"664\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1cfwcdg\" id=\"Flow_1cfwcdg_di\"\u003e\u003comgdi:waypoint x=\"570\" y=\"502\"/\u003e\u003comgdi:waypoint x=\"570\" y=\"538\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_04o0o2j\" id=\"Flow_04o0o2j_di\"\u003e\u003comgdi:waypoint x=\"668\" y=\"580\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"580\"/\u003e\u003comgdi:waypoint x=\"750\" y=\"664\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nydplc\" id=\"Flow_1nydplc_di\"\u003e\u003comgdi:waypoint x=\"710\" y=\"222\"/\u003e\u003comgdi:waypoint x=\"710\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1fjqr98\" id=\"Flow_1fjqr98_di\"\u003e\u003comgdi:waypoint x=\"710\" y=\"76\"/\u003e\u003comgdi:waypoint x=\"710\" y=\"138\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"616\" y=\"24\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"612\" y=\"138\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"684\" y=\"664\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"472\" y=\"538\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_4\" id=\"ConditionPoint_4_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"294.783\" x=\"588\" y=\"254\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_5\" id=\"ServiceTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"472\" y=\"418\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"842\" y=\"428\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667939159864,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "Randori: Update Discovery Path Data Table",
      "export_key": "randori_update_discovery_path_data_table",
      "field_type_handle": "playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Update Discovery Path Data Table",
        "export_key": "playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e",
        "uuid": "0a61e0d9-ad3e-4e9c-b8fe-a1c663bcf80c"
      },
      "has_logical_errors": false,
      "id": 20,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670437346986,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667939396484,
          "description": "",
          "enabled": false,
          "export_key": "Randori: Populate the Discovery Path Data Table",
          "id": 21,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670437344038,
          "name": "Randori: Populate the Discovery Path Data Table",
          "object_type": "incident",
          "playbook_handle": "randori_update_discovery_path_data_table",
          "programmatic_name": "randori_update_discovery_path_data_table_randori_populate_the_discovery_path_data_table",
          "script_text": "\nfrom datetime import datetime\n\ndef add_node_to_dt(node, randori_base_url):\n  \n  content = node.get(\"content\")\n\n  row = incident.addRow(\"randori_discovery_path_dt\")\n  row[\"randori_dt_date_added\"] = int(datetime.now().timestamp()*1000) \n  \n  # For each node type formatting is different.\n  if node.get(\"type\") == \"target\":\n    target_name = content.get(\"name\")\n    target_version = content.get(\"version\")\n    row[\"randori_dt_discovery_step\"] = \"{} {}\".format(target_name, target_version)\n  elif node.get(\"type\") == \"hostname\":\n    hostname = content.get(\"hostname\")\n    row[\"randori_dt_discovery_step\"] = \"{}\".format(hostname)\n    link = \"{0}/hostnames/{1}\".format(randori_base_url, node.get(\"id\"))\n    ref_html = u\"\"\"\u003ca href=\u0027{0}\u0027\u003eView Details\u003c/a\u003e\"\"\".format(link)\n    row[\"randori_dt_link\"] = helper.createRichText(ref_html)\n  elif node.get(\"type\") == \"ip\":\n    ip = content.get(\"ip_str\")\n    row[\"randori_dt_discovery_step\"] = \"{}\".format(ip)\n    link = \"{0}/ips/{1}\".format(randori_base_url, node.get(\"id\"))\n    ref_html = u\"\"\"\u003ca href=\u0027{0}\u0027\u003eView Details\u003c/a\u003e\"\"\".format(link)\n    row[\"randori_dt_link\"] = helper.createRichText(ref_html)\n  elif node.get(\"type\") == \"detection\":\n    hostname = content.get(\"hostname\")\n    ip = content.get(\"ip_str\")\n    row[\"randori_dt_discovery_step\"] = \"detection: {} {}\".format(hostname, ip)\n\n    \n#########################################################################################\npaths_data = playbook.functions.results.paths_data\n\nif not paths_data.success:\n  incident.addNote(\"Randori: Unable to get paths data to populate Discovery Path data table.\")\nelse:\n\n  paths_data_content = paths_data.get(\"content\")\n  randori_base_url = paths_data_content.get(\"base_url\")\n  data = paths_data_content.get(\u0027data\u0027)\n  edges = data.get(\"edges\")\n  nodes = data.get(\"nodes\")\n  paths_list_list = data.get(\"paths\")\n\n  for path_list in paths_list_list:\n    edge = None\n    for path in path_list:\n      edge = edges.get(path)\n      dst = edge.get(\"dst\")\n      node = nodes.get(dst)\n      \n      # Add node to the data table\n      add_node_to_dt(node, randori_base_url)\n  \n      # Add edge type to the data table\n      row = incident.addRow(\"randori_discovery_path_dt\")\n      row[\"randori_dt_date_added\"] = int(datetime.now().timestamp()*1000) \n      row[\"randori_dt_discovery_step\"] = \"{}\".format(edge.get(\"type\"))\n      \n    if edge is not None:\n      # Last node is the src\n      src = edge.get(\"src\")\n      node = nodes.get(src)\n      add_node_to_dt(node, randori_base_url)\n  \n  incident.addNote(\"Randori: Discovery Path table refreshed.\")\n\n",
          "tags": [],
          "uuid": "87b284a5-08ba-4efb-9b5c-a37b83d15c01"
        },
        {
          "actions": [],
          "created_date": 1668094374890,
          "description": "Add a note to indicate error updating the data table.",
          "enabled": false,
          "export_key": "Randori: Unable to update Discovery Paths data table",
          "id": 23,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1668094374905,
          "name": "Randori: Unable to update Discovery Paths data table",
          "object_type": "incident",
          "playbook_handle": "randori_update_discovery_path_data_table",
          "programmatic_name": "randori_update_discovery_path_data_table_randori_unable_to_update_discovery_paths_data_table",
          "script_text": "incident.addNote(\"Randori: Unable to update Discovery Paths data table.\")",
          "tags": [],
          "uuid": "50759108-060c-48d1-8d06-9ab8e0734176"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "randori_update_discovery_path_data_table",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_1a703c9d-60c8-4761-ad11-5f3b42ff388e",
        "id": 20,
        "name": "playbook_1a703c9d_60c8_4761_ad11_5f3b42ff388e",
        "type": "playbook",
        "uuid": "2825e599-e9c4-40e9-b2ec-3a16634160fa"
      },
      "tags": [],
      "type": "default",
      "uuid": "1a703c9d-60c8-4761-ad11-5f3b42ff388e",
      "version": 57
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_85f5e332_938a_4a6f_902b_691cf5611de8\" isExecutable=\"true\" name=\"playbook_85f5e332_938a_4a6f_902b_691cf5611de8\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_076wzpv\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Update Target Impact Score\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fc52d83b-ee18-405b-a819-c56aef3cdbcf\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\\ninputs.randori_target_impact_score = playbook.inputs.randori_target_impact_score\\ninputs.randori_note = playbook.inputs.randori_note.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"target_impact_score\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_076wzpv\u003c/incoming\u003e\u003coutgoing\u003eFlow_03rl6jo\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_076wzpv\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Update Impact Score in Randori and SOAR\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"4ac1b2b7-c230-405c-8eff-5a5f77291cb2\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_03rl6jo\u003c/incoming\u003e\u003coutgoing\u003eFlow_11kmzm0\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_11kmzm0\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_03rl6jo\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003csequenceFlow id=\"Flow_11kmzm0\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_85f5e332_938a_4a6f_902b_691cf5611de8\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_11kmzm0\" id=\"Flow_11kmzm0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"514\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_03rl6jo\" id=\"Flow_03rl6jo_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_076wzpv\" id=\"Flow_076wzpv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"514\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667851511070,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
      "description": {
        "content": "Update the Impact Score of the target in Randori.  If an optional note is specified post that as a comment in the Randori target.",
        "format": "text"
      },
      "display_name": "Randori: Update Target Impact Score in Randori",
      "export_key": "randori_update_target_impact_score_in_randori",
      "field_type_handle": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Update Target Impact Score in Randori",
        "export_key": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
        "fields": {
          "randori_note": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8/randori_note",
            "hide_notification": false,
            "id": 310,
            "input_type": "textarea",
            "internal": false,
            "is_tracked": false,
            "name": "randori_note",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Note",
            "tooltip": "",
            "type_id": 1019,
            "uuid": "a11c6ca1-90bf-43cb-a269-6174f71794c1",
            "values": []
          },
          "randori_target_impact_score": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8/randori_target_impact_score",
            "hide_notification": false,
            "id": 311,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "randori_target_impact_score",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Impact Score",
            "tooltip": "",
            "type_id": 1019,
            "uuid": "14d1f7ef-a752-446a-9218-5e3582fcfbe8",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "None",
                "properties": null,
                "uuid": "ef0ec3e1-de9e-4306-888d-dfac41b1bae4",
                "value": 106
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Low",
                "properties": null,
                "uuid": "0521c8ea-3f48-414a-b6b8-fd4a5c032bb1",
                "value": 107
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Medium",
                "properties": null,
                "uuid": "bcabd849-c365-4d09-b911-2760eef82e66",
                "value": 108
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "High",
                "properties": null,
                "uuid": "5862b6a8-03bd-4f80-bfd3-0ec9924c1d54",
                "value": 109
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
        "uuid": "7b238fc4-8c9f-47bb-981a-20f2d2468649"
      },
      "has_logical_errors": false,
      "id": 19,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670694603855,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667851869642,
          "description": "If the Randori target impact score is updated in the calling function, then update the impact score custom field in SOAR and write the playbook results to a note.",
          "enabled": false,
          "export_key": "Update Impact Score in Randori and SOAR",
          "id": 20,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667852105081,
          "name": "Update Impact Score in Randori and SOAR",
          "object_type": "incident",
          "playbook_handle": "randori_update_target_impact_score_in_randori",
          "programmatic_name": "randori_update_target_impact_score_in_randori_update_impact_score_in_randori_and_soar",
          "script_text": "target_impact_score = playbook.functions.results.target_impact_score\n\nif not target_impact_score.success:\n  incident.addNote(\"Randori: ERROR: Unable to Update Target Impact Score to \u003cb\u003e{}\u003c/b\u003e\".format(target_impact_score.inputs.randori_target_impact_score))\nelse:\n  incident.properties.randori_target_impact_score = target_impact_score.inputs.randori_target_impact_score\n  incident.addNote(\"Randori: Updated Target Impact Score to \u003cb\u003e{}\u003c/b\u003e in Randori\".format(incident.properties.randori_target_impact_score))",
          "tags": [],
          "uuid": "4ac1b2b7-c230-405c-8eff-5a5f77291cb2"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "14d1f7ef-a752-446a-9218-5e3582fcfbe8",
            "element": "field_uuid",
            "field_type": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a11c6ca1-90bf-43cb-a269-6174f71794c1",
            "element": "field_uuid",
            "field_type": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "randori_update_target_impact_score_in_randori",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_85f5e332-938a-4a6f-902b-691cf5611de8",
        "id": 19,
        "name": "playbook_85f5e332_938a_4a6f_902b_691cf5611de8",
        "type": "playbook",
        "uuid": "49ed4eef-d873-40d5-a82a-22468e5b253d"
      },
      "tags": [],
      "type": "default",
      "uuid": "85f5e332-938a-4a6f-902b-691cf5611de8",
      "version": 8
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 19,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_71569df3_623d_4529_8611_3bdb61c44885\" isExecutable=\"true\" name=\"playbook_71569df3_623d_4529_8611_3bdb61c44885\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0jcmxfk\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Randori: Get Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"46339b52-4027-4e57-b854-0fbc457c8924\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"target_data\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0jcmxfk\u003c/incoming\u003e\u003coutgoing\u003eFlow_1s8bliw\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0jcmxfk\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1hwx7pf\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Update target custom fields\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"5af933f7-fce7-4086-8ce2-ceaeddfe7a89\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1s8bliw\u003c/incoming\u003e\u003coutgoing\u003eFlow_1hwx7pf\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1s8bliw\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1hwx7pf\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_71569df3_623d_4529_8611_3bdb61c44885\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1hwx7pf\" id=\"Flow_1hwx7pf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"514\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1s8bliw\" id=\"Flow_1s8bliw_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0jcmxfk\" id=\"Flow_0jcmxfk_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"126\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"74\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"514\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"358\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667578983100,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_71569df3_623d_4529_8611_3bdb61c44885",
      "description": {
        "content": "Manual Playbook to update the Randori target custom field data in SOAR.",
        "format": "text"
      },
      "display_name": "Randori: Update Target in SOAR",
      "export_key": "randori_update_target_in_soar",
      "field_type_handle": "playbook_71569df3_623d_4529_8611_3bdb61c44885",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Update Target in SOAR",
        "export_key": "playbook_71569df3_623d_4529_8611_3bdb61c44885",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_71569df3_623d_4529_8611_3bdb61c44885",
        "uuid": "f5957f6d-824b-451a-ba80-8a8f798ae457"
      },
      "has_logical_errors": false,
      "id": 14,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670448574419,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667579102460,
          "description": "Update target custom fields",
          "enabled": false,
          "export_key": "Update target custom fields",
          "id": 15,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1670447732357,
          "name": "Update target custom fields",
          "object_type": "incident",
          "playbook_handle": "randori_update_target_in_soar",
          "programmatic_name": "randori_update_target_in_soar_update_target_custom_fields",
          "script_text": "def map_temptation(temptation_score):\n  if not isinstance(temptation_score, int):\n    return \"In Review\"\n    \n  if temptation_score \u003c= 14:\n    return \"Low\"\n  elif temptation_score \u003e= 15 and temptation_score \u003c= 29:\n    return \"Medium\"\n  elif temptation_score \u003e= 30 and temptation_score \u003c= 39:\n    return \"High\"\n  elif temptation_score \u003e= 40:\n    return \"Critical\"\n    \ntarget_data = playbook.functions.results.target_data\n\nif not target_data.success:\n  incident.addNote(\"Randori: Update custom fields: Unable to get target data to update custom fields.\")\nelse:\n  content = target_data.get(\"content\", {})\n  data = target_data.content.get(\"data\", {})\n  if data:\n    # Update custom fields with Randori target data\n    incident.properties.randori_target_status = data.get(\"status\")\n    incident.properties.randori_target_impact_score = data.get(\"impact_score\")\n    incident.properties.randori_target_temptation = map_temptation(data.get(\"target_temptation\"))\n    incident.properties.randori_target_name = data.get(\"name\")\n    incident.properties.randori_target_vendor = data.get(\"vendor\")\n    incident.properties.randori_target_version = data.get(\"version\")\n    incident.properties.randori_target_authority = data.get(\"authority\")\n    incident.properties.randori_target_affiliation_state = data.get(\"affiliation_state\")\n    incident.properties.randori_target_perspective_name = data.get(\"perspective_name\")\n    tech_category = data.get(\"tech_category\", [])\n    if tech_category:\n      incident.properties.randori_target_tech_category = \", \".join(tech_category)\n      \n    user_tags = data.get(\"user_tags\", [])\n    if user_tags:\n      incident.properties.randori_target_user_tags = \", \".join(user_tags)\n        \n    characteristic_tags = data.get(\"characteristic_tags\", [])\n    if user_tags:\n      incident.properties.randori_target_characteristic_tags = \", \".join(characteristic_tags)\n      \n    incident.addNote(\"Randori: Update Target Data in SOAR script updated custom fields in SOAR.\")\n",
          "tags": [],
          "uuid": "5af933f7-fce7-4086-8ce2-ceaeddfe7a89"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "randori_update_target_in_soar",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_71569df3-623d-4529-8611-3bdb61c44885",
        "id": 14,
        "name": "playbook_71569df3_623d_4529_8611_3bdb61c44885",
        "type": "playbook",
        "uuid": "f16522cd-91c5-426e-a5ae-10e8b2019c2b"
      },
      "tags": [],
      "type": "default",
      "uuid": "71569df3-623d-4529-8611-3bdb61c44885",
      "version": 27
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_43e96ffc_d3cb_49eb_8153_7028c276690b\" isExecutable=\"true\" name=\"playbook_43e96ffc_d3cb_49eb_8153_7028c276690b\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1v3gmw7\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1l4bc0p\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"Randori: Update Notes from Randori Target\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"7deecb02-2324-46a0-9b5b-79b43daabd6c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.incident_id = incident.id\\ninputs.randori_target_id = incident.properties.randori_target_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"target_notes\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1v3gmw7\u003c/incoming\u003e\u003coutgoing\u003eFlow_1l4bc0p\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1v3gmw7\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_2\"/\u003e\u003csequenceFlow id=\"Flow_1l4bc0p\" sourceRef=\"ServiceTask_2\" targetRef=\"EndPoint_1\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_43e96ffc_d3cb_49eb_8153_7028c276690b\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1l4bc0p\" id=\"Flow_1l4bc0p_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"374\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1v3gmw7\" id=\"Flow_1v3gmw7_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"374\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667315109201,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_43e96ffc_d3cb_49eb_8153_7028c276690b",
      "description": {
        "content": "Update notes in SOAR with comments from the corresponding target in Randori.",
        "format": "text"
      },
      "display_name": "Randori: Update Target Notes",
      "export_key": "randori_update_target_notes",
      "field_type_handle": "playbook_43e96ffc_d3cb_49eb_8153_7028c276690b",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Update Target Notes",
        "export_key": "playbook_43e96ffc_d3cb_49eb_8153_7028c276690b",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_43e96ffc_d3cb_49eb_8153_7028c276690b",
        "uuid": "32e9f81f-9dc4-4fb7-8255-7dd6c706a53c"
      },
      "has_logical_errors": false,
      "id": 9,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1667857632804,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667315282368,
          "description": "",
          "enabled": false,
          "export_key": "Randori: Update Target Notes",
          "id": 10,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667315282380,
          "name": "Randori: Update Target Notes",
          "object_type": "incident",
          "playbook_handle": "randori_update_target_notes",
          "programmatic_name": "randori_update_target_notes_randori_update_target_notes",
          "script_text": "playbook.functions.results.target_notes\n\nincident.addNote(\"Added {} notes from Randori Target\")",
          "tags": [],
          "uuid": "1bae3969-eccb-4af0-a55e-9db811b0a660"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "randori_update_target_notes",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_43e96ffc-d3cb-49eb-8153-7028c276690b",
        "id": 9,
        "name": "playbook_43e96ffc_d3cb_49eb_8153_7028c276690b",
        "type": "playbook",
        "uuid": "a56ca53f-b017-4a36-90d6-aca0c542f5fa"
      },
      "tags": [],
      "type": "default",
      "uuid": "43e96ffc-d3cb-49eb-8153-7028c276690b",
      "version": 13
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 16,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5\" isExecutable=\"true\" name=\"playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1h43a38\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1jhv7t6\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"Randori: Update Target Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f452d8b8-5f75-4b6b-9cde-40f496695abb\"\u003e{\"inputs\":{\"24621a5a-cb1b-43af-8110-01013dbb3b19\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"abc484a9-2a33-4162-9f39-873b2f917bcf\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"inputs.randori_target_id = incident.properties.randori_target_id\\ninputs.randori_target_status = playbook.inputs.randori_target_status\\ninputs.randori_note = playbook.inputs.randori_note.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"target_status\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1h43a38\u003c/incoming\u003e\u003coutgoing\u003eFlow_1wydn69\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1h43a38\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_2\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Randori: Write Update Status Results to a Note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"49d61fb2-ab61-40fa-bba9-ac8eb9701d40\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1wydn69\u003c/incoming\u003e\u003coutgoing\u003eFlow_1jhv7t6\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1wydn69\" sourceRef=\"ServiceTask_2\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1jhv7t6\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_1\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1jhv7t6\" id=\"Flow_1jhv7t6_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"462\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"564\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1wydn69\" id=\"Flow_1wydn69_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"312\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"378\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1h43a38\" id=\"Flow_1h43a38_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"228\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"564\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"228\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"378\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1667233238805,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
      "description": {
        "content": "Update the status of the specified Randori target in Randori.  Add optional note as a comment in Randori.",
        "format": "text"
      },
      "display_name": "Randori: Update Target Status in Randori",
      "export_key": "randori_update_target_status_in_randori",
      "field_type_handle": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
      "fields_type": {
        "actions": [],
        "display_name": "Randori: Update Target Status in Randori",
        "export_key": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
        "fields": {
          "randori_note": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5/randori_note",
            "hide_notification": false,
            "id": 305,
            "input_type": "textarea",
            "internal": false,
            "is_tracked": false,
            "name": "randori_note",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Note",
            "tooltip": "Note to send to Randori target",
            "type_id": 1008,
            "uuid": "05f1bb59-9f3b-411c-bc4d-4844ca1c9461",
            "values": []
          },
          "randori_target_status": {
            "allow_default_value": false,
            "blank_option": true,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5/randori_target_status",
            "hide_notification": false,
            "id": 298,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "randori_target_status",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Status",
            "tooltip": "",
            "type_id": 1008,
            "uuid": "8e10b243-70fe-46c8-978e-0c1a7f1095d8",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Needs Investigation",
                "properties": null,
                "uuid": "afad1993-22e8-414a-8d9c-c90e9635029a",
                "value": 71
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Needs Resolution",
                "properties": null,
                "uuid": "0f4af061-8a9d-45cb-aa76-554d38290c4c",
                "value": 72
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Needs Review",
                "properties": null,
                "uuid": "a84a744e-f5ff-4f14-b507-d1bd1216e440",
                "value": 73
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Accepted",
                "properties": null,
                "uuid": "dfb2fbf0-a86f-448a-baee-42395b0a9480",
                "value": 74
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Mitigated",
                "properties": null,
                "uuid": "47b21644-592a-4025-87e7-13b40c6028ca",
                "value": 75
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "None",
                "properties": null,
                "uuid": "df8a915a-3022-4630-8c42-8f0345105f94",
                "value": 76
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
        "uuid": "cfb3da9c-70ab-4beb-8714-860bb32f70a3"
      },
      "has_logical_errors": false,
      "id": 8,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1670694984259,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1667233507431,
          "description": "Write the results of functions to update the status of a Randori target in Randori.",
          "enabled": false,
          "export_key": "Randori: Write Update Status Results to a Note",
          "id": 9,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1667418510705,
          "name": "Randori: Write Update Status Results to a Note",
          "object_type": "incident",
          "playbook_handle": "randori_update_target_status_in_randori",
          "programmatic_name": "randori_update_target_status_in_randori_randori_write_update_status_results_to_a_note",
          "script_text": "target_status = playbook.functions.results.target_status\n\nif not target_status.success:\n  incident.addNote(\"Randori: ERROR: Unable to Update Target Status to \u003cb\u003e{}\u003c/b\u003e\".format(target_status.inputs.randori_target_status))\nelse:\n  incident.properties.randori_target_status = target_status.inputs.randori_target_status\n  incident.addNote(\"Randori: Updated Target Status to \u003cb\u003e{}\u003c/b\u003e in Randori\".format(incident.properties.randori_target_status))",
          "tags": [],
          "uuid": "49d61fb2-ab61-40fa-bba9-ac8eb9701d40"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.randori_target_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "8e10b243-70fe-46c8-978e-0c1a7f1095d8",
            "element": "field_uuid",
            "field_type": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "05f1bb59-9f3b-411c-bc4d-4844ca1c9461",
            "element": "field_uuid",
            "field_type": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "randori_update_target_status_in_randori",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_8f658e56-2fc3-4b92-ac5f-56a838587ad5",
        "id": 8,
        "name": "playbook_8f658e56_2fc3_4b92_ac5f_56a838587ad5",
        "type": "playbook",
        "uuid": "0c5cec2e-6f9f-4ff6-b36e-9864ae0618d2"
      },
      "tags": [],
      "type": "default",
      "uuid": "8f658e56-2fc3-4b92-ac5f-56a838587ad5",
      "version": 24
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 7899,
    "major": 45,
    "minor": 0,
    "version": "45.0.7899"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "Detections",
      "export_key": "randori_detections_dt",
      "fields": {
        "randori_dt_date_added": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_date_added",
          "hide_notification": false,
          "id": 294,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_date_added",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Date Added",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "4df451ab-9ebc-42b7-8f04-26d4085b528f",
          "values": [],
          "width": 98
        },
        "randori_dt_first_seen": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_first_seen",
          "hide_notification": false,
          "id": 292,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_first_seen",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "First Seen",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "77bb42b1-2977-4a4a-8b85-0ab3bf46bb79",
          "values": [],
          "width": 92
        },
        "randori_dt_hostname": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_hostname",
          "hide_notification": false,
          "id": 285,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_hostname",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Hostname",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "8d84a77e-7c0f-44d7-97d8-8ae7170f97fc",
          "values": [],
          "width": 81
        },
        "randori_dt_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_ip",
          "hide_notification": false,
          "id": 286,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_ip",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "IP",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "52528f2e-5697-49da-a758-c8d1f92462f8",
          "values": [],
          "width": 80
        },
        "randori_dt_last_seen": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_last_seen",
          "hide_notification": false,
          "id": 293,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_last_seen",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Last Seen",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "ceea765b-069b-4951-9035-02e80d4ae28f",
          "values": [],
          "width": 92
        },
        "randori_dt_path": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_path",
          "hide_notification": false,
          "id": 288,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_path",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Path",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "48bf2a9f-4762-4956-9cff-7188680e419d",
          "values": [],
          "width": 80
        },
        "randori_dt_port": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_detections_dt/randori_dt_port",
          "hide_notification": false,
          "id": 289,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_port",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Port",
          "tooltip": "",
          "type_id": 1003,
          "uuid": "44b6b389-3fab-4df9-9cb7-13b8b91959ca",
          "values": [],
          "width": 80
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "randori_detections_dt",
      "uuid": "abd848bc-e131-4523-b146-d50f9ed2e819"
    },
    {
      "actions": [],
      "display_name": "Discovery Path",
      "export_key": "randori_discovery_path_dt",
      "fields": {
        "randori_dt_date_added": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_discovery_path_dt/randori_dt_date_added",
          "hide_notification": false,
          "id": 316,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_date_added",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Date Added",
          "tooltip": "",
          "type_id": 1021,
          "uuid": "b243ec4e-38bb-4c0f-a1d9-573a3e0e057f",
          "values": [],
          "width": 50
        },
        "randori_dt_discovery_step": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_discovery_path_dt/randori_dt_discovery_step",
          "hide_notification": false,
          "id": 313,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_discovery_step",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Discovery Step",
          "tooltip": "",
          "type_id": 1021,
          "uuid": "40531ef5-b9d5-4f21-8da3-43e30f1eac0c",
          "values": [],
          "width": 356
        },
        "randori_dt_link": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "randori_discovery_path_dt/randori_dt_link",
          "hide_notification": false,
          "id": 314,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "randori_dt_link",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": true,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Link",
          "tooltip": "",
          "type_id": 1021,
          "uuid": "30aaa994-3fac-488e-8f07-647aff930c42",
          "values": [],
          "width": 506
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "randori_discovery_path_dt",
      "uuid": "d54ea95a-0a69-427f-aa4b-acc0fefd8894"
    }
  ],
  "workflows": [],
  "workspaces": []
}
