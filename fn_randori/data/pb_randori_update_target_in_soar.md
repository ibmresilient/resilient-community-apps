<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - Randori: Update Target in SOAR

### API Name
`randori_update_target_in_soar`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`incident.properties.randori_target_id has_a_value`

### Object Type
`incident`

### Description
Manual Playbook to update the Randori target custom field data in SOAR.


---
## Function - Randori: Get Target

### API Name
`randori_get_target`

### Output Name
`target_data`

### Message Destination
`fn_randori`

### Function-Input Script
```python
inputs.randori_target_id = incident.properties.randori_target_id
```

---

## Local script - Update target custom fields

### Description
Update target custom fields

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
def map_temptation(temptation_score):
  if not isinstance(temptation_score, int):
    return "In Review"
    
  if temptation_score <= 14:
    return "Low"
  elif temptation_score >= 15 and temptation_score <= 29:
    return "Medium"
  elif temptation_score >= 30 and temptation_score <= 39:
    return "High"
  elif temptation_score >= 40:
    return "Critical"
    
target_data = playbook.functions.results.target_data

if not target_data.success:
  incident.addNote("Randori: Update custom fields: Unable to get target data to update custom fields.")
else:
  content = target_data.get("content", {})
  data = target_data.content.get("data", {})
  if data:
    # Update custom fields with Randori target data
    incident.properties.randori_target_status = data.get("status")
    incident.properties.randori_target_impact_score = data.get("impact_score")
    incident.properties.randori_target_temptation = map_temptation(data.get("target_temptation"))
    incident.properties.randori_target_name = data.get("name")
    incident.properties.randori_target_vendor = data.get("vendor")
    incident.properties.randori_target_version = data.get("version")
    incident.properties.randori_target_authority = data.get("authority")
    incident.properties.randori_target_affiliation_state = data.get("affiliation_state")
    incident.properties.randori_target_perspective_name = data.get("perspective_name")
    tech_category = data.get("tech_category", [])
    if tech_category:
      incident.properties.randori_target_tech_category = ", ".join(tech_category)
      
    user_tags = data.get("user_tags", [])
    if user_tags:
      incident.properties.randori_target_user_tags = ", ".join(user_tags)
        
    characteristic_tags = data.get("characteristic_tags", [])
    if user_tags:
      incident.properties.randori_target_characteristic_tags = ", ".join(characteristic_tags)
      
    incident.addNote("Randori: Update Target Data in SOAR script updated custom fields in SOAR.")

```

---

