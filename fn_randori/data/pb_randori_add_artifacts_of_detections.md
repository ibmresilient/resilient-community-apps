<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.2.2.1096
-->

# Playbook - Randori: Automatic Add Artifacts of Detections

### API Name
`randori_add_artifacts_of_detections`

### Status
`enabled`

### Activation Type
`Automatic`

### Activation Conditions
`(incident.plan_status equals Active AND incident.properties.randori_target_id has_a_value AND object_added)`

### Object Type
`incident`

### Description
Automatic playbook to add artifacts of a detection as artifacts in SOAR.


---
## Function - Randori: Get Detections of Target

### API Name
`randori_get_detections_of_target`

### Output Name
`detection_data`

### Message Destination
`fn_randori`

### Function-Input Script
```python
inputs.randori_target_id = incident.properties.randori_target_id
```

---

## Local script - Randori: Add Detection Data as Artifacts

### Description
Add the Randori detections artifacts as artifacts in SOAR.

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
detection_data = playbook.functions.results.detection_data

if not detection_data.success:
  incident.addNote("Randori: Get Target Data: Unable to get target data from Randori to create artifacts.")
else:
  content = detection_data.get("content", {})
  detection_list = detection_data.content.get("detection_list", [])
  for detection in detection_list:
    
    # Add artifacts
    ip = detection.get("ip")
    if ip:
      incident.addArtifact("IP Address", ip, "Artifact from Randori.")
      
    port = detection.get("port")
    if port:
      incident.addArtifact("Port", str(port), "Artifact from Randori.")

    hostname = detection.get("hostname")
    if hostname:
      incident.addArtifact("DNS Name", hostname, "Artifact from Randori.")
      
    path = detection.get("path")
    if path:
      incident.addArtifact("File Path", path, "Artifact from Randori.")
      
    service_name = detection.get("name")
    if service_name:
      incident.addArtifact("Service", service_name, "Artifact from Randori.")
      
  incident.addNote("Randori: automatic playbook added artifacts from {} detections".format(len(detection_list)))
```

---

