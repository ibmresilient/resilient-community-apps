<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.1.51
-->

# Playbook - QRadar SIEM: Search QRadar for offense id -Example (PB)

### API Name
`search_qradar_for_offense_id`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`incident`

### Description
Use the qradar_id field of the incident to search qradar events, and update the data table, qradar_offense_event, with the first 5 results.


---
## Function - QRadar Search

### API Name
`qradar_search`

### Output Name
`qradar_search_result`

### Message Destination
`fn_qradar_integration`

### Function-Input Script
```python
inputs.qradar_label = playbook.inputs.qradar_server


if playbook.inputs.qradar_query_all_results:
  inputs.qradar_query_all_results = playbook.inputs.qradar_query_all_results

  
inputs.qradar_query = "SELECT %param1% FROM events WHERE INOFFENSE(%param2%) LAST %param3% Days"
inputs.qradar_search_param1  = "DATEFORMAT(starttime, 'YYYY-MM-dd HH:mm') as StartTime, CATEGORYNAME(category), LOGSOURCENAME(logsourceid), PROTOCOLNAME(protocolid), RULENAME(creeventlist)"
inputs.qradar_search_param2 = incident.properties.qradar_id
inputs.qradar_search_param3 = '7'
inputs.qradar_query_range_start = '1'
inputs.qradar_query_range_end = '5'

```

---

## Local script - qradar_search_post_process

### Description


### Script Type
`Local script`

### Objet Type
`incident`

### Script Content
```python
results = playbook.functions.results.qradar_search_result
for event in results["events"]:
  qradar_event = incident.addRow("qradar_offense_event")
  qradar_event.qradar_server = results.inputs.get("qradar_label")
  qradar_event.start_time = event["StartTime"]
  qradar_event.category = event["categoryname_category"]
  qradar_event.log_source = event["logsourcename_logsourceid"]
  qradar_event.protocol = event["protocolname_protocolid"]
  qradar_event.rule = event["rulename_creeventlist"]
```

---
