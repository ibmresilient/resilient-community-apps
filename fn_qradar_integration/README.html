<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="Randori" href="../fn_randori/README.html" /><link rel="prev" title="QRadar Enhanced Data Migration" href="../fn_qradar_enhanced_data/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>QRadar Integration - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmware_cbc/README.html">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_algosec/README.html">AlgoSec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cloud_foundry/README.html">Cloud Foundry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_icdx/README.html">Symantec ICDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_low_code/README.html">SOAR Low Code App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Networks Panorama Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">Phish Tank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sumo_logic/README.html">Sumo Logic Cloud SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html">watsonx.ai for SOAR Analysts<!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="qradar-integration">
<h1>QRadar Integration<a class="headerlink" href="#qradar-integration" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---qradar-siem-add-reference-set-item"><span class="xref myst">Function - QRadar SIEM: Add Reference Set Item </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-create-offense-note"><span class="xref myst">Function - QRadar SIEM: Create Offense Note</span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-delete-reference-set-item"><span class="xref myst">Function - QRadar SIEM: Delete Reference Set Item </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-find-reference-set-item"><span class="xref myst">Function - QRadar SIEM: Find Reference Set Item </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-find-reference-sets"><span class="xref myst">Function - QRadar SIEM: Find Reference Sets </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-reference-table-add-item"><span class="xref myst">Function - QRadar SIEM: Reference Table Add Item </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-reference-table-delete-item"><span class="xref myst">Function - QRadar SIEM: Reference Table Delete Item </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-reference-table-get-all-tables"><span class="xref myst">Function - QRadar SIEM: Reference Table Get All Tables </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-reference-table-get-table-data"><span class="xref myst">Function - QRadar SIEM: Reference Table Get Table Data </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-reference-table-update-item"><span class="xref myst">Function - QRadar SIEM: Reference Table Update Item </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-qradar-search"><span class="xref myst">Function - QRadar SIEM: QRadar Search </span></a></p></li>
<li><p><a class="reference internal" href="#function---qradar-siem-update-offense"><span class="xref myst">Function - QRadar SIEM: Update Offense</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---qradar-siem-offense-events"><span class="xref myst">Data Table - QRadar SIEM Offense Events</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---qradar-siem-reference-sets"><span class="xref myst">Data Table - QRadar SIEM Reference Sets</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---qradar-siem-reference-table-queried-rows"><span class="xref myst">Data Table - QRadar SIEM Reference Table Queried Rows</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---qradar-siem-reference-tables"><span class="xref myst">Data Table - QRadar SIEM Reference Tables</span></a></p></li>
<li><p><a class="reference internal" href="#custom-fields"><span class="xref myst">Custom Fields</span></a></p></li>
<li><p><a class="reference internal" href="#playbooks"><span class="xref myst">Playbooks</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<!--
  Specify all changes in this release. Do not remove the release 
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Publication</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2.4.1</p></td>
<td><p>May. 2024</p></td>
<td><p>Bug fix for function input field name qradar_note. Change it to qradar_siem_note.</p></td>
</tr>
<tr class="row-odd"><td><p>2.4.0</p></td>
<td><p>April. 2024</p></td>
<td><p>Added functions to create offense notes and make changes to an offense</p></td>
</tr>
<tr class="row-even"><td><p>2.3.1</p></td>
<td><p>April. 2024</p></td>
<td><p>Bug fix for search_ref_set function</p></td>
</tr>
<tr class="row-odd"><td><p>2.3.0</p></td>
<td><p>September. 2023</p></td>
<td><p>Python3 / Playbook Conversion</p></td>
</tr>
<tr class="row-even"><td><p>2.2.6</p></td>
<td><p>June. 2023</p></td>
<td><p>Fix bug in qradar_search function</p></td>
</tr>
<tr class="row-odd"><td><p>2.2.5</p></td>
<td><p>July. 2022</p></td>
<td><p>Bug Fix for windows clients</p></td>
</tr>
<tr class="row-even"><td><p>2.2.4</p></td>
<td><p>July. 2022</p></td>
<td><p>Update SOAR required version</p></td>
</tr>
<tr class="row-odd"><td><p>2.2.3</p></td>
<td><p>June. 2022</p></td>
<td><p>Bug fix for using with MSSP</p></td>
</tr>
<tr class="row-even"><td><p>2.2.2</p></td>
<td><p>May. 2022</p></td>
<td><p>Add more documentation and bug fix</p></td>
</tr>
<tr class="row-odd"><td><p>2.2.1</p></td>
<td><p>March 2022</p></td>
<td><p>Cancel QRadar queries which have timed out</p></td>
</tr>
<tr class="row-even"><td><p>2.2.0</p></td>
<td><p>March 2022</p></td>
<td><p>Allow multiple QRadar instances</p></td>
</tr>
<tr class="row-odd"><td><p>2.1.1</p></td>
<td><p>July 2021</p></td>
<td><p>Fixed selftest failing when using cafile</p></td>
</tr>
<tr class="row-even"><td><p>2.1.0</p></td>
<td><p>Feb. 2021</p></td>
<td><p>Additional functions for reference table mapping.</p></td>
</tr>
<tr class="row-odd"><td><p>2.0.9</p></td>
<td><p>Feb. 2021</p></td>
<td><p>Bug fixes associated with require input field validation.</p></td>
</tr>
<tr class="row-even"><td><p>2.0.8</p></td>
<td><p>Nov. 2020</p></td>
<td><p>Fixed a bug failing search function when used with token.</p></td>
</tr>
<tr class="row-odd"><td><p>2.0.7</p></td>
<td><p>July 2020</p></td>
<td><p>Correct typos and describe optional Search activity field Update SOAR version.</p></td>
</tr>
<tr class="row-even"><td><p>2.0.6</p></td>
<td><p>May 2020</p></td>
<td><p>Add option to return all results from Search.</p></td>
</tr>
<tr class="row-odd"><td><p>2.0.4</p></td>
<td><p>April 2020</p></td>
<td><p>Additional configuration notes.</p></td>
</tr>
<tr class="row-even"><td><p>2.0</p></td>
<td><p>March 2019</p></td>
<td><p>Supports the 2.0 release.</p></td>
</tr>
<tr class="row-odd"><td><p>1.0</p></td>
<td><p>July 2018</p></td>
<td><p>Initial publication.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<!--
  Provide a high-level description of the function itself and its remote software or application.
  The text below is parsed from the "description" and "long_description" attributes in the setup.py file
-->
<p><strong>IBM QRadar SOAR Components for ‘fn_qradar_integration’</strong></p>
<p><img alt="screenshot: main" src="../_images/main51.png" /></p>
<p>fn_qradar_integration supports performing ariel search to retrieve data from QRadar. It also provide functions to find/add/delete reference set items.</p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<!--
  List the Key Features of the Integration
-->
<p>This guide describes the QRadar Function integrations..
The QRadar app with the SOAR platform package provides the following:</p>
<ul class="simple">
<li><p>Search function to perform a QRadar Ariel query</p></li>
<li><p>Search function to query an item in a QRadar reference set</p></li>
<li><p>Search function to find all the reference sets that contain an item</p></li>
<li><p>Add function to insert a new item in a QRadar reference set</p></li>
<li><p>Delete function to remove an item from a QRadar reference set</p></li>
<li><p>List all reference tables</p></li>
<li><p>View all items associated with a given reference table</p></li>
<li><p>Add/Update/Delete items to a QRadar reference table</p></li>
<li><p>Update an offense, such as changing status to closed</p></li>
<li><p>Writing notes to an offense</p></li>
</ul>
<p>With the above functions, this package includes example workflows that demonstrate how to call the functions, rules that start the example workflows, and custom data tables updated by the example workflows.</p>
</section>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<!--
  List any Requirements 
--> 
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (formerly App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an Edge Gateway, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">50.0.0</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">50.0.0</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=50.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read, edit</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= <code class="docutils literal notranslate"><span class="pre">1.10</span></code>.</p></li>
<li><p>Cloud Pak is configured with an Edge Gateway.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app does support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.6, 3.9, and 3.11 are supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>resilient_circuits&gt;=50.0.0</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>host</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">localhost</span></code></p></td>
<td><p>*QRadar host name or IP Address *</p></td>
</tr>
<tr class="row-odd"><td><p><strong>qradarpassword</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">changeme</span></code></p></td>
<td><p><em>username password for QRadar authentication</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>qradartoken</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">changeme</span></code></p></td>
<td><p><em>QRadar token to use rather than password</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>username</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">admin</span></code></p></td>
<td><p><em>Username for QRadar authentication</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>verify_cert</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p>`false</p></td>
<td><p>/path/to/cert`</p></td>
</tr>
<tr class="row-odd"><td><p><strong>search_timeout</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60</span></code></p></td>
<td><p><em>Seconds to timeout after search begins</em></p></td>
</tr>
</tbody>
</table>
</div>
<section id="changes">
<h4>2.3.0 Changes<a class="headerlink" href="#changes" title="Link to this heading">¶</a></h4>
<p>In v2.3.0, the existing rules and workflows have been replaced with playbooks. This change is made to support the ongoing, newer capabilities of playbooks. Each playbook has the same functionality as the previous, corresponding rule/workflow.</p>
<p>If upgrading from a previous release, you’ll notice that the previous release’s rules/workflows remain in place. Both sets of rules and playbooks are active. For manual actions, playbooks have the same name as it’s corresponding rule, but with “(PB)” added at the end.</p>
<p>You can continue to use the rules/workflows. But migrating to playbooks provides greater functionality along with future app enhancements and bug fixes.</p>
</section>
<section id="id1">
<h4>2.2.0 Changes<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p>Starting in version 2.2.0, more than one QRadar instance can be configured for SOAR case data synchronization. For enterprises with only one QRadar instance, your app.config file will continue to define the QRadar instance under the <code class="docutils literal notranslate"><span class="pre">[fn_qradar_integration]</span></code> section header.</p>
<p>For enterprises with more than one QRadar instance, each instance will have it’s own section header, such as <code class="docutils literal notranslate"><span class="pre">[fn_qradar_integration:qradar_instance_label]</span></code> where <code class="docutils literal notranslate"><span class="pre">qradar_instance_label</span></code> represents any label helpful to define you QRadar environment.</p>
<p>Be aware that modifications to the workflows will be needed to correctly pass this label through the <code class="docutils literal notranslate"><span class="pre">qradar_label</span></code> function input field if the QRadar server/servers in the app.config have labels.</p>
<p>If you have existing custom workflows, see <a class="reference internal" href="#creating-workflows-when-serverservers-in-appconfig-are-labeled"><span class="xref myst">Creating workflows when server/servers in app.config are labeled</span></a> for more information about changing them to reference the <code class="docutils literal notranslate"><span class="pre">qradar_label</span></code> function input field.</p>
</section>
</section>
<section id="custom-layouts">
<h3>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">¶</a></h3>
<!--
  Use this section to provide guidance on where the user should add any custom fields and data tables.
  You may wish to recommend a new incident tab.
  You should save a screenshot "custom_layouts.png" in the doc/screenshots directory and reference it here
-->
<ul>
<li><p>Import the Data Tables and Custom Fields like the screenshot below:</p>
<p><img alt="screenshot: custom_layouts" src="../_images/custom_layouts26.png" /></p>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-add-reference-set-item">
<h2>Function - QRadar SIEM: Add Reference Set Item<a class="headerlink" href="#function-qradar-siem-add-reference-set-item" title="Link to this heading">¶</a></h2>
<p>Add an item to a given QRadar reference set</p>
<p><img alt="screenshot: fn-qradar-add-reference-set-item " src="../_images/fn-qradar-add-reference-set-item.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference set item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Name of a QRadar reference set</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1440703724417</span><span class="p">,</span>
    <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;IP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DHCP Servers&quot;</span><span class="p">,</span>
    <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.9.9.9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">:</span> <span class="s2">&quot;DHCP Servers&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_item_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span>  <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_add_reference_set_item_result</span>
<span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;IP: </span><span class="si">{}</span><span class="s2"> added to reference set: </span><span class="si">{}</span><span class="s2"> on QRadar server: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">],</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Failed to add IP: </span><span class="si">{}</span><span class="s2"> to reference set on QRadar server: </span><span class="si">{}</span><span class="s2">. Status Code: </span><span class="si">{}</span><span class="s2">, message: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;status_code&quot;</span><span class="p">]),</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-create-offense-note">
<h2>Function - QRadar SIEM: Create Offense Note<a class="headerlink" href="#function-qradar-siem-create-offense-note" title="Link to this heading">¶</a></h2>
<p>Add a note to an offense</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>QRadar Id</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_siem_note</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Note to create</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;note_text&quot;</span><span class="p">:</span> <span class="s2">&quot;test from soar</span><span class="se">\\</span><span class="s2">x03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;create_time&quot;</span><span class="p">:</span> <span class="mi">1713464714559</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">214</span><span class="p">,</span>
        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;API_token: ms qradar integration&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;qradar_siem_note&quot;</span><span class="p">:</span> <span class="s2">&quot;test from soar&quot;</span><span class="p">,</span>
        <span class="s2">&quot;qradar_id&quot;</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
        <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;9.46.246.248&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
        <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
        <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">463</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18 14:25:14&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_siem_note</span>  <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_siem_note</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">create_note_results</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QRadar note created for </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span><span class="si">}</span><span class="s2"> &#39;</span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_siem_note</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QRadar note failed for: </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span><span class="si">}</span><span class="s2"> Reason: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-delete-reference-set-item">
<h2>Function - QRadar SIEM: Delete Reference Set Item<a class="headerlink" href="#function-qradar-siem-delete-reference-set-item" title="Link to this heading">¶</a></h2>
<p>Delete an item from a given QRadar reference set</p>
<p><img alt="screenshot: fn-qradar-delete-reference-set-item " src="../_images/fn-qradar-delete-reference-set-item.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference set item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Name of a QRadar reference set</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1440703735265</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;IP&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Servers&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;9.9.9.9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">:</span> <span class="s2">&quot;DNS Servers&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1306</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-14 21:08:54&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">status_code</span><span class="se">\&quot;</span><span class="s2">: 200, </span><span class="se">\&quot;</span><span class="s2">content</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">FIRST_SEEN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 1, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1440703735265, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">DNS Servers</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">IP</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 12}}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_item_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_add_reference_set_item_result</span>

<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status_code&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Successfully added </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2"> on QRadar Server: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Failed to add </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2"> on QRadar server: </span><span class="si">{}</span><span class="s2">. Status code: </span><span class="si">{}</span><span class="s2">, message: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">],</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status_code&quot;</span><span class="p">),</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]))</span>
  
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-find-reference-set-item">
<h2>Function - QRadar SIEM: Find Reference Set Item<a class="headerlink" href="#function-qradar-siem-find-reference-set-item" title="Link to this heading">¶</a></h2>
<p>Find an item in a given QRadar reference set</p>
<p><img alt="screenshot: fn-qradar-find-reference-set-item " src="../_images/fn-qradar-find-reference-set-item.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference set item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Name of a QRadar reference set</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1557250160405</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;domain_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;first_seen&quot;</span><span class="p">:</span> <span class="mi">1694498079793</span><span class="p">,</span>
        <span class="s2">&quot;last_seen&quot;</span><span class="p">:</span> <span class="mi">1694498079793</span><span class="p">,</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;EC: Sysmon - Detected a Possible Credential Dumping Tool&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.107.107&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;IP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;EC Compromised Hosts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;found&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.107.107&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">:</span> <span class="s2">&quot;EC Compromised Hosts&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_item_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_name</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_find_reference_set_item_result</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">found</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Found IP: </span><span class="si">{}</span><span class="s2"> in list: </span><span class="si">{}</span><span class="s2"> on QRadar server: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">],</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;IP:</span><span class="si">{}</span><span class="s2"> not found in list: </span><span class="si">{}</span><span class="s2"> on QRadar server: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_reference_set_name&quot;</span><span class="p">],</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-find-reference-sets">
<h2>Function - QRadar SIEM: Find Reference Sets<a class="headerlink" href="#function-qradar-siem-find-reference-sets" title="Link to this heading">¶</a></h2>
<p>Find reference sets that contain a given item value, together with information about this item in those reference sets. Information includes whether this item is added to the reference set manually or by a rule.</p>
<p><img alt="screenshot: fn-qradar-find-reference-sets " src="../_images/fn-qradar-find-reference-sets.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_set_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference set item</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_set_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.107.107&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;reference_items&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1557250160405</span><span class="p">,</span>
      <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;domain_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;first_seen&quot;</span><span class="p">:</span> <span class="mi">1694498079793</span><span class="p">,</span>
          <span class="s2">&quot;last_seen&quot;</span><span class="p">:</span> <span class="mi">1694498079793</span><span class="p">,</span>
          <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;EC: Sysmon - Detected a Possible Credential Dumping Tool&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.107.107&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;IP&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;EC Compromised Hosts&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_set_item_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_find_reference_sets_result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span> 
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">reference_items</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">reference_items</span><span class="p">:</span>
    <span class="n">item_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;qradar_reference_set&quot;</span><span class="p">)</span>
    <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;query_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
    <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]</span>
    <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;reference_set&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;item_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
    <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;source&quot;</span><span class="p">]</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Reference sets found&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reference_items</span><span class="p">)))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;No reference sets contain artifact: </span><span class="si">{}</span><span class="s2"> on QRadar server: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-reference-table-add-item">
<h2>Function - QRadar SIEM: Reference Table Add Item<a class="headerlink" href="#function-qradar-siem-reference-table-add-item" title="Link to this heading">¶</a></h2>
<p>Add an item to a given QRadar reference table</p>
<p><img alt="screenshot: fn-qradar-reference-table-add-item " src="../_images/fn-qradar-reference-table-add-item.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_inner_key</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The inner key for a QRadar Reference Table</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_outer_key</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The outer key for a QRadar Reference Table</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1694502585199</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;key_label&quot;</span><span class="p">:</span> <span class="s2">&quot;Outer Key Label&quot;</span><span class="p">,</span>
      <span class="s2">&quot;key_name_types&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Inner Key 1&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_ref_tabe_1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_inner_key&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_outer_key&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.107.107&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_ref_tabe_1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1659</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-12 15:10:39&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">status_code</span><span class="se">\&quot;</span><span class="s2">: 200, </span><span class="se">\&quot;</span><span class="s2">content</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">FIRST_SEEN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 1, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1694502585199, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">test_ref_tabe_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">key_name_types</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">Inner Key 1</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">}, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 44, </span><span class="se">\&quot;</span><span class="s2">key_label</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Outer Key Label</span><span class="se">\&quot;</span><span class="s2">}}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span> <span class="o">=</span> <span class="n">artifact</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_inner_key</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_ref_table_inner_key</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_outer_key</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_ref_table_outer_key</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_reference_table_add_item_result</span>
<span class="n">note</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;Outer key: </span><span class="si">{}</span>
<span class="s2">Inner key: </span><span class="si">{}</span>
<span class="s2">Entry: </span><span class="si">{}</span>
<span class="s2">Reference table: </span><span class="si">{}</span>
<span class="s2">QRadar Server: </span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_outer_key</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_inner_key</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span><span class="p">,</span> 
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Successful add</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">note</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Failure to add item: </span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">],</span> <span class="n">note</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-reference-table-delete-item">
<h2>Function - QRadar SIEM: Reference Table Delete Item<a class="headerlink" href="#function-qradar-siem-reference-table-delete-item" title="Link to this heading">¶</a></h2>
<p>Delete an item from a given QRadar reference table</p>
<p><img alt="screenshot: fn-qradar-reference-table-delete-item " src="../_images/fn-qradar-reference-table-delete-item.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_inner_key</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The inner key for a QRadar Reference Table</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_outer_key</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The outer key for a QRadar Reference Table</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1607452116847</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse_imports&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;UNKNOWN&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_inner_key&quot;</span><span class="p">:</span> <span class="s2">&quot;part-3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_outer_key&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse-a142f062-f41b-4c2c-96b8-4ab4e3b7bde4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;test123&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse_imports&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1420</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-15 16:58:55&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">status_code</span><span class="se">\&quot;</span><span class="s2">: 200, </span><span class="se">\&quot;</span><span class="s2">content</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">UNKNOWN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 5, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1607452116847, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">pulse_imports</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 28}}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">table</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_outer_key</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">outer_key</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_inner_key</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">inner_key</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">value</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">]</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_reference_table_delete_item_result</span>
<span class="n">note</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;Outer key: </span><span class="si">{}</span>
<span class="s2">Inner key: </span><span class="si">{}</span>
<span class="s2">Entry: </span><span class="si">{}</span>
<span class="s2">Reference table: </span><span class="si">{}</span>
<span class="s2">QRadar Server: </span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_outer_key</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_inner_key</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span><span class="p">,</span> 
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span><span class="p">,</span>
                              <span class="n">row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Successful delete</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">note</span><span class="p">))</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;deleted&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Failure to delete item: </span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">note</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-reference-table-get-all-tables">
<h2>Function - QRadar SIEM: Reference Table Get All Tables<a class="headerlink" href="#function-qradar-siem-reference-table-get-all-tables" title="Link to this heading">¶</a></h2>
<p>Get all reference tables from a QRadar instance</p>
<p><img alt="screenshot: fn-qradar-reference-table-get-all-tables " src="../_images/fn-qradar-reference-table-get-all-tables.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1693550078786</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;key_label&quot;</span><span class="p">:</span> <span class="s2">&quot;offense_id&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Generated_Cases&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;time_to_live&quot;</span><span class="p">:</span> <span class="s2">&quot;0 years 1 mons 0 days 0 hours 0 mins 0.0 secs&quot;</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;LAST_SEEN&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1607452116847</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse_imports&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;UNKNOWN&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1694502585199</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;key_label&quot;</span><span class="p">:</span> <span class="s2">&quot;Outer Key Label&quot;</span><span class="p">,</span>
      <span class="s2">&quot;key_name_types&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Inner Key 1&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_ref_tabe_1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1442</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-15 18:47:24&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">time_to_live</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">0 years 1 mons 0 days 0 hours 0 mins 0.0 secs</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">LAST_SEEN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 0, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1693550078786, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Generated_Cases</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 43, </span><span class="se">\&quot;</span><span class="s2">key_label</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">offense_id</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">UNKNOWN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 5, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1607452116847, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">pulse_imports</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 28}, {</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">FIRST_SEEN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 1, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1694502585199, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">test_ref_tabe_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">key_name_types</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">Inner Key 1</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">}, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 44, </span><span class="se">\&quot;</span><span class="s2">key_label</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Outer Key Label</span><span class="se">\&quot;</span><span class="s2">}]&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_reference_table_get_all_tables_result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span> 
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
      <span class="n">item_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;qradar_reference_table&quot;</span><span class="p">)</span>
      <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;query_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
      <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">]</span>
      <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;reference_table&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
      <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;collection_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;collection_id&quot;</span><span class="p">]</span>
      <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;number_of_elements&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;number_of_elements&quot;</span><span class="p">]</span>
      <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Reference tables have successfully been queried&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="p">)))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;No reference tables found&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;An error occurred getting the reference tables: </span><span class="si">{}</span><span class="s2"> from QRadar server: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">qradar_label</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-reference-table-get-table-data">
<h2>Function - QRadar SIEM: Reference Table Get Table Data<a class="headerlink" href="#function-qradar-siem-reference-table-get-table-data" title="Link to this heading">¶</a></h2>
<p>Get the elements in the reference table</p>
<p><img alt="screenshot: fn-qradar-reference-table-get-table-data " src="../_images/fn-qradar-reference-table-get-table-data.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
    <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1694502585199</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;None&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;None&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;domain_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
          <span class="s2">&quot;first_seen&quot;</span><span class="p">:</span> <span class="mi">1694502641647</span><span class="p">,</span>
          <span class="s2">&quot;last_seen&quot;</span><span class="p">:</span> <span class="mi">1694502641647</span><span class="p">,</span>
          <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;reference data api&quot;</span><span class="p">,</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.107.107&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;key_label&quot;</span><span class="p">:</span> <span class="s2">&quot;Outer Key Label&quot;</span><span class="p">,</span>
    <span class="s2">&quot;key_name_types&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;Inner Key 1&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_ref_tabe_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;FIRST_SEEN&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_ref_tabe_1&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1392</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-15 19:00:19&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">FIRST_SEEN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 1, </span><span class="se">\&quot;</span><span class="s2">data</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">None</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">None</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">last_seen</span><span class="se">\&quot;</span><span class="s2">: 1694502641647, </span><span class="se">\&quot;</span><span class="s2">first_seen</span><span class="se">\&quot;</span><span class="s2">: 1694502641647, </span><span class="se">\&quot;</span><span class="s2">source</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">reference data api</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">192.168.107.107</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">domain_id</span><span class="se">\&quot;</span><span class="s2">: null}}}, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1694502585199, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">test_ref_tabe_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">key_name_types</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">Inner Key 1</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">}, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 44, </span><span class="se">\&quot;</span><span class="s2">key_label</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Outer Key Label</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;reference_table&#39;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">]</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_reference_table_get_table_data_result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span> 
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">outer_key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,[])</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">inner_key</span><span class="p">,</span> <span class="n">inner_item</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="n">table_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s1">&#39;qradar_reference_table_queried_rows&#39;</span><span class="p">)</span>
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;query_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;qradar_server&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">]</span>
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span>
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;outer_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outer_key</span>
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;inner_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inner_key</span>
      
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inner_item</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
      <span class="n">table_row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;active&#39;</span>
  <span class="n">num_data_gathered</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,[])</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Reference table data have been gathered&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_data_gathered</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;An error occurred getting the reference table data: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-reference-table-update-item">
<h2>Function - QRadar SIEM: Reference Table Update Item<a class="headerlink" href="#function-qradar-siem-reference-table-update-item" title="Link to this heading">¶</a></h2>
<p>Update an item in a given QRadar reference table</p>
<p><img alt="screenshot: fn-qradar-reference-table-update-item " src="../_images/fn-qradar-reference-table-update-item.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_inner_key</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The inner key for a QRadar Reference Table</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_outer_key</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>The outer key for a QRadar Reference Table</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_item_value</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_reference_table_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Value of a QRadar reference table item</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;collection_id&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
      <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="mi">1607452116847</span><span class="p">,</span>
      <span class="s2">&quot;element_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALN&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse_imports&quot;</span><span class="p">,</span>
      <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;SHARED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;number_of_elements&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
      <span class="s2">&quot;timeout_type&quot;</span><span class="p">:</span> <span class="s2">&quot;UNKNOWN&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;status_code&quot;</span><span class="p">:</span> <span class="mi">200</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_inner_key&quot;</span><span class="p">:</span> <span class="s2">&quot;part-3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_outer_key&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse-a142f062-f41b-4c2c-96b8-4ab4e3b7bde4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_item_value&quot;</span><span class="p">:</span> <span class="s2">&quot;test123&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_reference_table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;pulse_imports&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1365</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.3.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-15 16:57:43&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">status_code</span><span class="se">\&quot;</span><span class="s2">: 200, </span><span class="se">\&quot;</span><span class="s2">content</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">timeout_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">UNKNOWN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">number_of_elements</span><span class="se">\&quot;</span><span class="s2">: 6, </span><span class="se">\&quot;</span><span class="s2">creation_time</span><span class="se">\&quot;</span><span class="s2">: 1607452116847, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">pulse_imports</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">namespace</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SHARED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">element_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ALN</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">collection_id</span><span class="se">\&quot;</span><span class="s2">: 28}}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">]</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">table</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_outer_key</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">outer_key</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_inner_key</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">inner_key</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_ref_table_update</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_ref_table_update</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span> <span class="o">=</span> <span class="s2">&quot;This is an example&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_reference_table_update_result</span>
<span class="n">note</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;Outer key: </span><span class="si">{}</span>
<span class="s2">Inner key: </span><span class="si">{}</span>
<span class="s2">Entry: </span><span class="si">{}</span>
<span class="s2">Reference table: </span><span class="si">{}</span>
<span class="s2">QRadar Server: </span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_outer_key</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_inner_key</span><span class="p">,</span>
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span><span class="p">,</span> 
                              <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_name</span><span class="p">,</span>
                              <span class="n">row</span><span class="p">[</span><span class="s2">&quot;qradar_server&quot;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Successful updated</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">note</span><span class="p">))</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;updated&#39;</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_reference_table_item_value</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Failure to updated item: </span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">],</span> <span class="n">note</span><span class="p">))</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-qradar-search">
<h2>Function - QRadar SIEM: QRadar Search<a class="headerlink" href="#function-qradar-siem-qradar-search" title="Link to this heading">¶</a></h2>
<p>Search QRadar for events</p>
<p><img alt="screenshot: fn-qradar-search " src="../_images/fn-qradar-search.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_query</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">textarea</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>A qradar query string with parameters</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_query_all_results</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Display all results from search. By default, a range for the number of returned results is set.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_query_range_end</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_query_range_start</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_search_param1</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_search_param2</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_search_param3</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_search_param4</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_search_param5</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;StartTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-12 01:53&quot;</span><span class="p">,</span>
      <span class="s2">&quot;categoryname_category&quot;</span><span class="p">:</span> <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
      <span class="s2">&quot;logsourcename_logsourceid&quot;</span><span class="p">:</span> <span class="s2">&quot;Experience Center: Cisco IronPort @ 192.168.0.15&quot;</span><span class="p">,</span>
      <span class="s2">&quot;protocolname_protocolid&quot;</span><span class="p">:</span> <span class="s2">&quot;Reserved&quot;</span><span class="p">,</span>
      <span class="s2">&quot;rulename_creeventlist&quot;</span><span class="p">:</span> <span class="s2">&quot;[</span><span class="se">\u0027</span><span class="s2">Context is Local to Local</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">EC: AWS Cloud - Detected An Email with An Attachment From a Spam Sender</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:CategoryDefinition: Medium Magnitude Events</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:CategoryDefinition: High Magnitude Events</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Source Asset Weight is Low</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">ECBB:CategoryDefinition: Destination IP is a Third Country/Region</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Destination Asset Weight is Low</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:DeviceDefinition: Mail</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:DeviceDefinition: Proxy</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Load Basic Building Blocks</span><span class="se">\u0027</span><span class="s2">]&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;StartTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-12 01:53&quot;</span><span class="p">,</span>
      <span class="s2">&quot;categoryname_category&quot;</span><span class="p">:</span> <span class="s2">&quot;Suspicious Activity&quot;</span><span class="p">,</span>
      <span class="s2">&quot;logsourcename_logsourceid&quot;</span><span class="p">:</span> <span class="s2">&quot;Custom Rule Engine-8 :: hychuang-4&quot;</span><span class="p">,</span>
      <span class="s2">&quot;protocolname_protocolid&quot;</span><span class="p">:</span> <span class="s2">&quot;Reserved&quot;</span><span class="p">,</span>
      <span class="s2">&quot;rulename_creeventlist&quot;</span><span class="p">:</span> <span class="s2">&quot;[</span><span class="se">\u0027</span><span class="s2">EC: AWS Cloud - Detected An Email with An Attachment From a Spam Sender</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:CategoryDefinition: Suspicious Event Categories</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:CategoryDefinition: Suspicious Events</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Context is Local to Local</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:CategoryDefinition: Medium Magnitude Events</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">BB:CategoryDefinition: High Magnitude Events</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Source Asset Weight is Low</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">ECBB:CategoryDefinition: Destination IP is a Third Country/Region</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Destination Asset Weight is Low</span><span class="se">\u0027</span><span class="s2">, </span><span class="se">\u0027</span><span class="s2">Load Basic Building Blocks</span><span class="se">\u0027</span><span class="s2">]&quot;</span>
    <span class="p">}</span>
   
   
  <span class="p">],</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_query&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT %param1</span><span class="si">% F</span><span class="s2">ROM events WHERE INOFFENSE(%param2%) LAST %param3% Days&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_query_all_results&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;qradar_search_param1&quot;</span><span class="p">:</span> <span class="s2">&quot;DATEFORMAT(starttime, </span><span class="se">\u0027</span><span class="s2">YYYY-MM-dd HH:mm</span><span class="se">\u0027</span><span class="s2">) as StartTime, CATEGORYNAME(category), LOGSOURCENAME(logsourceid), PROTOCOLNAME(protocolid), RULENAME(creeventlist)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_search_param2&quot;</span><span class="p">:</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_search_param3&quot;</span><span class="p">:</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_search_param4&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qradar_search_param5&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_server</span>


<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_query_all_results</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">qradar_query_all_results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_query_all_results</span>

  
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT %param1</span><span class="si">% F</span><span class="s2">ROM events WHERE INOFFENSE(%param2%) LAST %param3% Days&quot;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_search_param1</span>  <span class="o">=</span> <span class="s2">&quot;DATEFORMAT(starttime, &#39;YYYY-MM-dd HH:mm&#39;) as StartTime, CATEGORYNAME(category), LOGSOURCENAME(logsourceid), PROTOCOLNAME(protocolid), RULENAME(creeventlist)&quot;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_search_param2</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">qradar_id</span>
<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">days_to_search_back</span><span class="p">:</span> 
  <span class="n">inputs</span><span class="o">.</span><span class="n">qradar_search_param3</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">days_to_search_back</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">qradar_search_param3</span> <span class="o">=</span> <span class="s1">&#39;7&#39;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_query_range_start</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_query_range_end</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_search_result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;events&quot;</span><span class="p">]:</span>
  <span class="n">qradar_event</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;qradar_offense_event&quot;</span><span class="p">)</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">query_time</span> <span class="o">=</span> <span class="n">current_time</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">qradar_server</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;qradar_label&quot;</span><span class="p">)</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;StartTime&quot;</span><span class="p">]</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;categoryname_category&quot;</span><span class="p">]</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">log_source</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;logsourcename_logsourceid&quot;</span><span class="p">]</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">protocol</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;protocolname_protocolid&quot;</span><span class="p">]</span>
  <span class="n">qradar_event</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;rulename_creeventlist&quot;</span><span class="p">]</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> offenses have successfully been queried&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;events&quot;</span><span class="p">])))</span>


</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-qradar-siem-update-offense">
<h2>Function - QRadar SIEM: Update Offense<a class="headerlink" href="#function-qradar-siem-update-offense" title="Link to this heading">¶</a></h2>
<p>Update information about an offense.</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_label</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Enter name of QRadar server to use from the app.config</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>QRadar Id</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qradar_update_json</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">{&quot;severity&quot;:</span> <span class="pre">50,</span> <span class="pre">&quot;categories&quot;:</span> <span class="pre">[&quot;Virtual</span> <span class="pre">Machine</span> <span class="pre">Creation</span> <span class="pre">Attempt&quot;,</span> <span class="pre">&quot;Read</span> <span class="pre">Activity</span> <span class="pre">Attempted&quot;]}</span></code></p></td>
<td><p>JSON formatted fields to update an app. Use double quotes.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The following fields are available (but not limited to) to change:</p>
<ul class="simple">
<li><p>assigned_to</p></li>
<li><p>categories</p></li>
<li><p>closing_reason_id</p></li>
<li><p>credibility</p></li>
<li><p>description</p></li>
<li><p>follow_up</p></li>
<li><p>inactive</p></li>
<li><p>magnitude</p></li>
<li><p>offense_type</p></li>
<li><p>protected</p></li>
<li><p>relevance</p></li>
<li><p>severity</p></li>
<li><p>status</p></li>
</ul>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;last_persisted_time&quot;</span><span class="p">:</span> <span class="mi">1713465658000</span><span class="p">,</span>
        <span class="s2">&quot;username_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Login</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">100462</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;CRE_RULE&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;event_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;flow_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;assigned_to&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;security_category_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;follow_up&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;source_address_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mi">99</span>
        <span class="p">],</span>
        <span class="s2">&quot;source_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;inactive&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;protected&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;closing_user&quot;</span><span class="p">:</span> <span class="s2">&quot;API_token: ms qradar integration&quot;</span><span class="p">,</span>
        <span class="s2">&quot;destination_networks&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;other&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;source_network&quot;</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;close_time&quot;</span><span class="p">:</span> <span class="mi">1713465658000</span><span class="p">,</span>
        <span class="s2">&quot;remote_destination_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="mi">1711492873201</span><span class="p">,</span>
        <span class="s2">&quot;magnitude&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;last_updated_time&quot;</span><span class="p">:</span> <span class="mi">1711492873201</span><span class="p">,</span>
        <span class="s2">&quot;credibility&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
        <span class="s2">&quot;categories&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;User Login Success&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;policy_category_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;log_sources&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;type_name&quot;</span><span class="p">:</span> <span class="s2">&quot;F5FirePass&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type_id&quot;</span><span class="p">:</span> <span class="mi">232</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;F5FirePass @ f5networks.firepass.test.com&quot;</span><span class="p">,</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">962</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;closing_reason_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;device_count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;first_persisted_time&quot;</span><span class="p">:</span> <span class="mi">1711492873000</span><span class="p">,</span>
        <span class="s2">&quot;offense_type&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;relevance&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;domain_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;offense_source&quot;</span><span class="p">:</span> <span class="s2">&quot;31.107.167.255&quot;</span><span class="p">,</span>
        <span class="s2">&quot;local_destination_address_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;local_destination_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOSED&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;qradar_update_json&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">status</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">CLOSED</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">closing_reason_id</span><span class="se">\&quot;</span><span class="s2">: 1}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;qradar_id&quot;</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
        <span class="s2">&quot;qradar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;11.22.33.44&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-qradar-integration&quot;</span><span class="p">,</span>
        <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.4.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
        <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">499</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-18 14:40:58&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="n">closing_reason_lookup</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;False Positive&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s2">&quot;Non-Issue&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;Policy Violation&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s2">&quot;Duplicate&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span>
  <span class="s2">&quot;Not an Issue&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span>
  <span class="s2">&quot;Resolved&quot;</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span>
  <span class="s2">&quot;Unresolved&quot;</span><span class="p">:</span> <span class="mi">55</span>
<span class="p">}</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">closing_reason_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">closing_reason</span><span class="p">):</span>
  <span class="n">helper</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Closing reason not found: </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">closing_reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">qradar_update_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOSED&quot;</span><span class="p">,</span> 
  <span class="s2">&quot;closing_reason_id&quot;</span><span class="p">:</span> <span class="n">closing_reason_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">closing_reason</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qradar_update_offense_results</span>
<span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QRadar offense update successful for: </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;QRadar offense update failed for: </span><span class="si">{</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_id</span><span class="si">}</span><span class="s2"> Reason: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
---
</section>
<section id="data-table-qradar-siem-offense-events">
<h2>Data Table - QRadar SIEM Offense Events<a class="headerlink" href="#data-table-qradar-siem-offense-events" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-qradar-offense-events" src="../_images/dt-qradar-offense-events.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>qradar_offense_event</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Category</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">category</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Log Source</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">log_source</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>logsourceid</p></td>
</tr>
<tr class="row-even"><td><p>Protocol</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">protocol</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>protocolid</p></td>
</tr>
<tr class="row-odd"><td><p>QRadar Server</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qradar_server</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Label from app.config of the QRadar server used</p></td>
</tr>
<tr class="row-even"><td><p>Rule</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rule</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>creeventlist</p></td>
</tr>
<tr class="row-odd"><td><p>Start Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">start_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>starttime</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-qradar-siem-reference-sets">
<h2>Data Table - QRadar SIEM Reference Sets<a class="headerlink" href="#data-table-qradar-siem-reference-sets" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-qradar-reference-sets" src="../_images/dt-qradar-reference-sets.png" /></p>
<section id="id2">
<h3>API Name:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>qradar_reference_set</p>
</section>
<section id="id3">
<h3>Columns:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Item Value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">item_value</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Item value</p></td>
</tr>
<tr class="row-odd"><td><p>QRadar Server</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qradar_server</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Label from app.config of the QRadar server used</p></td>
</tr>
<tr class="row-even"><td><p>Reference Set</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_set</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Name of reference set</p></td>
</tr>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>how this value is added to the reference set</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-qradar-siem-reference-table-queried-rows">
<h2>Data Table - QRadar SIEM Reference Table Queried Rows<a class="headerlink" href="#data-table-qradar-siem-reference-table-queried-rows" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-qradar-reference-table-queried-rows" src="../_images/dt-qradar-reference-table-queried-rows.png" /></p>
<section id="id4">
<h3>API Name:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>qradar_reference_table_queried_rows</p>
</section>
<section id="id5">
<h3>Columns:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Inner Key</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">inner_key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Outer Key</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">outer_key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>QRadar Server</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qradar_server</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Label from app.config of the QRadar server used</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Table</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">table</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">value</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-qradar-siem-reference-tables">
<h2>Data Table - QRadar SIEM Reference Tables<a class="headerlink" href="#data-table-qradar-siem-reference-tables" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-qradar-reference-tables" src="../_images/dt-qradar-reference-tables.png" /></p>
<section id="id6">
<h3>API Name:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>qradar_reference_table</p>
</section>
<section id="id7">
<h3>Columns:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Collection Id</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">collection_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Namespace</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">namespace</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Number Of Elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number_of_elements</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>QRadar Server</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qradar_server</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Label from app.config of the QRadar server used</p></td>
</tr>
<tr class="row-even"><td><p>Reference Table</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_table</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-fields">
<h2>Custom Fields<a class="headerlink" href="#custom-fields" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Prefix</p></th>
<th class="head"><p>Placeholder</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>qradar_destination</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qradar_destination</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>QRadar Destination to Sync With</p></td>
</tr>
<tr class="row-odd"><td><p>qradar_id</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qradar_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p></td>
<td><p>-</p></td>
<td><p>ID number of the QRadar offense</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="playbooks">
<h2>Playbooks<a class="headerlink" href="#playbooks" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>QRadar SIEM: Get All Reference Sets -Example (PB)</p></td>
<td><p>Find all the QRadar reference sets that contain the given artifact</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QRadar SIEM: Find in Reference Set - Example (PB)</p></td>
<td><p>Look for an item in QRadar reference set and add a note to the Incident</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QRadar SIEM: Add Item to this Reference Table - Example (PB)</p></td>
<td><p>Add a reference table item based on an existing named reference table</p></td>
<td><p>qradar_reference_table</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QRadar SIEM: Delete this Reference Table Item - Example (PB)</p></td>
<td><p>An example workflow that takes in a Reference Table name, an inner key, an outer key and a value to delete for the table</p></td>
<td><p>qradar_reference_table_queried_rows</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QRadar SIEM: Gather Reference Table Data - Example (PB)</p></td>
<td><p>Make a query on a reference table and return its results into another datatable</p></td>
<td><p>qradar_reference_table</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QRadar SIEM: Add to Reference Set -Example (PB)</p></td>
<td><p>Add an IP address artifact to QRadar reference set</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QRadar SIEM: Add to Reference Table -Example (PB)</p></td>
<td><p>Add a reference table item based on an artifact value</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QRadar SIEM: Get all Reference Tables - Example (PB)</p></td>
<td><p>An example workflow that returns a list of all Reference Tables on the QRadar instance.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QRadar SIEM: Move from Sample Blocked to Sample Suspected - Example (PB)</p></td>
<td><p>Remove an item from QRadar reference set and add it to reference set. Add a note to the Incident after completing each step.</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QRadar SIEM: Update this Reference Table Item - Example (PB)</p></td>
<td><p>Update an existing reference table item. If it does not exist, it will be added</p></td>
<td><p>qradar_reference_table_queried_rows</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QRadar SIEM: Search QRadar for offense id -Example (PB)</p></td>
<td><p>Use the qradar_id field of the incident to search qradar events, and update the data table, qradar_offense_event, with the first 5 results.</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QRadar SIEM: Update Offense (close offense)</p></td>
<td><p>Example of closing an offense</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QRadar SIEM: Create Note</p></td>
<td><p>Create a note for an offense</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="how-to-configure-to-use-a-single-qradar-server">
<h2>How to configure to use a single QRadar Server<a class="headerlink" href="#how-to-configure-to-use-a-single-qradar-server" title="Link to this heading">¶</a></h2>
<p>To use only a single server there are two ways this can be configured</p>
<ol class="arabic simple">
<li><p>Use the configuration used in QRadar Integration versions prior to V2.2.0
<img alt="screenshot: qr-single-server" src="../_images/qr-single-server1.png" /></p></li>
<li><p>Either keep the label, SOAR_Plugin_Destination_Name1, or change it (The label does not matter when only one server is configured)
<img alt="screenshot: qr-single-label-server" src="../_images/qr-single-label-server1.png" /></p></li>
</ol>
</section>
<section id="creating-playbooks-when-server-servers-in-app-config-are-labeled">
<h2>Creating Playbooks when server/servers in app.config are labeled<a class="headerlink" href="#creating-playbooks-when-server-servers-in-app-config-are-labeled" title="Link to this heading">¶</a></h2>
<p>The function input field <code class="docutils literal notranslate"><span class="pre">qradar_label</span></code> is required when QRadar server/servers in the app.config are labeled. In the example playbook pre-process scripts the
input field <code class="docutils literal notranslate"><span class="pre">qradar_label</span></code> is defined the following way,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">qradar_label</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">qradar_destination</span>
</pre></div>
</div>
</section>
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is a IBM Community provided App. Please search the Community <a class="reference external" href="https://ibm.biz/soarcommunity">ibm.biz/soarcommunity</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_randori/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Randori</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_qradar_enhanced_data/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">QRadar Enhanced Data Migration</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">QRadar Integration</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a><ul>
<li><a class="reference internal" href="#changes">2.3.0 Changes</a></li>
<li><a class="reference internal" href="#id1">2.2.0 Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-qradar-siem-add-reference-set-item">Function - QRadar SIEM: Add Reference Set Item</a></li>
<li><a class="reference internal" href="#function-qradar-siem-create-offense-note">Function - QRadar SIEM: Create Offense Note</a></li>
<li><a class="reference internal" href="#function-qradar-siem-delete-reference-set-item">Function - QRadar SIEM: Delete Reference Set Item</a></li>
<li><a class="reference internal" href="#function-qradar-siem-find-reference-set-item">Function - QRadar SIEM: Find Reference Set Item</a></li>
<li><a class="reference internal" href="#function-qradar-siem-find-reference-sets">Function - QRadar SIEM: Find Reference Sets</a></li>
<li><a class="reference internal" href="#function-qradar-siem-reference-table-add-item">Function - QRadar SIEM: Reference Table Add Item</a></li>
<li><a class="reference internal" href="#function-qradar-siem-reference-table-delete-item">Function - QRadar SIEM: Reference Table Delete Item</a></li>
<li><a class="reference internal" href="#function-qradar-siem-reference-table-get-all-tables">Function - QRadar SIEM: Reference Table Get All Tables</a></li>
<li><a class="reference internal" href="#function-qradar-siem-reference-table-get-table-data">Function - QRadar SIEM: Reference Table Get Table Data</a></li>
<li><a class="reference internal" href="#function-qradar-siem-reference-table-update-item">Function - QRadar SIEM: Reference Table Update Item</a></li>
<li><a class="reference internal" href="#function-qradar-siem-qradar-search">Function - QRadar SIEM: QRadar Search</a></li>
<li><a class="reference internal" href="#function-qradar-siem-update-offense">Function - QRadar SIEM: Update Offense</a></li>
<li><a class="reference internal" href="#data-table-qradar-siem-offense-events">Data Table - QRadar SIEM Offense Events</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-qradar-siem-reference-sets">Data Table - QRadar SIEM Reference Sets</a><ul>
<li><a class="reference internal" href="#id2">API Name:</a></li>
<li><a class="reference internal" href="#id3">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-qradar-siem-reference-table-queried-rows">Data Table - QRadar SIEM Reference Table Queried Rows</a><ul>
<li><a class="reference internal" href="#id4">API Name:</a></li>
<li><a class="reference internal" href="#id5">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-qradar-siem-reference-tables">Data Table - QRadar SIEM Reference Tables</a><ul>
<li><a class="reference internal" href="#id6">API Name:</a></li>
<li><a class="reference internal" href="#id7">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-fields">Custom Fields</a></li>
<li><a class="reference internal" href="#playbooks">Playbooks</a></li>
<li><a class="reference internal" href="#how-to-configure-to-use-a-single-qradar-server">How to configure to use a single QRadar Server</a></li>
<li><a class="reference internal" href="#creating-playbooks-when-server-servers-in-app-config-are-labeled">Creating Playbooks when server/servers in app.config are labeled</a></li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>