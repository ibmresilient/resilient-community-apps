<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.0.2.575
-->

# Playbook - Rapid7 InsightIDR: Send Note to Rapid7 Investigation

### API Name
`rapid7_insight_idr_send_note_to_rapid7_investigation`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`incident.plan_status equals Active AND incident.properties.rapid7_insight_idr_rrn has_a_value AND note.text not_contains Sent to Rapid7 InsightIDR at`

### Object Type
`note`

### Description
Manual playbook that sends a note in SOAR to an investigation in Rapid7 InsightIDR as a comment.


---
## Function - Rapid7 InsightIDR: Post Comment to Rapid7 Investigation

### API Name
`rapid7_insight_idr_post_comment`

### Output Name
`send_note_to_rapid7_results`

### Message Destination
`fn_rapid7_insight_idr`

### Function-Input Script
```python
inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn
inputs.rapid7_insight_idr_comment_text = note.text.content
```

---

## Local script - Rapid7 InsightIDR: Edit note when sent

### Description
Edit the SOAR note when it is sent to Rapid7, so we know it has been sent

### Script Type
`Local script`

### Object Type
`note`

### Script Content
```python
from datetime import datetime

results = playbook.functions.results.send_note_to_rapid7_results

# Edit note in SOAR to indicate it was sent to Rapid7 InsightIDR investigation
if results.get("success"):
  # Get the current time
  now = datetime.now()
  note.text = u"<b>Sent to Rapid7 InsightIDR at {0}</b><br>{1}".format(now, note.text.content)
  
```

---

