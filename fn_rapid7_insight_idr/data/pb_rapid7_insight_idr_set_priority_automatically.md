<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.0.2.575
-->

# Playbook - Rapid7 InsightIDR: Set Priority Automatically

### API Name
`rapid7_insight_idr_set_priority_automatically`

### Status
`enabled`

### Activation Type
`Automatic`

### Activation Conditions
`incident.plan_status equals Active AND incident.severity_code changed`

### Object Type
`incident`

### Description
Playbook to automatically update the priority of a Rapid7 InsightIDR investigation if the priority is changed in SOAR.


---
## Function - Rapid7 InsightIDR: Set Priority

### API Name
`rapid7_insight_idr_set_priority`

### Output Name
`set_priority_results`

### Message Destination
`fn_rapid7_insight_idr`

### Function-Input Script
```python
PRIORITY_MAPPING = {
  "Low": "LOW",
  "Medium": "MEDIUM",
  "High": "HIGH"
}
inputs.rapid7_insight_idr_incident_id = incident.id
inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn
inputs.rapid7_insight_idr_priority = PRIORITY_MAPPING.get(incident.severity_code)
```

---

## Local script - Rapid7 InsightIDR: Set priority 

### Description
Write results of set priority function in Rapid7 InsightIDR to a note.

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
results = playbook.functions.results.set_priority_results

if results.get("success"):
  priority = results.content.priority
  note_text = "<b>Rapid7 InsightIDR: Set Priority</b> Automatic Playbook set:<br>   Priority: {0}".format(priority)
else:
  note_text = "<b>Rapid7 InsightIDR: Set Priority</b> Automatic Playbook failed:<br>  {0}".results.get("reason")
  
incident.addNote(note_text)
```

---

