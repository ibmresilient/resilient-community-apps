{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1708454718721,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_status",
      "hide_notification": false,
      "id": 316,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_status",
      "tooltip": "The new status for the investigation (case insensitive). For example: \"OPEN\" \"CLOSED\" \"INVESTIGATING\" \"WAITING\"",
      "type_id": 11,
      "uuid": "8cb36735-4dea-4f91-af7e-00e56a761eef",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_alert_rrn",
      "hide_notification": false,
      "id": 363,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_alert_rrn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_alert_rrn",
      "tooltip": "Rapid7 InsightIDR Alert RRN (Rapid7 Resource Name)",
      "type_id": 11,
      "uuid": "9c9f29f5-7ddc-4bcd-abe3-e82fa2cb47f2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_rrn_optional",
      "hide_notification": false,
      "id": 364,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_rrn_optional",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_rrn_optional",
      "tooltip": "Rapid7 InsightIDR investigation RRN (optional)",
      "type_id": 11,
      "uuid": "ab6f3582-f5b1-44d3-942b-0b56676d4184",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_disposition",
      "hide_notification": false,
      "id": 317,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_disposition",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_disposition",
      "tooltip": "A disposition to set the investigation to. Only used if the new status is CLOSED.  Possible values: \"BENIGN\" \"MALICIOUS\" \"NOT_APPLICABLE\"",
      "type_id": 11,
      "uuid": "c82bb4e7-1f85-4aaa-85ca-f73101e5a294",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_priority",
      "hide_notification": false,
      "id": 318,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_priority",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_priority",
      "tooltip": "",
      "type_id": 11,
      "uuid": "ec30de08-3f3d-4acb-9093-76563b8445cf",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_rrn",
      "hide_notification": false,
      "id": 319,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_rrn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_rrn",
      "tooltip": "Rapid7 Resource Name of the investigation.",
      "type_id": 11,
      "uuid": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_comment_text",
      "hide_notification": false,
      "id": 320,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_comment_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_comment_text",
      "tooltip": "",
      "type_id": 11,
      "uuid": "53ecc86b-921c-4038-8b47-6bde81abf639",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/rapid7_insight_idr_incident_id",
      "hide_notification": false,
      "id": 321,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "rapid7_insight_idr_incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "7f6f5aa9-b639-4feb-92b6-03854a38f9b6",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_assignee_email",
      "hide_notification": false,
      "id": 325,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_assignee_email",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Assignee Email",
      "tooltip": "",
      "type_id": 0,
      "uuid": "9ed12b78-595c-4e65-ad4c-3bc782784492",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_rrn",
      "hide_notification": false,
      "id": 301,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_rrn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR RRN",
      "tooltip": "",
      "type_id": 0,
      "uuid": "ac658889-f7ff-411d-8121-020cf620eb93",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_responsibility",
      "hide_notification": false,
      "id": 302,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_responsibility",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Responsibility",
      "tooltip": "",
      "type_id": 0,
      "uuid": "ad4de2d1-3fd5-4a29-b79a-96c05faf0b90",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_assignee",
      "hide_notification": false,
      "id": 324,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_assignee",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Assignee",
      "tooltip": "",
      "type_id": 0,
      "uuid": "f60e3759-bdeb-45de-8be0-229b54d5910a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_link",
      "hide_notification": false,
      "id": 362,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_link",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": true,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Link",
      "tooltip": "",
      "type_id": 0,
      "uuid": "27072c46-7349-4a45-8244-dda7a06b7bbe",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_disposition",
      "hide_notification": false,
      "id": 303,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_disposition",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Disposition",
      "tooltip": "",
      "type_id": 0,
      "uuid": "2fad2a16-ce0d-4ea5-b83d-54496f24a9fc",
      "values": [
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Benign",
          "properties": null,
          "uuid": "16a675f1-c9c1-442d-91f5-5e6350b52c85",
          "value": 102
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Malicious",
          "properties": null,
          "uuid": "a8ecf0e1-b468-41f7-9d1c-085354faffad",
          "value": 103
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Not Applicable",
          "properties": null,
          "uuid": "574d2324-04a6-4dff-aa34-d7c4e01a7de9",
          "value": 104
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Undecided",
          "properties": null,
          "uuid": "8eafd1d7-1cdd-43c5-a77e-0711fa1e7393",
          "value": 105
        },
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "Unknown",
          "properties": null,
          "uuid": "be39c750-7569-4c50-9859-1b9eeacdd9d2",
          "value": 106
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_status",
      "hide_notification": false,
      "id": 304,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Status",
      "tooltip": "",
      "type_id": 0,
      "uuid": "6d7ad700-4257-415e-99d0-92e5530c3813",
      "values": [
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "Open",
          "properties": null,
          "uuid": "63055462-562d-44dd-a4df-ba22f9348579",
          "value": 107
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Investigating",
          "properties": null,
          "uuid": "2bae12b1-d851-4d1b-a940-0e2d735683cf",
          "value": 108
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Waiting",
          "properties": null,
          "uuid": "9a4463d3-ba5d-4245-a7eb-8ca901cd5624",
          "value": 109
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "Closed",
          "properties": null,
          "uuid": "3e443d2f-b55e-4561-988a-aa0b7dcc337a",
          "value": 110
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/rapid7_insight_idr_source",
      "hide_notification": false,
      "id": 305,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "rapid7_insight_idr_source",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "short_text": "",
      "tags": [],
      "templates": [],
      "text": "InsightIDR Source",
      "tooltip": "",
      "type_id": 0,
      "uuid": "710535ec-d338-4b7f-b316-548dd4c23fa5",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1705074849385,
      "description": {
        "content": "Manual playbook to get the attachments from a Rapid7 InsightIDR investigation and add them to the associated SOAR case.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Add Attachments to SOAR Case",
      "export_key": "rapid7_insight_idr_add_attachments_to_soar_case",
      "id": 1,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849385,
      "name": "rapid7_insight_idr_add_attachments_to_soar_case",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"rapid7_insight_idr_attachments\": [\"test.txt\"]}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_incident_id\": 2228, \"rapid7_insight_idr_rrn\": \"rrn:investigation:us2:e4463fba-cd64-427c-8fc9-f9e1983f24e1:investigation:JSPDKLRG7UWY\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"mylaptop\", \"execution_time_ms\": 30025, \"timestamp\": \"2023-12-12 14:41:29\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_attachments\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_incident_id\": {\"type\": \"integer\"}, \"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "8acc7c3d-4f9f-4e52-9d81-ab7105b82207",
      "version": 0,
      "view_items": [
        {
          "content": "7f6f5aa9-b639-4feb-92b6-03854a38f9b6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1707676323666,
      "description": {
        "content": "Get the Rapid7 InsightIDR investigation alert evidence.  The function requires 1 of 2 optional parameters to be set.  Specify the alert RRN if the alert source is Attack Behavior Analytics.  Specify the investigation RRN if the alert source is User Behavior Analytics.  NOTE: if specifying the investigation RRN, the \"restricted evidence\" API endpoint must be enabled on a per-organization basis. Contact Rapid7 support to enable the restricted evidence prior to using the function with an investigation RRN.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Get Alert Evidence",
      "export_key": "rapid7_insight_idr_get_alert_evidence",
      "id": 18,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1707775944211,
      "name": "rapid7_insight_idr_get_alert_evidence",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "tags": [],
      "uuid": "fa9a8006-3951-4c16-a1ef-58a27196268c",
      "version": 3,
      "view_items": [
        {
          "content": "9c9f29f5-7ddc-4bcd-abe3-e82fa2cb47f2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ab6f3582-f5b1-44d3-942b-0b56676d4184",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849462,
      "description": {
        "content": "Get the alerts associated with a Rapid7 InsightIDR investigation.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Get Alerts",
      "export_key": "rapid7_insight_idr_get_alerts",
      "id": 2,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849462,
      "name": "rapid7_insight_idr_get_alerts",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"data\": [{\"id\": \"eeeeeeeeee-83c0-4953-bc40-aaaaaaaaaaaaa\", \"title\": \"Custom Alert Possible Traffic for Venus Ransomware Detected was triggered for log Zscaler Firewall_Logs EUS2ZSCALEP002 in log set Firewall Activity\", \"alert_type\": \"Custom Alert - Pattern Detection\", \"alert_type_description\": \"One or more logs matched the pattern you defined.\", \"created_time\": \"2023-11-22T23:49:17.013Z\", \"first_event_time\": \"2023-11-22T23:44:38.234Z\", \"latest_event_time\": \"2023-11-22T23:49:17.013Z\", \"alert_source\": \"User Behavior Analytics\", \"detection_rule_rrn\": null}], \"metadata\": {\"index\": 0, \"size\": 20, \"total_pages\": 1, \"total_data\": 1}}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_rrn\": \"rrn:investigation:usxx:xxxxxx-1234-4608-be60-xxxxxxxxx:investigation:ggggggggggg\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"Pro.local\", \"execution_time_ms\": 219, \"timestamp\": \"2023-12-04 15:32:42\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"data\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"string\"}, \"title\": {\"type\": \"string\"}, \"alert_type\": {\"type\": \"string\"}, \"alert_type_description\": {\"type\": \"string\"}, \"created_time\": {\"type\": \"string\"}, \"first_event_time\": {\"type\": \"string\"}, \"latest_event_time\": {\"type\": \"string\"}, \"alert_source\": {\"type\": \"string\"}, \"detection_rule_rrn\": {}}}}, \"metadata\": {\"type\": \"object\", \"properties\": {\"index\": {\"type\": \"integer\"}, \"size\": {\"type\": \"integer\"}, \"total_pages\": {\"type\": \"integer\"}, \"total_data\": {\"type\": \"integer\"}}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "1a98c2fc-279a-4b9d-a314-1527777cfaa3",
      "version": 0,
      "view_items": [
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849517,
      "description": {
        "content": "Get the comments from a Rapid7 InsightIDR investigation and add any new ones as notes to the corresponding SOAR case.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Get Comments from Rapid7 Investigation",
      "export_key": "rapid7_insight_idr_get_comments",
      "id": 3,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849517,
      "name": "rapid7_insight_idr_get_comments",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"count\": 1}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_incident_id\": 2195, \"rapid7_insight_idr_rrn\": \"rrn:investigation:us2:eeeeeeee-cccc-4c4c-8fc9-f9e19e19e1:investigation:AAAAAAAAAA\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"mylaptop\", \"execution_time_ms\": 59301, \"timestamp\": \"2023-12-06 11:56:52\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"count\": {\"type\": \"integer\"}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_incident_id\": {\"type\": \"integer\"}, \"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "63beafd5-52ae-4693-a8b6-9d556a4a4637",
      "version": 0,
      "view_items": [
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "7f6f5aa9-b639-4feb-92b6-03854a38f9b6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849568,
      "description": {
        "content": "Get investigation information from Rapid7 InsightIDR for the given Rapid7 Resource Name (rrn).",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Get Investigation",
      "export_key": "rapid7_insight_idr_get_investigation",
      "id": 4,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849568,
      "name": "rapid7_insight_idr_get_investigation",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"rapid7_insight_idr_investigation\": {\"rrn\": \"rrn:investigation:us2:eeeeeeee-ccc4-4ccc-8eee-eeeeeeeeeeee:investigation:AAAAAAAAAA\", \"organization_id\": \"e4463fba-cd64-427c-8fc9-f9e1983f24e1\", \"title\": \"1st investigation\", \"source\": \"USER\", \"status\": \"INVESTIGATING\", \"priority\": \"LOW\", \"last_accessed\": \"2023-12-01T22:41:02.993Z\", \"created_time\": \"2023-11-10T15:55:12.182Z\", \"disposition\": \"MALICIOUS\", \"assignee\": null, \"first_alert_time\": null, \"latest_alert_time\": null, \"responsibility\": null, \"entity_url\": \"https://us2.api.insight.rapid7.com/op/6E85858585854#/investigations/rrn:investigation:us2:eeeeeeee-cccc-4c4c-8fc9-f9e1983f24e1:investigation:AAAAAAAAAA\"}}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_rrn\": \"rrn:investigation:us12:cccccccc-cd64-427c-8fc9-f9e1983f24e1:investigation:3AAAAAAAAAA\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"Book-Pro.local\", \"execution_time_ms\": 229, \"timestamp\": \"2023-12-04 10:24:18\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_investigation\": {\"type\": \"object\", \"properties\": {\"rrn\": {\"type\": \"string\"}, \"organization_id\": {\"type\": \"string\"}, \"title\": {\"type\": \"string\"}, \"source\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}, \"priority\": {\"type\": \"string\"}, \"last_accessed\": {\"type\": \"string\"}, \"created_time\": {\"type\": \"string\"}, \"disposition\": {\"type\": \"string\"}, \"assignee\": {}, \"first_alert_time\": {}, \"latest_alert_time\": {}, \"responsibility\": {}, \"entity_url\": {\"type\": \"string\"}}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "4cf150e9-653e-4ed7-b3d5-3d36e28db937",
      "version": 0,
      "view_items": [
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849624,
      "description": {
        "content": "Get list of the attachments of a Rapid7 InsightIDR investigation.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: List Attachments",
      "export_key": "rapid7_insight_idr_list_attachments",
      "id": 5,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849624,
      "name": "rapid7_insight_idr_list_attachments",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"data\": [{\"rrn\": \"rrn:collaboration:us2:e4463fba-cd64-427c-8fc9-f9e1983f24e1:attachment:9JF5ST900Y1H\", \"creator\": {\"type\": \"USER\", \"name\": \"AdminUser\"}, \"created_time\": \"2023-12-12T15:36:10.258Z\", \"file_name\": \"test.txt\", \"mime_type\": \"text/plain\", \"size\": 40, \"scan_status\": \"CLEAN\"}]}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_incident_id\": 2228, \"rapid7_insight_idr_rrn\": \"rrn:investigation:us2:e4463fba-cd64-427c-8fc9-f9e1983f24e1:investigation:JSPDKLRG7UWY\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"mylaptop\", \"execution_time_ms\": 6807, \"timestamp\": \"2023-12-12 11:34:29\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"data\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"rrn\": {\"type\": \"string\"}, \"creator\": {\"type\": \"object\", \"properties\": {\"type\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}}}, \"created_time\": {\"type\": \"string\"}, \"file_name\": {\"type\": \"string\"}, \"mime_type\": {\"type\": \"string\"}, \"size\": {\"type\": \"integer\"}, \"scan_status\": {\"type\": \"string\"}}}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_incident_id\": {\"type\": \"integer\"}, \"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "ce36bbf6-cda5-43c3-a804-e835050a928b",
      "version": 0,
      "view_items": [
        {
          "content": "7f6f5aa9-b639-4feb-92b6-03854a38f9b6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849682,
      "description": {
        "content": "Send a note to Rapid7 InsightIDR investigation as a comment.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Post Comment to Rapid7 Investigation",
      "export_key": "rapid7_insight_idr_post_comment",
      "id": 6,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849682,
      "name": "rapid7_insight_idr_post_comment",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"created_time\": \"2023-12-08T17:28:38.377Z\", \"rrn\": \"rrn:collaboration:us2:eeeeeeeeee-c4c4-427c-8fc9-f9e1e1e1e1ee1:comment:CDNOQXKNAFN5\", \"target\": \"rrn:investigation:us2:eeeeeeeee-c4c4-427c-8fc9-f9efe1e1e1e1e1:investigation:3XAAXAAXAAXAA\", \"creator\": {\"type\": \"USER\", \"name\": \"Admin User\"}, \"body\": \"Created by IBM SOAR:  Admin closing as BENIGN from SOAR December 8, 2023\", \"visibility\": \"PUBLIC\", \"attachments\": null}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_comment_text\": \"\u003cdiv class=\\\"rte\\\"\u003e\u003cdiv\u003eAdmin User closing as BENIGN from SOAR December 8, 2023\u003c/div\u003e\u003c/div\u003e\", \"rapid7_insight_idr_rrn\": \"rrn:investigation:us2:eeeeeeeee-c4c4-427c-8fc9-f9efe1e1e1e1e1:investigation:3XAAXAAXAAXAA\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"laptop.local\", \"execution_time_ms\": 263, \"timestamp\": \"2023-12-08 12:28:38\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"created_time\": {\"type\": \"string\"}, \"rrn\": {\"type\": \"string\"}, \"target\": {\"type\": \"string\"}, \"creator\": {\"type\": \"object\", \"properties\": {\"type\": {\"type\": \"string\"}, \"name\": {\"type\": \"string\"}}}, \"body\": {\"type\": \"string\"}, \"visibility\": {\"type\": \"string\"}, \"attachments\": {}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_comment_text\": {\"type\": \"string\"}, \"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "f734a215-d11b-4eec-9dff-2319366c54e1",
      "version": 0,
      "view_items": [
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "53ecc86b-921c-4038-8b47-6bde81abf639",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849743,
      "description": {
        "content": "Set the priority of a Rapid7 InsightIDR investigation from SOAR.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7 InsightIDR: Set Priority",
      "export_key": "rapid7_insight_idr_set_priority",
      "id": 7,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849743,
      "name": "rapid7_insight_idr_set_priority",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"rrn\": \"rrn:investigation:us2:eeeee222-cccc-dddc-8fc9-f9e19e19e1:investigation:2B9B9B9B9B9\", \"organization_id\": \"e4463fba-cd64-427c-8fc9-f9e1983f24e1\", \"title\": \"investigation 4\", \"source\": \"USER\", \"status\": \"INVESTIGATING\", \"priority\": \"LOW\", \"last_accessed\": \"2023-12-11T15:31:41.564Z\", \"created_time\": \"2023-11-28T20:09:36.546Z\", \"disposition\": \"UNDECIDED\", \"assignee\": {\"name\": \"Admin User\", \"email\": \"admin@example.com\"}, \"first_alert_time\": null, \"latest_alert_time\": null, \"responsibility\": null}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_priority\": \"LOW\", \"rapid7_insight_idr_incident_id\": 2220, \"rapid7_insight_idr_rrn\": \"rrn:investigation:us2:eeeee222-cccc-dddc-8fc9-f9e19e19e1:investigation:2B9B9B9B9B9\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"mylaptop.local\", \"execution_time_ms\": 21848, \"timestamp\": \"2023-12-11 10:31:47\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"rrn\": {\"type\": \"string\"}, \"organization_id\": {\"type\": \"string\"}, \"title\": {\"type\": \"string\"}, \"source\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}, \"priority\": {\"type\": \"string\"}, \"last_accessed\": {\"type\": \"string\"}, \"created_time\": {\"type\": \"string\"}, \"disposition\": {\"type\": \"string\"}, \"assignee\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}, \"email\": {\"type\": \"string\"}}}, \"first_alert_time\": {}, \"latest_alert_time\": {}, \"responsibility\": {}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_priority\": {\"type\": \"string\"}, \"rapid7_insight_idr_incident_id\": {\"type\": \"integer\"}, \"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "0a685b85-1daa-45ae-826b-ac7dc07076cf",
      "version": 0,
      "view_items": [
        {
          "content": "7f6f5aa9-b639-4feb-92b6-03854a38f9b6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ec30de08-3f3d-4acb-9093-76563b8445cf",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1705074849802,
      "description": {
        "content": "Set the status of a Rapid7 InsightIDR investigation. Optionally, set the investigation disposition.",
        "format": "text"
      },
      "destination_handle": "fn_rapid7_insight_idr",
      "display_name": "Rapid7: InsightIDR Set Status",
      "export_key": "rapid7_insight_idr_set_status",
      "id": 8,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705074849802,
      "name": "rapid7_insight_idr_set_status",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"rrn\": \"rrn:investigation:us2:eeeeeeeee-c4c4-427c-8fc9-f9efe1e1e1e1e1:investigation:3XAAXAAXAAXAA\", \"organization_id\": \"e4463fba-cd64-427c-8fc9-f9e1e1e1e1e1e1e1\", \"title\": \"Our 1st investigation\", \"source\": \"USER\", \"status\": \"CLOSED\", \"priority\": \"LOW\", \"last_accessed\": \"2023-12-08T17:30:12.959Z\", \"created_time\": \"2023-11-10T15:55:12.182Z\", \"disposition\": \"BENIGN\", \"assignee\": null, \"first_alert_time\": null, \"latest_alert_time\": null, \"responsibility\": null}, \"raw\": null, \"inputs\": {\"rapid7_insight_idr_threat_command_free_text\": \"\u003cdiv class=\\\"rte\\\"\u003e\u003cdiv\u003eAdmin User closing as BENIGN from SOAR December 8, 2023\u003c/div\u003e\u003c/div\u003e\", \"rapid7_insight_idr_status\": \"CLOSED\", \"rapid7_insight_idr_disposition\": \"BENIGN\", \"rapid7_insight_idr_threat_command_close_reason\": \"ProblemSolved\", \"rapid7_insight_idr_incident_id\": 2211, \"rapid7_insight_idr_rrn\": \"rrn:investigation:us2:eeeeeeeee-c4c4-427c-8fc9-f9efe1e1e1e1e1:investigation:3XAAXAAXAAXAA\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-rapid7-insight-idr\", \"package_version\": \"1.0.0\", \"host\": \"laptop.local\", \"execution_time_ms\": 93166, \"timestamp\": \"2023-12-08 12:30:12\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"rrn\": {\"type\": \"string\"}, \"organization_id\": {\"type\": \"string\"}, \"title\": {\"type\": \"string\"}, \"source\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}, \"priority\": {\"type\": \"string\"}, \"last_accessed\": {\"type\": \"string\"}, \"created_time\": {\"type\": \"string\"}, \"disposition\": {\"type\": \"string\"}, \"assignee\": {}, \"first_alert_time\": {}, \"latest_alert_time\": {}, \"responsibility\": {}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"rapid7_insight_idr_threat_command_free_text\": {\"type\": \"string\"}, \"rapid7_insight_idr_status\": {\"type\": \"string\"}, \"rapid7_insight_idr_disposition\": {\"type\": \"string\"}, \"rapid7_insight_idr_threat_command_close_reason\": {\"type\": \"string\"}, \"rapid7_insight_idr_incident_id\": {\"type\": \"integer\"}, \"rapid7_insight_idr_rrn\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "1a99f9eb-7e96-47dc-ad15-749e4bfc3a83",
      "version": 0,
      "view_items": [
        {
          "content": "7f6f5aa9-b639-4feb-92b6-03854a38f9b6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4bfd7152-8fe5-42e7-ac57-d2bd3adb4821",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "8cb36735-4dea-4f91-af7e-00e56a761eef",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c82bb4e7-1f85-4aaa-85ca-f73101e5a294",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 76,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1708454716828,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1708454716828,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "7a2f01ad-e77d-41eb-abe1-c736b4e60f52"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_rapid7_insight_idr",
      "name": "Rapid7 InsightIDR",
      "programmatic_name": "fn_rapid7_insight_idr",
      "tags": [],
      "users": [
        "admin@example.com"
      ],
      "uuid": "5464903f-c1f2-4872-ab4e-d75f526af4c2"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "changed_to",
              "type": null,
              "value": "Closed"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471\" isExecutable=\"true\" name=\"playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_17dwniq\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Rapid7: InsightIDR Set Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"1a99f9eb-7e96-47dc-ad15-749e4bfc3a83\"\u003e{\"inputs\":{},\"pre_processing_script\":\"STATUS_LOOKUP = {\\n  \\\"Unresolved\\\": \\\"CLOSED\\\",   # Unresolved\\n  \\\"Duplicate\\\": \\\"CLOSED\\\",    # Duplicate\\n  \\\"Not an Issue\\\": \\\"CLOSED\\\", # Not an Issue\\n  \\\"Resolved\\\": \\\"CLOSED\\\"      # Resolved\\n}\\n\\ninputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\\ninputs.rapid7_insight_idr_status = STATUS_LOOKUP.get(incident.resolution_id, \\\"CLOSED\\\")\\n\\n# The disposition is updated in the Close case layout dialog so pick it up from the custom field\\nif incident.properties.rapid7_insight_idr_disposition == \\\"Undecided\\\":\\n  helper.fail(\\\"Rapid7 InsightIDR Investigation cannot be closed with Disposition: Undecided\\\")\\nelse:\\n  inputs.rapid7_insight_idr_disposition = incident.properties.rapid7_insight_idr_disposition\\n\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"set_status_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0abxy2m\u003c/incoming\u003e\u003coutgoing\u003eFlow_1fgwc1c\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_17dwniq\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0tf9vqg\u003c/incoming\u003e\u003cincoming\u003eFlow_19hhrh5\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Rapid7 InsightIDR: Write set status results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"b1f664a3-014d-4b5a-89d2-9700f16f1b03\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1fgwc1c\u003c/incoming\u003e\u003coutgoing\u003eFlow_0tf9vqg\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1fgwc1c\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_0tf9vqg\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"Rapid7 InsightIDR: Post Comment to Rapid7 Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f734a215-d11b-4eec-9dff-2319366c54e1\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\\ninputs.rapid7_insight_idr_comment_text = incident.resolution_summary.content if incident.resolution_summary.content else \\\"Case {0} was closed in QRadar SOAR\\\".format(incident.id)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"post_comment_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_17dwniq\u003c/incoming\u003e\u003coutgoing\u003eFlow_0rumdgm\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0rumdgm\" sourceRef=\"ServiceTask_4\" targetRef=\"ConditionPoint_5\"/\u003e\u003cexclusiveGateway default=\"Flow_0kiccls\" id=\"ConditionPoint_5\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_0rumdgm\u003c/incoming\u003e\u003coutgoing\u003eFlow_0abxy2m\u003c/outgoing\u003e\u003coutgoing\u003eFlow_0kiccls\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003cscriptTask id=\"ScriptTask_6\" name=\"Rapid7 InsightIDR: Write comment post error to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7627a8c9-203f-4783-9594-b1976b2bfd53\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0kiccls\u003c/incoming\u003e\u003coutgoing\u003eFlow_19hhrh5\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_19hhrh5\" sourceRef=\"ScriptTask_6\" targetRef=\"EndPoint_2\"/\u003e\u003csequenceFlow id=\"Flow_0abxy2m\" name=\"Test close comment posted\" sourceRef=\"ConditionPoint_5\" targetRef=\"ServiceTask_1\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"Test close comment posted\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"# One line example:\\n#\\n# result = incident.employee_involved = True\\n#\\n# Multi-line example:\\n#\\n# certificate_expired = playbook.functions.results.certificate_results.is_expired\\n# if (incident.employee_involved == True and certificate_expired):\\n#     result = True\\n# else:\\n#     result = False\\nresults = playbook.functions.results.post_comment_results\\nif results.get(\\\"success\\\"):\\n  result = True\\nelse:\\n  result = False\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_0kiccls\" name=\"Else\" sourceRef=\"ConditionPoint_5\" targetRef=\"ScriptTask_6\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0kiccls\" id=\"Flow_0kiccls_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"186\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"227\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"227\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"298\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"784\" y=\"209\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0abxy2m\" id=\"Flow_0abxy2m_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"186\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"207\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"207\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"238\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"27\" width=\"84\" x=\"573\" y=\"216\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_19hhrh5\" id=\"Flow_19hhrh5_di\"\u003e\u003comgdi:waypoint x=\"870\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"423\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"423\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"494\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0rumdgm\" id=\"Flow_0rumdgm_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"102\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"134\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0tf9vqg\" id=\"Flow_0tf9vqg_di\"\u003e\u003comgdi:waypoint x=\"600\" y=\"462\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"478\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"478\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"494\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1fgwc1c\" id=\"Flow_1fgwc1c_di\"\u003e\u003comgdi:waypoint x=\"600\" y=\"322\"/\u003e\u003comgdi:waypoint x=\"600\" y=\"378\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_17dwniq\" id=\"Flow_17dwniq_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-24\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"18\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"-76\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"502\" y=\"238\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"494\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"502\" y=\"378\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"18\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_5\" id=\"ConditionPoint_5_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"599\" y=\"134\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_6\" id=\"ScriptTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"772\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074850197,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471",
      "description": {
        "content": "Automatic playbook that updates the Status and disposition of the associated investigation in Rapid7 InsightIDR when the cases is closed in SOAR.  The SOAR case resolution summary is written as a comment to the Rapid7 InsightIDR investigation.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Close Investigation On Case Close",
      "export_key": "rapid7_insight_idr_close_investigation_on_case_close",
      "field_type_handle": "playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Close Investigation On Case Close",
        "export_key": "playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_b934321f_5e9a_4aa3_a8c6_a6980ff5b471",
        "uuid": "e28c8723-a226-435d-beed-06c5cede0dc9"
      },
      "has_logical_errors": false,
      "id": 1,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705525622022,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074850263,
          "description": "Write post comment function results to a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Write comment post error to a note",
          "id": 4,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1705074850263,
          "name": "Rapid7 InsightIDR: Write comment post error to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_close_investigation_on_case_close",
          "programmatic_name": "rapid7_insight_idr_close_investigation_on_case_close_rapid7_insight_idr_on_close_in_soar_update_status_in_rapid7_rapid7_insightidr_write_comment_post_error_to_a_note",
          "script_text": "results = playbook.functions.results.post_comment_results\n\nnote_text = \"Rapid7 InsightIDR Automatic playbook \u003cb\u003eOn close from SOAR case\u003c/b\u003e failed to post comment to Rapid7 InsightIDR: {0}\".format(results.get(\"reason\", None))\n\nincident.addNote(note_text)",
          "tags": [],
          "uuid": "7627a8c9-203f-4783-9594-b1976b2bfd53"
        },
        {
          "actions": [],
          "created_date": 1705074850279,
          "description": "Write functions results to set the status in Rapid7 InsightIDR investigation.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Write set status results to a note",
          "id": 5,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1705074850279,
          "name": "Rapid7 InsightIDR: Write set status results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_close_investigation_on_case_close",
          "programmatic_name": "rapid7_insight_idr_close_investigation_on_case_close_rapid7_insight_idr_on_close_in_soar_update_status_in_rapid7_rapid7_insightidr_write_set_status_results_to_a_note",
          "script_text": "results = playbook.functions.results.set_status_results\n\nif results.get(\"success\"):\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Status on Close:\u003c/b\u003e Closed investigation in Rapid7 InsightIDR\"\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Status on Close:\u003c/b\u003e Failed function to set status. Reason = {0}\".format(results.get(\"reason\"))\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "b1f664a3-014d-4b5a-89d2-9700f16f1b03"
        }
      ],
      "name": "rapid7_insight_idr_close_investigation_on_case_close",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_b934321f-5e9a-4aa3-a8c6-a6980ff5b471",
        "id": 2,
        "name": "playbook_b934321f-5e9a-4aa3-a8c6-a6980ff5b471",
        "type": "playbook",
        "uuid": "24910d09-73e9-405f-8b13-aef0634b1e23"
      },
      "tags": [],
      "type": "default",
      "uuid": "b934321f-5e9a-4aa3-a8c6-a6980ff5b471",
      "version": 5
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_summary",
              "method": "changed",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.resolution_summary",
              "method": "contains",
              "type": null,
              "value": "Closed by Rapid7 InsightIDR"
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_6338d730_15de_4107_ba8f_1f921eb62165\" isExecutable=\"true\" name=\"playbook_6338d730_15de_4107_ba8f_1f921eb62165\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_03a5kci\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cscriptTask id=\"ScriptTask_1\" name=\"Rapid7 InsightIDR is closed by Rapid7 InsightIDR\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"8d2fed72-e35b-4c6c-a0af-d173e10b50b8\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_03a5kci\u003c/incoming\u003e\u003coutgoing\u003eFlow_02fw4u2\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_03a5kci\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ScriptTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_02fw4u2\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_02fw4u2\" sourceRef=\"ScriptTask_1\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_6338d730_15de_4107_ba8f_1f921eb62165\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02fw4u2\" id=\"Flow_02fw4u2_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"294\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_03a5kci\" id=\"Flow_03a5kci_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_1\" id=\"ScriptTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"294\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074850805,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_6338d730_15de_4107_ba8f_1f921eb62165",
      "description": {
        "content": "Write a note to SOAR when Rapid7 InsightIDR closes an investigation.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Closed by Rapid7 InsightIDR",
      "export_key": "rapid7_insight_idr_closed_by_rapid7_insightidr",
      "field_type_handle": "playbook_6338d730_15de_4107_ba8f_1f921eb62165",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Closed by Rapid7 InsightIDR",
        "export_key": "playbook_6338d730_15de_4107_ba8f_1f921eb62165",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_6338d730_15de_4107_ba8f_1f921eb62165",
        "uuid": "7c466e91-4e85-4c28-ab1c-8c2f046ce60e"
      },
      "has_logical_errors": false,
      "id": 2,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705525622470,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074850872,
          "description": "Write a note when investigation is closed by Rapid7 InsightIDR",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR is closed by Rapid7 InsightIDR",
          "id": 6,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1705074850872,
          "name": "Rapid7 InsightIDR is closed by Rapid7 InsightIDR",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_closed_by_rapid7_insightidr",
          "programmatic_name": "rapid7_insight_idr_closed_by_rapid7_insightidr_rapid7_insightidr_closed_by_rapid7_insightidr_rapid7_insightidr_is_closed_by_rapid7_insightidr",
          "script_text": "incident.addNote(\"Rapid7 InsightIDR investigation was closed in InsightIDR\u003cbr\u003e Resolution Id: {0}\u003cbr\u003e Resolution Summary: {1}\".format(incident.resolution_id, incident.resolution_summary))",
          "tags": [],
          "uuid": "8d2fed72-e35b-4c6c-a0af-d173e10b50b8"
        }
      ],
      "name": "rapid7_insight_idr_closed_by_rapid7_insightidr",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_6338d730-15de-4107-ba8f-1f921eb62165",
        "id": 3,
        "name": "playbook_6338d730-15de-4107-ba8f-1f921eb62165",
        "type": "playbook",
        "uuid": "ede0a708-958f-4533-99c1-e00a1ce2b381"
      },
      "tags": [],
      "type": "default",
      "uuid": "6338d730-15de-4107-ba8f-1f921eb62165",
      "version": 4
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 19,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865\" isExecutable=\"true\" name=\"playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1mxqq25\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1rxczew\u003c/incoming\u003e\u003c/endEvent\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"Rapid7 InsightIDR: Get Alert Evidence\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fa9a8006-3951-4c16-a1ef-58a27196268c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn_optional = incident.properties.rapid7_insight_idr_rrn\\n\\n# The \\\"User Behavior Analytics\\\" alert source uses the \\\"restricted\\\" InsightIDR endpoint \\n# that uses the rrn of the investigation to get the alert evidence.  It does not have\\n# an alert_rrn.\\ninputs.rapid7_insight_idr_alert_rrn = None if row.r7_alert_source == \\\"User Behavior Analytics\\\" else row.r7_alert_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alert_evident_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1mxqq25\u003c/incoming\u003e\u003coutgoing\u003eFlow_03jb345\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1mxqq25\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"Rapid7 InsightIDR: Update evidence and create artifacts\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"00472ef7-6f43-4dc9-99da-06a3de9b383a\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_03jb345\u003c/incoming\u003e\u003coutgoing\u003eFlow_1rxczew\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1rxczew\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_1\"/\u003e\u003csequenceFlow id=\"Flow_03jb345\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_03jb345\" id=\"Flow_03jb345_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"222\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1rxczew\" id=\"Flow_1rxczew_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"404\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1mxqq25\" id=\"Flow_1mxqq25_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"86\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"138\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"34\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"404\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.825\" y=\"138\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.825\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1707922805300,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865",
      "description": {
        "content": "Get the alert evidence of the alert in the data table row and write the JSON results to the Evidence column of the Alerts data table.  Create artifacts from the evidence.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Get Alert Evidence",
      "export_key": "rapid7_insight_idr_get_alert_evidence_dt",
      "field_type_handle": "playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Get Alert Evidence DT",
        "export_key": "playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865",
        "uuid": "1d3af827-f38f-449d-bdbb-92513e072ecc"
      },
      "has_logical_errors": false,
      "id": 33,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1708391026067,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1707922805368,
          "description": "Put the alert evidence  JSON in a Evidence column of Alerts data table and create artifacts.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Update evidence and create artifacts",
          "id": 50,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1708391023481,
          "name": "Rapid7 InsightIDR: Update evidence and create artifacts",
          "object_type": "rapid7_insight_idr_alerts_dt",
          "playbook_handle": "rapid7_insight_idr_get_alert_evidence_dt",
          "programmatic_name": "rapid7_insight_idr_get_alert_evidence_dt_rapid7_insightidr_write_alert_evidence_to_a_note",
          "script_text": "from json import (dumps, loads)\n\nresults = playbook.functions.results.get_alert_evident_results\n\nevidence_data = {}\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  inputs = results.get(\"inputs\", {})\n  if content: \n    alert_data = content.get(\"data\", {})\n    if alert_data:\n      # evidences is defined only in the case of non-restricted endpoint\n      evidences = alert_data.get(\"evidences\", False)\n      if evidences:\n        # Only one alert is returned. Get the data to display in the note\n        evidence = evidences[0]\n        data_string = evidence.get(\"data\", \"\")\n        if data_string:\n          evidence_data = loads(data_string)\n      else:\n        # restricted endpoint results \n        indicator_occurrences = alert_data.get(\"indicator_occurrences\", None)\n        if indicator_occurrences:\n          evidence = indicator_occurrences[0].get(\"evidence\", None)\n          if evidence:\n            details = evidence[0].get(\"details\", None)\n            if details:\n              data_string = details.get(\"logline\", None)\n              if data_string:\n                evidence_data = loads(data_string)\n    if evidence_data:\n      # Update the Evidence DT column with JSON evidence\n      row.r7_evidence = dumps(evidence_data, indent=4)\n      \n      # Create artifacts from the evidence\n      hostname = evidence_data.get(\"hostname\",None)\n      if hostname:\n        incident.addArtifact(\"System Name\", hostname, \"Evidence from Rapid7 InsightIDR\")\n      appname = evidence_data.get(\"appname\",None)\n      if appname:\n        incident.addArtifact(\"Service\", appname, \"Evidence from Rapid7 InsightIDR\")\n    else:\n      incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Get Evidence:\u003c/b\u003e No evidence found: {0}\".format(results.get(\"reason\", None)))\n  else:\n    incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Get Evidence:\u003c/b\u003e No content found\")\nelse:\n  incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Get Evidence: No evidence found {0}\".format(results.get(\"reason\", None)))",
          "tags": [],
          "uuid": "00472ef7-6f43-4dc9-99da-06a3de9b383a"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "rapid7_insight_idr_get_alert_evidence_dt",
      "object_type": "rapid7_insight_idr_alerts_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_7ce8f267-4fbe-4480-8aef-ec0e47604865",
        "id": 35,
        "name": "playbook_7ce8f267_4fbe_4480_8aef_ec0e47604865",
        "type": "playbook",
        "uuid": "96c4e176-f54e-43d6-8561-a62302a6e794"
      },
      "tags": [],
      "type": "default",
      "uuid": "7ce8f267-4fbe-4480-8aef-ec0e47604865",
      "version": 23
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 5,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d\" isExecutable=\"true\" name=\"playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0275kdc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Rapid7 InsightIDR: Get Alerts\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"1a98c2fc-279a-4b9d-a314-1527777cfaa3\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alerts_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0275kdc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1nrfmjn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0275kdc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Rapid7 InsightIDR: write alert to the Alerts data table and to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7fea65d2-8780-437c-8ad0-241ffb671624\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1nrfmjn\u003c/incoming\u003e\u003coutgoing\u003eFlow_1riicmt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1nrfmjn\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1riicmt\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1riicmt\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1riicmt\" id=\"Flow_1riicmt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"102\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"154\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nrfmjn\" id=\"Flow_1nrfmjn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-28\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"18\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0275kdc\" id=\"Flow_0275kdc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-174\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-112\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"-226\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"622.542\" y=\"-112\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"18\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"654.542\" y=\"154\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074851128,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d",
      "description": {
        "content": "Get the alerts associated with a Rapid7 Insight IDR investigation.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Get Alerts",
      "export_key": "rapid7_insight_idr_get_alerts",
      "field_type_handle": "playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Get Alerts",
        "export_key": "playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_e49d7c2b_f8e9_42ed_99b9_99c76f0edd2d",
        "uuid": "1de7d5e3-244b-4ef7-a639-3ef6d03615ef"
      },
      "has_logical_errors": false,
      "id": 3,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1708004144623,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074851181,
          "description": "Write the results of Get Alerts function to the data table and a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: write alert to the Alerts data table and to a note",
          "id": 7,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1708004141896,
          "name": "Rapid7 InsightIDR: write alert to the Alerts data table and to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_get_alerts",
          "programmatic_name": "rapid7_insight_idr_get_alerts_rapid7_insightidr_get_alerts_rapid7_insightidr_write_alert_to_a_note",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alerts_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert_list = content.get(\"alert_list\", [])\n    if alert_list:\n      for alert in alert_list:\n        alert_row = incident.addRow(\"rapid7_insight_idr_alerts_dt\")\n        alert_row.r7_query_date = datetime.now()\n        alert_row.r7_alert_id = alert.get(\"id\", None)\n        alert_row.r7_alert_source = alert.get(\"alert_source\", None)\n        alert_row.r7_alert_type = alert.get(\"alert_type\", None)\n        alert_row.r7_created_time = alert.get(\"created_time\")\n        detection_rule_rrn = alert.get(\"detection_rule_rrn\", None)\n        if detection_rule_rrn:\n          alert_row.r7_detection_rrn = detection_rule_rrn.get(\"rule_rrn\", None)\n          alert_row.r7_detection_rule = detection_rule_rrn.get(\"rule_name\", None)\n      note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Alerts:\u003c/b\u003e Added \u003cb\u003e{0}\u003c/b\u003e alerts to the Alerts data table\".format(len(alert_list))\n    else:\n     note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Alerts:\u003c/b\u003e No alerts found.\"     \n  else:\n    note_text = \"Rapid7 InsightIDR Get Alerts: No alerts found (no content).\"\nelse:\n  note_text = \"Rapid7 InsightIDR Get Alerts: Failed function to get alerts. Reason = {0}\".format(results.get(\"reason\", None))\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "7fea65d2-8780-437c-8ad0-241ffb671624"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "rapid7_insight_idr_get_alerts",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_e49d7c2b-f8e9-42ed-99b9-99c76f0edd2d",
        "id": 4,
        "name": "playbook_e49d7c2b-f8e9-42ed-99b9-99c76f0edd2d",
        "type": "playbook",
        "uuid": "535d4b42-6c2e-4647-8afb-f6afb5b40a6b"
      },
      "tags": [],
      "type": "default",
      "uuid": "e49d7c2b-f8e9-42ed-99b9-99c76f0edd2d",
      "version": 8
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b\" isExecutable=\"true\" name=\"playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_09flxqn\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Rapid7 InsightIDR: Add Attachments to SOAR Case\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"8acc7c3d-4f9f-4e52-9d81-ab7105b82207\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_attachments_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_09flxqn\u003c/incoming\u003e\u003coutgoing\u003eFlow_09ttvbx\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_09flxqn\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Rapid7 InsightIDR: Write add attachments to SOAR case results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d8a880eb-4417-48b7-a72f-ddad01fbf4c3\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_09ttvbx\u003c/incoming\u003e\u003coutgoing\u003eFlow_10eboed\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_09ttvbx\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1cbvfn5\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_10eboed\" sourceRef=\"ScriptTask_2\" targetRef=\"ServiceTask_4\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"Rapid7 InsightIDR: Get Comments from Rapid7 Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"63beafd5-52ae-4693-a8b6-9d556a4a4637\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_comments_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_10eboed\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ii52la\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0ii52la\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"Rapid7 InsightIDR: write get comments function result to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"8d3a6edf-202e-4dde-905a-8d7eefc1ae77\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ii52la\u003c/incoming\u003e\u003coutgoing\u003eFlow_1cbvfn5\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1cbvfn5\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1cbvfn5\" id=\"Flow_1cbvfn5_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"294\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ii52la\" id=\"Flow_0ii52la_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"132\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_10eboed\" id=\"Flow_10eboed_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"12\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"48\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_09ttvbx\" id=\"Flow_09ttvbx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-108\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-72\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_09flxqn\" id=\"Flow_09flxqn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-234\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-192\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"-286\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"-192\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"-72\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"294\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"48\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074851480,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b",
      "description": {
        "content": "Manual playbook to get the attachments associated with the Rapid7 InsightIDR investigation and add them as attachments to the SOAR case.  Also call the function to pull in new comments from the investigation as attachments often have associated comments with them in Rapid7 InsightIDR.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Get Attachments from Investigation",
      "export_key": "rapid7_insight_idr_get_attachments_from_investigation",
      "field_type_handle": "playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Get Attachments from Investigation",
        "export_key": "playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b",
        "uuid": "0d176cf8-070b-490b-8ebd-ad304a6a4520"
      },
      "has_logical_errors": false,
      "id": 4,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1708454670095,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074851541,
          "description": "Write add attachments to SOAR case function results to a note",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Write add attachments to SOAR case results to a note",
          "id": 8,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1708454520814,
          "name": "Rapid7 InsightIDR: Write add attachments to SOAR case results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_get_attachments_from_investigation",
          "programmatic_name": "rapid7_insight_idr_get_attachments_from_investigation_rapid7_insightidr_write_add_attachments_to_soar_case_results_to_a_note",
          "script_text": "results = playbook.functions.results.add_attachments_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\", {})\n  if content:\n    rapid7_attachments = content.get(\"rapid7_insight_idr_attachments\")\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Attachments:\u003c/b\u003e added {} attachments to incident:\u003cbr\u003e\".format(len(rapid7_attachments))\n    for attachment_name in rapid7_attachments:\n      note_text = note_text + \"\u003cbr\u003e{}\".format(attachment_name)\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Attachments\u003c/b\u003e failed to get \u003cb\u003eALL\u003c/b\u003e attachments from Rapid7 InsightIDR. Retry later:\u003cbr\u003e {0}.\".format(results.get(\"reason\", None))\nincident.addNote(note_text)\n",
          "tags": [],
          "uuid": "d8a880eb-4417-48b7-a72f-ddad01fbf4c3"
        },
        {
          "actions": [],
          "created_date": 1707318196139,
          "description": "Write get comments function result to an incident note in SOAR.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: write get comments function result to a note",
          "id": 46,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1707318196139,
          "name": "Rapid7 InsightIDR: write get comments function result to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_get_attachments_from_investigation",
          "programmatic_name": "rapid7_insight_idr_get_attachments_from_investigation_rapid7_insightidr_write_get_comments_function_result_to_a_note",
          "script_text": "results = playbook.functions.results.get_comments_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\", {})\n  if content:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e playbook created {0} notes in SOAR\".format(content.get(\"count\"))\n  else:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e function failed to get notes from Rapid7 InsightIDR\"\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e function failed to get notes from Rapid7 InsightIDR\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "8d3a6edf-202e-4dde-905a-8d7eefc1ae77"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "rapid7_insight_idr_get_attachments_from_investigation",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_8d2cb2d3-e193-43e4-8a70-cd240f7df14b",
        "id": 5,
        "name": "playbook_8d2cb2d3_e193_43e4_8a70_cd240f7df14b",
        "type": "playbook",
        "uuid": "76df5572-7534-430f-b06e-b28b243757e5"
      },
      "tags": [],
      "type": "default",
      "uuid": "8d2cb2d3-e193-43e4-8a70-cd240f7df14b",
      "version": 12
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_fa11a617_d942_47b4_8f99_c73c9e993189\" isExecutable=\"true\" name=\"playbook_fa11a617_d942_47b4_8f99_c73c9e993189\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0stcf3m\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Rapid7 InsightIDR: Post Comment to Rapid7 Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f734a215-d11b-4eec-9dff-2319366c54e1\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\\ninputs.rapid7_insight_idr_comment_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"send_note_to_rapid7_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0stcf3m\u003c/incoming\u003e\u003coutgoing\u003eFlow_0p76if9\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0stcf3m\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_14afg8x\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0p76if9\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Rapid7 InsightIDR: Edit note when sent\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"6184e4cb-8105-4a40-9c3b-ec1f37f2ffba\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0p76if9\u003c/incoming\u003e\u003coutgoing\u003eFlow_14afg8x\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_14afg8x\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_fa11a617_d942_47b4_8f99_c73c9e993189\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14afg8x\" id=\"Flow_14afg8x_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"92\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"144\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0p76if9\" id=\"Flow_0p76if9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-48\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"8\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0stcf3m\" id=\"Flow_0stcf3m_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"-174\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"-132\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"-226\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"-132\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655.283\" y=\"144\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"8\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074852528,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_fa11a617_d942_47b4_8f99_c73c9e993189",
      "description": {
        "content": "Manual playbook that sends a note in SOAR to an investigation in Rapid7 InsightIDR as a comment.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Send Note to Rapid7 Investigation",
      "export_key": "rapid7_insight_idr_send_note_to_rapid7_investigation",
      "field_type_handle": "playbook_fa11a617_d942_47b4_8f99_c73c9e993189",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Send Note to Rapid7 Investigation",
        "export_key": "playbook_fa11a617_d942_47b4_8f99_c73c9e993189",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_fa11a617_d942_47b4_8f99_c73c9e993189",
        "uuid": "6fdaff71-c2d4-41e7-9aa0-d4441a33e5a3"
      },
      "has_logical_errors": false,
      "id": 7,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1705525624631,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074852580,
          "description": "Edit the SOAR note when it is sent to Rapid7, so we know it has been sent",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Edit note when sent",
          "id": 11,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1705074852580,
          "name": "Rapid7 InsightIDR: Edit note when sent",
          "object_type": "note",
          "playbook_handle": "rapid7_insight_idr_send_note_to_rapid7_investigation",
          "programmatic_name": "rapid7_insight_idr_send_note_to_rapid7_investigation_rapid7_insightidr_send_note_to_rapid7_investigation_rapid7_insightidr_edit_note_when_sent",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.send_note_to_rapid7_results\n\n# Edit note in SOAR to indicate it was sent to Rapid7 InsightIDR investigation\nif results.get(\"success\"):\n  # Get the current time\n  now = datetime.now()\n  note.text = u\"\u003cb\u003eSent to Rapid7 InsightIDR at {0}\u003c/b\u003e\u003cbr\u003e{1}\".format(now, note.text.content)\n  ",
          "tags": [],
          "uuid": "6184e4cb-8105-4a40-9c3b-ec1f37f2ffba"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Sent to Rapid7 InsightIDR at"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "rapid7_insight_idr_send_note_to_rapid7_investigation",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_fa11a617-d942-47b4-8f99-c73c9e993189",
        "id": 8,
        "name": "playbook_fa11a617-d942-47b4-8f99-c73c9e993189",
        "type": "playbook",
        "uuid": "94735c2e-a8a7-4b5d-8efa-6c06f44a0393"
      },
      "tags": [],
      "type": "default",
      "uuid": "fa11a617-d942-47b4-8f99-c73c9e993189",
      "version": 5
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.severity_code",
              "method": "changed",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225\" isExecutable=\"true\" name=\"playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1lh6djy\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Rapid7 InsightIDR: Set Priority\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"0a685b85-1daa-45ae-826b-ac7dc07076cf\"\u003e{\"inputs\":{},\"pre_processing_script\":\"PRIORITY_MAPPING = {\\n  \\\"Low\\\": \\\"LOW\\\",\\n  \\\"Medium\\\": \\\"MEDIUM\\\",\\n  \\\"High\\\": \\\"HIGH\\\"\\n}\\ninputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\\ninputs.rapid7_insight_idr_priority = PRIORITY_MAPPING.get(incident.severity_code)\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"set_priority_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1lh6djy\u003c/incoming\u003e\u003coutgoing\u003eFlow_114xqv0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1lh6djy\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Rapid7 InsightIDR: Set priority \"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"125356c1-787c-44c8-baac-5d3a40be7853\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_114xqv0\u003c/incoming\u003e\u003coutgoing\u003eFlow_0j425p7\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_114xqv0\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0j425p7\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0j425p7\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0j425p7\" id=\"Flow_0j425p7_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"402\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"464\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_114xqv0\" id=\"Flow_114xqv0_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"318\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1lh6djy\" id=\"Flow_1lh6djy_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"318\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"464\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074852884,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225",
      "description": {
        "content": "Playbook to automatically update the priority of a Rapid7 InsightIDR investigation if the priority is changed in SOAR.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Set Priority Automatically",
      "export_key": "rapid7_insight_idr_set_priority_automatically",
      "field_type_handle": "playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Set Priority Automatically",
        "export_key": "playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_19ae810a_499e_4c4a_8cf5_f669ff5d7225",
        "uuid": "29895984-1077-4a12-8208-cee7154aad79"
      },
      "has_logical_errors": false,
      "id": 8,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1706902327540,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074852944,
          "description": "Write results of set priority function in Rapid7 InsightIDR to a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Set priority ",
          "id": 12,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1705074852944,
          "name": "Rapid7 InsightIDR: Set priority ",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_set_priority_automatically",
          "programmatic_name": "rapid7_insight_idr_set_priority_automatically_rapid7_insightidr_set_priority_automatically_rapid7_insightidr_set_priority_",
          "script_text": "results = playbook.functions.results.set_priority_results\n\nif results.get(\"success\"):\n  priority = results.content.priority\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Priority\u003c/b\u003e Automatic Playbook set:\u003cbr\u003e   Priority: {0}\".format(priority)\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Priority\u003c/b\u003e Automatic Playbook failed:\u003cbr\u003e  {0}\".results.get(\"reason\")\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "125356c1-787c-44c8-baac-5d3a40be7853"
        }
      ],
      "name": "rapid7_insight_idr_set_priority_automatically",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_19ae810a-499e-4c4a-8cf5-f669ff5d7225",
        "id": 9,
        "name": "playbook_19ae810a-499e-4c4a-8cf5-f669ff5d7225",
        "type": "playbook",
        "uuid": "ad971f1d-48de-48bb-8425-0b8012fd9797"
      },
      "tags": [],
      "type": "default",
      "uuid": "19ae810a-499e-4c4a-8cf5-f669ff5d7225",
      "version": 8
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 4,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_44a50e84_66ec_48af_93be_1c4704c19449\" isExecutable=\"true\" name=\"playbook_44a50e84_66ec_48af_93be_1c4704c19449\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_17lj24k\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Rapid7: InsightIDR Set Status\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"1a99f9eb-7e96-47dc-ad15-749e4bfc3a83\"\u003e{\"inputs\":{},\"pre_processing_script\":\"STATUS_MAPPING = {\\n  \\\"Open\\\": \\\"OPEN\\\",\\n  \\\"Investigating\\\": \\\"INVESTIGATING\\\",\\n  \\\"Waiting\\\": \\\"WAITING\\\",\\n  \\\"Closed\\\": \\\"CLOSED\\\"\\n}\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\\ninputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_status = STATUS_MAPPING.get(playbook.inputs.rapid7_insight_idr_status)\\n\\nif inputs.rapid7_insight_idr_status == \\\"CLOSED\\\" and playbook.inputs.rapid7_insight_idr_disposition == \\\"Undecided\\\":\\n  helper.fail(\\\"Rapid7 InsightIDR: Status can not be set to Closed with Disposition set to Undecided\\\")\\nelse:\\n  inputs.rapid7_insight_idr_disposition = playbook.inputs.rapid7_insight_idr_disposition\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"set_status_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_17lj24k\u003c/incoming\u003e\u003coutgoing\u003eFlow_1jxe78g\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_17lj24k\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Rapid7 InsightIDR: Write set status and disposition results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"91cb60bd-3866-4074-9233-46df750500ea\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1jxe78g\u003c/incoming\u003e\u003coutgoing\u003eFlow_09fsgew\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_09fsgew\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_09fsgew\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003csequenceFlow id=\"Flow_1jxe78g\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_44a50e84_66ec_48af_93be_1c4704c19449\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1jxe78g\" id=\"Flow_1jxe78g_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_09fsgew\" id=\"Flow_09fsgew_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"454\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_17lj24k\" id=\"Flow_17lj24k_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"454\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074853216,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
      "description": {
        "content": "Manual playbook to set the Status and Disposition of the Rapid7 InsightIDR investigation in Rapid7 InsightIDR",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Set Status and Disposition",
      "export_key": "rapid7_insight_idr_set_status_and_disposition",
      "field_type_handle": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Set Status and Disposition",
        "export_key": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
        "fields": {
          "rapid7_insight_idr_disposition": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_44a50e84_66ec_48af_93be_1c4704c19449/rapid7_insight_idr_disposition",
            "hide_notification": false,
            "id": 322,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "rapid7_insight_idr_disposition",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Disposition",
            "tooltip": "",
            "type_id": 1009,
            "uuid": "abe781bb-b436-4b17-b0c0-97b4447233ea",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Benign",
                "properties": null,
                "uuid": "f0bdc369-776f-424a-bf47-f8e8420e33b8",
                "value": 111
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Malicious",
                "properties": null,
                "uuid": "51acc124-cf09-49b3-8df4-fcf4037dc8b1",
                "value": 112
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Unknown",
                "properties": null,
                "uuid": "b74b39ff-1756-41b1-8c62-8c10f44988a1",
                "value": 113
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Applicable",
                "properties": null,
                "uuid": "33b99c14-2274-427f-b6ef-cf39f00c5496",
                "value": 114
              }
            ]
          },
          "rapid7_insight_idr_status": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_44a50e84_66ec_48af_93be_1c4704c19449/rapid7_insight_idr_status",
            "hide_notification": false,
            "id": 323,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "rapid7_insight_idr_status",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Status",
            "tooltip": "",
            "type_id": 1009,
            "uuid": "448fbb43-4f2c-4c73-aa0c-86b3dd6ba254",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Open",
                "properties": null,
                "uuid": "049081b3-133d-4452-aff0-e59e23bdae27",
                "value": 115
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Investigating",
                "properties": null,
                "uuid": "123693c3-99c7-4067-83e1-d136516b2cf5",
                "value": 116
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Waiting",
                "properties": null,
                "uuid": "030ce504-cfd8-43fa-b654-a6470c5b5529",
                "value": 117
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Closed",
                "properties": null,
                "uuid": "021aa117-abce-4362-af54-14121032948d",
                "value": 118
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
        "uuid": "fed5d2f8-261e-4cea-93b2-2dfad4266291"
      },
      "has_logical_errors": false,
      "id": 9,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1708363769899,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074853305,
          "description": "Write a note with results from set status and disposition function to a note",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: Write set status and disposition results to a note",
          "id": 13,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1708363761514,
          "name": "Rapid7 InsightIDR: Write set status and disposition results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_set_status_and_disposition",
          "programmatic_name": "rapid7_insight_idr_set_status_and_disposition_rapid7_insightidr_write_set_status_and_disposition_results_to_a_note",
          "script_text": "MAPPING_DISPOSITON_ON_CLOSE = {\n  \"Benign\": \"Resolved\",\n  \"Malicious\": \"Resolved\",\n  \"Unknown\": \"Resolved\",\n  \"Not Applicable\": \"Not an Issue\"\n}\nresults = playbook.functions.results.set_status_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\", {})\n  if content:\n    status = content.get(\"status\", {})\n    input_status = playbook.inputs.rapid7_insight_idr_status\n\n    if status.lower() == input_status.lower():\n        incident.properties.rapid7_insight_idr_status = playbook.inputs.rapid7_insight_idr_status\n        \n    disposition = content.get(\"disposition\", {})\n    input_disposition = playbook.inputs.rapid7_insight_idr_disposition\n    # Not Applicable disposition has space character that needs to be converted to underscore (NOT_APPLICABLE)\n    if disposition.lower() == input_disposition.lower().replace(\" \",\"_\"):\n        incident.properties.rapid7_insight_idr_disposition = playbook.inputs.rapid7_insight_idr_disposition\n        \n    if incident.properties.rapid7_insight_idr_status.lower() == \"closed\":\n      incident.plan_status = \"C\"\n      incident.resolution_id = MAPPING_DISPOSITON_ON_CLOSE.get(incident.properties.rapid7_insight_idr_disposition)\n      incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Status and Disposition\u003c/b\u003e set:\u003cbr\u003e   Status: {0}\u003cbr\u003e   Disposition: {1}\".format(incident.properties.rapid7_insight_idr_status, incident.properties.rapid7_insight_idr_disposition)\n  else:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Status and Disposition\u003c/b\u003e failed:\u003cbr\u003e  {0}\".results.get(\"reason\")\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Set Status and Disposition\u003c/b\u003e failed:\u003cbr\u003e  {0}\".results.get(\"reason\")\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "91cb60bd-3866-4074-9233-46df750500ea"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "equals",
              "type": null,
              "value": "Active"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "448fbb43-4f2c-4c73-aa0c-86b3dd6ba254",
            "element": "field_uuid",
            "field_type": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "abe781bb-b436-4b17-b0c0-97b4447233ea",
            "element": "field_uuid",
            "field_type": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "rapid7_insight_idr_set_status_and_disposition",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_44a50e84-66ec-48af-93be-1c4704c19449",
        "id": 10,
        "name": "playbook_44a50e84_66ec_48af_93be_1c4704c19449",
        "type": "playbook",
        "uuid": "1de8d41b-9558-452e-80ac-318cbbdd654e"
      },
      "tags": [],
      "type": "default",
      "uuid": "44a50e84-66ec-48af-93be-1c4704c19449",
      "version": 7
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 9,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf\" isExecutable=\"true\" name=\"playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1g7ga3g\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0b7a73k\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Rapid7 InsightIDR write update case results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"3540007f-80db-4ecd-ba17-2f5785f11ac1\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1v28gtn\u003c/incoming\u003e\u003coutgoing\u003eFlow_0omq6e9\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0omq6e9\" sourceRef=\"ScriptTask_2\" targetRef=\"ServiceTask_6\"/\u003e\u003csequenceFlow id=\"Flow_1g7ga3g\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_3\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"Rapid7 InsightIDR: Get Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"4cf150e9-653e-4ed7-b3d5-3d36e28db937\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"rapid7_insight_idr_update_case_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1g7ga3g\u003c/incoming\u003e\u003coutgoing\u003eFlow_1v28gtn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1v28gtn\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_6\" name=\"Rapid7 InsightIDR: Get Comments from Rapid7 Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"63beafd5-52ae-4693-a8b6-9d556a4a4637\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_comments_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0omq6e9\u003c/incoming\u003e\u003coutgoing\u003eFlow_13kci7a\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_13kci7a\" sourceRef=\"ServiceTask_6\" targetRef=\"ScriptTask_7\"/\u003e\u003cscriptTask id=\"ScriptTask_7\" name=\"Rapid7 InsightIDR: write comment results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d8c8e080-b653-4fc1-a247-adc2e23e2969\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_13kci7a\u003c/incoming\u003e\u003coutgoing\u003eFlow_0b7a73k\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0b7a73k\" sourceRef=\"ScriptTask_7\" targetRef=\"EndPoint_1\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0b7a73k\" id=\"Flow_0b7a73k_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"572\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"604\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_13kci7a\" id=\"Flow_13kci7a_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"488\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1v28gtn\" id=\"Flow_1v28gtn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"222\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1g7ga3g\" id=\"Flow_1g7ga3g_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"138\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0omq6e9\" id=\"Flow_0omq6e9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"656\" y=\"604\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"138\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_6\" id=\"ServiceTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_7\" id=\"ScriptTask_7_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.468717948718\" y=\"487.78564102564104\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1706290022926,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf",
      "description": {
        "content": "Manual playbook to update a Rapid7 InsightIDR case. Custom fields and comments are updated in SOAR.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Update Case",
      "export_key": "rapid7_insight_idr_update_case",
      "field_type_handle": "playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf",
      "fields_type": {
        "actions": [],
        "display_name": "rapid7_insight_idr_update_case",
        "export_key": "playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_dbb84c2e_9690_4cda_96ac_0a9903f2acbf",
        "uuid": "53ce0693-0d34-4439-8895-5dd3106cd96e"
      },
      "has_logical_errors": false,
      "id": 28,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1707497295996,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1706290023083,
          "description": "Get alert from the investigation and update the Alerts data table",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR Get Alerts",
          "id": 42,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1706290023083,
          "name": "Rapid7 InsightIDR Get Alerts",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_update_case",
          "programmatic_name": "rapid7_insight_idr_update_case_rapid7_insight_idr_update_case_all_rapid7_insightidr_get_alerts",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alerts_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\", {})\n  if content:\n    alert_list = content.get(\"alert_list\", [])\n    if alert_list:\n      for alert in alert_list:\n        alert_row = incident.addRow(\"rapid7_insight_idr_alerts_dt\")\n        alert_row.r7_query_date = datetime.now()\n        alert_row.r7_alert_id = alert.get(\"id\")\n        alert_row.r7_alert_source = alert.get(\"alert_source\")\n        alert_row.r7_alert_type = alert.get(\"alert_type\")\n        alert_row.r7_created_time = alert.get(\"created_time\")\n        alert_row.r7_first_event_time = alert.get(\"first_event_time\")\n        alert_row.r7_latest_event_time = alert.get(\"latest_event_time\")\n        detection_rule_rrn = alert.get(\"detection_rule_rrn\")\n        if detection_rule_rrn:\n          alert_row.r7_detection_rrn = detection_rule_rrn.get(\"rule_rrn\")\n          alert_row.r7_detection_rule = detection_rule_rrn.get(\"rule_name\")\n      note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e Added {0} alerts to the Alerts data table\".format(len(alert_list))\n    else:\n     note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e No alerts found.\"     \n  else:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e No alerts found (no content).\"\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e Failed function to get alerts. Reason = {0}\".format(results.get(\"reason\"))\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "a3f9490c-266e-4759-bfad-4543d17764b9"
        },
        {
          "actions": [],
          "created_date": 1706290023144,
          "description": "Write the results of updating a Rapid7 InsightIDR case to a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR write update case results to a note",
          "id": 43,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1707497293087,
          "name": "Rapid7 InsightIDR write update case results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_update_case",
          "programmatic_name": "rapid7_insight_idr_update_case_rapid7_insight_idr_update_case_all_rapid7_insightidr_write_update_case_results_to_a_note",
          "script_text": "# Map Rapid7 InsightIDR disposition values to the text values that appear in the SOAR UI.\nDISPOSITION_MAPPING = {\n  \"MALICIOUS\" : \"Malicious\",\n  \"BENIGN\": \"Benign\",\n  \"UNKNOWN\": \"Unknown\",\n  \"NOT_APPLICABLE\" : \"Not Applicable\",\n  \"UNDECIDED\": \"Undecided\"\n}\n\n# Map Rapid7 InsightIDR disposition values to SOAR resolution id values\nMAPPING_DISPOSITON_ON_CLOSE = {\n  \"Benign\": \"Resolved\",\n  \"Malicious\": \"Resolved\",\n  \"Unknown\": \"Resolved\",\n  \"Not Applicable\": \"Not an Issue\"\n}\n\nresults = playbook.functions.results.rapid7_insight_idr_update_case_results\n\nif not results.success:\n    incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Update Case Manual:\u003c/b\u003e Unable to get case data to update custom fields.\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        r7_case = content.get(\"rapid7_insight_idr_investigation\")\n        incident.properties.rapid7_insight_idr_disposition = DISPOSITION_MAPPING.get(r7_case.get(\"disposition\"))\n        incident.properties.rapid7_insight_idr_responsibility = r7_case.get(\"responsibility\")\n        incident.properties.rapid7_insight_idr_source = r7_case.get(\"source\").capitalize()\n        incident.properties.rapid7_insight_idr_status = r7_case.get(\"status\").capitalize()\n        assignee = r7_case.get(\"assignee\", None)\n        if assignee:\n            incident.properties.rapid7_insight_idr_assignee = assignee.get(\"name\")\n            incident.properties.rapid7_insight_idr_assignee_email = assignee.get(\"email\")\n        entity_url = r7_case.get(\"entity_url\", None)\n        if entity_url:\n            incident.properties.rapid7_insight_idr_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027{0}\u0027\u003eInvestigation\u003c/a\u003e\".format(entity_url)\n        \n        incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Update Case Manual:\u003c/b\u003e update of custom fields complete.\")\n        \n        if incident.properties.rapid7_insight_idr_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_DISPOSITON_ON_CLOSE.get(incident.properties.rapid7_insight_idr_disposition)\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n      \n    else: \n        incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Update Case Manual:\u003c/b\u003e update of custom fields did NOT complete.\")",
          "tags": [],
          "uuid": "3540007f-80db-4ecd-ba17-2f5785f11ac1"
        },
        {
          "actions": [],
          "created_date": 1706290023210,
          "description": "Write the results from get comments function to a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: write comment results to a note",
          "id": 44,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1706710850794,
          "name": "Rapid7 InsightIDR: write comment results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_update_case",
          "programmatic_name": "rapid7_insight_idr_update_case_rapid7_insight_idr_update_case_all_rapid7_insightidr_write_comment_results_to_a_note",
          "script_text": "results = playbook.functions.results.get_comments_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\", {})\n  if content:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e playbook created {0} notes in SOAR\".format(content.get(\"count\"))\n  else:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e function failed to get notes from Rapid7 InsightIDR\"\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e function failed to get notes from Rapid7 InsightIDR\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "d8c8e080-b653-4fc1-a247-adc2e23e2969"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "rapid7_insight_idr_update_case",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_dbb84c2e-9690-4cda-96ac-0a9903f2acbf",
        "id": 30,
        "name": "playbook_dbb84c2e-9690-4cda-96ac-0a9903f2acbf",
        "type": "playbook",
        "uuid": "8849e99f-0ec7-4d96-ba53-7bd663fff2b6"
      },
      "tags": [],
      "type": "default",
      "uuid": "dbb84c2e-9690-4cda-96ac-0a9903f2acbf",
      "version": 14
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.rapid7_insight_idr_rrn",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": null,
              "method": "object_added",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 11,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_6fa07e01_308f_4393_afac_5bccb24c522c\" isExecutable=\"true\" name=\"playbook_6fa07e01_308f_4393_afac_5bccb24c522c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1g7ga3g\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1ighdfb\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Rapid7 InsightIDR write update case results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"8da8965c-3f2d-43d9-9f72-5668fe1da2cf\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1v28gtn\u003c/incoming\u003e\u003coutgoing\u003eFlow_0omq6e9\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0omq6e9\" sourceRef=\"ScriptTask_2\" targetRef=\"ServiceTask_6\"/\u003e\u003csequenceFlow id=\"Flow_1g7ga3g\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_3\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"Rapid7 InsightIDR: Get Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"4cf150e9-653e-4ed7-b3d5-3d36e28db937\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"rapid7_insight_idr_update_case_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1g7ga3g\u003c/incoming\u003e\u003coutgoing\u003eFlow_1v28gtn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1v28gtn\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"Rapid7 InsightIDR: Get Alerts\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"1a98c2fc-279a-4b9d-a314-1527777cfaa3\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_alerts_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0b7a73k\u003c/incoming\u003e\u003coutgoing\u003eFlow_04l564j\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_04l564j\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_5\"/\u003e\u003cscriptTask id=\"ScriptTask_5\" name=\"Rapid7 InsightIDR Get Alerts\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"5e7960af-aa6d-4848-8ecb-e62f2bf0ed80\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_04l564j\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ighdfb\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1ighdfb\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_1\"/\u003e\u003cserviceTask id=\"ServiceTask_6\" name=\"Rapid7 InsightIDR: Get Comments from Rapid7 Investigation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"63beafd5-52ae-4693-a8b6-9d556a4a4637\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.rapid7_insight_idr_incident_id = incident.id\\ninputs.rapid7_insight_idr_rrn = incident.properties.rapid7_insight_idr_rrn\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"get_comments_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0omq6e9\u003c/incoming\u003e\u003coutgoing\u003eFlow_13kci7a\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_13kci7a\" sourceRef=\"ServiceTask_6\" targetRef=\"ScriptTask_7\"/\u003e\u003cscriptTask id=\"ScriptTask_7\" name=\"Rapid7 InsightIDR: write comment results to a note\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"e5a244cb-e3a5-4264-984b-5ac1653bdb3d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_13kci7a\u003c/incoming\u003e\u003coutgoing\u003eFlow_0b7a73k\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0b7a73k\" sourceRef=\"ScriptTask_7\" targetRef=\"ServiceTask_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_6fa07e01_308f_4393_afac_5bccb24c522c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0b7a73k\" id=\"Flow_0b7a73k_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"571.7856410256411\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"595\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"595\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"618\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_13kci7a\" id=\"Flow_13kci7a_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"488\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ighdfb\" id=\"Flow_1ighdfb_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"822\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"844\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_04l564j\" id=\"Flow_04l564j_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"702\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"738\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1v28gtn\" id=\"Flow_1v28gtn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"222\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1g7ga3g\" id=\"Flow_1g7ga3g_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"138\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0omq6e9\" id=\"Flow_0omq6e9_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"138\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"618\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"738\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_6\" id=\"ServiceTask_6_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_7\" id=\"ScriptTask_7_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.468717948718\" y=\"487.78564102564104\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1705074853985,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_6fa07e01_308f_4393_afac_5bccb24c522c",
      "description": {
        "content": "Automatic playbook to update a newly created Rapid7 InsightIDR case.",
        "format": "text"
      },
      "display_name": "Rapid7 InsightIDR: Update Created Rapid7 InsightIDR Case",
      "export_key": "rapid7_insight_idr_update_created_case",
      "field_type_handle": "playbook_6fa07e01_308f_4393_afac_5bccb24c522c",
      "fields_type": {
        "actions": [],
        "display_name": "Rapid7 InsightIDR: Update Created Rapid7 InsightIDR Case",
        "export_key": "playbook_6fa07e01_308f_4393_afac_5bccb24c522c",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_6fa07e01_308f_4393_afac_5bccb24c522c",
        "uuid": "b8889e74-e8c1-4e42-83ac-200b33db1596"
      },
      "has_logical_errors": false,
      "id": 11,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1708089149565,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1705074854056,
          "description": "Get alert from the investigation and update the Alerts data table",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR Get Alerts",
          "id": 15,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1708004203277,
          "name": "Rapid7 InsightIDR Get Alerts",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_update_created_case",
          "programmatic_name": "rapid7_insight_idr_update_created_case_rapid7_insightidr_get_alerts",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.get_alerts_results\n\nif results.get(\"success\", False):\n  content = results.get(\"content\", {})\n  if content:\n    alert_list = content.get(\"alert_list\", [])\n    if alert_list:\n      for alert in alert_list:\n        alert_row = incident.addRow(\"rapid7_insight_idr_alerts_dt\")\n        alert_row.r7_query_date = datetime.now()\n        alert_row.r7_alert_id = alert.get(\"id\", None)\n        alert_row.r7_alert_source = alert.get(\"alert_source\", None)\n        alert_row.r7_alert_type = alert.get(\"alert_type\", None)\n        alert_row.r7_created_time = alert.get(\"created_time\")\n        detection_rule_rrn = alert.get(\"detection_rule_rrn\", None)\n        if detection_rule_rrn:\n          alert_row.r7_detection_rrn = detection_rule_rrn.get(\"rule_rrn\", None)\n          alert_row.r7_detection_rule = detection_rule_rrn.get(\"rule_name\", None)\n      note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e Added {0} alerts to the Alerts data table\".format(len(alert_list))\n    else:\n     note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e No alerts found.\"     \n  else:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e No alerts found (no content).\"\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR Get Alerts:\u003c/b\u003e Failed function to get alerts. Reason = {0}\".format(results.get(\"reason\", None))\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "5e7960af-aa6d-4848-8ecb-e62f2bf0ed80"
        },
        {
          "actions": [],
          "created_date": 1705074854075,
          "description": "Write the results of updating a Rapid7 InsightIDR case to a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR write update case results to a note",
          "id": 16,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1708089128279,
          "name": "Rapid7 InsightIDR write update case results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_update_created_case",
          "programmatic_name": "rapid7_insight_idr_update_created_case_rapid7_insightidr_update_created_case_rapid7_insightidr_write_update_case_results_to_a_note",
          "script_text": "DISPOSITION_MAPPING = {\n  \"MALICIOUS\" : \"Malicious\",\n  \"BENIGN\": \"Benign\",\n  \"UNKNOWN\": \"Unknown\",\n  \"NOT_APPLICABLE\" : \"Not Applicable\",\n  \"UNDECIDED\": \"Undecided\"\n}\n\n# Map Rapid7 InsightIDR disposition values to SOAR resolution id values\nMAPPING_DISPOSITON_ON_CLOSE = {\n  \"Benign\": \"Resolved\",\n  \"Malicious\": \"Resolved\",\n  \"Unknown\": \"Resolved\",\n  \"Not Applicable\": \"Not an Issue\"\n}\n\nresults = playbook.functions.results.rapid7_insight_idr_update_case_results\n\nif not results.success:\n    incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Update Case Automatic:\u003c/b\u003e Unable to get case data to update custom fields.\")\nelse:\n    content = results.get(\"content\", {})\n    if content:\n        r7_case = content.get(\"rapid7_insight_idr_investigation\")\n        incident.properties.rapid7_insight_idr_disposition = DISPOSITION_MAPPING.get(r7_case.get(\"disposition\"))\n        incident.properties.rapid7_insight_idr_responsibility = r7_case.get(\"responsibility\")\n        incident.properties.rapid7_insight_idr_source = r7_case.get(\"source\").capitalize()\n        incident.properties.rapid7_insight_idr_status = r7_case.get(\"status\").capitalize()\n        assignee = r7_case.get(\"assignee\", None)\n        if assignee:\n            incident.properties.rapid7_insight_idr_assignee = assignee.get(\"name\")\n            incident.properties.rapid7_insight_idr_assignee_email = assignee.get(\"email\")\n            \n        entity_url = r7_case.get(\"entity_url\", None)\n        if entity_url:\n            incident.properties.rapid7_insight_idr_link = \"\u003ca target=\u0027_blank\u0027 href=\u0027{0}\u0027\u003eInvestigation\u003c/a\u003e\".format(entity_url)\n            \n        if incident.properties.rapid7_insight_idr_status.lower() == \"closed\":\n            incident.plan_status = \"C\"\n            incident.resolution_id = MAPPING_DISPOSITON_ON_CLOSE.get(incident.properties.rapid7_insight_idr_disposition)\n            incident.resolution_summary = \"Case {0} Closed in SOAR\".format(incident.id)\n            \n        incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Update Case Automatic:\u003c/b\u003e update of custom fields complete.\")\n    else: \n        incident.addNote(\"\u003cb\u003eRapid7 InsightIDR: Update Case Automatic:\u003c/b\u003e update of custom fields did NOT complete.\")",
          "tags": [],
          "uuid": "8da8965c-3f2d-43d9-9f72-5668fe1da2cf"
        },
        {
          "actions": [],
          "created_date": 1705074854097,
          "description": "Write the results from get comments function to a note.",
          "enabled": false,
          "export_key": "Rapid7 InsightIDR: write comment results to a note",
          "id": 17,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1705074854097,
          "name": "Rapid7 InsightIDR: write comment results to a note",
          "object_type": "incident",
          "playbook_handle": "rapid7_insight_idr_update_created_case",
          "programmatic_name": "rapid7_insight_idr_update_created_case_rapid7_insightidr_write_comment_results_to_a_note",
          "script_text": "results = playbook.functions.results.get_comments_results\n\nif results.get(\"success\"):\n  content = results.get(\"content\")\n  if content:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e playbook created {0} notes in SOAR\".format(content.get(\"count\"))\n  else:\n    note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e function failed to get notes from Rapid7 InsightIDR\"\nelse:\n  note_text = \"\u003cb\u003eRapid7 InsightIDR: Get Comments\u003c/b\u003e function failed to get notes from Rapid7 InsightIDR\"\n  \nincident.addNote(note_text)",
          "tags": [],
          "uuid": "e5a244cb-e3a5-4264-984b-5ac1653bdb3d"
        }
      ],
      "name": "rapid7_insight_idr_update_created_case",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "playbook_6fa07e01-308f-4393-afac-5bccb24c522c",
        "id": 12,
        "name": "playbook_6fa07e01-308f-4393-afac-5bccb24c522c",
        "type": "playbook",
        "uuid": "2eae73fb-490e-4ab9-a83e-3bd8854b7239"
      },
      "tags": [],
      "type": "default",
      "uuid": "6fa07e01-308f-4393-afac-5bccb24c522c",
      "version": 14
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 8803,
    "major": 49,
    "minor": 0,
    "version": "49.0.0"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "Rapid7 InsightIDR Alerts",
      "export_key": "rapid7_insight_idr_alerts_dt",
      "fields": {
        "r7_alert_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_alert_id",
          "hide_notification": false,
          "id": 307,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "r7_alert_id",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "ID",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "78bd188c-77f7-488a-9ed8-fa1a839a8db1",
          "values": [],
          "width": 83
        },
        "r7_alert_source": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_alert_source",
          "hide_notification": false,
          "id": 308,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "r7_alert_source",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Source",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "0a429dd2-9f3e-4b26-9775-06085a2ea9b0",
          "values": [],
          "width": 83
        },
        "r7_alert_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_alert_type",
          "hide_notification": false,
          "id": 309,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "r7_alert_type",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Type",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "aa2acb30-b97e-460a-979f-9ad3826328e8",
          "values": [],
          "width": 83
        },
        "r7_created_time": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_created_time",
          "hide_notification": false,
          "id": 366,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "r7_created_time",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Created",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "cff4a9f9-5958-4d05-903b-0605cb4dd2fd",
          "values": [],
          "width": 60
        },
        "r7_detection_rrn": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_detection_rrn",
          "hide_notification": false,
          "id": 311,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "r7_detection_rrn",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Detection RRN",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "a3b09424-d783-4710-b847-83b5507beb01",
          "values": [],
          "width": 74
        },
        "r7_detection_rule": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_detection_rule",
          "hide_notification": false,
          "id": 312,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "r7_detection_rule",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Detection Rule",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "27cc9f6b-cacb-4c24-b332-74b579dd45a5",
          "values": [],
          "width": 74
        },
        "r7_evidence": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_evidence",
          "hide_notification": false,
          "id": 365,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "r7_evidence",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Evidence",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "3a926fa7-bf51-421f-b448-d2a0ec358648",
          "values": [],
          "width": 69
        },
        "r7_query_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "rapid7_insight_idr_alerts_dt/r7_query_date",
          "hide_notification": false,
          "id": 315,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "r7_query_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Query Date",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "8ca05e92-4970-49d4-ae9a-8fb0f028a15e",
          "values": [],
          "width": 96
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "rapid7_insight_idr_alerts_dt",
      "uuid": "2e69aa7a-768d-47e6-9baf-328c7e24b5e0"
    }
  ],
  "workflows": [],
  "workspaces": []
}
