<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.0.2.575
-->

# Playbook - McAfee ePO Remove Permission Set from User (PB)

### API Name
`mcafee_epo_remove_permission_set_from_user`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| ePO Username | `epo_username` | text | User name of an ePO user | Always |

### Object Type
`mcafee_epo_permission_sets`

### Description
None


---
## Function - McAfee ePO Remove Permission sets from user

### API Name
`mcafee_epo_remove_permission_sets_from_user`

### Output Name
`remove_perms`

### Message Destination
`mcafee_epo_message_destination`

### Function-Input Script
```python
inputs.mcafee_epo_permsetname = row.permission_set_name
if getattr(playbook.inputs, "epo_username", None):
  inputs.mcafee_epo_username = getattr(playbook.inputs, "epo_username")
```

---

## Local script - mcafee epo post process

### Description


### Script Type
`Local script`

### Object Type
`mcafee_epo_permission_sets`

### Script Content
```python
results = playbook.functions.results.remove_perms
if results.get('success'):
  incident.addNote("Permissions set: {} was removed from user: {}".format(row.permission_set_name, getattr(playbook.inputs, "epo_username")))
  if row.users:
    usersList = list(row.users.split(", "))
    usersList.remove(getattr(playbook.inputs, "epo_username"))
    row.users = str(usersList).replace("[","").replace("]","").replace("'","")
```

---

