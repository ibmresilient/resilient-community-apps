<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# McAfee ePO apply a tag

## Function - McAfee tag an ePO asset

### API Name
`mcafee_tag_an_epo_asset`

### Output Name
`None`

### Message Destination
`mcafee_epo_message_destination`

### Pre-Processing Script
```python
inputs.mcafee_epo_systems = rule.properties.epo_system
inputs.mcafee_epo_tag = row['epo_tag']
```

### Post-Processing Script
```python
"""
{'version': '1.0', 'success': True, 'reason': None, 'content': 0, 'raw': '0', 'inputs': {'mcafee_epo_systems': 'xxx', 'mcafee_epo_tag': 'Shut Down'}, 'metrics': {'version': '1.0', 'package': 'fn-mcafee-epo', 'package_version': '1.0.2', 'host': 'Marks-MacBook-Pro.local', 'execution_time_ms': 362, 'timestamp': '2020-10-04 16:29:43'}, 'Systems': 'xxx', 'Tag': 'Shut Down'}
"""

if results.content:
  note = u"ePO tags: {} applied to system: {}".format(results.inputs['mcafee_epo_tag'], results.inputs['mcafee_epo_systems'])
else:
  note = u"ePO system: {} either not found or tag already applied for tags: {}".format(results.inputs['mcafee_epo_systems'], results.inputs['mcafee_epo_tag'])
  
incident.addNote(note)
```

---

