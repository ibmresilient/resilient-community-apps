<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# McAfee TIE Get Current Reputation

## Function - McAfee TIE search hash

### API Name
`mcafee_tie_search_hash`

### Output Name
`None`

### Message Destination
`mcafee_tie_md`

### Pre-Processing Script
```python
lookup_type = {
    "Malware MD5 Hash": "md5",
    "Malware SHA-1 Hash": "sha1",
    "Malware SHA-256 Hash": "sha256"
}

inputs.mcafee_tie_hash = row['hash']
inputs.mcafee_tie_hash_type = lookup_type.get(row['hash_type'], 'sha1')
```

### Post-Processing Script
```python
from datetime import datetime

if results.get('Enterprise'):
    row['results_date'] = datetime.now().strftime('%d/%m/%y %H:%M:%S')
    row['ent_trust_level'] = results['Enterprise'].get('Trust Level')
    row['gti_trust_level'] = results['GTI'].get('Trust Level')
    row['atd_trust_level'] = results['ATD'].get('Trust Level')
    row['mwg_trust_level'] = results['MWG'].get('Trust Level')

"""
{
  'Enterprise': {
    'File Provider': 'Enterprise',
    'Create Date': '2020-12-22 10:47:38',
    'Trust Level': 'Known Malicious',
    'Attributes': {
      'Prevalence': '2',
      'Enterprise Size': '6',
      'First Contact': '2020-12-22 10:47:38',
      'File Name Count': '3',
      'Is Prevalent': '0'
    }
  },
  'GTI': {
    'File Provider': 'GTI',
    'Create Date': '2020-12-22 10:48:25',
    'Trust Level': 'Known Malicious',
    'Attributes': {
      
    }
  },
  'ATD': {
    
  },
  'MWG': {
    
  },
  'system_list': [
    {
      'agentGuid': '{c0ffbb8b-424f-4c7a-94ca-976d2fa13104}',
      'date': 1608652232992
    },
    {
      'agentGuid': '716dd9a1332dbfe8a9a9332f1561d24ee1260aac',
      'date': 1610624110510
    }
  ]
}
"""
```

---

