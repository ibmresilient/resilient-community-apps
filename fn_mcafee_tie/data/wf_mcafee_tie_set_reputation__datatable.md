<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# McAfee TIE Set File Reputation - Datatable

## Function - McAfee TIE: Set File Reputation

### API Name
`mcafee_tie_set_file_reputation`

### Output Name
``

### Message Destination
`mcafee_tie_md`

### Pre-Processing Script
```python
inputs.mcafee_tie_trust_level = str(rule.properties.mcafee_tie_trust_level)
if rule.properties.mcafee_tie_filename:
  inputs.mcafee_tie_filename = rule.properties.mcafee_tie_filename or None
inputs.mcafee_tie_comment = rule.properties.mcafee_tie_comment.content or None
inputs.mcafee_tie_hash_type = row.hash_type
inputs.mcafee_tie_hash = row.hash
# if collecting the reputation type from a rule, uncomment the following line
#inputs.mcafee_tie_reputation_type = str(rule.properties.mcafee_tie_reputation_type)
inputs.mcafee_tie_reputation_type = "Enterprise"
```

### Post-Processing Script
```python
from datetime import datetime

note = "McAfee TIE File Reputation: {}\nReputation Type: {}\nHash: {} ({})\nFile Name: {}\nComment: {}"\
  .format(results.get("inputs", {}).get('mcafee_tie_trust_level'),
          results.get("inputs", {}).get('mcafee_tie_reputation_type'),
          results.get("inputs", {}).get('mcafee_tie_hash'),
          results.get("inputs", {}).get("mcafee_tie_hash_type"),
          results.get("inputs", {}).get('mcafee_tie_filename'),
          results.get("inputs", {}).get('mcafee_tie_comment'))

if results.content:
  incident.addNote("Set reputation successful\n{}".format(note))
else:
  incident.addNote("Set reputation unsuccessful. An internal McAfee TIE error occurred.\n{}".format(note))

## update the row
if results.content and results.content.get('newReputations'):
  row['results_date'] = datetime.now().strftime('%d/%m/%y %H:%M:%S')
  row['ent_trust_level'] = results.inputs['mcafee_tie_trust_level.name']
```

---

