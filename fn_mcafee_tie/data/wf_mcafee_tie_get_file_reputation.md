<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# McAfee TIE Get File Reputation

## Function - McAfee TIE search hash

### API Name
`mcafee_tie_search_hash`

### Output Name
`None`

### Message Destination
`mcafee_tie_md`

### Pre-Processing Script
```python
inputs.mcafee_tie_hash = artifact.value
inputs.mcafee_tie_hash_type = artifact.type
```

### Post-Processing Script
```python
from datetime import datetime

if results.get("Enterprise"):
    row = incident.addRow("tie_results")
    row['results_date'] = datetime.now().strftime('%d/%m/%y %H:%M:%S')
    row["hash_type"] = artifact.type
    row["hash"] = artifact.value
    row["ent_trust_level"] = results["Enterprise"].get("Trust Level")
    row["tie_create_date"] = results["Enterprise"].get("Create Date")
    row["gti_trust_level"] = results["GTI"].get("Trust Level")
    row["atd_trust_level"] = results["ATD"].get("Trust Level")
    row["mwg_trust_level"] = results["MWG"].get("Trust Level")

"""
Data returned will be in the following structure


{  
   "GTI":{  
      "File Provider":"GTI",
      "Attributes":{  

      },
      "Create Date":"2018-02-21 12:17:10",
      "Trust Level":"Known Malicious"
   },
   "ATD":{  
      "File Provider":"ATD",
      "Create Date":"2018-03-14 11:53:09",
      "Trust Level":"Most Likely Malicious"
   },
   "MWG":{  
      "File Provider":"MWG",
      "Create Date":"2018-03-14 11:53:55",
      "Trust Level":"Most Likely Malicious"
   },
   "Enterprise":{  
      "File Provider":"Enterprise",
      "Attributes":{  
         "Average Local Rep":"Most Likely Malicious",
         "First Contact":"2018-02-21 12:17:10",
         "Min Local Rep":"Most Likely Malicious",
         "Is Prevalent":"0",
         "File Name Count":"1",
         "Max Local Rep":"Most Likely Malicious"
      },
      "Create Date":"2018-02-21 12:17:10",
      "Trust Level":"Most Likely Malicious"
   }
   "system_list":[{
     "date": 1519233563,
     "agentGuid": {a00728ff-3187-46c1-97d2-8e0f26ea940b}
   }]
}
"""
```

---

