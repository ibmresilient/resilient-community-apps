<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Example: Twilio Send SMS

## Function - Twilio: Send SMS

### API Name
`twilio_send_sms`

### Output Name
``

### Message Destination
`fn_twilio`

### Pre-Processing Script
```python
inputs.twilio_sms_destination = rule.properties.twilio_sms_destination
if rule.properties.twilio_sms_message:
  inputs.twilio_sms_message = rule.properties.twilio_sms_message
else:
  inputs.twilio_sms_message = f'An incident {incident.name} ({incident.id}) with {incident.severity_code} priority may require your attention'

```

### Post-Processing Script
```python
from datetime import datetime

for entry in results["twilio_status"]:
  if entry.get("success"):
    note_text = """<b>Twilio SMS Message:</b> {0}
              </br><b>sent to:</b> {1}""".format(results.inputs.get("twilio_sms_message"),
                                            entry.get("phone_number"))
                                          
    incident.addNote(helper.createRichText(note_text))
  else: 
    note_text = """<b>Unable to send Twilio SMS Message:</b> {0}
              </br><b> to:</b> {1} ({2})""".format(results.inputs.get("twilio_sms_message"),
                                            entry.get("phone_number"), entry.get("error_message"))
                                          
    incident.addNote(helper.createRichText(note_text))
    
  row = incident.addRow("twilio_sms_log")
  row['row_created'] = datetime.now().strftime('%d/%m/%y %H:%M:%S')
  row['status'] = entry.get("status") or "Failed"
  row['message_id'] = entry.get("messaging_service_sid")
  row['date_created'] = entry.get("date_created_ts")
  row['msg_body'] = entry.get("message_body") or entry.get("error_message")
  row['phone_number'] = entry.get("phone_number")
  row["direction"] = entry.get("direction")
  
```

---

