<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example: URLhaus Lookup

## Function - URLhaus Lookup

### API Name
`fn_urlhaus`

### Output Name
`None`

### Message Destination
`fn_urlhaus`

### Pre-Processing Script
```python
inputs.urlhaus_artifact_type = artifact.type
inputs.urlhaus_artifact_value = artifact.value
```

### Post-Processing Script
```python

def format_link(item):
  if item and ("https://" in item or "http://" in item):
    return "<a target='blank' href='{0}'>{0}</a>".format(item)
  else:
    return item

def expand_list(list_value, separator="<br>"):
  if not isinstance(list_value, list):
    return format_link(list_value)
  else:
    try:
      items = []
      for item in list_value:
        if isinstance(item, dict):
          items.append("<div style='padding:10px'>{}</div>".format(walk_dict(item)))
        else:
          items.append(format_link(item))
      return separator.join(items)
    except:
        pass

def walk_dict(sub_dict):
  notes = []
  for key, value in sub_dict.items():
    if key not in ['display_content']:
      if isinstance(value, dict):
        notes.append(u"<b>{}</b>: <div style='padding:10px'>{}</div>".format(key, walk_dict(value)))
      else:
        notes.append(u"<b>{}</b>: {}".format(key, expand_list(value)))
  return u"<br>".join(notes)

note = u"<b>URLhaus look up for artifact:</b> {}<br><br>".format(artifact.value)

if results["success"]:
  note = note + walk_dict(results["content"])
else:
  note = note + u"This Artifact has no accessible registry information"
  
incident.addNote(helper.createRichText(note))
```

---

