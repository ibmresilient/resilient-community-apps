<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.0.4423
-->

# Playbook - Example: Post Incident / Task Attachment to Slack (PB)

### API Name
`example_post_incident__task_attachment_to_slack_pb`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`attachment`

### Description
Upload Incident or Task Attachment to your Slack channel with an optional custom text message.


---
## Function - Post attachment to Slack

### API Name
`slack_post_attachment`

### Output Name
`slack_info`

### Message Destination
`slack`

### Function-Input Script
```python
#####################
# Attachment data   #
#####################

# Required inputs are: the incident id and attachment id
inputs.incident_id = incident.id
inputs.attachment_id = attachment.id

# If this is a "task attachment" then we will additionally have a task-id
if task is not None:
  inputs.task_id = task.id

# Slack channel name
# Name of the existing Slack Workspace channel or a new Slack channel you are posting to. 
# Channel names can only contain lowercase letters, numbers, hyphens, and underscores, and must be 21 characters or less. 
# If you leave this field empty, function will try to use the slack_channel associated with the Incident or Task found in the Slack Conversations datatable. 
# If there isnâ€™t one defined, the workflow will terminate.
inputs.slack_channel = playbook.inputs.rule_slack_channel if playbook.inputs.rule_slack_channel is not None else playbook.inputs.rule_slack_channel

# Is channel private
# Indicate if the channel you are posting to should be private.
inputs.slack_is_channel_private = playbook.inputs.rule_slack_is_channel_private if playbook.inputs.rule_slack_is_channel_private is not None else playbook.inputs.rule_slack_is_channel_private

# Slack user emails
# Comma separated list of emails belonging to Slack users in your workspace that will be added to your channel.
inputs.slack_participant_emails = playbook.inputs.rule_slack_participant_emails if playbook.inputs.rule_slack_participant_emails is not None else playbook.inputs.rule_slack_participant_emails

# Slack additional text message
# Additional text message to include with the Incident, Note, Artifact, Attachment or Task data.
inputs.slack_text = playbook.inputs.rule_slack_text if playbook.inputs.rule_slack_text is not None else ''

# Slack Channel ID, faster than finding via channel name
inputs.slack_channel_id = playbook.inputs.slack_channel_id if playbook.inputs.slack_channel_id else playbook.inputs.slack_channel_id

```

---

## Local script - Post attachment to Slack Post-Process Script

### Description


### Script Type
`Local script`

### Objet Type
`attachment`

### Script Content
```python
userinfo = str(playbook.functions.results.slack_info.user_info)
userinfo = userinfo.replace("'", "").replace("[","").replace("]","")
# Create a note
noteText = u"""Attachment was posted to <a href='{}'>Slack channel #{}</a>. Members of this channel are: \n{}""".format(playbook.functions.results.url, playbook.functions.results.channel, userinfo)
if not task:
  incident.addNote(helper.createRichText(noteText))
else:
  task.addNote(helper.createRichText(noteText))
```

---
