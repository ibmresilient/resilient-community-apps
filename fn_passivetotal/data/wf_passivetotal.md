<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# PassiveTotal

## Function - PassiveTotal

### API Name
`fn_passivetotal`

### Output Name
`None`

### Message Destination
`passivetotal`

### Pre-Processing Script
```python
inputs.passivetotal_artifact_type = artifact.type
inputs.passivetotal_artifact_value = artifact.value
```

### Post-Processing Script
```python
# if results.success:

# def _generate_hit(self, artifact_value, tags_hits_list):
#         """
#         Query RiskIQ PassiveTotal API for the given 'net.name' (domain name artifact), 'net.uri' (URL) or 'net.ip'
#         (IP address) and generate a Hit.
#         :param artifact_value
#         :param tags_hits_list
#         """
#         # Passive DNS Results - Hits
#         # We grab the totalRecords number and show the First Seen date to Last Seen date interval
#         pdns_results_response = self._passivetotal_get_response(self.passivetotal_passive_dns_api_url,
#                                                                 artifact_value)
#         pdns_hit_number, pdns_first_seen, pdns_last_seen = None, None, None
#         if pdns_results_response.status_code == 200:
#             pdns_results = pdns_results_response.json()
#             pdns_hit_number = pdns_results.get("totalRecords", None)
#             pdns_first_seen = pdns_results.get("firstSeen", None)
#             pdns_last_seen = pdns_results.get("lastSeen", None)
#             LOG.info(pdns_hit_number)
#             LOG.info(pdns_first_seen)
#             LOG.info(pdns_last_seen)
#         else:
#             LOG.info("No Passive DNS information found for artifact value: {0}".format(artifact_value))
#             LOG.debug(pdns_results_response.text)

#         # URL Classification - suspicious, malicious etc
#         classification_results_response = self._passivetotal_get_response(self.passivetotal_actions_class_api_url,
#                                                                           artifact_value)
#         classification_hit = None
#         if classification_results_response.status_code == 200:
#             classification_results = classification_results_response.json()
#             classification_hit = classification_results.get("classification", None)
#             LOG.info(classification_hit)
#         else:
#             LOG.info("No URL classification found for artifact value: {0}".format(artifact_value))
#             LOG.debug(classification_results_response.text)

#         # Count of subdomains
#         subdomain_results_response = self._passivetotal_get_response(self.passivetotal_enrich_subdom_api_url,
#                                                                     artifact_value)
#         subdomain_hits_number, first_ten_subdomains = None, None
#         if subdomain_results_response.status_code == 200:
#             subdomain_results = subdomain_results_response.json()
#             subdomain_hits = subdomain_results.get("subdomains", None)
#             subdomain_hits_number = len(subdomain_hits) if subdomain_hits else None
#             first_ten_subdomains = ', '.join(subdomain_hits[:10]) if subdomain_hits else None
#             LOG.info(subdomain_hits_number)
#             LOG.info(first_ten_subdomains)
#         else:
#             LOG.info("No subdomain information found for artifact value: {0}".format(artifact_value))
#             LOG.debug(subdomain_results_response.text)

#         # Convert tags hits list to str
#         tags_hits = ", ".join(tags_hits_list) if tags_hits_list else None

#         # Construct url back to to PassiveThreat
#         report_url = self.passivetotal_community_url + artifact_value

#         return Hit(
#             NumberProp(name="Number of Passive DNS Records", value=pdns_hit_number),
#             StringProp(name="First Seen", value=pdns_first_seen),
#             StringProp(name="Last Seen", value=pdns_last_seen),
#             NumberProp(name="Subdomains - All", value=subdomain_hits_number),
#             StringProp(name="Subdomains - First ten Hostnames", value=first_ten_subdomains),
#             StringProp(name="Tags", value=tags_hits),
#             StringProp(name="Classification", value=classification_hit),
#             UriProp(name="Report Link", value=report_url)
#             )
            
#             hit = [
#         {
#           "name": "Number of Passive DNS Records",
#           "type": "number",
#           "value": "{}".format(pdns_hit_number)
#         }, 
#         {
#           "name": "First Seen",
#           "type": "string",
#           "value": "{}".format(pdns_first_seen)
#         }, 
#         {
#           "name": "Last Seen",
#           "type": "string",
#           "value": "{}".format(pdns_last_seen)
#         },
#         {
#           "name": "Subdomains - All",
#           "type": "number",
#           "value": "{}".format(subdomain_hits_number)
#         },
#         {
#           "name": "Subdomains - First ten Hostnames",
#           "type": "string",
#           "value": "{}".format(first_ten_subdomains)
#         },
#         {
#           "name": "Subdomains - First ten Hostnames",
#           "type": "string",
#           "value": "{}".format(first_ten_subdomains)
#         },
#         {
#           "name": "Subdomains - First ten Hostnames",
#           "type": "string",
#           "value": "{}".format(first_ten_subdomains)
#         },
#         {
#           "name": "Subdomains - First ten Hostnames",
#           "type": "string",
#           "value": "{}".format(first_ten_subdomains)
#         }
#         ]
#   artifact.addHit("AbuseIPDB Function hits added", hit)
```

---

