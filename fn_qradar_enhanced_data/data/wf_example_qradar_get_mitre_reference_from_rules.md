<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example: QRadar - Get MITRE Reference From Rules

## Function - QRadar Get Offense MITRE Reference

### API Name
`qradar_get_offense_mitre_reference`

### Output Name
`None`

### Message Destination
`fn_qradar_enhanced_data`

### Pre-Processing Script
```python
inputs.qradar_offense_id = incident.properties.qradar_id
inputs.qradar_label = incident.properties.qradar_destination
inputs.soar_incident_id = incident.id
inputs.soar_table_name = "qradar_rules_and_mitre_tactics_and_techniques"
```

### Post-Processing Script
```python
for item in results.content.get('rules'):
  mapping = item.get('mapping')
  if mapping:
    for tactic in list(mapping):
      techniques = mapping.get(tactic).get('techniques')
      if techniques:
        for technique in list(techniques):
          new_row = incident.addRow('qradar_rules_and_mitre_tactics_and_techniques')
          new_row.rule_id = item.get('id')
          new_row.rule_identifier = item.get('identifier')
          new_row.rule_name = item.get('name')
          new_row.mitre_tactic = tactic
          new_row.mitre_tactic_id = mapping.get(tactic).get('id')
          new_row.tactic_confidence_level = mapping.get(tactic).get('confidence')
          new_row.mitre_technique = technique
          new_row.mitre_technique_id = techniques.get(technique).get('id')
          new_row.technique_confidence_level = techniques.get(technique).get('confidence')
      else:
        new_row = incident.addRow('qradar_rules_and_mitre_tactics_and_techniques')
        new_row.rule_id = item.get('id')
        new_row.rule_identifier = item.get('identifier')
        new_row.rule_name = item.get('name')
        new_row.mitre_tactic = tactic
        new_row.mitre_tactic_id = mapping.get(tactic).get('id')
        new_row.tactic_confidence_level = mapping.get(tactic).get('confidence')
  else:
    new_row = incident.addRow('qradar_rules_and_mitre_tactics_and_techniques')
    new_row.rule_id = item.get('id')
    new_row.rule_identifier = item.get('identifier')
    new_row.rule_name = item.get('name')
```

---

