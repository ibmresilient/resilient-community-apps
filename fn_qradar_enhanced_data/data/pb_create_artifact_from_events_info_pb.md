<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.6.0.1543
-->

# Playbook - Create Artifact from Events info (PB)

### API Name
`create_artifact_from_events_info_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Select to create artifact from events info | `select_to_create_artifact_from_events_info` | multiselect | - | Always |

### Object Type
`qr_offense_top_events`

### Description
Create artifact from the Events info of the selected row


---

## Local script - Create Artifact from Events info PB

### Description


### Script Type
`Local script`

### Object Type
`qr_offense_top_events`

### Script Content
```python
# We create artifacts for those observables according to how they can be mapped to
# SOAR default artifacts. If user has custom artifacts, and wants
# to map them as well, please modify the following mapping dict.
import re

type_mapping = { "Source IP": "IP Address", "Destination IP": "IP Address", "Username": "User Account" }

for artifact_type in playbook.inputs.select_to_create_artifact_from_events_info:
  if artifact_type in type_mapping:
    if artifact_type in ["Source IP", "Destination IP"]:
      value = re.sub("<[^<>]+>", "", row.source_ip.get("content") if artifact_type == "Source IP" else row.destination_ip.get("content"))
    else:
      value = row.username

    incident.addArtifact(type_mapping.get(artifact_type), value, f"QRadar Offense {artifact_type}")
```

---

