<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.6.0.1543
-->

# Playbook - Create Artifacts from Flows Info (PB)

### API Name
`create_artifacts_from_flows_info_pb`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Select to create artifact from flows info | `select_to_create_artifact_from_flows_info` | multiselect | - | Always |

### Object Type
`qr_flows`

### Description
Create artifact from the Flows info of the selected row


---

## Local script - Create Artifact from Flows info PB

### Description


### Script Type
`Local script`

### Object Type
`qr_flows`

### Script Content
```python
# We create artifacts for those observables according to how they can be mapped to
# SOAR default artifacts. If user has custom artifacts, and wants
# to map them as well, please modify the following mapping dict.
import re

type_mapping = {
  "Source IP": "IP Address",
  "Destination IP": "IP Address",
  "Source Port": "Port",
  "Destination Port": "Port"
}

for artifact_type in playbook.inputs.select_to_create_artifact_from_flows_info:
  if artifact_type in type_mapping:
    incident.addArtifact(type_mapping.get(artifact_type),
      re.sub("<[^<>]+>", "", row.source_ip.get("content") if artifact_type in ["Source IP", "Source Port"] else row.destination_ip.get("content")),
      f"QRadar Offense {artifact_type}"
    )
```

---

