<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Google SCC: List Assets

## Function - Google Cloud SCC: List Assets

### API Name
`google_cloud_scc_list_assets`

### Output Name
`None`

### Message Destination
`fn_google_cloud_scc`

### Pre-Processing Script
```python
finding_name = incident.properties.google_scc_name.get("content")

if finding_name:
  inputs.google_scc_filter = rule.properties.google_scc_search_filter.strip() if rule.properties.google_scc_search_filter else None
  inputs.google_scc_field_mask = rule.properties.google_scc_field_mask.strip() if rule.properties.google_scc_field_mask else None
else:
  log.fail("Could not find value for finding_name in Incident")
```

### Post-Processing Script
```python
## This post-processing script is designed to use the
# pre-formatted assets that are returned in `results.content.assets_formatted`. 
# There is, however, another return value `assets_raw` that contains
# more information. Any effort to make the assets displayed in a
# different way should use the assets_raw values.
# NOTE: while the SCC UI will show associated findings
# for an asset, the API exposes no such functionality directly
# when querying assets. In order to acheive a similar result,
# make use of the list_findings function and a well-designed asset filter

pre_msg = "<b>Google SCC List Assets results:</b>"
post_msg = ""
given_filter = results.get("inputs", {}).get("google_scc_filter")
field_mask = results.get("inputs", {}).get("google_scc_field_mask")

# List the filter and field mask at the beginning if they are given
if given_filter:
  pre_msg += "<br><i>Filter: \t\t\t<b>{0}</b></i>".format(given_filter)

if field_mask:
  pre_msg += "<br><i>Field Mask: \t<b>{0}</b></i>".format(field_mask)
  
  # add a note about using field masks if they were given as they are tricky to get right
  post_msg = "<i>Note: When using a Field Mask, <b>only</b> the fields given (and a few other required default fields) will return values, however, other fields may be present as empty values. Be sure to use a properly formatted Field Mask.</i>"

if results.get("success"):
  incident.addNote(pre_msg + "<br><br>" + results.get("content", {}).get("assets_formatted") + "<br><br>" + post_msg)
else:
  incident.addNote(pre_msg + "<br><br>Failed to retreive assets. Reason: {0}<br><br>".format(results.get("reason", "UNKNOWN")) + post_msg)

```

---

