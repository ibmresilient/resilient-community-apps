<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Google SCC: Update Security Mark

## Function - Google Cloud SCC: Update Security Mark

### API Name
`google_cloud_scc_update_security_mark`

### Output Name
`None`

### Message Destination
`fn_google_cloud_scc`

### Pre-Processing Script
```python
finding_name = incident.properties.google_scc_name.get("content")

if finding_name:
  inputs.google_scc_finding_name = finding_name
  inputs.google_scc_update_key = rule.properties.google_scc_security_mark_key
  inputs.google_scc_update_value = rule.properties.google_scc_update_value
else:
  log.fail("Could not find value for finding_name in Incident")
```

### Post-Processing Script
```python
SPAN_FORMATTER = "<span class='label' rel='tooltip' title='{0}'>{1}</span>"

if results.get("success"):
  if results.get("content", {}).get("updated_value"):
    note_text = "Updated security mark <b>{0}</b> to value <b>{1}</b> in SCC"
  else:
    note_text = "Removed security mark <b>{0}</b> in SCC"
  
  update_key = results.get("content").get("updated_key")
  update_value = results.get("content").get("updated_value")
  
  incident.addNote(note_text.format(update_key, update_value))
  
  security_marks = results.get("content").get("updated_marks", {}).get("marks")
  marks_list = [SPAN_FORMATTER.format(mark_key, "{0} : {1}".format(mark_key, security_marks.get(mark_key))) for mark_key in security_marks]
  incident.properties.google_scc_security_marks = " ".join(marks_list)
```

---

