# -*- coding: utf-8 -*-
# (c) Copyright IBM Corp. 2010, 2025. All Rights Reserved.
# pylint: disable=line-too-long

"""Helper for tests"""
from typing import List

import copy

from resilient import SimpleClient

from fn_watsonx_analyst.types.watsonx_responses import WatsonxTextGenerationResponse
from fn_watsonx_analyst.util.rest import RestUrls
from fn_watsonx_analyst.util.ModelTag import AiResponsePurpose
from fn_watsonx_analyst.types.ai_response import AIResponse

from fn_watsonx_analyst.util.state_manager import app_state


def generate_app_state(
    purpose: AiResponsePurpose = AiResponsePurpose.NOTE_CONVERSATION,
    model_id="ibm/granite-3-2b-instruct",
    watsonx_endpoint="",
):
    app_state.get().set_model(model_id)
    app_state.get().purpose = purpose
    app_state.get().opts = {}
    app_state.get().res_client = SimpleClient()
    app_state.get().opts = {
        "fn_watsonx_analyst": {
            "watsonx_api_key": "api_key",
            "watsonx_project_id": "1234-1234-1234",
            "watsonx_endpoint": watsonx_endpoint,
        }
    }


class FakeResponse:
    """
    Helper class to simulate a requests.Response object.
    """

    status_code: int
    data: dict

    def __init__(self, status_code: int, data: dict):
        self.status_code = status_code
        self.data = data

    def __enter__(self):
        return self

    def __exit__(self, exc_type, exc_value, exc_tb):
        pass

    def json(self):
        return self.data


inc_details = {
    "dtm": {},
    "cm": {"unassigneds": [], "total": 0, "geo_counts": {}},
    "regulators": {"ids": [149]},
    "hipaa": {
        "hipaa_adverse": None,
        "hipaa_misused": None,
        "hipaa_acquired": None,
        "hipaa_additional_misuse": None,
        "hipaa_breach": None,
        "hipaa_adverse_comment": "",
        "hipaa_misused_comment": "",
        "hipaa_acquired_comment": "",
        "hipaa_additional_misuse_comment": "",
        "hipaa_breach_comment": "",
    },
    "tasks": None,
    "artifacts": None,
    "name": "asdf",
    "description": None,
    "phase_id": 1027,
    "inc_training": False,
    "vers": 3,
    "addr": None,
    "city": None,
    "creator": {
        "id": 34,
        "fname": "Resilient",
        "lname": "Sysadmin",
        "display_name": "Resilient Sysadmin",
        "status": "A",
        "email": "thomas@example.com",
        "locked": False,
        "password_changed": False,
        "is_external": False,
        "ui_theme": "verydarkmode",
        "is_ldap": False,
        "is_saml": False,
    },
    "creator_principal": {
        "id": 34,
        "type": "user",
        "name": "thomas@example.com",
        "display_name": "Resilient Sysadmin",
    },
    "exposure_type_id": 1,
    "incident_type_ids": [],
    "reporter": None,
    "state": None,
    "country": None,
    "zip": None,
    "workspace": 5,
    "exposure": 0,
    "org_handle": 204,
    "members": [],
    "negative_pr_likely": None,
    "perms": {
        "read": True,
        "write": False,
        "comment": True,
        "assign": False,
        "close": False,
        "change_members": False,
        "attach_file": False,
        "read_attachments": True,
        "delete_attachments": False,
        "create_milestones": False,
        "list_milestones": True,
        "create_artifacts": False,
        "list_artifacts": True,
        "delete": False,
        "change_workspace": False,
    },
    "confirmed": True,
    "task_changes": {"added": [], "removed": []},
    "assessment": '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<assessment>\n    <rollups/>\n    <optional>There are 1 required and 0 optional tasks from 1 regulators.</optional>\n</assessment>\n',
    "data_compromised": None,
    "draft": False,
    "properties": {"internal_customizations_field": None},
    "resolution_id": None,
    "resolution_summary": None,
    "pii": {
        "data_compromised": None,
        "determined_date": 1732115742448,
        "harmstatus_id": 2,
        "data_encrypted": None,
        "data_contained": None,
        "impact_likely": None,
        "ny_impact_likely": None,
        "or_impact_likely": None,
        "wa_impact_likely": None,
        "dc_impact_likely": None,
        "data_source_ids": [],
        "data_format": None,
        "assessment": '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<assessment>\n    <rollups/>\n    <optional>There are 1 required and 0 optional tasks from 1 regulators.</optional>\n</assessment>\n',
        "exposure": 0,
        "gdpr_harm_risk": None,
        "gdpr_lawful_data_processing_categories": [],
        "alberta_health_risk_assessment": None,
        "california_health_risk_assessment": None,
        "new_zealand_risk_assessment": None,
        "singapore_risk_assessment": None,
    },
    "gdpr": {
        "gdpr_breach_circumstances": [],
        "gdpr_breach_type": None,
        "gdpr_personal_data": None,
        "gdpr_identification": None,
        "gdpr_consequences": None,
        "gdpr_final_assessment": None,
        "gdpr_breach_type_comment": None,
        "gdpr_personal_data_comment": None,
        "gdpr_identification_comment": None,
        "gdpr_consequences_comment": None,
        "gdpr_final_assessment_comment": None,
        "gdpr_subsequent_notification": None,
    },
    "regulator_risk": {},
    "score": None,
    "inc_last_modified_date": 1732115801827,
    "comments": None,
    "actions": [],
    "playbooks": [],
    "timer_field_summarized_incident_data": [],
    "admin_id": None,
    "creator_id": 34,
    "crimestatus_id": 5,
    "employee_involved": None,
    "end_date": None,
    "exposure_dept_id": None,
    "exposure_individual_name": None,
    "exposure_vendor_id": None,
    "jurisdiction_name": None,
    "jurisdiction_reg_id": None,
    "start_date": None,
    "inc_start": None,
    "org_id": 204,
    "is_scenario": False,
    "hard_liability": 0,
    "nist_attack_vectors": [],
    "id": 2414,
    "sequence_code": None,
    "discovered_date": 1732115742448,
    "due_date": None,
    "create_date": 1732115748875,
    "owner_id": 34,
    "severity_code": 2055,
    "plan_status": "A",
}


sample_output: WatsonxTextGenerationResponse = {
    "model_id": "ibm/granite-3-2b-instruct",
    "created_at": "2023-07-21T16:52:32.190Z",
    "results": [
        {
            "generated_text": "Lorem ipsum",
            "generated_token_count": 4,
            "input_token_count": 12,
            "stop_reason": "eos_token",
        }
    ],
}

PACKAGE_NAME = "fn_watsonx_analyst"


def mock_get_api_key(_self, _res_client):
    """
    Stub to return a string
    """
    key = ""
    try:
        key = app_state.get().opts["fn_watsonx_analyst"]["watsonx_api_key"]
    finally:
        pass
    if not key:
        return ""
    return key


def mock_do_request(_self, uri, **kwargs):
    """
    Mock function to return sample data instead of SOAR REST API responses
    """
    match uri:
        case RestUrls.GET_NOTE:
            match kwargs.get("note_id", 1):
                case 1:
                    return {
                        "type": "incident",
                        "id": 1,
                        "parent_id": None,
                        "user_id": 34,
                        "user_fname": "Resilient",
                        "user_lname": "Sysadmin",
                        "text": '<div class="soar-rte-content"><p>@watsonx which is better arch or windows</p></div>',
                        "create_date": 1732115801922,
                        "modify_date": 1732115801922,
                        "children": [],
                        "mentioned_users": [],
                        "is_deleted": False,
                        "modify_user": {
                            "id": 34,
                            "first_name": "Resilient",
                            "last_name": "Sysadmin",
                        },
                        "actions": [],
                        "playbooks": [],
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "inc_owner": 34,
                        "user_name": "Resilient Sysadmin",
                        "modify_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "comment_perms": None,
                    }
                case 2:
                    return {
                        "type": "incident",
                        "id": 2,
                        "parent_id": None,
                        "user_id": 34,
                        "user_fname": "Resilient",
                        "user_lname": "Sysadmin",
                        "text": '<div class="soar-rte-content"><p>@watsonx does [runme2.sh] seem like it could be used maliciously?</p></div>',
                        "create_date": 1732115801922,
                        "modify_date": 1732115801922,
                        "children": [],
                        "mentioned_users": [],
                        "is_deleted": False,
                        "modify_user": {
                            "id": 34,
                            "first_name": "Resilient",
                            "last_name": "Sysadmin",
                        },
                        "actions": [],
                        "playbooks": [],
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "inc_owner": 34,
                        "user_name": "Resilient Sysadmin",
                        "modify_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "comment_perms": None,
                    }
                case 3:
                    return {
                        "type": "incident",
                        "id": 3,
                        "parent_id": None,
                        "user_id": 34,
                        "user_fname": "Resilient",
                        "user_lname": "Sysadmin",
                        "text": '<div class="soar-rte-content"><p>@watsonx does [<span><span><span>runme2.sh]</span></span></span> seem like it could be used maliciously?</p></div>',
                        "create_date": 1732115801922,
                        "modify_date": 1732115801922,
                        "children": [],
                        "mentioned_users": [],
                        "is_deleted": False,
                        "modify_user": {
                            "id": 34,
                            "first_name": "Resilient",
                            "last_name": "Sysadmin",
                        },
                        "actions": [],
                        "playbooks": [],
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "inc_owner": 34,
                        "user_name": "Resilient Sysadmin",
                        "modify_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "comment_perms": None,
                    }
                case 4:
                    return {
                        "type": "incident",
                        "id": 4,
                        "parent_id": None,
                        "user_id": 34,
                        "user_fname": "Resilient",
                        "user_lname": "Sysadmin",
                        "text": '<div class="soar-rte-content"><p>@watsonx does [<span><span><span>image.png]</span></span></span> seem like it could be used maliciously?</p></div>',
                        "create_date": 1732115801922,
                        "modify_date": 1732115801922,
                        "children": [],
                        "mentioned_users": [],
                        "is_deleted": False,
                        "modify_user": {
                            "id": 34,
                            "first_name": "Resilient",
                            "last_name": "Sysadmin",
                        },
                        "actions": [],
                        "playbooks": [],
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "inc_owner": 34,
                        "user_name": "Resilient Sysadmin",
                        "modify_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "comment_perms": None,
                    }
                case 5:
                    return {
                        "type": "incident",
                        "id": 5,
                        "parent_id": None,
                        "user_id": 34,
                        "user_fname": "Resilient",
                        "user_lname": "Sysadmin",
                        "text": '<div class="soar-rte-content"><p>@watsonx does [<span><span><span>output.txt]</span></span></span> seem like it could be used maliciously?</p></div>',
                        "create_date": 1732115801922,
                        "modify_date": 1732115801922,
                        "children": [],
                        "mentioned_users": [],
                        "is_deleted": False,
                        "modify_user": {
                            "id": 34,
                            "first_name": "Resilient",
                            "last_name": "Sysadmin",
                        },
                        "actions": [],
                        "playbooks": [],
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "inc_owner": 34,
                        "user_name": "Resilient Sysadmin",
                        "modify_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "comment_perms": None,
                    }

        case RestUrls.GET_INCIDENT_NOTES:
            return [
                {
                    "type": "incident",
                    "id": 3234,
                    "parent_id": None,
                    "user_id": 34,
                    "user_fname": "Resilient",
                    "user_lname": "Sysadmin",
                    "text": '<div class="soar-rte-content"><p>@watsonx which is better arch or windows</p></div>',
                    "create_date": 1732115801922,
                    "modify_date": 1732115801922,
                    "children": [],
                    "mentioned_users": [],
                    "is_deleted": False,
                    "modify_user": {
                        "id": 34,
                        "first_name": "Resilient",
                        "last_name": "Sysadmin",
                    },
                    "actions": [],
                    "playbooks": [],
                    "inc_id": 2414,
                    "inc_name": "asdf",
                    "task_id": None,
                    "task_name": None,
                    "task_custom": None,
                    "task_members": None,
                    "task_at_id": None,
                    "inc_owner": 34,
                    "user_name": "Resilient Sysadmin",
                    "modify_principal": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "comment_perms": None,
                }
            ]

        case RestUrls.INCIDENT_DETAILS:
            return inc_details

        case RestUrls.ARTIFACT_DETAILS:
            match kwargs.get("art_id", None):
                case 1413:
                    return {
                        "id": 24,
                        "type": {"id": 1, "name": "IP Address"},
                        "value": "128.210.157.251",
                        "description": None,
                        "attachment": None,
                        "parent_id": None,
                        "creator": {
                            "id": 5,
                            "fname": "Thomas",
                            "lname": "Galligan",
                            "display_name": "Thomas Galligan",
                            "status": "A",
                            "email": "thomas@co3sys.com",
                            "locked": False,
                            "password_changed": False,
                            "is_external": False,
                            "ui_theme": "verydarkmode",
                            "is_ldap": False,
                            "is_saml": False,
                        },
                        "inc_id": 2099,
                        "inc_name": "Suspected Phising Attack",
                        "inc_owner": {
                            "id": 5,
                            "name": "thomas@co3sys.com",
                            "display_name": "Thomas Galligan",
                            "type": "user",
                        },
                        "hits": [
                            {
                                "id": 19,
                                "value": "128.210.157.251",
                                "threat_source_id": {
                                    "id": 9,
                                    "name": "VirusTotal",
                                    "type": "system",
                                },
                                "artifact_type_id": {"id": 1, "name": "IP Address"},
                                "properties": [
                                    {"type": "string", "name": "total", "value": "97"},
                                    {
                                        "type": "string",
                                        "name": "positives",
                                        "value": "3",
                                    },
                                    {
                                        "type": "string",
                                        "name": "permalink",
                                        "value": "https://www.virustotal.com/ip-address/128.210.157.251/information/",
                                    },
                                    {
                                        "type": "string",
                                        "name": "scanDate",
                                        "value": "2025-04-08 12:05:59",
                                    },
                                ],
                                "active": True,
                                "created": 1744372190847,
                                "threat_source_type": "system",
                            },
                            {
                                "id": 18,
                                "value": "128.210.157.251",
                                "threat_source_id": {
                                    "id": 100,
                                    "name": "IBM X-Force Exchange",
                                    "type": "system",
                                },
                                "artifact_type_id": {"id": 1, "name": "IP Address"},
                                "properties": [
                                    {
                                        "type": "string",
                                        "name": "History 5",
                                        "value": "Score: 7.1; Category: Botnet Command and Control Server: 71%; Reason: One of the five RIRs announced a (new) location mapping of the IP.; Location: United States; Date: 2020-03-28T07:52:00.000Z",
                                    },
                                    {
                                        "type": "string",
                                        "name": "History 4",
                                        "value": "Score: 7.1; Category: Botnet Command and Control Server: 71%; Reason: One of the five RIRs announced a (new) location mapping of the IP.; Location: United States; Date: 2020-03-29T06:52:00.000Z",
                                    },
                                    {
                                        "type": "string",
                                        "name": "History count",
                                        "value": "23",
                                    },
                                    {
                                        "type": "string",
                                        "name": "Categories",
                                        "value": "Dynamic IPs: 71%; Botnet Command and Control Server: 71%",
                                    },
                                    {
                                        "type": "string",
                                        "name": "First seen",
                                        "value": "2020-03-28T07:52:00.000Z",
                                    },
                                    {
                                        "type": "string",
                                        "name": "History 3",
                                        "value": "Score: 7.1; Category: Botnet Command and Control Server: 71%; Reason: One of the five RIRs announced a (new) location mapping of the IP.; Location: United States; Date: 2021-12-26T07:52:00.000Z",
                                    },
                                    {
                                        "type": "string",
                                        "name": "History 2",
                                        "value": "Score: 7.1; Category: Botnet Command and Control Server: 71%; Reason: One of the five RIRs announced a (new) location mapping of the IP.; Location: United States; Date: 2021-12-27T07:52:00.000Z",
                                    },
                                    {
                                        "type": "string",
                                        "name": "History 1",
                                        "value": "Score: 7.1; Category: Dynamic IPs: 71%; Botnet Command and Control Server: 71%; Reason: Based on statistical DNS analysis.; Location: United States; Date: 2023-06-01T22:33:00.000Z",
                                    },
                                    {"type": "string", "name": "Score", "value": "7.1"},
                                    {
                                        "type": "string",
                                        "name": "Reason description",
                                        "value": "Based on statistical DNS analysis.",
                                    },
                                    {
                                        "type": "string",
                                        "name": "Country",
                                        "value": "United States",
                                    },
                                    {
                                        "type": "string",
                                        "name": "Subnet",
                                        "value": "Subnet: 128.210.157.128; Category: Dynamic IPs: 71%; Date: 2023-06-01T22:33:00.000Z",
                                    },
                                    {
                                        "type": "string",
                                        "name": "Last seen",
                                        "value": "2023-06-01T22:33:00.000Z",
                                    },
                                    {
                                        "type": "uri",
                                        "name": "Permalink",
                                        "value": "https://exchange.xforce.ibmcloud.com/ip/128.210.157.251",
                                    },
                                ],
                                "active": True,
                                "created": 1744372190847,
                                "threat_source_type": "system",
                            },
                        ],
                        "created": 1744372183326,
                        "last_modified_time": 1744372183337,
                        "last_modified_by": {
                            "id": 5,
                            "type": "user",
                            "name": "thomas@co3sys.com",
                            "display_name": "Thomas Galligan",
                        },
                        "pending_sources": [],
                        "perms": {"read": True, "write": True, "delete": True},
                        "properties": [
                            {"name": "destination", "value": "False"},
                            {"name": "source", "value": "True"},
                        ],
                        "actions": [],
                        "playbooks": [
                            {
                                "playbook_handle": {
                                    "id": 12,
                                    "name": "fn_watsonx_analyst_scan_artifact",
                                },
                                "display_name": "watsonx.ai Scan Artifact",
                            }
                        ],
                        "hash": "11ef5d88654e4b305dfee26aa23957b5a7b0f74005f9dc7c5d7e7cba74e76c86",
                        "relating": True,
                        "creator_principal": {
                            "id": 5,
                            "type": "user",
                            "name": "thomas@co3sys.com",
                            "display_name": "Thomas Galligan",
                        },
                        "related_incident_count": 0,
                        "pending_scan_result": False,
                        "global_info": {
                            "id": 24,
                            "type": {"id": 1, "name": "IP Address"},
                            "value": "128.210.157.251",
                            "description": None,
                            "creator": {
                                "id": 5,
                                "type": "user",
                                "name": "thomas@co3sys.com",
                                "display_name": "Thomas Galligan",
                            },
                            "created": 1744372183326,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1744372183329,
                            "related_incident_count": 1,
                            "last_related_inc_id": 2099,
                            "last_related_inc_owner_handle": {
                                "id": 5,
                                "name": "thomas@co3sys.com",
                                "display_name": "Thomas Galligan",
                                "type": "user",
                            },
                            "first_related_inc_id": 2099,
                            "first_related_inc_owner_handle": {
                                "id": 5,
                                "name": "thomas@co3sys.com",
                                "display_name": "Thomas Galligan",
                                "type": "user",
                            },
                            "perms": {"write": True},
                            "first_associated_time": 1744372183326,
                            "last_associated_time": 1744372183326,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "on",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        },
                        "ip": {"source": True, "destination": False},
                        "global_artifact": [
                            {
                                "id": 24,
                                "type": {"id": 1, "name": "IP Address"},
                                "value": "128.210.157.251",
                                "description": None,
                                "creator": {
                                    "id": 5,
                                    "type": "user",
                                    "name": "thomas@co3sys.com",
                                    "display_name": "Thomas Galligan",
                                },
                                "created": 1744372183326,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1744372183329,
                                "related_incident_count": 1,
                                "last_related_inc_id": 2099,
                                "last_related_inc_owner_handle": {
                                    "id": 5,
                                    "name": "thomas@co3sys.com",
                                    "display_name": "Thomas Galligan",
                                    "type": "user",
                                },
                                "first_related_inc_id": 2099,
                                "first_related_inc_owner_handle": {
                                    "id": 5,
                                    "name": "thomas@co3sys.com",
                                    "display_name": "Thomas Galligan",
                                    "type": "user",
                                },
                                "perms": {"write": True},
                                "first_associated_time": 1744372183326,
                                "last_associated_time": 1744372183326,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "on",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            }
                        ],
                    }
                case 1412:
                    return {
                        "id": 1412,
                        "type": 16,
                        "value": "image.png",
                        "description": None,
                        "attachment": {
                            "type": "artifact",
                            "id": 111,
                            "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                            "name": "image.png",
                            "content_type": "image/png",
                            "created": 1732119882733,
                            "creator_id": 34,
                            "size": 122,
                            "actions": [],
                            "playbooks": [],
                            "task_id": None,
                            "task_name": None,
                            "task_custom": None,
                            "task_members": None,
                            "task_at_id": None,
                            "reconciliation_status": "matched",
                            "vers": 3,
                            "inc_id": 2414,
                            "inc_name": "asdf",
                            "inc_owner": 34,
                        },
                        "parent_id": None,
                        "creator": {
                            "id": 34,
                            "fname": "Resilient",
                            "lname": "Sysadmin",
                            "display_name": "Resilient Sysadmin",
                            "status": "A",
                            "email": "thomas@example.com",
                            "locked": False,
                            "password_changed": False,
                            "is_external": False,
                            "ui_theme": "verydarkmode",
                            "is_ldap": False,
                            "is_saml": False,
                        },
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                        "hits": [],
                        "created": 1732119882637,
                        "last_modified_time": 1732119882742,
                        "last_modified_by": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "pending_sources": [],
                        "perms": {"read": True, "write": False, "delete": False},
                        "properties": None,
                        "actions": [],
                        "playbooks": [],
                        "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                        "relating": True,
                        "creator_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "related_incident_count": 3,
                        "pending_scan_result": False,
                        "global_info": {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        },
                        "ip": {"source": None, "destination": None},
                        "global_artifact": [
                            {
                                "id": 759,
                                "type": 16,
                                "value": "runme2.sh",
                                "description": None,
                                "creator": {
                                    "id": 34,
                                    "type": "user",
                                    "name": "thomas@example.com",
                                    "display_name": "Resilient Sysadmin",
                                },
                                "created": 1730307123575,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1730307123576,
                                "related_incident_count": 4,
                                "last_related_inc_id": 2414,
                                "last_related_inc_owner_handle": 34,
                                "first_related_inc_id": 2350,
                                "first_related_inc_owner_handle": 34,
                                "perms": {"write": False},
                                "first_associated_time": 1730307123575,
                                "last_associated_time": 1732119882637,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "unsupported",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            }
                        ],
                    }
                case 1411:
                    return {
                        "id": 1411,
                        "type": 16,
                        "value": "runme2.sh",
                        "description": None,
                        "attachment": {
                            "type": "artifact",
                            "id": 110,
                            "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                            "name": "runme2.sh",
                            "content_type": "application/x-shellscript",
                            "created": 1732119882733,
                            "creator_id": 34,
                            "size": 122,
                            "actions": [],
                            "playbooks": [],
                            "task_id": None,
                            "task_name": None,
                            "task_custom": None,
                            "task_members": None,
                            "task_at_id": None,
                            "reconciliation_status": "matched",
                            "vers": 3,
                            "inc_id": 2414,
                            "inc_name": "asdf",
                            "inc_owner": 34,
                        },
                        "parent_id": None,
                        "creator": {
                            "id": 34,
                            "fname": "Resilient",
                            "lname": "Sysadmin",
                            "display_name": "Resilient Sysadmin",
                            "status": "A",
                            "email": "thomas@example.com",
                            "locked": False,
                            "password_changed": False,
                            "is_external": False,
                            "ui_theme": "verydarkmode",
                            "is_ldap": False,
                            "is_saml": False,
                        },
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                        "hits": [],
                        "created": 1732119882637,
                        "last_modified_time": 1732119882742,
                        "last_modified_by": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "pending_sources": [],
                        "perms": {"read": True, "write": False, "delete": False},
                        "properties": None,
                        "actions": [],
                        "playbooks": [],
                        "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                        "relating": True,
                        "creator_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "related_incident_count": 3,
                        "pending_scan_result": False,
                        "global_info": {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        },
                        "ip": {"source": None, "destination": None},
                        "global_artifact": [
                            {
                                "id": 759,
                                "type": 16,
                                "value": "runme2.sh",
                                "description": None,
                                "creator": {
                                    "id": 34,
                                    "type": "user",
                                    "name": "thomas@example.com",
                                    "display_name": "Resilient Sysadmin",
                                },
                                "created": 1730307123575,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1730307123576,
                                "related_incident_count": 4,
                                "last_related_inc_id": 2414,
                                "last_related_inc_owner_handle": 34,
                                "first_related_inc_id": 2350,
                                "first_related_inc_owner_handle": 34,
                                "perms": {"write": False},
                                "first_associated_time": 1730307123575,
                                "last_associated_time": 1732119882637,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "unsupported",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            }
                        ],
                    }

        case (
            RestUrls.ARTIFACT_CONTENTS
            | RestUrls.ATTACHMENT_CONTENTS
            | RestUrls.TASK_ATTACHMENT_CONTENTS
        ):

            if "art_id" in kwargs:
                match kwargs.get("art_id", None):
                    case 1412:
                        return " "
            else:

                match kwargs.get("att_id", None):
                    case 322:
                        return "test 123"

            return "Lorem ipsum"

        case RestUrls.ARTIFACT_BY_NAME:
            match kwargs.get("obj_name", None):
                case "image.png":
                    return [
                        {
                            "id": 1412,
                            "type": 16,
                            "value": "image.png",
                            "description": None,
                            "attachment": {
                                "type": "artifact",
                                "id": 111,
                                "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                                "name": "image.png",
                                "content_type": "image/png",
                                "created": 1732119882733,
                                "creator_id": 34,
                                "size": 122,
                                "actions": [],
                                "playbooks": [],
                                "task_id": None,
                                "task_name": None,
                                "task_custom": None,
                                "task_members": None,
                                "task_at_id": None,
                                "reconciliation_status": "matched",
                                "vers": 3,
                                "inc_id": 2414,
                                "inc_name": "asdf",
                                "inc_owner": 34,
                            },
                            "parent_id": None,
                            "creator": {
                                "id": 34,
                                "fname": "Resilient",
                                "lname": "Sysadmin",
                                "display_name": "Resilient Sysadmin",
                                "status": "A",
                                "email": "thomas@example.com",
                                "locked": False,
                                "password_changed": False,
                                "is_external": False,
                                "ui_theme": "verydarkmode",
                                "is_ldap": False,
                                "is_saml": False,
                            },
                            "inc_id": 2414,
                            "inc_name": "asdf",
                            "inc_owner": 34,
                            "hits": [],
                            "created": 1732119882637,
                            "last_modified_time": 1732119882742,
                            "last_modified_by": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "pending_sources": [],
                            "perms": {"read": True, "write": False, "delete": False},
                            "properties": None,
                            "actions": [],
                            "playbooks": [],
                            "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                            "relating": True,
                            "creator_principal": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "related_incident_count": 3,
                            "pending_scan_result": False,
                            "global_info": {
                                "id": 759,
                                "type": 16,
                                "value": "runme2.sh",
                                "description": None,
                                "creator": {
                                    "id": 34,
                                    "type": "user",
                                    "name": "thomas@example.com",
                                    "display_name": "Resilient Sysadmin",
                                },
                                "created": 1730307123575,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1730307123576,
                                "related_incident_count": 4,
                                "last_related_inc_id": 2414,
                                "last_related_inc_owner_handle": 34,
                                "first_related_inc_id": 2350,
                                "first_related_inc_owner_handle": 34,
                                "perms": {"write": False},
                                "first_associated_time": 1730307123575,
                                "last_associated_time": 1732119882637,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "unsupported",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            },
                            "ip": {"source": None, "destination": None},
                            "global_artifact": [
                                {
                                    "id": 759,
                                    "type": 16,
                                    "value": "runme2.sh",
                                    "description": None,
                                    "creator": {
                                        "id": 34,
                                        "type": "user",
                                        "name": "thomas@example.com",
                                        "display_name": "Resilient Sysadmin",
                                    },
                                    "created": 1730307123575,
                                    "last_modified_by": {
                                        "id": 0,
                                        "type": "system",
                                        "name": "System User",
                                        "display_name": "System User",
                                    },
                                    "last_modified_time": 1730307123576,
                                    "related_incident_count": 4,
                                    "last_related_inc_id": 2414,
                                    "last_related_inc_owner_handle": 34,
                                    "first_related_inc_id": 2350,
                                    "first_related_inc_owner_handle": 34,
                                    "perms": {"write": False},
                                    "first_associated_time": 1730307123575,
                                    "last_associated_time": 1732119882637,
                                    "properties": None,
                                    "tags": [],
                                    "version": 0,
                                    "scan_option": "unsupported",
                                    "relating_incidents": True,
                                    "hit_threat_sources": [],
                                    "relating": True,
                                    "last_scan_hits": [],
                                    "summary": None,
                                }
                            ],
                        }
                    ]
            return [
                {
                    "id": 1411,
                    "type": 16,
                    "value": "runme2.sh",
                    "description": None,
                    "attachment": {
                        "type": "artifact",
                        "id": 110,
                        "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                        "name": "runme2.sh",
                        "content_type": "application/x-shellscript",
                        "created": 1732119882733,
                        "creator_id": 34,
                        "size": 122,
                        "actions": [],
                        "playbooks": [],
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "reconciliation_status": "matched",
                        "vers": 3,
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                    },
                    "parent_id": None,
                    "creator": {
                        "id": 34,
                        "fname": "Resilient",
                        "lname": "Sysadmin",
                        "display_name": "Resilient Sysadmin",
                        "status": "A",
                        "email": "thomas@example.com",
                        "locked": False,
                        "password_changed": False,
                        "is_external": False,
                        "ui_theme": "verydarkmode",
                        "is_ldap": False,
                        "is_saml": False,
                    },
                    "inc_id": 2414,
                    "inc_name": "asdf",
                    "inc_owner": 34,
                    "hits": [],
                    "created": 1732119882637,
                    "last_modified_time": 1732119882742,
                    "last_modified_by": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "pending_sources": [],
                    "perms": {"read": True, "write": False, "delete": False},
                    "properties": None,
                    "actions": [],
                    "playbooks": [],
                    "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                    "relating": True,
                    "creator_principal": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "related_incident_count": 3,
                    "pending_scan_result": False,
                    "global_info": {
                        "id": 759,
                        "type": 16,
                        "value": "runme2.sh",
                        "description": None,
                        "creator": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "created": 1730307123575,
                        "last_modified_by": {
                            "id": 0,
                            "type": "system",
                            "name": "System User",
                            "display_name": "System User",
                        },
                        "last_modified_time": 1730307123576,
                        "related_incident_count": 4,
                        "last_related_inc_id": 2414,
                        "last_related_inc_owner_handle": 34,
                        "first_related_inc_id": 2350,
                        "first_related_inc_owner_handle": 34,
                        "perms": {"write": False},
                        "first_associated_time": 1730307123575,
                        "last_associated_time": 1732119882637,
                        "properties": None,
                        "tags": [],
                        "version": 0,
                        "scan_option": "unsupported",
                        "relating_incidents": True,
                        "hit_threat_sources": [],
                        "relating": True,
                        "last_scan_hits": [],
                        "summary": None,
                    },
                    "ip": {"source": None, "destination": None},
                    "global_artifact": [
                        {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        }
                    ],
                },
            ]

        case RestUrls.TASK_TREE:
            return [
                {
                    "child_cats": [
                        {
                            "child_cats": [],
                            "child_tasks": [
                                {
                                    "name": "Investigate Exposure of Personal Information/Data",
                                    "inc_id": 2414,
                                    "inc_owner_id": 34,
                                    "due_date": None,
                                    "required": True,
                                    "owner_id": None,
                                    "user_notes": None,
                                    "status": "O",
                                    "frozen": False,
                                    "owner_fname": None,
                                    "owner_lname": None,
                                    "init_date": 1732115749383,
                                    "active": True,
                                    "src_name": None,
                                    "inc_name": "asdf",
                                    "instr_text": None,
                                    "instructions": None,
                                    "form": "data_compromised, determined_date",
                                    "members": None,
                                    "perms": {
                                        "read": True,
                                        "write": False,
                                        "comment": True,
                                        "assign": False,
                                        "close": False,
                                        "change_members": False,
                                        "attach_file": False,
                                        "read_attachments": True,
                                        "delete_attachments": False,
                                        "change_header": False,
                                    },
                                    "notes": [],
                                    "closed_date": None,
                                    "actions": [],
                                    "playbooks": [],
                                    "phase_id": 1027,
                                    "category_id": 155,
                                    "notes_count": 0,
                                    "attachments_count": 0,
                                    "task_layout": None,
                                    "auto_deactivate": True,
                                    "creator_principal": {
                                        "id": 34,
                                        "type": "user",
                                        "name": "thomas@example.com",
                                        "display_name": "Resilient Sysadmin",
                                    },
                                    "timeframe_name": None,
                                    "regs": {"88": "Data Breach Best Practices"},
                                    "custom": False,
                                    "id": 1854,
                                    "inc_training": False,
                                    "cat_name": "Respond",
                                    "description": "",
                                    "at_id": None,
                                    "private": None,
                                }
                            ],
                            "name": "Data Breach - Organizational",
                            "parent_id": None,
                            "phase_id": None,
                            "category_id": 155,
                            "id": None,
                            "status": "O",
                        }
                    ],
                    "child_tasks": [],
                    "name": "Respond",
                    "parent_id": None,
                    "phase_id": 1027,
                    "category_id": None,
                    "id": None,
                    "status": "O",
                }
            ]

        case RestUrls.PLAYBOOK_EXECUTIONS:
            return [
                {
                    "id": 2405,
                    "playbook": {
                        "id": 158,
                        "display_name": "kjhkjh",
                        "activation_type": "manual",
                        "description": None,
                        "creator_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "is_deleted": False,
                        "type": "default",
                        "version": 71,
                    },
                    "start_time": 1732120154932,
                    "last_activity_time": 1732120155352,
                    "last_activity_by": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "elapsed_time": 420,
                    "status": "completed",
                    "object": {
                        "parent": None,
                        "object_id": 2414,
                        "object_name": "asdf",
                        "type_id": 0,
                        "type_name": "incident",
                    },
                    "object_is_deleted": False,
                    "incident_id": 2414,
                    "detail_msg": None,
                }
            ]

        case RestUrls.TASK_ATTACHMENT_DETAILS:
            match kwargs.get("attach_id", 123):
                case 321:
                    return {
                        "id": 1411,
                        "task_id": 1,
                        "type": 16,
                        "name": "runme2.sh",
                        "description": None,
                        "attachment": {
                            "type": "artifact",
                            "id": 110,
                            "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                            "name": "runme2.sh",
                            "content_type": "application/x-shellscript",
                            "created": 1732119882733,
                            "creator_id": 34,
                            "size": 122,
                            "actions": [],
                            "playbooks": [],
                            "task_id": None,
                            "task_name": None,
                            "task_custom": None,
                            "task_members": None,
                            "task_at_id": None,
                            "reconciliation_status": "matched",
                            "vers": 3,
                            "inc_id": 2414,
                            "inc_name": "asdf",
                            "inc_owner": 34,
                        },
                        "parent_id": None,
                        "creator": {
                            "id": 34,
                            "fname": "Resilient",
                            "lname": "Sysadmin",
                            "display_name": "Resilient Sysadmin",
                            "status": "A",
                            "email": "resilient@example.com",
                            "locked": False,
                            "password_changed": False,
                            "is_external": False,
                            "ui_theme": "verydarkmode",
                            "is_ldap": False,
                            "is_saml": False,
                        },
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                        "hits": [],
                        "created": 1732119882637,
                        "last_modified_time": 1732119882742,
                        "last_modified_by": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "pending_sources": [],
                        "perms": {"read": True, "write": False, "delete": False},
                        "properties": None,
                        "actions": [],
                        "playbooks": [],
                        "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                        "relating": True,
                        "creator_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "related_incident_count": 3,
                        "pending_scan_result": False,
                        "global_info": {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        },
                        "ip": {"source": None, "destination": None},
                        "global_artifact": [
                            {
                                "id": 759,
                                "type": 16,
                                "value": "runme2.sh",
                                "description": None,
                                "creator": {
                                    "id": 34,
                                    "type": "user",
                                    "name": "thomas@example.com",
                                    "display_name": "Resilient Sysadmin",
                                },
                                "created": 1730307123575,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1730307123576,
                                "related_incident_count": 4,
                                "last_related_inc_id": 2414,
                                "last_related_inc_owner_handle": 34,
                                "first_related_inc_id": 2350,
                                "first_related_inc_owner_handle": 34,
                                "perms": {"write": False},
                                "first_associated_time": 1730307123575,
                                "last_associated_time": 1732119882637,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "unsupported",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            }
                        ],
                    }
                case 322:
                    return {
                        "id": 322,
                        "task_id": 1,
                        "type": 16,
                        "name": "output.png",
                        "description": None,
                        "attachment": {
                            "type": "artifact",
                            "id": 110,
                            "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                            "name": "runme2.sh",
                            "content_type": "application/x-shellscript",
                            "created": 1732119882733,
                            "creator_id": 34,
                            "size": 122,
                            "actions": [],
                            "playbooks": [],
                            "task_id": None,
                            "task_name": None,
                            "task_custom": None,
                            "task_members": None,
                            "task_at_id": None,
                            "reconciliation_status": "matched",
                            "vers": 3,
                            "inc_id": 2414,
                            "inc_name": "asdf",
                            "inc_owner": 34,
                        },
                        "parent_id": None,
                        "creator": {
                            "id": 34,
                            "fname": "Resilient",
                            "lname": "Sysadmin",
                            "display_name": "Resilient Sysadmin",
                            "status": "A",
                            "email": "resilient@example.com",
                            "locked": False,
                            "password_changed": False,
                            "is_external": False,
                            "ui_theme": "verydarkmode",
                            "is_ldap": False,
                            "is_saml": False,
                        },
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                        "hits": [],
                        "created": 1732119882637,
                        "last_modified_time": 1732119882742,
                        "last_modified_by": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "pending_sources": [],
                        "perms": {"read": True, "write": False, "delete": False},
                        "properties": None,
                        "actions": [],
                        "playbooks": [],
                        "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                        "relating": True,
                        "creator_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "related_incident_count": 3,
                        "pending_scan_result": False,
                        "global_info": {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        },
                        "ip": {"source": None, "destination": None},
                        "global_artifact": [
                            {
                                "id": 759,
                                "type": 16,
                                "value": "runme2.sh",
                                "description": None,
                                "creator": {
                                    "id": 34,
                                    "type": "user",
                                    "name": "thomas@example.com",
                                    "display_name": "Resilient Sysadmin",
                                },
                                "created": 1730307123575,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1730307123576,
                                "related_incident_count": 4,
                                "last_related_inc_id": 2414,
                                "last_related_inc_owner_handle": 34,
                                "first_related_inc_id": 2350,
                                "first_related_inc_owner_handle": 34,
                                "perms": {"write": False},
                                "first_associated_time": 1730307123575,
                                "last_associated_time": 1732119882637,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "unsupported",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            }
                        ],
                    }

        case RestUrls.ATTACHMENT_DETAILS:
            match kwargs.get("attach_id", 1411):
                case 1411:
                    return {
                        "id": 1411,
                        "task_id": None,
                        "type": 16,
                        "name": "runme2.sh",
                        "description": None,
                        "attachment": {
                            "type": "artifact",
                            "id": 110,
                            "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                            "name": "runme2.sh",
                            "content_type": "application/x-shellscript",
                            "created": 1732119882733,
                            "creator_id": 34,
                            "size": 122,
                            "actions": [],
                            "playbooks": [],
                            "task_id": None,
                            "task_name": None,
                            "task_custom": None,
                            "task_members": None,
                            "task_at_id": None,
                            "reconciliation_status": "matched",
                            "vers": 3,
                            "inc_id": 2414,
                            "inc_name": "asdf",
                            "inc_owner": 34,
                        },
                        "parent_id": None,
                        "creator": {
                            "id": 34,
                            "fname": "Resilient",
                            "lname": "Sysadmin",
                            "display_name": "Resilient Sysadmin",
                            "status": "A",
                            "email": "resilient@example.com",
                            "locked": False,
                            "password_changed": False,
                            "is_external": False,
                            "ui_theme": "verydarkmode",
                            "is_ldap": False,
                            "is_saml": False,
                        },
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                        "hits": [],
                        "created": 1732119882637,
                        "last_modified_time": 1732119882742,
                        "last_modified_by": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "pending_sources": [],
                        "perms": {"read": True, "write": False, "delete": False},
                        "properties": None,
                        "actions": [],
                        "playbooks": [],
                        "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                        "relating": True,
                        "creator_principal": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "related_incident_count": 3,
                        "pending_scan_result": False,
                        "global_info": {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        },
                        "ip": {"source": None, "destination": None},
                        "global_artifact": [
                            {
                                "id": 759,
                                "type": 16,
                                "value": "runme2.sh",
                                "description": None,
                                "creator": {
                                    "id": 34,
                                    "type": "user",
                                    "name": "thomas@example.com",
                                    "display_name": "Resilient Sysadmin",
                                },
                                "created": 1730307123575,
                                "last_modified_by": {
                                    "id": 0,
                                    "type": "system",
                                    "name": "System User",
                                    "display_name": "System User",
                                },
                                "last_modified_time": 1730307123576,
                                "related_incident_count": 4,
                                "last_related_inc_id": 2414,
                                "last_related_inc_owner_handle": 34,
                                "first_related_inc_id": 2350,
                                "first_related_inc_owner_handle": 34,
                                "perms": {"write": False},
                                "first_associated_time": 1730307123575,
                                "last_associated_time": 1732119882637,
                                "properties": None,
                                "tags": [],
                                "version": 0,
                                "scan_option": "unsupported",
                                "relating_incidents": True,
                                "hit_threat_sources": [],
                                "relating": True,
                                "last_scan_hits": [],
                                "summary": None,
                            }
                        ],
                    }

        case RestUrls.ATTACHMENT_BY_NAME:
            return [
                {
                    "id": 1411,
                    "task_id": 1,
                    "type": 16,
                    "name": "runme2.sh",
                    "description": None,
                    "attachment": {
                        "type": "artifact",
                        "id": 110,
                        "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                        "name": "runme2.sh",
                        "content_type": "application/x-shellscript",
                        "created": 1732119882733,
                        "creator_id": 34,
                        "size": 122,
                        "actions": [],
                        "playbooks": [],
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "reconciliation_status": "matched",
                        "vers": 3,
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                    },
                    "parent_id": None,
                    "creator": {
                        "id": 34,
                        "fname": "Resilient",
                        "lname": "Sysadmin",
                        "display_name": "Resilient Sysadmin",
                        "status": "A",
                        "email": "resilient@example.com",
                        "locked": False,
                        "password_changed": False,
                        "is_external": False,
                        "ui_theme": "verydarkmode",
                        "is_ldap": False,
                        "is_saml": False,
                    },
                    "inc_id": 2414,
                    "inc_name": "asdf",
                    "inc_owner": 34,
                    "hits": [],
                    "created": 1732119882637,
                    "last_modified_time": 1732119882742,
                    "last_modified_by": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "pending_sources": [],
                    "perms": {"read": True, "write": False, "delete": False},
                    "properties": None,
                    "actions": [],
                    "playbooks": [],
                    "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                    "relating": True,
                    "creator_principal": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "related_incident_count": 3,
                    "pending_scan_result": False,
                    "global_info": {
                        "id": 759,
                        "type": 16,
                        "value": "runme2.sh",
                        "description": None,
                        "creator": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "created": 1730307123575,
                        "last_modified_by": {
                            "id": 0,
                            "type": "system",
                            "name": "System User",
                            "display_name": "System User",
                        },
                        "last_modified_time": 1730307123576,
                        "related_incident_count": 4,
                        "last_related_inc_id": 2414,
                        "last_related_inc_owner_handle": 34,
                        "first_related_inc_id": 2350,
                        "first_related_inc_owner_handle": 34,
                        "perms": {"write": False},
                        "first_associated_time": 1730307123575,
                        "last_associated_time": 1732119882637,
                        "properties": None,
                        "tags": [],
                        "version": 0,
                        "scan_option": "unsupported",
                        "relating_incidents": True,
                        "hit_threat_sources": [],
                        "relating": True,
                        "last_scan_hits": [],
                        "summary": None,
                    },
                    "ip": {"source": None, "destination": None},
                    "global_artifact": [
                        {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        }
                    ],
                },
                {
                    "id": 322,
                    "task_id": 1,
                    "type": 16,
                    "name": "output.png",
                    "description": None,
                    "attachment": {
                        "type": "artifact",
                        "id": 110,
                        "uuid": "964f158a-5fc7-4f21-b58b-94edbe369ca8",
                        "name": "runme2.sh",
                        "content_type": "application/x-shellscript",
                        "created": 1732119882733,
                        "creator_id": 34,
                        "size": 122,
                        "actions": [],
                        "playbooks": [],
                        "task_id": None,
                        "task_name": None,
                        "task_custom": None,
                        "task_members": None,
                        "task_at_id": None,
                        "reconciliation_status": "matched",
                        "vers": 3,
                        "inc_id": 2414,
                        "inc_name": "asdf",
                        "inc_owner": 34,
                    },
                    "parent_id": None,
                    "creator": {
                        "id": 34,
                        "fname": "Resilient",
                        "lname": "Sysadmin",
                        "display_name": "Resilient Sysadmin",
                        "status": "A",
                        "email": "resilient@example.com",
                        "locked": False,
                        "password_changed": False,
                        "is_external": False,
                        "ui_theme": "verydarkmode",
                        "is_ldap": False,
                        "is_saml": False,
                    },
                    "inc_id": 2414,
                    "inc_name": "asdf",
                    "inc_owner": 34,
                    "hits": [],
                    "created": 1732119882637,
                    "last_modified_time": 1732119882742,
                    "last_modified_by": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "pending_sources": [],
                    "perms": {"read": True, "write": False, "delete": False},
                    "properties": None,
                    "actions": [],
                    "playbooks": [],
                    "hash": "d18ee8ed43f39efc8a84a838c71b114ac0bb17547e53a868b7589dbea2e03fa9",
                    "relating": True,
                    "creator_principal": {
                        "id": 34,
                        "type": "user",
                        "name": "thomas@example.com",
                        "display_name": "Resilient Sysadmin",
                    },
                    "related_incident_count": 3,
                    "pending_scan_result": False,
                    "global_info": {
                        "id": 759,
                        "type": 16,
                        "value": "runme2.sh",
                        "description": None,
                        "creator": {
                            "id": 34,
                            "type": "user",
                            "name": "thomas@example.com",
                            "display_name": "Resilient Sysadmin",
                        },
                        "created": 1730307123575,
                        "last_modified_by": {
                            "id": 0,
                            "type": "system",
                            "name": "System User",
                            "display_name": "System User",
                        },
                        "last_modified_time": 1730307123576,
                        "related_incident_count": 4,
                        "last_related_inc_id": 2414,
                        "last_related_inc_owner_handle": 34,
                        "first_related_inc_id": 2350,
                        "first_related_inc_owner_handle": 34,
                        "perms": {"write": False},
                        "first_associated_time": 1730307123575,
                        "last_associated_time": 1732119882637,
                        "properties": None,
                        "tags": [],
                        "version": 0,
                        "scan_option": "unsupported",
                        "relating_incidents": True,
                        "hit_threat_sources": [],
                        "relating": True,
                        "last_scan_hits": [],
                        "summary": None,
                    },
                    "ip": {"source": None, "destination": None},
                    "global_artifact": [
                        {
                            "id": 759,
                            "type": 16,
                            "value": "runme2.sh",
                            "description": None,
                            "creator": {
                                "id": 34,
                                "type": "user",
                                "name": "thomas@example.com",
                                "display_name": "Resilient Sysadmin",
                            },
                            "created": 1730307123575,
                            "last_modified_by": {
                                "id": 0,
                                "type": "system",
                                "name": "System User",
                                "display_name": "System User",
                            },
                            "last_modified_time": 1730307123576,
                            "related_incident_count": 4,
                            "last_related_inc_id": 2414,
                            "last_related_inc_owner_handle": 34,
                            "first_related_inc_id": 2350,
                            "first_related_inc_owner_handle": 34,
                            "perms": {"write": False},
                            "first_associated_time": 1730307123575,
                            "last_associated_time": 1732119882637,
                            "properties": None,
                            "tags": [],
                            "version": 0,
                            "scan_option": "unsupported",
                            "relating_incidents": True,
                            "hit_threat_sources": [],
                            "relating": True,
                            "last_scan_hits": [],
                            "summary": None,
                        }
                    ],
                },
            ]
        case _:
            return {}


def mock_text_generation(
    _self,
    _prompt: str,
    _arguments: str = None,
    _stop_sequences: List[str] = None,
    _repetition_penalty: float = 1.2,
    _min_new_tokens: int = 1,
    _max_new_tokens: int = 900,
    _timeout=25 * 1000,
    _enable_moderation=True,
) -> AIResponse:
    """Returns a deepcopy of the predefined output example"""
    output = copy.deepcopy(sample_output)

    # special case for artifact qna
    if app_state.get().purpose == AiResponsePurpose.ARTIFACT_CONVERSATION:
        output["results"][0]["generated_text"] = "Artifact conversation"
    return output


def mock_generate_embeddings(_self, data: List[str]) -> List[list]:
    return [[-1, 2, 3]]
