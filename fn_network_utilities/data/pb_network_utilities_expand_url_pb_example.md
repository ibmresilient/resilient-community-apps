<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v50.0.151
-->

# Playbook - Network Utilities Expand URL (PB) Example

### API Name
`network_utilities_expand_url_pb_example`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type equals URL`

### Object Type
`artifact`

### Description
Take a url (mostly shortened) and follow it through redirects as it's expanded


---
## Function - Network Utilities: Expand URL

### API Name
`network_utilities_expand_url`

### Output Name
`expand_url_result`

### Message Destination
`fn_network_utilities`

### Function-Input Script
```python
inputs.network_utilities_resilient_url = artifact.value
```

---

## Local script - expand_url_results

### Description


### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
results = playbook.functions.results.expand_url_result

# Results: {'urllist': ['https://community.ibm.com/community/user/security/communities/community-home?CommunityKey=d2f71e8c-108e-4652-b59c-29d61af7163e', 'https://community.ibm.com/community/user/security/communities/community-home']}

# Add the url expansions to the Artifact Description
expansions = results.get("urllist", [])
  
hits = []
for count, url in enumerate(expansions):
  incident.addArtifact("URL", url, u"expansion from {}".format(artifact.value))
  hits.append({
    "name": f"Expansion: #{count}",
    "type": "uri",
    "value": url
  })
  
if hits:
  artifact.addHit("Network Utilities Expand URL", hits)

```

---

