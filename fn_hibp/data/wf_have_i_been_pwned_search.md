<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Have I Been Pwned Search

## Function - Have I Been Pwned Get Breaches

### API Name
`have_i_been_pwned_get_breaches`

### Output Name
``

### Message Destination
`hibp`

### Pre-Processing Script
```python
inputs.email_address = artifact.value
```

### Post-Processing Script
```python
msg = "Timestamp: " + str(results.metrics["timestamp"])
if results.content["Breaches"]:
  msg = msg + "\nBreaches: " + str(len(results.content["Breaches"]))
else:
  msg = msg + "\nNo Breaches"
  
if artifact.description:
  artifact.description = artifact.description.content + '\n\n' + msg
else:
  artifact.description = msg


''' Example response
{
  "Inputs": {
    "email_address": "test@email.com"
  }, 
  "Run Time": "2000",
  "Breaches":
    [  
       {  
          u'PwnCount':14936670,
          u'Domain':u'000webhost.com',
          u'IsSensitive':False,
          u'Name':u'000webhost',
          u'Title':u'000webhost',
          u'DataClasses':[  
             u'Email addresses',
             u'IP addresses',
             u'Names',
             u'Passwords'
          ],
          u'LogoType':u'png',
          u'IsSpamList':False,
          u'IsRetired':False,
          u'BreachDate':u'2015-03-01',
          u'IsFabricated':False,
          u'ModifiedDate':      u'2017-12-10T21:44:27      Z',
          u'AddedDate':      u'2015-10-26T23:35:45      Z',
          u'IsVerified':True,
          u'Description':u'In approximately March 2015,
          the free web hosting provider <a href="http://www.troyhunt.com/2015/10/breaches-traders-plain-text-passwords.html" target="_blank" rel="noopener">000webhost suffered a major data breach</a> that exposed almost 15 million customer records. The data was sold and traded before 000webhost was alerted in October. The breach included names,
          email addresses and plain text passwords.'
       },
       {  
          u'PwnCount':7990619,
          u'Domain':u'8tracks.com',
          u'IsSensitive':False,
          u'Name':u'8tracks',
          u'Title':u'8tracks',
          u'DataClasses':[  
             u'Email addresses',
             u'Passwords'
          ],
          u'LogoType':u'png',
          u'IsSpamList':False,
          u'IsRetired':False,
          u'BreachDate':u'2017-06-27',
          u'IsFabricated':False,
          u'ModifiedDate':      u'2018-02-16T07:09:30      Z',
          u'AddedDate':      u'2018-02-16T07:09:30      Z',
          u'IsVerified':True,
          u'Description':u'In June 2017,
          the online playlists service known as <a href="https://blog.8tracks.com/2017/06/27/password-security-alert/" target="_blank" rel="noopener">8Tracks suffered a data breach</a> which impacted 18 million accounts. In their disclosure,
          8      Tracks advised that &quot;the vector for the attack was an employee\u2019s GitHub account,
          which was not secured using two-factor authentication&quot;. Salted SHA-1 password hashes for users who <em>didn\'t</em> sign up with either Google or Facebook authentication were also included. The data was provided to HIBP by whitehat security researcher and data analyst Adam Davies and contained almost 8 million unique email addresses.'
       },
       {  
          u'PwnCount':1372550,
          u'Domain':u'abusewith.us',
          u'IsSensitive':False,
          u'Name':u'AbuseWithUs',
          u'Title':u'AbuseWith.Us',
          u'DataClasses':[  
             u'Email addresses',
             u'IP addresses',
             u'Passwords',
             u'Usernames'
          ],
          u'LogoType':u'png',
          u'IsSpamList':False,
          u'IsRetired':False,
          u'BreachDate':u'2016-07-01',
          u'IsFabricated':False,
          u'ModifiedDate':      u'2017-10-09T11:08:45      Z',
          u'AddedDate':      u'2017-10-09T11:08:45      Z',
          u'IsVerified':True,
          u'Description':u'In 2016,
          the site dedicated to helping people hack email and online gaming accounts known as Abusewith.us suffered multiple data breaches. The site <a href="https://krebsonsecurity.com/2017/02/who-ran-leakedsource-com/" target="_blank" rel="noopener">allegedly had an administrator in common with the nefarious LeakedSource site</a>,
          both of which have since been shut down. The exposed data included more than 1.3 million unique email addresses,
          often accompanied by usernames,
          IP addresses and plain text or hashed passwords retrieved from various sources and intended to be used to compromise the victims\' accounts.'
       }
    ]
}

'''
```

---

## Function - Have I Been Pwned Get Pastes

### API Name
`have_i_been_pwned_get_pastes`

### Output Name
`None`

### Message Destination
`hibp`

### Pre-Processing Script
```python
inputs.email_address = artifact.value
```

### Post-Processing Script
```python
msg = "Timestamp: " + str(results.metrics["timestamp"])
if results.content["Pastes"]:
  msg = msg + "\nPastes: " + str(len(results.content["Pastes"]))
else:
  msg = msg + "\nNo Pastes"
    
if artifact.description:
  artifact.description = artifact.description.content + '\n\n' + msg
else:
  artifact.description = msg


''' Example Response
{
  "Inputs": {
    "email_address": "test@email.com"
  }, 
  "Run Time": "2000",
  "Pastes":
    [  
       {  
          u'Date':None,
          u'Source':u'AdHocUrl',
          u'EmailCount':9893,
          u'Id':      u'http://siph0n.in/exploits.php?id=3670',
          u'Title':u'siph0n.in'
       },
       {  
          u'Date':None,
          u'Source':u'AdHocUrl',
          u'EmailCount':12002,
          u'Id':      u'http://siph0n.in/exploits.php?id=3892',
          u'Title':u'siph0n.in'
       },
       {  
          u'Date':None,
          u'Source':u'AdHocUrl',
          u'EmailCount':99791,
          u'Id':      u'http://siph0n.in/exploits.php?id=4680',
          u'Title':u'remotestaff.com.au'
       }
    ]
}
'''

```

---

