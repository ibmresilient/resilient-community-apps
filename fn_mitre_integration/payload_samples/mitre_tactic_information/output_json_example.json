{
  "version": "1.0",
  "success": true,
  "reason": null,
  "content": {
    "mitre_tactics": [
      {
        "name": "Command and Control",
        "id": "TA0011",
        "ref": "https://attack.mitre.org/tactics/TA0011",
        "collection": "Enterprise ATT&CK",
        "mitre_techniques": [
          {
            "name": "Socket Filters",
            "description": "Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as the `libpcap` library to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell.\n\nTo establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria.(Citation: haking9 libpcap network sniffing) Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction with <a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a>.(Citation: exatrack bpf filters passive backdoors)(Citation: Leonardo Turla Penquin May 2020)\n\nFilters can be installed on any Unix-like platform with `libpcap` installed or on Windows hosts using `Winpcap`.  Adversaries may use either `libpcap` with `pcap_setfilter` or the standard library function `setsockopt` with `SO_ATTACH_FILTER` options. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205/002"
              },
              {
                "url": "https://exatrack.com/public/Tricephalic_Hellkeeper.pdf"
              },
              {
                "url": "https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/"
              },
              {
                "url": "https://www.leonardo.com/documents/20142/10868623/Malware+Technical+Insight+_Turla+%E2%80%9CPenquin_x64%E2%80%9D.pdf"
              },
              {
                "url": "http://recursos.aldabaknocking.com/libpcapHakin9LuisMartinGarcia.pdf"
              }
            ],
            "x_mitre_detection": "Identify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.(Citation: crowdstrike bpf socket filters)",
            "id": "T1205.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Standard Encoding",
            "description": "Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding)(Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1132.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Proxy",
            "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.\n\nAdversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nConsider monitoring for traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>).",
            "id": "T1090",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-hop Proxy",
            "description": "To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1188"
              }
            ],
            "x_mitre_detection": "When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>) or known adversary infrastructure that uses this technique.",
            "id": "T1188",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Dynamic Resolution",
            "description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.\n\nAdversaries may use dynamic resolution for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated C2 can be challenging due to the number of different algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are multiple approaches to detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more (Citation: Data Driven Security DGA). CDN domains may trigger these detections due to the format of their domain names. In addition to detecting algorithm generated domains based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.",
            "id": "T1568",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "External Proxy",
            "description": "Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion.\n\nExternal connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows, such as a client sending significantly more data than it receives from an external server. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1090.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Communication Through Removable Media",
            "description": "Adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system.(Citation: ESET Sednit USBStealer 2014) Both systems would need to be compromised, with the likelihood that an Internet-connected system was compromised first and the second through lateral movement by <a href=\"https://attack.mitre.org/techniques/T1091\">Replication Through Removable Media</a>. Commands and files would be relayed from the disconnected system to the Internet-connected system to which the adversary has direct access.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1092"
              },
              {
                "url": "http://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/"
              }
            ],
            "x_mitre_detection": "Monitor file access on removable media. Detect processes that execute when removable media is mounted.",
            "id": "T1092",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "One-Way Communication",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to a compromised system without receiving return output over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/003"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "File Transfer Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMB(Citation: US-CERT TA18-074A), FTP(Citation: ESET Machete July 2019), FTPS, and TFTP that transfer files may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/002"
              },
              {
                "url": "https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1071.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multiband Communication",
            "description": "Deprecated. **This technique has been deprecated and should no longer be used.**\n\nSome adversaries may split communications between different protocols. There could be one protocol for inbound command and control and another for outbound data, allowing it to bypass certain firewall restrictions. The split could also be random to simply avoid data threshold alerts on any one communication.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1026"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2) Correlating alerts between multiple communication channels can further help identify command-and-control behavior.",
            "id": "T1026",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Standard Port",
            "description": "Adversaries may communicate using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.\n\nAdversaries may also make changes to victim systems to abuse non-standard ports. For example, Registry keys and other configuration settings can be used to modify protocol and port pairings.(Citation: change_rdp_port_conti)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1571"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage"
              },
              {
                "url": "https://x.com/TheDFIRReport/status/1498657772254240768"
              },
              {
                "url": "https://www.fortinet.com/blog/threat-research/analysis-of-new-agent-tesla-spyware-variant.html"
              }
            ],
            "x_mitre_detection": "Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2)",
            "id": "T1571",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Data Obfuscation",
            "description": "Adversaries may obfuscate command and control traffic to make it more difficult to detect.(Citation: Bitdefender FunnyDream Campaign November 2020) Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.bitdefender.com/files/News/CaseStudies/study/379/Bitdefender-Whitepaper-Chinese-APT.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-hop Proxy",
            "description": "Adversaries may chain together multiple proxies to disguise the source of malicious traffic. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.\n\nFor example, adversaries may construct or use onion routing networks \u2013 such as the publicly available <a href=\"https://attack.mitre.org/software/S0183\">Tor</a> network \u2013 to transport encrypted C2 traffic through a compromised population, allowing communication with any device within the network.(Citation: Onion Routing) Adversaries may also use operational relay box (ORB) networks composed of virtual private servers (VPS), Internet of Things (IoT) devices, smart devices, and end-of-life routers to obfuscate their operations. (Citation: ORB Mandiant) \n\nIn the case of network infrastructure, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain (i.e., <a href=\"https://attack.mitre.org/techniques/T1584/008\">Network Devices</a>). By leveraging <a href=\"https://attack.mitre.org/techniques/T1601/001\">Patch System Image</a> on routers, adversaries can add custom code to the affected network devices that will implement onion routing between those nodes. This method is dependent upon the <a href=\"https://attack.mitre.org/techniques/T1599\">Network Boundary Bridging</a> method allowing the adversaries to cross the protected network boundary of the Internet perimeter and into the organization\u2019s Wide-Area Network (WAN).  Protocols such as ICMP may be used as a transport.  \n\nSimilarly, adversaries may abuse peer-to-peer (P2P) and blockchain-oriented infrastructure to implement routing between a decentralized network of peers.(Citation: NGLite Trojan)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/003"
              },
              {
                "url": "https://cloud.google.com/blog/topics/threat-intelligence/china-nexus-espionage-orb-networks"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Onion_routing"
              }
            ],
            "x_mitre_detection": "When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>) or known adversary infrastructure that uses this technique.\n\nIn context of network devices, monitor traffic for encrypted communications from the Internet that is addressed to border routers.  Compare this traffic with the configuration to determine whether it matches with any configured site-to-site Virtual Private Network (VPN) connections the device was intended to have. Monitor traffic for encrypted communications originating from potentially breached routers that is addressed to other routers within the organization.  Compare the source and destination with the configuration of the device to determine if these channels are an authorized Virtual Private Network (VPN) connections or other encrypted modes of communication. Monitor ICMP traffic from the Internet that is addressed to border routers and is encrypted.  Few if any legitimate use cases exist for sending encrypted data to a network device via ICMP.",
            "id": "T1090.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Port Knocking",
            "description": "Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.\n\nThis technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205/001"
              },
              {
                "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"
              }
            ],
            "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.",
            "id": "T1205.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-Stage Channels",
            "description": "Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult.\n\nRemote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features.\n\nThe different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a> in case the original first-stage communication path is discovered and blocked.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1104"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure. Relating subsequent actions that may result from Discovery of the system and network information or Lateral Movement to the originating process may also yield useful data.",
            "id": "T1104",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "DNS Calculation",
            "description": "Adversaries may perform calculations on addresses returned in DNS results to determine which port and IP address to use for command and control, rather than relying on a predetermined port number or the actual returned IP address. A IP and/or port number calculation can be used to bypass egress filtering on a C2 channel.(Citation: Meyers Numbered Panda)\n\nOne implementation of <a href=\"https://attack.mitre.org/techniques/T1568/003\">DNS Calculation</a> is to take the first three octets of an IP address in a DNS response and use those values to calculate the port for command and control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/003"
              },
              {
                "url": "http://www.crowdstrike.com/blog/whois-numbered-panda/"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2014/09/darwins-favorite-apt-group-2.html"
              },
              {
                "url": "https://blog.rapid7.com/2013/08/26/upcoming-g20-summit-fuels-espionage-operations/"
              }
            ],
            "x_mitre_detection": "Detection for this technique is difficult because it would require knowledge of the specific implementation of the port calculation algorithm. Detection may be possible by analyzing DNS records if the algorithm is known.",
            "id": "T1568.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Web Service",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites, cloud services, and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google, Microsoft, or Twitter, makes it easier for adversaries to hide in expected noise.(Citation: Broadcom BirdyClient Microsoft Graph API 2024) Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102"
              },
              {
                "url": "https://www.broadcom.com/support/security-center/protection-bulletin/birdyclient-malware-leverages-microsoft-graph-api-for-c-c-communication"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Symmetric Cryptography",
            "description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "With symmetric encryption, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures.\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Publish/Subscribe Protocols",
            "description": "Adversaries may communicate using publish/subscribe (pub/sub) application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as <tt>MQTT</tt>, <tt>XMPP</tt>, <tt>AMQP</tt>, and <tt>STOMP</tt> use a publish/subscribe design, with message distribution managed by a centralized broker.(Citation: wailing crab sub/pub)(Citation: Mandiant APT1 Appendix) Publishers categorize their messages by topics, while subscribers receive messages according to their subscribed topics.(Citation: wailing crab sub/pub) An adversary may abuse publish/subscribe protocols to communicate with systems under their control from behind a message broker while also mimicking normal, expected traffic.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/005"
              },
              {
                "url": "https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/"
              },
              {
                "url": "https://www.mandiant.com/sites/default/files/2021-09/mandiant-apt1-report.pdf"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1071.005",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Fast Flux DNS",
            "description": "Adversaries may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution. This technique uses a fully qualified domain name, with multiple IP addresses assigned to it which are swapped with high frequency, using a combination of round robin IP addressing and short Time-To-Live (TTL) for a DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity)\n\nThe simplest, \"single-flux\" method, involves registering and de-registering an addresses as part of the DNS A (address) record list for a single DNS name. These registrations have a five-minute average lifespan, resulting in a constant shuffle of IP address resolution.(Citation: Fast Flux - Welivesecurity)\n\nIn contrast, the \"double-flux\" method registers and de-registers an address as part of the DNS Name Server record list for the DNS zone, providing additional resilience for the connection. With double-flux additional hosts can act as a proxy to the C2 host, further insulating the true source of the C2 channel.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/001"
              },
              {
                "url": "https://resources.infosecinstitute.com/fast-flux-networks-working-detection-part-1/#gref"
              },
              {
                "url": "https://resources.infosecinstitute.com/fast-flux-networks-working-detection-part-2/#gref"
              },
              {
                "url": "https://www.welivesecurity.com/2017/01/12/fast-flux-networks-work/"
              }
            ],
            "x_mitre_detection": "In general, detecting usage of fast flux DNS is difficult due to web traffic load balancing that services client requests quickly. In single flux cases only IP addresses change for static domain names. In double flux cases, nothing is static. Defenders such as domain registrars and service providers are likely in the best position for detection.",
            "id": "T1568.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/002"
              },
              {
                "url": "https://arxiv.org/pdf/1611.00791.pdf"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://medium.com/@yvyuz/a-death-match-of-domain-generation-algorithms-a5b5dbdc1c6e"
              },
              {
                "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"
              },
              {
                "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain is related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)",
            "id": "T1568.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Fronting",
            "description": "Domain fronting takes advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) The technique involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).\n\nFor example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1172"
              },
              {
                "url": "http://www.icir.org/vern/papers/meek-PETS-2015.pdf"
              }
            ],
            "x_mitre_detection": "If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blacklist or whitelist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)",
            "id": "T1172",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "DNS",
            "description": "Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nThe DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/004"
              },
              {
                "url": "https://medium.com/@galolbardes/learn-how-easy-is-to-bypass-firewalls-using-dns-tunneling-and-also-how-to-block-it-3ed652f4a000"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.paloaltonetworks.com/cyberpedia/what-is-dns-tunneling"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for DNS traffic to/from known-bad or suspicious domains.",
            "id": "T1071.004",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Standard Cryptographic Protocol",
            "description": "Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1032"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels. (Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation. (Citation: SEI SSL Inspection Risks)\n\nIf malware uses encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1032",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Traffic Signaling",
            "description": "Adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e. <a href=\"https://attack.mitre.org/techniques/T1205/001\">Port Knocking</a>), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software.\n\nAdversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s).\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.\n\nOn network devices, adversaries may use crafted packets to enable <a href=\"https://attack.mitre.org/techniques/T1556/004\">Network Device Authentication</a> for standard services offered by the device such as telnet.  Such signaling may also be used to open a closed service port such as telnet, or to trigger module modification of malware implants on the device, adding, removing, or changing malicious capabilities.  Adversaries may use crafted packets to attempt to connect to one or more (open or closed) ports, but may also attempt to connect to a router interface, broadcast, and network address IP on the same port in order to achieve their goals and objectives.(Citation: Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco Blog Legacy Device Attacks)  To enable this traffic signaling on embedded devices, adversaries must first achieve and leverage <a href=\"https://attack.mitre.org/techniques/T1601/001\">Patch System Image</a> due to the monolithic nature of the architecture.\n\nAdversaries may also use the Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware feature that allows a powered down system to be powered on, or woken up, by sending a magic packet to it. Once the system is powered on, it may become a target for lateral movement.(Citation: Bleeping Computer - Ryuk WoL)(Citation: AMD Magic Packet)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205"
              },
              {
                "url": "https://www.bleepingcomputer.com/news/security/ryuk-ransomware-uses-wake-on-lan-to-encrypt-offline-devices/"
              },
              {
                "url": "https://www.amd.com/system/files/TechDocs/20213.pdf"
              },
              {
                "url": "https://www.mandiant.com/resources/synful-knock-acis"
              },
              {
                "url": "https://blogs.cisco.com/security/evolution-of-attacks-on-cisco-ios-devices"
              },
              {
                "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"
              },
              {
                "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
              },
              {
                "url": "https://gitlab.com/wireshark/wireshark/-/wikis/WakeOnLAN"
              }
            ],
            "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.\n\nThe Wake-on-LAN magic packet consists of 6 bytes of <tt>FF</tt> followed by sixteen repetitions of the target system's IEEE address. Seeing this string anywhere in a packet's payload may be indicative of a Wake-on-LAN attempt.(Citation: GitLab WakeOnLAN)",
            "id": "T1205",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Content Injection",
            "description": "Adversaries may gain access and continuously communicate with victims by injecting malicious content into systems through online network traffic. Rather than luring victims to malicious payloads hosted on a compromised website (i.e., <a href=\"https://attack.mitre.org/techniques/T1608/004\">Drive-by Target</a> followed by <a href=\"https://attack.mitre.org/techniques/T1189\">Drive-by Compromise</a>), adversaries may initially access victims through compromised data-transfer channels where they can manipulate traffic and/or inject their own content. These compromised online network channels may also be used to deliver additional payloads (i.e., <a href=\"https://attack.mitre.org/techniques/T1105\">Ingress Tool Transfer</a>) and other data to already compromised systems.(Citation: ESET MoustachedBouncer)\n\nAdversaries may inject content to victim systems in various ways, including:\n\n* From the middle, where the adversary is in-between legitimate online client-server communications (**Note:** this is similar but distinct from <a href=\"https://attack.mitre.org/techniques/T1557\">Adversary-in-the-Middle</a>, which describes AiTM activity solely within an enterprise environment) (Citation: Kaspersky Encyclopedia MiTM)\n* From the side, where malicious content is injected and races to the client as a fake response to requests of a legitimate online server (Citation: Kaspersky ManOnTheSide)\n\nContent injection is often the result of compromised upstream communication channels, for example at the level of an internet service provider (ISP) as is the case with \"lawful interception.\"(Citation: Kaspersky ManOnTheSide)(Citation: ESET MoustachedBouncer)(Citation: EFF China GitHub Attack)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1659"
              },
              {
                "url": "https://www.eff.org/deeplinks/2015/04/china-uses-unencrypted-websites-to-hijack-browsers-in-github-attack"
              },
              {
                "url": "https://www.welivesecurity.com/en/eset-research/moustachedbouncer-espionage-against-foreign-diplomats-in-belarus/"
              },
              {
                "url": "https://encyclopedia.kaspersky.com/glossary/man-in-the-middle-attack/"
              },
              {
                "url": "https://usa.kaspersky.com/blog/man-on-the-side/27854/"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1659",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Mail Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: FireEye APT28) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/003"
              },
              {
                "url": "https://web.archive.org/web/20151022204649/https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1071.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1483"
              },
              {
                "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"
              },
              {
                "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "https://blogs.akamai.com/2018/01/a-death-match-of-domain-generation-algorithms.html"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"
              },
              {
                "url": "https://arxiv.org/pdf/1611.00791.pdf"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain or related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)",
            "id": "T1483",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Protocol Tunneling",
            "description": "Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. \n\nThere are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling) \n\n<a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a> may also be abused by adversaries during <a href=\"https://attack.mitre.org/techniques/T1568\">Dynamic Resolution</a>. Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) \n\nAdversaries may also leverage <a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a> in conjunction with <a href=\"https://attack.mitre.org/techniques/T1090\">Proxy</a> and/or <a href=\"https://attack.mitre.org/techniques/T1001/003\">Protocol Impersonation</a> to further conceal C2 communications and infrastructure. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1572"
              },
              {
                "url": "https://www.ssh.com/ssh/tunneling"
              },
              {
                "url": "https://www.bleepingcomputer.com/news/security/new-godlua-malware-evades-traffic-monitoring-via-dns-over-https/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Monitoring for systems listening and/or establishing external connections using ports/protocols commonly associated with tunneling, such as SSH (port 22). Also monitor for processes commonly associated with tunneling, such as Plink and the OpenSSH client. \n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1572",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Application Layer Protocol",
            "description": "Adversaries may communicate using OSI application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, DNS, or publishing/subscribing. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.(Citation: Mandiant APT29 Eye Spy Email Nov 22) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.mandiant.com/resources/blog/unc3524-eye-spy-email"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1071",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multilayer Encryption",
            "description": "An adversary performs C2 communications using multiple layers of encryption, typically (but not exclusively) tunneling a custom encryption scheme within a protocol encryption scheme such as HTTPS or SMTPS.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1079"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "If malware uses <a href=\"https://attack.mitre.org/techniques/T1032\">Standard Cryptographic Protocol</a>, SSL/TLS inspection can be used to detect command and control traffic within some encrypted communication channels. (Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation. (Citation: SEI SSL Inspection Risks) After SSL/TLS inspection, additional cryptographic analysis may be needed to analyze the second layer of encryption.\n\nWith <a href=\"https://attack.mitre.org/techniques/T1024\">Custom Cryptographic Protocol</a>, if malware uses encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1079",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Remote Access Software",
            "description": "An adversary may use legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks. These services, such as `VNC`, `Team Viewer`, `AnyDesk`, `ScreenConnect`, `LogMein`, `AmmyyAdmin`, and other remote monitoring and management (RMM) tools, are commonly used as legitimate technical support software and may be allowed by application control within a target environment.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy)\n\nRemote access software may be installed and used post-compromise as an alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary-controlled system.\n \nAdversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.\n\nInstallation of many remote access software may also include persistence (e.g., the software's installation routine creates a <a href=\"https://attack.mitre.org/techniques/T1543/003\">Windows Service</a>). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome\u2019s Remote Desktop).(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1219"
              },
              {
                "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/15GlobalThreatReport.pdf"
              },
              {
                "url": "https://blog.crysys.hu/2013/03/teamspy/"
              },
              {
                "url": "https://support.google.com/chrome/answer/1649523"
              },
              {
                "url": "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
              },
              {
                "url": "https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-living-off-the-land-and-fileless-attack-techniques-en.pdf"
              }
            ],
            "x_mitre_detection": "Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\n\n<a href=\"https://attack.mitre.org/techniques/T1090/004\">Domain Fronting</a> may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.",
            "id": "T1219",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Custom Cryptographic Protocol",
            "description": "Adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic. A simple scheme, such as XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.\n\nCustom encryption schemes may vary in sophistication. Analysis and reverse engineering of malware samples may be enough to discover the algorithm and encryption key used.\n\nSome adversaries may also attempt to implement their own version of a well-known cryptographic algorithm instead of using a known implementation library, which may lead to unintentional errors. (Citation: F-Secure Cosmicduke)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1024"
              },
              {
                "url": "https://blog.f-secure.com/wp-content/uploads/2019/10/CosmicDuke.pdf"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "If malware uses custom encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect when communications do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1024",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Data Encoding",
            "description": "Adversaries may encode data to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system. Use of data encoding may adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64, MIME, or other binary-to-text and character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1132",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Fronting",
            "description": "Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).\n\nFor example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/004"
              },
              {
                "url": "http://www.icir.org/vern/papers/meek-PETS-2015.pdf"
              }
            ],
            "x_mitre_detection": "If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blocklist or allowlist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)",
            "id": "T1090.004",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Uncommonly Used Port",
            "description": "Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1065"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1065",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Encrypted Channel",
            "description": "Adversaries may employ an encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Protocol or Service Impersonation",
            "description": "Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.  \n\nAdversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. \n\nAdversaries may also leverage legitimate protocols to impersonate expected web traffic or trusted services. For example, adversaries may manipulate HTTP headers, URI endpoints, SSL certificates, and transmitted data to disguise C2 communications or mimic legitimate services such as Gmail, Google Drive, and Yahoo Messenger.(Citation: ESET Okrum July 2019)(Citation: Malleable-C2-U42)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/003"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/cobalt-strike-malleable-c2-profile/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Application Layer Protocol",
            "description": "Adversaries may use an OSI non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).\n\nICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution) Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.(Citation: Microsoft ICMP) However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1095"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://blogs.cisco.com/security/evolution-of-attacks-on-cisco-ios-devices"
              },
              {
                "url": "http://support.microsoft.com/KB/170292"
              },
              {
                "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
              },
              {
                "url": "http://en.wikipedia.org/wiki/List_of_network_protocols_%28OSI_model%29"
              }
            ],
            "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.(Citation: Cisco Blog Legacy Device Attacks)\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2) \n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.",
            "id": "T1095",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Asymmetric Cryptography",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as <a href=\"https://attack.mitre.org/techniques/T1573/002\">Asymmetric Cryptography</a>.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573/002"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Bidirectional Communication",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. \n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Fallback Channels",
            "description": "Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1008"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1008",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Steganography",
            "description": "Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Standard Encoding",
            "description": "Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132/002"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1132.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Deprecated. **This technique has been deprecated. Please use <a href=\"https://attack.mitre.org/techniques/T1571\">Non-Standard Port</a> where appropriate.**\n\nAdversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1043"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1043",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Junk Data",
            "description": "Adversaries may add junk data to protocols used for command and control to make detection more difficult.(Citation: FireEye SUNBURST Backdoor December 2020) By adding random or meaningless data to the protocols used for command and control, adversaries can prevent trivial methods for decoding, deciphering, or otherwise analyzing the traffic. Examples may include appending/prepending data with junk characters or writing junk characters between significant characters. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/001"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Dead Drop Resolver",
            "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Custom Command and Control Protocol",
            "description": "Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing <a href=\"https://attack.mitre.org/techniques/T1071\">Application Layer Protocol</a>. Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1094"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.",
            "id": "T1094",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Internal Proxy",
            "description": "Adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command and control communications inside a compromised environment, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between infected systems to avoid suspicion. Internal proxy connections may use common peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with the environment.\n\nBy using a compromised internal system as a proxy, adversaries may conceal the true destination of C2 traffic while reducing the need for numerous connections to external systems.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows between clients that should not or often do not communicate with one another. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1090.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Web Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as HTTP/S(Citation: CrowdStrike Putter Panda) and WebSocket(Citation: Brazking-Websockets) that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/001"
              },
              {
                "url": "http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://securityintelligence.com/posts/brazking-android-malware-upgraded-targeting-brazilian-banks/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for web traffic to/from known-bad or suspicious domains. ",
            "id": "T1071.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Hide Infrastructure",
            "description": "Adversaries may manipulate network traffic in order to hide and evade detection of their C2 infrastructure. This can be accomplished in various ways including by identifying and filtering traffic from defensive tools,(Citation: TA571) masking malicious domains to obfuscate the true destination from both automated scanning tools and security researchers,(Citation: Schema-abuse)(Citation: Facad1ng)(Citation: Browser-updates) and otherwise hiding malicious artifacts to delay discovery and prolong the effectiveness of adversary infrastructure that could otherwise be identified, blocked, or taken down entirely.\n\nC2 networks may include the use of <a href=\"https://attack.mitre.org/techniques/T1090\">Proxy</a> or VPNs to disguise IP addresses, which can allow adversaries to blend in with normal network traffic and bypass conditional access policies or anti-abuse protections. For example, an adversary may use a virtual private cloud to spoof their IP address to closer align with a victim's IP address ranges. This may also bypass security measures relying on geolocation of the source IP address.(Citation: sysdig)(Citation: Orange Residential Proxies)\n\nAdversaries may also attempt to filter network traffic in order to evade defensive tools in numerous ways, including blocking/redirecting common incident responder or security appliance user agents.(Citation: mod_rewrite)(Citation: SocGholish-update) Filtering traffic based on IP and geo-fencing may also avoid automated sandboxing or researcher activity (i.e., <a href=\"https://attack.mitre.org/techniques/T1497\">Virtualization/Sandbox Evasion</a>).(Citation: TA571)(Citation: mod_rewrite)\n\nHiding C2 infrastructure may also be supported by <a href=\"https://attack.mitre.org/tactics/TA0042\">Resource Development</a> activities such as <a href=\"https://attack.mitre.org/techniques/T1583\">Acquire Infrastructure</a> and <a href=\"https://attack.mitre.org/techniques/T1584\">Compromise Infrastructure</a>. For example, using widely trusted hosting services or domains such as prominent URL shortening providers or marketing services for C2 networks may enable adversaries to present benign content that later redirects victims to malicious web pages or infrastructure once specific conditions are met.(Citation: StarBlizzard)(Citation: QR-cofense)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1665"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/part-1-socgholish-very-real-threat-very-fake-update"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/security-brief-ta571-delivers-icedid-forked-loader"
              },
              {
                "url": "https://bluescreenofjeff.com/2016-04-12-combatting-incident-responders-with-apache-mod_rewrite/"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/are-you-sure-your-browser-date-current-landscape-fake-browser-updates"
              },
              {
                "url": "https://www.microsoft.com/en-us/security/blog/2023/12/07/star-blizzard-increases-sophistication-and-evasion-in-ongoing-attacks/"
              },
              {
                "url": "https://cofense.com/blog/major-energy-company-targeted-in-large-qr-code-campaign/"
              },
              {
                "url": "https://www.mandiant.com/resources/blog/url-obfuscation-schema-abuse"
              },
              {
                "url": "https://www.orangecyberdefense.com/global/blog/research/residential-proxies"
              },
              {
                "url": "https://github.com/spyboy-productions/Facad1ng"
              },
              {
                "url": "https://sysdig.com/content/c/pf-2023-global-cloud-threat-report?x=u_WFRi&xs=524303#page=1"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1665",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Ingress Tool Transfer",
            "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as <a href=\"https://attack.mitre.org/software/S0095\">ftp</a>. Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. <a href=\"https://attack.mitre.org/techniques/T1570\">Lateral Tool Transfer</a>). \n\nOn Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, <a href=\"https://attack.mitre.org/software/S0160\">certutil</a>, and <a href=\"https://attack.mitre.org/techniques/T1059/001\">PowerShell</a> commands such as <tt>IEX(New-Object Net.WebClient).downloadString()</tt> and <tt>Invoke-WebRequest</tt>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)\n\nAdversaries may also abuse installers and package managers, such as `yum` or `winget`, to download tools to victim hosts. Adversaries have also abused file application features, such as the Windows `search-ms` protocol handler, to deliver malicious files to victims through remote file searches invoked by <a href=\"https://attack.mitre.org/techniques/T1204\">User Execution</a> (typically after interacting with <a href=\"https://attack.mitre.org/techniques/T1566\">Phishing</a> lures).(Citation: T1105: Trellix_search-ms)\n\nFiles can also be transferred using various <a href=\"https://attack.mitre.org/techniques/T1102\">Web Service</a>s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016) In some cases, adversaries may be able to leverage services that sync between a web-based and an on-premises client, such as Dropbox or OneDrive, to transfer files onto victim systems. For example, by compromising a cloud account and logging into the service's web portal, an adversary may be able to trigger an automatic syncing process that transfers the file onto the victim's machine.(Citation: Dropbox Malware Sync)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1105"
              },
              {
                "url": "https://www.trellix.com/blogs/research/beyond-file-search-a-novel-method/"
              },
              {
                "url": "https://www.technologyreview.com/2013/08/21/83143/dropbox-and-similar-services-can-sync-malware/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://lolbas-project.github.io/#t1105"
              },
              {
                "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf"
              }
            ],
            "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as <a href=\"https://attack.mitre.org/software/S0095\">ftp</a>, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Specifically, for the finger utility on Windows and Linux systems, monitor command line or terminal execution for the finger command. Monitor network activity for TCP port 79, which is used by the finger utility, and Windows <tt>netsh interface portproxy</tt> modifications to well-known ports such as 80 and 443. Furthermore, monitor file system for the download/creation and execution of suspicious files, which may indicate adversary-downloaded payloads. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1105",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend in with normal network activity, to avoid more detailed inspection. They may use the protocol associated with the port, or a completely different protocol. They may use commonly open ports, such as the examples provided below. \n \n * TCP:80 (HTTP) \n * TCP:443 (HTTPS) \n * TCP/UDP:53 (DNS) \n * TCP:1024-4999 (OPC on XP/Win2k3) \n * TCP:49152-65535 (OPC on Vista and later) \n * TCP:23 (TELNET) \n * UDP:161 (SNMP) \n * TCP:502 (MODBUS) \n * TCP:102 (S7comm/ISO-TSAP) \n * TCP:20000 (DNP3) \n * TCP:44818 (Ethernet/IP)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0885"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0885",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Standard Application Layer Protocol",
            "description": "Adversaries may establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, RDP, telnet, DNP3, and modbus. These protocols may be used to disguise adversary actions as benign network traffic. Standard protocols may be seen on their associated port or in some cases over a non-standard port.  Adversaries may use these protocols to reach out of the network for command and control, or in some cases to other infected devices within the network.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0869"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0869",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Connection Proxy",
            "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.\n\nThe definition of a proxy can also be expanded to encompass trust relationships between networks in peer-to-peer, mesh, or trusted connections between networks consisting of hosts or systems that regularly communicate with each other.\n\nThe network may be within a single organization or across multiple organizations with trust relationships. Adversaries could use these types of relationships to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. (Citation: Enterprise ATT&CK January 2018)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0884"
              },
              {
                "url": "https://attack.mitre.org/wiki/Technique/T1090"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0884",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Web Service",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. \n\n \n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). \n\n ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "One-Way Communication",
            "description": "Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to a compromised system without receiving return output. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/003"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481.003",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Exfiltration Over Other Network Medium",
            "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a standard Internet connection, the exfiltration may occur, for example, via Bluetooth, or another radio frequency (RF) channel. \n\nAdversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1438"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-30.html"
              }
            ],
            "x_mitre_detection": "Exfiltration over other network mediums can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.",
            "id": "T1438",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Symmetric Cryptography",
            "description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, Blowfish, and RC4.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/001"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1637/001\">Domain Generation Algorithms</a> (DGAs) to procedurally generate domain names for uses such as command and control communication   or malicious application distribution.(Citation: securelist rotexy 2018)\n\nDGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there could potentially be thousands of domains that malware can check for instructions.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1637/001"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names ",
            "id": "T1637.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "SSL Pinning",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a>  to protect the C2 traffic from being intercepted and analyzed.\n\n<a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a>  is a technique commonly utilized by legitimate websites to ensure that encrypted communications are only allowed with a pre-defined certificate. If another certificate is presented, it could indicate device compromise, traffic interception, or another upstream issue. While benign usages are common, it is also possible for adversaries to abuse this technology to protect malicious C2 traffic.\n\nIn normal, not pinned SSL validation, when a client connects to a server using HTTPS, it typically checks whether the server\u2019s SSL/TLS certificate is signed by a trusted Certificate Authority (CA) in the device\u2019s trust store. If the certificate is valid and signed by a trusted CA, the connection is established. However, with <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a> , the client is configured to trust a specific SSL/TLS certificate or public key, rather than relying on the device\u2019s trust store. This means that even if the server\u2019s certificate is signed by a trusted CA, the client will only establish the connection of the certificate or key is pinned.\n\nThere are two types of <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a> :\n\n1.\tCertificate Pinning: The client stores a copy of the server\u2019s certificate and compares it with the certificate received during the SSL handshake. If the certificates match, then the client proceeds with the connection. This approach also works with self-signed certificates.\n\n2.\tPublic Key Pinning: Instead of pinning the entire certificate, the client pins just the public key extracted from the certificate. This is often more flexible, as it allows the server to renew its certificate without having to update the pinned certificate or breaking the SSL connection.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/003"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1521.003",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Dead Drop Resolver",
            "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. \n\n \n\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/001"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application. ",
            "id": "T1481.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Out of Band Data",
            "description": "Adversaries may communicate with compromised devices using out of band data streams. This could be done for a variety of reasons, including evading network traffic monitoring, as a backup method of command and control, or for data exfiltration if the device is not connected to any Internet-providing networks (i.e. cellular or Wi-Fi). Several out of band data streams exist, such as SMS messages, NFC, and Bluetooth. \n\n \n\nOn Android, applications can read push notifications to capture content from SMS messages, or other out of band data streams. This requires that the user manually grant notification access to the application via the settings menu. However, the application could launch an Intent to take the user directly there. \n\n \n\nOn iOS, there is no way to programmatically read push notifications. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1644"
              }
            ],
            "x_mitre_detection": "If a user sees a notification with text they do not recognize, they should review their list of installed applications.",
            "id": "T1644",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Encrypted Channel",
            "description": "Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Ingress Tool Transfer",
            "description": "Adversaries may transfer tools or other files from an external system onto a compromised device to facilitate follow-on actions. Files may be copied from an external adversary-controlled system through the command and control channel  or through alternate protocols with another tool such as FTP.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1544"
              }
            ],
            "x_mitre_detection": "Application vetting services could look for connections to unknown domains or IP addresses. Application vetting services may indicate precisely what content was requested during application execution.",
            "id": "T1544",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Dynamic Resolution",
            "description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. This algorithm can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1637"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different Domain Generation Algorithms (DGAs), constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) Content delivery network (CDN) domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names or rarely visited domains.",
            "id": "T1637",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Web Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with web protocols traffic to avoid detection/network filtering by blending in with existing traffic. Commands to remote mobile devices, and often the results of those commands, will be embedded within the protocol traffic between the mobile client and server. \n\nWeb protocols such as HTTP and HTTPS are used for web traffic as well as well as notification services native to mobile messaging services such as Google Cloud Messaging (GCM) and newly, Firebase Cloud Messaging (FCM), (GCM/FCM: two-way communication) and Apple Push Notification Service (APNS; one-way server-to-device).  Such notification services leverage HTTP/S via the respective API and are commonly abused on Android and iOS respectively in order blend in with routine device traffic making it difficult for enterprises to inspect. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1437/001"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-29.html"
              }
            ],
            "x_mitre_detection": "Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior. ",
            "id": "T1437.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Call Control",
            "description": "Adversaries may make, forward, or block phone calls without user authorization. This could be used for adversary goals such as audio surveillance, blocking or forwarding calls from the device owner, or C2 communication.\n\nSeveral permissions may be used to programmatically control phone calls, including:\n\n* `ANSWER_PHONE_CALLS` - Allows the application to answer incoming phone calls(Citation: Android Permissions)\n* `CALL_PHONE` - Allows the application to initiate a phone call without going through the Dialer interface(Citation: Android Permissions)\n* `PROCESS_OUTGOING_CALLS` - Allows the application to see the number being dialed during an outgoing call with the option to redirect the call to a different number or abort the call altogether(Citation: Android Permissions)\n* `MANAGE_OWN_CALLS` - Allows a calling application which manages its own calls through the self-managed `ConnectionService` APIs(Citation: Android Permissions)\n* `BIND_TELECOM_CONNECTION_SERVICE` - Required permission when using a `ConnectionService`(Citation: Android Permissions)\n* `WRITE_CALL_LOG` - Allows an application to write to the device call log, potentially to hide malicious phone calls(Citation: Android Permissions)\n\nWhen granted some of these permissions, an application can make a phone call without opening the dialer first. However, if an application desires to simply redirect the user to the dialer with a phone number filled in, it can launch an Intent using `Intent.ACTION_DIAL`, which requires no specific permissions. This then requires the user to explicitly initiate the call or use some form of <a href=\"https://attack.mitre.org/techniques/T1516\">Input Injection</a> to programmatically initiate it.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1616"
              },
              {
                "url": "https://developer.android.com/reference/android/Manifest.permission"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-41.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-42.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-36.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-18.html"
              }
            ],
            "x_mitre_detection": "Users can view their default phone app in device settings. Users can review available call logs for irregularities, such as missing or unrecognized calls.",
            "id": "T1616",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Deprecated. Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. \n\nThey may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1436"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1436",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Remote Access Software",
            "description": "Adversaries may use legitimate remote access software, such as `VNC`, `TeamViewer`, `AirDroid`, `AirMirror`, etc., to establish an interactive command and control channel to target mobile devices.  \n\nRemote access applications may be installed and used post-compromise as an alternate communication channel for redundant access or as a way to establish an interactive remote session with the target device. They may also be used as a component of malware to establish a reverse connection to an adversary-controlled system or service. Installation of remote access tools may also include persistence.  ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1663"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1663",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Asymmetric Cryptography",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private that should not be distributed. Due to how asymmetric algorithms work, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA, ElGamal, and ECDSA.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as <a href=\"https://attack.mitre.org/techniques/T1521/002\">Asymmetric Cryptography</a>.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/002"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521.002",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Bidirectional Communication",
            "description": "Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to and receiving output from a compromised system. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/002"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481.002",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Non-Standard Port",
            "description": "Adversaries may generate network traffic using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088 or port 587 as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1509"
              }
            ],
            "x_mitre_detection": "Application vetting reports may show network communications performed by the application, including hosts, ports, protocols, and URLs. Further detection would most likely be at the enterprise level, through packet and/or netflow inspection. Many properly configured firewalls may also naturally block command and control traffic over non-standard ports.",
            "id": "T1509",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1520\">Domain Generation Algorithms</a> (DGAs) to procedurally generate domain names for command and control communication, and other uses such as malicious application distribution.(Citation: securelist rotexy 2018)\n\nDGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1520"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.",
            "id": "T1520",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Application Layer Protocol",
            "description": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the mobile device, and often the results of those commands, will be embedded within the protocol traffic between the mobile device and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1437"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-29.html"
              }
            ],
            "x_mitre_detection": "Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior.",
            "id": "T1437",
            "collection": "Mobile ATT&CK"
          }
        ]
      },
      {
        "name": "Command and Control",
        "id": "TA0101",
        "ref": "https://attack.mitre.org/tactics/TA0101",
        "collection": "ICS ATT&CK",
        "mitre_techniques": [
          {
            "name": "Socket Filters",
            "description": "Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as the `libpcap` library to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell.\n\nTo establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria.(Citation: haking9 libpcap network sniffing) Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction with <a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a>.(Citation: exatrack bpf filters passive backdoors)(Citation: Leonardo Turla Penquin May 2020)\n\nFilters can be installed on any Unix-like platform with `libpcap` installed or on Windows hosts using `Winpcap`.  Adversaries may use either `libpcap` with `pcap_setfilter` or the standard library function `setsockopt` with `SO_ATTACH_FILTER` options. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205/002"
              },
              {
                "url": "https://exatrack.com/public/Tricephalic_Hellkeeper.pdf"
              },
              {
                "url": "https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/"
              },
              {
                "url": "https://www.leonardo.com/documents/20142/10868623/Malware+Technical+Insight+_Turla+%E2%80%9CPenquin_x64%E2%80%9D.pdf"
              },
              {
                "url": "http://recursos.aldabaknocking.com/libpcapHakin9LuisMartinGarcia.pdf"
              }
            ],
            "x_mitre_detection": "Identify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.(Citation: crowdstrike bpf socket filters)",
            "id": "T1205.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Standard Encoding",
            "description": "Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding)(Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1132.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Proxy",
            "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.\n\nAdversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nConsider monitoring for traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>).",
            "id": "T1090",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-hop Proxy",
            "description": "To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1188"
              }
            ],
            "x_mitre_detection": "When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>) or known adversary infrastructure that uses this technique.",
            "id": "T1188",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Dynamic Resolution",
            "description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.\n\nAdversaries may use dynamic resolution for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated C2 can be challenging due to the number of different algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are multiple approaches to detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more (Citation: Data Driven Security DGA). CDN domains may trigger these detections due to the format of their domain names. In addition to detecting algorithm generated domains based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.",
            "id": "T1568",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "External Proxy",
            "description": "Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion.\n\nExternal connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows, such as a client sending significantly more data than it receives from an external server. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1090.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Communication Through Removable Media",
            "description": "Adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system.(Citation: ESET Sednit USBStealer 2014) Both systems would need to be compromised, with the likelihood that an Internet-connected system was compromised first and the second through lateral movement by <a href=\"https://attack.mitre.org/techniques/T1091\">Replication Through Removable Media</a>. Commands and files would be relayed from the disconnected system to the Internet-connected system to which the adversary has direct access.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1092"
              },
              {
                "url": "http://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/"
              }
            ],
            "x_mitre_detection": "Monitor file access on removable media. Detect processes that execute when removable media is mounted.",
            "id": "T1092",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "One-Way Communication",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to a compromised system without receiving return output over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/003"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "File Transfer Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMB(Citation: US-CERT TA18-074A), FTP(Citation: ESET Machete July 2019), FTPS, and TFTP that transfer files may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/002"
              },
              {
                "url": "https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1071.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multiband Communication",
            "description": "Deprecated. **This technique has been deprecated and should no longer be used.**\n\nSome adversaries may split communications between different protocols. There could be one protocol for inbound command and control and another for outbound data, allowing it to bypass certain firewall restrictions. The split could also be random to simply avoid data threshold alerts on any one communication.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1026"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2) Correlating alerts between multiple communication channels can further help identify command-and-control behavior.",
            "id": "T1026",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Standard Port",
            "description": "Adversaries may communicate using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.\n\nAdversaries may also make changes to victim systems to abuse non-standard ports. For example, Registry keys and other configuration settings can be used to modify protocol and port pairings.(Citation: change_rdp_port_conti)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1571"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage"
              },
              {
                "url": "https://x.com/TheDFIRReport/status/1498657772254240768"
              },
              {
                "url": "https://www.fortinet.com/blog/threat-research/analysis-of-new-agent-tesla-spyware-variant.html"
              }
            ],
            "x_mitre_detection": "Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2)",
            "id": "T1571",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Data Obfuscation",
            "description": "Adversaries may obfuscate command and control traffic to make it more difficult to detect.(Citation: Bitdefender FunnyDream Campaign November 2020) Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.bitdefender.com/files/News/CaseStudies/study/379/Bitdefender-Whitepaper-Chinese-APT.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-hop Proxy",
            "description": "Adversaries may chain together multiple proxies to disguise the source of malicious traffic. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.\n\nFor example, adversaries may construct or use onion routing networks \u2013 such as the publicly available <a href=\"https://attack.mitre.org/software/S0183\">Tor</a> network \u2013 to transport encrypted C2 traffic through a compromised population, allowing communication with any device within the network.(Citation: Onion Routing) Adversaries may also use operational relay box (ORB) networks composed of virtual private servers (VPS), Internet of Things (IoT) devices, smart devices, and end-of-life routers to obfuscate their operations. (Citation: ORB Mandiant) \n\nIn the case of network infrastructure, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain (i.e., <a href=\"https://attack.mitre.org/techniques/T1584/008\">Network Devices</a>). By leveraging <a href=\"https://attack.mitre.org/techniques/T1601/001\">Patch System Image</a> on routers, adversaries can add custom code to the affected network devices that will implement onion routing between those nodes. This method is dependent upon the <a href=\"https://attack.mitre.org/techniques/T1599\">Network Boundary Bridging</a> method allowing the adversaries to cross the protected network boundary of the Internet perimeter and into the organization\u2019s Wide-Area Network (WAN).  Protocols such as ICMP may be used as a transport.  \n\nSimilarly, adversaries may abuse peer-to-peer (P2P) and blockchain-oriented infrastructure to implement routing between a decentralized network of peers.(Citation: NGLite Trojan)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/003"
              },
              {
                "url": "https://cloud.google.com/blog/topics/threat-intelligence/china-nexus-espionage-orb-networks"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Onion_routing"
              }
            ],
            "x_mitre_detection": "When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>) or known adversary infrastructure that uses this technique.\n\nIn context of network devices, monitor traffic for encrypted communications from the Internet that is addressed to border routers.  Compare this traffic with the configuration to determine whether it matches with any configured site-to-site Virtual Private Network (VPN) connections the device was intended to have. Monitor traffic for encrypted communications originating from potentially breached routers that is addressed to other routers within the organization.  Compare the source and destination with the configuration of the device to determine if these channels are an authorized Virtual Private Network (VPN) connections or other encrypted modes of communication. Monitor ICMP traffic from the Internet that is addressed to border routers and is encrypted.  Few if any legitimate use cases exist for sending encrypted data to a network device via ICMP.",
            "id": "T1090.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Port Knocking",
            "description": "Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.\n\nThis technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205/001"
              },
              {
                "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"
              }
            ],
            "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.",
            "id": "T1205.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-Stage Channels",
            "description": "Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult.\n\nRemote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features.\n\nThe different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a> in case the original first-stage communication path is discovered and blocked.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1104"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure. Relating subsequent actions that may result from Discovery of the system and network information or Lateral Movement to the originating process may also yield useful data.",
            "id": "T1104",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "DNS Calculation",
            "description": "Adversaries may perform calculations on addresses returned in DNS results to determine which port and IP address to use for command and control, rather than relying on a predetermined port number or the actual returned IP address. A IP and/or port number calculation can be used to bypass egress filtering on a C2 channel.(Citation: Meyers Numbered Panda)\n\nOne implementation of <a href=\"https://attack.mitre.org/techniques/T1568/003\">DNS Calculation</a> is to take the first three octets of an IP address in a DNS response and use those values to calculate the port for command and control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/003"
              },
              {
                "url": "http://www.crowdstrike.com/blog/whois-numbered-panda/"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2014/09/darwins-favorite-apt-group-2.html"
              },
              {
                "url": "https://blog.rapid7.com/2013/08/26/upcoming-g20-summit-fuels-espionage-operations/"
              }
            ],
            "x_mitre_detection": "Detection for this technique is difficult because it would require knowledge of the specific implementation of the port calculation algorithm. Detection may be possible by analyzing DNS records if the algorithm is known.",
            "id": "T1568.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Web Service",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites, cloud services, and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google, Microsoft, or Twitter, makes it easier for adversaries to hide in expected noise.(Citation: Broadcom BirdyClient Microsoft Graph API 2024) Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102"
              },
              {
                "url": "https://www.broadcom.com/support/security-center/protection-bulletin/birdyclient-malware-leverages-microsoft-graph-api-for-c-c-communication"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Symmetric Cryptography",
            "description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "With symmetric encryption, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures.\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Publish/Subscribe Protocols",
            "description": "Adversaries may communicate using publish/subscribe (pub/sub) application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as <tt>MQTT</tt>, <tt>XMPP</tt>, <tt>AMQP</tt>, and <tt>STOMP</tt> use a publish/subscribe design, with message distribution managed by a centralized broker.(Citation: wailing crab sub/pub)(Citation: Mandiant APT1 Appendix) Publishers categorize their messages by topics, while subscribers receive messages according to their subscribed topics.(Citation: wailing crab sub/pub) An adversary may abuse publish/subscribe protocols to communicate with systems under their control from behind a message broker while also mimicking normal, expected traffic.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/005"
              },
              {
                "url": "https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/"
              },
              {
                "url": "https://www.mandiant.com/sites/default/files/2021-09/mandiant-apt1-report.pdf"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1071.005",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Fast Flux DNS",
            "description": "Adversaries may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution. This technique uses a fully qualified domain name, with multiple IP addresses assigned to it which are swapped with high frequency, using a combination of round robin IP addressing and short Time-To-Live (TTL) for a DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity)\n\nThe simplest, \"single-flux\" method, involves registering and de-registering an addresses as part of the DNS A (address) record list for a single DNS name. These registrations have a five-minute average lifespan, resulting in a constant shuffle of IP address resolution.(Citation: Fast Flux - Welivesecurity)\n\nIn contrast, the \"double-flux\" method registers and de-registers an address as part of the DNS Name Server record list for the DNS zone, providing additional resilience for the connection. With double-flux additional hosts can act as a proxy to the C2 host, further insulating the true source of the C2 channel.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/001"
              },
              {
                "url": "https://resources.infosecinstitute.com/fast-flux-networks-working-detection-part-1/#gref"
              },
              {
                "url": "https://resources.infosecinstitute.com/fast-flux-networks-working-detection-part-2/#gref"
              },
              {
                "url": "https://www.welivesecurity.com/2017/01/12/fast-flux-networks-work/"
              }
            ],
            "x_mitre_detection": "In general, detecting usage of fast flux DNS is difficult due to web traffic load balancing that services client requests quickly. In single flux cases only IP addresses change for static domain names. In double flux cases, nothing is static. Defenders such as domain registrars and service providers are likely in the best position for detection.",
            "id": "T1568.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/002"
              },
              {
                "url": "https://arxiv.org/pdf/1611.00791.pdf"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://medium.com/@yvyuz/a-death-match-of-domain-generation-algorithms-a5b5dbdc1c6e"
              },
              {
                "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"
              },
              {
                "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain is related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)",
            "id": "T1568.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Fronting",
            "description": "Domain fronting takes advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) The technique involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).\n\nFor example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1172"
              },
              {
                "url": "http://www.icir.org/vern/papers/meek-PETS-2015.pdf"
              }
            ],
            "x_mitre_detection": "If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blacklist or whitelist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)",
            "id": "T1172",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "DNS",
            "description": "Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nThe DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/004"
              },
              {
                "url": "https://medium.com/@galolbardes/learn-how-easy-is-to-bypass-firewalls-using-dns-tunneling-and-also-how-to-block-it-3ed652f4a000"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.paloaltonetworks.com/cyberpedia/what-is-dns-tunneling"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for DNS traffic to/from known-bad or suspicious domains.",
            "id": "T1071.004",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Standard Cryptographic Protocol",
            "description": "Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1032"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels. (Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation. (Citation: SEI SSL Inspection Risks)\n\nIf malware uses encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1032",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Traffic Signaling",
            "description": "Adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e. <a href=\"https://attack.mitre.org/techniques/T1205/001\">Port Knocking</a>), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software.\n\nAdversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s).\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.\n\nOn network devices, adversaries may use crafted packets to enable <a href=\"https://attack.mitre.org/techniques/T1556/004\">Network Device Authentication</a> for standard services offered by the device such as telnet.  Such signaling may also be used to open a closed service port such as telnet, or to trigger module modification of malware implants on the device, adding, removing, or changing malicious capabilities.  Adversaries may use crafted packets to attempt to connect to one or more (open or closed) ports, but may also attempt to connect to a router interface, broadcast, and network address IP on the same port in order to achieve their goals and objectives.(Citation: Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco Blog Legacy Device Attacks)  To enable this traffic signaling on embedded devices, adversaries must first achieve and leverage <a href=\"https://attack.mitre.org/techniques/T1601/001\">Patch System Image</a> due to the monolithic nature of the architecture.\n\nAdversaries may also use the Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware feature that allows a powered down system to be powered on, or woken up, by sending a magic packet to it. Once the system is powered on, it may become a target for lateral movement.(Citation: Bleeping Computer - Ryuk WoL)(Citation: AMD Magic Packet)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205"
              },
              {
                "url": "https://www.bleepingcomputer.com/news/security/ryuk-ransomware-uses-wake-on-lan-to-encrypt-offline-devices/"
              },
              {
                "url": "https://www.amd.com/system/files/TechDocs/20213.pdf"
              },
              {
                "url": "https://www.mandiant.com/resources/synful-knock-acis"
              },
              {
                "url": "https://blogs.cisco.com/security/evolution-of-attacks-on-cisco-ios-devices"
              },
              {
                "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"
              },
              {
                "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
              },
              {
                "url": "https://gitlab.com/wireshark/wireshark/-/wikis/WakeOnLAN"
              }
            ],
            "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.\n\nThe Wake-on-LAN magic packet consists of 6 bytes of <tt>FF</tt> followed by sixteen repetitions of the target system's IEEE address. Seeing this string anywhere in a packet's payload may be indicative of a Wake-on-LAN attempt.(Citation: GitLab WakeOnLAN)",
            "id": "T1205",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Content Injection",
            "description": "Adversaries may gain access and continuously communicate with victims by injecting malicious content into systems through online network traffic. Rather than luring victims to malicious payloads hosted on a compromised website (i.e., <a href=\"https://attack.mitre.org/techniques/T1608/004\">Drive-by Target</a> followed by <a href=\"https://attack.mitre.org/techniques/T1189\">Drive-by Compromise</a>), adversaries may initially access victims through compromised data-transfer channels where they can manipulate traffic and/or inject their own content. These compromised online network channels may also be used to deliver additional payloads (i.e., <a href=\"https://attack.mitre.org/techniques/T1105\">Ingress Tool Transfer</a>) and other data to already compromised systems.(Citation: ESET MoustachedBouncer)\n\nAdversaries may inject content to victim systems in various ways, including:\n\n* From the middle, where the adversary is in-between legitimate online client-server communications (**Note:** this is similar but distinct from <a href=\"https://attack.mitre.org/techniques/T1557\">Adversary-in-the-Middle</a>, which describes AiTM activity solely within an enterprise environment) (Citation: Kaspersky Encyclopedia MiTM)\n* From the side, where malicious content is injected and races to the client as a fake response to requests of a legitimate online server (Citation: Kaspersky ManOnTheSide)\n\nContent injection is often the result of compromised upstream communication channels, for example at the level of an internet service provider (ISP) as is the case with \"lawful interception.\"(Citation: Kaspersky ManOnTheSide)(Citation: ESET MoustachedBouncer)(Citation: EFF China GitHub Attack)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1659"
              },
              {
                "url": "https://www.eff.org/deeplinks/2015/04/china-uses-unencrypted-websites-to-hijack-browsers-in-github-attack"
              },
              {
                "url": "https://www.welivesecurity.com/en/eset-research/moustachedbouncer-espionage-against-foreign-diplomats-in-belarus/"
              },
              {
                "url": "https://encyclopedia.kaspersky.com/glossary/man-in-the-middle-attack/"
              },
              {
                "url": "https://usa.kaspersky.com/blog/man-on-the-side/27854/"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1659",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Mail Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: FireEye APT28) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/003"
              },
              {
                "url": "https://web.archive.org/web/20151022204649/https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1071.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1483"
              },
              {
                "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"
              },
              {
                "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "https://blogs.akamai.com/2018/01/a-death-match-of-domain-generation-algorithms.html"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"
              },
              {
                "url": "https://arxiv.org/pdf/1611.00791.pdf"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain or related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)",
            "id": "T1483",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Protocol Tunneling",
            "description": "Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. \n\nThere are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling) \n\n<a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a> may also be abused by adversaries during <a href=\"https://attack.mitre.org/techniques/T1568\">Dynamic Resolution</a>. Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) \n\nAdversaries may also leverage <a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a> in conjunction with <a href=\"https://attack.mitre.org/techniques/T1090\">Proxy</a> and/or <a href=\"https://attack.mitre.org/techniques/T1001/003\">Protocol Impersonation</a> to further conceal C2 communications and infrastructure. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1572"
              },
              {
                "url": "https://www.ssh.com/ssh/tunneling"
              },
              {
                "url": "https://www.bleepingcomputer.com/news/security/new-godlua-malware-evades-traffic-monitoring-via-dns-over-https/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Monitoring for systems listening and/or establishing external connections using ports/protocols commonly associated with tunneling, such as SSH (port 22). Also monitor for processes commonly associated with tunneling, such as Plink and the OpenSSH client. \n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1572",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Application Layer Protocol",
            "description": "Adversaries may communicate using OSI application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, DNS, or publishing/subscribing. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.(Citation: Mandiant APT29 Eye Spy Email Nov 22) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.mandiant.com/resources/blog/unc3524-eye-spy-email"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1071",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multilayer Encryption",
            "description": "An adversary performs C2 communications using multiple layers of encryption, typically (but not exclusively) tunneling a custom encryption scheme within a protocol encryption scheme such as HTTPS or SMTPS.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1079"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "If malware uses <a href=\"https://attack.mitre.org/techniques/T1032\">Standard Cryptographic Protocol</a>, SSL/TLS inspection can be used to detect command and control traffic within some encrypted communication channels. (Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation. (Citation: SEI SSL Inspection Risks) After SSL/TLS inspection, additional cryptographic analysis may be needed to analyze the second layer of encryption.\n\nWith <a href=\"https://attack.mitre.org/techniques/T1024\">Custom Cryptographic Protocol</a>, if malware uses encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1079",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Remote Access Software",
            "description": "An adversary may use legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks. These services, such as `VNC`, `Team Viewer`, `AnyDesk`, `ScreenConnect`, `LogMein`, `AmmyyAdmin`, and other remote monitoring and management (RMM) tools, are commonly used as legitimate technical support software and may be allowed by application control within a target environment.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy)\n\nRemote access software may be installed and used post-compromise as an alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary-controlled system.\n \nAdversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.\n\nInstallation of many remote access software may also include persistence (e.g., the software's installation routine creates a <a href=\"https://attack.mitre.org/techniques/T1543/003\">Windows Service</a>). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome\u2019s Remote Desktop).(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1219"
              },
              {
                "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/15GlobalThreatReport.pdf"
              },
              {
                "url": "https://blog.crysys.hu/2013/03/teamspy/"
              },
              {
                "url": "https://support.google.com/chrome/answer/1649523"
              },
              {
                "url": "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
              },
              {
                "url": "https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-living-off-the-land-and-fileless-attack-techniques-en.pdf"
              }
            ],
            "x_mitre_detection": "Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\n\n<a href=\"https://attack.mitre.org/techniques/T1090/004\">Domain Fronting</a> may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.",
            "id": "T1219",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Custom Cryptographic Protocol",
            "description": "Adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic. A simple scheme, such as XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.\n\nCustom encryption schemes may vary in sophistication. Analysis and reverse engineering of malware samples may be enough to discover the algorithm and encryption key used.\n\nSome adversaries may also attempt to implement their own version of a well-known cryptographic algorithm instead of using a known implementation library, which may lead to unintentional errors. (Citation: F-Secure Cosmicduke)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1024"
              },
              {
                "url": "https://blog.f-secure.com/wp-content/uploads/2019/10/CosmicDuke.pdf"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "If malware uses custom encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect when communications do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1024",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Data Encoding",
            "description": "Adversaries may encode data to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system. Use of data encoding may adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64, MIME, or other binary-to-text and character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1132",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Fronting",
            "description": "Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).\n\nFor example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/004"
              },
              {
                "url": "http://www.icir.org/vern/papers/meek-PETS-2015.pdf"
              }
            ],
            "x_mitre_detection": "If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blocklist or allowlist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)",
            "id": "T1090.004",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Uncommonly Used Port",
            "description": "Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1065"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1065",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Encrypted Channel",
            "description": "Adversaries may employ an encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Protocol or Service Impersonation",
            "description": "Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.  \n\nAdversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. \n\nAdversaries may also leverage legitimate protocols to impersonate expected web traffic or trusted services. For example, adversaries may manipulate HTTP headers, URI endpoints, SSL certificates, and transmitted data to disguise C2 communications or mimic legitimate services such as Gmail, Google Drive, and Yahoo Messenger.(Citation: ESET Okrum July 2019)(Citation: Malleable-C2-U42)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/003"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/cobalt-strike-malleable-c2-profile/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Application Layer Protocol",
            "description": "Adversaries may use an OSI non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).\n\nICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution) Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.(Citation: Microsoft ICMP) However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1095"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://blogs.cisco.com/security/evolution-of-attacks-on-cisco-ios-devices"
              },
              {
                "url": "http://support.microsoft.com/KB/170292"
              },
              {
                "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
              },
              {
                "url": "http://en.wikipedia.org/wiki/List_of_network_protocols_%28OSI_model%29"
              }
            ],
            "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.(Citation: Cisco Blog Legacy Device Attacks)\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2) \n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.",
            "id": "T1095",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Asymmetric Cryptography",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as <a href=\"https://attack.mitre.org/techniques/T1573/002\">Asymmetric Cryptography</a>.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573/002"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Bidirectional Communication",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. \n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Fallback Channels",
            "description": "Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1008"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1008",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Steganography",
            "description": "Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Standard Encoding",
            "description": "Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132/002"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1132.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Deprecated. **This technique has been deprecated. Please use <a href=\"https://attack.mitre.org/techniques/T1571\">Non-Standard Port</a> where appropriate.**\n\nAdversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1043"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1043",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Junk Data",
            "description": "Adversaries may add junk data to protocols used for command and control to make detection more difficult.(Citation: FireEye SUNBURST Backdoor December 2020) By adding random or meaningless data to the protocols used for command and control, adversaries can prevent trivial methods for decoding, deciphering, or otherwise analyzing the traffic. Examples may include appending/prepending data with junk characters or writing junk characters between significant characters. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/001"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Dead Drop Resolver",
            "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Custom Command and Control Protocol",
            "description": "Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing <a href=\"https://attack.mitre.org/techniques/T1071\">Application Layer Protocol</a>. Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1094"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.",
            "id": "T1094",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Internal Proxy",
            "description": "Adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command and control communications inside a compromised environment, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between infected systems to avoid suspicion. Internal proxy connections may use common peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with the environment.\n\nBy using a compromised internal system as a proxy, adversaries may conceal the true destination of C2 traffic while reducing the need for numerous connections to external systems.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows between clients that should not or often do not communicate with one another. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1090.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Web Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as HTTP/S(Citation: CrowdStrike Putter Panda) and WebSocket(Citation: Brazking-Websockets) that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/001"
              },
              {
                "url": "http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://securityintelligence.com/posts/brazking-android-malware-upgraded-targeting-brazilian-banks/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for web traffic to/from known-bad or suspicious domains. ",
            "id": "T1071.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Hide Infrastructure",
            "description": "Adversaries may manipulate network traffic in order to hide and evade detection of their C2 infrastructure. This can be accomplished in various ways including by identifying and filtering traffic from defensive tools,(Citation: TA571) masking malicious domains to obfuscate the true destination from both automated scanning tools and security researchers,(Citation: Schema-abuse)(Citation: Facad1ng)(Citation: Browser-updates) and otherwise hiding malicious artifacts to delay discovery and prolong the effectiveness of adversary infrastructure that could otherwise be identified, blocked, or taken down entirely.\n\nC2 networks may include the use of <a href=\"https://attack.mitre.org/techniques/T1090\">Proxy</a> or VPNs to disguise IP addresses, which can allow adversaries to blend in with normal network traffic and bypass conditional access policies or anti-abuse protections. For example, an adversary may use a virtual private cloud to spoof their IP address to closer align with a victim's IP address ranges. This may also bypass security measures relying on geolocation of the source IP address.(Citation: sysdig)(Citation: Orange Residential Proxies)\n\nAdversaries may also attempt to filter network traffic in order to evade defensive tools in numerous ways, including blocking/redirecting common incident responder or security appliance user agents.(Citation: mod_rewrite)(Citation: SocGholish-update) Filtering traffic based on IP and geo-fencing may also avoid automated sandboxing or researcher activity (i.e., <a href=\"https://attack.mitre.org/techniques/T1497\">Virtualization/Sandbox Evasion</a>).(Citation: TA571)(Citation: mod_rewrite)\n\nHiding C2 infrastructure may also be supported by <a href=\"https://attack.mitre.org/tactics/TA0042\">Resource Development</a> activities such as <a href=\"https://attack.mitre.org/techniques/T1583\">Acquire Infrastructure</a> and <a href=\"https://attack.mitre.org/techniques/T1584\">Compromise Infrastructure</a>. For example, using widely trusted hosting services or domains such as prominent URL shortening providers or marketing services for C2 networks may enable adversaries to present benign content that later redirects victims to malicious web pages or infrastructure once specific conditions are met.(Citation: StarBlizzard)(Citation: QR-cofense)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1665"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/part-1-socgholish-very-real-threat-very-fake-update"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/security-brief-ta571-delivers-icedid-forked-loader"
              },
              {
                "url": "https://bluescreenofjeff.com/2016-04-12-combatting-incident-responders-with-apache-mod_rewrite/"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/are-you-sure-your-browser-date-current-landscape-fake-browser-updates"
              },
              {
                "url": "https://www.microsoft.com/en-us/security/blog/2023/12/07/star-blizzard-increases-sophistication-and-evasion-in-ongoing-attacks/"
              },
              {
                "url": "https://cofense.com/blog/major-energy-company-targeted-in-large-qr-code-campaign/"
              },
              {
                "url": "https://www.mandiant.com/resources/blog/url-obfuscation-schema-abuse"
              },
              {
                "url": "https://www.orangecyberdefense.com/global/blog/research/residential-proxies"
              },
              {
                "url": "https://github.com/spyboy-productions/Facad1ng"
              },
              {
                "url": "https://sysdig.com/content/c/pf-2023-global-cloud-threat-report?x=u_WFRi&xs=524303#page=1"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1665",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Ingress Tool Transfer",
            "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as <a href=\"https://attack.mitre.org/software/S0095\">ftp</a>. Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. <a href=\"https://attack.mitre.org/techniques/T1570\">Lateral Tool Transfer</a>). \n\nOn Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, <a href=\"https://attack.mitre.org/software/S0160\">certutil</a>, and <a href=\"https://attack.mitre.org/techniques/T1059/001\">PowerShell</a> commands such as <tt>IEX(New-Object Net.WebClient).downloadString()</tt> and <tt>Invoke-WebRequest</tt>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)\n\nAdversaries may also abuse installers and package managers, such as `yum` or `winget`, to download tools to victim hosts. Adversaries have also abused file application features, such as the Windows `search-ms` protocol handler, to deliver malicious files to victims through remote file searches invoked by <a href=\"https://attack.mitre.org/techniques/T1204\">User Execution</a> (typically after interacting with <a href=\"https://attack.mitre.org/techniques/T1566\">Phishing</a> lures).(Citation: T1105: Trellix_search-ms)\n\nFiles can also be transferred using various <a href=\"https://attack.mitre.org/techniques/T1102\">Web Service</a>s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016) In some cases, adversaries may be able to leverage services that sync between a web-based and an on-premises client, such as Dropbox or OneDrive, to transfer files onto victim systems. For example, by compromising a cloud account and logging into the service's web portal, an adversary may be able to trigger an automatic syncing process that transfers the file onto the victim's machine.(Citation: Dropbox Malware Sync)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1105"
              },
              {
                "url": "https://www.trellix.com/blogs/research/beyond-file-search-a-novel-method/"
              },
              {
                "url": "https://www.technologyreview.com/2013/08/21/83143/dropbox-and-similar-services-can-sync-malware/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://lolbas-project.github.io/#t1105"
              },
              {
                "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf"
              }
            ],
            "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as <a href=\"https://attack.mitre.org/software/S0095\">ftp</a>, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Specifically, for the finger utility on Windows and Linux systems, monitor command line or terminal execution for the finger command. Monitor network activity for TCP port 79, which is used by the finger utility, and Windows <tt>netsh interface portproxy</tt> modifications to well-known ports such as 80 and 443. Furthermore, monitor file system for the download/creation and execution of suspicious files, which may indicate adversary-downloaded payloads. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1105",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend in with normal network activity, to avoid more detailed inspection. They may use the protocol associated with the port, or a completely different protocol. They may use commonly open ports, such as the examples provided below. \n \n * TCP:80 (HTTP) \n * TCP:443 (HTTPS) \n * TCP/UDP:53 (DNS) \n * TCP:1024-4999 (OPC on XP/Win2k3) \n * TCP:49152-65535 (OPC on Vista and later) \n * TCP:23 (TELNET) \n * UDP:161 (SNMP) \n * TCP:502 (MODBUS) \n * TCP:102 (S7comm/ISO-TSAP) \n * TCP:20000 (DNP3) \n * TCP:44818 (Ethernet/IP)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0885"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0885",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Standard Application Layer Protocol",
            "description": "Adversaries may establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, RDP, telnet, DNP3, and modbus. These protocols may be used to disguise adversary actions as benign network traffic. Standard protocols may be seen on their associated port or in some cases over a non-standard port.  Adversaries may use these protocols to reach out of the network for command and control, or in some cases to other infected devices within the network.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0869"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0869",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Connection Proxy",
            "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.\n\nThe definition of a proxy can also be expanded to encompass trust relationships between networks in peer-to-peer, mesh, or trusted connections between networks consisting of hosts or systems that regularly communicate with each other.\n\nThe network may be within a single organization or across multiple organizations with trust relationships. Adversaries could use these types of relationships to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. (Citation: Enterprise ATT&CK January 2018)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0884"
              },
              {
                "url": "https://attack.mitre.org/wiki/Technique/T1090"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0884",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Web Service",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. \n\n \n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). \n\n ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "One-Way Communication",
            "description": "Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to a compromised system without receiving return output. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/003"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481.003",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Exfiltration Over Other Network Medium",
            "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a standard Internet connection, the exfiltration may occur, for example, via Bluetooth, or another radio frequency (RF) channel. \n\nAdversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1438"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-30.html"
              }
            ],
            "x_mitre_detection": "Exfiltration over other network mediums can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.",
            "id": "T1438",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Symmetric Cryptography",
            "description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, Blowfish, and RC4.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/001"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1637/001\">Domain Generation Algorithms</a> (DGAs) to procedurally generate domain names for uses such as command and control communication   or malicious application distribution.(Citation: securelist rotexy 2018)\n\nDGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there could potentially be thousands of domains that malware can check for instructions.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1637/001"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names ",
            "id": "T1637.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "SSL Pinning",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a>  to protect the C2 traffic from being intercepted and analyzed.\n\n<a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a>  is a technique commonly utilized by legitimate websites to ensure that encrypted communications are only allowed with a pre-defined certificate. If another certificate is presented, it could indicate device compromise, traffic interception, or another upstream issue. While benign usages are common, it is also possible for adversaries to abuse this technology to protect malicious C2 traffic.\n\nIn normal, not pinned SSL validation, when a client connects to a server using HTTPS, it typically checks whether the server\u2019s SSL/TLS certificate is signed by a trusted Certificate Authority (CA) in the device\u2019s trust store. If the certificate is valid and signed by a trusted CA, the connection is established. However, with <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a> , the client is configured to trust a specific SSL/TLS certificate or public key, rather than relying on the device\u2019s trust store. This means that even if the server\u2019s certificate is signed by a trusted CA, the client will only establish the connection of the certificate or key is pinned.\n\nThere are two types of <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a> :\n\n1.\tCertificate Pinning: The client stores a copy of the server\u2019s certificate and compares it with the certificate received during the SSL handshake. If the certificates match, then the client proceeds with the connection. This approach also works with self-signed certificates.\n\n2.\tPublic Key Pinning: Instead of pinning the entire certificate, the client pins just the public key extracted from the certificate. This is often more flexible, as it allows the server to renew its certificate without having to update the pinned certificate or breaking the SSL connection.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/003"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1521.003",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Dead Drop Resolver",
            "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. \n\n \n\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/001"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application. ",
            "id": "T1481.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Out of Band Data",
            "description": "Adversaries may communicate with compromised devices using out of band data streams. This could be done for a variety of reasons, including evading network traffic monitoring, as a backup method of command and control, or for data exfiltration if the device is not connected to any Internet-providing networks (i.e. cellular or Wi-Fi). Several out of band data streams exist, such as SMS messages, NFC, and Bluetooth. \n\n \n\nOn Android, applications can read push notifications to capture content from SMS messages, or other out of band data streams. This requires that the user manually grant notification access to the application via the settings menu. However, the application could launch an Intent to take the user directly there. \n\n \n\nOn iOS, there is no way to programmatically read push notifications. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1644"
              }
            ],
            "x_mitre_detection": "If a user sees a notification with text they do not recognize, they should review their list of installed applications.",
            "id": "T1644",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Encrypted Channel",
            "description": "Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Ingress Tool Transfer",
            "description": "Adversaries may transfer tools or other files from an external system onto a compromised device to facilitate follow-on actions. Files may be copied from an external adversary-controlled system through the command and control channel  or through alternate protocols with another tool such as FTP.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1544"
              }
            ],
            "x_mitre_detection": "Application vetting services could look for connections to unknown domains or IP addresses. Application vetting services may indicate precisely what content was requested during application execution.",
            "id": "T1544",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Dynamic Resolution",
            "description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. This algorithm can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1637"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different Domain Generation Algorithms (DGAs), constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) Content delivery network (CDN) domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names or rarely visited domains.",
            "id": "T1637",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Web Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with web protocols traffic to avoid detection/network filtering by blending in with existing traffic. Commands to remote mobile devices, and often the results of those commands, will be embedded within the protocol traffic between the mobile client and server. \n\nWeb protocols such as HTTP and HTTPS are used for web traffic as well as well as notification services native to mobile messaging services such as Google Cloud Messaging (GCM) and newly, Firebase Cloud Messaging (FCM), (GCM/FCM: two-way communication) and Apple Push Notification Service (APNS; one-way server-to-device).  Such notification services leverage HTTP/S via the respective API and are commonly abused on Android and iOS respectively in order blend in with routine device traffic making it difficult for enterprises to inspect. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1437/001"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-29.html"
              }
            ],
            "x_mitre_detection": "Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior. ",
            "id": "T1437.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Call Control",
            "description": "Adversaries may make, forward, or block phone calls without user authorization. This could be used for adversary goals such as audio surveillance, blocking or forwarding calls from the device owner, or C2 communication.\n\nSeveral permissions may be used to programmatically control phone calls, including:\n\n* `ANSWER_PHONE_CALLS` - Allows the application to answer incoming phone calls(Citation: Android Permissions)\n* `CALL_PHONE` - Allows the application to initiate a phone call without going through the Dialer interface(Citation: Android Permissions)\n* `PROCESS_OUTGOING_CALLS` - Allows the application to see the number being dialed during an outgoing call with the option to redirect the call to a different number or abort the call altogether(Citation: Android Permissions)\n* `MANAGE_OWN_CALLS` - Allows a calling application which manages its own calls through the self-managed `ConnectionService` APIs(Citation: Android Permissions)\n* `BIND_TELECOM_CONNECTION_SERVICE` - Required permission when using a `ConnectionService`(Citation: Android Permissions)\n* `WRITE_CALL_LOG` - Allows an application to write to the device call log, potentially to hide malicious phone calls(Citation: Android Permissions)\n\nWhen granted some of these permissions, an application can make a phone call without opening the dialer first. However, if an application desires to simply redirect the user to the dialer with a phone number filled in, it can launch an Intent using `Intent.ACTION_DIAL`, which requires no specific permissions. This then requires the user to explicitly initiate the call or use some form of <a href=\"https://attack.mitre.org/techniques/T1516\">Input Injection</a> to programmatically initiate it.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1616"
              },
              {
                "url": "https://developer.android.com/reference/android/Manifest.permission"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-41.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-42.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-36.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-18.html"
              }
            ],
            "x_mitre_detection": "Users can view their default phone app in device settings. Users can review available call logs for irregularities, such as missing or unrecognized calls.",
            "id": "T1616",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Deprecated. Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. \n\nThey may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1436"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1436",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Remote Access Software",
            "description": "Adversaries may use legitimate remote access software, such as `VNC`, `TeamViewer`, `AirDroid`, `AirMirror`, etc., to establish an interactive command and control channel to target mobile devices.  \n\nRemote access applications may be installed and used post-compromise as an alternate communication channel for redundant access or as a way to establish an interactive remote session with the target device. They may also be used as a component of malware to establish a reverse connection to an adversary-controlled system or service. Installation of remote access tools may also include persistence.  ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1663"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1663",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Asymmetric Cryptography",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private that should not be distributed. Due to how asymmetric algorithms work, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA, ElGamal, and ECDSA.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as <a href=\"https://attack.mitre.org/techniques/T1521/002\">Asymmetric Cryptography</a>.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/002"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521.002",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Bidirectional Communication",
            "description": "Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to and receiving output from a compromised system. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/002"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481.002",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Non-Standard Port",
            "description": "Adversaries may generate network traffic using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088 or port 587 as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1509"
              }
            ],
            "x_mitre_detection": "Application vetting reports may show network communications performed by the application, including hosts, ports, protocols, and URLs. Further detection would most likely be at the enterprise level, through packet and/or netflow inspection. Many properly configured firewalls may also naturally block command and control traffic over non-standard ports.",
            "id": "T1509",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1520\">Domain Generation Algorithms</a> (DGAs) to procedurally generate domain names for command and control communication, and other uses such as malicious application distribution.(Citation: securelist rotexy 2018)\n\nDGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1520"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.",
            "id": "T1520",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Application Layer Protocol",
            "description": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the mobile device, and often the results of those commands, will be embedded within the protocol traffic between the mobile device and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1437"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-29.html"
              }
            ],
            "x_mitre_detection": "Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior.",
            "id": "T1437",
            "collection": "Mobile ATT&CK"
          }
        ]
      },
      {
        "name": "Command and Control",
        "id": "TA0037",
        "ref": "https://attack.mitre.org/tactics/TA0037",
        "collection": "Mobile ATT&CK",
        "mitre_techniques": [
          {
            "name": "Socket Filters",
            "description": "Adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as the `libpcap` library to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell.\n\nTo establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria.(Citation: haking9 libpcap network sniffing) Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction with <a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a>.(Citation: exatrack bpf filters passive backdoors)(Citation: Leonardo Turla Penquin May 2020)\n\nFilters can be installed on any Unix-like platform with `libpcap` installed or on Windows hosts using `Winpcap`.  Adversaries may use either `libpcap` with `pcap_setfilter` or the standard library function `setsockopt` with `SO_ATTACH_FILTER` options. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205/002"
              },
              {
                "url": "https://exatrack.com/public/Tricephalic_Hellkeeper.pdf"
              },
              {
                "url": "https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/"
              },
              {
                "url": "https://www.leonardo.com/documents/20142/10868623/Malware+Technical+Insight+_Turla+%E2%80%9CPenquin_x64%E2%80%9D.pdf"
              },
              {
                "url": "http://recursos.aldabaknocking.com/libpcapHakin9LuisMartinGarcia.pdf"
              }
            ],
            "x_mitre_detection": "Identify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.(Citation: crowdstrike bpf socket filters)",
            "id": "T1205.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Standard Encoding",
            "description": "Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding)(Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1132.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Proxy",
            "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.\n\nAdversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nConsider monitoring for traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>).",
            "id": "T1090",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-hop Proxy",
            "description": "To disguise the source of malicious traffic, adversaries may chain together multiple proxies. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1188"
              }
            ],
            "x_mitre_detection": "When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>) or known adversary infrastructure that uses this technique.",
            "id": "T1188",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Dynamic Resolution",
            "description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.\n\nAdversaries may use dynamic resolution for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated C2 can be challenging due to the number of different algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are multiple approaches to detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more (Citation: Data Driven Security DGA). CDN domains may trigger these detections due to the format of their domain names. In addition to detecting algorithm generated domains based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.",
            "id": "T1568",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "External Proxy",
            "description": "Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion.\n\nExternal connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows, such as a client sending significantly more data than it receives from an external server. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1090.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Communication Through Removable Media",
            "description": "Adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system.(Citation: ESET Sednit USBStealer 2014) Both systems would need to be compromised, with the likelihood that an Internet-connected system was compromised first and the second through lateral movement by <a href=\"https://attack.mitre.org/techniques/T1091\">Replication Through Removable Media</a>. Commands and files would be relayed from the disconnected system to the Internet-connected system to which the adversary has direct access.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1092"
              },
              {
                "url": "http://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/"
              }
            ],
            "x_mitre_detection": "Monitor file access on removable media. Detect processes that execute when removable media is mounted.",
            "id": "T1092",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "One-Way Communication",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to a compromised system without receiving return output over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/003"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "File Transfer Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMB(Citation: US-CERT TA18-074A), FTP(Citation: ESET Machete July 2019), FTPS, and TFTP that transfer files may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/002"
              },
              {
                "url": "https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1071.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multiband Communication",
            "description": "Deprecated. **This technique has been deprecated and should no longer be used.**\n\nSome adversaries may split communications between different protocols. There could be one protocol for inbound command and control and another for outbound data, allowing it to bypass certain firewall restrictions. The split could also be random to simply avoid data threshold alerts on any one communication.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1026"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2) Correlating alerts between multiple communication channels can further help identify command-and-control behavior.",
            "id": "T1026",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Standard Port",
            "description": "Adversaries may communicate using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.\n\nAdversaries may also make changes to victim systems to abuse non-standard ports. For example, Registry keys and other configuration settings can be used to modify protocol and port pairings.(Citation: change_rdp_port_conti)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1571"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage"
              },
              {
                "url": "https://x.com/TheDFIRReport/status/1498657772254240768"
              },
              {
                "url": "https://www.fortinet.com/blog/threat-research/analysis-of-new-agent-tesla-spyware-variant.html"
              }
            ],
            "x_mitre_detection": "Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2)",
            "id": "T1571",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Data Obfuscation",
            "description": "Adversaries may obfuscate command and control traffic to make it more difficult to detect.(Citation: Bitdefender FunnyDream Campaign November 2020) Command and control (C2) communications are hidden (but not necessarily encrypted) in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen. This encompasses many methods, such as adding junk data to protocol traffic, using steganography, or impersonating legitimate protocols. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.bitdefender.com/files/News/CaseStudies/study/379/Bitdefender-Whitepaper-Chinese-APT.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-hop Proxy",
            "description": "Adversaries may chain together multiple proxies to disguise the source of malicious traffic. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.\n\nFor example, adversaries may construct or use onion routing networks \u2013 such as the publicly available <a href=\"https://attack.mitre.org/software/S0183\">Tor</a> network \u2013 to transport encrypted C2 traffic through a compromised population, allowing communication with any device within the network.(Citation: Onion Routing) Adversaries may also use operational relay box (ORB) networks composed of virtual private servers (VPS), Internet of Things (IoT) devices, smart devices, and end-of-life routers to obfuscate their operations. (Citation: ORB Mandiant) \n\nIn the case of network infrastructure, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain (i.e., <a href=\"https://attack.mitre.org/techniques/T1584/008\">Network Devices</a>). By leveraging <a href=\"https://attack.mitre.org/techniques/T1601/001\">Patch System Image</a> on routers, adversaries can add custom code to the affected network devices that will implement onion routing between those nodes. This method is dependent upon the <a href=\"https://attack.mitre.org/techniques/T1599\">Network Boundary Bridging</a> method allowing the adversaries to cross the protected network boundary of the Internet perimeter and into the organization\u2019s Wide-Area Network (WAN).  Protocols such as ICMP may be used as a transport.  \n\nSimilarly, adversaries may abuse peer-to-peer (P2P) and blockchain-oriented infrastructure to implement routing between a decentralized network of peers.(Citation: NGLite Trojan)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/003"
              },
              {
                "url": "https://cloud.google.com/blog/topics/threat-intelligence/china-nexus-espionage-orb-networks"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Onion_routing"
              }
            ],
            "x_mitre_detection": "When observing use of Multi-hop proxies, network data from the actual command and control servers could allow correlating incoming and outgoing flows to trace malicious traffic back to its source. Multi-hop proxies can also be detected by alerting on traffic to known anonymity networks (such as <a href=\"https://attack.mitre.org/software/S0183\">Tor</a>) or known adversary infrastructure that uses this technique.\n\nIn context of network devices, monitor traffic for encrypted communications from the Internet that is addressed to border routers.  Compare this traffic with the configuration to determine whether it matches with any configured site-to-site Virtual Private Network (VPN) connections the device was intended to have. Monitor traffic for encrypted communications originating from potentially breached routers that is addressed to other routers within the organization.  Compare the source and destination with the configuration of the device to determine if these channels are an authorized Virtual Private Network (VPN) connections or other encrypted modes of communication. Monitor ICMP traffic from the Internet that is addressed to border routers and is encrypted.  Few if any legitimate use cases exist for sending encrypted data to a network device via ICMP.",
            "id": "T1090.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Port Knocking",
            "description": "Adversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.\n\nThis technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205/001"
              },
              {
                "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"
              }
            ],
            "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.",
            "id": "T1205.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multi-Stage Channels",
            "description": "Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult.\n\nRemote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features.\n\nThe different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a> in case the original first-stage communication path is discovered and blocked.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1104"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure. Relating subsequent actions that may result from Discovery of the system and network information or Lateral Movement to the originating process may also yield useful data.",
            "id": "T1104",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "DNS Calculation",
            "description": "Adversaries may perform calculations on addresses returned in DNS results to determine which port and IP address to use for command and control, rather than relying on a predetermined port number or the actual returned IP address. A IP and/or port number calculation can be used to bypass egress filtering on a C2 channel.(Citation: Meyers Numbered Panda)\n\nOne implementation of <a href=\"https://attack.mitre.org/techniques/T1568/003\">DNS Calculation</a> is to take the first three octets of an IP address in a DNS response and use those values to calculate the port for command and control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/003"
              },
              {
                "url": "http://www.crowdstrike.com/blog/whois-numbered-panda/"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2014/09/darwins-favorite-apt-group-2.html"
              },
              {
                "url": "https://blog.rapid7.com/2013/08/26/upcoming-g20-summit-fuels-espionage-operations/"
              }
            ],
            "x_mitre_detection": "Detection for this technique is difficult because it would require knowledge of the specific implementation of the port calculation algorithm. Detection may be possible by analyzing DNS records if the algorithm is known.",
            "id": "T1568.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Web Service",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites, cloud services, and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google, Microsoft, or Twitter, makes it easier for adversaries to hide in expected noise.(Citation: Broadcom BirdyClient Microsoft Graph API 2024) Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102"
              },
              {
                "url": "https://www.broadcom.com/support/security-center/protection-bulletin/birdyclient-malware-leverages-microsoft-graph-api-for-c-c-communication"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Symmetric Cryptography",
            "description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "With symmetric encryption, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures.\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Publish/Subscribe Protocols",
            "description": "Adversaries may communicate using publish/subscribe (pub/sub) application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as <tt>MQTT</tt>, <tt>XMPP</tt>, <tt>AMQP</tt>, and <tt>STOMP</tt> use a publish/subscribe design, with message distribution managed by a centralized broker.(Citation: wailing crab sub/pub)(Citation: Mandiant APT1 Appendix) Publishers categorize their messages by topics, while subscribers receive messages according to their subscribed topics.(Citation: wailing crab sub/pub) An adversary may abuse publish/subscribe protocols to communicate with systems under their control from behind a message broker while also mimicking normal, expected traffic.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/005"
              },
              {
                "url": "https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/"
              },
              {
                "url": "https://www.mandiant.com/sites/default/files/2021-09/mandiant-apt1-report.pdf"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1071.005",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Fast Flux DNS",
            "description": "Adversaries may use Fast Flux DNS to hide a command and control channel behind an array of rapidly changing IP addresses linked to a single domain resolution. This technique uses a fully qualified domain name, with multiple IP addresses assigned to it which are swapped with high frequency, using a combination of round robin IP addressing and short Time-To-Live (TTL) for a DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity)\n\nThe simplest, \"single-flux\" method, involves registering and de-registering an addresses as part of the DNS A (address) record list for a single DNS name. These registrations have a five-minute average lifespan, resulting in a constant shuffle of IP address resolution.(Citation: Fast Flux - Welivesecurity)\n\nIn contrast, the \"double-flux\" method registers and de-registers an address as part of the DNS Name Server record list for the DNS zone, providing additional resilience for the connection. With double-flux additional hosts can act as a proxy to the C2 host, further insulating the true source of the C2 channel.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/001"
              },
              {
                "url": "https://resources.infosecinstitute.com/fast-flux-networks-working-detection-part-1/#gref"
              },
              {
                "url": "https://resources.infosecinstitute.com/fast-flux-networks-working-detection-part-2/#gref"
              },
              {
                "url": "https://www.welivesecurity.com/2017/01/12/fast-flux-networks-work/"
              }
            ],
            "x_mitre_detection": "In general, detecting usage of fast flux DNS is difficult due to web traffic load balancing that services client requests quickly. In single flux cases only IP addresses change for static domain names. In double flux cases, nothing is static. Defenders such as domain registrars and service providers are likely in the best position for detection.",
            "id": "T1568.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1568/002"
              },
              {
                "url": "https://arxiv.org/pdf/1611.00791.pdf"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://medium.com/@yvyuz/a-death-match-of-domain-generation-algorithms-a5b5dbdc1c6e"
              },
              {
                "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"
              },
              {
                "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain is related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)",
            "id": "T1568.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Fronting",
            "description": "Domain fronting takes advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) The technique involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).\n\nFor example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1172"
              },
              {
                "url": "http://www.icir.org/vern/papers/meek-PETS-2015.pdf"
              }
            ],
            "x_mitre_detection": "If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blacklist or whitelist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)",
            "id": "T1172",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "DNS",
            "description": "Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nThe DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/004"
              },
              {
                "url": "https://medium.com/@galolbardes/learn-how-easy-is-to-bypass-firewalls-using-dns-tunneling-and-also-how-to-block-it-3ed652f4a000"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.paloaltonetworks.com/cyberpedia/what-is-dns-tunneling"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for DNS traffic to/from known-bad or suspicious domains.",
            "id": "T1071.004",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Standard Cryptographic Protocol",
            "description": "Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1032"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels. (Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation. (Citation: SEI SSL Inspection Risks)\n\nIf malware uses encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1032",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Traffic Signaling",
            "description": "Adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e. <a href=\"https://attack.mitre.org/techniques/T1205/001\">Port Knocking</a>), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software.\n\nAdversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s).\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.\n\nOn network devices, adversaries may use crafted packets to enable <a href=\"https://attack.mitre.org/techniques/T1556/004\">Network Device Authentication</a> for standard services offered by the device such as telnet.  Such signaling may also be used to open a closed service port such as telnet, or to trigger module modification of malware implants on the device, adding, removing, or changing malicious capabilities.  Adversaries may use crafted packets to attempt to connect to one or more (open or closed) ports, but may also attempt to connect to a router interface, broadcast, and network address IP on the same port in order to achieve their goals and objectives.(Citation: Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco Blog Legacy Device Attacks)  To enable this traffic signaling on embedded devices, adversaries must first achieve and leverage <a href=\"https://attack.mitre.org/techniques/T1601/001\">Patch System Image</a> due to the monolithic nature of the architecture.\n\nAdversaries may also use the Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware feature that allows a powered down system to be powered on, or woken up, by sending a magic packet to it. Once the system is powered on, it may become a target for lateral movement.(Citation: Bleeping Computer - Ryuk WoL)(Citation: AMD Magic Packet)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1205"
              },
              {
                "url": "https://www.bleepingcomputer.com/news/security/ryuk-ransomware-uses-wake-on-lan-to-encrypt-offline-devices/"
              },
              {
                "url": "https://www.amd.com/system/files/TechDocs/20213.pdf"
              },
              {
                "url": "https://www.mandiant.com/resources/synful-knock-acis"
              },
              {
                "url": "https://blogs.cisco.com/security/evolution-of-attacks-on-cisco-ios-devices"
              },
              {
                "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"
              },
              {
                "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
              },
              {
                "url": "https://gitlab.com/wireshark/wireshark/-/wikis/WakeOnLAN"
              }
            ],
            "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.\n\nThe Wake-on-LAN magic packet consists of 6 bytes of <tt>FF</tt> followed by sixteen repetitions of the target system's IEEE address. Seeing this string anywhere in a packet's payload may be indicative of a Wake-on-LAN attempt.(Citation: GitLab WakeOnLAN)",
            "id": "T1205",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Content Injection",
            "description": "Adversaries may gain access and continuously communicate with victims by injecting malicious content into systems through online network traffic. Rather than luring victims to malicious payloads hosted on a compromised website (i.e., <a href=\"https://attack.mitre.org/techniques/T1608/004\">Drive-by Target</a> followed by <a href=\"https://attack.mitre.org/techniques/T1189\">Drive-by Compromise</a>), adversaries may initially access victims through compromised data-transfer channels where they can manipulate traffic and/or inject their own content. These compromised online network channels may also be used to deliver additional payloads (i.e., <a href=\"https://attack.mitre.org/techniques/T1105\">Ingress Tool Transfer</a>) and other data to already compromised systems.(Citation: ESET MoustachedBouncer)\n\nAdversaries may inject content to victim systems in various ways, including:\n\n* From the middle, where the adversary is in-between legitimate online client-server communications (**Note:** this is similar but distinct from <a href=\"https://attack.mitre.org/techniques/T1557\">Adversary-in-the-Middle</a>, which describes AiTM activity solely within an enterprise environment) (Citation: Kaspersky Encyclopedia MiTM)\n* From the side, where malicious content is injected and races to the client as a fake response to requests of a legitimate online server (Citation: Kaspersky ManOnTheSide)\n\nContent injection is often the result of compromised upstream communication channels, for example at the level of an internet service provider (ISP) as is the case with \"lawful interception.\"(Citation: Kaspersky ManOnTheSide)(Citation: ESET MoustachedBouncer)(Citation: EFF China GitHub Attack)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1659"
              },
              {
                "url": "https://www.eff.org/deeplinks/2015/04/china-uses-unencrypted-websites-to-hijack-browsers-in-github-attack"
              },
              {
                "url": "https://www.welivesecurity.com/en/eset-research/moustachedbouncer-espionage-against-foreign-diplomats-in-belarus/"
              },
              {
                "url": "https://encyclopedia.kaspersky.com/glossary/man-in-the-middle-attack/"
              },
              {
                "url": "https://usa.kaspersky.com/blog/man-on-the-side/27854/"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1659",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Mail Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: FireEye APT28) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/003"
              },
              {
                "url": "https://web.archive.org/web/20151022204649/https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1071.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of <a href=\"https://attack.mitre.org/techniques/T1008\">Fallback Channels</a>. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1483"
              },
              {
                "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"
              },
              {
                "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"
              },
              {
                "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"
              },
              {
                "url": "https://blogs.akamai.com/2018/01/a-death-match-of-domain-generation-algorithms.html"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
              },
              {
                "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"
              },
              {
                "url": "https://arxiv.org/pdf/1611.00791.pdf"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain or related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Elastic Predicting DGA)",
            "id": "T1483",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Protocol Tunneling",
            "description": "Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. \n\nThere are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling) \n\n<a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a> may also be abused by adversaries during <a href=\"https://attack.mitre.org/techniques/T1568\">Dynamic Resolution</a>. Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) \n\nAdversaries may also leverage <a href=\"https://attack.mitre.org/techniques/T1572\">Protocol Tunneling</a> in conjunction with <a href=\"https://attack.mitre.org/techniques/T1090\">Proxy</a> and/or <a href=\"https://attack.mitre.org/techniques/T1001/003\">Protocol Impersonation</a> to further conceal C2 communications and infrastructure. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1572"
              },
              {
                "url": "https://www.ssh.com/ssh/tunneling"
              },
              {
                "url": "https://www.bleepingcomputer.com/news/security/new-godlua-malware-evades-traffic-monitoring-via-dns-over-https/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Monitoring for systems listening and/or establishing external connections using ports/protocols commonly associated with tunneling, such as SSH (port 22). Also monitor for processes commonly associated with tunneling, such as Plink and the OpenSSH client. \n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1572",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Application Layer Protocol",
            "description": "Adversaries may communicate using OSI application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, DNS, or publishing/subscribing. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.(Citation: Mandiant APT29 Eye Spy Email Nov 22) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.mandiant.com/resources/blog/unc3524-eye-spy-email"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "id": "T1071",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Multilayer Encryption",
            "description": "An adversary performs C2 communications using multiple layers of encryption, typically (but not exclusively) tunneling a custom encryption scheme within a protocol encryption scheme such as HTTPS or SMTPS.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1079"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "If malware uses <a href=\"https://attack.mitre.org/techniques/T1032\">Standard Cryptographic Protocol</a>, SSL/TLS inspection can be used to detect command and control traffic within some encrypted communication channels. (Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation. (Citation: SEI SSL Inspection Risks) After SSL/TLS inspection, additional cryptographic analysis may be needed to analyze the second layer of encryption.\n\nWith <a href=\"https://attack.mitre.org/techniques/T1024\">Custom Cryptographic Protocol</a>, if malware uses encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1079",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Remote Access Software",
            "description": "An adversary may use legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks. These services, such as `VNC`, `Team Viewer`, `AnyDesk`, `ScreenConnect`, `LogMein`, `AmmyyAdmin`, and other remote monitoring and management (RMM) tools, are commonly used as legitimate technical support software and may be allowed by application control within a target environment.(Citation: Symantec Living off the Land)(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy)\n\nRemote access software may be installed and used post-compromise as an alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary-controlled system.\n \nAdversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.\n\nInstallation of many remote access software may also include persistence (e.g., the software's installation routine creates a <a href=\"https://attack.mitre.org/techniques/T1543/003\">Windows Service</a>). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome\u2019s Remote Desktop).(Citation: Google Chrome Remote Desktop)(Citation: Chrome Remote Desktop)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1219"
              },
              {
                "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/15GlobalThreatReport.pdf"
              },
              {
                "url": "https://blog.crysys.hu/2013/03/teamspy/"
              },
              {
                "url": "https://support.google.com/chrome/answer/1649523"
              },
              {
                "url": "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
              },
              {
                "url": "https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-living-off-the-land-and-fileless-attack-techniques-en.pdf"
              }
            ],
            "x_mitre_detection": "Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\n\n<a href=\"https://attack.mitre.org/techniques/T1090/004\">Domain Fronting</a> may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.",
            "id": "T1219",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Custom Cryptographic Protocol",
            "description": "Adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic. A simple scheme, such as XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.\n\nCustom encryption schemes may vary in sophistication. Analysis and reverse engineering of malware samples may be enough to discover the algorithm and encryption key used.\n\nSome adversaries may also attempt to implement their own version of a well-known cryptographic algorithm instead of using a known implementation library, which may lead to unintentional errors. (Citation: F-Secure Cosmicduke)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1024"
              },
              {
                "url": "https://blog.f-secure.com/wp-content/uploads/2019/10/CosmicDuke.pdf"
              },
              {
                "url": "https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "If malware uses custom encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect when communications do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1024",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Data Encoding",
            "description": "Adversaries may encode data to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system. Use of data encoding may adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64, MIME, or other binary-to-text and character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1132",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Domain Fronting",
            "description": "Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, \"domainless\" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).\n\nFor example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/004"
              },
              {
                "url": "http://www.icir.org/vern/papers/meek-PETS-2015.pdf"
              }
            ],
            "x_mitre_detection": "If SSL inspection is in place or the traffic is not encrypted, the Host field of the HTTP header can be checked if it matches the HTTPS SNI or against a blocklist or allowlist of domain names. (Citation: Fifield Blocking Resistent Communication through domain fronting 2015)",
            "id": "T1090.004",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Uncommonly Used Port",
            "description": "Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1065"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1065",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Encrypted Channel",
            "description": "Adversaries may employ an encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Protocol or Service Impersonation",
            "description": "Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.  \n\nAdversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. \n\nAdversaries may also leverage legitimate protocols to impersonate expected web traffic or trusted services. For example, adversaries may manipulate HTTP headers, URI endpoints, SSL certificates, and transmitted data to disguise C2 communications or mimic legitimate services such as Gmail, Google Drive, and Yahoo Messenger.(Citation: ESET Okrum July 2019)(Citation: Malleable-C2-U42)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/003"
              },
              {
                "url": "https://unit42.paloaltonetworks.com/cobalt-strike-malleable-c2-profile/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.003",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Application Layer Protocol",
            "description": "Adversaries may use an OSI non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).\n\nICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution) Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.(Citation: Microsoft ICMP) However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1095"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://blogs.cisco.com/security/evolution-of-attacks-on-cisco-ios-devices"
              },
              {
                "url": "http://support.microsoft.com/KB/170292"
              },
              {
                "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
              },
              {
                "url": "http://en.wikipedia.org/wiki/List_of_network_protocols_%28OSI_model%29"
              }
            ],
            "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.(Citation: Cisco Blog Legacy Device Attacks)\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2) \n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.",
            "id": "T1095",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Asymmetric Cryptography",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as <a href=\"https://attack.mitre.org/techniques/T1573/002\">Asymmetric Cryptography</a>.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1573/002"
              },
              {
                "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
              },
              {
                "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1573.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Bidirectional Communication",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. \n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Fallback Channels",
            "description": "Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1008"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1008",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Steganography",
            "description": "Adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult. Steganographic techniques can be used to hide data in digital messages that are transferred between systems. This hidden information can be used for command and control of compromised systems. In some cases, the passing of files embedded using steganography, such as image or document files, can be used for command and control. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/002"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Non-Standard Encoding",
            "description": "Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1132/002"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Binary-to-text_encoding"
              },
              {
                "url": "https://en.wikipedia.org/wiki/Character_encoding"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1132.002",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Deprecated. **This technique has been deprecated. Please use <a href=\"https://attack.mitre.org/techniques/T1571\">Non-Standard Port</a> where appropriate.**\n\nAdversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1043"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "id": "T1043",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Junk Data",
            "description": "Adversaries may add junk data to protocols used for command and control to make detection more difficult.(Citation: FireEye SUNBURST Backdoor December 2020) By adding random or meaningless data to the protocols used for command and control, adversaries can prevent trivial methods for decoding, deciphering, or otherwise analyzing the traffic. Examples may include appending/prepending data with junk characters or writing junk characters between significant characters. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1001/001"
              },
              {
                "url": "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1001.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Dead Drop Resolver",
            "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1102/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)",
            "id": "T1102.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Custom Command and Control Protocol",
            "description": "Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing <a href=\"https://attack.mitre.org/techniques/T1071\">Application Layer Protocol</a>. Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1094"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              }
            ],
            "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.",
            "id": "T1094",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Internal Proxy",
            "description": "Adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment. Many tools exist that enable traffic redirection through proxies or port redirection, including <a href=\"https://attack.mitre.org/software/S0040\">HTRAN</a>, ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command and control communications inside a compromised environment, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between infected systems to avoid suspicion. Internal proxy connections may use common peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with the environment.\n\nBy using a compromised internal system as a proxy, adversaries may conceal the true destination of C2 traffic while reducing the need for numerous connections to external systems.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1090/001"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows between clients that should not or often do not communicate with one another. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1090.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Web Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as HTTP/S(Citation: CrowdStrike Putter Panda) and WebSocket(Citation: Brazking-Websockets) that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1071/001"
              },
              {
                "url": "http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://securityintelligence.com/posts/brazking-android-malware-upgraded-targeting-brazilian-banks/"
              }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for web traffic to/from known-bad or suspicious domains. ",
            "id": "T1071.001",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Hide Infrastructure",
            "description": "Adversaries may manipulate network traffic in order to hide and evade detection of their C2 infrastructure. This can be accomplished in various ways including by identifying and filtering traffic from defensive tools,(Citation: TA571) masking malicious domains to obfuscate the true destination from both automated scanning tools and security researchers,(Citation: Schema-abuse)(Citation: Facad1ng)(Citation: Browser-updates) and otherwise hiding malicious artifacts to delay discovery and prolong the effectiveness of adversary infrastructure that could otherwise be identified, blocked, or taken down entirely.\n\nC2 networks may include the use of <a href=\"https://attack.mitre.org/techniques/T1090\">Proxy</a> or VPNs to disguise IP addresses, which can allow adversaries to blend in with normal network traffic and bypass conditional access policies or anti-abuse protections. For example, an adversary may use a virtual private cloud to spoof their IP address to closer align with a victim's IP address ranges. This may also bypass security measures relying on geolocation of the source IP address.(Citation: sysdig)(Citation: Orange Residential Proxies)\n\nAdversaries may also attempt to filter network traffic in order to evade defensive tools in numerous ways, including blocking/redirecting common incident responder or security appliance user agents.(Citation: mod_rewrite)(Citation: SocGholish-update) Filtering traffic based on IP and geo-fencing may also avoid automated sandboxing or researcher activity (i.e., <a href=\"https://attack.mitre.org/techniques/T1497\">Virtualization/Sandbox Evasion</a>).(Citation: TA571)(Citation: mod_rewrite)\n\nHiding C2 infrastructure may also be supported by <a href=\"https://attack.mitre.org/tactics/TA0042\">Resource Development</a> activities such as <a href=\"https://attack.mitre.org/techniques/T1583\">Acquire Infrastructure</a> and <a href=\"https://attack.mitre.org/techniques/T1584\">Compromise Infrastructure</a>. For example, using widely trusted hosting services or domains such as prominent URL shortening providers or marketing services for C2 networks may enable adversaries to present benign content that later redirects victims to malicious web pages or infrastructure once specific conditions are met.(Citation: StarBlizzard)(Citation: QR-cofense)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1665"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/part-1-socgholish-very-real-threat-very-fake-update"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/security-brief-ta571-delivers-icedid-forked-loader"
              },
              {
                "url": "https://bluescreenofjeff.com/2016-04-12-combatting-incident-responders-with-apache-mod_rewrite/"
              },
              {
                "url": "https://www.proofpoint.com/us/blog/threat-insight/are-you-sure-your-browser-date-current-landscape-fake-browser-updates"
              },
              {
                "url": "https://www.microsoft.com/en-us/security/blog/2023/12/07/star-blizzard-increases-sophistication-and-evasion-in-ongoing-attacks/"
              },
              {
                "url": "https://cofense.com/blog/major-energy-company-targeted-in-large-qr-code-campaign/"
              },
              {
                "url": "https://www.mandiant.com/resources/blog/url-obfuscation-schema-abuse"
              },
              {
                "url": "https://www.orangecyberdefense.com/global/blog/research/residential-proxies"
              },
              {
                "url": "https://github.com/spyboy-productions/Facad1ng"
              },
              {
                "url": "https://sysdig.com/content/c/pf-2023-global-cloud-threat-report?x=u_WFRi&xs=524303#page=1"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1665",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Ingress Tool Transfer",
            "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as <a href=\"https://attack.mitre.org/software/S0095\">ftp</a>. Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. <a href=\"https://attack.mitre.org/techniques/T1570\">Lateral Tool Transfer</a>). \n\nOn Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, <a href=\"https://attack.mitre.org/software/S0160\">certutil</a>, and <a href=\"https://attack.mitre.org/techniques/T1059/001\">PowerShell</a> commands such as <tt>IEX(New-Object Net.WebClient).downloadString()</tt> and <tt>Invoke-WebRequest</tt>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)\n\nAdversaries may also abuse installers and package managers, such as `yum` or `winget`, to download tools to victim hosts. Adversaries have also abused file application features, such as the Windows `search-ms` protocol handler, to deliver malicious files to victims through remote file searches invoked by <a href=\"https://attack.mitre.org/techniques/T1204\">User Execution</a> (typically after interacting with <a href=\"https://attack.mitre.org/techniques/T1566\">Phishing</a> lures).(Citation: T1105: Trellix_search-ms)\n\nFiles can also be transferred using various <a href=\"https://attack.mitre.org/techniques/T1102\">Web Service</a>s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016) In some cases, adversaries may be able to leverage services that sync between a web-based and an on-premises client, such as Dropbox or OneDrive, to transfer files onto victim systems. For example, by compromising a cloud account and logging into the service's web portal, an adversary may be able to trigger an automatic syncing process that transfers the file onto the victim's machine.(Citation: Dropbox Malware Sync)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1105"
              },
              {
                "url": "https://www.trellix.com/blogs/research/beyond-file-search-a-novel-method/"
              },
              {
                "url": "https://www.technologyreview.com/2013/08/21/83143/dropbox-and-similar-services-can-sync-malware/"
              },
              {
                "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
              },
              {
                "url": "https://lolbas-project.github.io/#t1105"
              },
              {
                "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf"
              }
            ],
            "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as <a href=\"https://attack.mitre.org/software/S0095\">ftp</a>, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Specifically, for the finger utility on Windows and Linux systems, monitor command line or terminal execution for the finger command. Monitor network activity for TCP port 79, which is used by the finger utility, and Windows <tt>netsh interface portproxy</tt> modifications to well-known ports such as 80 and 443. Furthermore, monitor file system for the download/creation and execution of suspicious files, which may indicate adversary-downloaded payloads. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "id": "T1105",
            "collection": "Enterprise ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend in with normal network activity, to avoid more detailed inspection. They may use the protocol associated with the port, or a completely different protocol. They may use commonly open ports, such as the examples provided below. \n \n * TCP:80 (HTTP) \n * TCP:443 (HTTPS) \n * TCP/UDP:53 (DNS) \n * TCP:1024-4999 (OPC on XP/Win2k3) \n * TCP:49152-65535 (OPC on Vista and later) \n * TCP:23 (TELNET) \n * UDP:161 (SNMP) \n * TCP:502 (MODBUS) \n * TCP:102 (S7comm/ISO-TSAP) \n * TCP:20000 (DNP3) \n * TCP:44818 (Ethernet/IP)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0885"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0885",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Standard Application Layer Protocol",
            "description": "Adversaries may establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, RDP, telnet, DNP3, and modbus. These protocols may be used to disguise adversary actions as benign network traffic. Standard protocols may be seen on their associated port or in some cases over a non-standard port.  Adversaries may use these protocols to reach out of the network for command and control, or in some cases to other infected devices within the network.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0869"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0869",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Connection Proxy",
            "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications.\n\nThe definition of a proxy can also be expanded to encompass trust relationships between networks in peer-to-peer, mesh, or trusted connections between networks consisting of hosts or systems that regularly communicate with each other.\n\nThe network may be within a single organization or across multiple organizations with trust relationships. Adversaries could use these types of relationships to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. (Citation: Enterprise ATT&CK January 2018)",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T0884"
              },
              {
                "url": "https://attack.mitre.org/wiki/Technique/T1090"
              }
            ],
            "x_mitre_detection": "",
            "id": "T0884",
            "collection": "ICS ATT&CK"
          },
          {
            "name": "Web Service",
            "description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. \n\n \n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). \n\n ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "One-Way Communication",
            "description": "Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to a compromised system without receiving return output. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/003"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481.003",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Exfiltration Over Other Network Medium",
            "description": "Adversaries may attempt to exfiltrate data over a different network medium than the command and control channel. If the command and control network is a standard Internet connection, the exfiltration may occur, for example, via Bluetooth, or another radio frequency (RF) channel. \n\nAdversaries may choose to do this if they have sufficient access or proximity, and the connection might not be secured or defended as well as the primary Internet-connected channel because it is not routed through the same enterprise network. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1438"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-30.html"
              }
            ],
            "x_mitre_detection": "Exfiltration over other network mediums can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.",
            "id": "T1438",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Symmetric Cryptography",
            "description": "Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, Blowfish, and RC4.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/001"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1637/001\">Domain Generation Algorithms</a> (DGAs) to procedurally generate domain names for uses such as command and control communication   or malicious application distribution.(Citation: securelist rotexy 2018)\n\nDGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there could potentially be thousands of domains that malware can check for instructions.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1637/001"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names ",
            "id": "T1637.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "SSL Pinning",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a>  to protect the C2 traffic from being intercepted and analyzed.\n\n<a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a>  is a technique commonly utilized by legitimate websites to ensure that encrypted communications are only allowed with a pre-defined certificate. If another certificate is presented, it could indicate device compromise, traffic interception, or another upstream issue. While benign usages are common, it is also possible for adversaries to abuse this technology to protect malicious C2 traffic.\n\nIn normal, not pinned SSL validation, when a client connects to a server using HTTPS, it typically checks whether the server\u2019s SSL/TLS certificate is signed by a trusted Certificate Authority (CA) in the device\u2019s trust store. If the certificate is valid and signed by a trusted CA, the connection is established. However, with <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a> , the client is configured to trust a specific SSL/TLS certificate or public key, rather than relying on the device\u2019s trust store. This means that even if the server\u2019s certificate is signed by a trusted CA, the client will only establish the connection of the certificate or key is pinned.\n\nThere are two types of <a href=\"https://attack.mitre.org/techniques/T1521/003\">SSL Pinning</a> :\n\n1.\tCertificate Pinning: The client stores a copy of the server\u2019s certificate and compares it with the certificate received during the SSL handshake. If the certificates match, then the client proceeds with the connection. This approach also works with self-signed certificates.\n\n2.\tPublic Key Pinning: Instead of pinning the entire certificate, the client pins just the public key extracted from the certificate. This is often more flexible, as it allows the server to renew its certificate without having to update the pinned certificate or breaking the SSL connection.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/003"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1521.003",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Dead Drop Resolver",
            "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. \n\n \n\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/001"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application. ",
            "id": "T1481.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Out of Band Data",
            "description": "Adversaries may communicate with compromised devices using out of band data streams. This could be done for a variety of reasons, including evading network traffic monitoring, as a backup method of command and control, or for data exfiltration if the device is not connected to any Internet-providing networks (i.e. cellular or Wi-Fi). Several out of band data streams exist, such as SMS messages, NFC, and Bluetooth. \n\n \n\nOn Android, applications can read push notifications to capture content from SMS messages, or other out of band data streams. This requires that the user manually grant notification access to the application via the settings menu. However, the application could launch an Intent to take the user directly there. \n\n \n\nOn iOS, there is no way to programmatically read push notifications. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1644"
              }
            ],
            "x_mitre_detection": "If a user sees a notification with text they do not recognize, they should review their list of installed applications.",
            "id": "T1644",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Encrypted Channel",
            "description": "Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Ingress Tool Transfer",
            "description": "Adversaries may transfer tools or other files from an external system onto a compromised device to facilitate follow-on actions. Files may be copied from an external adversary-controlled system through the command and control channel  or through alternate protocols with another tool such as FTP.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1544"
              }
            ],
            "x_mitre_detection": "Application vetting services could look for connections to unknown domains or IP addresses. Application vetting services may indicate precisely what content was requested during application execution.",
            "id": "T1544",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Dynamic Resolution",
            "description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. This algorithm can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1637"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different Domain Generation Algorithms (DGAs), constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) Content delivery network (CDN) domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names or rarely visited domains.",
            "id": "T1637",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Web Protocols",
            "description": "Adversaries may communicate using application layer protocols associated with web protocols traffic to avoid detection/network filtering by blending in with existing traffic. Commands to remote mobile devices, and often the results of those commands, will be embedded within the protocol traffic between the mobile client and server. \n\nWeb protocols such as HTTP and HTTPS are used for web traffic as well as well as notification services native to mobile messaging services such as Google Cloud Messaging (GCM) and newly, Firebase Cloud Messaging (FCM), (GCM/FCM: two-way communication) and Apple Push Notification Service (APNS; one-way server-to-device).  Such notification services leverage HTTP/S via the respective API and are commonly abused on Android and iOS respectively in order blend in with routine device traffic making it difficult for enterprises to inspect. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1437/001"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-29.html"
              }
            ],
            "x_mitre_detection": "Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior. ",
            "id": "T1437.001",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Call Control",
            "description": "Adversaries may make, forward, or block phone calls without user authorization. This could be used for adversary goals such as audio surveillance, blocking or forwarding calls from the device owner, or C2 communication.\n\nSeveral permissions may be used to programmatically control phone calls, including:\n\n* `ANSWER_PHONE_CALLS` - Allows the application to answer incoming phone calls(Citation: Android Permissions)\n* `CALL_PHONE` - Allows the application to initiate a phone call without going through the Dialer interface(Citation: Android Permissions)\n* `PROCESS_OUTGOING_CALLS` - Allows the application to see the number being dialed during an outgoing call with the option to redirect the call to a different number or abort the call altogether(Citation: Android Permissions)\n* `MANAGE_OWN_CALLS` - Allows a calling application which manages its own calls through the self-managed `ConnectionService` APIs(Citation: Android Permissions)\n* `BIND_TELECOM_CONNECTION_SERVICE` - Required permission when using a `ConnectionService`(Citation: Android Permissions)\n* `WRITE_CALL_LOG` - Allows an application to write to the device call log, potentially to hide malicious phone calls(Citation: Android Permissions)\n\nWhen granted some of these permissions, an application can make a phone call without opening the dialer first. However, if an application desires to simply redirect the user to the dialer with a phone number filled in, it can launch an Intent using `Intent.ACTION_DIAL`, which requires no specific permissions. This then requires the user to explicitly initiate the call or use some form of <a href=\"https://attack.mitre.org/techniques/T1516\">Input Injection</a> to programmatically initiate it.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1616"
              },
              {
                "url": "https://developer.android.com/reference/android/Manifest.permission"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-41.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-42.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-36.html"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/cellular-threats/CEL-18.html"
              }
            ],
            "x_mitre_detection": "Users can view their default phone app in device settings. Users can review available call logs for irregularities, such as missing or unrecognized calls.",
            "id": "T1616",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Commonly Used Port",
            "description": "Deprecated. Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. \n\nThey may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1436"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1436",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Remote Access Software",
            "description": "Adversaries may use legitimate remote access software, such as `VNC`, `TeamViewer`, `AirDroid`, `AirMirror`, etc., to establish an interactive command and control channel to target mobile devices.  \n\nRemote access applications may be installed and used post-compromise as an alternate communication channel for redundant access or as a way to establish an interactive remote session with the target device. They may also be used as a component of malware to establish a reverse connection to an adversary-controlled system or service. Installation of remote access tools may also include persistence.  ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1663"
              }
            ],
            "x_mitre_detection": "",
            "id": "T1663",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Asymmetric Cryptography",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private that should not be distributed. Due to how asymmetric algorithms work, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA, ElGamal, and ECDSA.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as <a href=\"https://attack.mitre.org/techniques/T1521/002\">Asymmetric Cryptography</a>.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1521/002"
              }
            ],
            "x_mitre_detection": "Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.",
            "id": "T1521.002",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Bidirectional Communication",
            "description": "Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to and receiving output from a compromised system. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. \n\n \n\nPopular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1481/002"
              }
            ],
            "x_mitre_detection": "Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.",
            "id": "T1481.002",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Non-Standard Port",
            "description": "Adversaries may generate network traffic using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088 or port 587 as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1509"
              }
            ],
            "x_mitre_detection": "Application vetting reports may show network communications performed by the application, including hosts, ports, protocols, and URLs. Further detection would most likely be at the enterprise level, through packet and/or netflow inspection. Many properly configured firewalls may also naturally block command and control traffic over non-standard ports.",
            "id": "T1509",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Domain Generation Algorithms",
            "description": "Adversaries may use <a href=\"https://attack.mitre.org/techniques/T1520\">Domain Generation Algorithms</a> (DGAs) to procedurally generate domain names for command and control communication, and other uses such as malicious application distribution.(Citation: securelist rotexy 2018)\n\nDGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1520"
              },
              {
                "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"
              },
              {
                "url": "https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/"
              }
            ],
            "x_mitre_detection": "Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.",
            "id": "T1520",
            "collection": "Mobile ATT&CK"
          },
          {
            "name": "Application Layer Protocol",
            "description": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the mobile device, and often the results of those commands, will be embedded within the protocol traffic between the mobile device and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS.",
            "external_references": [
              {
                "url": "https://attack.mitre.org/techniques/T1437"
              },
              {
                "url": "https://pages.nist.gov/mobile-threat-catalogue/application-threats/APP-29.html"
              }
            ],
            "x_mitre_detection": "Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior.",
            "id": "T1437",
            "collection": "Mobile ATT&CK"
          }
        ]
      }
    ]
  },
  "raw": "",
  "inputs": {
    "mitre_tactic_id": null,
    "mitre_tactic_name": "Command and Control"
  },
  "metrics": {
    "version": "1.0",
    "package": "fn-mitre-integration",
    "package_version": "2.2.0",
    "host": "my.app.host",
    "execution_time_ms": 78133,
    "timestamp": "2025-01-16 08:18:07"
  }
}