<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: MITRE Get Technique information


## Function - MITRE Technique Information

### API Name
`mitre_technique_information`

### Output Name
`None`

### Message Destination
`fn_mitre_integration`

### Pre-Processing Script
```python
# The priority order of inputs is:
# 1. Values entered in the Activity Field pop-up
# 2. Values in the Input Fields added to the layout
# 3. Inputs in the function's workflow

# Except mitre_technique_mitigation_only which checks Activity Field and then Function input

activity_field_given = rule.properties.mitre_technique_id or rule.properties.mitre_technique_name
incident_properties_given = incident.properties.mitre_technique_name or incident.properties.mitre_technique_id

if activity_field_given:
  inputs.mitre_technique_name = rule.properties.mitre_technique_name
  inputs.mitre_technique_id = rule.properties.mitre_technique_id
elif incident_properties_given:
  inputs.mitre_technique_id = incident.properties.mitre_technique_id
  inputs.mitre_technique_name = incident.properties.mitre_technique_name

inputs.mitre_technique_mitigation_only = rule.properties.mitre_technique_mitigation_only if rule.properties.mitre_technique_mitigation_only is not None else inputs.mitre_technique_mitigation_only
```

### Post-Processing Script
```python
"""
Content in the ResultPayload:
        {
            "name": "Name of the technique",
            "description": "Description of the technique",
            "external_references": ["url1", "url2"],
            "x_mitre_detection": "Detection procedure",
            "id": :"Technique's ID",
            "collection": "Collection that the technique belongs to",
            "mitre_mitigations": [
              {
                "name": "String",
                "description": "String",
                "id": "String",
                "collection": "String"
              }
            ],
            "tactic": "Tactic Name" or None
        }
"""

att_techs = results.content["mitre_techniques"]

if not isinstance(att_techs, list):
  att_techs = [att_techs]

for att_tech in att_techs:
  tech_row = incident.addRow("mitre_attack_techniques")
  tech_row["collection"] = att_tech.get("collection", "")
  tech_row["tactic"] = att_tech.get("tactic", "")
  tech_row["technique_name"] = att_tech["name"]
  tech_row["technique_description"] = helper.createRichText(att_tech["description"])
  refs = att_tech["external_references"]
  ref_html = ""
  for ref in refs:
    ref_html = ref_html + '<a href="' + ref["url"] + '">' + ref["url"] + '</a><br>'
  tech_row["references"] = helper.createRichText(ref_html)
  tech_row["detection"] = helper.createRichText(att_tech["x_mitre_detection"])
  tech_row["technique_id"] = att_tech["id"]
```

---

