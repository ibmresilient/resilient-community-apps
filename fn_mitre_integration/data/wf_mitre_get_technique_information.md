<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example of getting MITRE technique information


## Function - MITRE Technique Information

### API Name
`mitre_technique_information`

### Output Name
`None`

### Message Destination
`fn_mitre_integration`

### Pre-Processing Script
```python
activity_field_given = rule.properties.mitre_technique_id or rule.properties.mitre_technique_name
incident_properties_given = incident.properties.mitre_technique_name or incident.properties.mitre_technique_id

if activity_field_given:
  inputs.mitre_technique_name = rule.properties.mitre_technique_name
  inputs.mitre_technique_id = rule.properties.mitre_technique_id
elif incident_properties_given:
  inputs.mitre_technique_id = incident.properties.mitre_technique_id
  inputs.mitre_technique_name = incident.properties.mitre_technique_name

inputs.mitre_technique_mitigation_only = rule.properties.mitre_technique_mitigation_only if rule.properties.mitre_technique_mitigation_only is not None else inputs.mitre_technique_mitigation_only
```

### Post-Processing Script
```python
att_techs = results.content["mitre_techniques"]

if not isinstance(att_techs, list):
  att_techs = [att_techs]

for att_tech in att_techs:
  tech_row = incident.addRow("mitre_attack_techniques")
  tech_row["collection"] = att_tech.get("collection", "")
  tech_row["tactic"] = ""
  tech_row["technique_name"] = att_tech["name"]
  tech_row["technique_description"] = helper.createRichText(att_tech["description"])
  refs = att_tech["external_references"]
  ref_html = ""
  for ref in refs:
    ref_html = ref_html + '<a href="' + ref["url"] + '">' + ref["url"] + '</a><br>'
  tech_row["references"] = helper.createRichText(ref_html)
  tech_row["detection"] = helper.createRichText(att_tech["x_mitre_detection"])
  tech_row["technique_id"] = att_tech["id"]
```

---

