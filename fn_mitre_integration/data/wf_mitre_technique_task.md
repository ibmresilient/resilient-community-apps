<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: MITRE Add a Task from a Technique


## Function - MITRE Technique Information

### API Name
`mitre_technique_information`

### Output Name
`None`

### Message Destination
`fn_mitre_integration`

### Pre-Processing Script
```python
inputs.mitre_technique_id = row.technique_id
inputs.mitre_technique_name = row.technique_name
```

### Post-Processing Script
```python
""" An example of returned data in ResultPayload. Whether it's queried by id or name a list will be returned.
{
  "mitre_techniques": [
    {
      "name": "String", 
      "description": "String",
      "external_references": [{"url": "String"}],
      "x_mitre_detection": "String",
      "id": "String",
      "collection": "String",
      "tactic": "String",
      "mitre_mitigations": [
        {
          "name": "String",
          "description": "String",
          "id": "String",
          "collection": "String"
        }
      ]
    }
  ]
}
"""

techniques = results.content["mitre_techniques"]

if not isinstance(techniques, list):
  techniques = [techniques]

for technique in techniques:
  task_title = "MITRE ATT&CK Technique: " + technique["name"]
  
  mitigations = technique.get("mitre_mitigations", None)
  if not mitigations:
    mitigation_text = "No mitigations found"
  else:
    mitigation_text = []
    for mitigation in mitigations:
      mitigation_text.append(u"""
      <h3>{0}</h3>
      <p>{1}</p>
      """.format(mitigation["name"], mitigation["description"]))
    mitigation_text = "".join(mitigation_text)
  
  task_summary=u"""
  <h1> Description </h1>
  {des}
  <h1> Detection </h1>
  {det}
  <h1> Mitigation </h1>
  {miti}
  """.format(des=technique.get("description", ""), det=technique.get("x_mitre_detection", ""), miti=mitigation_text)
  incident.addTask(task_title, "Detect/Analyze", helper.createRichText(task_summary))
```

---

