# -*- coding: utf-8 -*-
# pragma pylint: disable=unused-argument, no-self-use
# (c) Copyright IBM Corp. 2010, 2019. All Rights Reserved.

class MitreQueryMocker(object):
    """
    Whole class exists to patch MitreAttackConnection's query to return data from saved data.
    query is called 3 times during each of `get_items` calls; 1 time per collection, so we have 3 arrays of data
    per category, and return one at a time, counting the number of calls made.
    We mod the index we return, just in case more collections get added down the road.
    """
    TACTICS =   [
                [{'x_mitre_deprecated': True, 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': '<code>Unsupported tag</code> The adversary is trying to manipulate, interrupt, or destroy your systems and data.\n \nImpact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.', 'type': 'x-mitre-tactic', 'name': 'Impact', 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'x-mitre-tactic--5569339b-94c2-49ee-afb3-2222936582c8', 'external_references': [{'external_id': 'TA0040', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/tactics/TA0040'}], 'modified': '2019-07-25T18:42:23.222Z', 'created': '2019-03-14T18:44:44.639Z', 'x_mitre_shortname': 'impact'}],
                [{'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': "The adversary is trying to gather data of interest to their goal.\n\nCollection consists of techniques adversaries may use to gather information and the sources information is collected from that are relevant to following through on the adversary's objectives. Frequently, the next goal after collecting data is to steal (exfiltrate) the data. Common target sources include various drive types, browsers, audio, video, and email. Common collection methods include capturing screenshots and keyboard input.", 'type': 'x-mitre-tactic', 'id': 'x-mitre-tactic--d108ce10-2419-4cf9-a774-46161d6c6cfe', 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'name': 'Collection', 'external_references': [{'external_id': 'TA0009', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/tactics/TA0009'}], 'modified': '2019-07-19T17:44:53.176Z', 'created': '2018-10-17T00:14:20.652Z', 'x_mitre_shortname': 'collection'}, {'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': 'The adversary is trying to communicate with compromised systems to control them.\n\nCommand and Control consists of techniques that adversaries may use to communicate with systems under their control within a victim network. Adversaries commonly attempt to mimic normal, expected traffic to avoid detection. There are many ways an adversary can establish command and control with various levels of stealth depending on the victim’s network structure and defenses.', 'type': 'x-mitre-tactic', 'id': 'x-mitre-tactic--f72804c5-f15a-449e-a5da-2eecd181f813', 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'name': 'Command and Control', 'external_references': [{'external_id': 'TA0011', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/tactics/TA0011'}], 'modified': '2019-07-19T17:45:30.644Z', 'created': '2018-10-17T00:14:20.652Z', 'x_mitre_shortname': 'command-and-control'}, {'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': 'The adversary is trying to steal account names and passwords.\n\nCredential Access consists of techniques for stealing credentials like account names and passwords. Techniques used to get credentials include keylogging or credential dumping. Using legitimate credentials can give adversaries access to systems, make them harder to detect, and provide the opportunity to create more accounts to help achieve their goals.', 'type': 'x-mitre-tactic', 'id': 'x-mitre-tactic--2558fd61-8c75-4730-94c4-11926db2a263', 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'name': 'Credential Access', 'external_references': [{'external_id': 'TA0006', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/tactics/TA0006'}], 'modified': '2019-07-19T17:43:41.967Z', 'created': '2018-10-17T00:14:20.652Z', 'x_mitre_shortname': 'credential-access'}],
                [{'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': 'The adversary is trying to manipulate, interrupt, or destroy your systems and data.\n \nImpact consists of techniques that adversaries use to disrupt availability or compromise integrity by manipulating business and operational processes. Techniques used for impact can include destroying or tampering with data. In some cases, business processes can look fine, but may have been altered to benefit the adversaries’ goals. These techniques might be used by adversaries to follow through on their end goal or to provide cover for a confidentiality breach.', 'type': 'x-mitre-tactic', 'name': 'Impact', 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'x-mitre-tactic--5569339b-94c2-49ee-afb3-2222936582c8', 'external_references': [{'external_id': 'TA0040', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/tactics/TA0040'}], 'modified': '2019-07-25T18:42:23.222Z', 'created': '2019-03-14T18:44:44.639Z', 'x_mitre_shortname': 'impact'},{'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': 'The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ', 'type': 'x-mitre-tactic', 'id': 'x-mitre-tactic--c17c5845-175e-4421-9713-829d0573dbc9', 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'name': 'Discovery', 'external_references': [{'external_id': 'TA0007', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/tactics/TA0007'}], 'modified': '2019-07-19T17:44:13.228Z', 'created': '2018-10-17T00:14:20.652Z', 'x_mitre_shortname': 'discovery'}]
                ]
    TECHNIQUES =[
                [{'x_mitre_deprecated': True, "type": "attack-pattern",    "id": "attack-pattern--54456690-84de-4538-9101-643e26437e09",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2019-02-18T17:22:57.831Z",    "modified": "2019-04-29T14:04:35.908Z",    "name": "Domain Generation Algorithms",    "description": "<code>Unsupported tag</code> Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)\n\nDGAs can take the form of apparently random or \u201cgibberish\u201d strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)\n\nAdversaries may use DGAs for the purpose of [Fallback Channels](https://attack.mitre.org/techniques/T1008). When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity)",    "kill_chain_phases": [        {            "kill_chain_name": "mitre-attack",            "phase_name": "command-and-control"        }    ],    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/techniques/T1483",            "external_id": "T1483"        },        {            "source_name": "Cybereason Dissecting DGAs",            "description": "Sternfeld, U. (2016). Dissecting Domain Generation Algorithms: Eight Real World DGA Variants. Retrieved February 18, 2019.",            "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-Dissecting-DGAs-Eight-Real-World-DGA-Variants.pdf"        },        {            "source_name": "Cisco Umbrella DGA",            "description": "Scarfo, A. (2016, October 10). Domain Generation Algorithms \u2013 Why so effective?. Retrieved February 18, 2019.",            "url": "https://umbrella.cisco.com/blog/2016/10/10/domain-generation-algorithms-effective/"        },        {            "source_name": "Unit 42 DGA Feb 2019",            "description": "Unit 42. (2019, February 7). Threat Brief: Understanding Domain Generation Algorithms (DGA). Retrieved February 19, 2019.",            "url": "https://unit42.paloaltonetworks.com/threat-brief-understanding-domain-generation-algorithms-dga/"        },        {            "source_name": "Talos CCleanup 2017",            "description": "Brumaghin, E. et al. (2017, September 18). CCleanup: A Vast Number of Machines at Risk. Retrieved March 9, 2018.",            "url": "http://blog.talosintelligence.com/2017/09/avast-distributes-malware.html"        },        {            "source_name": "Akamai DGA Mitigation",            "description": "Liu, H. and Yuzifovich, Y. (2018, January 9). A Death Match of Domain Generation Algorithms. Retrieved February 18, 2019.",            "url": "https://blogs.akamai.com/2018/01/a-death-match-of-domain-generation-algorithms.html"        },        {            "source_name": "FireEye POSHSPY April 2017",            "description": "Dunwoody, M.. (2017, April 3). Dissecting One of APT29\u2019s Fileless WMI and PowerShell Backdoors (POSHSPY). Retrieved April 5, 2017.",            "url": "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"        },        {            "source_name": "ESET Sednit 2017 Activity",            "description": "ESET. (2017, December 21). Sednit update: How Fancy Bear Spent the Year. Retrieved February 18, 2019.",            "url": "https://www.welivesecurity.com/2017/12/21/sednit-update-fancy-bear-spent-year/"        },        {            "source_name": "Data Driven Security DGA",            "description": "Jacobs, J. (2014, October 2). Building a DGA Classifier: Part 2, Feature Engineering. Retrieved February 18, 2019.",            "url": "https://datadrivensecurity.info/blog/posts/2014/Oct/dga-part2/"        },        {            "source_name": "Pace University Detecting DGA May 2017",            "description": "Chen, L., Wang, T.. (2017, May 5). Detecting Algorithmically Generated Domains Using Data Visualization and N-Grams Methods . Retrieved April 26, 2019.",            "url": "http://csis.pace.edu/~ctappert/srd2017/2017PDF/d4.pdf"        },        {            "source_name": "Endgame Predicting DGA",            "description": "Ahuja, A., Anderson, H., Grant, D., Woodbridge, J.. (2016, November 2). Predicting Domain Generation Algorithms with Long Short-Term Memory Networks. Retrieved April 26, 2019.",            "url": "https://arxiv.org/pdf/1611.00791.pdf"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_contributors": [        "Sylvain Gil, Exabeam",        "Barry Shteiman, Exabeam",        "Ryan Benson, Exabeam"    ],    "x_mitre_data_sources": [        "Process use of network",        "Packet capture",        "Network device logs",        "Netflow/Enclave netflow",        "DNS records"    ],    "x_mitre_detection": "<code>Unsupported tag</code> Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There is a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, another more general approach for detecting a suspicious domain is to check for recently registered names or for rarely visited domains.\n\nMachine learning approaches to detecting DGA domains have been developed and have seen success in applications. One approach is to use N-Gram methods to determine a randomness score for strings used in the domain name. If the randomness score is high, and the domains are not whitelisted (CDN, etc), then it may be determined if a domain or related to a legitimate host or DGA.(Citation: Pace University Detecting DGA May 2017) Another approach is to use deep learning to classify domains as DGA-generated.(Citation: Endgame Predicting DGA)",    "x_mitre_permissions_required": [        "User"    ],    "x_mitre_platforms": [        "Linux",        "macOS",        "Windows"    ],    "x_mitre_version": "1.0"}],
                [{"type": "attack-pattern",    "id": "attack-pattern--451a9977-d255-43c9-b431-66de80130c8c",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2018-04-18T17:59:24.739Z",    "modified": "2018-10-17T00:14:20.652Z",    "name": "Port Knocking",    "description": "Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access. To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. \n\nThis technique has been observed to both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",    "kill_chain_phases": [        {            "kill_chain_name": "mitre-attack",            "phase_name": "defense-evasion"        },        {            "kill_chain_name": "mitre-attack",            "phase_name": "persistence"        },        {            "kill_chain_name": "mitre-attack",            "phase_name": "command-and-control"        }    ],    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/techniques/T1205",            "external_id": "T1205"        },        {            "source_name": "Hartrell cd00r 2002",            "description": "Hartrell, Greg. (2002, August). Get a handle on cd00r: The invisible backdoor. Retrieved October 13, 2018.",            "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_defense_bypassed": [        "Defensive network service scanning"    ],    "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.",    "x_mitre_network_requirements": True,    "x_mitre_permissions_required": [        "User"    ],    "x_mitre_platforms": [        "Linux",        "macOS"    ],    "x_mitre_version": "1.0"},{    "type": "attack-pattern",    "id": "attack-pattern--4061e78c-1284-44b4-9116-73e4ac3912f7",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2018-04-18T17:59:24.739Z",    "modified": "2018-10-31T13:45:13.024Z",    "name": "Remote Access Tools",    "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be whitelisted within a target environment. Remote access tools like VNC, Ammy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n\nRemote access tools may be established and used post-compromise as alternate communications channel for [Redundant Access](https://attack.mitre.org/techniques/T1108) or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system.\n\nAdmin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns. (Citation: CrowdStrike 2015 Global Threat Report) (Citation: CrySyS Blog TeamSpy)",    "kill_chain_phases": [        {            "kill_chain_name": "mitre-attack",            "phase_name": "command-and-control"        }    ],    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/techniques/T1219",            "external_id": "T1219"        },        {            "source_name": "Symantec Living off the Land",            "description": "Wueest, C., Anand, H. (2017, July). Living off the land and fileless attack techniques. Retrieved April 10, 2018.",            "url": "https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-living-off-the-land-and-fileless-attack-techniques-en.pdf"        },        {            "source_name": "CrowdStrike 2015 Global Threat Report",            "description": "CrowdStrike Intelligence. (2016). 2015 Global Threat Report. Retrieved April 11, 2018.",            "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/15GlobalThreatReport.pdf"        },        {            "source_name": "CrySyS Blog TeamSpy",            "description": "CrySyS Lab. (2013, March 20). TeamSpy \u2013 Obshie manevri. Ispolzovat\u2019 tolko s razreshenija S-a. Retrieved April 11, 2018.",            "url": "https://blog.crysys.hu/2013/03/teamspy/"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_contributors": [        "Matt Kelly, @breakersall"    ],    "x_mitre_data_sources": [        "Network intrusion detection system",        "Network protocol analysis",        "Process use of network",        "Process monitoring"    ],    "x_mitre_detection": "Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\n\n[Domain Fronting](https://attack.mitre.org/techniques/T1172) may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.",    "x_mitre_network_requirements": True,    "x_mitre_permissions_required": [        "User"    ],    "x_mitre_platforms": [        "Linux",        "Windows",        "macOS"    ],    "x_mitre_version": "1.0"}],
                [{"type": "attack-pattern",    "id": "attack-pattern--d28ef391-8ed4-45dc-bc4a-2f43abf54416",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2018-04-18T17:59:24.739Z",    "modified": "2018-10-31T13:45:13.024Z",    "name": "Data from Information Repositories",    "description": "Adversaries may leverage information repositories to mine valuable information. Information repositories are tools that allow for storage of information, typically to facilitate collaboration or information sharing between users, and can store a wide variety of data that may aid adversaries in further objectives, or direct access to the target information.\n\nThe following is a brief list of example information that may hold potential value to an adversary and may also be found on an information repository:\n\n* Policies, procedures, and standards\n* Physical / logical network diagrams\n* System architecture diagrams\n* Technical system documentation\n* Testing / development credentials\n* Work / project schedules\n* Source code snippets\n* Links to network shares and other internal resources\n\nSpecific common information repositories include:\n\n### Microsoft SharePoint\nFound in many enterprise networks and often used to store and share significant amounts of documentation.\n\n### Atlassian Confluence\nOften found in development environments alongside Atlassian JIRA, Confluence is generally used to store development-related documentation.",    "kill_chain_phases": [        {            "kill_chain_name": "mitre-attack",            "phase_name": "collection"        }    ],    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/techniques/T1213",            "external_id": "T1213"        },        {            "source_name": "Microsoft SharePoint Logging",            "description": "Microsoft. (2017, July 19). Configure audit settings for a site collection. Retrieved April 4, 2018.",            "url": "https://support.office.com/en-us/article/configure-audit-settings-for-a-site-collection-a9920c97-38c0-44f2-8bcb-4cf1e2ae22d2"        },        {            "source_name": "Atlassian Confluence Logging",            "description": "Atlassian. (2018, January 9). How to Enable User Access Logging. Retrieved April 4, 2018.",            "url": "https://confluence.atlassian.com/confkb/how-to-enable-user-access-logging-182943.html"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_contributors": [        "Milos Stojadinovic"    ],    "x_mitre_data_sources": [        "Application logs",        "Authentication logs",        "Data loss prevention",        "Third-party application logs"    ],    "x_mitre_detection": "As information repositories generally have a considerably large user base, detection of malicious use can be non-trivial. At minimum, access to information repositories performed by privileged users (for example, Active Directory Domain, Enterprise, or Schema Administrators) should be closely monitored and alerted upon, as these types of accounts should not generally used to access information repositories. If the capability exists, it may be of value to monitor and alert on users that are retrieving and viewing a large number of documents and pages; this behavior may be indicative of programmatic means being used to retrieve all data within the repository. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user based anomalies.\n\nThe user access logging within Microsoft's SharePoint can be configured to report access to certain pages and documents. (Citation: Microsoft SharePoint Logging) The user user access logging within Atlassian's Confluence can also be configured to report access to certain pages and documents through AccessLogFilter. (Citation: Atlassian Confluence Logging) Additional log storage and analysis infrastructure will likely be required for more robust detection capabilities.",    "x_mitre_permissions_required": [        "User"    ],    "x_mitre_platforms": [        "Linux",        "Windows",        "macOS"    ],    "x_mitre_version": "1.0"}, {"type": "attack-pattern",    "id": "attack-pattern--451a9977-d255-43c9-b431-66de80130c8c",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2018-04-18T17:59:24.739Z",    "modified": "2018-10-17T00:14:20.652Z",    "name": "Port Knocking",    "description": "Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access. To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. \n\nThis technique has been observed to both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.\n\nThe observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.",    "kill_chain_phases": [        {            "kill_chain_name": "mitre-attack",            "phase_name": "defense-evasion"        },        {            "kill_chain_name": "mitre-attack",            "phase_name": "persistence"        },        {            "kill_chain_name": "mitre-attack",            "phase_name": "command-and-control"        }    ],    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/techniques/T1205",            "external_id": "T1205"        },        {            "source_name": "Hartrell cd00r 2002",            "description": "Hartrell, Greg. (2002, August). Get a handle on cd00r: The invisible backdoor. Retrieved October 13, 2018.",            "url": "https://www.giac.org/paper/gcih/342/handle-cd00r-invisible-backdoor/103631"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_defense_bypassed": [        "Defensive network service scanning"    ],    "x_mitre_detection": "Record network packets sent to and from the system, looking for extraneous packets that do not belong to established flows.",    "x_mitre_network_requirements": True,    "x_mitre_permissions_required": [        "User"    ],    "x_mitre_platforms": [        "Linux",        "macOS"    ],    "x_mitre_version": "1.0"}]
                ]
    MITIGATIONS=[
                [{'x_mitre_deprecated': True, "type": "course-of-action",    "id": "course-of-action--f6b7c116-0821-4eb7-9b24-62bd09b3e575",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2018-10-17T00:14:20.652Z",    "modified": "2019-07-25T11:25:50.338Z",    "name": "Port Knocking Mitigation",    "description": "<code>Unsupported tag</code> Mitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented.",    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/mitigations/T1205",            "external_id": "T1205"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_deprecated": True,    "x_mitre_version": "1.0"}],
                [{"type": "course-of-action",    "id": "course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d",    "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",    "created": "2019-06-11T16:33:55.337Z",    "modified": "2019-06-11T16:33:55.337Z",    "name": "Filter Network Traffic",    "description": "Use network appliances to filter ingress or egress traffic and perform protocol-based filtering.",    "external_references": [        {            "source_name": "mitre-attack",            "url": "https://attack.mitre.org/mitigations/M1037",            "external_id": "M1037"        }    ],    "object_marking_refs": [        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"    ],    "x_mitre_version": "1.0"}],
                []
                ]
    SOFTWARE =  [
                [{'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': '[Pegasus for iOS](https://attack.mitre.org/software/S0289) is the iOS version of malware that has reportedly been linked to the NSO Group. It has been advertised and sold to target high-value victims. (Citation: Lookout-Pegasus) (Citation: PegasusCitizenLab) The Android version is tracked separately under [Pegasus for Android](https://attack.mitre.org/software/S0316).', 'id': 'malware--33d9d91d-aad9-49d5-a516-220ce101ac8a', 'external_references': [{'external_id': 'S0289', 'source_name': 'mitre-mobile-attack', 'url': 'https://attack.mitre.org/software/S0289'}, {'source_name': 'Pegasus for iOS', 'description': '(Citation: Lookout-Pegasus) (Citation: PegasusCitizenLab)'}, {'source_name': 'Lookout-Pegasus', 'description': 'Lookout. (2016). Technical Analysis of Pegasus Spyware. Retrieved December 12, 2016.', 'url': 'https://info.lookout.com/rs/051-ESQ-475/images/lookout-pegasus-technical-analysis.pdf'}, {'source_name': 'PegasusCitizenLab', 'description': 'Bill Marczak and John Scott-Railton. (2016, August 24). The Million Dollar Dissident: NSO Group’s iPhone Zero-Days used against a UAE Human Rights Defender. Retrieved December 12, 2016.', 'url': 'https://citizenlab.org/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'modified': '2018-12-11 20:40:31.461000+00:00', 'type': 'malware', 'created': '2017-10-25 14:48:44.238000+00:00', 'name': 'Pegasus for iOS', 'labels': ['malware'], 'x_mitre_old_attack_id': 'MOB-S0005', 'x_mitre_version': '1.1', 'x_mitre_platforms': ['iOS'], 'x_mitre_aliases': ['Pegasus for iOS'], 'revoked': 'False'}],
                [{'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'description': '[Adups](https://attack.mitre.org/software/S0309) is software that was pre-installed onto Android devices, including those made by BLU Products. The software was reportedly designed to help a Chinese phone manufacturer monitor user behavior, transferring sensitive data to a Chinese server. (Citation: NYTimes-BackDoor) (Citation: BankInfoSecurity-BackDoor)', 'id': 'malware--f6ac21b6-2592-400c-8472-10d0e2f1bfaf', 'external_references': [{'external_id': 'S0309', 'source_name': 'mitre-mobile-attack', 'url': 'https://attack.mitre.org/software/S0309'}, {'source_name': 'Adups', 'description': '(Citation: NYTimes-BackDoor) (Citation: BankInfoSecurity-BackDoor)'}, {'source_name': 'NYTimes-BackDoor', 'description': 'Matt Apuzzo and Michael S. Schmidt. (2016, November 15). Secret Back Door in Some U.S. Phones Sent Data to China, Analysts Say. Retrieved February 6, 2017.', 'url': 'https://www.nytimes.com/2016/11/16/us/politics/china-phones-software-security.html'}, {'source_name': 'BankInfoSecurity-BackDoor', 'description': 'Jeremy Kirk. (2016, November 16). Why Did Chinese Spyware Linger in U.S. Phones?. Retrieved February 6, 2017.', 'url': 'http://www.bankinfosecurity.com/did-chinese-spyware-linger-in-us-phones-a-9534'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'modified': '2018-12-11 20:40:31.461000+00:00', 'type': 'malware', 'created': '2017-10-25 14:48:47.038000+00:00', 'name': 'Adups', 'labels': ['malware'], 'x_mitre_old_attack_id': 'MOB-S0025', 'x_mitre_version': '1.1', 'x_mitre_platforms': ['Android'], 'x_mitre_aliases': ['Adups'], 'revoked': 'False'}],
                []
                ]
    GROUPS     =[
                [{'type': 'intrusion-set', 'id': 'intrusion-set--bef4c620-0787-42a8-a96d-b7eb6e85917c', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'created': '2017-05-31T21:31:48.664Z', 'modified': '2019-07-27T00:09:33.254Z', 'name': 'APT28', 'description': "[APT28](https://attack.mitre.org/groups/G0007) is a threat group that has been attributed to Russia's Main Intelligence Directorate of the Russian General Staff by a July 2018 U.S. Department of Justice indictment. This group reportedly compromised the Hillary Clinton campaign, the Democratic National Committee, and the Democratic Congressional Campaign Committee in 2016 in an attempt to interfere with the U.S. presidential election. [APT28](https://attack.mitre.org/groups/G0007) has been active since at least 2004.(Citation: DOJ GRU Indictment Jul 2018) (Citation: Ars Technica GRU indictment Jul 2018) (Citation: Crowdstrike DNC June 2016) (Citation: FireEye APT28) (Citation: SecureWorks TG-4127) (Citation: FireEye APT28 January 2017) (Citation: GRIZZLY STEPPE JAR) (Citation: Sofacy DealersChoice) (Citation: Palo Alto Sofacy 06-2018) (Citation: Symantec APT28 Oct 2018) (Citation: ESET Zebrocy May 2019)", 'aliases': ['APT28', 'SNAKEMACKEREL', 'Swallowtail', 'Group 74', 'Sednit', 'Sofacy', 'Pawn Storm', 'Fancy Bear', 'STRONTIUM', 'Tsar Team', 'Threat Group-4127', 'TG-4127'], 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/groups/G0007', 'external_id': 'G0007'}, {'source_name': 'APT28', 'description': '(Citation: FireEye APT28) (Citation: SecureWorks TG-4127) (Citation: Crowdstrike DNC June 2016) (Citation: Kaspersky Sofacy) (Citation: ESET Sednit Part 3) (Citation: Ars Technica GRU indictment Jul 2018)(Citation: Talos Seduploader Oct 2017)(Citation: Symantec APT28 Oct 2018)(Citation: Securelist Sofacy Feb 2018)'}, {'source_name': 'SNAKEMACKEREL', 'description': '(Citation: Accenture SNAKEMACKEREL Nov 2018)'}, {'source_name': 'Swallowtail', 'description': '(Citation: Symantec APT28 Oct 2018)'}, {'source_name': 'Group 74', 'description': '(Citation: Talos Seduploader Oct 2017)'}, {'source_name': 'Sednit', 'description': 'This designation has been used in reporting both to refer to the threat group and its associated malware JHUHUGIT. (Citation: FireEye APT28 January 2017) (Citation: SecureWorks TG-4127) (Citation: Kaspersky Sofacy) (Citation: Ars Technica GRU indictment Jul 2018)'}, {'source_name': 'Sofacy', 'description': 'This designation has been used in reporting both to refer to the threat group and its associated malware. (Citation: FireEye APT28) (Citation: SecureWorks TG-4127) (Citation: Crowdstrike DNC June 2016) (Citation: ESET Sednit Part 3) (Citation: Ars Technica GRU indictment Jul 2018)(Citation: Talos Seduploader Oct 2017)'}, {'source_name': 'Pawn Storm', 'description': '(Citation: SecureWorks TG-4127) (Citation: ESET Sednit Part 3)'}, {'source_name': 'Fancy Bear', 'description': '(Citation: Crowdstrike DNC June 2016) (Citation: Kaspersky Sofacy) (Citation: ESET Sednit Part 3) (Citation: Ars Technica GRU indictment Jul 2018)(Citation: Talos Seduploader Oct 2017)(Citation: Symantec APT28 Oct 2018)(Citation: Securelist Sofacy Feb 2018)'}, {'source_name': 'STRONTIUM', 'description': '(Citation: Kaspersky Sofacy) (Citation: ESET Sednit Part 3)'}, {'source_name': 'Tsar Team', 'description': '(Citation: ESET Sednit Part 3)(Citation: Talos Seduploader Oct 2017)(Citation: Talos Seduploader Oct 2017)'}, {'source_name': 'Threat Group-4127', 'description': '(Citation: SecureWorks TG-4127)'}, {'source_name': 'TG-4127', 'description': '(Citation: SecureWorks TG-4127)'}, {'source_name': 'DOJ GRU Indictment Jul 2018', 'description': 'Mueller, R. (2018, July 13). Indictment - United States of America vs. VIKTOR BORISOVICH NETYKSHO, et al. Retrieved September 13, 2018.', 'url': 'https://www.justice.gov/file/1080281/download'}, {'source_name': 'Ars Technica GRU indictment Jul 2018', 'description': 'Gallagher, S. (2018, July 27). How they did it (and will likely try again): GRU hackers vs. US elections. Retrieved September 13, 2018.', 'url': 'https://arstechnica.com/information-technology/2018/07/from-bitly-to-x-agent-how-gru-hackers-targeted-the-2016-presidential-election/'}, {'source_name': 'Crowdstrike DNC June 2016', 'description': 'Alperovitch, D.. (2016, June 15). Bears in the Midst: Intrusion into the Democratic National Committee. Retrieved August 3, 2016.', 'url': 'https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/'}, {'source_name': 'FireEye APT28', 'description': 'FireEye. (2015). APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?. Retrieved August 19, 2015.', 'url': 'https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf'}, {'source_name': 'SecureWorks TG-4127', 'description': 'SecureWorks Counter Threat Unit Threat Intelligence. (2016, June 16). Threat Group-4127 Targets Hillary Clinton Presidential Campaign. Retrieved August 3, 2016.', 'url': 'https://www.secureworks.com/research/threat-group-4127-targets-hillary-clinton-presidential-campaign'}, {'source_name': 'FireEye APT28 January 2017', 'description': 'FireEye iSIGHT Intelligence. (2017, January 11). APT28: At the Center of the Storm. Retrieved January 11, 2017.', 'url': 'https://www2.fireeye.com/rs/848-DID-242/images/APT28-Center-of-Storm-2017.pdf'}, {'source_name': 'GRIZZLY STEPPE JAR', 'description': 'Department of Homeland Security and Federal Bureau of Investigation. (2016, December 29). GRIZZLY STEPPE – Russian Malicious Cyber Activity. Retrieved January 11, 2017.', 'url': 'https://www.us-cert.gov/sites/default/files/publications/JAR_16-20296A_GRIZZLY%20STEPPE-2016-1229.pdf'}, {'source_name': 'Sofacy DealersChoice', 'description': 'Falcone, R. (2018, March 15). Sofacy Uses DealersChoice to Target European Government Agency. Retrieved June 4, 2018.', 'url': 'https://researchcenter.paloaltonetworks.com/2018/03/unit42-sofacy-uses-dealerschoice-target-european-government-agency/'}, {'source_name': 'Palo Alto Sofacy 06-2018', 'description': 'Lee, B., Falcone, R. (2018, June 06). Sofacy Group’s Parallel Attacks. Retrieved June 18, 2018.', 'url': 'https://researchcenter.paloaltonetworks.com/2018/06/unit42-sofacy-groups-parallel-attacks/'}, {'source_name': 'Symantec APT28 Oct 2018', 'description': 'Symantec Security Response. (2018, October 04). APT28: New Espionage Operations Target Military and Government Organizations. Retrieved November 14, 2018.', 'url': 'https://www.symantec.com/blogs/election-security/apt28-espionage-military-government'}, {'source_name': 'ESET Zebrocy May 2019', 'description': 'ESET Research. (2019, May 22). A journey to Zebrocy land. Retrieved June 20, 2019.', 'url': 'https://www.welivesecurity.com/2019/05/22/journey-zebrocy-land/'}, {'source_name': 'Kaspersky Sofacy', 'description': "Kaspersky Lab's Global Research and Analysis Team. (2015, December 4). Sofacy APT hits high profile targets with updated toolset. Retrieved December 10, 2015.", 'url': 'https://securelist.com/sofacy-apt-hits-high-profile-targets-with-updated-toolset/72924/'}, {'source_name': 'ESET Sednit Part 3', 'description': 'ESET. (2016, October). En Route with Sednit - Part 3: A Mysterious Downloader. Retrieved November 21, 2016.', 'url': 'http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf'}, {'source_name': 'Talos Seduploader Oct 2017', 'description': 'Mercer, W., et al. (2017, October 22). "Cyber Conflict" Decoy Document Used in Real Cyber Conflict. Retrieved November 2, 2018.', 'url': 'https://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html'}, {'source_name': 'Securelist Sofacy Feb 2018', 'description': "Kaspersky Lab's Global Research & Analysis Team. (2018, February 20). A Slice of 2017 Sofacy Activity. Retrieved November 27, 2018.", 'url': 'https://securelist.com/a-slice-of-2017-sofacy-activity/83930/'}, {'source_name': 'Accenture SNAKEMACKEREL Nov 2018', 'description': 'Accenture Security. (2018, November 29). SNAKEMACKEREL. Retrieved April 15, 2019.', 'url': 'https://www.accenture.com/t20181129T203820Z__w__/us-en/_acnmedia/PDF-90/Accenture-snakemackerel-delivers-zekapab-malware.pdf#zoom=50'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_contributors': ['Emily Ratliff, IBM', 'Richard Gold, Digital Shadows'], 'x_mitre_version': '2.1'}],
                [{'type': 'intrusion-set', 'id': 'intrusion-set--6713ab67-e25b-49cc-808d-2b36d4fbc35c', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'created': '2017-05-31T21:31:47.177Z', 'modified': '2019-04-22T15:08:48.005Z', 'name': 'Ke3chang', 'description': '[Ke3chang](https://attack.mitre.org/groups/G0004) is a threat group attributed to actors operating out of China.\n[Ke3chang](https://attack.mitre.org/groups/G0004) has targeted several industries, including oil, government, military, and more. (Citation: Villeneuve et al 2014) (Citation: NCC Group APT15 Alive and Strong) (Citation: APT15 Intezer June 2018)', 'aliases': ['Ke3chang', 'APT15', 'Mirage', 'Vixen Panda', 'GREF', 'Playful Dragon', 'RoyalAPT'], 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/groups/G0004', 'external_id': 'G0004'}, {'source_name': 'Ke3chang', 'description': '(Citation: Villeneuve et al 2014) (Citation: NCC Group APT15 Alive and Strong) (Citation: APT15 Intezer June 2018)'}, {'source_name': 'APT15', 'description': '(Citation: NCC Group APT15 Alive and Strong)'}, {'source_name': 'Mirage', 'description': '(Citation: NCC Group APT15 Alive and Strong)'}, {'source_name': 'Vixen Panda', 'description': '(Citation: NCC Group APT15 Alive and Strong) (Citation: APT15 Intezer June 2018)'}, {'source_name': 'GREF', 'description': '(Citation: NCC Group APT15 Alive and Strong)'}, {'source_name': 'Playful Dragon', 'description': '(Citation: NCC Group APT15 Alive and Strong) (Citation: APT15 Intezer June 2018)'}, {'source_name': 'RoyalAPT', 'description': '(Citation: APT15 Intezer June 2018)'}, {'source_name': 'Villeneuve et al 2014', 'description': 'Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.', 'url': 'https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-operation-ke3chang.pdf'}, {'source_name': 'NCC Group APT15 Alive and Strong', 'description': 'Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.', 'url': 'https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/'}, {'source_name': 'APT15 Intezer June 2018', 'description': 'Rosenberg, J. (2018, June 14). MirageFox: APT15 Resurfaces With New Tools Based On Old Ones. Retrieved September 21, 2018.', 'url': 'https://www.intezer.com/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones/'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_version': '1.1'}],
                [{'type': 'intrusion-set', 'id': 'intrusion-set--d13c8a7f-740b-4efa-a232-de7d6bb05321', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'created': '2019-05-24T17:57:36.491Z', 'modified': '2019-07-16T16:12:09.085Z', 'name': 'Silence', 'description': "[Silence](https://attack.mitre.org/groups/G0091) is a financially motivated threat actor targeting financial institutions in different countries. The group was first seen in June 2016. Their main targets reside in Russia, Ukraine, Belarus, Azerbaijan, Poland and Kazakhstan. They compromised various banking systems, including the Russian Central Bank's Automated Workstation Client, ATMs, and card processing. (Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017) ", 'aliases': ['Silence'], 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/groups/G0091', 'external_id': 'G0091'}, {'source_name': 'Silence', 'description': '(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017) '}, {'source_name': 'Cyber Forensicator Silence Jan 2019', 'description': 'Skulkin, O.. (2019, January 20). Silence: Dissecting Malicious CHM Files and Performing Forensic Analysis. Retrieved May 24, 2019.', 'url': 'https://cyberforensicator.com/2019/01/20/silence-dissecting-malicious-chm-files-and-performing-forensic-analysis/'}, {'source_name': 'SecureList Silence Nov 2017', 'description': 'GReAT. (2017, November 1). Silence – a new Trojan attacking financial organizations. Retrieved May 24, 2019.', 'url': 'https://securelist.com/the-silence/83009/'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_contributors': ['Oleg Skulkin, Group-IB'], 'x_mitre_version': '1.0'}]
                ]

    def __init__(self):
        self.call = 0  # call keeps track of the array position to return. We expect to always have 3 calls in a row

    def query(self, filters):
        """
        Look through the filters to see what type of data is requested.
        For supported types return one collection of data.
        We expect to get 3 calls,  for each of the collections, so we track the number of function calls to
        make sure we return all of the data.
        """
        res = None

        if not isinstance(filters, list):
            filters = [filters]

        for filt in filters:
            if filt.property == "type":
                if filt.value == "x-mitre-tactic":
                    res = self.tactics(filters)
                    break
                elif filt.value == "attack-pattern":
                    res = self.techniques(filters)
                    break
                elif filt.value == "course-of-action":
                    res = self.mitigations(filters)
                    break
                # software supports 2 types, so we handle the situation when each or a combination is queried
                elif (isinstance(filt.value, (list, tuple)) and filt.value[0] in ["tool", "malware"] and filt.value[1] in ["tool", "malware"]) or \
                    filt.value in ["tool", "malware"]:
                    res = self.software(filters)
                    break
                elif filt.value == "intrusion-set":
                    res = self.groups(filters)
                    break
        self.call += 1  # next collection
        self.call %= 3  # loop through the data we have.
        return res

    def apply_fiters(self, data, filters):
        """
        Simulate some of the basic filters for the purpose of testing.
        Supports selecting items by their id and name.
        """
        result = []
        filtered = False

        for filt in filters:
            if filt.property == "type":
                continue
            elif filt.property == "external_references.external_id":
                result.extend(filter(lambda x: x["external_references"][0]["external_id"] == filt.value, data))
                filtered = True
            elif filt.property == "name":
                result.extend(filter(lambda x: x["name"] == filt.value, data))
                filtered = True
            elif filt.property == "x_mitre_shortname":
                result.extend(filter(lambda x: x.get("x_mitre_shortname", "") == filt.value, data))
        if not filtered:
            result = data

        return result

    def tactics(self, filters):
        """
        :return: list - one of 3, for each datastore queried
        """
        return self.apply_fiters(self.TACTICS[self.call], filters)

    def techniques(self, filters):
        """
        :return: list - one of 3, for each datastore queried
        """
        return self.apply_fiters(self.TECHNIQUES[self.call], filters)

    def mitigations(self, filters):
        """
        :return: list - one of 3, for each datastore queried
        """
        return self.apply_fiters(self.MITIGATIONS[self.call], filters)

    def software(self, filters):
        """
        :return: list - one of 3, for each datastore queried
        """
        return self.apply_fiters(self.SOFTWARE[self.call], filters)

    def groups(self, filters):
        """
        :return: list - one of 3, for each datastore queried
        """
        return self.apply_fiters(self.GROUPS[self.call], filters)
