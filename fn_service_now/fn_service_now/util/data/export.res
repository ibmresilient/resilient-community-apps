{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "export_date": 1684264733161,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/incident_id",
      "hide_notification": false,
      "id": 4531,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_note_text",
      "hide_notification": false,
      "id": 4532,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_note_text",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_note_text",
      "tooltip": "The text of the Comment",
      "type_id": 11,
      "uuid": "908e2bd1-d682-44e1-9240-efb5c2bf23a1",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_close_work_note",
      "hide_notification": false,
      "id": 4533,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_close_work_note",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_close_work_note",
      "tooltip": "A optional note to add to the ServiceNow Record when it is closed from within IBM SOAR",
      "type_id": 11,
      "uuid": "9939f061-85a2-42ac-875a-46168998f3b6",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_init_work_note",
      "hide_notification": false,
      "id": 4534,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_init_work_note",
      "operation_perms": {},
      "operations": [],
      "placeholder": "This Incident originated from our Cyber Security Team using the IBM SOAR platform",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_init_work_note",
      "tooltip": "A custom string of text to be added as initial work_note in ServiceNow",
      "type_id": 11,
      "uuid": "9fb070d7-fc5a-4ca1-8e2e-fc940e53c857",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_query_field",
      "hide_notification": false,
      "id": 4535,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_query_field",
      "operation_perms": {},
      "operations": [],
      "placeholder": "state",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_query_field",
      "tooltip": "The name of the ServiceNow Field to query",
      "type_id": 11,
      "uuid": "a483a5fb-0064-4760-9fe8-7d8312ed1dd2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_query_value",
      "hide_notification": false,
      "id": 4536,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_query_value",
      "operation_perms": {},
      "operations": [],
      "placeholder": "\"In Progress\"",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_query_value",
      "tooltip": "The value to be compared",
      "type_id": 11,
      "uuid": "ad37c004-da73-4b49-9575-a33093897343",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/task_id",
      "hide_notification": false,
      "id": 4537,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "task_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "task_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_close_code",
      "hide_notification": false,
      "id": 4538,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_close_code",
      "operation_perms": {},
      "operations": [],
      "placeholder": "Solved (Permanently)",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_close_code",
      "tooltip": "The ServiceNow close_code i.e. \"Solved (Permanently)\"",
      "type_id": 11,
      "uuid": "bffdd765-d0c1-42bd-8b93-798436cfab93",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_record_state",
      "hide_notification": false,
      "id": 4539,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "sn_record_state",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_record_state",
      "tooltip": "The numeric value of the state of the record in ServiceNow",
      "type_id": 11,
      "uuid": "f0eb15f5-fb36-4c6d-b489-352befbe3ea3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_close_notes",
      "hide_notification": false,
      "id": 4540,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_close_notes",
      "operation_perms": {},
      "operations": [],
      "placeholder": "Incident resolved in SOAR. No further action needed",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_close_notes",
      "tooltip": "The reason for resolving this record",
      "type_id": 11,
      "uuid": "f234db2f-dfe8-401f-a3b9-f5f87921e21f",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_optional_fields",
      "hide_notification": false,
      "id": 4541,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_optional_fields",
      "operation_perms": {},
      "operations": [],
      "placeholder": "\"\"\"{\"assignment_group\": \"IT Security\"}\"\"\"",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_optional_fields",
      "tooltip": "JSON string containing the api_name and value of the fields you want to set within ServiceNow after creating the record",
      "type_id": 11,
      "uuid": "0b739213-0896-4ee8-bd5a-fd26286185ba",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_table_name",
      "hide_notification": false,
      "id": 4542,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_table_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "incident",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_table_name",
      "tooltip": "Name of the table in ServiceNow",
      "type_id": 11,
      "uuid": "107edc5d-e444-4398-a596-00d61db4c3fd",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/attachment_id",
      "hide_notification": false,
      "id": 4543,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "attachment_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "attachment_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "1677716a-a95e-4f55-8e3e-5399e6d3bd96",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_note_type",
      "hide_notification": false,
      "id": 4544,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "sn_note_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_note_type",
      "tooltip": "When sending a Note, should it be added as a \"work_note\" or \"additional_comment\" in ServiceNow. Default: \"work_note\"",
      "type_id": 11,
      "uuid": "19d5e854-dc64-43d4-9a39-7be914920ad6",
      "values": [
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "work_note",
          "properties": null,
          "uuid": "c65de77d-f6b2-4c19-94eb-cdfa5cf5037f",
          "value": 974
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "additional_comment",
          "properties": null,
          "uuid": "3cb448e0-48d2-4afb-b509-59e9dc19168e",
          "value": 975
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_res_id",
      "hide_notification": false,
      "id": 4545,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_res_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_res_id",
      "tooltip": "The res_id of a SNOW record in sn_records_dt Data Table",
      "type_id": 11,
      "uuid": "33155d23-83f5-4a2b-b013-0baa7866c62d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_update_fields",
      "hide_notification": false,
      "id": 4546,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_update_fields",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_update_fields",
      "tooltip": "A JSON String of SNOW field names and values to update",
      "type_id": 11,
      "uuid": "4bf00b16-c289-4a96-9066-7422fc18b78a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/sn_resilient_status",
      "hide_notification": false,
      "id": 4547,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_resilient_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "sn_resilient_status",
      "tooltip": "",
      "type_id": 11,
      "uuid": "72a4e5ad-6df7-4839-a114-f081d4c00973",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sn_snow_record_id",
      "hide_notification": false,
      "id": 4515,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "sn_snow_record_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "SNOW Record ID",
      "tooltip": "ID of ServiceNow Record",
      "type_id": 0,
      "uuid": "ec65fd4d-b4c5-4632-a504-d390f45be715",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/sn_snow_record_link",
      "hide_notification": false,
      "id": 4516,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "sn_snow_record_link",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": true,
      "tags": [],
      "templates": [],
      "text": "SNOW Record",
      "tooltip": "Link to ServiceNow Record",
      "type_id": 0,
      "uuid": "6e69a025-6597-4994-9b1b-557ef736d45e",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1684259051079,
      "description": {
        "content": "Function that adds a SOAR Attachment to a ServiceNow Record.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW: Add Attachment to Record",
      "export_key": "fn_snow_add_attachment_to_record",
      "id": 49,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051127,
      "name": "fn_snow_add_attachment_to_record",
      "tags": [],
      "uuid": "975b1809-2110-4208-8c37-4b8ba9ad331a",
      "version": 1,
      "view_items": [
        {
          "content": "1677716a-a95e-4f55-8e3e-5399e6d3bd96",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Add Attachment to Record",
          "object_type": "attachment",
          "programmatic_name": "example_snow_add_attachment_to_record",
          "tags": [],
          "uuid": null,
          "workflow_id": 122
        }
      ]
    },
    {
      "created_date": 1684259051156,
      "description": {
        "content": "Function that adds a Note to a ServiceNow Record. Option to add the note as a \u0027Work Note\u0027 or \u0027Additional Comment\u0027.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW: Add Note to Record",
      "export_key": "fn_snow_add_note_to_record",
      "id": 50,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051206,
      "name": "fn_snow_add_note_to_record",
      "tags": [],
      "uuid": "c43f8cc1-5cdc-41a6-a6b0-fa59dd32df36",
      "version": 1,
      "view_items": [
        {
          "content": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "908e2bd1-d682-44e1-9240-efb5c2bf23a1",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "19d5e854-dc64-43d4-9a39-7be914920ad6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: [INC] SNOW Update Record on Severity Change",
          "object_type": "incident",
          "programmatic_name": "example_snow_update_record_on_severity_change",
          "tags": [],
          "uuid": null,
          "workflow_id": 128
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: [SIR] SNOW Update Record on Severity Change",
          "object_type": "incident",
          "programmatic_name": "example_sir_snow_update_record_on_severity_change",
          "tags": [],
          "uuid": null,
          "workflow_id": 133
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Add Comment to Record",
          "object_type": "note",
          "programmatic_name": "example_snow_add_comment_to_record",
          "tags": [],
          "uuid": null,
          "workflow_id": 123
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Add Work Note to Record",
          "object_type": "note",
          "programmatic_name": "example_snow_add_worknote_to_record",
          "tags": [],
          "uuid": null,
          "workflow_id": 130
        }
      ]
    },
    {
      "created_date": 1684259051237,
      "description": {
        "content": "Function that uses the \u0027/close_record\u0027 custom endpoint in ServiceNow to change the state of a ServiceNow Record and add Close Notes and a Close Code to the Record.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW: Close Record",
      "export_key": "fn_snow_close_record",
      "id": 51,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051282,
      "name": "fn_snow_close_record",
      "tags": [],
      "uuid": "edadf951-4652-48a9-8068-9b719bf4bfe4",
      "version": 1,
      "view_items": [
        {
          "content": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "33155d23-83f5-4a2b-b013-0baa7866c62d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f0eb15f5-fb36-4c6d-b489-352befbe3ea3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f234db2f-dfe8-401f-a3b9-f5f87921e21f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "bffdd765-d0c1-42bd-8b93-798436cfab93",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9939f061-85a2-42ac-875a-46168998f3b6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Close Record [Incident]",
          "object_type": "incident",
          "programmatic_name": "example_snow_close_record_incident",
          "tags": [],
          "uuid": null,
          "workflow_id": 124
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Close Record [Task]",
          "object_type": "task",
          "programmatic_name": "example_snow_close_record_task",
          "tags": [],
          "uuid": null,
          "workflow_id": 129
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Close Record from Data Table",
          "object_type": "sn_records_dt",
          "programmatic_name": "example_snow_close_record_from_data_table",
          "tags": [],
          "uuid": null,
          "workflow_id": 125
        }
      ]
    },
    {
      "created_date": 1684259051312,
      "description": {
        "content": "Function that uses the \u0027/create\u0027 custom endpoint in ServiceNow to create a ServiceNow Record from a SOAR Incident or Task.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW: Create Record",
      "export_key": "fn_snow_create_record",
      "id": 52,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051358,
      "name": "fn_snow_create_record",
      "tags": [],
      "uuid": "041fa8ca-70bb-44b1-996b-88f61a8a0671",
      "version": 1,
      "view_items": [
        {
          "content": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9fb070d7-fc5a-4ca1-8e2e-fc940e53c857",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0b739213-0896-4ee8-bd5a-fd26286185ba",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Create Record [Incident]",
          "object_type": "incident",
          "programmatic_name": "example_snow_create_record_incident",
          "tags": [],
          "uuid": null,
          "workflow_id": 126
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Create Record [Task]",
          "object_type": "task",
          "programmatic_name": "example_snow_create_record_task",
          "tags": [],
          "uuid": null,
          "workflow_id": 132
        }
      ]
    },
    {
      "created_date": 1684259051388,
      "description": {
        "content": "A helper function to add a Note to a Task from a Workflow with a different parent object type.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW Helper: Add Task Note",
      "export_key": "fn_snow_helper_add_task_note",
      "id": 53,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051438,
      "name": "fn_snow_helper_add_task_note",
      "tags": [],
      "uuid": "f02d65f0-f19a-414a-828d-5c35de5270b1",
      "version": 1,
      "view_items": [
        {
          "content": "33155d23-83f5-4a2b-b013-0baa7866c62d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "908e2bd1-d682-44e1-9240-efb5c2bf23a1",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Close Record from Data Table",
          "object_type": "sn_records_dt",
          "programmatic_name": "example_snow_close_record_from_data_table",
          "tags": [],
          "uuid": null,
          "workflow_id": 125
        }
      ]
    },
    {
      "created_date": 1684259051465,
      "description": {
        "content": "A helper function that updates the ServiceNow Records Data Table when the status of an Incident/Task is changed.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW Helper: Update Data Table",
      "export_key": "fn_snow_helper_update_datatable",
      "id": 54,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051508,
      "name": "fn_snow_helper_update_datatable",
      "tags": [],
      "uuid": "6130c083-17ea-4262-986b-8d073d3f7328",
      "version": 1,
      "view_items": [
        {
          "content": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "72a4e5ad-6df7-4839-a114-f081d4c00973",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Update Data Table on Status Change [Incident]",
          "object_type": "incident",
          "programmatic_name": "example_snow_update_datatable_on_status_change_incident",
          "tags": [],
          "uuid": null,
          "workflow_id": 127
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Update Data Table on Status Change [Task]",
          "object_type": "task",
          "programmatic_name": "example_snow_update_datatable_on_status_change_task",
          "tags": [],
          "uuid": null,
          "workflow_id": 131
        }
      ]
    },
    {
      "created_date": 1684259051534,
      "description": {
        "content": "Function that gets the \u0027sys_id\u0027 of a ServiceNow Record.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW: Lookup sys_id",
      "export_key": "fn_snow_lookup_sysid",
      "id": 55,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051580,
      "name": "fn_snow_lookup_sysid",
      "tags": [],
      "uuid": "e5abf91c-57f6-4d01-bd5a-50bfe261cb01",
      "version": 1,
      "view_items": [
        {
          "content": "107edc5d-e444-4398-a596-00d61db4c3fd",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a483a5fb-0064-4760-9fe8-7d8312ed1dd2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ad37c004-da73-4b49-9575-a33093897343",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Create Record [Incident]",
          "object_type": "incident",
          "programmatic_name": "example_snow_create_record_incident",
          "tags": [],
          "uuid": null,
          "workflow_id": 126
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: SNOW: Create Record [Task]",
          "object_type": "task",
          "programmatic_name": "example_snow_create_record_task",
          "tags": [],
          "uuid": null,
          "workflow_id": 132
        }
      ]
    },
    {
      "created_date": 1684259051607,
      "description": {
        "content": "Function that uses the \u0027/update\u0027 custom endpoint in ServiceNow to update a ServiceNow Record with a given dictionary of field name/value pairs.",
        "format": "text"
      },
      "destination_handle": "fn_service_now",
      "display_name": "SNOW: Update Record",
      "export_key": "fn_snow_update_record",
      "id": 56,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259051652,
      "name": "fn_snow_update_record",
      "tags": [],
      "uuid": "95d7d4df-0ec8-4dbd-bbcf-9759b23930eb",
      "version": 1,
      "view_items": [
        {
          "content": "811e99d7-d194-4ce8-86cc-aff5e01ab85c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ba318261-ed6a-4a38-a187-9e0b68d1604f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "33155d23-83f5-4a2b-b013-0baa7866c62d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4bf00b16-c289-4a96-9066-7422fc18b78a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: [INC] SNOW Update Record on Severity Change",
          "object_type": "incident",
          "programmatic_name": "example_snow_update_record_on_severity_change",
          "tags": [],
          "uuid": null,
          "workflow_id": 128
        },
        {
          "actions": [],
          "description": null,
          "name": "Example: [SIR] SNOW Update Record on Severity Change",
          "object_type": "incident",
          "programmatic_name": "example_sir_snow_update_record_on_severity_change",
          "tags": [],
          "uuid": null,
          "workflow_id": 133
        }
      ]
    }
  ],
  "geos": null,
  "groups": null,
  "id": 25,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1684264731735,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1684264731735,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "industries": null,
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_service_now",
      "name": "fn_service_now",
      "programmatic_name": "fn_service_now",
      "tags": [],
      "users": [
        "j@example.com"
      ],
      "uuid": "59c41f3d-8a93-4205-a23d-1706c1e48f61"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sn_snow_record_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sn_snow_record_id",
              "method": "not_contains",
              "type": null,
              "value": "SIR"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.severity_code",
              "method": "changed",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_26e860aa_1826_44cd_8108_3d468e98cd87\" isExecutable=\"true\" name=\"playbook_26e860aa_1826_44cd_8108_3d468e98cd87\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0wwhag2\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Update Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"95d7d4df-0ec8-4dbd-bbcf-9759b23930eb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n# Map IBM SOAR severity values to ServiceNow severity values\\nsn_severity_map = {\\n  \\\"High\\\": 1,\\n  \\\"Medium\\\": 2,\\n  \\\"Low\\\": 3\\n}\\n\\n# Get the id of this incident\\ninputs.incident_id = incident.id\\n\\n# List all the fields you want to update in the ServiceNow Record here with the ServiceNow field_name being the key\\ninputs.sn_update_fields = dumps({\\n  \\\"severity\\\": sn_severity_map[incident.severity_code],\\n})\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_record\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0wwhag2\u003c/incoming\u003e\u003coutgoing\u003eFlow_0g99ya7\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0wwhag2\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process update\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"a7f6904f-29d0-4fa0-a338-0ca4fe49e393\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0g99ya7\u003c/incoming\u003e\u003coutgoing\u003eFlow_05exjux\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0g99ya7\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"SNOW: Add Note to Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c43f8cc1-5cdc-41a6-a6b0-fa59dd32df36\"\u003e{\"inputs\":{\"811e99d7-d194-4ce8-86cc-aff5e01ab85c\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"908e2bd1-d682-44e1-9240-efb5c2bf23a1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"19d5e854-dc64-43d4-9a39-7be914920ad6\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"c65de77d-f6b2-4c19-94eb-cdfa5cf5037f\"}},\"ba318261-ed6a-4a38-a187-9e0b68d1604f\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"inputs.incident_id = incident.id\\ninputs.sn_note_text = f\\\"The Severity of this Incident was updated to {incident.severity_code} in IBM SOAR\\\"\\ninputs.sn_note_type = \\\"work_note\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_note\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_05exjux\u003c/incoming\u003e\u003coutgoing\u003eFlow_0psgqgq\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_05exjux\" sourceRef=\"ScriptTask_2\" targetRef=\"ServiceTask_3\"/\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0psgqgq\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0psgqgq\" sourceRef=\"ServiceTask_3\" targetRef=\"EndPoint_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_26e860aa_1826_44cd_8108_3d468e98cd87\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wwhag2\" id=\"Flow_0wwhag2_di\"\u003e\u003comgdi:waypoint x=\"1420\" y=\"186\"/\u003e\u003comgdi:waypoint x=\"1420\" y=\"248\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0g99ya7\" id=\"Flow_0g99ya7_di\"\u003e\u003comgdi:waypoint x=\"1420\" y=\"332\"/\u003e\u003comgdi:waypoint x=\"1420\" y=\"378\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_05exjux\" id=\"Flow_05exjux_di\"\u003e\u003comgdi:waypoint x=\"1420\" y=\"462\"/\u003e\u003comgdi:waypoint x=\"1420\" y=\"538\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0psgqgq\" id=\"Flow_0psgqgq_di\"\u003e\u003comgdi:waypoint x=\"1420\" y=\"622\"/\u003e\u003comgdi:waypoint x=\"1420\" y=\"684\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"1326\" y=\"134\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1322\" y=\"248\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1322\" y=\"378\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"1322\" y=\"538\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"1354\" y=\"684\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684259120305,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_26e860aa_1826_44cd_8108_3d468e98cd87",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: [INC] Update Record on Severity Change (PB)",
      "export_key": "snow_inc_update_record_on_severity_change_pb",
      "field_type_handle": "playbook_26e860aa_1826_44cd_8108_3d468e98cd87",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: [INC] Update Record on Severity Change (PB)",
        "export_key": "playbook_26e860aa_1826_44cd_8108_3d468e98cd87",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_26e860aa_1826_44cd_8108_3d468e98cd87",
        "uuid": "565a8c94-4123-4e22-86e7-8a36f2cf4364"
      },
      "has_logical_errors": false,
      "id": 45,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259503019,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684259296831,
          "description": "",
          "enabled": false,
          "export_key": "post process update",
          "id": 71,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684259296841,
          "name": "post process update",
          "object_type": "incident",
          "playbook_handle": "snow_inc_update_record_on_severity_change_pb",
          "programmatic_name": "snow_inc_update_record_on_severity_change_pb_post_process_update",
          "script_text": "# Add a Note to the Incident\nincident.addNote(f\"The Severity of this Incident was updated to {incident.severity_code} in IBM SOAR\")",
          "tags": [],
          "uuid": "a7f6904f-29d0-4fa0-a338-0ca4fe49e393"
        }
      ],
      "name": "snow_inc_update_record_on_severity_change_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_26e860aa-1826-44cd-8108-3d468e98cd87",
        "id": 45,
        "name": "playbook_26e860aa_1826_44cd_8108_3d468e98cd87",
        "type": "playbook",
        "uuid": "1a30ce9c-d9a2-4a91-8161-dc8650ed4677"
      },
      "tags": [],
      "type": "default",
      "uuid": "26e860aa-1826-44cd-8108-3d468e98cd87",
      "version": 5
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sn_snow_record_id",
              "method": "contains",
              "type": null,
              "value": "SIR"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sn_snow_record_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.severity_code",
              "method": "changed",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_72566091_6309_487b_83c1_805840a5a37c\" isExecutable=\"true\" name=\"playbook_72566091_6309_487b_83c1_805840a5a37c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_02k951d\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Update Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"95d7d4df-0ec8-4dbd-bbcf-9759b23930eb\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n# Map IBM SOAR severity values to ServiceNow severity values\\nsn_severity_map = {\\n  \\\"High\\\": 1,\\n  \\\"Medium\\\": 2,\\n  \\\"Low\\\": 3\\n}\\n\\n# Get the id of this incident\\ninputs.incident_id = incident.id\\n\\n# List all the fields you want to update in the ServiceNow Record here with the ServiceNow field_name being the key\\n# The default here is \\\"severity\\\", however if using the SIR Table we recommend switching to the business_criticality field\\ninputs.sn_update_fields = dumps({\\\"severity\\\": sn_severity_map[incident.severity_code]})\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_record\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02k951d\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ll3imt\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_02k951d\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"b7528578-0310-48bf-b896-84e7174ea635\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ll3imt\u003c/incoming\u003e\u003coutgoing\u003eFlow_0wklw0r\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1ll3imt\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"SNOW: Add Note to Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c43f8cc1-5cdc-41a6-a6b0-fa59dd32df36\"\u003e{\"inputs\":{\"811e99d7-d194-4ce8-86cc-aff5e01ab85c\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"908e2bd1-d682-44e1-9240-efb5c2bf23a1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"19d5e854-dc64-43d4-9a39-7be914920ad6\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"c65de77d-f6b2-4c19-94eb-cdfa5cf5037f\"}},\"ba318261-ed6a-4a38-a187-9e0b68d1604f\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"inputs.incident_id = incident.id\\n\\ninputs.sn_note_text = f\\\"The Business Impact of this Incident was updated to {incident.severity_code} in IBM SOAR\\\"\\ninputs.sn_note_type = \\\"work_note\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_note\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0wklw0r\u003c/incoming\u003e\u003coutgoing\u003eFlow_0e7ehs2\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0wklw0r\" sourceRef=\"ScriptTask_2\" targetRef=\"ServiceTask_3\"/\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0e7ehs2\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0e7ehs2\" sourceRef=\"ServiceTask_3\" targetRef=\"EndPoint_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_72566091_6309_487b_83c1_805840a5a37c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02k951d\" id=\"Flow_02k951d_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ll3imt\" id=\"Flow_1ll3imt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"268\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wklw0r\" id=\"Flow_0wklw0r_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"352\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"388\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0e7ehs2\" id=\"Flow_0e7ehs2_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"472\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"504\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"268\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"388\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"504\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684259573851,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_72566091_6309_487b_83c1_805840a5a37c",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: [SIR] Update Record on Severity Change (PB)",
      "export_key": "snow_sir_update_record_on_severity_change_pb",
      "field_type_handle": "playbook_72566091_6309_487b_83c1_805840a5a37c",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: [SIR] Update Record on Severity Change (PB)",
        "export_key": "playbook_72566091_6309_487b_83c1_805840a5a37c",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_72566091_6309_487b_83c1_805840a5a37c",
        "uuid": "4c87357b-be9d-4e77-b3f0-2dc5419cb7ec"
      },
      "has_logical_errors": false,
      "id": 46,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259832100,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684259676648,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 72,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684259676659,
          "name": "post process",
          "object_type": "incident",
          "playbook_handle": "snow_sir_update_record_on_severity_change_pb",
          "programmatic_name": "snow_sir_update_record_on_severity_change_pb_post_process",
          "script_text": "incident.addNote(f\"The Business Impact of this Incident was updated to {incident.severity_code} in IBM SOAR\")",
          "tags": [],
          "uuid": "b7528578-0310-48bf-b896-84e7174ea635"
        }
      ],
      "name": "snow_sir_update_record_on_severity_change_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_72566091-6309-487b-83c1-805840a5a37c",
        "id": 46,
        "name": "playbook_72566091_6309_487b_83c1_805840a5a37c",
        "type": "playbook",
        "uuid": "3ebc8147-c2d3-49cd-8546-f0fe0fdb5590"
      },
      "tags": [],
      "type": "default",
      "uuid": "72566091-6309-487b-83c1-805840a5a37c",
      "version": 7
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_098e7385_a5bf_4c11_91f1_d04490e3b791\" isExecutable=\"true\" name=\"playbook_098e7385_a5bf_4c11_91f1_d04490e3b791\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1qqywrr\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Add Attachment to Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"975b1809-2110-4208-8c37-4b8ba9ad331a\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# The id of this attachment\\ninputs.attachment_id = attachment.id\\n\\n# The id of this incident\\ninputs.incident_id = incident.id\\n\\n# If this is a task attachment, get the taskId\\nif attachment.type == \u0027task\u0027:\\n  inputs.task_id = task.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_attachment\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1qqywrr\u003c/incoming\u003e\u003coutgoing\u003eFlow_1aka46t\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1qqywrr\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"db033a24-6341-4183-82b6-6002efb796c3\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1aka46t\u003c/incoming\u003e\u003coutgoing\u003eFlow_1quzyar\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1aka46t\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1quzyar\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1quzyar\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_098e7385_a5bf_4c11_91f1_d04490e3b791\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1quzyar\" id=\"Flow_1quzyar_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"412\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"464\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1aka46t\" id=\"Flow_1aka46t_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"328\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1qqywrr\" id=\"Flow_1qqywrr_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"209.017\" x=\"616\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"328\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"464\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684260097977,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_098e7385_a5bf_4c11_91f1_d04490e3b791",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Add Attachment to Record (PB)",
      "export_key": "snow_add_attachment_to_record",
      "field_type_handle": "playbook_098e7385_a5bf_4c11_91f1_d04490e3b791",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Add Attachment to Record",
        "export_key": "playbook_098e7385_a5bf_4c11_91f1_d04490e3b791",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_098e7385_a5bf_4c11_91f1_d04490e3b791",
        "uuid": "c802bdd7-2413-486a-baac-12e6271c1256"
      },
      "has_logical_errors": false,
      "id": 49,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684264591561,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684260150561,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 73,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684260262707,
          "name": "post process",
          "object_type": "attachment",
          "playbook_handle": "snow_add_attachment_to_record",
          "programmatic_name": "snow_add_attachment_to_record_post_process",
          "script_text": "results = playbook.functions.results.add_attachment\nif results.get(\"success\"):\n\n  noteText = f\"\"\"\u003cbr\u003e{principal.display_name} has added an attachment to \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eAttachment Name:\u003c/b\u003e  {results.attachment_name}\n              \u003cbr\u003e\u003cb\u003eServiceNow ID:\u003c/b\u003e  {results.get(\u0027sn_ref_id\u0027)}\"\"\"\n\n  # If this is a task attachment, add a note to the Task\n  if task:\n    task.addNote(helper.createRichText(noteText))\n  # Else add the note to the Incident\n  else:\n    incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "db033a24-6341-4183-82b6-6002efb796c3"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "snow_add_attachment_to_record",
      "object_type": "attachment",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_098e7385-a5bf-4c11-91f1-d04490e3b791",
        "id": 49,
        "name": "playbook_098e7385_a5bf_4c11_91f1_d04490e3b791",
        "type": "playbook",
        "uuid": "9373fa16-0859-4d02-a4e4-119bef653c43"
      },
      "tags": [],
      "type": "default",
      "uuid": "098e7385-a5bf-4c11-91f1-d04490e3b791",
      "version": 7
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 3,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_57237674_6459_4940_a146_9daf73c2f87a\" isExecutable=\"true\" name=\"playbook_57237674_6459_4940_a146_9daf73c2f87a\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1pwcmsj\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Lookup sys_id\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"e5abf91c-57f6-4d01-bd5a-50bfe261cb01\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# The table in ServiceNow to query\\ninputs.sn_table_name = \\\"sys_user_group\\\"\\n\\n# The name of the field/table column to query\\ninputs.sn_query_field = \\\"name\\\"\\n\\n# The value to equate the cell to\\n# Get the group name from the Rule Activity Field with:\\ninputs.sn_query_value = playbook.inputs.sn_assignment_group\\n\\n## OR Set group name statically with:\\n## inputs.sn_query_value = \\\"IT Securities\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"assignment_group\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1pwcmsj\u003c/incoming\u003e\u003coutgoing\u003eFlow_09gn2pv\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1pwcmsj\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"SNOW: Lookup sys_id\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"e5abf91c-57f6-4d01-bd5a-50bfe261cb01\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# The table in ServiceNow to query\\ninputs.sn_table_name = \\\"sys_user\\\"\\n\\n# The name of the field/table column to query\\ninputs.sn_query_field = \\\"user_name\\\"\\n\\n# The value to equate the cell to\\ninputs.sn_query_value = \\\"ibmresilient\\\" #our integrations user in ServiceNow\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"caller_id\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_09gn2pv\u003c/incoming\u003e\u003coutgoing\u003eFlow_160bxct\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_09gn2pv\" sourceRef=\"ServiceTask_1\" targetRef=\"ServiceTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"SNOW: Create Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"041fa8ca-70bb-44b1-996b-88f61a8a0671\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n# Map IBM SOAR severity values to ServiceNow severity values\\nsn_severity_map = {\\n  \\\"High\\\": 1,\\n  \\\"Medium\\\": 2,\\n  \\\"Low\\\": 3\\n}\\n\\n# Default text of the initial note added to the ServiceNow Record\\ninit_snow_note_text = f\\\"\\\"\\\"Record created from a IBM SOAR Incident ID: {incident.id}.\\n                          Severity: {incident.severity_code}\\n                          Incident Type(s): {\u0027, \u0027.join(incident.incident_type_ids)}\\\"\\\"\\\"\\n\\n# If the user adds a comment when they invoke the rule, that comment gets concatenated here\\nif playbook.inputs.sn_initial_note.content\\n  init_snow_note_text = \\\"{init_snow_note_text}\\\\n\\\\n{playbook.inputs.sn_initial_note.content}\\\")\\n\\n# ID of this incident\\ninputs.incident_id = incident.id\\n\\n# Initial work note to attach to created ServiceNow Record\\ninputs.sn_init_work_note = init_snow_note_text\\n\\n# Any further information you want to send to ServiceNow. Each Key/Value pair is attached to the Request object and accessible in ServiceNow.\\n# ServiceNow Example:: setValue(\u0027assignment_group\u0027, request.body.data.sn_optional_fields.assignment_group)\\n# For SIR tables it is recommended to map \\\"business_criticality\\\" to sn_severity_map as that is visible in the SNOW query_builder\\n# (see the example commented out below)\\ninputs.sn_optional_fields = dumps({\\n  \\\"short_description\\\": f\\\"RES-{incident.id,}: {incident.name}\\\"),\\n  \\\"severity\\\": sn_severity_map[incident.severity_code],\\n  #\\\"business_criticality\\\": sn_severity_map[incident.severity_code],\\n  \\\"assignment_group\\\": playbook.functions.results.assignment_group.get(\\\"sys_id\\\"),\\n  \\\"caller_id\\\": playbook.functions.results.caller_id.get(\\\"sys_id\\\")\\n})\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"create_record\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_160bxct\u003c/incoming\u003e\u003coutgoing\u003eFlow_1vytx9i\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_160bxct\" sourceRef=\"ServiceTask_2\" targetRef=\"ServiceTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"73be698f-53dc-4937-a232-852291f15bd5\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1vytx9i\u003c/incoming\u003e\u003coutgoing\u003eFlow_0owltkx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1vytx9i\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_5\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0owltkx\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0owltkx\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_5\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_57237674_6459_4940_a146_9daf73c2f87a\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1pwcmsj\" id=\"Flow_1pwcmsj_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_09gn2pv\" id=\"Flow_09gn2pv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"338\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_160bxct\" id=\"Flow_160bxct_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"422\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"508\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vytx9i\" id=\"Flow_1vytx9i_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"592\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"638\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0owltkx\" id=\"Flow_0owltkx_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"722\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"784\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"338\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"508\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"638\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_5\" id=\"EndPoint_5_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"784\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684260313742,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Create Record [Incident] (PB)",
      "export_key": "snow_create_record_incident_pb",
      "field_type_handle": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Create Record [Incident] (PB)",
        "export_key": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
        "fields": {
          "sn_assignment_group": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_57237674_6459_4940_a146_9daf73c2f87a/sn_assignment_group",
            "hide_notification": false,
            "id": 4548,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_assignment_group",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Assignment Group",
            "tooltip": "The group this record will be assigned to in ServiceNow",
            "type_id": 1063,
            "uuid": "e66e5ba7-8e3d-4633-b143-a477337c2145",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "IT Securities",
                "properties": null,
                "uuid": "7aa0c8aa-ab53-4a18-aa64-4fb29a97abe8",
                "value": 976
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Network",
                "properties": null,
                "uuid": "94926972-d9c2-4852-8bc6-0625b32b947e",
                "value": 977
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Hardware",
                "properties": null,
                "uuid": "09fa796f-5657-4ba4-b41b-99fdcaeb8e6a",
                "value": 978
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Software",
                "properties": null,
                "uuid": "8d2434e7-1961-417d-a272-d31b6ac52c54",
                "value": 979
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Database",
                "properties": null,
                "uuid": "9bec94cd-ac5a-4a9e-a9b1-f27f0e619080",
                "value": 980
              },
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "Incident Management",
                "properties": null,
                "uuid": "2dee7af0-b270-4c66-b8a0-535a3bcf158f",
                "value": 981
              }
            ]
          },
          "sn_initial_note": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_57237674_6459_4940_a146_9daf73c2f87a/sn_initial_note",
            "hide_notification": false,
            "id": 4549,
            "input_type": "textarea",
            "internal": false,
            "is_tracked": false,
            "name": "sn_initial_note",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Initial Note",
            "tooltip": "",
            "type_id": 1063,
            "uuid": "83475f17-1707-4aac-9f92-f6400cdc1076",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
        "uuid": "30af54bc-38fd-4648-9a46-e7fadeed1cc8"
      },
      "has_logical_errors": false,
      "id": 50,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684261867472,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684260615907,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 74,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684260615918,
          "name": "post process",
          "object_type": "incident",
          "playbook_handle": "snow_create_record_incident_pb",
          "programmatic_name": "snow_create_record_incident_pb_post_process",
          "script_text": "results = playbook.functions.results.create_record\nif results.get(\"success\"):\n  # Set incident fields sn_snow_record_id and sn_snow_record_link\n  incident.sn_snow_record_id = results.get(\"sn_ref_id\")\n  incident.sn_snow_record_link = f\"\"\"\u003ca href=\u0027{results.get(\u0027sn_record_link\u0027)}\u0027\u003eLink\u003c/a\u003e\"\"\"\n  \n  noteText = f\"\"\"\u003cbr\u003eThis Incident has been created in \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eServiceNow ID:\u003c/b\u003e  {results.get(\u0027sn_ref_id\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Link:\u003c/b\u003e \u003ca href=\u0027{results.get(\u0027sn_record_link\u0027)}\u0027\u003e{results.get(\u0027sn_record_link\u0027)}\u003c/a\u003e\"\"\"\n\n  incident.addNote(helper.createRichText(noteText))",
          "tags": [],
          "uuid": "73be698f-53dc-4937-a232-852291f15bd5"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sn_snow_record_id",
              "method": "not_has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "e66e5ba7-8e3d-4633-b143-a477337c2145",
            "element": "field_uuid",
            "field_type": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "83475f17-1707-4aac-9f92-f6400cdc1076",
            "element": "field_uuid",
            "field_type": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "snow_create_record_incident_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_57237674-6459-4940-a146-9daf73c2f87a",
        "id": 50,
        "name": "playbook_57237674_6459_4940_a146_9daf73c2f87a",
        "type": "playbook",
        "uuid": "8f073d8b-43a0-4ae4-8f20-52c29ecfc417"
      },
      "tags": [],
      "type": "default",
      "uuid": "57237674-6459-4940-a146-9daf73c2f87a",
      "version": 6
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea\" isExecutable=\"true\" name=\"playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1uwk90m\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Lookup sys_id\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"e5abf91c-57f6-4d01-bd5a-50bfe261cb01\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# The table in ServiceNow to query\\ninputs.sn_table_name = \\\"sys_user_group\\\"\\n\\n# The name of the field/table column to query\\ninputs.sn_query_field = \\\"name\\\"\\n\\n# The value to equate the cell to\\n# Get the group name from the Rule Activity Field with:\\ninputs.sn_query_value = playbook.inputs.sn_assignment_group\\n\\n## OR Set group name statically with:\\n## inputs.sn_query_value = \\\"IT Securities\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"assignment_group\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1uwk90m\u003c/incoming\u003e\u003coutgoing\u003eFlow_04wlg33\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1uwk90m\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"SNOW: Lookup sys_id\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"e5abf91c-57f6-4d01-bd5a-50bfe261cb01\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# The table in ServiceNow to query\\ninputs.sn_table_name = \\\"sys_user\\\"\\n\\n# The name of the field/table column to query\\ninputs.sn_query_field = \\\"email\\\"\\n\\n# The value to equate the cell to\\ninputs.sn_query_value = \\\"ibmresilient\\\" #our integrations user in ServiceNow\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"caller_id\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_04wlg33\u003c/incoming\u003e\u003coutgoing\u003eFlow_0chwcrv\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_04wlg33\" sourceRef=\"ServiceTask_1\" targetRef=\"ServiceTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_3\" name=\"SNOW: Create Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"041fa8ca-70bb-44b1-996b-88f61a8a0671\"\u003e{\"inputs\":{},\"pre_processing_script\":\"from json import dumps\\n# Default text of the initial note added to the ServiceNow Record\\ninit_snow_note_text = f\\\"\\\"\\\"Record created from IBM SOAR Task ID: {task.id}. Associated IBM SOAR Incident ID: {incident.id}.\\\"\\\"\\\"\\n\\n# If the user adds a comment when they invoke the playbook, that comment gets concatenated here\\nif playbook.inputs.sn_initial_note.content:\\n  init_snow_note_text = f\\\"{init_snow_note_text}\\\\n\\\\n{playbook.inputs.sn_initial_note.content}\\\")\\n\\n# ID of this incident\\ninputs.incident_id = incident.id\\n\\n# ID of this task\\ninputs.task_id = task.id\\n\\n# Initial work note to attach to created ServiceNow record\\ninputs.sn_init_work_note = init_snow_note_text\\n\\n# Any further information you want to send to ServiceNow. Each Key/Value pair is attached to the Request object and accessible in ServiceNow.\\n# ServiceNow Example:: setValue(\u0027assignment_group\u0027, request.body.data.sn_optional_fields.assignment_group)\\ninputs.sn_optional_fields = dumps({\\n  \\\"short_description\\\": f\\\"RES-{incident.id}-{task.id}: {task.name}\\\",\\n  \\\"assignment_group\\\": playbook..functions.results.assignment_group.get(\\\"sys_id\\\"),\\n  \\\"caller_id\\\": playbook.functions.results.caller_id.get(\\\"sys_id\\\")\\n})\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"create_record\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0chwcrv\u003c/incoming\u003e\u003coutgoing\u003eFlow_1vyyekt\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0chwcrv\" sourceRef=\"ServiceTask_2\" targetRef=\"ServiceTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_4\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"604b080a-1625-45dc-bca3-52f9a4abe8fe\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1vyyekt\u003c/incoming\u003e\u003coutgoing\u003eFlow_1oz0idp\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1vyyekt\" sourceRef=\"ServiceTask_3\" targetRef=\"ScriptTask_4\"/\u003e\u003cendEvent id=\"EndPoint_5\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1oz0idp\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1oz0idp\" sourceRef=\"ScriptTask_4\" targetRef=\"EndPoint_5\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1uwk90m\" id=\"Flow_1uwk90m_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_04wlg33\" id=\"Flow_04wlg33_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0chwcrv\" id=\"Flow_0chwcrv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"498\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vyyekt\" id=\"Flow_1vyyekt_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"582\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"658\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1oz0idp\" id=\"Flow_1oz0idp_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"742\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"824\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"161.48329999999999\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"358\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_3\" id=\"ServiceTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"498\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_4\" id=\"ScriptTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"658\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_5\" id=\"EndPoint_5_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"824\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684261890647,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Create Record [Task] (PB)",
      "export_key": "snow_create_record_task_pb",
      "field_type_handle": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Create Record [Task] (PB)",
        "export_key": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
        "fields": {
          "sn_assignment_group": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea/sn_assignment_group",
            "hide_notification": false,
            "id": 4550,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_assignment_group",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Assignment Group",
            "tooltip": "The group this record will be assigned to in ServiceNow",
            "type_id": 1064,
            "uuid": "251d072f-2087-474c-bc74-d079f6d6142d",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "IT Securities",
                "properties": null,
                "uuid": "12ca895f-15ea-4440-85d1-811e198cc62a",
                "value": 982
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Network",
                "properties": null,
                "uuid": "8b78cbd9-5455-4d89-8d29-2001add11745",
                "value": 983
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Hardware",
                "properties": null,
                "uuid": "61e6145e-4d88-454b-8cc1-e15262762879",
                "value": 984
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Software",
                "properties": null,
                "uuid": "3272dcaf-3ab5-4700-96f0-9734aed68b9f",
                "value": 985
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Database",
                "properties": null,
                "uuid": "21a7dc88-2074-4e15-b7a6-ea90471a5183",
                "value": 986
              },
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "Incident Management",
                "properties": null,
                "uuid": "9f7957e2-92f7-4090-98df-b9021c655e3c",
                "value": 987
              }
            ]
          },
          "sn_initial_note": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea/sn_initial_note",
            "hide_notification": false,
            "id": 4551,
            "input_type": "textarea",
            "internal": false,
            "is_tracked": false,
            "name": "sn_initial_note",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Initial Note",
            "tooltip": "",
            "type_id": 1064,
            "uuid": "8a89384f-5cfd-4a95-ad9b-cd865d367c1e",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
        "uuid": "1cb65283-9449-4b59-9c3a-338081a5c14f"
      },
      "has_logical_errors": false,
      "id": 51,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684262415337,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684262397867,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 75,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684262397877,
          "name": "post process",
          "object_type": "task",
          "playbook_handle": "snow_create_record_task_pb",
          "programmatic_name": "snow_create_record_task_pb_post_process",
          "script_text": "results = playbook.functions.results.create_record\nif results.get(\"success\"):\n\n  note_text = f\"\"\"\u003cbr\u003eThis Task has been created in \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eServiceNow ID:\u003c/b\u003e  {results.get(\u0027sn_ref_id\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Link:\u003c/b\u003e \u003ca href=\u0027{results.get(\u0027sn_record_link\u0027)}\u0027\u003e{results.get(\u0027sn_record_link\u0027)}\u003c/a\u003e\"\"\"\n\n  task.addNote(helper.createRichText(note_text))\n\nelif results.get(\"reason\"):\n  task.addNote(results.get(\"reason\"))",
          "tags": [],
          "uuid": "604b080a-1625-45dc-bca3-52f9a4abe8fe"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "251d072f-2087-474c-bc74-d079f6d6142d",
            "element": "field_uuid",
            "field_type": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "8a89384f-5cfd-4a95-ad9b-cd865d367c1e",
            "element": "field_uuid",
            "field_type": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "snow_create_record_task_pb",
      "object_type": "task",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_c1e69c29-d812-47e5-acc1-0c6879a9cfea",
        "id": 51,
        "name": "playbook_c1e69c29_d812_47e5_acc1_0c6879a9cfea",
        "type": "playbook",
        "uuid": "ad23d53f-3ada-4725-886f-cd8cfc23ec81"
      },
      "tags": [],
      "type": "default",
      "uuid": "c1e69c29-d812-47e5-acc1-0c6879a9cfea",
      "version": 5
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c\" isExecutable=\"true\" name=\"playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1k8fj92\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Add Note to Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c43f8cc1-5cdc-41a6-a6b0-fa59dd32df36\"\u003e{\"inputs\":{\"811e99d7-d194-4ce8-86cc-aff5e01ab85c\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"908e2bd1-d682-44e1-9240-efb5c2bf23a1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"19d5e854-dc64-43d4-9a39-7be914920ad6\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"c65de77d-f6b2-4c19-94eb-cdfa5cf5037f\"}},\"ba318261-ed6a-4a38-a187-9e0b68d1604f\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"inputs.sn_note_type = \\\"additional_comment\\\"\\n# The id of this incident\\ninputs.incident_id = incident.id\\n\\n# If this is a task note, get the taskId\\nif note.type == \u0027task\u0027:\\n  # Set the task_id\\n  inputs.task_id = task.id\\n\\n# Get the text of the note\\ninputs.sn_note_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_note\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1k8fj92\u003c/incoming\u003e\u003coutgoing\u003eFlow_1dk6y8d\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1k8fj92\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"60fecb55-7cbb-4ade-803f-d75bf5fa98b5\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1dk6y8d\u003c/incoming\u003e\u003coutgoing\u003eFlow_1urnpky\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1dk6y8d\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1urnpky\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1urnpky\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1k8fj92\" id=\"Flow_1k8fj92_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1dk6y8d\" id=\"Flow_1dk6y8d_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1urnpky\" id=\"Flow_1urnpky_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"444\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"444\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684262441378,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Send as Additional Comment (PB)",
      "export_key": "snow_send_as_additional_comment_pb",
      "field_type_handle": "playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Send as Additional Comment (PB)",
        "export_key": "playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c",
        "uuid": "52d68bef-f011-49f0-a16f-3e9f64d7dc27"
      },
      "has_logical_errors": false,
      "id": 52,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684262636807,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684262616418,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 76,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684262616431,
          "name": "post process",
          "object_type": "note",
          "playbook_handle": "snow_send_as_additional_comment_pb",
          "programmatic_name": "snow_send_as_additional_comment_pb_post_process",
          "script_text": "from datetime import datetime\nnote.text = f\"\u003cb\u003eSent to ServiceNow at {datetime.now()}\u003c/b\u003e\u003cbr\u003e{note.text.content}\"",
          "tags": [],
          "uuid": "60fecb55-7cbb-4ade-803f-d75bf5fa98b5"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Sent to ServiceNow at"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "snow_send_as_additional_comment_pb",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_fae27efd-55f8-4473-b9f2-c044a0b6a97c",
        "id": 52,
        "name": "playbook_fae27efd_55f8_4473_b9f2_c044a0b6a97c",
        "type": "playbook",
        "uuid": "13eda8cc-3269-46f0-bfb9-9b1c1cc7516e"
      },
      "tags": [],
      "type": "default",
      "uuid": "fae27efd-55f8-4473-b9f2-c044a0b6a97c",
      "version": 5
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06\" isExecutable=\"true\" name=\"playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1el4yjo\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Add Note to Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c43f8cc1-5cdc-41a6-a6b0-fa59dd32df36\"\u003e{\"inputs\":{\"811e99d7-d194-4ce8-86cc-aff5e01ab85c\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"908e2bd1-d682-44e1-9240-efb5c2bf23a1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"19d5e854-dc64-43d4-9a39-7be914920ad6\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"c65de77d-f6b2-4c19-94eb-cdfa5cf5037f\"}},\"ba318261-ed6a-4a38-a187-9e0b68d1604f\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"inputs.sn_note_type = \\\"work_note\\\"\\n# The id of this incident\\ninputs.incident_id = incident.id\\n\\n# If this is a task note, get the taskId\\nif note.type == \u0027task\u0027:\\n  # Set the task_id\\n  inputs.task_id = task.id\\n\\n# Get the text of the note\\ninputs.sn_note_text = note.text.content\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_note\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1el4yjo\u003c/incoming\u003e\u003coutgoing\u003eFlow_12cxyxn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1el4yjo\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f3e64ae6-3ba9-406b-ab9a-5a2b8b013abc\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_12cxyxn\u003c/incoming\u003e\u003coutgoing\u003eFlow_06e0j7j\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_12cxyxn\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_06e0j7j\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_06e0j7j\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1el4yjo\" id=\"Flow_1el4yjo_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_12cxyxn\" id=\"Flow_12cxyxn_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_06e0j7j\" id=\"Flow_06e0j7j_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"454\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"162.5667\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"454\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684262658240,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Send as Work Note (PB)",
      "export_key": "snow_send_as_work_note_pb",
      "field_type_handle": "playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Send as Work Note (PB)",
        "export_key": "playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06",
        "uuid": "cee26ce2-c81f-46ed-a249-e415c5e9df96"
      },
      "has_logical_errors": false,
      "id": 53,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684262801502,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684262783426,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 77,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684262783436,
          "name": "post process",
          "object_type": "note",
          "playbook_handle": "snow_send_as_work_note_pb",
          "programmatic_name": "snow_send_as_work_note_pb_post_process",
          "script_text": "from datetime import datetime\nnote.text = f\"\u003cb\u003eSent to ServiceNow at {datetime.now()}\u003c/b\u003e\u003cbr\u003e{note.text.content}\"",
          "tags": [],
          "uuid": "f3e64ae6-3ba9-406b-ab9a-5a2b8b013abc"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "note.text",
              "method": "not_contains",
              "type": null,
              "value": "Sent to ServiceNow at"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "snow_send_as_work_note_pb",
      "object_type": "note",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_64920ab3-7a3f-49a4-bfd0-eaac83149e06",
        "id": 53,
        "name": "playbook_64920ab3_7a3f_49a4_bfd0_eaac83149e06",
        "type": "playbook",
        "uuid": "3ddf7aac-d0a3-4d85-83c4-b5c36f64e7d9"
      },
      "tags": [],
      "type": "default",
      "uuid": "64920ab3-7a3f-49a4-bfd0-eaac83149e06",
      "version": 5
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "changed",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1\" isExecutable=\"true\" name=\"playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0fr6c68\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW Helper: Update Data Table\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6130c083-17ea-4262-986b-8d073d3f7328\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Get the incident id\\ninputs.incident_id = incident.id\\n\\n# Get the new status of the incident\\ninputs.sn_resilient_status = incident.plan_status\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_data_table\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0fr6c68\u003c/incoming\u003e\u003coutgoing\u003eFlow_08aob7k\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0fr6c68\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_08aob7k\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_08aob7k\" sourceRef=\"ServiceTask_1\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0fr6c68\" id=\"Flow_0fr6c68_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_08aob7k\" id=\"Flow_08aob7k_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"294\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"294\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684259851542,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Update Data Table on Status Change [Incident] (PB)",
      "export_key": "snow_update_data_table_on_status_change_incident_pb",
      "field_type_handle": "playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Update Data Table on Status Change [Incident] (PB)",
        "export_key": "playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1",
        "uuid": "84b5995f-5b06-4a7d-83c4-6f3ef9721e62"
      },
      "has_logical_errors": false,
      "id": 47,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684259989454,
      "local_scripts": [],
      "name": "snow_update_data_table_on_status_change_incident_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_220a34cb-6f4e-4cd4-8feb-854fed31bea1",
        "id": 47,
        "name": "playbook_220a34cb_6f4e_4cd4_8feb_854fed31bea1",
        "type": "playbook",
        "uuid": "47219148-db2e-4d05-a001-49a241e8f2f4"
      },
      "tags": [],
      "type": "default",
      "uuid": "220a34cb-6f4e-4cd4-8feb-854fed31bea1",
      "version": 5
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "task.status",
              "method": "changed",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc\" isExecutable=\"true\" name=\"playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_14kgw9i\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW Helper: Update Data Table\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"6130c083-17ea-4262-986b-8d073d3f7328\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Get the incident id\\ninputs.incident_id = incident.id\\n\\n# Get the task id\\ninputs.task_id = task.id\\n\\n# Get the new status of the task\\ninputs.sn_resilient_status = task.status\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"update_data_table\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_14kgw9i\u003c/incoming\u003e\u003coutgoing\u003eFlow_0c6uea7\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_14kgw9i\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0c6uea7\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0c6uea7\" sourceRef=\"ServiceTask_1\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14kgw9i\" id=\"Flow_14kgw9i_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0c6uea7\" id=\"Flow_0c6uea7_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"324\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"161.48329999999999\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"324\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684260009297,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Update Data Table on Status Change [Task] (PB)",
      "export_key": "snow_update_data_table_on_status_change_task_pb",
      "field_type_handle": "playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Update Data Table on Status Change [Task] (PB)",
        "export_key": "playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc",
        "uuid": "164b7808-1750-4033-ad58-d44e1defc1db"
      },
      "has_logical_errors": false,
      "id": 48,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684260077962,
      "local_scripts": [],
      "name": "snow_update_data_table_on_status_change_task_pb",
      "object_type": "task",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_e6abcf71-4c86-44fd-82e2-f72fcf64d6dc",
        "id": 48,
        "name": "playbook_e6abcf71_4c86_44fd_82e2_f72fcf64d6dc",
        "type": "playbook",
        "uuid": "24c8c172-652f-46cd-b2b4-5261e973e498"
      },
      "tags": [],
      "type": "default",
      "uuid": "e6abcf71-4c86-44fd-82e2-f72fcf64d6dc",
      "version": 5
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_edcd1bb4_0249_4a25_bcca_e17347857277\" isExecutable=\"true\" name=\"playbook_edcd1bb4_0249_4a25_bcca_e17347857277\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_077rlcc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Close Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"edadf951-4652-48a9-8068-9b719bf4bfe4\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# A Dictionary that maps Record States to their corresponding codes\\n# These codes are defined in ServiceNow and may be different for each ServiceNow configuration\\n# Codes prepended with [SIR] are specific to Security Incident Response incidents\\nmap_sn_record_states = {\\n  \\\"New\\\": 1,\\n  \\\"In Progress\\\": 2,\\n  \\\"On Hold\\\": 3,\\n  \\\"[INC] Resolved\\\": 6,\\n  \\\"[INC] Closed\\\": 7,\\n  \\\"[INC] Canceled\\\": 8,\\n\\t\\\"[SIR] Analysis\\\": 16,\\n\\t\\\"[SIR] Contain\\\": 18,\\n\\t\\\"[SIR] Eradicate\\\": 19,\\n\\t\\\"[SIR] Recover\\\": 20,\\n\\t\\\"[SIR] Review\\\": 100,\\n\\t\\\"[SIR] Closed\\\": 3,\\n\\t\\\"[SIR] Canceled\\\": 7\\n}\\n\\n# ID of this incident\\ninputs.incident_id = incident.id\\n\\n# RES ID of this SNOW record from the Data Table row\\ninputs.sn_res_id = row.sn_records_dt_res_id\\n\\n# The state to change the record to\\ninputs.sn_record_state = map_sn_record_states.get(playbook.inputs.sn_record_state)\\n\\n# The resolution notes that are normally required when you close a ServiceNow record\\ninputs.sn_close_notes = playbook.inputs.sn_close_notes\\n\\n# The ServiceNow \u0027close_code\u0027 that you normally select when closing a ServiceNow record\\ninputs.sn_close_code = playbook.inputs.sn_close_code\\n\\n# Add a Work Note to the Record in ServiceNow\\ninputs.sn_close_work_note = f\\\"This record\u0027s state has been changed to {playbook.inputs.sn_record_state} by IBM SOAR\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"close_in_sn\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_077rlcc\u003c/incoming\u003e\u003coutgoing\u003eFlow_0vwiu22\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_077rlcc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"488a18f2-a7fd-47c8-9a6b-fc2f367bc634\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0vwiu22\u003c/incoming\u003e\u003coutgoing\u003eFlow_103hgzz\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0vwiu22\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cexclusiveGateway default=\"Flow_0zqn8dv\" id=\"ConditionPoint_3\" resilient:documentation=\"Condition point\"\u003e\u003cextensionElements/\u003e\u003cincoming\u003eFlow_103hgzz\u003c/incoming\u003e\u003coutgoing\u003eFlow_0b4bf5c\u003c/outgoing\u003e\u003coutgoing\u003eFlow_0zqn8dv\u003c/outgoing\u003e\u003c/exclusiveGateway\u003e\u003csequenceFlow id=\"Flow_103hgzz\" sourceRef=\"ScriptTask_2\" targetRef=\"ConditionPoint_3\"/\u003e\u003cserviceTask id=\"ServiceTask_4\" name=\"SNOW Helper: Add Task Note\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f02d65f0-f19a-414a-828d-5c35de5270b1\"\u003e{\"inputs\":{},\"pre_processing_script\":\"note_text = None\\nresults = playbook.functions.results.close_in_sn\\nif results.get(\\\"success\\\"):\\n  \\n  # If we successfully closed the record, set this note_text\\n  note_text = f\\\"\\\"\\\"\u0026lt;br\u0026gt;This Task has been updated in \u0026lt;b\u0026gt;ServiceNow\u0026lt;/b\u0026gt;\\n              \u0026lt;br\u0026gt;\u0026lt;b\u0026gt;ServiceNow ID:\u0026lt;/b\u0026gt; {results.get(\u0027sn_ref_id\u0027)}\\n              \u0026lt;br\u0026gt;\u0026lt;b\u0026gt;ServiceNow Record State:\u0026lt;/b\u0026gt; {results.get(\u0027sn_record_state\u0027)}\\n              \u0026lt;br\u0026gt;\u0026lt;b\u0026gt;ServiceNow Closing Notes:\u0026lt;/b\u0026gt; {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_notes\u0027)}\\n              \u0026lt;br\u0026gt;\u0026lt;b\u0026gt;ServiceNow Closing Code:\u0026lt;/b\u0026gt; {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_code\u0027)}\\\"\\\"\\\"\\n\\nelse:\\n  # Else, it failed, so set this note_text\\n  note_text = f\\\"\\\"\\\"\u0026lt;br\u0026gt;Failed to close this Task in \u0026lt;b\u0026gt;ServiceNow\u0026lt;/b\u0026gt;\\n            \u0026lt;br\u0026gt;\u0026lt;b\u0026gt;Reason:\u0026lt;/b\u0026gt; {results.get(\\\"reason\\\")}\\\"\\\"\\\"\\n\\n# Get sn_res_id from the Data Table\\ninputs.sn_res_id = row.sn_records_dt_res_id\\n\\n# Set the sn_note_text input\\ninputs.sn_note_text = note_text\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"add_task_note\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0b4bf5c\u003c/incoming\u003e\u003coutgoing\u003eFlow_1nozhak\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cendEvent id=\"EndPoint_5\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1nozhak\u003c/incoming\u003e\u003cincoming\u003eFlow_0zqn8dv\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1nozhak\" sourceRef=\"ServiceTask_4\" targetRef=\"EndPoint_5\"/\u003e\u003csequenceFlow id=\"Flow_0b4bf5c\" name=\"do_continue\" sourceRef=\"ConditionPoint_3\" targetRef=\"ServiceTask_4\"\u003e\u003cextensionElements\u003e\u003cresilient:condition label=\"do_continue\" order=\"0\"/\u003e\u003c/extensionElements\u003e\u003cconditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\"\u003e{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"result = row.sn_records_dt_type == \\\"Task\\\"\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}\u003c/conditionExpression\u003e\u003c/sequenceFlow\u003e\u003csequenceFlow id=\"Flow_0zqn8dv\" name=\"Else\" sourceRef=\"ConditionPoint_3\" targetRef=\"EndPoint_5\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_edcd1bb4_0249_4a25_bcca_e17347857277\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_077rlcc\" id=\"Flow_077rlcc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"208\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0vwiu22\" id=\"Flow_0vwiu22_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"292\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_103hgzz\" id=\"Flow_103hgzz_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"504\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0b4bf5c\" id=\"Flow_0b4bf5c_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"556\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"638\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"62\" x=\"690\" y=\"583\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nozhak\" id=\"Flow_1nozhak_di\"\u003e\u003comgdi:waypoint x=\"819\" y=\"680\"/\u003e\u003comgdi:waypoint x=\"894\" y=\"680\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0zqn8dv\" id=\"Flow_0zqn8dv_di\"\u003e\u003comgdi:waypoint x=\"843\" y=\"530\"/\u003e\u003comgdi:waypoint x=\"960\" y=\"530\"/\u003e\u003comgdi:waypoint x=\"960\" y=\"654\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"23\" x=\"948.9999999999999\" y=\"523\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"208\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ConditionPoint_3\" id=\"ConditionPoint_3_di\" isMarkerVisible=\"true\"\u003e\u003comgdc:Bounds height=\"52\" width=\"243.6\" x=\"599\" y=\"504\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_5\" id=\"EndPoint_5_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"894\" y=\"654\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"638\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684262825370,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Update/Close Record (PB)",
      "export_key": "snow_updateclose_record_pb",
      "field_type_handle": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Update/Close Record (PB)",
        "export_key": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
        "fields": {
          "sn_close_code": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277/sn_close_code",
            "hide_notification": false,
            "id": 4552,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_close_code",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Close Code",
            "tooltip": "Optional. Sets the close code only when Record State is CLOSED",
            "type_id": 1067,
            "uuid": "3eca123e-cf0c-4ece-af6b-4c2d87382213",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Solved (Work Around)",
                "properties": null,
                "uuid": "56070ec6-50df-41df-ac2b-9771dffabb59",
                "value": 988
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Solved (Permanently)",
                "properties": null,
                "uuid": "b5d4c881-3a1d-4bba-8bb4-839c2fc8817e",
                "value": 989
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Solved (Not Reproducible)",
                "properties": null,
                "uuid": "6df00d88-ff9d-44c3-ac40-0baafea8c517",
                "value": 990
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Solved (Too Costly)",
                "properties": null,
                "uuid": "b9ea1766-1ddc-45d7-bfd1-c9ed3f2237ad",
                "value": 991
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Closed/Resolved by Caller",
                "properties": null,
                "uuid": "0df2c9c7-a3c5-469c-9236-6938cf0fa2ad",
                "value": 992
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Investigation completed",
                "properties": null,
                "uuid": "c72df9f4-1f59-481a-9f16-b8556fd384d2",
                "value": 993
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Threat mitigated",
                "properties": null,
                "uuid": "7ecb1479-bf7f-41e9-b59d-2d3d9b016737",
                "value": 994
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Patched vulnerability",
                "properties": null,
                "uuid": "aca5ed90-05a7-466c-9592-2f25e7195288",
                "value": 995
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Invalid vulnerability",
                "properties": null,
                "uuid": "6cd0fdc3-17bd-4a7c-9dfa-c1d289f0f961",
                "value": 996
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not resolved",
                "properties": null,
                "uuid": "8bfc2a73-4176-4f74-8514-ffbfb0b0f0ff",
                "value": 997
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "False positive",
                "properties": null,
                "uuid": "108a8f26-39ed-45a3-b2a1-9099b15faa9b",
                "value": 998
              }
            ]
          },
          "sn_close_notes": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277/sn_close_notes",
            "hide_notification": false,
            "id": 4553,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "sn_close_notes",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Close Notes",
            "tooltip": "Optional. Note to be added to record when state is CLOSED",
            "type_id": 1067,
            "uuid": "41b3f8e4-53fd-4566-a02d-4b22dfaff152",
            "values": []
          },
          "sn_record_state": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277/sn_record_state",
            "hide_notification": false,
            "id": 4554,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_record_state",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Record State",
            "tooltip": "Use INC state for SNOW Incident tables and SIR States for Security Incident Response tables",
            "type_id": 1067,
            "uuid": "93655d2e-3e26-4046-93cd-19cb4903a91a",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Resolved",
                "properties": null,
                "uuid": "ec21081b-ec92-45df-8fd2-cfac710e8e95",
                "value": 999
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Closed",
                "properties": null,
                "uuid": "95830893-b77c-4761-9678-6bc5f4614671",
                "value": 1000
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Canceled",
                "properties": null,
                "uuid": "cbab115d-ae0c-465c-8915-4dbf2c8d1fe5",
                "value": 1001
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Analysis",
                "properties": null,
                "uuid": "b15a7a86-bbe9-4148-9218-5048afbdbe92",
                "value": 1002
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Contain",
                "properties": null,
                "uuid": "e161445b-cfa5-47ca-bdec-aee9327d65a5",
                "value": 1003
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Eradicate",
                "properties": null,
                "uuid": "3c0c0116-ff23-4f7f-8d3e-10e53377ac96",
                "value": 1004
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Recover",
                "properties": null,
                "uuid": "1575eddf-57be-4822-ad0f-2f4633961ffe",
                "value": 1005
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Review",
                "properties": null,
                "uuid": "77a4e85c-1256-4c48-9bc6-2e4c686f5a20",
                "value": 1006
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Closed",
                "properties": null,
                "uuid": "af377f76-ca50-4b1d-ae2f-232b4bb8e564",
                "value": 1007
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Canceled",
                "properties": null,
                "uuid": "8fd951a9-c83e-4dca-86f2-1c70bb99b420",
                "value": 1008
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
        "uuid": "b809ad39-4159-46c1-9091-598d542c315e"
      },
      "has_logical_errors": false,
      "id": 54,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684263662463,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684263249685,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 78,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684263249695,
          "name": "post process",
          "object_type": "sn_records_dt",
          "playbook_handle": "snow_updateclose_record_pb",
          "programmatic_name": "snow_updateclose_record_pb_post_process",
          "script_text": "results = playbook.functions.results.close_in_sn\n# If the SOAR item type is Incident (if it is Task, we run the SNOW Helper: Add Task Note function)\nif row.sn_records_dt_type == \"Incident\":\n  note_text = None\n  \n  # And it was a success, set this note_text\n  if results.get(\"success\"):\n    note_text = f\"\"\"\u003cbr\u003eThis Incident has been updated in \u003cb\u003eServiceNow\u003c/b\u003e\n                \u003cbr\u003e\u003cb\u003eServiceNow ID:\u003c/b\u003e {results.get(\u0027sn_ref_id\u0027)}\n                \u003cbr\u003e\u003cb\u003eServiceNow Record State:\u003c/b\u003e {results.get(\u0027sn_record_state\u0027)}\n                \u003cbr\u003e\u003cb\u003eServiceNow Closing Notes:\u003c/b\u003e {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_notes\u0027)}\n                \u003cbr\u003e\u003cb\u003eServiceNow Closing Code:\u003c/b\u003e {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_code\u0027))}\"\"\"\n\n  # Else, it failed, so set this note_text\n  else:\n    note_text = f\"\"\"\u003cbr\u003eFailed to close this Incident in \u003cb\u003eServiceNow\u003c/b\u003e\n                \u003cbr\u003e\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\"\"\n\n  incident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "488a18f2-a7fd-47c8-9a6b-fc2f367bc634"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "93655d2e-3e26-4046-93cd-19cb4903a91a",
            "element": "field_uuid",
            "field_type": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "3eca123e-cf0c-4ece-af6b-4c2d87382213",
            "element": "field_uuid",
            "field_type": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "41b3f8e4-53fd-4566-a02d-4b22dfaff152",
            "element": "field_uuid",
            "field_type": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "snow_updateclose_record_pb",
      "object_type": "sn_records_dt",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_edcd1bb4-0249-4a25-bcca-e17347857277",
        "id": 54,
        "name": "playbook_edcd1bb4_0249_4a25_bcca_e17347857277",
        "type": "playbook",
        "uuid": "16ec98ec-b569-4e84-8e29-4521a54ecafe"
      },
      "tags": [],
      "type": "default",
      "uuid": "edcd1bb4-0249-4a25-bcca-e17347857277",
      "version": 5
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f\" isExecutable=\"true\" name=\"playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_030xauf\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Close Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"edadf951-4652-48a9-8068-9b719bf4bfe4\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# A Dictionary that maps Record States to their corresponding codes\\n# These codes are defined in ServiceNow and may be different for each ServiceNow configuration\\n# Codes prepended with [SIR] are specific to Security Incident Response incidents\\nmap_sn_record_states = {\\n  \\\"New\\\": 1,\\n  \\\"In Progress\\\": 2,\\n  \\\"On Hold\\\": 3,\\n  \\\"[INC] Resolved\\\": 6,\\n  \\\"[INC] Closed\\\": 7,\\n  \\\"[INC] Canceled\\\": 8,\\n\\t\\\"[SIR] Analysis\\\": 16,\\n\\t\\\"[SIR] Contain\\\": 18,\\n\\t\\\"[SIR] Eradicate\\\": 19,\\n\\t\\\"[SIR] Recover\\\": 20,\\n\\t\\\"[SIR] Review\\\": 100,\\n\\t\\\"[SIR] Closed\\\": 3,\\n\\t\\\"[SIR] Canceled\\\": 7\\n}\\n\\n# ID of this incident\\ninputs.incident_id = incident.id\\n\\n# The state to change the record to\\n# inputs.sn_record_state = map_sn_record_states[\\\"Closed\\\"]\\ninputs.sn_record_state = map_sn_record_states[playbook.inputs.sn_record_state]\\n\\n# The resolution notes that are normally required when you close a ServiceNow record\\n# inputs.sn_close_notes = \\\"This incident has been resolved in IBM SOAR. No further action required\\\"\\ninputs.sn_close_notes = playbook.inputs.sn_close_notes\\n\\n# The ServiceNow \u0027close_code\u0027 that you normally select when closing a ServiceNow record\\n# inputs.sn_close_code = \\\"Solved (Permanently)\\\"\\ninputs.sn_close_code = playbook.inputs.sn_close_code\\n\\n# Add a Work Note to the Record in ServiceNow\\ninputs.sn_close_work_note = f\\\"This record\u0027s state has been changed to {playbook.incident.sn_record_state} by IBM SOAR\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"close_record\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_030xauf\u003c/incoming\u003e\u003coutgoing\u003eFlow_0wztaau\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_030xauf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"82a425ab-8d3e-48a0-8672-e12b9b498585\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0wztaau\u003c/incoming\u003e\u003coutgoing\u003eFlow_085mkuv\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0wztaau\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_085mkuv\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_085mkuv\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_030xauf\" id=\"Flow_030xauf_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"168\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wztaau\" id=\"Flow_0wztaau_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"252\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_085mkuv\" id=\"Flow_085mkuv_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"434\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"168\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"308\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"434\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684263681289,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Update/Close Record [Incident] (PB)",
      "export_key": "snow_updateclose_record_incident_pb",
      "field_type_handle": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Update/Close Record [Incident] (PB)",
        "export_key": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
        "fields": {
          "sn_close_code": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f/sn_close_code",
            "hide_notification": false,
            "id": 4555,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_close_code",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Close Code",
            "tooltip": "Optional. Sets the close code only when Record State is CLOSED",
            "type_id": 1068,
            "uuid": "6cb1f7f0-6f52-428a-8150-d9c8c80f38e8",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Solved (Work Around)",
                "properties": null,
                "uuid": "6246c121-b899-4de6-bbc0-fd9ab17b519f",
                "value": 1009
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Solved (Permanently)",
                "properties": null,
                "uuid": "456aaad5-e5c6-4277-a45e-c763a6ed14e2",
                "value": 1010
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Solved (Not Reproducible)",
                "properties": null,
                "uuid": "4c6c687c-f7c5-4c32-b82c-7da832816648",
                "value": 1011
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Solved (Too Costly)",
                "properties": null,
                "uuid": "9a83ffb2-48b8-4878-aa86-9374f31a5ee1",
                "value": 1012
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Closed/Resolved by Caller",
                "properties": null,
                "uuid": "478b2383-cd13-454e-8e62-af786e502697",
                "value": 1013
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Investigation completed",
                "properties": null,
                "uuid": "5f721fba-73c4-4d8f-a0fc-eca2cd76a61d",
                "value": 1014
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Threat mitigated",
                "properties": null,
                "uuid": "4e98ad83-5d6f-44ac-ac39-6298d0b23ff5",
                "value": 1015
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Patched vulnerability",
                "properties": null,
                "uuid": "397905a1-b60a-4be1-9905-10339e7796f9",
                "value": 1016
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Invalid vulnerability",
                "properties": null,
                "uuid": "3222705e-b4b4-425a-bee7-df4ce396b938",
                "value": 1017
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not resolved",
                "properties": null,
                "uuid": "2acee495-0ea0-4422-a9d3-97138a1661c7",
                "value": 1018
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "False positive",
                "properties": null,
                "uuid": "ed73ffd2-1ca9-4315-8363-0ec44704c902",
                "value": 1019
              }
            ]
          },
          "sn_close_notes": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f/sn_close_notes",
            "hide_notification": false,
            "id": 4556,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "sn_close_notes",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Close Notes",
            "tooltip": "Optional. Note to be added to record when state is CLOSED",
            "type_id": 1068,
            "uuid": "99faf2a3-bd94-42b2-9c9d-54815f154016",
            "values": []
          },
          "sn_record_state": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f/sn_record_state",
            "hide_notification": false,
            "id": 4557,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_record_state",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Record State",
            "tooltip": "Use INC state for SNOW Incident tables and SIR States for Security Incident Response tables",
            "type_id": 1068,
            "uuid": "e1e3ccb6-8f31-4416-87b4-1778210de08f",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Resolved",
                "properties": null,
                "uuid": "16da25ac-2de6-42f8-b4be-eeeab61f9744",
                "value": 1020
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Closed",
                "properties": null,
                "uuid": "e5c4c59b-fb4e-47d5-8d53-13cd9aaeab5f",
                "value": 1021
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Canceled",
                "properties": null,
                "uuid": "504b729c-f810-480a-b133-9e343b921f84",
                "value": 1022
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Analysis",
                "properties": null,
                "uuid": "e7f4fde8-b5a2-488e-a751-47da827673f3",
                "value": 1023
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Contain",
                "properties": null,
                "uuid": "88997a82-7199-4810-a455-3bd12b06dbe8",
                "value": 1024
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Eradicate",
                "properties": null,
                "uuid": "277f71a0-a2ab-4a2a-9337-26134fb1a3b3",
                "value": 1025
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Recover",
                "properties": null,
                "uuid": "a59cd164-0a72-45eb-9b43-ee78453a33d1",
                "value": 1026
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Review",
                "properties": null,
                "uuid": "8f0a7f91-df8d-43dc-a67c-03612ce6c9ed",
                "value": 1027
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Closed",
                "properties": null,
                "uuid": "cfd48c20-0fb0-4d56-831b-8192bc0b306e",
                "value": 1028
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Canceled",
                "properties": null,
                "uuid": "d0fe3a21-eeff-4149-bf09-d06fb3bd7401",
                "value": 1029
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
        "uuid": "628e0198-3bc9-4e42-b54e-2bef6f3d569a"
      },
      "has_logical_errors": false,
      "id": 55,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684264081623,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684263854542,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 79,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684264075780,
          "name": "post process",
          "object_type": "incident",
          "playbook_handle": "snow_updateclose_record_incident_pb",
          "programmatic_name": "snow_updateclose_record_incident_pb_post_process",
          "script_text": "results = playbook.functions.results.close_record\nif results.get(\"success\"):\n  note_text = f\"\"\"\u003cbr\u003eThis Incident has been updated in \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eServiceNow ID:\u003c/b\u003e {results.get(\u0027sn_ref_id\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Record State:\u003c/b\u003e {results.get(\u0027sn_record_state\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Closing Notes:\u003c/b\u003e {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_notes\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Closing Code:\u003c/b\u003e {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_code\u0027)}\"\"\"\nelse:\n  note_text = f\"\"\"\u003cbr\u003eFailed to close this Incident in \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\"\"\n\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "82a425ab-8d3e-48a0-8672-e12b9b498585"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.sn_snow_record_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "e1e3ccb6-8f31-4416-87b4-1778210de08f",
            "element": "field_uuid",
            "field_type": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "6cb1f7f0-6f52-428a-8150-d9c8c80f38e8",
            "element": "field_uuid",
            "field_type": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "99faf2a3-bd94-42b2-9c9d-54815f154016",
            "element": "field_uuid",
            "field_type": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "snow_updateclose_record_incident_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_536adc5b-6286-4ff2-ae36-72ef17ffc20f",
        "id": 55,
        "name": "playbook_536adc5b_6286_4ff2_ae36_72ef17ffc20f",
        "type": "playbook",
        "uuid": "b5c0ccfe-696e-4c30-b75d-739dad73fa85"
      },
      "tags": [],
      "type": "default",
      "uuid": "536adc5b-6286-4ff2-ae36-72ef17ffc20f",
      "version": 5
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 2,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423\" isExecutable=\"true\" name=\"playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_18kx1xj\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"SNOW: Close Record\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"edadf951-4652-48a9-8068-9b719bf4bfe4\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# A Dictionary that maps Record States to their corresponding codes\\n# These codes are defined in ServiceNow and may be different for each ServiceNow configuration\\n# Codes prepended with [SIR] are specific to Security Incident Response incidents\\nmap_sn_record_states = {\\n  \\\"New\\\": 1,\\n  \\\"In Progress\\\": 2,\\n  \\\"On Hold\\\": 3,\\n  \\\"[INC] Resolved\\\": 6,\\n  \\\"[INC] Closed\\\": 7,\\n  \\\"[INC] Canceled\\\": 8,\\n\\t\\\"[SIR] Analysis\\\": 16,\\n\\t\\\"[SIR] Contain\\\": 18,\\n\\t\\\"[SIR] Eradicate\\\": 19,\\n\\t\\\"[SIR] Recover\\\": 20,\\n\\t\\\"[SIR] Review\\\": 100,\\n\\t\\\"[SIR] Closed\\\": 3,\\n\\t\\\"[SIR] Canceled\\\": 7\\n}\\n\\n# ID of this incident\\ninputs.incident_id = incident.id\\n\\n# ID of this task\\ninputs.task_id = task.id\\n\\n# The state to change the record to\\n# inputs.sn_record_state = map_sn_record_states[\\\"Closed\\\"]\\ninputs.sn_record_state = map_sn_record_states[playbook.inputs.sn_record_state]\\n\\n# The resolution notes that are normally required when you close a ServiceNow record\\n# inputs.sn_close_notes = \\\"This incident has been resolved in IBM SOAR. No further action required\\\"\\ninputs.sn_close_notes = playbook.inputs.sn_close_notes\\n\\n# The ServiceNow \u0027close_code\u0027 that you normally select when closing a ServiceNow record\\n# inputs.sn_close_code = \\\"Solved (Permanently)\\\"\\ninputs.sn_close_code = playbook.inputs.sn_close_code\\n\\n# Add a Work Note to the Record in ServiceNow\\ninputs.sn_close_work_note = f\\\"This record\u0027s state has been changed to {playbook.inputs.sn_record_state} by IBM SOAR\\\"\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"close_record\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_18kx1xj\u003c/incoming\u003e\u003coutgoing\u003eFlow_1q6qsnc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_18kx1xj\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"post process\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"787488cb-b82d-4925-83d4-75ac5eefbe85\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1q6qsnc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1rpv64c\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1q6qsnc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1rpv64c\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1rpv64c\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_18kx1xj\" id=\"Flow_18kx1xj_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1q6qsnc\" id=\"Flow_1q6qsnc_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"318\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1rpv64c\" id=\"Flow_1rpv64c_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"402\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"454\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"161.48329999999999\" x=\"640\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"318\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"454\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1684264099740,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "SNOW: Update/Close Record [Task] (PB)",
      "export_key": "snow_updateclose_record_task_pb",
      "field_type_handle": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
      "fields_type": {
        "actions": [],
        "display_name": "SNOW: Update/Close Record [Task] (PB)",
        "export_key": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
        "fields": {
          "sn_close_code": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423/sn_close_code",
            "hide_notification": false,
            "id": 4558,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_close_code",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Close Code",
            "tooltip": "Optional. Sets the close code only when Record State is CLOSED",
            "type_id": 1069,
            "uuid": "aa8a86c5-8980-475e-8383-9fe0704f4cb2",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Solved (Work Around)",
                "properties": null,
                "uuid": "de767ea9-8214-4654-a553-1b6ba44ea494",
                "value": 1030
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Solved (Permanently)",
                "properties": null,
                "uuid": "8fc18dad-8399-4d0a-bcf7-32d4f559dbaf",
                "value": 1031
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Solved (Not Reproducible)",
                "properties": null,
                "uuid": "6c495ca9-3abe-4208-b7d9-24ccb2afe096",
                "value": 1032
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not Solved (Too Costly)",
                "properties": null,
                "uuid": "d233d03f-7bdf-4ba6-a17d-7923c7c25e9f",
                "value": 1033
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Closed/Resolved by Caller",
                "properties": null,
                "uuid": "7347bbf3-7517-4e77-b041-06b18367486d",
                "value": 1034
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Investigation completed",
                "properties": null,
                "uuid": "11e9cabd-d4f1-47ff-bfdc-79af168bc7e3",
                "value": 1035
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Threat mitigated",
                "properties": null,
                "uuid": "42bd5afd-7471-4b37-8b97-de4f3b444cda",
                "value": 1036
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Patched vulnerability",
                "properties": null,
                "uuid": "10863819-a1c6-41c7-9890-cce3cc008bfa",
                "value": 1037
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Invalid vulnerability",
                "properties": null,
                "uuid": "c57dce4c-86d0-470e-8cfb-41913c9dab07",
                "value": 1038
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Not resolved",
                "properties": null,
                "uuid": "0f5eb06b-0d7f-479c-97c2-30dd5bbc9b3f",
                "value": 1039
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "False positive",
                "properties": null,
                "uuid": "32d0b824-f227-4daa-974d-436cc4078182",
                "value": 1040
              }
            ]
          },
          "sn_close_notes": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423/sn_close_notes",
            "hide_notification": false,
            "id": 4559,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "sn_close_notes",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Close Notes",
            "tooltip": "Optional. Note to be added to record when state is CLOSED",
            "type_id": 1069,
            "uuid": "e2b0868b-0596-47cd-918d-54f03e59c541",
            "values": []
          },
          "sn_record_state": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423/sn_record_state",
            "hide_notification": false,
            "id": 4560,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "sn_record_state",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "SN Record State",
            "tooltip": "Use INC state for SNOW Incident tables and SIR States for Security Incident Response tables",
            "type_id": 1069,
            "uuid": "76bc3ddf-e62f-4479-a549-92d9ecd75cab",
            "values": [
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Resolved",
                "properties": null,
                "uuid": "8e3e8c9c-388b-4495-812d-68f9b4482375",
                "value": 1041
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Closed",
                "properties": null,
                "uuid": "64df972d-9c3a-464e-8a85-f6e99a25424e",
                "value": 1042
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[INC] Canceled",
                "properties": null,
                "uuid": "b7994a00-2f79-48ba-8167-6207913cf539",
                "value": 1043
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Analysis",
                "properties": null,
                "uuid": "05b48c98-7b59-4c12-87a4-840f974e006a",
                "value": 1044
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Contain",
                "properties": null,
                "uuid": "a7a930f2-eba2-4df0-a722-e75d5bd3f804",
                "value": 1045
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Eradicate",
                "properties": null,
                "uuid": "6e143172-c622-4f61-9970-b7d9bbedcc70",
                "value": 1046
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Recover",
                "properties": null,
                "uuid": "77d2b513-fdfe-4fc2-af76-7c823c22cc5b",
                "value": 1047
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Review",
                "properties": null,
                "uuid": "1514abfe-03b0-44a1-aa3b-a64aed84a3cc",
                "value": 1048
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Closed",
                "properties": null,
                "uuid": "3a778ad2-8f01-4ca0-9365-1bc98a64af8b",
                "value": 1049
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "[SIR] Canceled",
                "properties": null,
                "uuid": "c028da6b-3f50-4eea-a89c-00ee4f1b60bb",
                "value": 1050
              }
            ]
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
        "uuid": "877d0656-a09b-412a-b418-4cc7a820ec76"
      },
      "has_logical_errors": false,
      "id": 56,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 38,
        "name": "j@example.com",
        "type": "user"
      },
      "last_modified_time": 1684264475082,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1684264461463,
          "description": "",
          "enabled": false,
          "export_key": "post process",
          "id": 80,
          "language": "python3",
          "last_modified_by": "j@example.com",
          "last_modified_time": 1684264461473,
          "name": "post process",
          "object_type": "task",
          "playbook_handle": "snow_updateclose_record_task_pb",
          "programmatic_name": "snow_updateclose_record_task_pb_post_process",
          "script_text": "results = playbook.functions.results.close_record\nif results.get(\"success\"):\n  note_text = f\"\"\"\u003cbr\u003eThis Task has been updated in \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eServiceNow ID:\u003c/b\u003e {results.get(\u0027sn_ref_id\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Record State:\u003c/b\u003e {results.get(\u0027sn_record_state\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Closing Notes:\u003c/b\u003e {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_notes\u0027)}\n              \u003cbr\u003e\u003cb\u003eServiceNow Closing Code:\u003c/b\u003e {results.get(\u0027inputs\u0027, {}).get(\u0027sn_close_code\u0027)}\"\"\"\nelse:\n  note_text = f\"\"\"\u003cbr\u003eFailed to close this Task in \u003cb\u003eServiceNow\u003c/b\u003e\n              \u003cbr\u003e\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\"\"\n\ntask.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "787488cb-b82d-4925-83d4-75ac5eefbe85"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "76bc3ddf-e62f-4479-a549-92d9ecd75cab",
            "element": "field_uuid",
            "field_type": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "aa8a86c5-8980-475e-8383-9fe0704f4cb2",
            "element": "field_uuid",
            "field_type": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "e2b0868b-0596-47cd-918d-54f03e59c541",
            "element": "field_uuid",
            "field_type": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "snow_updateclose_record_task_pb",
      "object_type": "task",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_c21d4c8d-d49b-4c41-92c4-ddd0e60b3423",
        "id": 56,
        "name": "playbook_c21d4c8d_d49b_4c41_92c4_ddd0e60b3423",
        "type": "playbook",
        "uuid": "132e9fe1-ddf3-4406-9f29-bc1eaf5c0837"
      },
      "tags": [],
      "type": "default",
      "uuid": "c21d4c8d-d49b-4c41-92c4-ddd0e60b3423",
      "version": 5
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 8131,
    "major": 46,
    "minor": 0,
    "version": "46.0.8131"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "ServiceNow Records",
      "export_key": "sn_records_dt",
      "fields": {
        "sn_records_dt_links": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_links",
          "hide_notification": false,
          "id": 4518,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_links",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": true,
          "tags": [],
          "templates": [],
          "text": "Links",
          "tooltip": "Opens the record in a new tab in either IBM SOAR or SNOW",
          "type_id": 1057,
          "uuid": "7fafcc23-1b8d-44e0-a192-336bdd4137b2",
          "values": [],
          "width": 64
        },
        "sn_records_dt_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_name",
          "hide_notification": false,
          "id": 4519,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_name",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Name",
          "tooltip": "The name of the record",
          "type_id": 1057,
          "uuid": "b81b6dd1-78c0-4e35-9fc0-2883b0037890",
          "values": [],
          "width": 110
        },
        "sn_records_dt_res_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_res_id",
          "hide_notification": false,
          "id": 4520,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_res_id",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "SOAR ID",
          "tooltip": "Unique ID of IBM SOAR Incident or Task",
          "type_id": 1057,
          "uuid": "7709e2b5-f66c-403d-a8ba-c438837b78c9",
          "values": [],
          "width": 167
        },
        "sn_records_dt_res_status": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_res_status",
          "hide_notification": false,
          "id": 4521,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_res_status",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": true,
          "tags": [],
          "templates": [],
          "text": "SOAR Status",
          "tooltip": "The current status of the Incident/Task in IBM SOAR",
          "type_id": 1057,
          "uuid": "c99d25f2-8066-412a-ba89-4f1226b6af5e",
          "values": [],
          "width": 181
        },
        "sn_records_dt_sn_ref_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_sn_ref_id",
          "hide_notification": false,
          "id": 4522,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_sn_ref_id",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "SNOW ID",
          "tooltip": "ID of record in SNOW, unique to its table in SNOW",
          "type_id": 1057,
          "uuid": "cd9c9e13-ebbf-4b5e-a438-a7a969c1f9fd",
          "values": [],
          "width": 121
        },
        "sn_records_dt_snow_status": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_snow_status",
          "hide_notification": false,
          "id": 4523,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_snow_status",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": true,
          "tags": [],
          "templates": [],
          "text": "SNOW Status",
          "tooltip": "The current status of the record in SNOW",
          "type_id": 1057,
          "uuid": "fa7159db-73e4-464e-8bbd-5e7ef99f54e9",
          "values": [],
          "width": 181
        },
        "sn_records_dt_time": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_time",
          "hide_notification": false,
          "id": 4524,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_time",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Last Updated",
          "tooltip": "The time this row was last updated",
          "type_id": 1057,
          "uuid": "3da0c0bb-b1fa-40c9-9859-aa8458211ba6",
          "values": [],
          "width": 157
        },
        "sn_records_dt_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "sn_records_dt/sn_records_dt_type",
          "hide_notification": false,
          "id": 4525,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "sn_records_dt_type",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Type",
          "tooltip": "Either Incident or Task",
          "type_id": 1057,
          "uuid": "9fd786bb-cc8d-49c8-8df1-f02921e36578",
          "values": [],
          "width": 73
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "sn_records_dt",
      "uuid": "8d34ee77-4c54-4034-b68b-23cbf9088e11"
    }
  ],
  "workflows": [],
  "workspaces": []
}
