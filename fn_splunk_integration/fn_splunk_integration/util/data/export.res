{
  "action_order": [],
  "actions": [
    {
      "automations": [],
      "conditions": [],
      "enabled": true,
      "export_key": "Add artifact to Splunk ES",
      "id": 40,
      "logic_type": "all",
      "message_destinations": [],
      "name": "Add artifact to Splunk ES",
      "object_type": "artifact",
      "tags": [],
      "timeout_seconds": 86400,
      "type": 1,
      "uuid": "f47cb64b-c16b-46c8-9e91-78c456779bc6",
      "view_items": [
        {
          "content": "19536b13-46af-4a43-b573-f7af49d0c307",
          "element": "field_uuid",
          "field_type": "actioninvocation",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        "splunk_add_new_ip_intel"
      ]
    },
    {
      "automations": [],
      "conditions": [
        {
          "evaluation_id": null,
          "field_name": "splunk_intel_results.status",
          "method": "equals",
          "type": null,
          "value": "Active"
        }
      ],
      "enabled": true,
      "export_key": "Delete an intel entry in Splunk ES",
      "id": 26,
      "logic_type": "all",
      "message_destinations": [],
      "name": "Delete an intel entry in Splunk ES",
      "object_type": "splunk_intel_results",
      "tags": [],
      "timeout_seconds": 86400,
      "type": 1,
      "uuid": "4de7ea41-fdbf-4826-ae82-0b216f2c346e",
      "view_items": [],
      "workflows": [
        "example_of_deleting_an_intel_entry_in_splunk_es"
      ]
    },
    {
      "automations": [],
      "conditions": [],
      "enabled": true,
      "export_key": "Search Splunk ES for an artifact",
      "id": 41,
      "logic_type": "all",
      "message_destinations": [],
      "name": "Search Splunk ES for an artifact",
      "object_type": "artifact",
      "tags": [],
      "timeout_seconds": 86400,
      "type": 1,
      "uuid": "f568e487-24b6-4799-b89c-a042f3012284",
      "view_items": [
        {
          "content": "19536b13-46af-4a43-b573-f7af49d0c307",
          "element": "field_uuid",
          "field_type": "actioninvocation",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        "search_splunk_ip_intel"
      ]
    },
    {
      "automations": [],
      "conditions": [],
      "enabled": true,
      "export_key": "Update Splunk ES notable event",
      "id": 42,
      "logic_type": "all",
      "message_destinations": [],
      "name": "Update Splunk ES notable event",
      "object_type": "incident",
      "tags": [],
      "timeout_seconds": 86400,
      "type": 1,
      "uuid": "fc9fe54f-c935-4602-94b9-b1224e559092",
      "view_items": [
        {
          "content": "19536b13-46af-4a43-b573-f7af49d0c307",
          "element": "field_uuid",
          "field_type": "actioninvocation",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        "splunk_update_notable"
      ]
    }
  ],
  "apps": [],
  "automatic_tasks": [],
  "export_date": 1639063557242,
  "export_format_version": 2,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param2",
      "hide_notification": false,
      "id": 287,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param2",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param2",
      "tooltip": "",
      "type_id": 11,
      "uuid": "85ecf916-d844-4b3c-a89f-5273bf3835a3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param10",
      "hide_notification": false,
      "id": 275,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param10",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param10",
      "tooltip": "",
      "type_id": 11,
      "uuid": "c51b4789-9132-4f0f-b5a6-b882b98277de",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/event_id",
      "hide_notification": false,
      "id": 274,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "event_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "event_id",
      "tooltip": "notable event id from splunk ES",
      "type_id": 11,
      "uuid": "d3c6002c-826a-41ce-9cca-67e94cda8fc0",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param7",
      "hide_notification": false,
      "id": 285,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param7",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param7",
      "tooltip": "",
      "type_id": 11,
      "uuid": "de435906-91b7-4b74-80ec-3de099cacdd6",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param6",
      "hide_notification": false,
      "id": 280,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param6",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param6",
      "tooltip": "",
      "type_id": 11,
      "uuid": "e584a13e-0bb5-4996-8a53-1f74f9a8ca0e",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param8",
      "hide_notification": false,
      "id": 289,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param8",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param8",
      "tooltip": "",
      "type_id": 11,
      "uuid": "ebf0aa1d-8286-4465-91fb-2a4a4943f22d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param1",
      "hide_notification": false,
      "id": 282,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param1",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param1",
      "tooltip": "",
      "type_id": 11,
      "uuid": "ed2ef56f-a3f2-46c8-bff3-6c28a5e708e8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_max_return",
      "hide_notification": false,
      "id": 281,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_max_return",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_max_return",
      "tooltip": "max number of events to return (used in head max)",
      "type_id": 11,
      "uuid": "f4243c42-ed46-4b74-b28e-7b99c021ec7b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_threat_intel_type",
      "hide_notification": false,
      "id": 279,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_threat_intel_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_threat_intel_type",
      "tooltip": "",
      "type_id": 11,
      "uuid": "00c3475d-4026-4301-b73c-dc29fc7869b8",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_label",
      "hide_notification": false,
      "id": 346,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_label",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_label",
      "tooltip": "label given to each splunk server in the app.config",
      "type_id": 11,
      "uuid": "0b4e2cdc-cfeb-488e-9826-0752db6cc152",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param5",
      "hide_notification": false,
      "id": 290,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param5",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param5",
      "tooltip": "",
      "type_id": 11,
      "uuid": "13d39604-e948-43b9-95b2-5d39529e7145",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_threat_intel_key",
      "hide_notification": false,
      "id": 288,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_threat_intel_key",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_threat_intel_key",
      "tooltip": "The _key from Splunk ES for this threat_intel item",
      "type_id": 11,
      "uuid": "174ae898-a813-4379-b322-ba20e850a400",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param3",
      "hide_notification": false,
      "id": 276,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param3",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param3",
      "tooltip": "",
      "type_id": 11,
      "uuid": "4af32ba8-92cb-4bd7-a5b2-9e48c2618863",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param4",
      "hide_notification": false,
      "id": 278,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param4",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param4",
      "tooltip": "",
      "type_id": 11,
      "uuid": "5c8543bc-a513-4a47-90c6-1af4215b5e1f",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/notable_event_status",
      "hide_notification": false,
      "id": 286,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "notable_event_status",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "notable_event_status",
      "tooltip": "",
      "type_id": 11,
      "uuid": "5dcd2998-9222-44cf-b047-418d672fbf0c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query_param9",
      "hide_notification": false,
      "id": 283,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query_param9",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "splunk_query_param9",
      "tooltip": "",
      "type_id": 11,
      "uuid": "7341377c-62c3-4565-aa76-b33bc8a5bcb4",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/comment",
      "hide_notification": false,
      "id": 284,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "comment",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "comment",
      "tooltip": "Update the notable comment using this",
      "type_id": 11,
      "uuid": "747afc0e-82a0-4def-acab-edd06f61f81e",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/splunk_query",
      "hide_notification": false,
      "id": 277,
      "input_type": "textarea",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_query",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [
        {
          "id": 4,
          "name": "search threat_intel for type",
          "template": {
            "content": "inputlookup %param1% | search NOT disabled=* AND %param2%=%param3% | eval item_key=_key",
            "format": "text"
          },
          "uuid": "e1e32c46-2964-4a7f-8652-caea8ac1ad53"
        },
        {
          "id": 5,
          "name": "search index and source for type",
          "template": {
            "content": "search index = %param1% source=%param2% AND %param3%=%param4%",
            "format": "text"
          },
          "uuid": "4ce8e66d-08b8-486c-8479-7ecc7886729e"
        },
        {
          "id": 6,
          "name": "search index for type",
          "template": {
            "content": "search index = %param1% AND %param2% = %param3%",
            "format": "text"
          },
          "uuid": "a55cf594-4753-4e75-8696-a1e8d665032a"
        }
      ],
      "text": "splunk_query",
      "tooltip": "",
      "type_id": 11,
      "uuid": "7b229c20-5508-4449-af5e-e6d6d7bc9e39",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "actioninvocation/splunk_servers",
      "hide_notification": false,
      "id": 349,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "splunk_servers",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "Splunk Servers",
      "tooltip": "List of splunk servers from app.config",
      "type_id": 6,
      "uuid": "19536b13-46af-4a43-b573-f7af49d0c307",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "apps": [],
      "created_date": 1638204671281,
      "creator": {
        "display_name": "admin",
        "id": 6,
        "name": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
        "type": "apikey"
      },
      "description": {
        "content": "Add a new Splunk ES threat intelligence item to a given collection. splunk_threat_intel_type is one of the 9 collections, including ip_intel, file_intel.... splunk_query_param1 to splunk_query_param10 are used to build a dict {splunk_query_param1:splunk_query_parame2, splunk_query_param3:splunk_query_param4....} This dict is used to create the new threat intel item.",
        "format": "text"
      },
      "destination_handle": "splunk_es_rest",
      "display_name": "Splunk Add Intel Item",
      "export_key": "splunk_add_intel_item",
      "id": 11,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1638214785798,
      "name": "splunk_add_intel_item",
      "tags": [],
      "uuid": "3118f626-d719-40c5-a862-a76b93e585e6",
      "version": 2,
      "view_items": [
        {
          "content": "00c3475d-4026-4301-b73c-dc29fc7869b8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ed2ef56f-a3f2-46c8-bff3-6c28a5e708e8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "85ecf916-d844-4b3c-a89f-5273bf3835a3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4af32ba8-92cb-4bd7-a5b2-9e48c2618863",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "5c8543bc-a513-4a47-90c6-1af4215b5e1f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "13d39604-e948-43b9-95b2-5d39529e7145",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "e584a13e-0bb5-4996-8a53-1f74f9a8ca0e",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "de435906-91b7-4b74-80ec-3de099cacdd6",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ebf0aa1d-8286-4465-91fb-2a4a4943f22d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "7341377c-62c3-4565-aa76-b33bc8a5bcb4",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c51b4789-9132-4f0f-b5a6-b882b98277de",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0b4e2cdc-cfeb-488e-9826-0752db6cc152",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example of adding artifact to Splunk ES",
          "object_type": "artifact",
          "programmatic_name": "splunk_add_new_ip_intel",
          "tags": [],
          "uuid": null,
          "workflow_id": 27
        }
      ]
    },
    {
      "apps": [],
      "created_date": 1638204671373,
      "creator": {
        "display_name": "admin",
        "id": 6,
        "name": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
        "type": "apikey"
      },
      "description": {
        "content": "Delete a threat intelligence item from a given collection. splunk_threat_intel_type is one of 9 collections, including ip_intel, file_intel... splunk_threat_intel_key is the _key of the item to be deleted.",
        "format": "text"
      },
      "destination_handle": "splunk_es_rest",
      "display_name": "Splunk Delete Threat Intel Item",
      "export_key": "splunk_delete_threat_intel_item",
      "id": 12,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1638214792167,
      "name": "splunk_delete_threat_intel_item",
      "tags": [],
      "uuid": "f66d22ca-b1f0-49c9-b328-22628bbc10c4",
      "version": 2,
      "view_items": [
        {
          "content": "00c3475d-4026-4301-b73c-dc29fc7869b8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "174ae898-a813-4379-b322-ba20e850a400",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0b4e2cdc-cfeb-488e-9826-0752db6cc152",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example of deleting an intel entry in Splunk ES",
          "object_type": "splunk_intel_results",
          "programmatic_name": "example_of_deleting_an_intel_entry_in_splunk_es",
          "tags": [],
          "uuid": null,
          "workflow_id": 14
        }
      ]
    },
    {
      "apps": [],
      "created_date": 1638204671456,
      "creator": {
        "display_name": "admin",
        "id": 6,
        "name": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
        "type": "apikey"
      },
      "description": {
        "content": "Define a Splunk query string with parameters. Map parameters from inputs, and perform the query. For example, %param1% in the query string will be replaced by the value of splunk_query_param1. The return is a list.",
        "format": "text"
      },
      "destination_handle": "splunk_es_rest",
      "display_name": "Splunk Search",
      "export_key": "splunk_search",
      "id": 13,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1638214798958,
      "name": "splunk_search",
      "tags": [],
      "uuid": "aee7fbff-c72e-4755-ba80-b39b31861354",
      "version": 2,
      "view_items": [
        {
          "content": "7b229c20-5508-4449-af5e-e6d6d7bc9e39",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ed2ef56f-a3f2-46c8-bff3-6c28a5e708e8",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "85ecf916-d844-4b3c-a89f-5273bf3835a3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "4af32ba8-92cb-4bd7-a5b2-9e48c2618863",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "5c8543bc-a513-4a47-90c6-1af4215b5e1f",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "13d39604-e948-43b9-95b2-5d39529e7145",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f4243c42-ed46-4b74-b28e-7b99c021ec7b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0b4e2cdc-cfeb-488e-9826-0752db6cc152",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example of searching an artifact in Splunk ES",
          "object_type": "artifact",
          "programmatic_name": "search_splunk_ip_intel",
          "tags": [],
          "uuid": null,
          "workflow_id": 29
        }
      ]
    },
    {
      "apps": [],
      "created_date": 1638204671542,
      "creator": {
        "display_name": "admin",
        "id": 6,
        "name": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
        "type": "apikey"
      },
      "description": {
        "content": "Update notable events according to the status of the corresponding incident. Parameters: \n1. event_id: The event_id of the notable event; \n2. notable_event_status: Change new status for the notable event; \n3. comment: comment to be added to the notable event.",
        "format": "text"
      },
      "destination_handle": "splunk_es_rest",
      "display_name": "Splunk Update Notable Event",
      "export_key": "splunk_update_notable",
      "id": 14,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1638214807956,
      "name": "splunk_update_notable",
      "tags": [],
      "uuid": "3e39198f-c337-42be-8420-9502d573e413",
      "version": 2,
      "view_items": [
        {
          "content": "d3c6002c-826a-41ce-9cca-67e94cda8fc0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "5dcd2998-9222-44cf-b047-418d672fbf0c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "747afc0e-82a0-4def-acab-edd06f61f81e",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "0b4e2cdc-cfeb-488e-9826-0752db6cc152",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example of updating Splunk ES notable event",
          "object_type": "incident",
          "programmatic_name": "splunk_update_notable",
          "tags": [],
          "uuid": null,
          "workflow_id": 28
        }
      ]
    }
  ],
  "geos": null,
  "groups": null,
  "id": 4,
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1639063556113,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1639063556113,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "industries": null,
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "c5327bfa-d87a-4a69-8e6b-a20b58d95946"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "splunk_es_rest",
      "name": "splunk_es_rest",
      "programmatic_name": "splunk_es_rest",
      "tags": [],
      "users": [],
      "uuid": "2a6a71e5-9807-482b-8eef-2d964ce47b03"
    }
  ],
  "notifications": null,
  "overrides": [],
  "phases": [],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 6554,
    "major": 40,
    "minor": 0,
    "version": "40.0.6554"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "Splunk Intel Results",
      "export_key": "splunk_intel_results",
      "fields": {
        "create_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/create_date",
          "hide_notification": false,
          "id": 267,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "create_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Create Date",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "044cd37c-fa95-4467-acbc-ac0a234070ee",
          "values": [],
          "width": 142
        },
        "intel_collection": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/intel_collection",
          "hide_notification": false,
          "id": 268,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "intel_collection",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Intel Collection",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "a1f56334-033e-412c-8a86-3c75963cac64",
          "values": [],
          "width": 91
        },
        "intel_field": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/intel_field",
          "hide_notification": false,
          "id": 269,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "intel_field",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Intel Field",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "f03aea26-c6c0-439a-b8c0-00ccf3697a1f",
          "values": [],
          "width": 74
        },
        "intel_key": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/intel_key",
          "hide_notification": false,
          "id": 270,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "intel_key",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Intel Key",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "233afdf9-b92a-4d22-a881-310ab5d4bd85",
          "values": [],
          "width": 73
        },
        "intel_value": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/intel_value",
          "hide_notification": false,
          "id": 271,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "intel_value",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Intel Value",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "8bbc4c5b-17be-4d17-9005-31ce116759a8",
          "values": [],
          "width": 74
        },
        "source": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/source",
          "hide_notification": false,
          "id": 272,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "source",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Source",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "e1bb5fdc-8a46-4edb-aac3-e59876b0c896",
          "values": [],
          "width": 74
        },
        "splunk_server": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/splunk_server",
          "hide_notification": false,
          "id": 347,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "splunk_server",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Splunk Server",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "5b771e5b-d04b-4091-bb7f-fe6521d00eb9",
          "values": [],
          "width": 53
        },
        "status": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "splunk_intel_results/status",
          "hide_notification": false,
          "id": 273,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "status",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Status",
          "tooltip": "",
          "type_id": 1004,
          "uuid": "aeb2c921-ebac-42ee-b89e-30bf0fc1708d",
          "values": [],
          "width": 74
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "splunk_intel_results",
      "uuid": "fee7d158-85ae-44ad-a5ba-099e01a16203"
    }
  ],
  "workflows": [
    {
      "actions": [],
      "content": {
        "version": 1,
        "workflow_id": "splunk_update_notable",
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"splunk_update_notable\" isExecutable=\"true\" name=\"Example of updating Splunk ES notable event\"\u003e\u003cdocumentation\u003e\u003c![CDATA[This is an example workflow calling the \"Splunk Update Notable Event\" function to update a given notable event. The event_status is mapped to the plan_status of the incident, and the comment is set in the Pre-Process Script tab accordingly.]]\u003e\u003c/documentation\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eSequenceFlow_0irbxe6\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_152mu1x\" name=\"Splunk Update Notable Event\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3e39198f-c337-42be-8420-9502d573e413\"\u003e{\"inputs\":{\"747afc0e-82a0-4def-acab-edd06f61f81e\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"Updating information from SOAR\"}}},\"post_processing_script\":\"# {\u0027status_code\u0027: 200, \u0027content\u0027: {\u0027details\u0027: {}, \u0027success_count\u0027: 1, \u0027failure_count\u0027: 0, \u0027warnings\u0027: [], \u0027success\u0027: True, \u0027message\u0027: \u00271 event updated successfully\u0027}}\\n\\nresult_note = u\\\"\u0026lt;b\u0026gt;Splunk Update notable event\u0026lt;/b\u0026gt;:\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\\\"\\nif isinstance(results.get(\\\"content\\\"), dict):\\n  result_note = result_note + u\\\"\\\"\\\"\u0026lt;b\u0026gt;Splunk Update Status\u0026lt;/b\u0026gt;: {}\u0026lt;br\u0026gt;\\n\u0026lt;b\u0026gt;Message\u0026lt;/b\u0026gt;: {}\\\"\\\"\\\".format(\\\"Successful\\\" if results.get(\\\"content\\\", {}).get(\\\"success\\\", False) else \\\"Unsuccessful\\\",\\n                             results.get(\\\"content\\\", {}).get(\\\"message\\\", \\\"None\\\"))\\nelse:\\n  result_note = result_note + results.get(\\\"content\\\")\\n\\nincident.addNote(helper.createRichText(result_note))\",\"post_processing_script_language\":\"python\",\"pre_processing_script\":\"if incident.properties.splunk_notable_event_id:\\n  inputs.event_id = incident.properties.splunk_notable_event_id\\n  if incident.plan_status == \\\"C\\\":\\n      inputs.notable_event_status = 5\\n      inputs.comment = \\\"SOAR incident is closed\\\"\\n  else:\\n      inputs.notable_event_status = 2\\n      inputs.comment = \\\"SOAR incident is active\\\"\\n  inputs.splunk_label = rule.properties.splunk_servers\\nelse:\\n  helper.fail(\\\"Ensure that the incident custom field is set: splunk_notable_event_id\\\")\",\"pre_processing_script_language\":\"python\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eSequenceFlow_0irbxe6\u003c/incoming\u003e\u003coutgoing\u003eSequenceFlow_0yhrhv0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"SequenceFlow_0irbxe6\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_152mu1x\"/\u003e\u003cendEvent id=\"EndEvent_0ceci5l\"\u003e\u003cincoming\u003eSequenceFlow_0yhrhv0\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"SequenceFlow_0yhrhv0\" sourceRef=\"ServiceTask_152mu1x\" targetRef=\"EndEvent_0ceci5l\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_1kxxiyt\"\u003e\u003ctext\u003eStart your workflow here\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_0ean0am\"\u003e\u003ctext\u003e\u003c![CDATA[An incident created from a Splunk ES notable event shall carry a splunk_notable_event_id. This example workflow uses that event_id to update the corresponding notable event.\n]]\u003e\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_0vurcta\" sourceRef=\"ServiceTask_152mu1x\" targetRef=\"TextAnnotation_0ean0am\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"326\" y=\"142\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"321\" y=\"177\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"\u003e\u003comgdc:Bounds height=\"30\" width=\"100\" x=\"223\" y=\"226\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"\u003e\u003comgdi:waypoint x=\"332\" xsi:type=\"omgdc:Point\" y=\"172\"/\u003e\u003comgdi:waypoint x=\"284\" xsi:type=\"omgdc:Point\" y=\"226\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_152mu1x\" id=\"ServiceTask_152mu1x_di\"\u003e\u003comgdc:Bounds height=\"80\" width=\"100\" x=\"449\" y=\"120\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0irbxe6\" id=\"SequenceFlow_0irbxe6_di\"\u003e\u003comgdi:waypoint x=\"362\" xsi:type=\"omgdc:Point\" y=\"160\"/\u003e\u003comgdi:waypoint x=\"449\" xsi:type=\"omgdc:Point\" y=\"160\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"0\" x=\"405.5\" y=\"138\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndEvent_0ceci5l\" id=\"EndEvent_0ceci5l_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"622\" y=\"142\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"595\" y=\"181\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0yhrhv0\" id=\"SequenceFlow_0yhrhv0_di\"\u003e\u003comgdi:waypoint x=\"549\" xsi:type=\"omgdc:Point\" y=\"160\"/\u003e\u003comgdi:waypoint x=\"622\" xsi:type=\"omgdc:Point\" y=\"160\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"540.5\" y=\"138.5\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_0ean0am\" id=\"TextAnnotation_0ean0am_di\"\u003e\u003comgdc:Bounds height=\"63\" width=\"329\" x=\"517\" y=\"23\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_0vurcta\" id=\"Association_0vurcta_di\"\u003e\u003comgdi:waypoint x=\"549\" xsi:type=\"omgdc:Point\" y=\"130\"/\u003e\u003comgdi:waypoint x=\"628\" xsi:type=\"omgdc:Point\" y=\"86\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "content_version": 1,
      "creator_id": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
      "description": "This is an example workflow calling the \"Splunk Update Notable Event\" function to update a given notable event. The event_status is mapped to the plan_status of the incident, and the comment is set in the Pre-Process Script tab accordingly.",
      "export_key": "splunk_update_notable",
      "last_modified_by": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
      "last_modified_time": 1639063145129,
      "name": "Example of updating Splunk ES notable event",
      "object_type": "incident",
      "programmatic_name": "splunk_update_notable",
      "tags": [],
      "uuid": "1be3f306-2418-4aa9-87db-6c5712c574f8",
      "workflow_id": 28
    },
    {
      "actions": [],
      "content": {
        "version": 5,
        "workflow_id": "example_of_deleting_an_intel_entry_in_splunk_es",
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"example_of_deleting_an_intel_entry_in_splunk_es\" isExecutable=\"true\" name=\"Example of deleting an intel entry in Splunk ES\"\u003e\u003cdocumentation\u003e\u003c![CDATA[This is an example workflow using the \"Splunk Delete Threat Intel Item\" function to delete an intel item from a Splunk collection.]]\u003e\u003c/documentation\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eSequenceFlow_1fsyszc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1j8papp\" name=\"Splunk Delete Threat Intel Item\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"f66d22ca-b1f0-49c9-b328-22628bbc10c4\"\u003e{\"inputs\":{},\"post_processing_script\":\"# {\u0027status_code\u0027: 201, \u0027content\u0027: {\u0027message\u0027: \u0027Delete operation successful.\u0027, \u0027status\u0027: True}}\\n\\nresult_note = u\\\"\\\"\\\"\u0026lt;b\u0026gt;Artifact\u0026lt;/b\u0026gt;: {}\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\\n\u0026lt;b\u0026gt;Splunk Delete Status\u0026lt;/b\u0026gt;: {}\u0026lt;br\u0026gt;\\n\u0026lt;b\u0026gt;Message\u0026lt;/b\u0026gt;: {}\\\"\\\"\\\".format(row.intel_value, \\n                             \\\"Successful\\\" if results.get(\\\"content\\\", {}).get(\\\"status\\\", False) else \\\"Unsuccessful\\\",\\n                             results.get(\\\"content\\\", {}).get(\\\"message\\\", \\\"None\\\"))\\n\\nincident.addNote(helper.createRichText(result_note))\\nrow.status = \\\"Deleted\\\"\",\"post_processing_script_language\":\"python\",\"pre_processing_script\":\"inputs.splunk_threat_intel_type = row.intel_collection\\ninputs.splunk_threat_intel_key = row.intel_key\\ninputs.splunk_label = row.splunk_server\",\"pre_processing_script_language\":\"python\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eSequenceFlow_1fsyszc\u003c/incoming\u003e\u003coutgoing\u003eSequenceFlow_1cdxs98\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"SequenceFlow_1fsyszc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1j8papp\"/\u003e\u003cendEvent id=\"EndEvent_00odjzi\"\u003e\u003cincoming\u003eSequenceFlow_1cdxs98\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"SequenceFlow_1cdxs98\" sourceRef=\"ServiceTask_1j8papp\" targetRef=\"EndEvent_00odjzi\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_1kxxiyt\"\u003e\u003ctext\u003eStart your workflow here\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_04vpsmi\"\u003e\u003ctext\u003e\u003c![CDATA[Results returned in a note\n]]\u003e\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_1xifsxc\" sourceRef=\"ServiceTask_1j8papp\" targetRef=\"TextAnnotation_04vpsmi\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_0gavnpw\"\u003e\u003ctext\u003e\u003c![CDATA[Delete an intel entry based on it\u0027s internal key\n]]\u003e\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_17motrf\" sourceRef=\"ServiceTask_1j8papp\" targetRef=\"TextAnnotation_0gavnpw\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"\u003e\u003comgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"\u003e\u003comgdi:waypoint x=\"169\" xsi:type=\"omgdc:Point\" y=\"220\"/\u003e\u003comgdi:waypoint x=\"153\" xsi:type=\"omgdc:Point\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1j8papp\" id=\"ServiceTask_1j8papp_di\"\u003e\u003comgdc:Bounds height=\"80\" width=\"100\" x=\"267\" y=\"166\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1fsyszc\" id=\"SequenceFlow_1fsyszc_di\"\u003e\u003comgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003comgdi:waypoint x=\"267\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"0\" x=\"232.5\" y=\"184\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndEvent_00odjzi\" id=\"EndEvent_00odjzi_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"430.97435897435895\" y=\"188\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"0\" x=\"448.97435897435895\" y=\"227\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1cdxs98\" id=\"SequenceFlow_1cdxs98_di\"\u003e\u003comgdi:waypoint x=\"367\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003comgdi:waypoint x=\"431\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"14\" width=\"0\" x=\"399\" y=\"184\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_04vpsmi\" id=\"TextAnnotation_04vpsmi_di\"\u003e\u003comgdc:Bounds height=\"30\" width=\"100\" x=\"371.97435897435895\" y=\"75.92307692307692\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_1xifsxc\" id=\"Association_1xifsxc_di\"\u003e\u003comgdi:waypoint x=\"354\" xsi:type=\"omgdc:Point\" y=\"166\"/\u003e\u003comgdi:waypoint x=\"408\" xsi:type=\"omgdc:Point\" y=\"106\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_0gavnpw\" id=\"TextAnnotation_0gavnpw_di\"\u003e\u003comgdc:Bounds height=\"39\" width=\"158\" x=\"159\" y=\"71\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_17motrf\" id=\"Association_17motrf_di\"\u003e\u003comgdi:waypoint x=\"290\" xsi:type=\"omgdc:Point\" y=\"166\"/\u003e\u003comgdi:waypoint x=\"251\" xsi:type=\"omgdc:Point\" y=\"110\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "content_version": 5,
      "creator_id": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
      "description": "This is an example workflow using the \"Splunk Delete Threat Intel Item\" function to delete an intel item from a Splunk collection.",
      "export_key": "example_of_deleting_an_intel_entry_in_splunk_es",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1638558416186,
      "name": "Example of deleting an intel entry in Splunk ES",
      "object_type": "splunk_intel_results",
      "programmatic_name": "example_of_deleting_an_intel_entry_in_splunk_es",
      "tags": [],
      "uuid": "c9e465ff-c829-4c0f-9231-0cf94465097f",
      "workflow_id": 14
    },
    {
      "actions": [],
      "content": {
        "version": 2,
        "workflow_id": "search_splunk_ip_intel",
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"search_splunk_ip_intel\" isExecutable=\"true\" name=\"Example of searching an artifact in Splunk ES\"\u003e\u003cdocumentation\u003e\u003c![CDATA[This is an example workflow of using the \"Splunk Search\" function to search a Splunk collection based on the artifact type. The results are returned in the Splunk Results datatable.]]\u003e\u003c/documentation\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eSequenceFlow_0okqtx9\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1u54fw7\" name=\"Splunk Search\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"aee7fbff-c72e-4755-ba80-b39b31861354\"\u003e{\"inputs\":{\"7b229c20-5508-4449-af5e-e6d6d7bc9e39\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_content_value\":{\"format\":\"text\",\"content\":\"inputlookup %param1% | search NOT disabled=* AND %param2%=%param3% | eval item_key=_key\"}}},\"f4243c42-ed46-4b74-b28e-7b99c021ec7b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"number_value\":10}}},\"post_processing_script\":\"# {\u0027events\u0027: [OrderedDict([(\u0027_key\u0027, \u00274fa89feac1004d7cbfcb974eb79c62e9\u0027), (\u0027ip\u0027, \u0027https://ibm.biz/resilientcommunity\u0027), (\u0027item_key\u0027, \u00274fa89feac1004d7cbfcb974eb79c62e9\u0027), (\u0027threat_key\u0027, \u0027restapi\u0027), (\u0027time\u0027, \u00271598296740.6724114\u0027)]), OrderedDict([(\u0027_key\u0027, \u00279b14932c75aa4b1f909775bd10cb78d6\u0027), (\u0027ip\u0027, \u0027https://ibm.biz/resilientcommunity\u0027), (\u0027item_key\u0027, \u00279b14932c75aa4b1f909775bd10cb78d6\u0027), (\u0027threat_key\u0027, \u0027restapi\u0027), (\u0027time\u0027, \u00271598296660.9374135\u0027)])]}\\n\\nif results.get(\\\"content\\\", None):\\n  for event in results.content:\\n    result_row = incident.addRow(\\\"splunk_intel_results\\\")\\n    result_row.create_date = int(float(event.pop(\\\"time\\\"))*1000)\\n    result_row.source = event.pop(\\\"threat_key\\\")\\n    result_row.intel_collection = results.inputs[\u0027splunk_query_param1\u0027]\\n    result_row.intel_key = event.pop(\\\"_key\\\")\\n    result_row.splunk_server = rule.properties.splunk_servers\\n    result_row.status = \\\"Active\\\"\\n    event.pop(\\\"item_key\\\") # not presented\\n    # what\u0027s left is the artifact value\\n    for k, v in event.items():\\n      result_row.intel_field = k\\n      result_row.intel_value = v\\n      break\\nelse:\\n  result_row = incident.addRow(\\\"splunk_intel_results\\\")\\n  result_row.intel_value = artifact.value\\n  result_row.status = \\\"Not Found\\\"\\n  result_row.splunk_server = rule.properties.splunk_servers\\n  \\n\",\"post_processing_script_language\":\"python\",\"pre_processing_script\":\"lookup_map = {\\n  \\\"DNS Name\\\": (\\\"ip_intel\\\", \\\"domain\\\"),\\n  \\\"Email Attachment\\\": None,\\n  \\\"Email Attachment Name\\\": (\\\"file_intel\\\", \\\"file_name\\\"),\\n  \\\"Email Body\\\": None,\\n  \\\"Email Recipient\\\": None,\\n  \\\"Email Sender\\\": (\\\"email_intel\\\", \\\"src_user\\\"),\\n  \\\"Email Sender Name\\\": (\\\"email_intel\\\", \\\"src_user\\\"),\\n  \\\"Email Subject\\\": (\\\"email_intel\\\", \\\"subject\\\"),\\n  \\\"File Name\\\": (\\\"file_intel\\\", \\\"file_name\\\"),\\n  \\\"File Path\\\": None,\\n  \\\"HTTP Request Header\\\": None,\\n  \\\"HTTP Response Header\\\": None,\\n  \\\"IP Address\\\": (\\\"ip_intel\\\", \\\"ip\\\"),\\n  \\\"Log File\\\": None,\\n  \\\"MAC Address\\\": None,\\n  \\\"Malware Family/Variant\\\": None,\\n  \\\"Malware MD5 Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Malware Sample\\\": None,\\n  \\\"Malware Sample Fuzzy Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Malware SHA-1 Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Malware SHA-256 Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Mutex\\\": None,\\n  \\\"Network CIDR Range\\\": None,\\n  \\\"Other File\\\": None,\\n  \\\"Password\\\": None,\\n  \\\"Port\\\": None,\\n  \\\"Process Name\\\": (\\\"process_intel\\\", \\\"process\\\"),\\n  \\\"Registry Key\\\": (\\\"registry_intel\\\", \\\"registry_value_name\\\"),\\n  \\\"RFC 822 Email Message File\\\": None,\\n  \\\"Service\\\": (\\\"service_intel\\\", \\\"service\\\"),\\n  \\\"String\\\": None,\\n  \\\"System Name\\\": (\\\"service_intel\\\", \\\"service\\\"),\\n  \\\"URI Path\\\": None,\\n  \\\"URL\\\": (\\\"http_intel\\\", \\\"url\\\"),\\n  \\\"URL Referer\\\": (\\\"http_intel\\\", \\\"http_referrer\\\"),\\n  \\\"User Account\\\": None,\\n  \\\"User Agent\\\": (\\\"http_intel\\\", \\\"http_user_agent\\\")\\n}\\n\\nif artifact.type in lookup_map and lookup_map.get(artifact.type):\\n  threat_type, threat_field_name = lookup_map.get(artifact.type)\\n  inputs.splunk_query_param1 = threat_type\\n  inputs.splunk_query_param2 = threat_field_name\\n  inputs.splunk_query_param3 = artifact.value\\n  inputs.splunk_label = rule.properties.splunk_servers\\nelse:\\n  helper.fail(\\\"Artifact type not supported: {}\\\".format(artifact.type))\",\"pre_processing_script_language\":\"python\",\"result_name\":\"\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eSequenceFlow_0okqtx9\u003c/incoming\u003e\u003coutgoing\u003eSequenceFlow_0va1j4a\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"SequenceFlow_0okqtx9\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1u54fw7\"/\u003e\u003cendEvent id=\"EndEvent_1pka5io\"\u003e\u003cincoming\u003eSequenceFlow_0va1j4a\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"SequenceFlow_0va1j4a\" sourceRef=\"ServiceTask_1u54fw7\" targetRef=\"EndEvent_1pka5io\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_1kxxiyt\"\u003e\u003ctext\u003eStart your workflow here\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_0g4jym4\"\u003e\u003ctext\u003e\u003c![CDATA[Results returned in Splunk Search Results datatable\n]]\u003e\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_0o0baxl\" sourceRef=\"ServiceTask_1u54fw7\" targetRef=\"TextAnnotation_0g4jym4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"289\" y=\"194\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"284\" y=\"229\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"\u003e\u003comgdc:Bounds height=\"30\" width=\"100\" x=\"197\" y=\"259\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"\u003e\u003comgdi:waypoint x=\"294\" xsi:type=\"omgdc:Point\" y=\"224\"/\u003e\u003comgdi:waypoint x=\"261\" xsi:type=\"omgdc:Point\" y=\"259\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1u54fw7\" id=\"ServiceTask_1u54fw7_di\"\u003e\u003comgdc:Bounds height=\"80\" width=\"100\" x=\"404\" y=\"172\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0okqtx9\" id=\"SequenceFlow_0okqtx9_di\"\u003e\u003comgdi:waypoint x=\"325\" xsi:type=\"omgdc:Point\" y=\"212\"/\u003e\u003comgdi:waypoint x=\"404\" xsi:type=\"omgdc:Point\" y=\"212\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"0\" x=\"364.5\" y=\"190\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndEvent_1pka5io\" id=\"EndEvent_1pka5io_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"574\" y=\"194\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"547\" y=\"233\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0va1j4a\" id=\"SequenceFlow_0va1j4a_di\"\u003e\u003comgdi:waypoint x=\"504\" xsi:type=\"omgdc:Point\" y=\"212\"/\u003e\u003comgdi:waypoint x=\"539\" xsi:type=\"omgdc:Point\" y=\"212\"/\u003e\u003comgdi:waypoint x=\"539\" xsi:type=\"omgdc:Point\" y=\"212\"/\u003e\u003comgdi:waypoint x=\"574\" xsi:type=\"omgdc:Point\" y=\"212\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"509\" y=\"205.5\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_0g4jym4\" id=\"TextAnnotation_0g4jym4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"189\" x=\"481\" y=\"69\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_0o0baxl\" id=\"Association_0o0baxl_di\"\u003e\u003comgdi:waypoint x=\"495\" xsi:type=\"omgdc:Point\" y=\"173\"/\u003e\u003comgdi:waypoint x=\"549\" xsi:type=\"omgdc:Point\" y=\"121\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "content_version": 2,
      "creator_id": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
      "description": "This is an example workflow of using the \"Splunk Search\" function to search a Splunk collection based on the artifact type. The results are returned in the Splunk Results datatable.",
      "export_key": "search_splunk_ip_intel",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1639063304402,
      "name": "Example of searching an artifact in Splunk ES",
      "object_type": "artifact",
      "programmatic_name": "search_splunk_ip_intel",
      "tags": [],
      "uuid": "c7df8026-0e4e-4f22-91b8-e50fd68464c8",
      "workflow_id": 29
    },
    {
      "actions": [],
      "content": {
        "version": 1,
        "workflow_id": "splunk_add_new_ip_intel",
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"splunk_add_new_ip_intel\" isExecutable=\"true\" name=\"Example of adding artifact to Splunk ES\"\u003e\u003cdocumentation\u003e\u003c![CDATA[This is an example workflow calling the \"Splunk Add Intel Item\" function to add a new collection item. The type is set determined by the artifact type.  Results are returned in a note and the Splunk Results datatable.]]\u003e\u003c/documentation\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eSequenceFlow_14001kj\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1aax9p0\" name=\"Splunk Add Intel Item\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"3118f626-d719-40c5-a862-a76b93e585e6\"\u003e{\"inputs\":{},\"post_processing_script\":\"# {\u0027status_code\u0027: 201, \u0027content\u0027: {\u0027message\u0027: \u0027Create operation successful.\u0027, \u0027status\u0027: True}}\\nimport java.util.Date as Date \\n\\nnow = Date().time\\n\\nresult_note = u\\\"\\\"\\\"\u0026lt;b\u0026gt;Artifact\u0026lt;/b\u0026gt;: {}\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\\n\u0026lt;b\u0026gt;Splunk Add Status\u0026lt;/b\u0026gt;: {}\u0026lt;br\u0026gt;\\n\u0026lt;b\u0026gt;Message\u0026lt;/b\u0026gt;: {}\\\"\\\"\\\".format(artifact.value, \\n                             \\\"Successful\\\" if results.get(\\\"content\\\", {}).get(\\\"status\\\", False) else \\\"Unsuccessful\\\",\\n                             results.get(\\\"content\\\", {}).get(\\\"message\\\", \\\"None\\\"))\\n\\nif results.get(\\\"content\\\", {}).get(\\\"status\\\", False):\\n  incident.addNote(helper.createRichText(result_note))\\n  result_row = incident.addRow(\\\"splunk_intel_results\\\")\\n  result_row.create_date = now\\n  result_row.status = \\\"Added\\\"\\n  result_row.intel_collection = results.inputs[\u0027splunk_threat_intel_type\u0027]\\n  result_row.intel_field = results.inputs[\u0027splunk_query_param1\u0027]\\n  result_row.intel_value = results.inputs[\u0027splunk_query_param2\u0027]\\n  result_row.splunk_server = rule.properties.splunk_servers\\n\",\"post_processing_script_language\":\"python\",\"pre_processing_script\":\"lookup_map = {\\n  \\\"DNS Name\\\": (\\\"ip_intel\\\", \\\"domain\\\"),\\n  \\\"Email Attachment\\\": None,\\n  \\\"Email Attachment Name\\\": (\\\"file_intel\\\", \\\"file_name\\\"),\\n  \\\"Email Body\\\": None,\\n  \\\"Email Recipient\\\": None,\\n  \\\"Email Sender\\\": (\\\"email_intel\\\", \\\"src_user\\\"),\\n  \\\"Email Sender Name\\\": (\\\"email_intel\\\", \\\"src_user\\\"),\\n  \\\"Email Subject\\\": (\\\"email_intel\\\", \\\"subject\\\"),\\n  \\\"File Name\\\": (\\\"file_intel\\\", \\\"file_name\\\"),\\n  \\\"File Path\\\": None,\\n  \\\"HTTP Request Header\\\": None,\\n  \\\"HTTP Response Header\\\": None,\\n  \\\"IP Address\\\": (\\\"ip_intel\\\", \\\"ip\\\"),\\n  \\\"Log File\\\": None,\\n  \\\"MAC Address\\\": None,\\n  \\\"Malware Family/Variant\\\": None,\\n  \\\"Malware MD5 Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Malware Sample\\\": None,\\n  \\\"Malware Sample Fuzzy Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Malware SHA-1 Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Malware SHA-256 Hash\\\": (\\\"file_intel\\\", \\\"file_hash\\\"),\\n  \\\"Mutex\\\": None,\\n  \\\"Network CIDR Range\\\": None,\\n  \\\"Other File\\\": None,\\n  \\\"Password\\\": None,\\n  \\\"Port\\\": None,\\n  \\\"Process Name\\\": (\\\"process_intel\\\", \\\"process\\\"),\\n  \\\"Registry Key\\\": (\\\"registry_intel\\\", \\\"registry_value_name\\\"),\\n  \\\"RFC 822 Email Message File\\\": None,\\n  \\\"Service\\\": (\\\"service_intel\\\", \\\"service\\\"),\\n  \\\"String\\\": None,\\n  \\\"System Name\\\": (\\\"service_intel\\\", \\\"service\\\"),\\n  \\\"URI Path\\\": None,\\n  \\\"URL\\\": (\\\"http_intel\\\", \\\"url\\\"),\\n  \\\"URL Referer\\\": (\\\"http_intel\\\", \\\"http_referrer\\\"),\\n  \\\"User Account\\\": None,\\n  \\\"User Agent\\\": (\\\"http_intel\\\", \\\"http_user_agent\\\")\\n}\\n\\nif artifact.type in lookup_map and lookup_map[artifact.type]:\\n  threat_type, threat_field_name = lookup_map[artifact.type]\\n  inputs.splunk_threat_intel_type = threat_type\\n  inputs.splunk_query_param1 = threat_field_name\\n  inputs.splunk_query_param2 = artifact.value\\n  inputs.splunk_label = rule.properties.splunk_servers\\nelse:\\n  helper.fail(\\\"Artifact type not supported: {}\\\".format(artifact.type))\\n\",\"pre_processing_script_language\":\"python\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eSequenceFlow_14001kj\u003c/incoming\u003e\u003coutgoing\u003eSequenceFlow_1rp7f1j\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"SequenceFlow_14001kj\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1aax9p0\"/\u003e\u003cendEvent id=\"EndEvent_05bgc5i\"\u003e\u003cincoming\u003eSequenceFlow_1rp7f1j\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"SequenceFlow_1rp7f1j\" sourceRef=\"ServiceTask_1aax9p0\" targetRef=\"EndEvent_05bgc5i\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_1kxxiyt\"\u003e\u003ctext\u003eStart your workflow here\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_0rg86ww\"\u003e\u003ctext\u003e\u003c![CDATA[Results returned in Splunk Results datatable\n]]\u003e\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_0cimwoi\" sourceRef=\"ServiceTask_1aax9p0\" targetRef=\"TextAnnotation_0rg86ww\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"196\" y=\"174\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"191\" y=\"209\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"\u003e\u003comgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"\u003e\u003comgdi:waypoint x=\"201\" xsi:type=\"omgdc:Point\" y=\"203\"/\u003e\u003comgdi:waypoint x=\"158\" xsi:type=\"omgdc:Point\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1aax9p0\" id=\"ServiceTask_1aax9p0_di\"\u003e\u003comgdc:Bounds height=\"80\" width=\"100\" x=\"311\" y=\"152\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_14001kj\" id=\"SequenceFlow_14001kj_di\"\u003e\u003comgdi:waypoint x=\"232\" xsi:type=\"omgdc:Point\" y=\"192\"/\u003e\u003comgdi:waypoint x=\"311\" xsi:type=\"omgdc:Point\" y=\"192\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"226.5\" y=\"170.5\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndEvent_05bgc5i\" id=\"EndEvent_05bgc5i_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"488\" y=\"174\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"461\" y=\"213\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1rp7f1j\" id=\"SequenceFlow_1rp7f1j_di\"\u003e\u003comgdi:waypoint x=\"411\" xsi:type=\"omgdc:Point\" y=\"192\"/\u003e\u003comgdi:waypoint x=\"488\" xsi:type=\"omgdc:Point\" y=\"192\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"90\" x=\"404.5\" y=\"170.5\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_0rg86ww\" id=\"TextAnnotation_0rg86ww_di\"\u003e\u003comgdc:Bounds height=\"44\" width=\"205\" x=\"394\" y=\"66\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_0cimwoi\" id=\"Association_0cimwoi_di\"\u003e\u003comgdi:waypoint x=\"406\" xsi:type=\"omgdc:Point\" y=\"157\"/\u003e\u003comgdi:waypoint x=\"468\" xsi:type=\"omgdc:Point\" y=\"110\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "content_version": 1,
      "creator_id": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
      "description": "This is an example workflow calling the \"Splunk Add Intel Item\" function to add a new collection item. The type is set determined by the artifact type.  Results are returned in a note and the Splunk Results datatable.",
      "export_key": "splunk_add_new_ip_intel",
      "last_modified_by": "c5327bfa-d87a-4a69-8e6b-a20b58d95946",
      "last_modified_time": 1639063144917,
      "name": "Example of adding artifact to Splunk ES",
      "object_type": "artifact",
      "programmatic_name": "splunk_add_new_ip_intel",
      "tags": [],
      "uuid": "851e45ce-9031-45fa-80ec-c91b25a451a8",
      "workflow_id": 27
    }
  ],
  "workspaces": []
}
