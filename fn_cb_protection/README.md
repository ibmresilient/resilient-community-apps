# Resilient Functions for CarbonBlack Protection

This Resilient Function package can be used to interact with Carbon Black CbProtection.
When a CbProtection user sends an approval request to allow execution of a file,
this request can be used to create a Resilient incident.  This integration includes
workflows for the analyst to approve or deny the approval request.

Prerequisites:
```
resilient version 30 or later
resilient_circuits version 30 or later
```

## Environment

This package requires that it is installed on a RHEL platform and that the resilient-circuits application is installed.
Install this package with 'pip', or `python setup.py install`.
To set the config values in the app.config file with a new resilient instance run `resilient-circuits config -c`.
To set the config values in the app.config file with an existing resilient instance run `resilient-circuits config -u`.

Config values example:
```
[fn_cb_protection]

# Name or IP address of your CbProtect server
server=10.200.1.1

# Access token issued by the CbProtect administrator
token=XXXXX-XXXX-XXXXX-XXXX

# If your CbProtect server has a self-signed TLS certificate, you cannot verify it:
# verify=false
```

Run with: `resilient-circuits run`.

## Resilient Functions for CbProtection
```
CbProtect Approval Request Get
CbProtect Approval Request Query
CbProtect Approval Request Update
CbProtect File Catalog Get
CbProtect File Catalog Query
CbProtect File Instance Query
CbProtect File Instance Update
CbProtect File Rule Delete
CbProtect File Rule Get
CbProtect File Rule Query
CbProtect File Rule Update
```
## Rules and workflows have been provided:
```
CbProtection: Get Approval Request
CbProtection: Approve File Globally and Close Request
CbProtection: Approve File Locally and Close Request
CbProtection: Ban File Globally and Close Request
```
You can modify these, or develop your own custom workflows, using the functions provided.


## Technical

This template project was generated by

    resilient-circuits codegen -p fn_cb_protection -m bit9 \
        --workflow cb_protect_approve_file_locally_and_close_request \
                   cb_protect_approve_file_globally_and_close_request \
                   cb_protect_ban_file_globally_and_close_request \
        --rule "CbProtection: Approve File Locally and Close Request" \
               "CbProtection: Approve File Globally and Close Request" \
               "CbProtection: Ban File Globally and Close Request" \
               "CbProtection: Get Approval Request" \
        --field cb_protect_computer \
                cb_protect_computer_id \
                cb_protect_details \
                cb_protect_enforcement_level \
                cb_protect_file_catalog_id \
                cb_protect_file_path \
                cb_protect_filename \
                cb_protect_request_id \
                cb_protect_request_priority \
                cb_protect_request_status \
                cb_protect_triggered_on \
                cb_protect_user

