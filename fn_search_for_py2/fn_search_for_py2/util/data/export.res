{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1746566508272,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/py2_search_tags",
      "hide_notification": false,
      "id": 3461,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "py2_search_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "fn_soar_utils, fn_outbound_email",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "py2_search_tags",
      "tooltip": "comma separated list of apps to search",
      "type_id": 11,
      "uuid": "923e2cd0-ad53-49cb-8a6c-022e0db71c1a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/py2_clear_datatable",
      "hide_notification": false,
      "id": 3687,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "py2_clear_datatable",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "py2_clear_datatable",
      "tooltip": "clear datatable results between function results",
      "type_id": 11,
      "uuid": "c78a08b2-029a-438a-b6f2-9ae0c7e8b632",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/py2_item_type",
      "hide_notification": false,
      "id": 3405,
      "input_type": "select",
      "internal": false,
      "is_tracked": false,
      "name": "py2_item_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "py2_item_type",
      "tooltip": "",
      "type_id": 11,
      "uuid": "181b83c6-d774-465a-ab4e-589e4d6c8bd9",
      "values": [
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "script",
          "properties": null,
          "uuid": "da86a261-08d3-48bd-b793-af2524d283fb",
          "value": 3473
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "playbook",
          "properties": null,
          "uuid": "e6a34726-1552-475c-b34a-885f8ab317a0",
          "value": 3474
        },
        {
          "default": false,
          "enabled": true,
          "hidden": false,
          "label": "workflow",
          "properties": null,
          "uuid": "4a49d329-0f56-4bb7-97b9-47abbe87d12b",
          "value": 3475
        },
        {
          "default": true,
          "enabled": true,
          "hidden": false,
          "label": "all",
          "properties": null,
          "uuid": "c48465d6-e969-4d43-90f4-4086471f4e5d",
          "value": 3753
        }
      ]
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/py2_inc_id",
      "hide_notification": false,
      "id": 3689,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "py2_inc_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "py2_inc_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "529aa15d-ba52-4090-bf98-b8869c8be266",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/py2_item_id",
      "hide_notification": false,
      "id": 3460,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "py2_item_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "py2_item_id",
      "tooltip": "script, workflow or playbook id",
      "type_id": 11,
      "uuid": "6120aa78-46ec-4aa0-8435-7775177dc06b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/py2_item_name",
      "hide_notification": false,
      "id": 3589,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "py2_item_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "py2_item_name",
      "tooltip": "Display name of the script, workflow or playbook",
      "type_id": 11,
      "uuid": "7737a7a6-3ba6-44ce-ad00-db4428f76c9a",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1743710021912,
      "description": {
        "content": "Convert a script, playbook or playbook to use Python 3 scripting engine.",
        "format": "text"
      },
      "destination_handle": "fn_search_for_py2",
      "display_name": "Convert to Python 3",
      "export_key": "convert_to_python_3",
      "id": 336,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "last_modified_time": 1744218841884,
      "name": "convert_to_python_3",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"script\": {\"id\": 5, \"name\": \"email py2\", \"description\": \"\", \"language\": \"python3\", \"object_type\": \"__emailmessage\", \"uuid\": \"*****-31fb-4d9a-a3b3-95c6c9c9f148\", \"actions\": [], \"tags\": [], \"creator_id\": \"sysadmin@example.com\", \"last_modified_by\": \"sysadmin@example.com\", \"last_modified_time\": 1743719293802, \"created_date\": 1743719293802, \"playbook_handle\": null, \"programmatic_name\": \"email_py2\", \"script_text\": \"incident.addNote(emailmessage.sender)\\n\", \"enabled\": false}}, \"raw\": null, \"inputs\": {\"py2_item_id\": 5, \"py2_item_type\": \"script\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-search-for-py2\", \"package_version\": \"1.0.0\", \"host\": \"my.app.host\", \"execution_time_ms\": 798, \"timestamp\": \"2025-04-04 12:25:47\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"script\": {\"type\": \"object\", \"properties\": {\"id\": {\"type\": \"integer\"}, \"name\": {\"type\": \"string\"}, \"description\": {\"type\": \"string\"}, \"language\": {\"type\": \"string\"}, \"object_type\": {\"type\": \"string\"}, \"uuid\": {\"type\": \"string\"}, \"actions\": {\"type\": \"array\"}, \"tags\": {\"type\": \"array\"}, \"creator_id\": {\"type\": \"string\"}, \"last_modified_by\": {\"type\": \"string\"}, \"last_modified_time\": {\"type\": \"integer\"}, \"created_date\": {\"type\": \"integer\"}, \"playbook_handle\": {}, \"programmatic_name\": {\"type\": \"string\"}, \"script_text\": {\"type\": \"string\"}, \"enabled\": {\"type\": \"boolean\"}}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"py2_item_id\": {\"type\": \"integer\"}, \"py2_item_type\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "b51acbd2-48bf-4faf-b433-0409ac69bc7b",
      "version": 1,
      "view_items": [
        {
          "content": "181b83c6-d774-465a-ab4e-589e4d6c8bd9",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "6120aa78-46ec-4aa0-8435-7775177dc06b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "py2 workflow",
          "object_type": "incident",
          "programmatic_name": "py2_workflow",
          "tags": [],
          "uuid": null,
          "workflow_id": 479
        }
      ]
    },
    {
      "created_date": 1743196243613,
      "description": {
        "content": "Search for scripts, workflows and playbooks which are set to using Python 2. Python 2 will be removed from SOAR in an upcoming release.",
        "format": "text"
      },
      "destination_handle": "fn_search_for_py2",
      "display_name": "Search for Python 2",
      "export_key": "fn_search_for_py2",
      "id": 323,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "last_modified_time": 1744307775823,
      "name": "fn_search_for_py2",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2.0, \"success\": true, \"reason\": null, \"content\": {\"script\": {\"5\": {\"name\": \"email py2\", \"display_name\": null, \"tags\": [], \"attributes\": [\"PY2_CONVERTIBLE\", \"PY2_UNICODE\"]}, \"6\": {\"name\": \"py2_script\", \"display_name\": null, \"tags\": [], \"attributes\": [\"PY2_CONVERTIBLE\"]}}, \"workflow\": {\"5\": {\"name\": \"py2 workflow\", \"display_name\": null, \"tags\": [], \"attributes\": [\"PY2_CONVERTIBLE\"]}}, \"playbook\": {\"4\": {\"name\": \"py2_3conditions\", \"display_name\": \"Py2 3Conditions\", \"tags\": [], \"attributes\": [\"PY2_CONVERTIBLE\"]}}}, \"raw\": null, \"inputs\": {\"py2_item_id\": null, \"py2_item_type\": null, \"py2_scripts_only\": null, \"py2_search_tags\": null, \"py2_workflows_only\": null, \"py2_playbooks_only\": null}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-search-for-py2\", \"package_version\": \"1.0.0\", \"host\": \"my.app.host\", \"execution_time_ms\": 3758, \"timestamp\": \"2025-04-04 12:25:17\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"script\": {\"type\": \"object\", \"properties\": {\"5\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}, \"display_name\": {}, \"tags\": {\"type\": \"array\"}, \"attributes\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}, \"6\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}, \"display_name\": {}, \"tags\": {\"type\": \"array\"}, \"attributes\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}}, \"workflow\": {\"type\": \"object\", \"properties\": {\"5\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}, \"display_name\": {}, \"tags\": {\"type\": \"array\"}, \"attributes\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}}, \"playbook\": {\"type\": \"object\", \"properties\": {\"4\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}, \"display_name\": {\"type\": \"string\"}, \"tags\": {\"type\": \"array\"}, \"attributes\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}}}}, \"raw\": {}, \"inputs\": {\"type\": \"object\", \"properties\": {\"py2_item_id\": {}, \"py2_item_type\": {}, \"py2_scripts_only\": {}, \"py2_search_tags\": {}, \"py2_workflows_only\": {}, \"py2_playbooks_only\": {}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "d87ee1c1-f76b-4839-a050-078bd8c2ef2f",
      "version": 12,
      "view_items": [
        {
          "content": "529aa15d-ba52-4090-bf98-b8869c8be266",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "6120aa78-46ec-4aa0-8435-7775177dc06b",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "7737a7a6-3ba6-44ce-ad00-db4428f76c9a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "181b83c6-d774-465a-ab4e-589e4d6c8bd9",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "923e2cd0-ad53-49cb-8a6c-022e0db71c1a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c78a08b2-029a-438a-b6f2-9ae0c7e8b632",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 223,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1746566505640,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1746566505640,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "e7e3b2d7-8e6a-4169-b94a-9ca7f6a4d024"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_search_for_py2",
      "name": "fn_search_for_py2",
      "programmatic_name": "fn_search_for_py2",
      "tags": [],
      "users": [
        "sysadmin@example.com"
      ],
      "uuid": "d87b249a-af50-4498-bce9-bacaa14efb01"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 16,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_7d94e62b_d006_404c_a8d1_0a02036af733\" isExecutable=\"true\" name=\"playbook_7d94e62b_d006_404c_a8d1_0a02036af733\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1if1nbl\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Search for Python 2\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"d87ee1c1-f76b-4839-a050-078bd8c2ef2f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.py2_item_id = row[\\\"item_id\\\"]\\ninputs.py2_item_type = row[\\\"item_type\\\"]\\ninputs.py2_inc_id = incident.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_for_py2_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1if1nbl\u003c/incoming\u003e\u003coutgoing\u003eFlow_15vmjpy\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1if1nbl\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"search_for_py2__datatable_results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"04851025-07d6-469c-beca-f349cc184f9e\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_15vmjpy\u003c/incoming\u003e\u003coutgoing\u003eFlow_11w1y3h\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_15vmjpy\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_11w1y3h\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_11w1y3h\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_7d94e62b_d006_404c_a8d1_0a02036af733\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_11w1y3h\" id=\"Flow_11w1y3h_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"412\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"494\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15vmjpy\" id=\"Flow_15vmjpy_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"328\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1if1nbl\" id=\"Flow_1if1nbl_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.765625\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"328\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.21875\" x=\"656\" y=\"494\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1743710022555,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_7d94e62b_d006_404c_a8d1_0a02036af733",
      "description": {
        "content": "Search for Python2 in scripts, workflows and playbooks. Python 2 will be removed in an upcoming version of SOAR.",
        "format": "text"
      },
      "display_name": "Check for Python 2",
      "export_key": "search_for_python_2_datatable",
      "field_type_handle": "playbook_7d94e62b_d006_404c_a8d1_0a02036af733",
      "fields_type": {
        "actions": [],
        "display_name": "Check for Python 2",
        "export_key": "playbook_7d94e62b_d006_404c_a8d1_0a02036af733",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_7d94e62b_d006_404c_a8d1_0a02036af733",
        "uuid": "47579dd3-a73a-49c8-a2fe-a145a5a87964"
      },
      "has_logical_errors": false,
      "id": 220,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "last_modified_time": 1746566500823,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1743710022698,
          "description": "",
          "enabled": false,
          "export_key": "search_for_py2__datatable_results",
          "id": 208,
          "language": "python3",
          "last_modified_by": "sysadmin@example.com",
          "last_modified_time": 1746565847959,
          "name": "search_for_py2__datatable_results",
          "object_type": "search_for_py2_results",
          "playbook_handle": "search_for_python_2_datatable",
          "programmatic_name": "search_for_python_2_datatable_search_for_py2_results",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.search_for_py2_results\n\nPY2_LOOKUP = {\n  \"PY2_UNCONVERTIBLE\": \"Python 2 execution found, but script complexity prevents further analysis. Please review and, in some cases, changing the setting to Python 3 is the only change needed.\",\n  \"PY2_CONVERTIBLE\": \"{item_type} set to run Python 2. This {item_type} can be easily changed to use Python 3. Check function input scripts, local scripts, and scripts used in conditions. Mostly likely the only change needed is to convert all language settings to Python 3.\",\n  \"PY2_ITERS\": \"Python 2 iters found. Convert to use .items(), .keys(), and .values() as appropriate\",\n  \"PY2_JAVA_UTIL_DATE\": \"\u0027import java.util.Date\u0027 found. Change to \u0027from datetime import datetime\u0027 and datetime functions such as \u0027datetime.now()\u0027.\",\n  \"PY2_UNICODE\": \"Unicode strings found (\u0027u\u0027 string prefix). This can remain for Python 3, but it\u0027s cleaner to remove.\"\n}\n\ndef display_db_row(now, item_type, status, attributes):\n  row[\"date\"] = now\n  row[\"status\"] = status\n\n  msg = []\n  for attr in attributes:\n    if PY2_LOOKUP.get(attr):\n      row[attr.lower()] = \"Yes\"\n      msg.append(PY2_LOOKUP.get(attr).format(item_type=item_type.title()))\n    else:\n      msg.append(attr)\n  row[\"notes\"] = \"\\n\".join(msg)\n\ndef display_db():\n  now = int(datetime.now().timestamp()*1000)\n  is_found = False\n  for item_type in [\"script\", \"playbook\", \"workflow\"]:\n    for item_id, item_info in results.content.get(item_type, []).items():\n      if row[\"item_type\"] == item_type and int(row[\"item_id\"]) == int(item_id):\n        is_found = True\n        display_db_row(now, item_type, \"Unconverted\", item_info.get(\"attributes\", []))\n        break\n\n  if not is_found:\n    display_db_row(now, None, \"Converted\", [f\"{row[\u0027item_type\u0027]} is converted.\"])\n\n# S T A R T\nif results.success:\n    display_db()\nelse:\n    incident.addNote(f\"Check for Python 2 failed: {results.reason}\")\n",
          "tags": [],
          "uuid": "04851025-07d6-469c-beca-f349cc184f9e"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "search_for_python_2_datatable",
      "object_type": "search_for_py2_results",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_7d94e62b-d006-404c-a8d1-0a02036af733",
        "id": 311,
        "name": "playbook_7d94e62b_d006_404c_a8d1_0a02036af733",
        "type": "playbook",
        "uuid": "f0d9c45b-2d75-4ab3-93cd-01f540494c5c"
      },
      "tags": [],
      "type": "default",
      "uuid": "7d94e62b-d006-404c-a8d1-0a02036af733",
      "version": 19
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 6,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb\" isExecutable=\"true\" name=\"playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1y67s6b\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cendEvent id=\"EndPoint_1\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0xw3zkd\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1y67s6b\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_2\"/\u003e\u003cserviceTask id=\"ServiceTask_2\" name=\"Convert to Python 3\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"b51acbd2-48bf-4faf-b433-0409ac69bc7b\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.py2_item_id = row.item_id\\ninputs.py2_item_type = row.item_type\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"convert_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1y67s6b\u003c/incoming\u003e\u003coutgoing\u003eFlow_1yfm2ys\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1yfm2ys\" sourceRef=\"ServiceTask_2\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Convert Results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d0dd501f-9f3c-421c-8f35-d86a56adc8f4\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1yfm2ys\u003c/incoming\u003e\u003coutgoing\u003eFlow_0xw3zkd\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0xw3zkd\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_1\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0xw3zkd\" id=\"Flow_0xw3zkd_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"392\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"424\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1yfm2ys\" id=\"Flow_1yfm2ys_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"308\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1y67s6b\" id=\"Flow_1y67s6b_di\"\u003e\u003comgdi:waypoint x=\"721\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"721\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"199.765625\" x=\"621\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_1\" id=\"EndPoint_1_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.21875\" x=\"655\" y=\"424\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"623.383\" y=\"307.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1743710023211,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb",
      "description": {
        "content": "Convert Scripts, Workflows and Playbooks to Python 3 if no blockers exist. Blockers are \u0027Manual Conversion Required\u0027, \u0027Python 2 iterators\u0027, and \u0027import java.util.Date\u0027",
        "format": "text"
      },
      "display_name": "Convert to Python 3",
      "export_key": "convert_to_python_3",
      "field_type_handle": "playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb",
      "fields_type": {
        "actions": [],
        "display_name": "Convert to Python 3",
        "export_key": "playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb",
        "uuid": "f02ce95d-1c65-45e7-a1d8-118b0bca7dcd"
      },
      "has_logical_errors": false,
      "id": 221,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "last_modified_time": 1745865603836,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1743710023347,
          "description": "",
          "enabled": false,
          "export_key": "Convert Results",
          "id": 209,
          "language": "python3",
          "last_modified_by": "sysadmin@example.com",
          "last_modified_time": 1745599874188,
          "name": "Convert Results",
          "object_type": "search_for_py2_results",
          "playbook_handle": "convert_to_python_3",
          "programmatic_name": "convert_to_python_3_convert_results",
          "script_text": "from datetime import datetime\nresults = playbook.functions.results.convert_results\n\nif results.success:\n  now = int(datetime.now().timestamp()*1000)\n  row[\"date\"] = now\n  row[\"status\"] = \"Converted\"\n  row[\"notes\"] = results.reason if results.reason else \"\"\nelse:\n  incident.addNote(f\"Python 2 conversion failed for \u0027{row.item_name.content}\u0027: {results.reason}\")",
          "tags": [],
          "uuid": "d0dd501f-9f3c-421c-8f35-d86a56adc8f4"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "search_for_py2_results.py2_convertible",
              "method": "equals",
              "type": null,
              "value": "Yes"
            },
            {
              "evaluation_id": null,
              "field_name": "search_for_py2_results.status",
              "method": "equals",
              "type": null,
              "value": "Unconverted"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "convert_to_python_3",
      "object_type": "search_for_py2_results",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_7bd5e8ec-b313-4f71-b456-3c7496a78beb",
        "id": 302,
        "name": "playbook_7bd5e8ec_b313_4f71_b456_3c7496a78beb",
        "type": "playbook",
        "uuid": "6714a459-ae40-408a-bdc0-4d0884a39fde"
      },
      "tags": [],
      "type": "default",
      "uuid": "7bd5e8ec-b313-4f71-b456-3c7496a78beb",
      "version": 9
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 45,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_a6824fd1_69fa_4af1_9a40_11152af3970d\" isExecutable=\"true\" name=\"playbook_a6824fd1_69fa_4af1_9a40_11152af3970d\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1if1nbl\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Search for Python 2\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"d87ee1c1-f76b-4839-a050-078bd8c2ef2f\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.py2_inc_id = incident.id\\ninputs.py2_item_id = playbook.inputs.item_id\\ninputs.py2_item_name = playbook.inputs.item_name\\ninputs.py2_item_type = playbook.inputs.item_type\\n\\ninputs.py2_search_tags = playbook.inputs.search_tags\\ninputs.py2_clear_datatable = bool(playbook.inputs.clear_database == \\\"Yes\\\")\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_for_py2_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1if1nbl\u003c/incoming\u003e\u003coutgoing\u003eFlow_15vmjpy\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1if1nbl\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"search_for_py2_results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"801c0175-dd74-439d-a22d-575471810493\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_15vmjpy\u003c/incoming\u003e\u003coutgoing\u003eFlow_11w1y3h\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_15vmjpy\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_11w1y3h\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_11w1y3h\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_a6824fd1_69fa_4af1_9a40_11152af3970d\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_11w1y3h\" id=\"Flow_11w1y3h_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"412\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"494\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15vmjpy\" id=\"Flow_15vmjpy_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"328\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1if1nbl\" id=\"Flow_1if1nbl_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.1875\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"328\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.21875\" x=\"656\" y=\"494\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1743196863546,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
      "description": {
        "content": "Search for Python2 in scripts, workflows and playbooks. Python 2 will be removed in an upcoming version of SOAR.",
        "format": "text"
      },
      "display_name": "Search for Python 2",
      "export_key": "search_for_py2",
      "field_type_handle": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
      "fields_type": {
        "actions": [],
        "display_name": "Search for Python 2",
        "export_key": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
        "fields": {
          "clear_database": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d/clear_database",
            "hide_notification": false,
            "id": 4313,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "clear_database",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Clear Database",
            "tooltip": "",
            "type_id": 1241,
            "uuid": "ca4bc5fd-6e1a-4c9e-b0cf-630cb03e39bf",
            "values": [
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "No",
                "properties": null,
                "uuid": "4638b0b0-2067-4881-a73f-a6a6fd85f2d8",
                "value": 4105
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "Yes",
                "properties": null,
                "uuid": "b41de291-6d0d-4d43-82c5-765a394aa527",
                "value": 4106
              }
            ]
          },
          "item_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d/item_id",
            "hide_notification": false,
            "id": 3449,
            "input_type": "number",
            "internal": false,
            "is_tracked": false,
            "name": "item_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "123",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Item Id",
            "tooltip": "script, workflow or playbook id",
            "type_id": 1241,
            "uuid": "8c33fa59-ac7f-45c8-9a03-bc7eece342c7",
            "values": []
          },
          "item_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d/item_name",
            "hide_notification": false,
            "id": 3590,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "item_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Item Name",
            "tooltip": "Display name or script, workflow or playbook",
            "type_id": 1241,
            "uuid": "ece802d0-e3c8-4b18-a839-bed6ffceda48",
            "values": []
          },
          "item_type": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d/item_type",
            "hide_notification": false,
            "id": 3450,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "item_type",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Item Type",
            "tooltip": "",
            "type_id": 1241,
            "uuid": "4a2441f0-5802-4821-80ff-0ea25c12be3d",
            "values": [
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "all",
                "properties": null,
                "uuid": "f717cf8e-3f5a-4058-a1e4-2086bd4ca10b",
                "value": 3752
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "script",
                "properties": null,
                "uuid": "62fe1e6c-459c-4375-ac8f-c473aff26144",
                "value": 3562
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "workflow",
                "properties": null,
                "uuid": "24c7eb21-479c-47a0-9964-f9dd9290688a",
                "value": 3563
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "playbook",
                "properties": null,
                "uuid": "5ac18b62-aa9b-4623-b17f-f3ea6aaa4b38",
                "value": 3564
              }
            ]
          },
          "search_tags": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d/search_tags",
            "hide_notification": false,
            "id": 3406,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "search_tags",
            "operation_perms": {},
            "operations": [],
            "placeholder": "fn_soar_utils, fn_outbound_email",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Search Apps",
            "tooltip": "comma separated list app API names to allow",
            "type_id": 1241,
            "uuid": "354a9367-e89a-497f-ab63-2a721b661cf4",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
        "uuid": "75e9cada-aeee-4957-aa40-76de7b0677b6"
      },
      "has_logical_errors": false,
      "id": 214,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 20,
        "name": "sysadmin@example.com",
        "type": "user"
      },
      "last_modified_time": 1746565823391,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1743196863736,
          "description": "",
          "enabled": false,
          "export_key": "search_for_py2_results",
          "id": 196,
          "language": "python3",
          "last_modified_by": "sysadmin@example.com",
          "last_modified_time": 1746565819628,
          "name": "search_for_py2_results",
          "object_type": "incident",
          "playbook_handle": "search_for_py2",
          "programmatic_name": "search_for_py2_search_for_py2_results",
          "script_text": "from datetime import datetime\n\nresults = playbook.functions.results.search_for_py2_results\n\nPY2_LOOKUP = {\n  \"PY2_UNCONVERTIBLE\": \"Python 2 execution found, but script complexity prevents further analysis. Please review and, in some cases, changing the setting to Python 3 is the only change needed.\",\n  \"PY2_CONVERTIBLE\": \"{item_type} set to run Python 2. This {item_type} can be easily changed to use Python 3. Check function input scripts, local scripts, and scripts used in conditions. Mostly likely the only change needed is to convert all language settings to Python 3.\",\n  \"PY2_ITERS\": \"Python 2 iters found. Convert to use .items(), .keys(), and .values() as appropriate\",\n  \"PY2_JAVA_UTIL_DATE\": \"\u0027import java.util.Date\u0027 found. Change to \u0027from datetime import datetime\u0027 and datetime functions such as \u0027datetime.now()\u0027.\",\n  \"PY2_UNICODE\": \"Unicode strings found (\u0027u\u0027 string prefix). This can remain for Python 3, but it\u0027s cleaner to remove.\"\n}\n\ndef display_db_row(db, now, item_type, item_id, item_name, tags, attributes, components):\n  row = incident.addRow(db)\n  row[\"date\"] = now\n  row[\"status\"] = \"Unconverted\"\n  row[\"item_type\"] = item_type\n  row[\"item_id\"] = int(item_id)\n  row[\"item_name\"] = make_url(item_type, item_id, item_name)\n  if tags:\n    row[\"app_tags\"] = \", \".join([str(tag.get(\"tag_handle\"))  for tag in tags])\n  msg = []\n  for attr in attributes:\n    row[attr.lower()] = \"Yes\"\n    msg.append(PY2_LOOKUP.get(attr, \"\").format(item_type=item_type.title()))\n  row[\"py2_components\"] = helper.createPlainText(\"\\n\".join(components)) if components else \"\"\n  row[\"notes\"] = \"\\n\".join(msg)\n\ndef display_db(db=\"search_for_py2_results\"):\n  now = int(datetime.now().timestamp()*1000)\n  found = False\n  for item_type in [\"script\", \"playbook\", \"workflow\"]:\n    for item_id, item_info in results.content.get(item_type, []).items():\n      found = True\n      display_db_row(db,\n                     now,\n                     item_type,\n                     item_id,\n                     item_info.get(\"display_name\") if item_info.get(\"display_name\") else item_info.get(\"name\"),\n                     item_info.get(\"tags\", []),\n                     item_info.get(\"attributes\", []),\n                     item_info.get(\"components\", []))\n             \n  if not found:\n    item_type_msg = \"scripts, workflows, or playbooks\" if playbook.inputs.item_type == \"all\" else f\"{playbook.inputs.item_type}s\"\n    info = \"\"\n    if playbook.inputs.item_id:\n      info = f\"for ID: {playbook.inputs.item_id}\"\n    elif playbook.inputs.item_name:\n      info = f\"for name: {playbook.inputs.item_name}\"\n    elif playbook.inputs.search_tags:\n      info = f\"for app(s): {playbook.inputs.search_tags}\"\n    \n    incident.addNote(f\"No Python 2 {item_type_msg} found {info}\")\n\ndef make_url(item_type, item_id, item_name):\n  if item_type == \"script\":\n    return f\"\u003ca target=\u0027_blank\u0027 href=\u0027#customize?tab=scripts\u0026script={item_id}\u0027\u003e{item_name}\u003c/a\u003e\"\n\n  if item_type == \"workflow\":\n    return f\"\u003ca target=\u0027_blank\u0027 href=\u0027#customize?tab=workflows\u0026workflow={item_id}\u0027\u003e{item_name}\u003c/a\u003e\"\n\n  if item_type == \"playbook\":\n    return f\"\u003ca target=\u0027_blank\u0027 href=\u0027#playbooks/designer/{item_id}\u0027\u003e{item_name}\u003c/a\u003e\"\n\n  return item_name\n\n# S T A R T\nif results.success:\n    display_db()\nelse:\n    incident.addNote(f\"Search for Python 2 failed: {results.reason}\")\n",
          "tags": [],
          "uuid": "801c0175-dd74-439d-a22d-575471810493"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003ch5\u003eOptionally refer to a specific script, workflow or playbook\u003c/h5\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "ece802d0-e3c8-4b18-a839-bed6ffceda48",
            "element": "field_uuid",
            "field_type": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "8c33fa59-ac7f-45c8-9a03-bc7eece342c7",
            "element": "field_uuid",
            "field_type": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "4a2441f0-5802-4821-80ff-0ea25c12be3d",
            "element": "field_uuid",
            "field_type": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "\u003ch5\u003eOptionally limit the search to specific apps, scripts, workflows, or playbooks\u003c/h5\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "354a9367-e89a-497f-ab63-2a721b661cf4",
            "element": "field_uuid",
            "field_type": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "ca4bc5fd-6e1a-4c9e-b0cf-630cb03e39bf",
            "element": "field_uuid",
            "field_type": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "search_for_py2",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_a6824fd1-69fa-4af1-9a40-11152af3970d",
        "id": 301,
        "name": "playbook_a6824fd1_69fa_4af1_9a40_11152af3970d",
        "type": "playbook",
        "uuid": "597b0b5b-a0ca-478f-b5a6-fb62232dda83"
      },
      "tags": [],
      "type": "default",
      "uuid": "a6824fd1-69fa-4af1-9a40-11152af3970d",
      "version": 49
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 9339,
    "f": 0,
    "m": 0,
    "major": 0,
    "minor": 0,
    "r": 0,
    "v": 51,
    "version": "51.0.0.0.9339"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "Search for Python 2 Results",
      "export_key": "search_for_py2_results",
      "fields": {
        "app_tags": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/app_tags",
          "hide_notification": false,
          "id": 3462,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "app_tags",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "App Tags",
          "tooltip": "App API name ",
          "type_id": 1248,
          "uuid": "bf87f664-1a3f-4da5-89c5-09afbcc49ba0",
          "values": [],
          "width": 91
        },
        "date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/date",
          "hide_notification": false,
          "id": 3463,
          "input_type": "datetimepicker",
          "internal": false,
          "is_tracked": false,
          "name": "date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Date",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "3aa8b4c1-f20a-4af9-9cf2-237025cab6c0",
          "values": [],
          "width": 82
        },
        "item_id": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/item_id",
          "hide_notification": false,
          "id": 3464,
          "input_type": "number",
          "internal": false,
          "is_tracked": false,
          "name": "item_id",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "ID",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "ef2124bf-3a1f-40ff-a480-134aac9c0a28",
          "values": [],
          "width": 26
        },
        "item_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/item_name",
          "hide_notification": false,
          "id": 3465,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "item_name",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": true,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Name",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "06d76dc7-a531-4331-af8f-b60345512c2a",
          "values": [],
          "width": 160
        },
        "item_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/item_type",
          "hide_notification": false,
          "id": 3466,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "item_type",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Type",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "71de9c4d-b9ca-401a-b836-b3685fc1908e",
          "values": [],
          "width": 52
        },
        "notes": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/notes",
          "hide_notification": false,
          "id": 3467,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "notes",
          "operation_perms": {},
          "operations": [],
          "order": 12,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Notes",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "dc24a8d3-1feb-4adf-9eb2-6a936e771f72",
          "values": [],
          "width": 502
        },
        "py2_components": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/py2_components",
          "hide_notification": false,
          "id": 3707,
          "input_type": "textarea",
          "internal": false,
          "is_tracked": false,
          "name": "py2_components",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Py2 Components",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "d453f57d-8f89-4c92-b241-bcf7b028f491",
          "values": [],
          "width": 129
        },
        "py2_convertible": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/py2_convertible",
          "hide_notification": false,
          "id": 3468,
          "input_type": "select",
          "internal": false,
          "is_tracked": false,
          "name": "py2_convertible",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Fixable",
          "tooltip": "This item can be converted via the Datatable item action",
          "type_id": 1248,
          "uuid": "b3ed2141-79fe-4404-86aa-441d053806cd",
          "values": [
            {
              "default": true,
              "enabled": true,
              "hidden": false,
              "label": "Yes",
              "properties": null,
              "uuid": "37578967-dd60-44be-a728-ee2a2db5577e",
              "value": 3565
            },
            {
              "default": false,
              "enabled": true,
              "hidden": false,
              "label": "No",
              "properties": null,
              "uuid": "81cf5bc8-3852-448a-bea9-de153e7a6643",
              "value": 3566
            }
          ],
          "width": 136
        },
        "py2_iters": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/py2_iters",
          "hide_notification": false,
          "id": 3469,
          "input_type": "select",
          "internal": false,
          "is_tracked": false,
          "name": "py2_iters",
          "operation_perms": {},
          "operations": [],
          "order": 10,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Py2 Iters",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "895a2e67-2633-42f8-b8d1-252a63537e51",
          "values": [
            {
              "default": true,
              "enabled": true,
              "hidden": false,
              "label": "Yes",
              "properties": null,
              "uuid": "6820b5e4-6f8a-4d77-81f1-2e69f68a6fde",
              "value": 3567
            },
            {
              "default": false,
              "enabled": true,
              "hidden": false,
              "label": "No",
              "properties": null,
              "uuid": "92391963-ce74-4a94-9c47-90d6250f6e5b",
              "value": 3568
            }
          ],
          "width": 70
        },
        "py2_java_util_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/py2_java_util_date",
          "hide_notification": false,
          "id": 3470,
          "input_type": "select",
          "internal": false,
          "is_tracked": false,
          "name": "py2_java_util_date",
          "operation_perms": {},
          "operations": [],
          "order": 11,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "java.util.Date",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "b4e08b8a-1dd1-495d-8a43-32e826cfdffb",
          "values": [
            {
              "default": true,
              "enabled": true,
              "hidden": false,
              "label": "Yes",
              "properties": null,
              "uuid": "2047fab1-9992-4b5e-980a-3c807988abe4",
              "value": 3569
            },
            {
              "default": false,
              "enabled": true,
              "hidden": false,
              "label": "No",
              "properties": null,
              "uuid": "4725177f-e4aa-45fc-b24a-ba90896ad609",
              "value": 3570
            }
          ],
          "width": 103
        },
        "py2_unconvertible": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/py2_unconvertible",
          "hide_notification": false,
          "id": 3471,
          "input_type": "select",
          "internal": false,
          "is_tracked": false,
          "name": "py2_unconvertible",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Fix Manually",
          "tooltip": "Manual conversion is required",
          "type_id": 1248,
          "uuid": "e22344ce-bbfc-44aa-865f-f12f7af36499",
          "values": [
            {
              "default": true,
              "enabled": true,
              "hidden": false,
              "label": "Yes",
              "properties": null,
              "uuid": "f9ccbebc-cfad-4984-ab8b-1f92433dc287",
              "value": 3571
            },
            {
              "default": false,
              "enabled": true,
              "hidden": false,
              "label": "No",
              "properties": null,
              "uuid": "8bd1ad3b-19c0-4e3c-b6ad-cd5395f54bc7",
              "value": 3572
            }
          ],
          "width": 182
        },
        "py2_unicode": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/py2_unicode",
          "hide_notification": false,
          "id": 3472,
          "input_type": "select",
          "internal": false,
          "is_tracked": false,
          "name": "py2_unicode",
          "operation_perms": {},
          "operations": [],
          "order": 9,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Unicode",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "a19c0509-0b41-4553-b557-ae28570c9c9a",
          "values": [
            {
              "default": true,
              "enabled": true,
              "hidden": false,
              "label": "Yes",
              "properties": null,
              "uuid": "01bdd00c-d723-44f3-bc63-876162a2b4da",
              "value": 3573
            },
            {
              "default": false,
              "enabled": true,
              "hidden": false,
              "label": "No",
              "properties": null,
              "uuid": "edd32b9f-19bb-43e3-8d7e-6c876c58d1dd",
              "value": 3574
            }
          ],
          "width": 62
        },
        "status": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "search_for_py2_results/status",
          "hide_notification": false,
          "id": 3473,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "status",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Status",
          "tooltip": "",
          "type_id": 1248,
          "uuid": "1bd3e2b6-f7de-4275-9a50-927691103c1b",
          "values": [],
          "width": 66
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "search_for_py2_results",
      "uuid": "8c6ef899-9ab1-4d4f-a6c1-9edb2d3021fc"
    }
  ],
  "workflows": [],
  "workspaces": []
}
