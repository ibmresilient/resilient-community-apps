<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html"><link rel="next" title="Symantec DLP" href="../fn_symantec_dlp/README.html"><link rel="prev" title="VMware Carbon Black Cloud" href="../fn_vmware_cbc/README.html">
        <link rel="prefetch" href="../_static/IBM_Security_Light.png" as="image">
        <link rel="prefetch" href="../_static/IBM_Security_Dark.png" as="image">

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>AWS IAM - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input aria-label="Toggle navigation of ServiceNow" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmware_cbc/README.html">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fn_bitsight_cyber_insurance/README.html">BitSight Cyber Insurance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_algosec/README.html">AlgoSec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange/README.html">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_maps_directions/README.html">Google Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_low_code/README.html">SOAR Low Code App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocm/README.html">On Call Manager for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Networks Panorama Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">Phish Tank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Function Utilities for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_search_for_py2/README.html">Search for Python 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sumo_logic/README.html">Sumo Logic Cloud SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities Function for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html">watsonx.ai for SOAR Analysts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#app-usage">App usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#how-to-get-the-best-out-of-the-app">How to get the best out of the app</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#data-selection">Data selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#soar-customizations">SOAR Customizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <!--
  This README.md is generated by running:
  "resilient-sdk docgen -p fn_aws_iam"

  This file was generated with resilient-sdk v52.0.0.0.1048

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  All fields followed by "::CHANGE_ME::"" should be manually edited

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)

  NOTE: If your app is available in the container-format only, there is no need to mention the integration server in this readme.
-->
<section id="aws-iam">
<h1>AWS IAM<a class="headerlink" href="#aws-iam" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---aws-iam-add-user-to-groups"><span class="xref myst">Function - AWS IAM: Add User To Groups</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-attach-user-policies"><span class="xref myst">Function - AWS IAM: Attach User policies</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-deactivate-mfa-devices"><span class="xref myst">Function - AWS IAM: Deactivate MFA Devices</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-access-keys"><span class="xref myst">Function - AWS IAM: Delete Access Keys</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-login-profile"><span class="xref myst">Function - AWS IAM: Delete Login Profile</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-service-specific-credentials"><span class="xref myst">Function - AWS IAM: Delete Service Specific Credentials</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-signing-certificates"><span class="xref myst">Function - AWS IAM: Delete Signing Certificates</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-ssh-public-keys"><span class="xref myst">Function - AWS IAM: Delete SSH Public Keys</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-delete-virtual-mfa-devices"><span class="xref myst">Function - AWS IAM: Delete Virtual MFA Devices</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-detach-user-policies"><span class="xref myst">Function - AWS IAM: Detach User policies</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-mfa-devices"><span class="xref myst">Function - AWS IAM: List MFA Devices</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-service-specific-credentials"><span class="xref myst">Function - AWS IAM: List Service Specific Credentials</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-signing-certificates"><span class="xref myst">Function - AWS IAM: List Signing Certificates</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-ssh-public-keys"><span class="xref myst">Function - AWS IAM: List SSH Public Keys</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-user-access-key-ids"><span class="xref myst">Function - AWS IAM: List User Access Key IDs</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-user-groups"><span class="xref myst">Function - AWS IAM: List User Groups</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-user-policies"><span class="xref myst">Function - AWS IAM: List User Policies</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-list-users"><span class="xref myst">Function - AWS IAM: List Users</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-remove-user-from-groups"><span class="xref myst">Function - AWS IAM: Remove User From Groups</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-update-access-key"><span class="xref myst">Function - AWS IAM: Update Access Key</span></a></p></li>
<li><p><a class="reference internal" href="#function---aws-iam-update-login-profile"><span class="xref myst">Function - AWS IAM: Update Login Profile</span></a></p></li>
<li><p><a class="reference internal" href="#script---scr_aws_iam_add_access_key_as_artifact"><span class="xref myst">Script - scr_aws_iam_add_access_key_as_artifact</span></a></p></li>
<li><p><a class="reference internal" href="#script---scr_aws_iam_add_user_as_artifact"><span class="xref myst">Script - scr_aws_iam_add_user_as_artifact</span></a></p>
<ul>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#data-table---aws-iam-access-keys"><span class="xref myst">Data Table - AWS IAM Access Keys</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---aws-iam-users"><span class="xref myst">Data Table - AWS IAM Users</span></a></p></li>
<li><p><a class="reference internal" href="#custom-artifact-types"><span class="xref myst">Custom Artifact Types</span></a></p></li>
<li><p><a class="reference internal" href="#rules"><span class="xref myst">Rules</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<!--
  Specify all changes in this release. Do not remove the release
  notes of a previous release
-->
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0.3</p></td>
<td><p>06/2024</p></td>
<td><p>Converted to Python3</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.2</p></td>
<td><p>-</p></td>
<td><p>Update payloads in workflow comments</p></td>
</tr>
<tr class="row-even"><td><p>1.0.1</p></td>
<td><p>-</p></td>
<td><p>Support added for App Host.</p></td>
</tr>
<tr class="row-odd"><td><p>1.0.0</p></td>
<td><p>-</p></td>
<td><p>Initial Release</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<!--
  Provide a high-level description of the function itself and its remote software or application.
  The text below is parsed from the "description" and "long_description" attributes in the setup.py file
-->
<p><strong>Amazon AWS IAM Integration for SOAR</strong></p>
<p>Amazon Web Services Identity and Access Management (AWS IAM) allows management of access to AWS services and resources securely. You can use IAM to create and manage AWS users and groups, and use permissions to allow or deny access to AWS resources.
The AWS IAM integration with the SOAR platform allows you to query and update users or access keys for an AWS account.</p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<!--
  List the Key Features of the Integration
-->
<p>You can execute the following types of queries:</p>
<ul class="simple">
<li><p>Get a list of users and associated items (login profile, access keys, groups, policies).</p></li>
<li><p>Get a list of access keys.</p></li>
<li><p>List objects associated with a user:</p>
<ul>
<li><p>Access keys.</p></li>
<li><p>Groups.</p></li>
<li><p>Policies.</p></li>
<li><p>SSH public keys.</p></li>
<li><p>Service-specific credentials.</p></li>
<li><p>Signing certificates.</p></li>
<li><p>Active MFA devices (Virtual devices flagged).</p></li>
</ul>
</li>
</ul>
<p>You can also use the integration to make the following changes to an AWS IAM environment:</p>
<ul class="simple">
<li><p>Delete a user and delete or remove items associated with the user.</p></li>
<li><p>Attach a user policy.</p></li>
<li><p>Detach all policies for a user.</p></li>
<li><p>Add a user to a group.</p></li>
<li><p>Remove a user from all groups.</p></li>
<li><p>Change a user profile password.</p></li>
<li><p>Delete an access key.</p></li>
<li><p>Delete all access keys for a user.</p></li>
<li><p>Delete the login profile for a user.</p></li>
<li><p>Delete all SSH Public Keys for a user.</p></li>
<li><p>Delete all service-specific credentials for a user.</p></li>
<li><p>Delete all signing certificates for a user.</p></li>
<li><p>De-activate all active MFA devices for a user.</p></li>
<li><p>Delete all active MFA virtual devices for a user.</p></li>
</ul>
</section>
</section>
<section id="the-integration-contains-the-following-functions">
<h2>The integration contains the following functions:
<img alt="screenshot: functions" src="../_images/functions.png" />
<img alt="screenshot: functions_2" src="../_images/functions_2.png" /><a class="headerlink" href="#the-integration-contains-the-following-functions" title="Link to this heading">¶</a></h2>
</section>
<hr class="docutils" />
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<!--
  List any Requirements
-->
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0.0.9340</span></code></p></li>
<li><p>An Integration Server running:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=35.0.0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resilient_lib&gt;=35.0.0</span></code></p></li>
<li><p>The minimum set of SOAR API permissions for this integration if using an API key account:</p>
<ul>
<li><p>Edit Org Data</p></li>
<li><p>Incidents.Edit.Fields</p></li>
<li><p>Functions.Read</p></li>
<li><p>Functions.Edit</p></li>
<li><p>Layouts.Read</p></li>
<li><p>Other.ReadIncidentsActionInvocations</p></li>
<li><p>Scripts.Create</p></li>
<li><p>Scripts.Edit</p></li>
<li><p>Workflows.Create</p></li>
<li><p>Workflow.Edit</p></li>
</ul>
</li>
<li><p>To set up an Integration Server see: <a class="reference external" href="https://ibm.biz/res-int-server-guide">ibm.biz/res-int-server-guide</a></p></li>
</ul>
</li>
<li><p>An AWS IAM user dedicated for this integration with the following configuration:</p>
<ul>
<li><p>User account is not the AWS IAM root account user.</p></li>
<li><p>User is added to an “Administrators” group to which is attached the <code class="docutils literal notranslate"><span class="pre">AdministratorAccess</span></code> policy.</p></li>
<li><p>An access key created for the user. The user access key ID and secret access key are used by the integration.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (also known as App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an App Host, the requirements are:</p>
<ul class="simple">
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0.0.9340</span></code>.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">51.0.0.0.9340</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=35.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= <code class="docutils literal notranslate"><span class="pre">1.10.15</span></code>.</p></li>
<li><p>Cloud Pak is configured with an Edge Gateway.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.9, 3.11, and 3.12 are officially supported. When deployed as an app, the app runs on Python 3.11.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>boto3&gt;=1.10.6</p></li>
<li><p>resilient_circuits&gt;=35.0.0</p></li>
<li><p>resilient_lib&gt;=35.0.0</p></li>
</ul>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>An Amazon AWS account with access key id and access key.</p></li>
</ul>
</section>
</section>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="on-apphost">
<h3>on AppHost<a class="headerlink" href="#on-apphost" title="Link to this heading">¶</a></h3>
<p>All the components for running this integration in a container already exist when using the App Host app.</p>
<ul class="simple">
<li><p>Download the app <code class="docutils literal notranslate"><span class="pre">app-fn_aws_iam-x.x.x.zip</span></code>.</p></li>
<li><p>Navigate to Administrative Settings and then the Apps tab.</p></li>
<li><p>Click the Install button and select the downloaded file: app-fn_aws_iam-x.x.x.zip.</p></li>
<li><p>Go to the Configuration tab and edit the app.config file, editing the access key values for Amazon AWS IAM and add a proxy setting if required.</p></li>
</ul>
</section>
<section id="on-integration-server">
<h3>on Integration Server<a class="headerlink" href="#on-integration-server" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Download the app  <code class="docutils literal notranslate"><span class="pre">app-fn_aws_iam-x.x.x.zip</span></code>.</p></li>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">.zip</span></code> to your Integration Server and SSH into it.</p></li>
<li><p><strong>Unzip</strong> the app:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ unzip app-fn_aws_iam-x.x.x.zip
</pre></div>
</div>
</li>
<li><p><strong>Install</strong> the package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install fn_aws_iam-x.x.x.tar.gz
</pre></div>
</div>
</li>
<li><p>Import the <strong>configurations</strong> into your app.config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ resilient-circuits config -u
</pre></div>
</div>
</li>
<li><p>Import the fn_aws_iam <strong>customizations</strong> into the SOAR platform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ resilient-circuits customize -y -l fn-aws-iam
</pre></div>
</div>
</li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>aws_iam_access_key_id</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ABCDEFG</span></code></p></td>
<td><p><em>AWS access key id of user with programmatic (API) access to AWS IAM services for an AWS account. Note: User must have sufficent permissions to be able to manage IAM resources for the AWS account.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>aws_iam_secret_access_key</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aBcdeFGH/ABCDEFG12345</span></code></p></td>
<td><p><em>AWS secret access key used for programmatic (API) access to AWS services.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>http_proxy</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">http://proxy:80</span></code></p></td>
<td><p><em>Optional setting for an http proxy if required.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>https_proxy</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">http://proxy:80</span></code></p></td>
<td><p><em>Optional setting for an http proxy if required.</em></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-users">
<h2>Function - AWS IAM: List Users<a class="headerlink" href="#function-aws-iam-list-users" title="Link to this heading">¶</a></h2>
<p>The function can perform a get of IAM user or users in the AWS account. Users can be filtered by user name, group, policy or access key. If the user name is specified, the function can perform a get of information for this user only. Parameter aws_iam_user_name is an IAM user name. Parameters aws_iam_user_filter, aws_aim_group_filter and aws_aim_policy_filter param (all optional) are filters used to refine the user data returned. Parameter aws_iam_query_type (optional) is used to determine the type of query to perform on users.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Get</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code> and <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Get</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_filter (optional) is mapped to an activity field input. Note: Input should be a valid regular expression.</p></li>
<li><p>aws_iam_group_filter (optional) is mapped to an activity field input. Note: Input should be a valid regular expression.</p></li>
<li><p>aws_iam_policy_filter (optional) is mapped to an activity field input. Note: Input should be a valid regular expression.</p></li>
<li><p>aws_iam_access_key_filter (optional) is mapped to an activity field input. Note: Input should be a valid regular expression.</p></li>
<li><p>aws_iam_query_type is set to value <code class="docutils literal notranslate"><span class="pre">users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the incident rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code> from Actions.</p>
<p><img alt="screenshot: fn-aws-iam-list-users-action " src="../_images/fn-aws-iam-list-users-action.png" /></p>
</li>
<li><p>The user is presented with a list of input fields which can be used to filter users using regular expressions. Set any desired filters.</p>
<p><img alt="screenshot: fn-aws-iam-list-users-action_2 " src="../_images/fn-aws-iam-list-users-action_2.png" /></p>
</li>
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> is updated in the Resilient platform with the users’ properties for the selected AWS account.</p>
<p><img alt="screenshot: fn-aws-iam-list-users-datatable" src="../_images/fn-aws-iam-list-users-datatable.png" /></p>
<p>Note: If all unfiltered users are listed, the default user for the integration is indicated by “Yes” in the “Default user” field.</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_key_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users or access keys based on access keys applied to user. Filter by access key ID. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_group_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users based on group membership. Filter by group name. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_policy_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users based on policies applied to user. Filter by policy name. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_query_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Type of query to perform for list_users, can be one of ‘users’ or ‘access_keys’. Optional parameter.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users or access keys based on user name. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">,</span> <span class="s1">&#39;UserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:user/iam_test_User&#39;</span><span class="p">,</span> <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-05 15:54:43&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User_2&#39;</span><span class="p">,</span> <span class="s1">&#39;UserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:user/iam_test_User_2&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-10-31 16:23:07&#39;</span><span class="p">,</span> <span class="s1">&#39;PasswordLastUsed&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-12 10:55:42&#39;</span><span class="p">}</span>
                       <span class="p">],</span>
            <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;Path&quot;: &quot;/&quot;, &quot;UserName&quot;: &quot;iam_test_User&quot;, &quot;UserId&quot;: &quot;ABCDEFGH&quot;, &quot;Arn&quot;: &quot;arn:aws:iam::123456789123:user/iam_test_User&quot;, &quot;CreateDate&quot;: &quot;2019-11-05 15:54:43&quot;}, {&quot;Path&quot;: &quot;/&quot;, &quot;UserName&quot;: &quot;iam_test_User_2&quot;, &quot;UserId&quot;: &quot;ABCDEFGH&quot;, &quot;Arn&quot;: &quot;arn:aws:iam::123456789123:user/iam_test_User_2&quot;, &quot;CreateDate&quot;: &quot;2019-10-31 16:23:07&quot;}]&#39;</span><span class="p">,</span>
            <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">7951</span><span class="p">,</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-14 13:48:30&#39;</span>
                       <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="c1"># Get a list of all enabled filters.</span>
<span class="n">ENABLED_FILTERS</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_user_filter</span><span class="p">,</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_group_filter</span><span class="p">,</span> 
                               <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_policy_filter</span><span class="p">,</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_access_key_filter</span><span class="p">]</span> 
                   <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_regex</span><span class="p">(</span><span class="n">regex_str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;Test if sting is a correctly formed regular expression.</span>

<span class="sd">    :param regex_str: Regular expression string.</span>
<span class="sd">    :return: Boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regex_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Test any enabled filters to ensure they are valid regular expressions.</span>
    <span class="k">for</span> <span class="n">ef</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ENABLED_FILTERS</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_regex</span><span class="p">(</span><span class="n">ef</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The query filter &#39;</span><span class="si">{}</span><span class="s2">&#39; is not a valid regular expression.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unicode</span><span class="p">(</span><span class="n">ef</span><span class="p">)))</span>

    <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_user_filter</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_group_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_group_filter</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_policy_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_policy_filter</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_access_key_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_access_key_filter</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_query_type</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_users script ##</span>
<span class="c1">#  Globals</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_users script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;query_execution_time&quot;</span><span class="p">,</span> <span class="s2">&quot;UserName&quot;</span><span class="p">,</span> <span class="s2">&quot;Arn&quot;</span><span class="p">,</span> <span class="s2">&quot;DefaultUser&quot;</span><span class="p">,</span> <span class="s2">&quot;CreateDate&quot;</span><span class="p">,</span> <span class="s2">&quot;LoginProfileExists&quot;</span><span class="p">,</span> 
                   <span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">,</span> <span class="s2">&quot;Policies&quot;</span><span class="p">,</span> <span class="s2">&quot;Tags&quot;</span><span class="p">,</span> <span class="s2">&quot;Groups&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_users&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;List Users&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_add_quotes</span><span class="p">(</span><span class="n">tag_name</span><span class="p">):</span>
    <span class="c1"># Using regex</span>
    <span class="c1"># If spaces in tag name add quotes</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s&quot;</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">tag_name</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tag_name</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_access_key_ids</span><span class="p">(</span><span class="n">access_key_id_list</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">access_key_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ak_id</span> <span class="ow">in</span> <span class="n">access_key_id_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ak_id</span><span class="p">[</span><span class="s2">&quot;AccessKeyId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">access_key_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ak_id</span><span class="p">[</span><span class="s2">&quot;AccessKeyId&quot;</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">AccessKeyIds</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">access_key_ids</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_policies</span><span class="p">(</span><span class="n">policy_list</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">policies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pol</span> <span class="ow">in</span> <span class="n">policy_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pol</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">Policies</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">policies</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_groups</span><span class="p">(</span><span class="n">group_list</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">group_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">Groups</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_tags</span><span class="p">(</span><span class="n">tag_list</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">Tags</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check_add_quotes</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_filter&quot;</span><span class="p">],</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_group_filter&quot;</span><span class="p">],</span>  
                           <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_policy_filter&quot;</span><span class="p">],</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_key_filter&quot;</span><span class="p">]]</span> 
               <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; user(s) returned for Resilient function &quot;</span> \
                   <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Adding new row(s) to data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; for &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; user(s).&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;AWS IAM Users&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;aws_iam_users&quot;</span><span class="p">)</span>
            <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">DATA_TBL_FIELDS</span><span class="p">:</span>
                <span class="n">newrow</span><span class="o">.</span><span class="n">Status</span> <span class="o">=</span> <span class="s2">&quot;Active&quot;</span>
                <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">unicode</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> \
                            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">long</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="s2">&quot;DefaultUser&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">]:</span>
                            <span class="k">pass</span>
                        <span class="k">else</span><span class="p">:</span>
                          <span class="n">newrow</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="s2">&quot;AccessKeyIds&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">process_access_key_ids</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">newrow</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">f</span> <span class="o">==</span> <span class="s2">&quot;Policies&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">process_policies</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">newrow</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">f</span> <span class="o">==</span> <span class="s2">&quot;Groups&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">process_groups</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">newrow</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">f</span> <span class="o">==</span> <span class="s2">&quot;Tags&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">process_tags</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">],</span> <span class="n">newrow</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">newrow</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">f</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;no&lt;/b&gt; results returned for Resilient function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filters</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Query Filters:&lt;/br&gt;&quot;</span>
        <span class="k">if</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_iam_user_filter&quot;</span><span class="p">):</span> 
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;aws_iam_user_filter: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_filter&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_iam_group_filter&quot;</span><span class="p">):</span> 
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;aws_iam_group_filter: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_group_filter&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_iam_policy_filter&quot;</span><span class="p">):</span> 
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;aws_iam_policy_filter: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_policy_filter&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_iam_access_key_filter&quot;</span><span class="p">):</span>   
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;aws_iam_access_key_filter: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_key_filter&quot;</span><span class="p">])</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Access</span> <span class="pre">keys</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_filter (optional) is mapped to an activity field input. Note: Input should be a valid regular expression.</p></li>
<li><p>aws_iam_access_key_filter (optional) is mapped to an activity field input. Note: Input should be a valid regular expression.</p></li>
<li><p>aws_iam_query_type is set to value <code class="docutils literal notranslate"><span class="pre">access_keys</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the incident rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Access</span> <span class="pre">keys</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Access</span> <span class="pre">keys</span></code> from Actions.</p>
<p><img alt="screenshot: fn-aws-iam-list-keys-action " src="../_images/fn-aws-iam-list-keys-action.png" /></p>
</li>
<li><p>The user is presented with a list of input fields which can be used to filter users using regular expressions. Set any desired filters.</p>
<p><img alt="screenshot: fn-aws-iam-list-keys-action_2 " src="../_images/fn-aws-iam-list-keys-action_2.png" /></p>
</li>
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Access</span> <span class="pre">keys</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Users</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> is updated in the Resilient platform with the users’ properties for the selected AWS account.</p>
<p><img alt="screenshot: fn-aws-iam-list-keys-datatable" src="../_images/fn-aws-iam-list-keys-datatable.png" /></p>
<p>Note: If all unfiltered access keys are listed, the key for the default user for the integration is indicated by “Yes” in the “Default key” field.</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_key_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users or access keys based on access keys applied to user. Filter by access key ID. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_group_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users based on group membership. Filter by group name. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_policy_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users based on policies applied to user. Filter by policy name. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_query_type</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Type of query to perform for list_users, can be one of ‘users’ or ‘access_keys’. Optional parameter.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_filter</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Filter users or access keys based on user name. Can be a string or regular expression.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span>  <span class="p">{</span>
            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">,</span> <span class="s1">&#39;UserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:user/iam_test_User&#39;</span><span class="p">,</span> <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-05 15:54:43&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User_2&#39;</span><span class="p">,</span> <span class="s1">&#39;UserId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:user/iam_test_User_2&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-10-31 16:23:07&#39;</span><span class="p">,</span> <span class="s1">&#39;PasswordLastUsed&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-12 10:55:42&#39;</span><span class="p">}</span>
                       <span class="p">],</span>
            <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;Path&quot;: &quot;/&quot;, &quot;UserName&quot;: &quot;iam_test_User&quot;, &quot;UserId&quot;: &quot;ABCDEFGH&quot;, &quot;Arn&quot;: &quot;arn:aws:iam::123456789123:user/iam_test_User&quot;, &quot;CreateDate&quot;: &quot;2019-11-05 15:54:43&quot;}, {&quot;Path&quot;: &quot;/&quot;, &quot;UserName&quot;: &quot;iam_test_User_2&quot;, &quot;UserId&quot;: &quot;ABCDEFGH&quot;, &quot;Arn&quot;: &quot;arn:aws:iam::123456789123:user/iam_test_User_2&quot;, &quot;CreateDate&quot;: &quot;2019-10-31 16:23:07&quot;}]&#39;</span><span class="p">,</span>
            <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">7951</span><span class="p">,</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-14 13:48:30&#39;</span>
                       <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_access_key_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_access_key_filter</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_filter</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_user_filter</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_query_type</span> <span class="o">=</span> <span class="s2">&quot;access_keys&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_users script ##</span>
<span class="c1">#  Globals</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_users script main</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;query_execution_time&quot;</span><span class="p">,</span> <span class="s2">&quot;UserName&quot;</span><span class="p">,</span> <span class="s2">&quot;AccessKeyId&quot;</span><span class="p">,</span> <span class="s2">&quot;CreateDate&quot;</span><span class="p">,</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="s2">&quot;DefaultKey&quot;</span><span class="p">]</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_users script last used access keys.</span>
<span class="n">DATA_TBL_FIELDS_LUAK</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LastUsedDate&quot;</span><span class="p">,</span> <span class="s2">&quot;ServiceName&quot;</span><span class="p">,</span> <span class="s2">&quot;Region&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_users&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;List Access Keys&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_access_keys</span><span class="p">(</span><span class="n">access_key_id_list</span><span class="p">,</span> <span class="n">user_name</span><span class="p">):</span>
    <span class="n">access_key_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ak_id</span> <span class="ow">in</span> <span class="n">access_key_id_list</span><span class="p">:</span>
        <span class="n">newrow</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;aws_iam_access_keys&quot;</span><span class="p">)</span>
        <span class="n">newrow</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">QUERY_EXECUTION_DATE</span>
        <span class="n">newrow</span><span class="o">.</span><span class="n">UserName</span> <span class="o">=</span> <span class="n">user_name</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">DATA_TBL_FIELDS</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">ak_id</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">newrow</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">ak_id</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
        <span class="c1"># Add key last used data if it exists.</span>
        <span class="k">if</span> <span class="n">ak_id</span><span class="p">[</span><span class="s2">&quot;key_last_used&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">luak</span> <span class="o">=</span> <span class="n">ak_id</span><span class="p">[</span><span class="s2">&quot;key_last_used&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">DATA_TBL_FIELDS_LUAK</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">luak</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">newrow</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">luak</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_filter&quot;</span><span class="p">],</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_group_filter&quot;</span><span class="p">],</span>
                           <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_policy_filter&quot;</span><span class="p">],</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_key_filter&quot;</span><span class="p">]]</span>
               <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">key_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
           <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span>  <span class="n">u</span><span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">]:</span>
                    <span class="n">key_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; access keys(s) returned for Resilient function &quot;</span> \
                   <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">key_count</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Adding new rows to data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; for &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; access keys(s).&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;AWS IAM Access Keys&quot;</span><span class="p">,</span> <span class="n">key_count</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
           <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">]:</span>
                <span class="n">user_name</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;UserName&quot;</span><span class="p">]</span>
                <span class="n">process_access_keys</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">],</span> <span class="n">user_name</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;no&lt;/b&gt; results returned for Resilient function &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filters</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Query Filters:&lt;/br&gt;&quot;</span>
        <span class="k">if</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_iam_user_filter&quot;</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;aws_iam_user_filter: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_filter&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">INPUTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_iam_access_key_filter&quot;</span><span class="p">):</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;&lt;br&gt;aws_iam_access_key_filter: &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;&lt;/br&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_key_filter&quot;</span><span class="p">])</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-user">
<h2>Function - AWS IAM: Delete User<a class="headerlink" href="#function-aws-iam-delete-user" title="Link to this heading">¶</a></h2>
<p>Delete the specified IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>When deleting an IAM user programmatically, the workflow deletes or removes the following items attached to the user:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Password
Access keys
Inline policies
Attached managed policies
Group memberships
Signing certificates
SSH public keys
Service specific credentials
Deactivate Multi-factor authentication (MFA) devices
Delete virtual MFA Devices
</pre></div>
</div>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>Both of the example workflows are multi-step functions and will attempt to remove or delete the items referenced above if associated with the user,
and then attempt to delete the user.</p>
<p>If any of the items mentioned above exist for the user, the workflow will fail.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected data table row <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or artifact.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user whose access keys are to be deleted.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-user-action " src="../_images/fn-aws-iam-delete-user-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-delete-user-action_2 " src="../_images/fn-aws-iam-delete-user-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> is refreshed in the Resilient platform with the updated access key details for the selected user. The <code class="docutils literal notranslate"><span class="pre">Status</span></code> field of the data table transitions to <code class="docutils literal notranslate"><span class="pre">Deleted</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-user-datatable" src="../_images/fn-aws-iam-delete-user-datatable.png" /></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the artifact rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the ‘Artifacts’ tab.</p></li>
<li><p>For a Resilient artifact of type, ‘AWS IAM User Name’, click Action-&gt; <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-user-artifact-action " src="../_images/fn-aws-iam-delete-user-artifact-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-delete-user-artifact-action_2 " src="../_images/fn-aws-iam-delete-user-artifact-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the artifact description is updated with details of the user deletion.</p>
<p><img alt="screenshot: fn-aws-iam-delete-user-artifact" src="../_images/fn-aws-iam-delete-user-artifact.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;OK&quot;&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">},</span> 
            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> 
                        <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">689</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-01-15 10:27:48&#39;</span>
                       <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_access_keys script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_delete_user  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_delete_user&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: User &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; was successfully deleted for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">Status</span> <span class="o">=</span> <span class="s2">&quot;Deleted&quot;</span>
            <span class="n">row</span><span class="o">.</span><span class="n">Tags</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Unexpected delete status &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for delete&quot;</span> \
                        <span class="s2">&quot; user operation &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">CONTENT</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-user-access-key-ids">
<h2>Function - AWS IAM: List User Access Key IDs<a class="headerlink" href="#function-aws-iam-list-user-access-key-ids" title="Link to this heading">¶</a></h2>
<p>Gets information about the access key IDs associated with the specified IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Get</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected data table row.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user which is to have its properties refreshed for the data table.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-list-user-access-key-ids-action " src="../_images/fn-aws-iam-list-user-access-key-ids-action.png" /></p>
</li>
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">User</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">IDs</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Access</span> <span class="pre">key</span> <span class="pre">ids</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-list-user-access-key-ids-datatable" src="../_images/fn-aws-iam-list-user-access-key-ids-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">,</span> <span class="s1">&#39;AccessKeyId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-12 11:09:38&#39;</span>
                      <span class="p">}</span>
                     <span class="p">],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;UserName&quot;: &quot;iam_test_User&quot;, &quot;AccessKeyId&quot;: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;Active&quot;, &quot;CreateDate&quot;: &quot;2019-11-12 11:09:38&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">5365</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-21 10:41:22&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_user_access_keys script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_user_access_keys script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_user_access_keys&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Refresh User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">access_key_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ak_id</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ak_id</span><span class="p">[</span><span class="s2">&quot;AccessKeyId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">access_key_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ak_id</span><span class="p">[</span><span class="s2">&quot;AccessKeyId&quot;</span><span class="p">])</span>
        <span class="n">row</span><span class="o">.</span><span class="n">AccessKeyIds</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">access_key_ids</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">row</span><span class="o">.</span><span class="n">AccessKeyIds</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-update-access-key">
<h2>Function - AWS IAM: Update Access Key<a class="headerlink" href="#function-aws-iam-update-access-key" title="Link to this heading">¶</a></h2>
<p>Change the status of an access key from Active to Inactive, or vice versa. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_access_key_id is an IAM user access key id. Parameter aws_iam_status is be set to “Active” or “Inactive” to change the status of the access key.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Deactivate</span> <span class="pre">Access</span> <span class="pre">Key</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Deactivate</span> <span class="pre">Access</span> <span class="pre">Key</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected data table row.</p></li>
<li><p>aws_iam_access_key_id = is mapped to an access key ID from the selected data table row.</p></li>
<li><p>aws_iam_status = is set to the value “Inactive”.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Deactivate</span> <span class="pre">Access</span> <span class="pre">Key</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user which is to have its properties refreshed for the data table.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Deactivate</span> <span class="pre">Access</span> <span class="pre">Key</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-update-access-key-action " src="../_images/fn-aws-iam-update-access-key-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-update-access-key-action_2 " src="../_images/fn-aws-iam-update-access-key-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Deactivate</span> <span class="pre">Access</span> <span class="pre">Key</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Update</span> <span class="pre">Access</span> <span class="pre">Key</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Status</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> data table is transitioned to <code class="docutils literal notranslate"><span class="pre">Inactive</span></code></p>
<p><img alt="screenshot: fn-aws-iam-update-access-key-datatable" src="../_images/fn-aws-iam-update-access-key-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_key_id</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_status</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">select</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_access_key_id&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;aws_iam_status&#39;</span><span class="p">:</span> <span class="s1">&#39;Inactive&#39;</span><span class="p">},</span>
           <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-19 12:53:48&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">3023</span><span class="p">},</span>
           <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
           <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span>
           <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;OK&quot;&#39;</span><span class="p">,</span>
           <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
           <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_access_key_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">AccessKeyId</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_status</span> <span class="o">=</span> <span class="s2">&quot;Inactive&quot;</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_delete_access_keys  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_update_access_key&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Deactivate Access Key&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The Access Key Id &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; was deactivated &quot;</span> \
                        <span class="sa">u</span><span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_key_id&quot;</span><span class="p">],</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span>  <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">Status</span> <span class="o">=</span> <span class="s2">&quot;Inactive&quot;</span>
        <span class="k">elif</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="sa">u</span><span class="s2">&quot;NoSuchEntity&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The Access Key Id &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Not found &quot;</span> \
                        <span class="sa">u</span><span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_key_id&quot;</span><span class="p">],</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span>  <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">Status</span> <span class="o">=</span> <span class="s2">&quot;NoSuchEntity&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were no results returned for &quot;</span> \
                     <span class="sa">u</span><span class="s2">&quot;access key id &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; access key  Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_keys&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-access-keys">
<h2>Function - AWS IAM: Delete Access Keys<a class="headerlink" href="#function-aws-iam-delete-access-keys" title="Link to this heading">¶</a></h2>
<p>Delete the access key pairs associated with the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_access_keys is a comma-separated list of IAM access key IDs.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_access_keys is mapped to all access keys for the user from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user whose access keys are to be deleted.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskeys-action " src="../_images/fn-aws-iam-delete-accesskeys-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskeys-action_2 " src="../_images/fn-aws-iam-delete-accesskeys-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Access</span> <span class="pre">key</span> <span class="pre">ids</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskeys-datatable" src="../_images/fn-aws-iam-delete-accesskeys-datatable.png" /></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>.</p></li>
<li><p>aws_iam_access_keys is mapped to the access key ID from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Keys</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> corresponding to the access key to be deleted.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskey-action " src="../_images/fn-aws-iam-delete-accesskey-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskey-action_2 " src="../_images/fn-aws-iam-delete-accesskey-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Status</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> data table is transitioned to <code class="docutils literal notranslate"><span class="pre">Deleted</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskey-datatable" src="../_images/fn-aws-iam-delete-accesskey-datatable.png" /></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name computed from a previous step in the workflow.</p></li>
<li><p>aws_iam_access_keys is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">ID</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the artifact rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the ‘Artifacts’ tab.</p></li>
<li><p>For a Resilient artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">ID</span></code>, click Action-&gt; <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskey-artifact-action " src="../_images/fn-aws-iam-delete-accesskey-artifact-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskey-artifact-action_2 " src="../_images/fn-aws-iam-delete-accesskey-artifact-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Key</span> <span class="pre">For</span> <span class="pre">Artifact</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Access</span> <span class="pre">Keys</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the artifact description is updated with details of access key deletion.</p>
<p><img alt="screenshot: fn-aws-iam-delete-accesskey-artifact" src="../_images/fn-aws-iam-delete-accesskey-artifact.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_keys</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-seperated list of AWS IAM access key names.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
           <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;AccessKeyId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}],</span>
           <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;AccessKeyId&quot;: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;OK&quot;}]&#39;</span><span class="p">,</span>
           <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User_1&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_access_keys&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">},</span>
           <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">752</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-01-16 13:47:07&#39;</span>
                      <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_access_keys</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">AccessKeyIds</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_access_keys script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_delete_access_keys  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AccessKeyIds&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_delete_access_keys&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete Access Key&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">deleted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deleted_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ak_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ak_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">deleted_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ak_stat</span><span class="p">[</span><span class="s2">&quot;AccessKeyId&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ak_stat</span><span class="p">[</span><span class="s2">&quot;AccessKeyId&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">deleted_keys</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The Access Key Id &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; was deleted &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">deleted_keys</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span>  <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Access keyId id &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; does not exist &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_such_entity_keys</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">Status</span> <span class="o">=</span> <span class="s2">&quot;Deleted&quot;</span>
        <span class="n">row</span><span class="o">.</span><span class="n">query_execution_date</span> <span class="o">=</span> <span class="n">EXECUTION_DATE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were no results returned for &quot;</span> \
        <span class="s2">&quot;access key id &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; access key  Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_access_keys&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-user-groups">
<h2>Function - AWS IAM: List User Groups<a class="headerlink" href="#function-aws-iam-list-user-groups" title="Link to this heading">¶</a></h2>
<p>Gets the IAM groups that include the specified IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Group</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">All</span> <span class="pre">Groups</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or , <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>corresponding to the user who needs to be added to a group.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-list-user-groups-action " src="../_images/fn-aws-iam-list-user-groups-action.png" /></p>
</li>
</ol>
<p>This invokes the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">User</span> <span class="pre">Groups</span></code> function.</p>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Groups</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-list-user-groups-datatable" src="../_images/fn-aws-iam-list-user-groups-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupName&#39;</span><span class="p">:</span> <span class="s1">&#39;null_group&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:group/null_group&#39;</span><span class="p">,</span> <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-12-04 12:31:47&#39;</span><span class="p">},</span> 
                      <span class="p">{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupName&#39;</span><span class="p">:</span> <span class="s1">&#39;denyall_group&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:group/denyall_group&#39;</span><span class="p">,</span> <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 15:49:34&#39;</span><span class="p">},</span> 
                      <span class="p">{</span><span class="s1">&#39;Path&#39;</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupName&#39;</span><span class="p">:</span> <span class="s1">&#39;myS3group&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;Arn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:group/myS3group&#39;</span><span class="p">,</span> <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2017-05-29 20:41:50&#39;</span><span class="p">}],</span> 
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;Path&quot;: &quot;/&quot;, &quot;GroupName&quot;: &quot;null_group&quot;, &quot;GroupId&quot;: &quot;ABCDEFGH&quot;,&#39;</span> \
                 <span class="s1">&#39;&quot;Arn&quot;: &quot;arn:aws:iam::123456789123:group/null_group&quot;, &quot;CreateDate&quot;: &quot;2019-12-04 12:31:47&quot;},&#39;</span> \ 
                 <span class="s1">&#39;&quot;Path&quot;: &quot;/&quot;, &quot;GroupName&quot;: &quot;denyall_group&quot;, &quot;GroupId&quot;: &quot;ABCDEFGH&quot;,&#39;</span> \
                 <span class="s1">&#39;&quot;Arn&quot;: &quot;arn:aws:iam::123456789123:group/denyall_group&quot;, &quot;CreateDate&quot;: &quot;2019-11-29 15:49:34&quot;},&#39;</span> \
                 <span class="s1">&#39;{&quot;Path&quot;: &quot;/&quot;, &quot;GroupName&quot;: &quot;myS3group&quot;, &quot;GroupId&quot;: &quot;ABCDEFGH&quot;,&#39;</span> \
                 <span class="s1">&#39;&quot;Arn&quot;: &quot;arn:aws:iam::123456789123:group/myS3group&quot;, &quot;CreateDate&quot;: &quot;2017-05-29 20:41:50&quot;}]&#39;</span> <span class="p">,</span> 
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user_1&#39;</span><span class="p">},</span> 
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ie.ibm.com&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">944</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-03-16 15:43:21&#39;</span>
                    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_user_groups script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_user_groups script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Groups&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_user_groups&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Refresh User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="n">row</span><span class="o">.</span><span class="n">Groups</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">row</span><span class="o">.</span><span class="n">Groups</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-add-user-to-groups">
<h2>Function - AWS IAM: Add User To Groups<a class="headerlink" href="#function-aws-iam-add-user-to-groups" title="Link to this heading">¶</a></h2>
<p>Adds the specified IAM user to the specified groups. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_group_names is a comma-separated list of IAM group names.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Group</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Group</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_group_names is mapped to an activity field, which is a drop-down list of group names.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Group</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>corresponding to the user who needs to be added to a group.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Group</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-add-user-to-groups-action " src="../_images/fn-aws-iam-add-user-to-groups-action.png" /></p>
</li>
<li><p>From the drop-down list of user defined groups names, select a group and click Execute.</p>
<p><img alt="screenshot: fn-aws-iam-add-user-to-groups_2-action " src="../_images/fn-aws-iam-add-user-to-groups_2-action.png" /></p>
</li>
</ol>
<p>This invokes the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Group</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Add</span> <span class="pre">User</span> <span class="pre">To</span> <span class="pre">Groups</span></code> function.</p>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Groups</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-add-user-to-groups-datatable" src="../_images/fn-aws-iam-add-user-to-groups-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_group_names</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-separated list of AWS IAM group names.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;GroupName&#39;</span><span class="p">:</span> <span class="s1">&#39;denyall_group&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}],</span> 
         <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;GroupName&quot;: &quot;denyall_group&quot;, &quot;Status&quot;: &quot;OK&quot;}]&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user_1&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_group_names&#39;</span><span class="p">:</span> <span class="s1">&#39;denyall_group&#39;</span><span class="p">},</span> 
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">4303</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-03-16 15:43:17&#39;</span>
           
                    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_group_names</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_group</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_add_user_to_groups script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_add_user_to_groups  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Groups&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_add_user_to_groups&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Add User To Group&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">added</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">added_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">grp_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">added</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">added_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">added_groups</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: User &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; added to group &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">added_groups</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Refreshing data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; row for user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with updated group data.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;AWS IAM Users&quot;</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The group(s) &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;did not exist for user &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_groups</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-remove-user-from-groups">
<h2>Function - AWS IAM: Remove User From Groups<a class="headerlink" href="#function-aws-iam-remove-user-from-groups" title="Link to this heading">¶</a></h2>
<p>Removes the specified IAM user from the specified groups. Group names is a comma-separated string of group names. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_group_names is  a comma-separated list of IAM group names.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">All</span> <span class="pre">Groups</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">All</span> <span class="pre">Groups</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_group_names is mapped to all group names from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">All</span> <span class="pre">Groups</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>corresponding to the user who needs to be removed from all groups.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">All</span> <span class="pre">Groups</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-remove-user-from-groups-action " src="../_images/fn-aws-iam-remove-user-from-groups-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-remove-user-from-groups-action_2 " src="../_images/fn-aws-iam-remove-user-from-groups-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">All</span> <span class="pre">Groups</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Remove</span> <span class="pre">User</span> <span class="pre">From</span> <span class="pre">Groups</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Groups</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated to an empty value for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-remove-user-from-groups-datatable" src="../_images/fn-aws-iam-remove-user-from-groups-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_group_names</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-separated list of AWS IAM group names.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;PolicyArn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">},</span>
                      <span class="p">{</span><span class="s1">&#39;PolicyArn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll_2&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;PolicyArn&quot;: &quot;arn:aws:iam::aws:policy/AWSDenyAll&quot;, &quot;Status&quot;: &quot;OK&quot;},&#39;</span> \
                  <span class="s1">&#39;{&quot;PolicyArn&quot;: &quot;arn:aws:iam::aws:policy/AWSDenyAll_2&quot;, &quot;Status&quot;: &quot;OK&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_arns&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User_1&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_group_names</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Groups</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_detach_user_policies script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_detach_user_policies  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_remove_user_from_groups&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Remove User From All Groups&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">added</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">added_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pol_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">added</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">added_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">added_groups</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; was removed from the &quot;</span> \
                        <span class="s2">&quot;following groups &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">added_groups</span><span class="p">),</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Groups &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_groups</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_groups</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-user-policies">
<h2>Function - AWS IAM: List User Policies<a class="headerlink" href="#function-aws-iam-list-user-policies" title="Link to this heading">¶</a></h2>
<p>Gets all managed policies and in-line policies that are attached to the specified IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">Policy</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Get</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">All</span> <span class="pre">User</span> <span class="pre">Policies</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> and <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user who needs to have a policy attached.</p></li>
<li><p>From the selected rows action menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-list-user-policies-action " src="../_images/fn-aws-iam-list-user-policies-action.png" /></p>
</li>
</ol>
<p>This invokes the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Refresh</span> <span class="pre">User</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">User</span> <span class="pre">Policies</span></code> function.</p>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Policies</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-list-user-policies-datatable" src="../_images/fn-aws-iam-list-user-policies-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;PolicyName&#39;</span><span class="p">:</span> <span class="s1">&#39;test_pol&#39;</span><span class="p">},</span>
                      <span class="p">{</span><span class="s1">&#39;PolicyName&#39;</span><span class="p">:</span> <span class="s1">&#39;test_pol_2&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;PolicyArn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:policy/test_pol_2&#39;</span><span class="p">},</span>
                      <span class="p">{</span><span class="s1">&#39;PolicyName&#39;</span><span class="p">:</span> <span class="s1">&#39;AmazonRoute53ReadOnlyAccess&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;PolicyArn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AmazonRoute53ReadOnlyAccess&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;PolicyName&quot;: &quot;test_pol&quot;}, {&quot;PolicyName&quot;: &quot;test_pol_2&quot;, &quot;PolicyArn&quot;:&#39;</span>\
                 <span class="s1">&#39;&quot;arn:aws:iam::123456789123:policy/test_pol_2&quot;}, {&quot;PolicyName&quot;: &#39;</span>\
                 <span class="s1">&#39;&quot;AmazonRoute53ReadOnlyAccess&quot;, &quot;PolicyArn&quot;: &quot;arn:aws:iam::aws:policy/AmazonRoute53ReadOnlyAccess&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">87423</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-21 11:55:29&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_user_policies script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_user_groups script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_user_policies&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Refresh User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">policy_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pol</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span>  <span class="n">pol</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">policy_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">pol</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">])</span>
        <span class="n">row</span><span class="o">.</span><span class="n">Policies</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">policy_names</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">row</span><span class="o">.</span><span class="n">Policies</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-attach-user-policies">
<h2>Function - AWS IAM: Attach User policies<a class="headerlink" href="#function-aws-iam-attach-user-policies" title="Link to this heading">¶</a></h2>
<p>Attaches the specified managed policies to the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_policy_names (optional) is a comma-separated  list of IAM policy names. Parameter (optional) aws_iam_arns is a comma-separated list of IAM policy arns.</p>
<p>Note: One of parameters, aws_iam_policy_names or aws_iam_arns, is required to be set.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">Policy</span></code></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">Policy</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_policy_names is mapped to activity field <code class="docutils literal notranslate"><span class="pre">aws_iam_policy_name</span></code> which should be a drop-down list of policy names.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">Policy</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user who needs to have a policy attached.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">Policy</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-attach-user-policies-action " src="../_images/fn-aws-iam-attach-user-policies-action.png" /></p>
</li>
<li><p>From the drop-down list of user defined policy names, select a policy and click Execute.</p>
<p><img alt="screenshot: fn-aws-iam-attach-user-policies_2-action " src="../_images/fn-aws-iam-attach-user-policies_2-action.png" /></p>
</li>
</ol>
<p>This invokes the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">Policy</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Attach</span> <span class="pre">User</span> <span class="pre">policies</span></code> function.</p>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Policies</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-attach-user-policies-datatable" src="../_images/fn-aws-iam-attach-user-policies-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_arns</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-separated list of AWS IAM Amazon Resource Names (ARNs).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_policy_names</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-separated list of AWS IAM policy names.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note: At least One of the parameters <code class="docutils literal notranslate"><span class="pre">aws_iam_arns</span></code> or <code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code> must be set.</p>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;PolicyArn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">},</span>
                      <span class="p">{</span><span class="s1">&#39;PolicyArn&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll_2&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;NoSuchEntity&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;PolicyArn&quot;: &quot;arn:aws:iam::aws:policy/AWSDenyAll&quot;, &quot;Status&quot;: &quot;OK&quot;}, &#39;</span>\
                 <span class="s1">&#39;{&quot;PolicyArn&quot;: &quot;arn:aws:iam::aws:policy/AWSDenyAll_2&quot;, &quot;Status&quot;: &quot;NoSuchEntity&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_arns&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User_1&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_policy_names</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_policy_name</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_attach_user_policies script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_attach_user_policies  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_attach_user_policies&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Attach User Policy&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">added</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">added_policies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_policies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pol_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">added</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">added_policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">added_policies</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The Policy &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; was attached to user &quot;</span> \
                        <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">added_policies</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br&gt;Refreshing data table &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt; row for user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; with updated policy data.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;AWS IAM Users&quot;</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Policies &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_policies</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_policies</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-detach-user-policies">
<h2>Function - AWS IAM: Detach User policies<a class="headerlink" href="#function-aws-iam-detach-user-policies" title="Link to this heading">¶</a></h2>
<p>Removes the specified managed policy from the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_policy_names (optional) is  a comma-separated  list of IAM policy names. Parameter (optional) aws_iam_arns is a comma-separated list of IAM policy arns.</p>
<p>Note: A user can have embedded inline policies, which the function also deletes. One of the parameters, aws_iam_policy_names or aws_iam_arns, is
required to be set.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">All</span> <span class="pre">User</span> <span class="pre">Policies</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">All</span> <span class="pre">User</span> <span class="pre">Policies</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_policy_names is mapped to all policy names for the user from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">All</span> <span class="pre">User</span> <span class="pre">Policies</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user who needs to have all polices removed or deleted.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">All</span> <span class="pre">User</span> <span class="pre">Policies</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-detach-user-policies-action " src="../_images/fn-aws-iam-detach-user-policies-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-detach-user-policies-action_2 " src="../_images/fn-aws-iam-detach-user-policies-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">All</span> <span class="pre">User</span> <span class="pre">Policies</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Detach</span> <span class="pre">User</span> <span class="pre">policies</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Policies</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated to an empty value for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-detach-user-policies-datatable" src="../_images/fn-aws-iam-detach-user-policies-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_arns</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-separated list of AWS IAM Amazon Resource Names (ARNs).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_policy_names</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma-separated list of AWS IAM policy names.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note: At least One of the parameters <code class="docutils literal notranslate"><span class="pre">aws_iam_arns</span></code> or <code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code> must be set.</p>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;PolicyName&#39;</span><span class="p">:</span> <span class="s1">&#39;AWSDenyAll&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">},</span>
                      <span class="p">{</span><span class="s1">&#39;PolicyName&#39;</span><span class="p">:</span> <span class="s1">&#39;AWSDenyAll_2&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;NoSuchEntity&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;PolicyName&quot;: &quot;AWSDenyAll&quot;, &quot;Status&quot;: &quot;OK&quot;},{&quot;PolicyName&quot;: &quot;AWSDenyAll_2&quot;, &quot;Status&quot;: &quot;NoSuchEntity&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_arns&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::aws:policy/AWSDenyAll&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User_1&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_policy_names</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">Policies</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_detach_user_policies script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_detach_user_policies  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_detach_user_policies&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Detach All User Policies&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">added</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">detached_policies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_policies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pol_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">added</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">detached_policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_policies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pol_stat</span><span class="p">[</span><span class="s2">&quot;PolicyName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">detached_policies</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: The Policies &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; were detached and/or deleted &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">detached_policies</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; Policies &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_policies</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_policies</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-ssh-public-keys">
<h2>Function - AWS IAM: List SSH Public Keys<a class="headerlink" href="#function-aws-iam-list-ssh-public-keys" title="Link to this heading">¶</a></h2>
<p>List the SSH public keys associated with an IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;SSHPublicKeyId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;UploadDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-25 11:05:17&#39;</span>
                      <span class="p">}</span>
                     <span class="p">],</span> 
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;UserName&quot;: &quot;iam_test_user_10&quot;, &quot;SSHPublicKeyId&quot;: &quot;ABCDEFGH&quot;, &#39;</span>\
                 <span class="s1">&#39;&quot;Status&quot;: &quot;Active&quot;, &quot;UploadDate&quot;: &quot;2020-02-25 11:05:17&quot;}]&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">},</span> 
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">657</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-25 16:11:28&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_ssh_public_keys script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_ssh_public_keys script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SSHPublicKeyIds&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_ssh_public_keys&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">DEBUG_SCRIPT</span><span class="o">=</span><span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;SSH Public keys&#39; returned for user &quot;</span> \
                    <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="n">access_key_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sshk_id</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sshk_id</span><span class="p">[</span><span class="s2">&quot;SSHPublicKeyId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;has_ssh_public_keys&quot;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; &#39;SSH Public keys&#39; result(s) returned for &quot;</span> \
                    <span class="s2">&quot;user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
  </p>
  </details>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-ssh-public-keys">
<h2>Function - AWS IAM: Delete SSH Public Keys<a class="headerlink" href="#function-aws-iam-delete-ssh-public-keys" title="Link to this heading">¶</a></h2>
<p>Delete Secure Shell (SSH) public keys associated with the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_ssh_key_ids is a comma-separated list of SSH public key IDs.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_ssh_key_ids is mapped to SSH key IDs retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">SSH</span> <span class="pre">Public</span> <span class="pre">Keys</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
<li><p>aws_iam_ssh_key_ids is mapped to SSH key IDs retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">SSH</span> <span class="pre">Public</span> <span class="pre">Keys</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_ssh_key_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;SSHPublicKeyId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}</span>
                      <span class="p">{</span><span class="s1">&#39;SSHPublicKeyId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;NoSuchEntity&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;SSHPublicKeyId&quot;: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;OK&quot;},&#39;</span>\
                  <span class="s1">&#39;{&quot;SSHPublicKeyId&quot;: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;NoSuchEntity&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_ssh_keys_ids&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">list_ssh_keys_results</span><span class="o">.</span><span class="n">content</span>
<span class="n">ssh_key_ids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ssh_key_id</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">ssh_key_id</span><span class="p">[</span><span class="s2">&quot;SSHPublicKeyId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ssh_key_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssh_key_id</span><span class="p">[</span><span class="s2">&quot;SSHPublicKeyId&quot;</span><span class="p">])</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_ssh_key_ids</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ssh_key_ids</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_ssh_keys script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_delete_ssh_keys  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_delete_ssh_keys&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DEBUG_SCRIPT</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">deleted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deleted_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">grp_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">deleted_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">deleted_keys</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;SSH Public keys&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; removed &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">deleted_keys</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">deleted_keys</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;SSH Public keys&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_keys</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_keys</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
  </p>
  </details>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-service-specific-credentials">
<h2>Function - AWS IAM: List Service Specific Credentials<a class="headerlink" href="#function-aws-iam-list-service-specific-credentials" title="Link to this heading">¶</a></h2>
<p>List the service-specific credentials associated with an IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;ServiceUserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user-at-123456789123&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-25 10:43:24&#39;</span><span class="p">,</span> <span class="s1">&#39;ServiceSpecificCredentialId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;ServiceName&#39;</span><span class="p">:</span> <span class="s1">&#39;codecommit.amazonaws.com&#39;</span>
                     <span class="p">},</span>
                     <span class="p">{</span><span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;ServiceUserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user_10-at-123456789123&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;CreateDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-26 11:50:52&#39;</span><span class="p">,</span> <span class="s1">&#39;ServiceSpecificCredentialId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;ServiceName&#39;</span><span class="p">:</span> <span class="s1">&#39;cassandra.amazonaws.com&#39;</span><span class="p">}],</span> 
         <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;UserName&quot;: &quot;iam_test_user&quot;, &quot;Status&quot;: &quot;Active&quot;, &quot;ServiceUserName&quot;: &quot;iam_test_user_10-at-123456789123&quot;,&#39;</span>\ 
                   <span class="s1">&#39;&quot;CreateDate&quot;: &quot;2020-02-25 10:43:24&quot;, &quot;ServiceSpecificCredentialId&quot;: &quot;ABCDEFGH&quot;, &#39;</span>\
                   <span class="s1">&#39;&quot;ServiceName&quot;: &quot;codecommit.amazonaws.com&quot;},{&quot;UserName&quot;: &quot;iam_test_user_10&quot;, &quot;Status&quot;: &quot;Active&quot;, &#39;</span>\
                   <span class="s1">&#39;&quot;ServiceUserName&quot;: &quot;iam_test_user_10-at-123456789123&quot;, &quot;CreateDate&quot;: &quot;2020-02-26 11:50:52&quot;, &#39;</span>\
                   <span class="s1">&#39;&quot;ServiceSpecificCredentialId&quot;: &quot;ABCDEFGH&quot;, &quot;ServiceName&quot;: &quot;cassandra.amazonaws.com&quot;}]&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">},</span> 
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">982</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-26 11:56:51&#39;</span>
                    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="c1">##  AWS IAM - fn_aws_iam_list_service_specific_credentials script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_service_specific_credentials script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ServiceSpecificCredentialIds&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_service_specific_credentials&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">DEBUG_SCRIPT</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Service specific credentials&#39; returned for user &quot;</span> \
                    <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ssc_id</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ssc_id</span><span class="p">[</span><span class="s2">&quot;ServiceSpecificCredentialId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;has_srv_creds&quot;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; &#39;Service specific credentials&#39; result(s) returned for &quot;</span> \
                    <span class="s2">&quot;user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-service-specific-credentials">
<h2>Function - AWS IAM: Delete Service Specific Credentials<a class="headerlink" href="#function-aws-iam-delete-service-specific-credentials" title="Link to this heading">¶</a></h2>
<p>Delete service-specific credentials associated with the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_ssc_ids is a comma-separated list of service-specific credential ids.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_ssc_ids is mapped to service specific credential IDs retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Service</span> <span class="pre">Specific</span> <span class="pre">Credentials</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
<li><p>aws_iam_ssc_ids is mapped to service specific credential IDs retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Service</span> <span class="pre">Specific</span> <span class="pre">Credentials</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_ssc_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;ServiceSpecificCredentialId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}</span>
                      <span class="p">{</span><span class="s1">&#39;ServiceSpecificCredentialId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;NoSuchEntity&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;ServiceSpecificCredentialId: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;OK&quot;},&#39;</span>\
                 <span class="s1">&#39;{&quot;ServiceSpecificCredentialId&quot;: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;NoSuchEntity&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_ssc_ids&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">list_srv_specific_creds_results</span><span class="o">.</span><span class="n">content</span>
<span class="n">srv_specific_cred_ids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ssc_id</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">ssc_id</span><span class="p">[</span><span class="s2">&quot;ServiceSpecificCredentialId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">srv_specific_cred_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssc_id</span><span class="p">[</span><span class="s2">&quot;ServiceSpecificCredentialId&quot;</span><span class="p">])</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_ssc_ids</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srv_specific_cred_ids</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_ss_creds script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_delete_ss_creds  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_delete_ss_creds&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DEBUG_SCRIPT</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">deleted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deleted_creds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_creds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">grp_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">deleted_creds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_creds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">deleted_creds</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Service specific credentials&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; removed &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">deleted_creds</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">deleted_creds</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Service specific credentials&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_creds</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_creds</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-signing-certificates">
<h2>Function - AWS IAM: List Signing Certificates<a class="headerlink" href="#function-aws-iam-list-signing-certificates" title="Link to this heading">¶</a></h2>
<p>List the signing certificates associated with an IAM user. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;CertificateId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;CertificateBody&#39;</span><span class="p">:</span> <span class="s1">&#39;-----BEGIN CERTIFICATE-----</span><span class="se">\n</span><span class="s1">MIID...Apg=</span><span class="se">\n</span><span class="s1">-----END CERTIFICATE-----&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;UploadDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-26 12:25:27&#39;</span><span class="p">}],</span> 
         <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;UserName&quot;: &quot;iam_test_user&quot;, &quot;CertificateId&quot;: &quot;ABCDEFGH&quot;, &quot;CertificateBody&quot;:&#39;</span>
                 <span class="s1">&#39;&quot;-----BEGIN CERTIFICATE-----</span><span class="se">\\</span><span class="s1">nMIID...Apg=</span><span class="se">\\</span><span class="s1">n-----END CERTIFICATE-----&quot;, &quot;Status&quot;: &quot;Active&quot;,&#39;</span>
                 <span class="s1">&#39;&quot;UploadDate&quot;: &quot;2020-02-26 12:25:27&quot;}]&#39;</span><span class="p">,</span>
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">},</span> 
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">729</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-26 12:33:57&#39;</span>
                    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="c1">##  AWS IAM - fn_aws_iam_list_signing_certificates script ##</span>
<span class="c1"># Example result:</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Result: {&#39;version&#39;: &#39;1.0&#39;, &#39;success&#39;: True, &#39;reason&#39;: None, </span>
<span class="sd">         &#39;content&#39;: [{&#39;UserName&#39;: &#39;iam_test_user&#39;, &#39;CertificateId&#39;: &#39;ABCDEFGH&#39;, </span>
<span class="sd">                      &#39;CertificateBody&#39;: &#39;-----BEGIN CERTIFICATE-----\nMIID...Apg=\n-----END CERTIFICATE-----&#39;, </span>
<span class="sd">                      &#39;Status&#39;: &#39;Active&#39;, &#39;UploadDate&#39;: &#39;2020-02-26 12:25:27&#39;}], </span>
<span class="sd">         &#39;raw&#39;: &#39;[{&quot;UserName&quot;: &quot;iam_test_user&quot;, &quot;CertificateId&quot;: &quot;ABCDEFGH&quot;, &quot;CertificateBody&quot;: </span>
<span class="sd">                 &quot;-----BEGIN CERTIFICATE-----\\nMIID...Apg=\\n-----END CERTIFICATE-----&quot;, &quot;Status&quot;: &quot;Active&quot;, &quot;UploadDate&quot;: &quot;2020-02-26 12:25:27&quot;}]&#39;, </span>
<span class="sd">         &#39;inputs&#39;: {&#39;aws_iam_user_name&#39;: &#39;iam_test_user&#39;}, </span>
<span class="sd">         &#39;metrics&#39;: {&#39;version&#39;: &#39;1.0&#39;, &#39;package&#39;: &#39;fn-aws-iam&#39;, &#39;package_version&#39;: &#39;1.0.0&#39;, &#39;host&#39;: &#39;myhost.ibm.com&#39;, </span>
<span class="sd">                     &#39;execution_time_ms&#39;: 729, &#39;timestamp&#39;: &#39;2020-02-26 12:33:57&#39;</span>
<span class="sd">        }</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_signing_certificates script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CertificateIds&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_signing_certificates&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">DEBUG_SCRIPT</span><span class="o">=</span><span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Signing Certificates&#39; returned for user &quot;</span> \
                    <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">scert_id</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scert_id</span><span class="p">[</span><span class="s2">&quot;CertificateId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;has_sign_certs&quot;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; &#39;Signing Certificates&#39; result(s) returned for &quot;</span> \
                    <span class="s2">&quot;user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-signing-certificates">
<h2>Function - AWS IAM: Delete Signing Certificates<a class="headerlink" href="#function-aws-iam-delete-signing-certificates" title="Link to this heading">¶</a></h2>
<p>Delete signing certificates associated with the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_sign_cert_ids is a comma-separated list of signing certificate ids.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_sign_cert_ids is mapped to signing certificate IDs retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Signing</span> <span class="pre">Certificates</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
<li><p>aws_iam_sign_cert_ids is mapped to signing certificate IDs retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">Signing</span> <span class="pre">Certificates</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_sign_cert_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;CertificateId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">},</span>
                      <span class="p">{</span><span class="s1">&#39;CertificateId&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;NoSuchEntity&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&#39;</span><span class="n">CertificateId</span><span class="s1">&#39;: &quot;ABCDEFGH&quot;, &quot;Status&quot;: &quot;OK&quot;},&#39;</span>
                  <span class="s1">&#39;{&#39;</span><span class="n">CertificateId</span><span class="s1">&#39;: &#39;</span><span class="n">ABCDEFGH</span><span class="s1">&#39;, &#39;</span><span class="n">Status</span><span class="s1">&#39;: &#39;</span><span class="n">NoSuchEntity</span><span class="s1">&#39;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_sign_cert_ids&#39;</span><span class="p">:</span> <span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">list_signing_certs_results</span><span class="o">.</span><span class="n">content</span>
<span class="n">sign_cert_ids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">scert_id</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">scert_id</span><span class="p">[</span><span class="s2">&quot;CertificateId&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sign_cert_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scert_id</span><span class="p">[</span><span class="s2">&quot;CertificateId&quot;</span><span class="p">])</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_sign_cert_ids</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sign_cert_ids</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_signing_certs script ##</span>

<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_list_signing_certs  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_signing_certs&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DEBUG_SCRIPT</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">deleted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deleted_certs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_certs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">grp_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">deleted_certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">deleted_certs</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Signing Certificates&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; removed &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">deleted_certs</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">deleted_certs</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Signing Certificates&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_certs</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_certs</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-list-mfa-devices">
<h2>Function - AWS IAM: List MFA Devices<a class="headerlink" href="#function-aws-iam-list-mfa-devices" title="Link to this heading">¶</a></h2>
<p>List the MFA devices associated with an IAM user. Also determine which of the associated MFA devices is a virtual device. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;UserName&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;SerialNumber&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:mfa/iam_test_user&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;EnableDate&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-26 16:55:05&#39;</span><span class="p">,</span> <span class="s1">&#39;is_virtual&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}],</span>
         <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;UserName&quot;: &quot;iam_test_user_10&quot;, &quot;SerialNumber&quot;: &quot;arn:aws:iam::123456789123:mfa/iam_test_user_10&quot;,&#39;</span> 
                 <span class="s1">&#39;&quot;EnableDate&quot;: &quot;2020-02-26 16:55:05&quot;, &#39;</span><span class="n">is_virtual</span><span class="s1">&#39;: True}]&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user_10&#39;</span><span class="p">},</span>
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ie.ibm.com&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">5644</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-02-26 17:37:48&#39;</span>
                    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_list_mfa_devices script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_list_mfa_devices script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SerialNumbers&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_list_mfa_devices&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">DEBUG_SCRIPT</span><span class="o">=</span><span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;Active NFA devices&#39; returned for user &quot;</span> \
                    <span class="s2">&quot;&lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mfa_ser_num</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mfa_ser_num</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;has_active_mfa&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="n">mfa_ser_num</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_virtual&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">workflow</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">&quot;is_virtual_mfa&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was &lt;b&gt;no&lt;/b&gt; &#39;Active NFA devices&#39; result(s) returned for &quot;</span> \
                    <span class="s2">&quot;user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-deactivate-mfa-devices">
<h2>Function - AWS IAM: Deactivate MFA Devices<a class="headerlink" href="#function-aws-iam-deactivate-mfa-devices" title="Link to this heading">¶</a></h2>
<p>Deactivate MFA devices and remove it from association with the user name for which it was originally enabled. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_mfa_serial_numbers is a comma-separated list of IAM MFA serial numbers or arns.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_mfa_serial_numbers is mapped to MFA serial numbers retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">MFA</span> <span class="pre">Devices</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to an artifact value for artifact of type <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">User</span> <span class="pre">Name</span></code>.</p></li>
<li><p>aws_iam_mfa_serial_numbers is mapped to MFA serial numbers retrieved from the previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">MFA</span> <span class="pre">Devices</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_mfa_serial_nums</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;SerialNumber&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:mfa/iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&quot;SerialNumber&quot;: &quot;arn:aws:iam::123456789123:mfa/iam_test_user&quot;, &quot;Status&quot;: &quot;OK&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_mfa_serial_nums&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:mfa/iam_test_user&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">list_mfa_devices_results</span><span class="o">.</span><span class="n">content</span>
<span class="n">mfa_serial_nums</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">mfa_ser_num</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">mfa_ser_num</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mfa_serial_nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mfa_ser_num</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">])</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_mfa_serial_nums</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mfa_serial_nums</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="c1">##  AWS IAM - fn_aws_iam_deactivate_mfa_devices script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_deactivate_mfa_devices  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_deactivate_mfa_devices&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DEBUG_SCRIPT</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">deactivated</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deactivated_mfas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_mfas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">grp_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">deactivated</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">deactivated_mfas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_mfas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">deactivated_mfas</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;MFA devices&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; de-activated &quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">deactivated_mfas</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">deactivated_mfas</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;MFA devices&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_mfas</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_mfas</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-virtual-mfa-devices">
<h2>Function - AWS IAM: Delete Virtual MFA Devices<a class="headerlink" href="#function-aws-iam-delete-virtual-mfa-devices" title="Link to this heading">¶</a></h2>
<p>Delete a virtual MFA device. Parameter aws_iam_mfa_serial_numbers is a comma-separated list of IAM MFA serial numbers or arns.</p>
<p>Note: You must deactivate a user’s virtual MFA device before you can delete it.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> or <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_mfa_serial_numbers is mapped to MFA serial numbers retrieved a previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">MFA</span> <span class="pre">Devices</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_mfa_serial_numbers is mapped to MFA serial numbers retrieved a previous step (c.f. <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">List</span> <span class="pre">MFA</span> <span class="pre">Devices</span></code>) in the workflow.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.
For more information on this workflow, reference section <a class="reference internal" href="#function---aws-iam-delete-user"><span class="xref myst">Function - AWS IAM: Delete User</span></a></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_mfa_serial_nums</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
          <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;SerialNumber&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:mfa/iam_test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">}],</span>
          <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;[{&#39;</span><span class="n">SerialNumber</span><span class="s1">&#39;: &quot;arn:aws:iam::123456789123:mfa/iam_test_user&quot;, &quot;Status&quot;: &quot;OK&quot;}]&#39;</span><span class="p">,</span>
          <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_mfa_serial_nums&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789123:mfa/iam_test_user&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">790</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-29 12:18:30&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">content</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">list_mfa_devices_results</span><span class="o">.</span><span class="n">content</span>
<span class="n">mfa_serial_nums</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">mfa_ser_num</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">mfa_ser_num</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mfa_ser_num</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_virtual&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">mfa_serial_nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mfa_ser_num</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">])</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_mfa_serial_nums</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mfa_serial_nums</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_mfa_devices script ##</span>
<span class="c1"># Example result:</span>

<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable for fn_aws_iam_delete_mfa_devices  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Policies&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_delete_mfa_devices&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete User&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">DEBUG_SCRIPT</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">deleted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">no_such_entity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">deleted_mfas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">no_such_entity_mfas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">grp_stat</span> <span class="ow">in</span> <span class="n">CONTENT</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;Status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
                <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">deleted_mfas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_such_entity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">no_such_entity_mfas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp_stat</span><span class="p">[</span><span class="s2">&quot;GroupName&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">deleted_mfas</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;MFA devices&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; deleted&quot;</span> \
                        <span class="s2">&quot;for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">deleted_mfas</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">deleted_mfas</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">no_such_entity</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There were &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; &#39;MFA devices&#39; &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt; &quot;</span> \
                        <span class="s2">&quot;which did not exist for user &lt;b&gt;</span><span class="si">{3}</span><span class="s2">&lt;/b&gt; for Resilient function &lt;b&gt;</span><span class="si">{4}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_such_entity_mfas</span><span class="p">),</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">no_such_entity_mfas</span><span class="p">),</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DEBUG_SCRIPT</span><span class="p">:</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
 </p>
 </details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-update-login-profile">
<h2>Function - AWS IAM: Update Login Profile<a class="headerlink" href="#function-aws-iam-update-login-profile" title="Link to this heading">¶</a></h2>
<p>Changes the password for the specified IAM user. Parameter aws_iam_user_name is an IAM user name. Parameter aws_iam_password is a new password value for an IAM user. Parameter aws_iam_password_reset_required is a boolean value to determine whether a password reset should be required on change.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Change</span> <span class="pre">Profile</span> <span class="pre">Password</span></code></p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Change</span> <span class="pre">Profile</span> <span class="pre">Password</span></code>, sets the following input fields for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
<li><p>aws_iam_password is mapped to an activity field input.</p></li>
<li><p>aws_iam_password_reset_required is mapped to a boolean from an activity field drop-down list.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Change</span> <span class="pre">Profile</span> <span class="pre">Password</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user who needs to have a profile password updated.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Change</span> <span class="pre">Profile</span> <span class="pre">Password</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-update-login-profile-action " src="../_images/fn-aws-iam-update-login-profile-action.png" /></p>
</li>
<li><p>The user is presented with 2 activity fields for a new password a password confirmation and a boolean to indicate if password reset is needed.
Set the appropriate values for the fields and click Execute.</p>
<p><img alt="screenshot: fn-aws-iam-update-login-profile_2-action " src="../_images/fn-aws-iam-update-login-profile_2-action.png" /></p>
</li>
</ol>
<p>Note: The minimum reqirements for a new password is at &gt; 8 characters, at least 1 uppercase and 1 lowercase ascii character.</p>
<p>This invokes the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Change</span> <span class="pre">Profile</span> <span class="pre">Password</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Update</span> <span class="pre">Login</span> <span class="pre">Profile</span></code> function.</p>
<p>On successful completion of the workflow, a note is created indicting the status of the action.</p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_password</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>AWS IAM password for user login profile.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_password_reset_required</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>A password reset required on password change.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;OK&quot;&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_user_1&#39;</span><span class="p">,</span> <span class="s1">&#39;aws_iam_password&#39;</span><span class="p">:</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;aws_iam_password_reset_required&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> 
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ibm.com&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">4300</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-03-13 17:35:48&#39;</span>
                    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
<span class="c1"># Test password to see it complies with basic password policy.</span>
<span class="n">err_msg_validation</span> <span class="o">=</span> <span class="s2">&quot;The new password needs be minimum 8 characters in length and have at least 1 uppercase and 1 lowercase character.&quot;</span>
<span class="n">err_msg_ascii</span> <span class="o">=</span> <span class="s2">&quot;The new password must contain only printable ASCII characters.&quot;</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg_validation</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_password</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg_validation</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">islower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_password</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg_validation</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_password</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err_msg_ascii</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_password</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_password</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_password_reset_required</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">aws_iam_password_reset_required</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
    <span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_password_reset_required</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_login_profile script ##</span>

<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_update_login_profile  script</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_update_login_profile&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Change Profile Password&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Login profile password was updated for user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;PasswordPolicyViolation&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Login profile password got policy violation ERROR updating user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;ValidationError&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Login profile password got validation ERROR updating user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Login profile password got unexpected ERROR updating user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-aws-iam-delete-login-profile">
<h2>Function - AWS IAM: Delete Login Profile<a class="headerlink" href="#function-aws-iam-delete-login-profile" title="Link to this heading">¶</a></h2>
<p>Deletes the password for the specified IAM user, which terminates the user’s ability to access AWS services through the AWS Management Console. Parameter aws_iam_user_name is an IAM user name.</p>
<p>Example workflows that use this Resilient function include <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code>, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span></code> and <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">User</span> <span class="pre">For</span> <span class="pre">Artifact</span></code>.</p>
<p>The workflow, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code>, sets the following input field for the function:</p>
<ul class="simple">
<li><p>aws_iam_user_name is mapped to a user name from the selected row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code>.</p></li>
</ul>
<p>The workflow is initiated by the data table rule, <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code>.</p>
<ol class="arabic">
<li><p>Open an incident and select the row of data table <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> corresponding to the user whose login profile is to be deleted.</p></li>
<li><p>From the selected row’s actions menu, select <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code>.</p>
<p><img alt="screenshot: fn-aws-iam-delete-login-profile-action " src="../_images/fn-aws-iam-delete-login-profile-action.png" /></p>
</li>
</ol>
<p>The user is presented with a warning and an option to Execute or Cancel.</p>
<p><img alt="screenshot: fn-aws-iam-delete-login-profile-action_2 " src="../_images/fn-aws-iam-delete-login-profile-action_2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Press Execute to invoke the <code class="docutils literal notranslate"><span class="pre">Example:</span> <span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code> workflow, which calls the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM:</span> <span class="pre">Delete</span> <span class="pre">Login</span> <span class="pre">Profile</span></code> function.</p></li>
</ol>
<p>On successful completion of the workflow, the <code class="docutils literal notranslate"><span class="pre">Login</span> <span class="pre">Profile</span> <span class="pre">exists</span></code> field of the <code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">Users</span></code> data table is updated to “No” for the selected user.</p>
<p><img alt="screenshot: fn-aws-iam-delete-login-profile-datatable" src="../_images/fn-aws-iam-delete-login-profile-datatable.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">IAM</span> <span class="pre">user</span> <span class="pre">name</span></code></p></td>
<td><p>AWS IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
         <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span> <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;&quot;OK&quot;&#39;</span><span class="p">,</span>
         <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aws_iam_user_name&#39;</span><span class="p">:</span> <span class="s1">&#39;iam_test_User&#39;</span><span class="p">},</span>
         <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span> <span class="s1">&#39;fn-aws-iam&#39;</span><span class="p">,</span> <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;myhost.ie.ibm.com&#39;</span><span class="p">,</span> <span class="s1">&#39;execution_time_ms&#39;</span><span class="p">:</span> <span class="mi">9170</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-11-18 16:24:17&#39;</span>
                     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">aws_iam_user_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">UserName</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">##  AWS IAM - fn_aws_iam_delete_login_profile script ##</span>
<span class="c1">#  Globals</span>
<span class="c1"># List of fields in datatable fn_aws_iam_delete_login_profile  script</span>
<span class="n">DATA_TBL_FIELDS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Groups&quot;</span><span class="p">]</span>
<span class="n">FN_NAME</span> <span class="o">=</span> <span class="s2">&quot;fn_aws_iam_delete_login_profile&quot;</span>
<span class="n">WF_NAME</span> <span class="o">=</span> <span class="s2">&quot;Delete Login Profile&quot;</span>
<span class="c1"># Processing</span>
<span class="n">CONTENT</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">content</span>
<span class="n">INPUTS</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">inputs</span>
<span class="n">QUERY_EXECUTION_DATE</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span>
<span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">note_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">CONTENT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;OK&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Login profile deleted for user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">LoginProfileExists</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span>
        <span class="k">elif</span> <span class="n">CONTENT</span> <span class="o">==</span> <span class="s2">&quot;NoSuchEntity&quot;</span><span class="p">:</span>
            <span class="n">note_text</span> <span class="o">=</span> <span class="s2">&quot;AWS IAM Integration: : Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: Login profile does not exist for user &lt;b&gt;</span><span class="si">{1}</span><span class="s2">&lt;/b&gt; for &quot;</span> \
                        <span class="s2">&quot;Resilient function &lt;b&gt;</span><span class="si">{2}</span><span class="s2">&lt;/b&gt;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">INPUTS</span><span class="p">[</span><span class="s2">&quot;aws_iam_user_name&quot;</span><span class="p">],</span> <span class="n">FN_NAME</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">LoginProfileExists</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">note_text</span> <span class="o">+=</span> <span class="s2">&quot;AWS IAM Integration: Workflow &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;: There was no result returned for Resilient function &lt;b&gt;</span><span class="si">{0}</span><span class="s2">&lt;/b&gt;.&quot;</span>\
            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">WF_NAME</span><span class="p">,</span> <span class="n">FN_NAME</span><span class="p">)</span>

    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">note_text</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="data-table-aws-iam-access-keys">
<h2>Data Table - AWS IAM Access Keys<a class="headerlink" href="#data-table-aws-iam-access-keys" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-aws-iam-access-keys" src="../_images/dt-aws-iam-access-keys.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>aws_iam_access_keys</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Access key id</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AccessKeyId</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Create date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CreateDate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Default key</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DefaultKey</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Last used date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LastUsedDate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Region</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Region</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Service name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ServiceName</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>User name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UserName</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-aws-iam-users">
<h2>Data Table - AWS IAM Users<a class="headerlink" href="#data-table-aws-iam-users" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: dt-aws-iam-users" src="../_images/dt-aws-iam-users.png" /></p>
<section id="id1">
<h3>API Name:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>aws_iam_users</p>
</section>
<section id="id2">
<h3>Columns:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Access key ids</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AccessKeyIds</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Create date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CreateDate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Default user</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DefaultUser</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Groups</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Groups</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Login Profile exists</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LoginProfileExists</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Policies</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Policies</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Query execution date</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_execution_date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Tags</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Tags</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>User Arn</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Arn</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>User name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UserName</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="custom-artifact-types">
<h2>Custom Artifact Types<a class="headerlink" href="#custom-artifact-types" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Display Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AWS IAM Access Key ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_key_id</span></code></p></td>
<td><p>Amazon Web Services (AWS) IAM access key id.</p></td>
</tr>
<tr class="row-odd"><td><p>AWS IAM User Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_user_name</span></code></p></td>
<td><p>Amazon Web Services (AWS) IAM user name.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="rules">
<h2>Rules<a class="headerlink" href="#rules" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Rule Name</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>Workflow Triggered</p></th>
<th class="head"><p>Condition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Example: AWS IAM: Add Access Key As Artifact</p></td>
<td><p>aws_iam_access_keys</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_keys.AccessKeyId</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Add User As Artifact</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Add User To Group</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_add_user_to_group</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Attach User Policy</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_attach_user_policy</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Change Profile Password</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_change_profile_password</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.LoginProfileExists</span> <span class="pre">equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Deactivate Access Key</p></td>
<td><p>aws_iam_access_keys</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_deactivate_access_key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_keys.AccessKeyId</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.DefaultKey</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.Status</span> <span class="pre">equals</span> <span class="pre">Active</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.Status</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Delete Access Key</p></td>
<td><p>aws_iam_access_keys</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_delete_access_key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_keys.AccessKeyId</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.DefaultKey</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Delete Access Key For Artifact</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_delete_access_key_for_artifact</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">artifact.type</span> <span class="pre">equals</span> <span class="pre">aws_iam_access_key_id</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Delete Access Keys</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_delete_access_keys</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.AccessKeyIds</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Delete Login Profile</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_delete_login_profile</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.LoginProfileExists</span> <span class="pre">equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Delete User</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_delete_user</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Delete User For Artifact</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_delete_user_for_artifact</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">artifact.type</span> <span class="pre">equals</span> <span class="pre">aws_iam_user_name</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Detach All User Policies</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_detach_all_user_policies</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Policies</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Get access Key For Artifact</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_get_access_key_for_artifact</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">artifact.type</span> <span class="pre">equals</span> <span class="pre">aws_iam_access_key_id</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Get Access Keys</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_get_access_keys</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.AccessKeyIds</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Get User</p></td>
<td><p>aws_iam_access_keys</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_get_user</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_keys.AccessKeyId</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Get User For Artifact</p></td>
<td><p>artifact</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_get_user_for_artifact</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">artifact.type</span> <span class="pre">equals</span> <span class="pre">aws_iam_user_name</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: List Access Keys</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_list_access_keys</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: List Users</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_list_users</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Refresh Access Key</p></td>
<td><p>aws_iam_access_keys</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_refresh_access_key</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_access_keys.AccessKeyId</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_access_keys.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Example: AWS IAM: Refresh User</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_refresh_user</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Example: AWS IAM: Remove User From All Groups</p></td>
<td><p>aws_iam_users</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wf_aws_iam_remove_user_from_all_groups</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aws_iam_users.DefaultUser</span> <span class="pre">not_equals</span> <span class="pre">Yes</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Groups</span> <span class="pre">has_a_value</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.Status</span> <span class="pre">not_equals</span> <span class="pre">Deleted</span> <span class="pre">AND</span> <span class="pre">aws_iam_users.UserName</span> <span class="pre">has_a_value</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>There are several ways to verify the successful operation of a function.</p>
<section id="soar-action-status">
<h3>SOAR Action Status<a class="headerlink" href="#soar-action-status" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>When viewing an incident, use the Actions menu to view <strong>Action Status</strong>.</p></li>
<li><p>By default, pending and errors are displayed.</p></li>
<li><p>Modify the filter for actions to also show Completed actions.</p></li>
<li><p>Clicking on an action displays additional information on the progress made or what error occurred.</p></li>
</ul>
</section>
<section id="soar-scripting-log">
<h3>SOAR Scripting Log<a class="headerlink" href="#soar-scripting-log" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>A separate log file is available to review scripting errors.</p></li>
<li><p>This is useful when issues occur in the pre-processing or post-processing scripts.</p></li>
<li><p>The default location for this log file is: <code class="docutils literal notranslate"><span class="pre">/var/log/resilient-scripting/resilient-scripting.log</span></code>.</p></li>
</ul>
</section>
<section id="soar-logs">
<h3>SOAR Logs<a class="headerlink" href="#soar-logs" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>By default, SOAR logs are retained at <code class="docutils literal notranslate"><span class="pre">/usr/share/co3/logs</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">client.log</span></code> may contain additional information regarding the execution of functions.</p></li>
</ul>
</section>
<section id="resilient-circuits">
<h3>Resilient-Circuits<a class="headerlink" href="#resilient-circuits" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The log is controlled in the <code class="docutils literal notranslate"><span class="pre">.resilient/app.config</span></code> file under the section [resilient] and the property <code class="docutils literal notranslate"><span class="pre">logdir</span></code>.</p></li>
<li><p>The default file name is <code class="docutils literal notranslate"><span class="pre">app.log</span></code>.</p></li>
<li><p>Each function will create progress information.</p></li>
<li><p>Failures will show up as errors and may contain python trace statements.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is an IBM supported app. Please search <a class="reference external" href="https://ibm.com/mysupport">ibm.com/mysupport</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_symantec_dlp/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Symantec DLP</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_vmware_cbc/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">VMware Carbon Black Cloud</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">AWS IAM</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-integration-contains-the-following-functions">The integration contains the following functions:

</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#on-apphost">on AppHost</a></li>
<li><a class="reference internal" href="#on-integration-server">on Integration Server</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-aws-iam-list-users">Function - AWS IAM: List Users</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-user">Function - AWS IAM: Delete User</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-user-access-key-ids">Function - AWS IAM: List User Access Key IDs</a></li>
<li><a class="reference internal" href="#function-aws-iam-update-access-key">Function - AWS IAM: Update Access Key</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-access-keys">Function - AWS IAM: Delete Access Keys</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-user-groups">Function - AWS IAM: List User Groups</a></li>
<li><a class="reference internal" href="#function-aws-iam-add-user-to-groups">Function - AWS IAM: Add User To Groups</a></li>
<li><a class="reference internal" href="#function-aws-iam-remove-user-from-groups">Function - AWS IAM: Remove User From Groups</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-user-policies">Function - AWS IAM: List User Policies</a></li>
<li><a class="reference internal" href="#function-aws-iam-attach-user-policies">Function - AWS IAM: Attach User policies</a></li>
<li><a class="reference internal" href="#function-aws-iam-detach-user-policies">Function - AWS IAM: Detach User policies</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-ssh-public-keys">Function - AWS IAM: List SSH Public Keys</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-ssh-public-keys">Function - AWS IAM: Delete SSH Public Keys</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-service-specific-credentials">Function - AWS IAM: List Service Specific Credentials</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-service-specific-credentials">Function - AWS IAM: Delete Service Specific Credentials</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-signing-certificates">Function - AWS IAM: List Signing Certificates</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-signing-certificates">Function - AWS IAM: Delete Signing Certificates</a></li>
<li><a class="reference internal" href="#function-aws-iam-list-mfa-devices">Function - AWS IAM: List MFA Devices</a></li>
<li><a class="reference internal" href="#function-aws-iam-deactivate-mfa-devices">Function - AWS IAM: Deactivate MFA Devices</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-virtual-mfa-devices">Function - AWS IAM: Delete Virtual MFA Devices</a></li>
<li><a class="reference internal" href="#function-aws-iam-update-login-profile">Function - AWS IAM: Update Login Profile</a></li>
<li><a class="reference internal" href="#function-aws-iam-delete-login-profile">Function - AWS IAM: Delete Login Profile</a></li>
<li><a class="reference internal" href="#data-table-aws-iam-access-keys">Data Table - AWS IAM Access Keys</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-aws-iam-users">Data Table - AWS IAM Users</a><ul>
<li><a class="reference internal" href="#id1">API Name:</a></li>
<li><a class="reference internal" href="#id2">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-artifact-types">Custom Artifact Types</a></li>
<li><a class="reference internal" href="#rules">Rules</a></li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#soar-action-status">SOAR Action Status</a></li>
<li><a class="reference internal" href="#soar-scripting-log">SOAR Scripting Log</a></li>
<li><a class="reference internal" href="#soar-logs">SOAR Logs</a></li>
<li><a class="reference internal" href="#resilient-circuits">Resilient-Circuits</a></li>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>