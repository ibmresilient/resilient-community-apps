{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1704401470056,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_xml_source",
      "hide_notification": false,
      "id": 359,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_xml_source",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_xml_source",
      "tooltip": "xml document to transform or empty when using attachments",
      "type_id": 11,
      "uuid": "c7a516a1-8d59-4ed1-870d-6e71dd632ea2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_filename",
      "hide_notification": false,
      "id": 360,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_filename",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_filename",
      "tooltip": "",
      "type_id": 11,
      "uuid": "ee6c2353-c93c-4fc4-a555-db5a115ec0a7",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_task_id",
      "hide_notification": false,
      "id": 361,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_task_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_task_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "f021ba2d-49d9-4a87-9f5b-84d743618a6d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_certificate",
      "hide_notification": false,
      "id": 362,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_certificate",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_certificate",
      "tooltip": "",
      "type_id": 11,
      "uuid": "f81ec445-590c-4ef4-8d8b-821a57e01207",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_incident_id",
      "hide_notification": false,
      "id": 363,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_incident_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "02cba5bf-7a97-4eff-9c39-8935eebd8835",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_attachment_id",
      "hide_notification": false,
      "id": 364,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_attachment_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_attachment_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "095c2f0a-7eb3-4822-ab88-2fb614ecca44",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_artifact_id",
      "hide_notification": false,
      "id": 365,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_artifact_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_artifact_id",
      "tooltip": "",
      "type_id": 11,
      "uuid": "2e64afbd-cea3-4e6c-b936-89d80e9083da",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_xml_stylesheet",
      "hide_notification": false,
      "id": 366,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_xml_stylesheet",
      "operation_perms": {},
      "operations": [],
      "placeholder": "transform.xslt",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_xml_stylesheet",
      "tooltip": "name of stylesheet to use for the transformation",
      "type_id": 11,
      "uuid": "32241685-5dc0-48a2-8b07-c72776cd2730",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_base64content",
      "hide_notification": false,
      "id": 367,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_base64content",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_base64content",
      "tooltip": "",
      "type_id": 11,
      "uuid": "559e9e98-7ee6-447b-a723-e4446293e192",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/parse_utilities_email_attachments",
      "hide_notification": false,
      "id": 368,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "parse_utilities_email_attachments",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "parse_utilities_email_attachments",
      "tooltip": "If set to True, attachments found in the email file will be attached as Artifacts",
      "type_id": 11,
      "uuid": "71585139-062b-4c5f-a0f9-bbc41b62b2da",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1701708549950,
      "description": {
        "content": "Extracts message headers and body parts from an email message (.eml or .msg).\n\nAny attachments found are added to the incident as artifacts if `parse_utilities_parse_email_attachments` is set to True.",
        "format": "text"
      },
      "destination_handle": "fn_parse_utilities",
      "display_name": "Parse Utilities: Email Parse",
      "export_key": "parse_utilities_email_parse",
      "id": 29,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1701708550001,
      "name": "parse_utilities_email_parse",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": \"1.0\", \"success\": true, \"reason\": null, \"content\": {\"received\": [{\"from\": \"www-data@localhost\", \"by\": \"example.fyre.ibm.com 8.15.2/8.15.2/Submit\", \"id\": \"29AJsIaP1141965\", \"date\": \"Mon, 10 Oct 2022 12:54:18 -0700\", \"hop\": 1, \"date_utc\": \"2022-10-10T19:54:18\", \"delay\": 0}, {\"from\": \"example.fyre.ibm.com localhost 127.0.0.1\", \"by\": \"example.fyre.ibm.com 8.15.2/8.15.2/Debian-10\", \"with\": \"ESMTP\", \"id\": \"29AJsIxo1141966\", \"for\": \"\u003cexample@ibm.com\u003e\", \"date\": \"Mon, 10 Oct 2022 12:54:18 -0700\", \"hop\": 2, \"date_utc\": \"2022-10-10T19:54:18\", \"delay\": 0.0}, {\"from\": \"example.fyre.ibm.com unknown 9.30.166.9\", \"by\": \"b01ledav005.gho.pok.ibm.com Postfix\", \"with\": \"ESMTPS\", \"for\": \"\u003cexample@ibm.com\u003e\", \"date\": \"Mon, 10 Oct 2022 19:54:18 +0000 GMT\", \"hop\": 3, \"date_utc\": \"2022-10-10T19:54:18\", \"delay\": 0.0}, {\"from\": \"b01ledav005.gho.pok.ibm.com unknown 127.0.0.1\", \"by\": \"IMSVA Postfix\", \"with\": \"ESMTP\", \"id\": \"F0260AE060\", \"for\": \"\u003cexample@ibm.com\u003e\", \"date\": \"Mon, 10 Oct 2022 19:54:18 +0000 GMT\", \"hop\": 4, \"date_utc\": \"2022-10-10T19:54:18\", \"delay\": 0.0}, {\"from\": \"b01ledav005.gho.pok.ibm.com unknown 127.0.0.1\", \"by\": \"IMSVA Postfix\", \"with\": \"ESMTP\", \"id\": \"3203BAE066\", \"for\": \"\u003cexample@ibm.com\u003e\", \"date\": \"Mon, 10 Oct 2022 19:54:19 +0000 GMT\", \"hop\": 5, \"date_utc\": \"2022-10-10T19:54:19\", \"delay\": 1.0}, {\"from\": \"b01ledav005.gho.pok.ibm.com b01ledav005.gho.pok.ibm.com 9.57.199.110\", \"by\": \"b01cxnp23034.gho.pok.ibm.com 8.14.9/8.14.9/NCO v10.0\", \"with\": \"ESMTP\", \"id\": \"29AJsJhU4784872\\r version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK\", \"for\": \"\u003cexample@ibm.com\u003e\", \"date\": \"Mon, 10 Oct 2022 19:54:19 GMT\", \"hop\": 6, \"date_utc\": \"2022-10-10T19:54:19\", \"delay\": 0.0}, {\"from\": \"b01cxnp23034.gho.pok.ibm.com 9.57.198.29\", \"by\": \"m01ex002.gmx.ibm.com 10.148.53.59\", \"with\": \"Microsoft SMTP Server\\r version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\", \"id\": \"15.1.2507.12\", \"via\": \"Frontend Transport\", \"date\": \"Mon, 10 Oct 2022 15:54:19 -0400\", \"hop\": 7, \"date_utc\": \"2022-10-10T19:54:19\", \"delay\": 0.0}, {\"from\": \"m01ex002.gmx.ibm.com 10.148.53.59\", \"by\": \"m01ex004.gmx.ibm.com\\r 10.148.53.60\", \"with\": \"Microsoft SMTP Server version=TLS1_2,\\r cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\", \"id\": \"15.1.2507.12\", \"date\": \"Mon, 10 Oct\\r 2022 15:54:19 -0400\", \"hop\": 8, \"date_utc\": \"2022-10-10T19:54:19\", \"delay\": 0.0}, {\"from\": \"gmx.mail.ibm.com 169.55.84.251\", \"by\": \"MW2NAM12FT057.mail.protection.outlook.com 10.13.181.5\", \"with\": \"Microsoft SMTP\\r Server version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\", \"id\": \"15.20.5723.11\", \"via\": \"Frontend Transport\", \"date\": \"Mon, 10 Oct 2022 19:54:24 +0000\", \"hop\": 9, \"date_utc\": \"2022-10-10T19:54:24\", \"delay\": 5.0}, {\"from\": \"MW2NAM12FT057.eop-nam12.prod.protection.outlook.com\\r 2603:10b6:303:8c:cafe::42\", \"by\": \"MW4PR03CA0145.outlook.office365.com\\r 2603:10b6:303:8c::30\", \"with\": \"Microsoft SMTP Server version=TLS1_2,\\r cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\", \"id\": \"15.20.5709.19\", \"via\": \"Frontend\\r Transport\", \"date\": \"Mon, 10 Oct 2022 19:54:24 +0000\", \"hop\": 10, \"date_utc\": \"2022-10-10T19:54:24\", \"delay\": 0.0}, {\"from\": \"MW4PR03CA0145.namprd03.prod.outlook.com 2603:10b6:303:8c::30\", \"by\": \"MN2PR15MB2877.namprd15.prod.outlook.com 2603:10b6:208:ee::17\", \"with\": \"Microsoft SMTP Server version=TLS1_2,\\r cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\", \"id\": \"15.20.5709.15\", \"date\": \"Mon, 10 Oct\\r 2022 19:54:24 +0000\", \"hop\": 11, \"date_utc\": \"2022-10-10T19:54:24\", \"delay\": 0.0}, {\"from\": \"MN2PR15MB2877.namprd15.prod.outlook.com 2603:10b6:208:ee::17\", \"by\": \"BYAPR15MB2296.namprd15.prod.outlook.com\", \"with\": \"HTTPS\", \"date\": \"Mon, 10 Oct 2022\\r 19:54:38 +0000\", \"hop\": 12, \"date_utc\": \"2022-10-10T19:54:38\", \"delay\": 14.0}], \"x-originatororg\": \"mail.ibm.com\", \"x-ms-exchange-organization-expirationstarttimereason\": \"OriginalSubmit\", \"x-crosspremisesheadersfiltered\": \"MW2NAM12FT057.eop-nam12.prod.protection.outlook.com\", \"x-ms-exchange-organization-scl\": \"-1\", \"body\": \"\u003cmeta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=utf-8\\\"\u003e\u003ctable cellpadding=\\\"4\\\"\u003e\u003ctr\u003e\u003ctd align=\\\"left\\\" colspan=\\\"4\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003eCongratulations, you\u0027re all ready to go!!\\r\\n\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd align=\\\"left\\\" colspan=\\\"4\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003eYour cluster \u003cb\u003elead\u003c/b\u003e has been built with the following\\r\\nconfiguration :\u003c/b\u003e\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr bgcolor=\\\"orange\\\"\u003e\u003cth\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003eEmbers\u003c/th\u003e\u003cth\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003ePublic\\r\\nIP\u003c/th\u003e\u003cth\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003ePrivate IP \u003c/th\u003e\u003cth\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003eAdditional Disks\u003c/th\u003e\u003ctr\u003e\u003ctr\u003e\u003ctd align=\\\"left\\\" bgcolor=\\\"#f0f0f0\\\"\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e\u003cb\u003elead1\u003c/b\u003e.fyre.ibm.com \u003c/td\u003e\u003ctd bgcolor=\\\"#f0f0f0\\\"\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e9.30.211.110\u003c/td\u003e\u003ctd bgcolor=\\\"#f0f0f0\\\"\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e10.11.38.164\u003c/td\u003e\u003ctd bgcolor=\\\"#f0f0f0\\\"\u003e\u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e--\u003c/td\u003e\u003ctr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e\u003cbr\u003e\u003cbr\u003e\u003cb\u003eLogin Credentials:\u003c/b\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e You can now log\\r\\ninto the node(s) of your cluster with the following credentials:\\r\\n\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e Username: root\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e Password: Your personal root password that you\\r\\nset on the Fyre webpage. \u003cbr\u003e\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e\u003cbr\u003e\u003cb\u003eSecurity schedule\u003cb\u003e:\\r\\n\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e\\r\\nYour cluster will be kept compliant automatically and will be patched\\r\\nand rebooted on the 1st weekend of each month.  You can change this\\r\\nschedule or disable it on a per-cluster basis from the Fyre\\r\\nGUI.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e\u003cbr\u003e\u003cb\u003eTerms of Use\u003cb\u003e: \u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003eBy using Fyre and/or Fyre resources\\r\\n(vms, clusters, etc), you agree to always abide by the Fyre Terms of\\r\\nUse.  \u003cbr\u003e\\r\\n\\tThese terms can be found here: \u003ca href=\\\"https://fyre.ibm.com/help#fyre-termsofuse\\\"\u003ehttps://fyre.ibm.com/help#fyre-termsofuse\u003c/a\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e\\r\\n\u003cbr\u003e\u003cbr\u003eThanks!\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\"4\\\" align=\\\"left\\\"\u003e \u003cfont face=\\\"verdana\\\" size=\\\"2\\\"\u003e ~ The Fyre Team\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\\r\\n\", \"x-ms-exchange-organization-network-message-id\": \"467954c2-54fc-491f-6f45-08daaaf93b34\", \"x-ms-exchange-crosstenant-fromentityheader\": \"HybridOnPrem\", \"date\": \"2022-10-10T19:54:18\", \"subject\": \"Fyre stack : \u0027lead\u0027 ready\", \"x-eopattributedmessage\": \"0\", \"x-ms-exchange-processed-by-bccfoldering\": \"15.20.5709.018\", \"authentication-results\": \"spf=none (sender IP is 169.55.84.251)\\r\\n smtp.mailfrom=example.fyre.ibm.com; dkim=none (message not signed)\\r\\n header.d=none;dmarc=fail action=none header.from=us.ibm.com;\", \"x-ms-exchange-organization-authas\": \"Anonymous\", \"content-type\": \"text/html; charset=\\\"UTF-8\\\"\", \"x-ms-exchange-crosstenant-network-message-id\": \"467954c2-54fc-491f-6f45-08daaaf93b34\", \"x-ms-exchange-organization-authsource\": \"m01ex002.gmx.ibm.com\", \"x-ms-exchange-crosstenant-authsource\": \"m01ex002.gmx.ibm.com\", \"x-tm-as-gconf\": \"00\", \"message-id\": \"\u003c202210101954.29AJsIaP1141965@example.fyre.ibm.com\u003e\", \"received-spf\": \"None (protection.outlook.com: example.fyre.ibm.com does not\\r\\n designate permitted sender hosts)\", \"timezone\": \"-7.0\", \"x-ms-exchange-organization-messagedirectionality\": \"Originating\", \"x-ms-exchange-crosstenant-id\": \"fcf67057-50c9-4ad4-98f3-ffca64add9e9\", \"x-organizationheaderspreserved\": \"m01ex004.gmx.ibm.com\", \"x-ms-exchange-crosstenant-originalarrivaltime\": \"10 Oct 2022 19:54:24.1967\\r\\n (UTC)\", \"to\": [[\"\", \"example@ibm.com\"]], \"x-ms-exchange-organization-expirationstarttime\": \"10 Oct 2022 19:54:24.3217\\r\\n (UTC)\", \"x-ms-traffictypediagnostic\": \"MW2NAM12FT057:EE_|MN2PR15MB2877:EE_\", \"x-ms-exchange-transport-endtoendlatency\": \"00:00:14.1482542\", \"x-ms-exchange-organization-expirationinterval\": \"1:00:00:00.0000000\", \"x-ms-exchange-crosstenant-originalattributedtenantconnectingip\": \"TenantId=fcf67057-50c9-4ad4-98f3-ffca64add9e9;Ip=[169.55.84.251];Helo=[gmx.mail.ibm.com]\", \"x-ms-exchange-transport-crosstenantheadersstamped\": \"MN2PR15MB2877\", \"x-ms-office365-filtering-correlation-id\": \"467954c2-54fc-491f-6f45-08daaaf93b34\", \"x-forefront-antispam-report\": \"CIP:169.55.84.251;CTRY:US;LANG:en;SCL:-1;SRV:;IPV:NLI;SFV:NSPM;H:gmx.mail.ibm.com;PTR:fb.54.37a9.ip4.static.sl-reverse.com;CAT:NONE;SFS:;DIR:INB;\", \"x-ms-exchange-organization-expirationintervalreason\": \"OriginalSubmit\", \"x-ms-publictraffictype\": \"Email\", \"to_domains\": [\"ibm.com\"], \"x-crosspremisesheaderspromoted\": \"MW2NAM12FT057.eop-nam12.prod.protection.outlook.com\", \"x-microsoft-antispam-mailbox-delivery\": \"ucf:0;jmr:0;auth:0;dest:I;ENG:(910001)(944506478)(944626604)(920097)(930097);\", \"x-ms-exchange-crosstenant-authas\": \"Anonymous\", \"x-microsoft-antispam-message-info\": \"FxHn9SLBjgFF4dnkfttJCPKsph9Xn/sEQCFV3yiLJGtgKZtqncl8KfT/dUhKZ0/gsMGuWHSea0qfzrAZ8+JHELx2xhOikG7lgDFxpsHiT9xi6/rannm53Ur5JqbUAGkXzJGXDA/BAUb1pjGogswkrl3NyGAq3+QSJ0XGJfOok63/Pa3ua6sCwzRjdEtzV0wK4YiTcMCMdhedpFPWf01iBcQPezd6aEHOg5EdMEnSFPFjSVfixP3nIqOsMSQLPS72ubUMz8JDhXycm1XennS6cGMb/WwByYS9YhfpFIiJqE3jFFLRnmzucI6msgFHRgQAS7nx2KYUZnnjJZbN1kS6bICVaRh4h2BrRhjb3G4b+HkkoW2Cqrhn4p+VnYIFH/hBPWuuophaKvQt/lJ0gIfR/svy0WBVtx1iRHY+lGgW8temE8vG4CS0oTgbztcMlMTmU5MNMszcSGHgeZZODkyeQPzi84QmpJdmiowkQqYynyv6yoYugLy3iIQfzv3XI0GChyctAVEzL34SAxwn+FCojNM/VYTp9XiZN3GSuqgvgwDpQNJpK6fxxdXhRsF6UG4eJpiQjHpCTYAg1y5njTGekjCqVsLkMeI5XYFdwOXKtceUos0vVCnUNVZxnEVxS2vJQWPZHziRd2tv8n/sMxdnIfXkQIDUSnby6M+X86IIYJYtf6vGPbTFaaYy8d8TVeHeEQNbnkyLuCmpKNek9xHHXBkz/5SSJ2JYb7/P6hzcVAXiIL2zlfLeUygHwl5yIupHY5QgqGOapnypnY4AfJWbIjpUL/EiB3aO0Mu+spvWoGZp3alMeYkvTTMmZcJrPOUJjY8Mgo4nhmJ+SWOo7VbAyoHwuJQrnfokBs3YCfHAHtub8WPcWDmimJ8mXViuT65QrPDc56ygK2NaCX6e++zOI/XKPTTbql4f1lsVoD8BFhmCfXZow1YDjsIwpn9ON5nWW86F7QveWQABZj0dGZb6OR/240k2FreC4u2H0l1X+Sa4H/bPVMwmJF6OEyKXVRWez4qdwfPw92kKLm3wD1kAOx/XTo0nJnrtrnOS+T+6BtLy+3m3u1Hehem6mDete3v3UJAWaZB0ofTJKzlrteo9/UCG3pwwYfLD9NHP0QsPUuD4qQmSee8TZO5XTZ3wkGEglIVs0lA9guRiVYMnX9kEFWrOcIAZYHpUMJDmY9YEc9tzJ9cRPVv/4WR1Gmf96p2s1tc5WkvYUXXotr+uyKp1d82lseuiW0fnVM2cfHD39URVCYJ7Jqmf2pnXRGuldbaWd/RFmyYBDHzeOX0jiZ+1cQLcn5kmOfowBxmDgBNKv4MPPvanY0jEkCqxM6YerTsJGs2fMN8JlUH5ToKMdk87JX8BEHYBuCHiGZWG/Zk6hdTL6QrfVL7gYwXOuhB+mBZYORylMH5SlNbNUzco0P2UwSHndiHBS/alLU9pzKPpCWaotNrvy3u9o0F0bBSHLqFoqjzhcwuY559ScjzUaAC7ASAS9G9Puy7d9PIl1UNH5Po8rvxmlkXlSv+YVHynHOsHo+2w/rkJP21IDz1Y6OT6SDoCBBU6vnuIkcmdKo+c4QyuOmmKnjf1gK3lRUOssWPEglg/2guLzVunyzpiafNeWoQZ6nGGE7pDHT24FzXjvi3X7zJLQiS+dkIjOYPEWABN140mLxbIODzhJ9MpsLMH1mh9ZQq3z3KELEtpXvlltJnf9lgcnZKDxv7R5L7ApHHvcRz3hyoJXc7PoQ1eBdwRi0bCA9aY+Q3m74Rmq+VEGRj7QpJS+fm7ALEdSqJw1f+HHKxtnMzdGSMMkXdOgSM4lW+y7wndHdXrqGXS+52z0Fhd4bzMLDKSSa/6HjdZtEjDQy2J8wLhrXK8e5sPaJgPPOpf+VIW1Xg/Qj968zigOEWb87TDN0NUM+WBF/t4QnebfQCnFCRiA8ZajnnlDa8dZA==\", \"return-path\": \"www-data@example.fyre.ibm.com\", \"x-microsoft-antispam\": \"BCL:0;\", \"mime-version\": \"1.0\", \"from\": [[\"Fyre Admin\", \"fyre@us.ibm.com\"]], \"has_defects\": false, \"plain_body\": \"\", \"html_body\": \"[\\\"\u003cmeta http-equiv=\\\\\\\"Content-Type\\\\\\\" content=\\\\\\\"text/html; charset=utf-8\\\\\\\"\u003e\u003ctable cellpadding=\\\\\\\"4\\\\\\\"\u003e\u003ctr\u003e\u003ctd align=\\\\\\\"left\\\\\\\" colspan=\\\\\\\"4\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003eCongratulations, you\u0027re all ready to go!!\\\\r\\\\n\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd align=\\\\\\\"left\\\\\\\" colspan=\\\\\\\"4\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003eYour cluster \u003cb\u003elead\u003c/b\u003e has been built with the following\\\\r\\\\nconfiguration :\u003c/b\u003e\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr bgcolor=\\\\\\\"orange\\\\\\\"\u003e\u003cth\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003eEmbers\u003c/th\u003e\u003cth\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003ePublic\\\\r\\\\nIP\u003c/th\u003e\u003cth\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003ePrivate IP \u003c/th\u003e\u003cth\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003eAdditional Disks\u003c/th\u003e\u003ctr\u003e\u003ctr\u003e\u003ctd align=\\\\\\\"left\\\\\\\" bgcolor=\\\\\\\"#f0f0f0\\\\\\\"\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e\u003cb\u003elead1\u003c/b\u003e.fyre.ibm.com \u003c/td\u003e\u003ctd bgcolor=\\\\\\\"#f0f0f0\\\\\\\"\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e9.30.211.110\u003c/td\u003e\u003ctd bgcolor=\\\\\\\"#f0f0f0\\\\\\\"\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e10.11.38.164\u003c/td\u003e\u003ctd bgcolor=\\\\\\\"#f0f0f0\\\\\\\"\u003e\u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e--\u003c/td\u003e\u003ctr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e\u003cbr\u003e\u003cbr\u003e\u003cb\u003eLogin Credentials:\u003c/b\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e You can now log\\\\r\\\\ninto the node(s) of your cluster with the following credentials:\\\\r\\\\n\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e Username: root\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e Password: Your personal root password that you\\\\r\\\\nset on the Fyre webpage. \u003cbr\u003e\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e\u003cbr\u003e\u003cb\u003eSecurity schedule\u003cb\u003e:\\\\r\\\\n\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e\\\\r\\\\nYour cluster will be kept compliant automatically and will be patched\\\\r\\\\nand rebooted on the 1st weekend of each month.  You can change this\\\\r\\\\nschedule or disable it on a per-cluster basis from the Fyre\\\\r\\\\nGUI.\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e\u003cbr\u003e\u003cb\u003eTerms of Use\u003cb\u003e: \u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003eBy using Fyre and/or Fyre resources\\\\r\\\\n(vms, clusters, etc), you agree to always abide by the Fyre Terms of\\\\r\\\\nUse.  \u003cbr\u003e\\\\r\\\\n\\\\tThese terms can be found here: \u003ca href=\\\\\\\"https://fyre.ibm.com/help#fyre-termsofuse\\\\\\\"\u003ehttps://fyre.ibm.com/help#fyre-termsofuse\u003c/a\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e\\\\r\\\\n\u003cbr\u003e\u003cbr\u003eThanks!\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd colspan=\\\\\\\"4\\\\\\\" align=\\\\\\\"left\\\\\\\"\u003e \u003cfont face=\\\\\\\"verdana\\\\\\\" size=\\\\\\\"2\\\\\\\"\u003e ~ The Fyre Team\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\\\\r\\\\n\\\"]\"}, \"raw\": \"{\\\"received\\\": [{\\\"from\\\": \\\"www-data@localhost\\\", \\\"by\\\": \\\"example.fyre.ibm.com 8.15.2/8.15.2/Submit\\\", \\\"FxHn9SLBjgFF4dnkfttJCPKsph9Xn/sEQCFV3yiLJGtgKZtqncl8KfT/dUhKZ0/gsMGuWHSea0qfzrAZ8+JHELx2xhOikG7lgDFxpsHiT9xi6/rannm53Ur5JqbUAGkXzJGXDA/BAUb1pjGogswkrl3NyGAq3+QSJ0XGJfOok63/Pa3ua6sCwzRjdEtzV0wK4YiTcMCMdhedpFPWf01iBcQPezd6aEHOg5EdMEnSFPFjSVfixP3nIqOsMSQLPS72ubUMz8JDhXycm1XennS6cGMb/WwByYS9YhfpFIiJqE3jFFLRnmzucI6msgFHRgQAS7nx2KYUZnnjJZbN1kS6bICVaRh4h2BrRhjb3G4b+HkkoW2Cqrhn4p+VnYIFH/hBPWuuophaKvQt/lJ0gIfR/svy0WBVtx1iRHY+lGgW8temE8vG4CS0oTgbztcMlMTmU5MNMszcSGHgeZZODkyeQPzi84QmpJdmiowkQqYynyv6yoYugLy3iIQfzv3XI0GChyctAVEzL34SAxwn+FCojNM/VYTp9XiZN3GSuqgvgwDpQNJpK6fxxdXhRsF6UG4eJpiQjHpCTYAg1y5njTGekjCqVsLkMeI5XYFdwOXKtceUos0vVCnUNVZxnEVxS2vJQWPZHziRd2tv8n/sMxdnIfXkQIDUSnby6M+X86IIYJYtf6vGPbTFaaYy8d8TVeHeEQNbnkyLuCmpKNek9xHHXBkz/5SSJ2JYb7/P6hzcVAXiIL2zlfLeUygHwl5yIupHY5QgqGOapnypnY4AfJWbIjpUL/EiB3aO0Mu+spvWoGZp3alMeYkvTTMmZcJrPOUJjY8Mgo4nhmJ+SWOo7VbAyoHwuJQrnfokBs3YCfHAHtub8WPcWDmimJ8mXViuT65QrPDc56ygK2NaCX6e++zOI/XKPTTbql4f1lsVoD8BFhmCfXZow1YDjsIwpn9ON5nWW86F7QveWQABZj0dGZb6OR/240k2FreC4u2H0l1X+Sa4H/bPVMwmJF6OEyKXVRWez4qdwfPw92kKLm3wD1kAOx/XTo0nJnrtrnOS+T+6BtLy+3m3u1Hehem6mDete3v3UJAWaZB0ofTJKzlrteo9/UCG3pwwYfLD9NHP0QsPUuD4qQmSee8TZO5XTZ3wkGEglIVs0lA9guRiVYMnX9kEFWrOcIAZYHpUMJDmY9YEc9tzJ9cRPVv/4WR1Gmf96p2s1tc5WkvYUXXotr+uyKp1d82lseuiW0fnVM2cfHD39URVCYJ7Jqmf2pnXRGuldbaWd/RFmyYBDHzeOX0jiZ+1cQLcn5kmOfowBxmDgBNKv4MPPvanY0jEkCqxM6YerTsJGs2fMN8JlUH5ToKMdk87JX8BEHYBuCHiGZWG/Zk6hdTL6QrfVL7gYwXOuhB+mBZYORylMH5SlNbNUzco0P2UwSHndiHBS/alLU9pzKPpCWaotNrvy3u9o0F0bBSHLqFoqjzhcwuY559ScjzUaAC7ASAS9G9Puy7d9PIl1UNH5Po8rvxmlkXlSv+YVHynHOsHo+2w/rkJP21IDz1Y6OT6SDoCBBU6vnuIkcmdKo+c4QyuOmmKnjf1gK3lRUOssWPEglg/2guLzVunyzpiafNeWoQZ6nGGE7pDHT24FzXjvi3X7zJLQiS+dkIjOYPEWABN140mLxbIODzhJ9MpsLMH1mh9ZQq3z3KELEtpXvlltJnf9lgcnZKDxv7R5L7ApHHvcRz3hyoJXc7PoQ1eBdwRi0bCA9aY+Q3m74Rmq+VEGRj7QpJS+fm7ALEdSqJw1f+HHKxtnMzdGSMMkXdOgSM4lW+y7wndHdXrqGXS+52z0Fhd4bzMLDKSSa/6HjdZtEjDQy2J8wLhrXK8e5sPaJgPPOpf+VIW1Xg/Qj968zigOEWb87TDN0NUM+WBF/t4QnebfQCnFCRiA8ZajnnlDa8dZA==\\\", \\\"return-path\\\": \\\"www-data@example.fyre.ibm.com\\\"}\", \"inputs\": {\"incident_id\": 2125, \"parse_utilities_email_attachments\": true, \"attachment_id\": 88}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-utilities\", \"package_version\": \"2.1.1\", \"host\": \"My Host\", \"execution_time_ms\": 1347, \"timestamp\": \"2022-10-13 15:50:56\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"received\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"from\": {\"type\": \"string\"}, \"by\": {\"type\": \"string\"}, \"id\": {\"type\": \"string\"}, \"date\": {\"type\": \"string\"}, \"hop\": {\"type\": \"integer\"}, \"date_utc\": {\"type\": \"string\"}, \"delay\": {\"type\": \"number\"}, \"with\": {\"type\": \"string\"}, \"for\": {\"type\": \"string\"}, \"via\": {\"type\": \"string\"}}}}, \"x-originatororg\": {\"type\": \"string\"}, \"x-ms-exchange-organization-expirationstarttimereason\": {\"type\": \"string\"}, \"x-crosspremisesheadersfiltered\": {\"type\": \"string\"}, \"x-ms-exchange-organization-scl\": {\"type\": \"string\"}, \"body\": {\"type\": \"string\"}, \"x-ms-exchange-organization-network-message-id\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-fromentityheader\": {\"type\": \"string\"}, \"date\": {\"type\": \"string\"}, \"subject\": {\"type\": \"string\"}, \"x-eopattributedmessage\": {\"type\": \"string\"}, \"x-ms-exchange-processed-by-bccfoldering\": {\"type\": \"string\"}, \"authentication-results\": {\"type\": \"string\"}, \"x-ms-exchange-organization-authas\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-network-message-id\": {\"type\": \"string\"}, \"x-ms-exchange-organization-authsource\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-authsource\": {\"type\": \"string\"}, \"x-tm-as-gconf\": {\"type\": \"string\"}, \"message-id\": {\"type\": \"string\"}, \"received-spf\": {\"type\": \"string\"}, \"timezone\": {\"type\": \"string\"}, \"x-ms-exchange-organization-messagedirectionality\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-id\": {\"type\": \"string\"}, \"x-organizationheaderspreserved\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-originalarrivaltime\": {\"type\": \"string\"}, \"to\": {\"type\": \"array\", \"items\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"x-ms-exchange-organization-expirationstarttime\": {\"type\": \"string\"}, \"x-ms-traffictypediagnostic\": {\"type\": \"string\"}, \"x-ms-exchange-transport-endtoendlatency\": {\"type\": \"string\"}, \"x-ms-exchange-organization-expirationinterval\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-originalattributedtenantconnectingip\": {\"type\": \"string\"}, \"x-ms-exchange-transport-crosstenantheadersstamped\": {\"type\": \"string\"}, \"x-ms-office365-filtering-correlation-id\": {\"type\": \"string\"}, \"x-forefront-antispam-report\": {\"type\": \"string\"}, \"x-ms-exchange-organization-expirationintervalreason\": {\"type\": \"string\"}, \"x-ms-publictraffictype\": {\"type\": \"string\"}, \"to_domains\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"x-crosspremisesheaderspromoted\": {\"type\": \"string\"}, \"x-microsoft-antispam-mailbox-delivery\": {\"type\": \"string\"}, \"x-ms-exchange-crosstenant-authas\": {\"type\": \"string\"}, \"x-microsoft-antispam-message-info\": {\"type\": \"string\"}, \"return-path\": {\"type\": \"string\"}, \"x-microsoft-antispam\": {\"type\": \"string\"}, \"mime-version\": {\"type\": \"string\"}, \"from\": {\"type\": \"array\", \"items\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"has_defects\": {\"type\": \"boolean\"}, \"plain_body\": {\"type\": \"string\"}, \"html_body\": {\"type\": \"string\"}}}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"incident_id\": {\"type\": \"integer\"}, \"parse_utilities_email_attachments\": {\"type\": \"boolean\"}, \"attachment_id\": {\"type\": \"integer\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "b8d57d19-a21e-42d4-9dba-06154084ca7e",
      "version": 1,
      "view_items": [
        {
          "content": "559e9e98-7ee6-447b-a723-e4446293e192",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "71585139-062b-4c5f-a0f9-bbc41b62b2da",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "095c2f0a-7eb3-4822-ab88-2fb614ecca44",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "02cba5bf-7a97-4eff-9c39-8935eebd8835",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "2e64afbd-cea3-4e6c-b936-89d80e9083da",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f021ba2d-49d9-4a87-9f5b-84d743618a6d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "095c2f0a-7eb3-4822-ab88-2fb614ecca44",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1701708550012,
      "description": {
        "content": "This function produces the structured data from a provided SSL certificate. Three inputs are accepted by the function. There are 2 defined ways to use this function for parsing certificates.",
        "format": "text"
      },
      "destination_handle": "fn_parse_utilities",
      "display_name": "Parse Utilities: Parse SSL Certificate",
      "export_key": "parse_utilities_parse_ssl_certificate",
      "id": 30,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1701708550058,
      "name": "parse_utilities_parse_ssl_certificate",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"subject\": \"\\\"[(b\u0027C\u0027, b\u0027US\u0027), (b\u0027ST\u0027, b\u0027California\u0027), (b\u0027L\u0027, b\u0027San Francisco\u0027), (b\u0027O\u0027, b\u0027Cloudflare, Inc.\u0027), (b\u0027CN\u0027, b\u0027sni.cloudflaressl.com\u0027)]\\\"\", \"notBefore\": \"2022-03-29 00:00:00\", \"notAfter\": \"2023-03-29 23:59:59\", \"issuer\": \"\\\"[(b\u0027C\u0027, b\u0027US\u0027), (b\u0027O\u0027, b\u0027Cloudflare, Inc.\u0027), (b\u0027CN\u0027, b\u0027Cloudflare Inc ECC CA-3\u0027)]\\\"\", \"version\": 2, \"expiration_status\": \"Valid\", \"signature_algorithm\": \"b\u0027ecdsa-with-SHA256\u0027\", \"public_key\": \"b\u0027-----BEGIN PUBLIC KEY-----\\\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXLHljT47vFyTH/0A6YqZhypEhVok\\\\n6OsRv++OwcB5tcAQmnTF58RgamcQ8rOEiEDhavOcbBeX/xsus397BgBGmQ==\\\\n-----END PUBLIC KEY-----\\\\n\u0027\", \"extensions\": {\"subjectAltNames\": \"[\\\"sni.cloudflaressl.com\\\", \\\"*.adamtheautomator.com\\\", \\\"adamtheautomator.com\\\"]\", \"basicConstraints\": \"false\", \"issuerAltNames\": \"[]\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"subject\": {\"type\": \"string\"}, \"notBefore\": {\"type\": \"string\"}, \"notAfter\": {\"type\": \"string\"}, \"issuer\": {\"type\": \"string\"}, \"version\": {\"type\": \"integer\"}, \"expiration_status\": {\"type\": \"string\"}, \"signature_algorithm\": {\"type\": \"string\"}, \"public_key\": {\"type\": \"string\"}, \"extensions\": {\"type\": \"object\", \"properties\": {\"subjectAltNames\": {\"type\": \"string\"}, \"basicConstraints\": {\"type\": \"string\"}, \"issuerAltNames\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "0e09a520-544a-4f0f-8990-d2475b43ba04",
      "version": 1,
      "view_items": [
        {
          "content": "f81ec445-590c-4ef4-8d8b-821a57e01207",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "2e64afbd-cea3-4e6c-b936-89d80e9083da",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "02cba5bf-7a97-4eff-9c39-8935eebd8835",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1701708550065,
      "description": {
        "content": "Produces summary information about the structure of a PDF file, using Didier Stevens\u0027 PDFID (https://blog.didierstevens.com/programs/pdf-tools/).",
        "format": "text"
      },
      "destination_handle": "fn_parse_utilities",
      "display_name": "Parse Utilities: PDFID",
      "export_key": "parse_utilities_pdfid",
      "id": 31,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1701708550107,
      "name": "parse_utilities_pdfid",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"filename\": \"README.pdf\", \"header\": \"%PDF-1.4\", \"isPdf\": \"True\", \"obj\": 570, \"endobj\": 570, \"stream\": 398, \"endstream\": 398, \"xref\": 1, \"trailer\": 1, \"startxref\": 1, \"/Page\": 85, \"/Encrypt\": 0, \"/ObjStm\": 0, \"/JS\": 0, \"/JavaScript\": 0, \"/AA\": 0, \"/OpenAction\": 0, \"/AcroForm\": 0, \"/JBIG2Decode\": 0, \"/RichMedia\": 0, \"/Launch\": 0, \"/EmbeddedFile\": 0, \"/XFA\": 0, \"/Colors \u003e 2^24\": 0}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"filename\": {\"type\": \"string\"}, \"header\": {\"type\": \"string\"}, \"isPdf\": {\"type\": \"string\"}, \"obj\": {\"type\": \"integer\"}, \"endobj\": {\"type\": \"integer\"}, \"stream\": {\"type\": \"integer\"}, \"endstream\": {\"type\": \"integer\"}, \"xref\": {\"type\": \"integer\"}, \"trailer\": {\"type\": \"integer\"}, \"startxref\": {\"type\": \"integer\"}, \"/Page\": {\"type\": \"integer\"}, \"/Encrypt\": {\"type\": \"integer\"}, \"/ObjStm\": {\"type\": \"integer\"}, \"/JS\": {\"type\": \"integer\"}, \"/JavaScript\": {\"type\": \"integer\"}, \"/AA\": {\"type\": \"integer\"}, \"/OpenAction\": {\"type\": \"integer\"}, \"/AcroForm\": {\"type\": \"integer\"}, \"/JBIG2Decode\": {\"type\": \"integer\"}, \"/RichMedia\": {\"type\": \"integer\"}, \"/Launch\": {\"type\": \"integer\"}, \"/EmbeddedFile\": {\"type\": \"integer\"}, \"/XFA\": {\"type\": \"integer\"}, \"/Colors \u003e 2^24\": {\"type\": \"integer\"}}}",
      "tags": [],
      "uuid": "c4b919f7-f943-405e-86fd-640f79e3ee8e",
      "version": 1,
      "view_items": [
        {
          "content": "2e64afbd-cea3-4e6c-b936-89d80e9083da",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "02cba5bf-7a97-4eff-9c39-8935eebd8835",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "2e64afbd-cea3-4e6c-b936-89d80e9083da",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "095c2f0a-7eb3-4822-ab88-2fb614ecca44",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f021ba2d-49d9-4a87-9f5b-84d743618a6d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "ee6c2353-c93c-4fc4-a555-db5a115ec0a7",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "559e9e98-7ee6-447b-a723-e4446293e192",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1701708550115,
      "description": {
        "content": "Transforms an XML document using a preexisting `xsl` stylesheet. The resulting content is returned.",
        "format": "text"
      },
      "destination_handle": "fn_parse_utilities",
      "display_name": "Parse Utilities: XML Transformation",
      "export_key": "parse_utilities_xml_transformation",
      "id": 32,
      "last_modified_by": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1701708550159,
      "name": "parse_utilities_xml_transformation",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"content\": \"\u003chtml\u003e\u003cbody\u003e\u003ch2\u003eMy CD Collection\u003c/h2\u003e\u003ctable border=\\\"1\\\"\u003e\u003ctr bgcolor=\\\"#9acd32\\\"\u003e\u003cth style=\\\"text-align:left\\\"\u003eTitle\u003c/th\u003e\u003cth style=\\\"text-align:left\\\"\u003eArtist\u003c/th\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eEmpire Burlesque\u003c/td\u003e\u003ctd\u003eBob Dylan\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eHide your heart\u003c/td\u003e\u003ctd\u003eBonnie Tyler\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eGreatest Hits\u003c/td\u003e\u003ctd\u003eDolly Parton\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eStill got the blues\u003c/td\u003e\u003ctd\u003eGary Moore\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\u003c/body\u003e\u003c/html\u003e\"}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"content\": {\"type\": \"string\"}}}",
      "tags": [],
      "uuid": "fb731c0f-f0ee-4a66-8cc5-ab98495a92ca",
      "version": 1,
      "view_items": [
        {
          "content": "2e64afbd-cea3-4e6c-b936-89d80e9083da",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "32241685-5dc0-48a2-8b07-c72776cd2730",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "095c2f0a-7eb3-4822-ab88-2fb614ecca44",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "02cba5bf-7a97-4eff-9c39-8935eebd8835",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "f021ba2d-49d9-4a87-9f5b-84d743618a6d",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "c7a516a1-8d59-4ed1-870d-6e71dd632ea2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 8,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [],
  "incident_types": [
    {
      "create_date": 1704401468299,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1704401468299,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "84cdaf7b-d8f0-48d3-9c1f-77e8c311d621"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_parse_utilities",
      "name": "fn_parse_utilities",
      "programmatic_name": "fn_parse_utilities",
      "tags": [],
      "users": [
        "admin@example.com"
      ],
      "uuid": "218ce2bf-074b-4320-adc9-67da29b465a2"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_type": "manual",
      "content": {
        "content_version": 19,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5\" isExecutable=\"true\" name=\"playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0qye9xc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: Email Parse\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"b8d57d19-a21e-42d4-9dba-06154084ca7e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Define incident_id and artifact_id\\ninputs.parse_utilities_incident_id = incident.id\\ninputs.parse_utilities_artifact_id = artifact.id\\n\\n# Setting this to True will add any found attachments as an Email Attachment Artifact\\ninputs.parse_utilities_email_attachments = True\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"email_parse\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0qye9xc\u003c/incoming\u003e\u003coutgoing\u003eFlow_0qe3ltl\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0qye9xc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_0qe3ltl\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1rjoj9p\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Email Parsing (Artifact)\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"59a182e9-e7ac-4582-9628-1e6672bec0ca\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0qe3ltl\u003c/incoming\u003e\u003coutgoing\u003eFlow_1rjoj9p\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1rjoj9p\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1rjoj9p\" id=\"Flow_1rjoj9p_di\"\u003e\u003comgdi:waypoint x=\"724\" y=\"132\"/\u003e\u003comgdi:waypoint x=\"724\" y=\"194\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0qe3ltl\" id=\"Flow_0qe3ltl_di\"\u003e\u003comgdi:waypoint x=\"724\" y=\"-8\"/\u003e\u003comgdi:waypoint x=\"724\" y=\"48\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0qye9xc\" id=\"Flow_0qye9xc_di\"\u003e\u003comgdi:waypoint x=\"724\" y=\"-164\"/\u003e\u003comgdi:waypoint x=\"724\" y=\"-92\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"633\" y=\"-216\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"625.95\" y=\"-91.75\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"657.95\" y=\"194.25\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"625.95\" y=\"48.25\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1701871814305,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5",
      "description": {
        "content": "Example playbook showing how to parse an Email File (.eml or .msg) from an Artifact File. Sender and recipient email addresses are added as Artifacts. URLs and IPs found in the email headers or body are also added as Artifacts. The body of the email, as well as sender and recipient details are added in a Note to the Incident. If attachments are found in the parsed email message, they are added as Email Attachment Artifacts.",
        "format": "text"
      },
      "display_name": "Parse Utilities: Email Parsing (Artifact) - Example (PB) ",
      "export_key": "parse_utilities_email_parsing_artifact_pb",
      "field_type_handle": "playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: Email Parsing (Artifact) (PB) ",
        "export_key": "playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5",
        "uuid": "80e8cb6e-2453-48df-8576-84031ee7a872"
      },
      "has_logical_errors": false,
      "id": 1,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704386621881,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702066961891,
          "description": "",
          "enabled": false,
          "export_key": "Email Parsing (Artifact)",
          "id": 26,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704386619917,
          "name": "Email Parsing (Artifact)",
          "object_type": "artifact",
          "playbook_handle": "parse_utilities_email_parsing_artifact_pb",
          "programmatic_name": "parse_utilities_email_parsing_artifact_pb_email_parsing_artifact",
          "script_text": "import re\n\nresults = playbook.functions.results.email_parse\n\nif not results.success:\n  note_text = u\"\"\"Playbook \u0027Parse Utilities: Email Parsing (Artifact) - Example (PB)\u0027 Failed\u003cbr\u003e\n                  \u003cb\u003eReason:\u003c/b\u003e {0}\"\"\".format(str(results.reason))\n  \n  incident.addNote(helper.createRichText(note_text))\n\nelse:\n  email = results.content\n  \n  # Get Email Subject\n  eml_subject = email.get(\"subject\", \"BLANK SUBJECT LINE\")\n\n  #########################################\n  # Add Artifacts for Email Recipient: to #\n  #########################################\n  for eml_addr in email.get(\"to\", []):\n    if len(eml_addr) \u003e= 2:\n      incident.addArtifact(\"Email Recipient\", eml_addr[1], eml_addr[0])\n  \n  #########################################\n  # Add Artifacts for Email Recipient: cc #\n  #########################################\n  for eml_addr in email.get(\"cc\", []):\n    if len(eml_addr) \u003e= 2:\n      incident.addArtifact(\"Email Recipient\", eml_addr[1], eml_addr[0])\n  \n  ########################################\n  # Add Artifacts for Email Sender: from #\n  ########################################\n  for eml_addr in email.get(\"from\", []):\n    if len(eml_addr) \u003e= 2:\n      incident.addArtifact(\"Email Sender\", eml_addr[1], eml_addr[0])\n\n  ################################################\n  # Add Artifacts for IPs found in Email Headers #\n  ################################################\n  for eml_header in email.get(\"received\", []):\n    \n    the_header = eml_header.get(\"from\", None)\n    \n    if the_header:\n      ips = re.findall(\u0027(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\u0027, the_header)\n      unique_ips = set(ips)\n  \n      for an_ip in unique_ips:\n        if an_ip:\n          incident.addArtifact(\"IP Address\", an_ip, u\"Hop {0} at {1}\\n\\nHeader: {2}\".format(eml_header.get(\"hop\", \"\"), eml_header.get(\"date_utc\", \"\"), the_header))\n\n  ##############################################\n  # Add Artifacts for URLs found in Email Body #\n  ##############################################\n  urls = []\n  for eml_body_content in [email.get(\"plain_body\", \"\"), email.get(\"html_body\", \"\")]:\n    urls.extend(re.findall(\u0027http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.\u0026+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+\u0027, eml_body_content))\n\n  uniq_urls = set(urls)\n\n  for a_url in uniq_urls:\n    # Remove any backslash as regex can add\n    a_url = a_url.replace(\u0027\\\\\u0027,\"\")\n    if a_url:\n      incident.addArtifact(\"URL\", a_url, \"Found in parsed Email\")\n  \n  ################################################\n  # Add the Email Body as a Note to the Incident #\n  ################################################\n  if email.get(\"body\"):\n    note_text = u\"\"\"\u003cb\u003ePlaybook \u0027Parse Utilities: Email Parsing (Artifact) - Example (PB)\u0027 results\u003c/b\u003e\u003cbr\u003e\n                    \u003cb\u003eParsed Email::\u003c/b\u003e\u003cbr\u003e\n                    \u003cb\u003eSubject:\u003c/b\u003e\u003cbr\u003e{0}\u003cbr\u003e\n                    \u003cb\u003eFrom:\u003c/b\u003e\u003cbr\u003e{1}\u003cbr\u003e\n                    \u003cb\u003eTo:\u003c/b\u003e\u003cbr\u003e{2}\u003cbr\u003e\n                    \u003cb\u003eBody:\u003c/b\u003e\u003cbr\u003e{3}\"\"\".format(str(eml_subject),\n                                  str(email.get(\"from\", \"N/A\")),\n                                  str(email.get(\"to\", \"N/A\")), \n                                  str(email.get(\"body\", \"N/A\")))\n\n    incident.addNote(helper.createRichText(note_text))\n  \n  \u0027\u0027\u0027Uncomment this if you would like to add a (safer) plain_text only Note\n  if email.get(\"plain_body\"):\n    note_text = u\"\"\"Parsed Email::\\n\\nSubject:\\n{0}\\n\\nFrom:\\n{1}\\n\\nTo:\\n{2}\\n\\nBody:\\n{3}\"\"\".format(str(eml_subject),\n      str(email.get(\"from\", \"N/A\")), unicode(email.get(\"to\", \"N/A\")), str(email.get(\"body\", \"N/A\")))\n\n    incident.addNote(helper.createPlainText(note_text))\n  \u0027\u0027\u0027",
          "tags": [],
          "uuid": "59a182e9-e7ac-4582-9628-1e6672bec0ca"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "in",
              "type": null,
              "value": [
                "RFC 822 Email Message File",
                "Email Attachment",
                "Other File"
              ]
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_email_parsing_artifact_pb",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_4a34f9ba-b19a-4785-8623-5dea9034efa5",
        "id": 2,
        "name": "playbook_4a34f9ba_b19a_4785_8623_5dea9034efa5",
        "type": "playbook",
        "uuid": "113c7133-cff9-457b-82d4-6783c6a7ecc9"
      },
      "tags": [],
      "type": "default",
      "uuid": "4a34f9ba-b19a-4785-8623-5dea9034efa5",
      "version": 27
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_636f90a1_c042_42ff_8eac_9385587efc1e\" isExecutable=\"true\" name=\"playbook_636f90a1_c042_42ff_8eac_9385587efc1e\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0nt2mr4\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: Email Parse\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"b8d57d19-a21e-42d4-9dba-06154084ca7e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Define incident_id and attachment_id\\ninputs.parse_utilities_incident_id = incident.id\\ninputs.parse_utilities_attachment_id = attachment.id\\n\\n# If this is a \\\"task attachment\\\" then we will additionally have a task-id\\nif task is not None:\\n  inputs.parse_utilities_task_id = task.id\\n\\n# Setting this to True will add any found attachments as an Email Attachment Artifact\\ninputs.parse_utilities_email_attachments = True\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"email_parse\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0nt2mr4\u003c/incoming\u003e\u003coutgoing\u003eFlow_1jml5bp\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0nt2mr4\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Email Parsing (Attachment)\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d1c1bd85-dbf8-4efd-8bde-01555c1c5cb0\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1jml5bp\u003c/incoming\u003e\u003coutgoing\u003eFlow_1vuj65m\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1jml5bp\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1vuj65m\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1vuj65m\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_636f90a1_c042_42ff_8eac_9385587efc1e\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1vuj65m\" id=\"Flow_1vuj65m_di\"\u003e\u003comgdi:waypoint x=\"430\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"430\" y=\"504\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1jml5bp\" id=\"Flow_1jml5bp_di\"\u003e\u003comgdi:waypoint x=\"430\" y=\"292\"/\u003e\u003comgdi:waypoint x=\"430\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0nt2mr4\" id=\"Flow_0nt2mr4_di\"\u003e\u003comgdi:waypoint x=\"430\" y=\"136\"/\u003e\u003comgdi:waypoint x=\"430\" y=\"208\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"209.017\" x=\"325\" y=\"84\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"332\" y=\"208\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"332\" y=\"358\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"364\" y=\"503.5\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1702997782351,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_636f90a1_c042_42ff_8eac_9385587efc1e",
      "description": {
        "content": "Example playbook showing how to parse an Email File (.eml or .msg) from Incident/Task Attachments. Sender and recipient email addresses are added as Artifacts. URLs and IPs found in the email headers or body are also added as Artifacts. The body of the email, as well as sender and recipient details are added in a Note to the Incident. If attachments are found in the parsed email message, they are added as Email Attachment Artifacts.",
        "format": "text"
      },
      "display_name": "Parse Utilities: Email Parsing (Attachment) - Example (PB)",
      "export_key": "parse_utilities_email_parsing_attachment_pb",
      "field_type_handle": "playbook_636f90a1_c042_42ff_8eac_9385587efc1e",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: Email Parsing (Attachment) - Example (PB)",
        "export_key": "playbook_636f90a1_c042_42ff_8eac_9385587efc1e",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_636f90a1_c042_42ff_8eac_9385587efc1e",
        "uuid": "524971ed-44df-4e82-8431-eb0250118be0"
      },
      "has_logical_errors": false,
      "id": 30,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704386588003,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702997782421,
          "description": "",
          "enabled": false,
          "export_key": "Email Parsing (Attachment)",
          "id": 38,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704386584108,
          "name": "Email Parsing (Attachment)",
          "object_type": "attachment",
          "playbook_handle": "parse_utilities_email_parsing_attachment_pb",
          "programmatic_name": "parse_utilities_email_parsing_attachment_pb_email_parsing_attachment",
          "script_text": "import re\n\nresults = playbook.functions.results.email_parse\n\nif not results.success:\n  note_text = u\"\"\"Playbook \u0027Parse Utilities: Email Parsing (Attachment) - Example (PB)\u0027 Failed\u003cbr\u003e\n                  \u003cb\u003eReason:\u003c/b\u003e {0}\"\"\".format(str(results.reason))\n  \n  incident.addNote(helper.createRichText(note_text))\n\nelse:\n  email = results.content\n  \n  # Get Email Subject\n  eml_subject = email.get(\"subject\", \"BLANK SUBJECT LINE\")\n\n  #########################################\n  # Add Artifacts for Email Recipient: to #\n  #########################################\n  for eml_addr in email.get(\"to\", []):\n    if len(eml_addr) \u003e= 2:\n      incident.addArtifact(\"Email Recipient\", eml_addr[1], eml_addr[0])\n  \n  #########################################\n  # Add Artifacts for Email Recipient: cc #\n  #########################################\n  for eml_addr in email.get(\"cc\", []):\n    if len(eml_addr) \u003e= 2:\n      incident.addArtifact(\"Email Recipient\", eml_addr[1], eml_addr[0])\n  \n  ########################################\n  # Add Artifacts for Email Sender: from #\n  ########################################\n  for eml_addr in email.get(\"from\", []):\n    if len(eml_addr) \u003e= 2:\n      incident.addArtifact(\"Email Sender\", eml_addr[1], eml_addr[0])\n\n  ################################################\n  # Add Artifacts for IPs found in Email Headers #\n  ################################################\n  for eml_header in email.get(\"received\", []):\n    \n    the_header = eml_header.get(\"from\", None)\n    \n    if the_header:\n      ips = re.findall(\u0027(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\u0027, the_header)\n      unique_ips = set(ips)\n  \n      for an_ip in unique_ips:\n        if an_ip:\n          incident.addArtifact(\"IP Address\", an_ip, u\"Hop {0} at {1}\\n\\nHeader: {2}\".format(eml_header.get(\"hop\", \"\"), eml_header.get(\"date_utc\", \"\"), the_header))\n\n  ##############################################\n  # Add Artifacts for URLs found in Email Body #\n  ##############################################\n  urls = []\n  for eml_body_content in [email.get(\"plain_body\", \"\"), email.get(\"html_body\", \"\")]:\n    urls.extend(re.findall(\u0027http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.\u0026+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+\u0027, eml_body_content))\n\n  uniq_urls = set(urls)\n\n  for a_url in uniq_urls:\n    # Remove any backslash as regex can add\n    a_url = a_url.replace(\u0027\\\\\u0027,\"\")\n    if a_url:\n      incident.addArtifact(\"URL\", a_url, \"Found in parsed Email\")\n  \n  ################################################\n  # Add the Email Body as a Note to the Incident #\n  ################################################\n  if email.get(\"body\"):\n    note_text = u\"\"\"\u003cb\u003ePlaybook \u0027Parse Utilities: Email Parsing (Attachment) - Example (PB)\u0027 results\u003c/b\u003e\u003cbr\u003e\n                    \u003cb\u003eParsed Email::\u003c/b\u003e\u003cbr\u003e\n                    \u003cb\u003eSubject:\u003c/b\u003e\u003cbr\u003e{0}\u003cbr\u003e\n                    \u003cb\u003eFrom:\u003c/b\u003e\u003cbr\u003e{1}\u003cbr\u003e\n                    \u003cb\u003eTo:\u003c/b\u003e\u003cbr\u003e{2}\u003cbr\u003e\n                    \u003cb\u003eBody:\u003c/b\u003e\u003cbr\u003e{3}\"\"\".format(str(eml_subject),\n                                  str(email.get(\"from\", \"N/A\")),\n                                  str(email.get(\"to\", \"N/A\")), \n                                  str(email.get(\"body\", \"N/A\")))\n\n    incident.addNote(helper.createRichText(note_text))\n  \n  \u0027\u0027\u0027Uncomment this if you would like to add a (safer) plain_text only Note\n  if email.get(\"plain_body\"):\n    note_text = u\"\"\"Parsed Email::\\n\\nSubject:\\n{0}\\n\\nFrom:\\n{1}\\n\\nTo:\\n{2}\\n\\nBody:\\n{3}\"\"\".format(str(eml_subject),\n      str(email.get(\"from\", \"N/A\")), str(email.get(\"to\", \"N/A\")), str(email.get(\"body\", \"N/A\")))\n\n    incident.addNote(helper.createPlainText(note_text))\n  \u0027\u0027\u0027",
          "tags": [],
          "uuid": "d1c1bd85-dbf8-4efd-8bde-01555c1c5cb0"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_email_parsing_attachment_pb",
      "object_type": "attachment",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_636f90a1-c042-42ff-8eac-9385587efc1e",
        "id": 32,
        "name": "playbook_636f90a1_c042_42ff_8eac_9385587efc1e",
        "type": "playbook",
        "uuid": "a884b0b9-ddd5-448f-84e5-4400af236551"
      },
      "tags": [],
      "type": "default",
      "uuid": "636f90a1-c042-42ff-8eac-9385587efc1e",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 9,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_074660c4_d7f3_4721_9b37_6f61e7582474\" isExecutable=\"true\" name=\"playbook_074660c4_d7f3_4721_9b37_6f61e7582474\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1bw1g6h\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: Parse SSL Certificate\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"0e09a520-544a-4f0f-8990-d2475b43ba04\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.parse_utilities_certificate = artifact.value\\ninputs.parse_utilities_artifact_id = artifact.id\\ninputs.parse_utilities_incident_id = incident.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"ssl_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1bw1g6h\u003c/incoming\u003e\u003coutgoing\u003eFlow_0zr7wmz\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1bw1g6h\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Convert JSON to rich text v1.3\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"64d3e6da-8b56-4d19-9ce8-a75586f71dad\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1qvz5rt\u003c/incoming\u003e\u003coutgoing\u003eFlow_0r1tkor\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Process SSL Results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"0e318141-2ac2-47de-810c-b82e965f81b5\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0zr7wmz\u003c/incoming\u003e\u003coutgoing\u003eFlow_1qvz5rt\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0zr7wmz\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1qvz5rt\" sourceRef=\"ScriptTask_3\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0r1tkor\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0r1tkor\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_4\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_074660c4_d7f3_4721_9b37_6f61e7582474\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0r1tkor\" id=\"Flow_0r1tkor_di\"\u003e\u003comgdi:waypoint x=\"520\" y=\"582\"/\u003e\u003comgdi:waypoint x=\"520\" y=\"654\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1qvz5rt\" id=\"Flow_1qvz5rt_di\"\u003e\u003comgdi:waypoint x=\"520\" y=\"422\"/\u003e\u003comgdi:waypoint x=\"520\" y=\"498\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0zr7wmz\" id=\"Flow_0zr7wmz_di\"\u003e\u003comgdi:waypoint x=\"520\" y=\"272\"/\u003e\u003comgdi:waypoint x=\"520\" y=\"338\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1bw1g6h\" id=\"Flow_1bw1g6h_di\"\u003e\u003comgdi:waypoint x=\"520\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"520\" y=\"188\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"429\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"422\" y=\"188\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"422\" y=\"498\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"421.75\" y=\"337.75\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"453.75\" y=\"653.75\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1702387826044,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_074660c4_d7f3_4721_9b37_6f61e7582474",
      "description": {
        "content": "Example playbook that takes a PEM encoded SSL certificate as input and returns structured information about the certificate.",
        "format": "text"
      },
      "display_name": "Parse Utilities: Parse SSL Certificate - Example (PB)",
      "export_key": "parse_utilities_parse_ssl_certificate",
      "field_type_handle": "playbook_074660c4_d7f3_4721_9b37_6f61e7582474",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: Parse SSL Certificate (PB)",
        "export_key": "playbook_074660c4_d7f3_4721_9b37_6f61e7582474",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_074660c4_d7f3_4721_9b37_6f61e7582474",
        "uuid": "baa0068b-8fbe-4d14-968e-6cab459a43fe"
      },
      "has_logical_errors": false,
      "id": 21,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704394003808,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702388171882,
          "description": "Add a note with certificate details",
          "enabled": false,
          "export_key": "Process SSL Results",
          "id": 29,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704394000424,
          "name": "Process SSL Results",
          "object_type": "artifact",
          "playbook_handle": "parse_utilities_parse_ssl_certificate",
          "programmatic_name": "parse_utilities_parse_ssl_certificate_process_ssl_results",
          "script_text": "color = \"#45bc27\"\n\nresults = playbook.functions.results.ssl_results\n\nif (results.expiration_status != \"Valid\"):\n  color = \"#ff402b\"\nnoteText = \"\"\"\u003cb\u003ePlaybook \u0027Parse Utilities: Parse SSL Certificate - Example (PB)\u0027 results\u003c/b\u003e\u003cbr\u003e\n              \u003cbr\u003eCertificate Subject :\u003cb\u003e{0}\u003c/b\u003e\n              \u003cb\u003eCertificate Expiry After :\u003c/b\u003e{1}\u003c/a\u003e\n              \u003cb\u003eExpiration Status:\u003c/b\u003e \u003cb style=\"color: {2}\"\u003e{3}\u003c/b\u003e\n              \u003cbr\u003eIssuer Details :\u003cb\u003e{4}\u003c/b\u003e\"\"\".format(results.subject, results.notAfter, color, results.expiration_status,results.issuer)\n\nincident.addNote(helper.createRichText(noteText))\n\nplaybook.addProperty(\u0027convert_json_to_rich_text\u0027, { \n    \"version\": 1.0,\n    \"header\": \"\u003cb\u003ePlaybook \u0027Parse Utilities: Parse SSL Certificate - Example (PB)\u0027 results\u003c/b\u003e\",\n    \"padding\": 10,\n    \"separator\": u\"\u003cbr\u003e\",\n    \"json\": results,\n    \"json_omit_list\": [],\n    \"incident_field\": None\n  })",
          "tags": [],
          "uuid": "0e318141-2ac2-47de-810c-b82e965f81b5"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "equals",
              "type": null,
              "value": "X509 Certificate File"
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_parse_ssl_certificate",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_074660c4-d7f3-4721-9b37-6f61e7582474",
        "id": 23,
        "name": "playbook_074660c4_d7f3_4721_9b37_6f61e7582474",
        "type": "playbook",
        "uuid": "b4279465-43bb-4743-9314-6e22fa6633d0"
      },
      "tags": [],
      "type": "default",
      "uuid": "074660c4-d7f3-4721-9b37-6f61e7582474",
      "version": 16
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 12,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_22470ecb_44cd_4812_b8c2_204ea243dedd\" isExecutable=\"true\" name=\"playbook_22470ecb_44cd_4812_b8c2_204ea243dedd\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1m7msji\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: PDFID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c4b919f7-f943-405e-86fd-640f79e3ee8e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Required inputs are: incident_id artifact_id\\ninputs.parse_utilities_incident_id = incident.id\\ninputs.parse_utilities_artifact_id = artifact.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"pdfid_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1m7msji\u003c/incoming\u003e\u003coutgoing\u003eFlow_0w68jfa\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1m7msji\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"Process PDFiD Results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"bcabfcd4-b2a6-4ed9-b91b-e290a5a692cf\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0w68jfa\u003c/incoming\u003e\u003coutgoing\u003eFlow_0qh9akk\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0w68jfa\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0qh9akk\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0qh9akk\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_22470ecb_44cd_4812_b8c2_204ea243dedd\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0qh9akk\" id=\"Flow_0qh9akk_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"504\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0w68jfa\" id=\"Flow_0w68jfa_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"292\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1m7msji\" id=\"Flow_1m7msji_di\"\u003e\u003comgdi:waypoint x=\"720\" y=\"136\"/\u003e\u003comgdi:waypoint x=\"720\" y=\"208\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"629\" y=\"84\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"621.75\" y=\"208.25\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"621.75\" y=\"358.25\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"653.75\" y=\"504.25\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1702388484628,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_22470ecb_44cd_4812_b8c2_204ea243dedd",
      "description": {
        "content": "Example playbook to show how to use the PDFiD function to get summary information about a PDF file artifact.",
        "format": "text"
      },
      "display_name": "Parse Utilities: PDFiD (Artifact) - Example (PB)",
      "export_key": "parse_utilities_pdfid_artifact",
      "field_type_handle": "playbook_22470ecb_44cd_4812_b8c2_204ea243dedd",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: PDFiD (Artifact) (PB)",
        "export_key": "playbook_22470ecb_44cd_4812_b8c2_204ea243dedd",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_22470ecb_44cd_4812_b8c2_204ea243dedd",
        "uuid": "866c5a12-b045-46c3-a871-0396cdd746fe"
      },
      "has_logical_errors": false,
      "id": 22,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704394623598,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702388853275,
          "description": "",
          "enabled": false,
          "export_key": "Process PDFiD Results",
          "id": 30,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704394596165,
          "name": "Process PDFiD Results",
          "object_type": "artifact",
          "playbook_handle": "parse_utilities_pdfid_artifact",
          "programmatic_name": "parse_utilities_pdfid_artifact_execute_pdfid",
          "script_text": "# The output of PDFiD is a dictionary with the fundamental elements of the PDF file.\n# These include,\n#  - \"isPdf\" (True or False)\n#  - \"header\" (the PDF version header)\n#  - \"obj\", \"endobj\" and so on: the count of each element.\n# More documentation can be found at https://blog.didierstevens.com/programs/pdf-tools/\n\n# Some sections of interest\ninteresting_sections = [\n  \u0027obj\u0027, \u0027endobj\u0027, \u0027stream\u0027, \u0027endstream\u0027, \u0027startxref\u0027, \u0027xref\u0027, \u0027trailer\u0027,\n  \u0027/AA\u0027, \u0027/AcroForm\u0027, \u0027/EmbeddedFile\u0027, \u0027/Encrypt\u0027, \u0027/JBIG2Decode\u0027, \u0027/JS\u0027, \u0027/JavaScript\u0027, \u0027/Launch\u0027, \u0027/ObjStm\u0027, \u0027/OpenAction\u0027, \u0027/Page\u0027, \u0027/RichMedia\u0027, \u0027/XFA\u0027\n  ]\n\nresults = playbook.functions.results.pdfid_results\n\nif not results.isPdf:\n  incident.addNote(helper.createRichText(u\"Playbook \u0027Parse Utilities: PDFiD (Artifact) - Example (PB)\u0027 results\u003cbr\u003eNot a PDF file: {}\".format(results.get(\"filename\"))))\nelse:\n  # In this example we just write them to a note in the incident\n  note_data = [u\"Playbook \u0027Parse Utilities: PDFiD (Artifact) - Example (PB)\u0027 results\\nPDFID report for {} ({}):\".format(results.get(\"filename\"), results.header)]\n\n  for section in interesting_sections:\n    value = results.get(section)\n    if value is not None:\n      note_data.append(\"{}: {}\".format(section, value))\n\n  text = helper.createPlainText(\"\\n\".join(note_data))\n  incident.addNote(text)\n  \n  # Maybe extend this to alert if (/JS or /JavaScript) and (/AA or /OpenAction)\n",
          "tags": [],
          "uuid": "bcabfcd4-b2a6-4ed9-b91b-e290a5a692cf"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.attachment",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_pdfid_artifact",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_22470ecb-44cd-4812-b8c2-204ea243dedd",
        "id": 24,
        "name": "playbook_22470ecb_44cd_4812_b8c2_204ea243dedd",
        "type": "playbook",
        "uuid": "fae0be61-6849-4880-9ea5-7ca095af987c"
      },
      "tags": [],
      "type": "default",
      "uuid": "22470ecb-44cd-4812-b8c2-204ea243dedd",
      "version": 19
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 8,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_404edfdc_139c_4c89_8232_dd9a5116bc88\" isExecutable=\"true\" name=\"playbook_404edfdc_139c_4c89_8232_dd9a5116bc88\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0hb53uu\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: PDFID\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"c4b919f7-f943-405e-86fd-640f79e3ee8e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"# Required inputs are: incident_id attachment_id\\ninputs.parse_utilities_incident_id = incident.id\\ninputs.parse_utilities_attachment_id = attachment.id\\n\\n# If this is a \\\"task attachment\\\" then we will additionally have a task-id\\nif task is not None:\\n  inputs.parse_utilities_task_id = task.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"pdfid_results\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0hb53uu\u003c/incoming\u003e\u003coutgoing\u003eFlow_0uc7963\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0hb53uu\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1n2lccr\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0uc7963\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"Process PDFiD Results\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"14db3829-9098-4802-894b-f4c9cb96671d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0uc7963\u003c/incoming\u003e\u003coutgoing\u003eFlow_1n2lccr\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1n2lccr\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_404edfdc_139c_4c89_8232_dd9a5116bc88\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1n2lccr\" id=\"Flow_1n2lccr_di\"\u003e\u003comgdi:waypoint x=\"440\" y=\"432\"/\u003e\u003comgdi:waypoint x=\"440\" y=\"504\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0uc7963\" id=\"Flow_0uc7963_di\"\u003e\u003comgdi:waypoint x=\"440\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"440\" y=\"348\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hb53uu\" id=\"Flow_0hb53uu_di\"\u003e\u003comgdi:waypoint x=\"440\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"440\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"209.017\" x=\"335\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"342\" y=\"197.64999389648438\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"374.325\" y=\"503.88799389648443\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"342.3\" y=\"348.3749938964844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1702411986562,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_404edfdc_139c_4c89_8232_dd9a5116bc88",
      "description": {
        "content": "Example playbook to show how to use the PDFiD function to get summary information about a PDF file artifact.",
        "format": "text"
      },
      "display_name": "Parse Utilities: PDFiD (Attachment) - Example (PB)",
      "export_key": "parse_utilities_pdfid_attachment",
      "field_type_handle": "playbook_404edfdc_139c_4c89_8232_dd9a5116bc88",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: PDFiD (Attachment) (PB)",
        "export_key": "playbook_404edfdc_139c_4c89_8232_dd9a5116bc88",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_404edfdc_139c_4c89_8232_dd9a5116bc88",
        "uuid": "10327488-a36d-4a03-8cfb-ee474adfb548"
      },
      "has_logical_errors": false,
      "id": 23,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704394647953,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702412133351,
          "description": "",
          "enabled": false,
          "export_key": "Process PDFiD Results",
          "id": 31,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704394645570,
          "name": "Process PDFiD Results",
          "object_type": "attachment",
          "playbook_handle": "parse_utilities_pdfid_attachment",
          "programmatic_name": "parse_utilities_pdfid_attachment_process_pdfid_results",
          "script_text": "# The output of PDFiD is a dictionary with the fundamental elements of the PDF file.\n# These include,\n#  - \"isPdf\" (True or False)\n#  - \"header\" (the PDF version header)\n#  - \"obj\", \"endobj\" and so on: the count of each element.\n# More documentation can be found at https://blog.didierstevens.com/programs/pdf-tools/\n\nresults = playbook.functions.results.pdfid_results\n\n# Some sections of interest\ninteresting_sections = [\n  \u0027obj\u0027, \u0027endobj\u0027, \u0027stream\u0027, \u0027endstream\u0027, \u0027startxref\u0027, \u0027xref\u0027, \u0027trailer\u0027,\n  \u0027/AA\u0027, \u0027/AcroForm\u0027, \u0027/EmbeddedFile\u0027, \u0027/Encrypt\u0027, \u0027/JBIG2Decode\u0027, \u0027/JS\u0027, \u0027/JavaScript\u0027, \u0027/Launch\u0027, \u0027/ObjStm\u0027, \u0027/OpenAction\u0027, \u0027/Page\u0027, \u0027/RichMedia\u0027, \u0027/XFA\u0027\n  ]\n\nif not results.isPdf:\n  incident.addNote(helper.createRichText(u\"Playbook \u0027Parse Utilities: PDFiD (Attachment) - Example (PB)\u0027 results\u003cbr\u003eNot a PDF file: {}\".format(results.get(\"filename\"))))\nelse:\n  # In this example we just write them to a note in the incident\n  note_data = [u\"Playbook \u0027Parse Utilities: PDFiD (Attachment) - Example (PB)\u0027 results\\nPDFID report for {} ({}):\".format(results.get(\"filename\"), results.header)]\n\n  for section in interesting_sections:\n    value = results.get(section)\n    if value is not None:\n      note_data.append(\"{}: {}\".format(section, value))\n\n  text = helper.createPlainText(\"\\n\".join(note_data))\n  incident.addNote(text)\n  \n  # Maybe extend this to alert if (/JS or /JavaScript) and (/AA or /OpenAction)\n",
          "tags": [],
          "uuid": "14db3829-9098-4802-894b-f4c9cb96671d"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_pdfid_attachment",
      "object_type": "attachment",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_404edfdc-139c-4c89-8232-dd9a5116bc88",
        "id": 25,
        "name": "playbook_404edfdc_139c_4c89_8232_dd9a5116bc88",
        "type": "playbook",
        "uuid": "525ebca9-0b97-46ad-a5c8-11f5b0ff2bb1"
      },
      "tags": [],
      "type": "default",
      "uuid": "404edfdc-139c-4c89-8232-dd9a5116bc88",
      "version": 15
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 21,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca\" isExecutable=\"true\" name=\"playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0xftpis\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: XML Transformation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fb731c0f-f0ee-4a66-8cc5-ab98495a92ca\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.parse_utilities_artifact_id = artifact.id\\ninputs.parse_utilities_incident_id = incident.id\\ninputs.parse_utilities_xml_stylesheet = \\\"cdcatalog.xslt\\\"  # CHANGEME\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"xml_transformation\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0xftpis\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ov3yvr\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"XML Transformation\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"602bf77f-9df8-4c29-b907-cf55fd082e91\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ov3yvr\u003c/incoming\u003e\u003coutgoing\u003eFlow_14ltjtk\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_14ltjtk\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0xftpis\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_1ov3yvr\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003csequenceFlow id=\"Flow_14ltjtk\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14ltjtk\" id=\"Flow_14ltjtk_di\"\u003e\u003comgdi:waypoint x=\"470\" y=\"422\"/\u003e\u003comgdi:waypoint x=\"470\" y=\"484\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ov3yvr\" id=\"Flow_1ov3yvr_di\"\u003e\u003comgdi:waypoint x=\"470\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"470\" y=\"338\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0xftpis\" id=\"Flow_0xftpis_di\"\u003e\u003comgdi:waypoint x=\"470\" y=\"106\"/\u003e\u003comgdi:waypoint x=\"470\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"181.4\" x=\"379\" y=\"54\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"372\" y=\"177.64999389648438\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"372\" y=\"337.6499938964844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"404\" y=\"483.6499938964844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1702412789291,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca",
      "description": {
        "content": "Example playbook to transform an XML document artifact using a defined xsl transform file.",
        "format": "text"
      },
      "display_name": "Parse Utilities: XML Transformation (Artifact) - Example (PB)",
      "export_key": "parse_utilities_xml_transformation_artifact",
      "field_type_handle": "playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: XML Transformation (Artifact)",
        "export_key": "playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca",
        "uuid": "22a86314-21d3-4197-8b6a-151d72c8abec"
      },
      "has_logical_errors": false,
      "id": 24,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704401361357,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702412880169,
          "description": "",
          "enabled": false,
          "export_key": "XML Transformation",
          "id": 32,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704401359637,
          "name": "XML Transformation",
          "object_type": "artifact",
          "playbook_handle": "parse_utilities_xml_transformation_artifact",
          "programmatic_name": "parse_utilities_xml_transformation_artifact_xml_transformation",
          "script_text": "results = playbook.functions.results.xml_transformation\n\n# results.content is the string representation of the transformed xml document\ncontent = helper.createRichText(\"\u003cb\u003ePlaybook \u0027Parse Utilities: XML Transformation (Artifact) - Example (PB)\u0027 results\u003c/b\u003e\u003cbr\u003e{}\".format(results.content))\nincident.addNote(content)",
          "tags": [],
          "uuid": "602bf77f-9df8-4c29-b907-cf55fd082e91"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "artifact.type",
              "method": "in",
              "type": null,
              "value": [
                "Email Attachment",
                "Malware Sample",
                "Log File",
                "Other File"
              ]
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_xml_transformation_artifact",
      "object_type": "artifact",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_f7cc5e19-32fb-4b6a-974c-3457346523ca",
        "id": 26,
        "name": "playbook_f7cc5e19_32fb_4b6a_974c_3457346523ca",
        "type": "playbook",
        "uuid": "4a0e9d5f-9c4c-4df8-8c1a-2e81d9b397b0"
      },
      "tags": [],
      "type": "default",
      "uuid": "f7cc5e19-32fb-4b6a-974c-3457346523ca",
      "version": 27
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 9,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" targetNamespace=\"http://www.camunda.org/test\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003cprocess id=\"playbook_5c981904_3da8_461c_a88b_11844f450ef0\" isExecutable=\"true\" name=\"playbook_5c981904_3da8_461c_a88b_11844f450ef0\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0xftpis\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"Parse Utilities: XML Transformation\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fb731c0f-f0ee-4a66-8cc5-ab98495a92ca\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.parse_utilities_incident_id = incident.id\\ninputs.parse_utilities_attachment_id = attachment.id\\ninputs.parse_utilities_xml_stylesheet = \\\"cdcatalog.xslt\\\"\\n\\n# If this is a \\\"task attachment\\\" then we will additionally have a task-id\\nif task is not None:\\n  inputs.parse_utilities_task_id = task.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"xml_transformation\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0xftpis\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ov3yvr\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"XML Transformation\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"0a60a5a6-e8df-4cb3-a6c0-e2dacfa350aa\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ov3yvr\u003c/incoming\u003e\u003coutgoing\u003eFlow_14ltjtk\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_14ltjtk\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0xftpis\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003csequenceFlow id=\"Flow_1ov3yvr\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003csequenceFlow id=\"Flow_14ltjtk\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_5c981904_3da8_461c_a88b_11844f450ef0\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14ltjtk\" id=\"Flow_14ltjtk_di\"\u003e\u003comgdi:waypoint x=\"470\" y=\"422\"/\u003e\u003comgdi:waypoint x=\"470\" y=\"484\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ov3yvr\" id=\"Flow_1ov3yvr_di\"\u003e\u003comgdi:waypoint x=\"470\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"470\" y=\"338\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0xftpis\" id=\"Flow_0xftpis_di\"\u003e\u003comgdi:waypoint x=\"470\" y=\"106\"/\u003e\u003comgdi:waypoint x=\"470\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"209.017\" x=\"379\" y=\"54\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"372\" y=\"177.64999389648438\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"372\" y=\"337.6499938964844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.15\" x=\"404\" y=\"483.6499938964844\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1702931250305,
      "creator_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_5c981904_3da8_461c_a88b_11844f450ef0",
      "description": {
        "content": "Example playbook to transform an XML document attachment using a defined xsl transform file.",
        "format": "text"
      },
      "display_name": "Parse Utilities: XML Transformation (Attachment) - Example (PB)",
      "export_key": "parse_utilities_xml_transformation_attachment_pb",
      "field_type_handle": "playbook_5c981904_3da8_461c_a88b_11844f450ef0",
      "fields_type": {
        "actions": [],
        "display_name": "Parse Utilities: XML Transformation (Attachment) (PB) copy",
        "export_key": "playbook_5c981904_3da8_461c_a88b_11844f450ef0",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_5c981904_3da8_461c_a88b_11844f450ef0",
        "uuid": "fd907ed1-0c4b-49b6-9f62-90f9b9c197af"
      },
      "has_logical_errors": false,
      "id": 28,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Admin User",
        "id": 1,
        "name": "admin@example.com",
        "type": "user"
      },
      "last_modified_time": 1704401339322,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1702931250371,
          "description": "",
          "enabled": false,
          "export_key": "XML Transformation",
          "id": 36,
          "language": "python3",
          "last_modified_by": "admin@example.com",
          "last_modified_time": 1704401328910,
          "name": "XML Transformation",
          "object_type": "attachment",
          "playbook_handle": "parse_utilities_xml_transformation_attachment_pb",
          "programmatic_name": "parse_utilities_xml_transformation_attachment_pb_xml_transformation",
          "script_text": "results = playbook.functions.results.xml_transformation\n\n# results.content is the string representation of the transformed xml document\ncontent = helper.createRichText(\"\u003cb\u003ePlaybook \u0027Parse Utilities: XML Transformation (Attachment) - Example (PB)\u0027 results\u003c/b\u003e\u003cbr\u003e{}\".format(results.content))\nincident.addNote(content)",
          "tags": [],
          "uuid": "0a60a5a6-e8df-4cb3-a6c0-e2dacfa350aa"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "parse_utilities_xml_transformation_attachment_pb",
      "object_type": "attachment",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_5c981904-3da8-461c-a88b-11844f450ef0",
        "id": 30,
        "name": "playbook_5c981904_3da8_461c_a88b_11844f450ef0",
        "type": "playbook",
        "uuid": "ff19b6b9-876b-4c3c-b2fe-4ab48b61db08"
      },
      "tags": [],
      "type": "default",
      "uuid": "5c981904-3da8-461c-a88b-11844f450ef0",
      "version": 14
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [
    {
      "actions": [],
      "created_date": 1701880202106,
      "description": "This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note. A workflow property is used to share the json to convert and identify parameters used on how to perform the conversion.\nTypically, a function will create workflow property and this script will run after that function to perform the conversion.\n\nFeatures:\n\n* Display the hierarchical nature of json, presenting the json keys (sorted if specified) as bold labels\n* Provide links to found URLs\n* Create either an incident note or add results to an incident (custom) rich text field.",
      "enabled": false,
      "export_key": "Convert JSON to rich text v1.3",
      "id": 6,
      "language": "python3",
      "last_modified_by": "admin@example.com",
      "last_modified_time": 1701880202125,
      "name": "Convert JSON to rich text v1.3",
      "object_type": "incident",
      "playbook_handle": null,
      "programmatic_name": "convert_json_to_rich_text_13",
      "script_text": "# (c) Copyright IBM Corp. 2010, 2023. All Rights Reserved.\nVERSION = 1.3\n\"\"\"\n  This script converts a json object into a hierarchical display of rich text and adds the rich text to an incident\u0027s rich text (custom) field or an incident note.\n  A workflow property is used to define the json to convert and identify parameters used on how to perform the conversion.\n  Typically, a function will create workflow property and this script will run after that function to perform the conversion.\n  Features:\n    * Display the hierarchical nature of json, presenting the json keys as bold labels\n    * Provide links to found URLs\n    * Create either an incident note or add results to an incident (custom) rich text field.\n  \n  In order to use this script, define a workflow property called: convert_json_to_rich_text, to define the json and parameters to use for the conversion.\n  Workflow properties can be added using a command similar to this:\n  workflow.addProperty(\u0027convert_json_to_rich_text\u0027, {\n    \"version\": 1.3,\n    \"header\": \"Artifact scan results for: {}\".format(artifact.value),\n    \"padding\": 10,\n    \"separator\": u\"\u003cbr /\u003e\",\n    \"sort\": True,\n    \"json\": results.content,\n    \"json_omit_list\": [\"omit\"],\n    \"incident_field\": None\n  })\n  \n  Format of workflow.property.convert_json_to_rich_text:\n  { \n    \"version\": 1.3, [this is for future compatibility]\n    \"header\": str, [header line to add to converted json produced or None. Ex: Results from scanning artifact: xxx. The header may contain rich text tags]\n    \"padding\": 10, [padding for nested json elements, or defaults to 10]\n    \"separator\": u\"\u003cbr /\u003e\"|list such as [\u0027\u003cspan\u003e\u0027,\u0027\u003c/span\u003e\u0027], [html separator between json keys and lists or defaults to html break: \u0027\u003cbr /\u003e\u0027. \n                                                If a list, then the data is brackets by the pair specified]\n    \"sort\": True|False, [sort the json keys at each level when displayed]\n    \"json\": json, [required json to convert]\n    \"json_omit_list\": [list of json keys to exclude or None]\n    \"incident_field\": \"\u003cincident_field\u003e\" [indicates a builtin rich text incident field, such as \u0027description\u0027 \n                                          or a custom rich text field in the format: \u0027properties.\u003cfield\u003e\u0027. default: create an incident note]\n  }\n\n  For playbooks, use playbook.addProperty() with the same format as workflow.addProperty()\n\n  Playbooks can also use playbook.functions.results.convert_json_to_rich_text using the standard function output which contains the \u0027content\u0027 json element.\n  When using playbook.functions.results.convert_json_to_rich_text with standard function results, all the defaults for padding, separator, etc. are used.\n\"\"\"\n\nimport re\n\n# needed for python 3\ntry:\n    unicode(\"abc\") # fails in py3\n    py2 = True\nexcept:\n    unicode = str\n    py2 = False\n\n\nrc = re.compile(r\u0027http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.\u0026+#\\?]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+\u0027)\n\nclass ConvertJson:\n    \"\"\"Class to hold the conversion parameters and perform the conversion\"\"\"\n\n    def __init__(self, omit_keys=[], padding=10, separator=u\"\u003cbr /\u003e\", sort_keys=False):\n        self.omit_keys = omit_keys\n        self.padding = padding\n        self.separator = separator\n        self.sort_keys = sort_keys\n\n\n    def format_link(self, item):\n        \"\"\"[summary]\n          Find embedded urls (http(s)) and add html anchor tags to display as links\n          Args:\n              item ([string])\n\n          Returns:\n              [str]: None|original text if no links|text with html links\n        \"\"\"\n        formatted_item = item\n        if py2:\n            num_type = bool(item and isinstance(item, (int, long, bool, float)))\n        else:\n            num_type = bool(item and isinstance(item, (int, bool, float)))\n\n        if item and not num_type:\n            list = rc.findall(item)\n            if list:\n                for link in list:\n                    formatted_item = formatted_item.replace(link, u\"\u003ca target=\u0027blank\u0027 href=\u0027{0}\u0027\u003e{0}\u003c/a\u003e\".format(link))\n\n        return formatted_item\n\n    def expand_list(self, list_value, is_list=False):\n        \"\"\"[summary]\n          convert items to html, adding indents to nested dictionaries.\n          Args:\n              list_value ([dict|list]): json element\n\n          Returns:\n              [str]: html converted code\n        \"\"\"\n        if not isinstance(list_value, list):\n            return self.format_link(list_value)\n        elif not list_value:\n            return u\"None\u003cbr\u003e\"\n\n        try:\n            items_list = []  # this will ensure list starts on second line of key label\n            for item in list_value:\n                if isinstance(item, dict):\n                    result = self.convert_json_to_rich_text(item)\n                    if is_list:\n                        items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(result))\n                    else:\n                        items_list.append(result)\n                elif isinstance(item, list):\n                    items_list.append(self.expand_list(item, is_list=True))\n                elif is_list:\n                    items_list.append(u\"\u003cli\u003e{}\u003c/li\u003e\".format(self.format_link(unicode(item))))\n                else:\n                    items_list.append(self.format_link(unicode(item)))\n\n            expand_list_result = self.add_separator(self.separator if not is_list else u\"\",\n                                                    items_list,\n                                                    is_list=is_list)\n\n            if is_list:\n                return u\"\u003cul\u003e{}\u003c/ul\u003e\".format(expand_list_result)\n            else:\n                return u\"\u003cdiv style=\u0027padding:5px\u0027\u003e{}\u003c/div\u003e\".format(expand_list_result)\n        except Exception as err:\n            return str(err)\n\n    def convert_json_to_rich_text(self, sub_dict):\n        \"\"\"[summary]\n          Walk dictionary tree and convert to html for better display\n          Args:\n              sub_dict ([type]): [description]\n\n          Returns:\n              [type]: [description]\n        \"\"\"\n        notes = []\n        if sub_dict and isinstance(sub_dict, (list, dict)):\n            if isinstance(sub_dict, list):\n                expanded_list = self.expand_list(sub_dict, is_list=True)\n                notes.append(self.add_separator(self.separator, expanded_list))\n            else:\n                keys = sorted (sub_dict.keys()) if self.sort_keys else sub_dict.keys()\n\n                for key in keys:\n                    if key not in self.omit_keys:\n                        value = sub_dict[key]\n                        is_list = isinstance(value, list)\n                        item_list = [u\"\u003cstrong\u003e{0}\u003c/strong\u003e: \".format(key)]\n                        if isinstance(value, dict):\n                            convert_result = self.convert_json_to_rich_text(value)\n                            if convert_result:\n                                item_list.append(u\"\u003cdiv style=\u0027padding:{}px\u0027\u003e{}\u003c/div\u003e\".format(self.padding, convert_result))\n                            else:\n                                item_list.append(u\"None\u003cbr\u003e\")\n                        else:\n                            item_list.append(self.expand_list(value, is_list=is_list))\n\n                        notes.append(self.add_separator(self.separator, u\"\".join(make_unicode(v) for v in item_list), is_list=is_list))\n\n        result_notes = u\"\".join(notes)\n        if isinstance(self.separator, list):\n            return result_notes\n        else:\n            return result_notes.replace(\n                u\"\u003c/div\u003e{0}\".format(self.separator), u\"\u003c/div\u003e\").replace(\n                u\"{0}\u003c/div\u003e\".format(self.separator), u\"\u003c/div\u003e\"\n            )  # tighten up result\n\n    def add_separator(self, separator, items, is_list=False):\n        \"\"\"\n        apply the separator to the data\n        :param separator: None, str or list such as [\u0027\u003cspan\u003e\u0027, \u0027\u003c/span\u003e\u0027]\n        :param items: str or list to add separator\n        :return: text with separator applied\n        \"\"\"\n        _items = items\n\n        if not _items:\n            return \"\u003cbr\u003e\"\n\n        if not isinstance(_items, list):\n            _items = [_items]\n\n        if isinstance(separator, list):\n            return u\"\".join([u\"{}{}{}\".format(separator[0], item, separator[1]) for item in _items])\n\n        return u\"{}{}\".format(separator.join(_items), separator if not is_list else u\"\")\n\ndef make_unicode(value):\n    if value is None:\n        return \u0027None\u0027\n\n    return unicode(value)\n\ndef get_results(property_name):\n    if playbook and playbook.functions.results[property_name] is not None:\n        return playbook.functions.results[property_name]\n    elif playbook and playbook.properties[property_name] is not None:\n        return playbook.properties[property_name]\n    elif workflow and workflow.properties[property_name] is not None:\n        return workflow.properties[property_name]\n\n    return None\n\ndef get_properties(property_name):\n    \"\"\"\n    Logic to collect the json and parameters from a workflow property.\n    Args:\n      property_name: workflow property to reference\n    Returns:\n      padding, separator, header, json_omit_list, incident_field, json, sort_keys\n    \"\"\"\n    result_properties = get_results(property_name)\n    if not result_properties:\n        helper.fail(\"Playbook/workflow property not found: {}\".format(property_name))\n\n    padding = int(result_properties.get(\"padding\", 10))\n    separator = result_properties.get(\"separator\", u\"\u003cbr /\u003e\")\n    if isinstance(separator, list) and len(separator) != 2:\n        helper.fail(\"list of separators should be specified as a pair such as [\u0027\u003cdiv\u003e\u0027, \u0027\u003c/div\u003e\u0027]: {}\".format(separator))\n\n    header = result_properties.get(\"header\")\n    sort_keys = bool(result_properties.get(\"sort\", False))\n    json_omit_list = result_properties.get(\"json_omit_list\")\n    if not json_omit_list:\n        json_omit_list = []\n    incident_field = result_properties.get(\"incident_field\")\n    \n    # workflow formatted content is \u0027json\u0027. Standard functions is \u0027content\u0027\n    json = result_properties.get(\"json\") if result_properties.get(\"json\") else result_properties.get(\"content\")\n    json_err = None\n    # is there an issue we need handle now?\n    if not json and \\\n        result_properties.get(\"success\") == False and result_properties.get(\"reason\"):\n        json_err = result_properties.get(\"reason\")\n    \n    return padding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys\n\n\n## S T A R T\npadding, separator, header, json_omit_list, incident_field, json, json_err, sort_keys = get_properties(\u0027convert_json_to_rich_text\u0027)\nif json_err:\n    result = \"Result error: {}\".format(json_err)\nelse:\n    if header:\n        if isinstance(separator, list):\n            hdr = u\"{0}{1}{2}\".format(separator[0], header, separator[1])\n        else:\n            hdr = u\"{0}{1}\".format(header, separator)\n    else:\n        hdr = u\"\"\n\n    convert = ConvertJson(omit_keys=json_omit_list, padding=padding, separator=separator, sort_keys=sort_keys)\n    converted_json = convert.convert_json_to_rich_text(json)\n    result = u\"{}{}\".format(hdr, converted_json if converted_json else \"\\nNone\")\n\nrich_text_note = helper.createRichText(result)\nif incident_field:\n    incident[incident_field] = rich_text_note\nelse:\n    incident.addNote(rich_text_note)\n",
      "tags": [],
      "uuid": "64d3e6da-8b56-4d19-9ce8-a75586f71dad"
    }
  ],
  "server_version": {
    "build_number": 16,
    "major": 48,
    "minor": 2,
    "version": "48.2.16"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [],
  "workflows": [],
  "workspaces": []
}
