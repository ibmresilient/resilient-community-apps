<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Example: Whois Query Against Artifact

## Function - Whois: Query

### API Name
`whois_query`

### Output Name
``

### Message Destination
`fn_whois`

### Pre-Processing Script
```python
inputs.whois_query = artifact.value
```

### Post-Processing Script
```python
def format_link(item):
  if item and (item.startswith("https://") or item.startswith("http://")):
    return "<a target='blank' href='{0}'>{0}</a>".format(item)
  else:
    return item

def expand_list(list_value, separator="<br>"):
  if not isinstance(list_value, list):
    return format_link(list_value)
  else:
    try:
      items = []
      for item in list_value:
        if isinstance(item, dict):
          items.append("<div style='padding:10px'>{}</div>".format(walk_dict(item)))
        else:
          items.append(format_link(item))
      return separator.join(items)
    except:
        pass
    
def walk_dict(sub_dict):
  notes = []
  for key, value in sub_dict.items():
    if key not in ['display_content']:
      if isinstance(value, dict):
        notes.append("<b>{}</b>: <div style='padding:10px'>{}</div>".format(key, walk_dict(value)))
      else:
        notes.append("<b>{}</b>: {}".format(key, expand_list(value)))
      
  return "<br>".join(notes)
    

note = "Whois for artifact: {}<br><br>".format(artifact.value)
if results["success"]:
  note = note + walk_dict(results["domain_details"])
else:
  note = note + "This Artifact has no whois information"

incident.addNote(helper.createRichText(note))

```

---

