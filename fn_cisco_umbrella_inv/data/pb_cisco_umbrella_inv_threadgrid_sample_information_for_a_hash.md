<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.4.0.1351
-->

# Playbook - Cisco Umbrella Inv: ThreatGrid sample information for a hash - Example (PB)

### API Name
`cisco_umbrella_inv_threadgrid_sample_information_for_a_hash`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`artifact.type in ['Malware MD5 Hash', 'Malware SHA-1 Hash', 'Malware SHA-256 Hash']`

### Object Type
`artifact`

### Description
Cisco Umbrella Investigate Playbook to get the ThreatGrid sample information for a hash


---
## Function - umbrella_threat_grid_sample

### API Name
`umbrella_threat_grid_sample`

### Output Name
`threatgrid_sample_hash_result`

### Message Destination
`umbrella_investigate`

### Function-Input Script
```python
None
```

---

## Local script - umbrella threatgrid sample from a hash output

### Description


### Script Type
`Local script`

### Object Type
`artifact`

### Script Content
```python
results = playbook.functions.results.threatgrid_sample_hash_result
content = results.get("content", {})
sample_basic = content.get("sample_basic", {})

if results.get("success", None):
  if sample_basic:
    newrow = incident.addRow("umbinv_thread_grid_sample_info_for_a_hash_basic")
    newrow["hash"] = content.get("hash", None)
    newrow.query_execution_time = content.get("query_execution_time", None)
    newrow["magic_type"] = sample_basic.get("magicType", None)
    newrow["sha1"] = sample_basic.get("sha1", None)
    newrow["md5"] = sample_basic.get("md5", None)
    newrow["size"] = str(sample_basic.get("size"))
    newrow["threat_score"] = str(sample_basic.get("threatScore"))
    newrow["first_seen"] = str(sample_basic.get("firstSeen"))
    newrow["last_seen"] = str(sample_basic.get("lastSeen"))
    newrow.num_behaviors = len(sample_basic.get("behaviors", []))
    newrow.num_connections = str(sample_basic.get("connections", {}).get("totalResults"))
    newrow.num_samples = str(sample_basic.get("samples", {}).get("totalResults"))
  else:
    incident.addNote("Cisco Umbrella Inv playbook: ThreatGrid sample information for a hash returned no results.")
else:
  incident.addNote(f"Cisco Umbrella Inv playbook: ThreatGrid sample information for a hash\nFailed with reason: {results.get('reason', None)}")
```

---

