<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example of Exchange Create Meeting

## Function - Exchange Create Meeting

### API Name
`exchange_create_meeting`

### Output Name
`None`

### Message Destination
`fn_exchange`

### Pre-Processing Script
```python
inputs.exchange_email = rule.properties.exchange_email if rule.properties.exchange_email is not None else inputs.exchange_email
inputs.exchange_meeting_start_time = rule.properties.exchange_meeting_start_time if rule.properties.exchange_meeting_start_time is not None else inputs.exchange_meeting_start_time
inputs.exchange_meeting_end_time = rule.properties.exchange_meeting_end_time if rule.properties.exchange_meeting_end_time is not None else inputs.exchange_meeting_end_time
inputs.exchange_meeting_subject = rule.properties.exchange_meeting_subject if rule.properties.exchange_meeting_subject is not None else inputs.exchange_meeting_subject
inputs.exchange_meeting_body = rule.properties.exchange_meeting_body if rule.properties.exchange_meeting_body is not None else inputs.exchange_meeting_body
inputs.exchange_required_attendees = rule.properties.exchange_required_attendees if rule.properties.exchange_required_attendees is not None else inputs.exchange_required_attendees
inputs.exchange_optional_attendees = rule.properties.exchange_optional_attendees if rule.properties.exchange_optional_attendees is not None else inputs.exchange_optional_attendees
```

### Post-Processing Script
```python
'''
Results:
--------
   'required_attendees':required1@example.com,required2@example.com
   'optional_attendees': optional1@example.com,...
   'sender': sender@example.com
   'subject': meeting subject
   'body': meeting body
   'start_time': epoch start time
   'end_time': epoch end time
'''

from java.util import Date

content = results.get("content")

if not results.success:
  text = u"Unable to create meeting"
  fail_reason = results.reason
  if fail_reason:
    text = u"{0}:\n\tFailure reason: {1}".format(text, fail_reason)
    
else:
  start_time = Date(content.get("start_time")).toString()
  end_time = Date(content.get("end_time")).toString()
  
  text  =  "<b>Meeting created from Exchange Create Meeting:</b><br />"
  text += f"<br />Subject: {content.get('subject')}"
  text += f"<br />Start time: {content.get('start_time')}"
  text += f"<br />End time: {content.get('end_time')}"
  text += f"<br />Required Attendees: {content.get('required_attendees')}" 
  text += f"<br />Optional Attendees: {content.get('optional_attendees')}" 
  text += f"<br />Body: {content.get('body')}"

noteText = helper.createRichText(text)
incident.addNote(noteText)
```

---

