<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Exchange Move Folder Contents and Delete Folder

## Function - Exchange Move Folder Contents and Delete Folder

### API Name
`exchange_move_folder_contents_and_delete_folder`

### Output Name
`None`

### Message Destination
`fn_exchange`

### Pre-Processing Script
```python
# Set inputs
inputs.exchange_email = inputs.exchange_email if rule.properties.exchange_email is None else rule.properties.exchange_email
inputs.exchange_delete_if_no_subfolders = inputs.exchange_delete_if_no_subfolders if rule.properties.exchange_delete_if_no_subfolders is None else rule.properties.exchange_delete_if_no_subfolders
inputs.exchange_folder_path = inputs.exchange_folder_path if rule.properties.exchange_folder_path is None else rule.properties.exchange_folder_path
inputs.exchange_destination_folder_path = inputs.exchange_destination_folder_path if rule.properties.exchange_destination_folder_path is None else rule.properties.exchange_destination_folder_path
```

### Post-Processing Script
```python
 # Example function results
        # results = {
        #     'email_ids': ['id1', 'idN'],
        #     'emails': {
        #         'id1': {
        #             'subject': 'Email Subject',
        #             'body': 'Subject body in HTML',
        #             'mime_content': mime content of message
        #             'sender_name': 'FirstName LastName',
        #             'sender_email': 'example@example.com',
        #             'attachment_ids': ['attachment_id1', 'attachment_id2'],
        #             'attachments': {
        #                 'attachment_id1': {
        #                     'attachment_name': 'attachment.xslx',
        #                     'attachment_content_type': 'spreadsheet',
        #                     'attachment_size': '8842',
        #                     'attachment_base64': 'attachment encoded in base 64'
        #                 },
        #                 'attachment_id2': {
        #                     'attachment_name': '...',
        #                     'attachment_content_type': '...',
        #                     'attachment_size': '...',
        #                     'attachment_base64': 'attachment encoded in base 64'
        #                 }
        #             }
        #         },
        #         'idN': {
        #             'subject': 'Email Subject',
        #             'body': 'Subject body in HTML',
        #             'mime_content': mime content of message
        #             'sender_name': 'FirstName LastName',
        #             'sender_email': 'example@example.com',
        #             'attachment_ids': ['attachment_id1', 'attachment_id2'],
        #             'attachments': {
        #                 'attachment_id1': {
        #                     'attachment_name': 'attachment.xslx',
        #                     'attachment_content_type': 'spreadsheet',
        #                     'attachment_size': '8842',
        #                     'attachment_base64': 'attachment encoded in base 64'
        #                 },
        #                 'attachment_id2': {
        #                     'attachment_name': '...',
        #                     'attachment_content_type': '...',
        #                     'attachment_size': '...',
        #                     'attachment_base64': 'attachment encoded in base 64'
        #                 }
        #             }
        #         }
        #     }
        # }
        
# Get email ids
email_ids = results.email_ids
# Get emails
emails = results.emails

# Loop through all queried emails
for email_id in email_ids:
  # Get email that corresponds to email_id
  email = emails[email_id]
  # Create artifacts from sender information that isn't None
  if email['sender_name']:
    incident.addArtifact('Email Sender Name', email['sender_name'], 'Sender name for email {}'.format(email_id))
  if email['sender_email']:
    incident.addArtifact('Email Sender', email['sender_email'], 'Sender email address for email {}'.format(email_id))
  if email['subject']:
    incident.addArtifact('Email Subject', email['subject'], 'Email subject for email {}'.format(email_id))
  if email['body']:
    incident.addArtifact('Email Body', email['body'], 'Email body in HTML for email {}'.format(email_id))
    
  # Loop through attachments and create artifacts and notes for them
  attachment_ids = email['attachment_ids']
  attachments = email['attachments']
  for attachment_id in attachment_ids:
    attachment = attachments[attachment_id]
    incident.addArtifact('Email Attachment Name', attachment['attachment_name'], 'Attachment name for attachment {} from email {}'.format(attachment_id, email_id))
    
    # Add note
    noteText = 'base64 attachment of {} from email {}: \n{}'.format(attachment['attachment_name'], email_id, attachment['attachment_base64'])
    incident.addNote(noteText)
```

---

