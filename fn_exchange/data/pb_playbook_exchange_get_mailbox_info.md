<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - Playbooks: Exchange Get Mailbox Info

### API Name
`playbook_exchange_get_mailbox_info`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Mailbox ID | `exchange_get_email` | text | Email address of the mailbox | Optional |

### Object Type
`incident`

### Description
Get mailbox info for an email and then creates an artifact or a note with the result.


---
## Function - Exchange Get Mailbox Info

### API Name
`exchange_get_mailbox_info`

### Output Name
`output_exchange_get_mailbox`

### Message Destination
`fn_exchange`

### Function-Input Script
```python
inputs.exchange_get_email = getattr(playbook.inputs, "exchange_get_email", None)
```

---

## Local script - Write Information to Notes

### Description
This script writes mailbox information to notes

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
'''
Example
-------
response = {
  'name': 'firstname lastname',
  'email_address': 'user@example.com',
  'routing_type': 'SMTP',
  'mailbox_type': 'Mailbox'}

'''
write_to_artifact = False

results = playbook.functions.results.output_exchange_get_mailbox
content = results.get("content")

if not results.get("success"):
  text = u"Unable to create meeting"
  fail_reason = results.get("reason")
  if fail_reason:
    text += u"Failure reason: {}".format(fail_reason)
    
else:
  if write_to_artifact:
    incident.addArtifact('Email Sender', content.get('email_address'), 'Email address from Exchange Get Mailbox Info')
    incident.addArtifact('Email Sender Name', content.get('name'), 'Email sender name from Exchange Get Mailbox Info')
  
  text  =  "<b>Microsoft Exchange Mailbox Information:</b><br />"
  text += f"<br />Name: {content.get('name')}"
  text += f"<br />Email Address: {content.get('email_address')}"
  text += f"<br />Routing Type: {content.get('routing_type')}"
  text += f"<br />Mailbox Type: {content.get('mailbox_type')}"

noteText = helper.createRichText(text)
incident.addNote(noteText)
```

---

