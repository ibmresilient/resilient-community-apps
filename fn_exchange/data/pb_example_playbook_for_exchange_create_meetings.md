<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - Playbooks: Exchange Create Meetings

### API Name
`example_playbook_for_exchange_create_meetings`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Email address | `exchange_email` | text | Email account that is used to perform this action. | Optional |
| End Time | `exchange_meeting_end_time` | datetimepicker | Meeting end time and date | Optional |
| Invite Body | `exchange_meeting_body` | textarea | Body of the meeting invite | Optional |
| Invite Subject | `exchange_meeting_subject` | text | Subject of the meeting | Optional |
| Location | `exchange_meeting_location` | text | If the meeting is conducted online, then the URL to the Room. Or the Name of the Physical location of the Meeting Room | Optional |
| Online Meeting | `exchange_is_online_meeting` | boolean | Yes, if the location provided above is a URL, else No | Optional |
| Optional Attendees | `exchange_optional_attendees` | text | Comma separated list of attendees that are mandatory for the meeting | Optional |
| Required Attendees | `exchange_required_attendees` | text | Comma separated list of attendees that are mandatory for the meeting | Optional |
| Start Time | `exchange_meeting_start_time` | datetimepicker | Date and time of the meeting | Optional |

### Object Type
`incident`

### Description
Creates a meeting with the given parameters and creates a note from the result.


---
## Function - Exchange Create Meeting

### API Name
`exchange_create_meeting`

### Output Name
`output_exchange_create_meeting`

### Message Destination
`fn_exchange`

### Function-Input Script
```python
inputs.exchange_email = getattr(playbook.inputs, "exchange_email", None)
inputs.exchange_meeting_start_time = getattr(playbook.inputs, "exchange_meeting_start_time", None)
inputs.exchange_meeting_end_time = getattr(playbook.inputs, "exchange_meeting_end_time", None)
inputs.exchange_meeting_subject = getattr(playbook.inputs, "exchange_meeting_subject", None)
inputs.exchange_required_attendees = getattr(playbook.inputs, "exchange_required_attendees", None)
inputs.exchange_optional_attendees = getattr(playbook.inputs, "exchange_optional_attendees", None)
inputs.exchange_meeting_location = getattr(playbook.inputs, "exchange_meeting_location", None)
inputs.exchange_is_online_meeting = getattr(playbook.inputs, "exchange_is_online_meeting", False)

if playbook.inputs.exchange_meeting_body and playbook.inputs.exchange_meeting_body.content:
  inputs.exchange_meeting_body = playbook.inputs.exchange_meeting_body.content

```

---

## Local script - Push Meeting Invite to DataTable

### Description
A post-processing script that processes the meeting invite and creates a note or adds it as an entry to the Datatable

### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
'''
Results:
--------
   'required_attendees':required1@example.com,required2@example.com
   'optional_attendees': optional1@example.com,...
   'sender': sender@example.com
   'subject': meeting subject
   'body': meeting body
   'start_time': 1655938800000
   'end_time': 1656025200000
   'location': https://meeting.room.com/meet/johndoe
'''
enable_write_to_datatables = True

from datetime import datetime

content = playbook.functions.results.output_exchange_create_meeting.get("content")
success = playbook.functions.results.output_exchange_create_meeting.get("success")
fail_reason = playbook.functions.results.output_exchange_create_meeting.get("reason")

if not success:
  text = u"Unable to create meeting"
  if fail_reason:
    text = u"{0}:\n\tFailure reason: {1}".format(text, fail_reason)
  noteText = helper.createRichText(text)
  incident.addNote(noteText)
    
else:
  required_attendees = ",".join(content.get('required_attendees')) if content.get('required_attendees') else ""
  optional_attendees = ",".join(content.get('optional_attendees')) if content.get('optional_attendees') else ""
  if content.get("online_meeting") is True:
    location = u"""<a href='{0}'>Meeting URL</a>""".format(content.get('location')) if content.get("location") else ""
  else:
    location = content.get('location') if content.get("location") else ""

  if enable_write_to_datatables:
    message_row = incident.addRow("exchange_dt_meeting_information")
    message_row.exchange_dt_created_time = datetime.now().strftime('%Y/%m/%d %H:%M:%S')
    message_row.exchange_dt_meeting_subject = content.get('subject')
    message_row.exchange_dt_start_time = content.get('start_time')
    message_row.exchange_dt_end_time = content.get('end_time')
    message_row.exchange_dt_mandatory_attendees = required_attendees
    message_row.exchange_dt_optional_attendees = optional_attendees
    message_row.exchange_dt_meeting_location = helper.createRichText(location)

  else:
    text  =  "<b>Meeting created from Exchange Create Meeting:</b><br />"
    text += f"<br />Subject: {content.get('subject')}"
    text += f"<br />Start time: {content.get('start_time')}"
    text += f"<br />End time: {content.get('end_time')}"
    text += f"<br />Timezone: {content.get('timezone')}"
    text += f"<br />Required Attendees: {required_attendees}" 
    text += f"<br />Optional Attendees: {optional_attendees}" 
    text += f"<br />Body: {content.get('body')}"
    text += f"<br />Location: {location}"
    text += f"<br />Online Meeting: {content.get('online_meeting')}"
    noteText = helper.createRichText(text)
    incident.addNote(noteText)

```

---

