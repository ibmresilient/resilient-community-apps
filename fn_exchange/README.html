<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="search" title="Search" href="../search.html" /><link rel="next" title="Microsoft Exchange Online" href="../fn_exchange_online/README.html" /><link rel="prev" title="Email Header Validation" href="../fn_email_header_validation/README.html" />

    <link rel="shortcut icon" href="../_static/IBM_Security_Shield.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Microsoft Exchange - QRadar SOAR Apps</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=afe95b24" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">QRadar SOAR Apps</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/IBM_Security_Light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/IBM_Security_Dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">QRadar SOAR Apps</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">New and Recently Updated Apps</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fn_service_now/README.html">ServiceNow</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ServiceNow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/install_guide/README.html">ServiceNow Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_snow_guide/README.html">ServiceNow Customization Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fn_service_now/docs/customize_resilient_guide/README.html">SOAR Customization Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fn_siemplify/README.html">Siemplify</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_vmware_cbc/README.html">VMware Carbon Black Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_iam/README.html">AWS IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_symantec_dlp/README.html">Symantec DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_resilientfeed/README.html">Data Feeder for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiz/README.html">Wiz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">App Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/python_api.html">IBM SOAR Python Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All Apps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fn_algosec/README.html">AlgoSec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_abuseipdb/README.html">AbuseIPDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_alienvault_otx/README.html">AlienVault OTX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible/README.html">Ansible for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ansible_tower/README.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_api_void/README.html">APIVoid Threat Analysis APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_guardduty/README.html">AWS GuardDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_aws_utilities/README.html">AWS Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_axonius/README.html">Axonius</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_azure_automation_utilities/README.html">Azure Automation Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bigfix/README.html">BigFix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_bmc_helix/README.html">BMC Helix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_calendar_invite/README.html">Calendar Invite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_amp4ep/README.html">Cisco Secure Endpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_asa/README.html">Cisco ASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_enforcement/README.html">Cisco Umbrella Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cisco_umbrella_inv/README.html">Cisco Umbrella Investigate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_clamav/README.html">ClamAV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_components/README.html">App Host Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_webex_meeting/README.html">Cisco WebEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_create_zoom_meeting/README.html">Zoom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_cve_search/README.html">CVE Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_darktrace/README.html">Darktrace <!-- omit in toc --></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_datatable_utils/README.html">Datatable Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_elasticsearch/README.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_email_header_validation/README.html">Email Header Validation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Microsoft Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_exchange_online/README.html">Microsoft Exchange Online</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_extrahop/README.html">ExtraHop for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_geocoding/README.html">Google Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_github/README.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_dlp/README.html">Google Cloud DLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_cloud_scc/README.html">Google Cloud Security Command Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_google_maps_directions/README.html">Google Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_googlesafebrowsing/README.html">Google Safe Browsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_greynoise/README.html">GreyNoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_grpc_interface/README.html">gRPC Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_insights_integration/README.html">Guardium Insights Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_guardium_integration/README.html">Guardium Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_hibp/README.html">Have I Been Pwned</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_html2pdf/README.html">HTML to PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_incident_utils/README.html">Incident Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ioc_parser_v2/README.html">IOC Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ipinfo/README.html">IPInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_isitphishing/README.html">IsItPhishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_jira/README.html">Jira</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_joe_sandbox_analysis/README.html">Joe Sandbox Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_kafka/README.html">Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ldap_utilities/README.html">LDAP Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_low_code/README.html">SOAR Low Code App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_maas360/README.html">MaaS360</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mandiant/README.html">Mandiant Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_atd/README.html">McAfee ATD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_epo/README.html">McAfee ePO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_esm/README.html">McAfee ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_opendxl/README.html">McAfee OpenDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mcafee_tie/README.html">McAfee TIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_defender/README.html">Microsoft Defender</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_security_graph/README.html">Microsoft Security Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_microsoft_sentinel/README.html">Microsoft Sentinel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_misp/README.html">MISP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mitre_integration/README.html">MITRE ATT&amp;CK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_mxtoolbox/README.html">MxToolBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_netdevice/README.html">netMiko</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_network_utilities/README.html">Network Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_ocr/README.html">Image OCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_odbc_query/README.html">ODBC Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_outbound_email/README.html">Outbound Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pa_panorama/README.html">Palo Alto Networks Panorama Integration for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pagerduty/README.html">PagerDuty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_parse_utilities/README.html">Parse Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_passivetotal/README.html">PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pastebin/README.html">PasteBin Creator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_phish_tank/README.html">Phish Tank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pipl/README.html">Pipl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_maker/README.html">Playbook Maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_playbook_utils/README.html">Playbook Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_tap/README.html">Proofpoint TAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_proofpoint_trap/README.html">Proofpoint TRAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_pulsedive/README.html">Pulsedive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_advisor/README.html">QRadar Advisor Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_enhanced_data/README.html">QRadar Enhanced Data Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_qradar_integration/README.html">QRadar Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_randori/README.html">Randori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rapid7_insight_idr/README.html">Rapid7 InsightIDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_reaqta/README.html">QRadar EDR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_relations/README.html">Parent/Child Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rest_api/README.html">REST API Functions for SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_rsa_netwitness/README.html">RSA NetWitness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_salesforce/README.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_soar_utils/README.html">SOAR Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_scheduler/README.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_secureworks_ctp/README.html">Secureworks CTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sentinelone/README.html">SentinelOne</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sep/README.html">Symantec Endpoint Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shadowserver/README.html">Shadowserver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_shodan/README.html">Shodan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_slack/README.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_snapshot_url/README.html">Snapshot URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_splunk_integration/README.html">Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_sumo_logic/README.html">Sumo Logic Cloud SIEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_task_utils/README.html">Task Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_teams/README.html">Microsoft Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_threatminer/README.html">ThreatMiner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_timer/README.html">Timer Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_trusteer_ppd/README.html">Trusteer Pinpoint Detect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twilio/README.html">Twilio SMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_twitter_most_popular/README.html">Twitter Search API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_url_to_dns/README.html">URL to DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlhaus/README.html">URLhaus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_urlscanio/README.html">URLScan.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_utilities/README.html">Utilities (Deprecated)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_virustotal/README.html">VirusTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html">watsonx.ai for SOAR Analysts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#app-usage">App usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#how-to-get-the-best-out-of-the-app">How to get the best out of the app</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_watsonx_analyst/README.html#soar-customizations">SOAR Customizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_webex/README.html">Cisco Webex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois/README.html">Whois</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_whois_rdap/README.html">Whois RDAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_wiki/README.html">SOAR Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_xforce/README.html">IBM XForce Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_yeti/README.html">Yeti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fn_zia/README.html">Zscaler Internet Access Functions for IBM SOAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed/README.html">Data Feed Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_elasticfeed/README.html">Data Feed Elasticsearch Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_kafkafeed/README.html">Data Feed KafkaFeed Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_odbcfeed/README.html">Data Feeder for ODBC Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc_data_feed_plugin_splunkfeed/README.html">Data Feed plugin for Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-abuseipdb/README.html">AbuseIPDB Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-haveibeenpwned/README.html">Have I Been Pwned Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-mcafeetie/README.html">McAfee TIE Threat Searcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-passivetotal/README.html">RiskIQ PassiveTotal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-shadowserver/README.html">ShadowServer Threat Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rc-cts-urlscanio/README.html">URLScan IO Threat Searcher</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="microsoft-exchange">
<h1>Microsoft Exchange<a class="headerlink" href="#microsoft-exchange" title="Link to this heading">¶</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#microsoft-exchange"><span class="xref myst">Microsoft Exchange</span></a></p>
<ul>
<li><p><a class="reference internal" href="#table-of-contents"><span class="xref myst">Table of Contents</span></a></p></li>
<li><p><a class="reference internal" href="#release-notes"><span class="xref myst">Release Notes</span></a></p></li>
<li><p><a class="reference internal" href="#overview"><span class="xref myst">Overview</span></a></p>
<ul>
<li><p><a class="reference internal" href="#key-features"><span class="xref myst">Key Features</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#requirements"><span class="xref myst">Requirements</span></a></p>
<ul>
<li><p><a class="reference internal" href="#soar-platform"><span class="xref myst">SOAR platform</span></a></p></li>
<li><p><a class="reference internal" href="#cloud-pak-for-security"><span class="xref myst">Cloud Pak for Security</span></a></p></li>
<li><p><a class="reference internal" href="#proxy-server"><span class="xref myst">Proxy Server</span></a></p></li>
<li><p><a class="reference internal" href="#python-environment"><span class="xref myst">Python Environment</span></a></p></li>
<li><p><a class="reference internal" href="#development-version"><span class="xref myst">Development Version</span></a></p></li>
<li><p><a class="reference internal" href="#endpoint-developed-with"><span class="xref myst">Endpoint Developed With</span></a></p></li>
<li><p><a class="reference internal" href="#configuration"><span class="xref myst">Configuration</span></a></p>
<ul>
<li><p><a class="reference internal" href="#timezones"><span class="xref myst">Timezones</span></a></p></li>
<li><p><a class="reference internal" href="#folder-paths"><span class="xref myst">Folder Paths</span></a></p></li>
<li><p><a class="reference internal" href="#information-as-data-tables-or-artifacts"><span class="xref myst">Information as Data-tables or Artifacts</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#installation"><span class="xref myst">Installation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#install"><span class="xref myst">Install</span></a></p></li>
<li><p><a class="reference internal" href="#app-configuration"><span class="xref myst">App Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#custom-layouts"><span class="xref myst">Custom Layouts</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#function---exchange-create-meeting"><span class="xref myst">Function - Exchange Create Meeting</span></a></p></li>
<li><p><a class="reference internal" href="#function---exchange-delete-emails"><span class="xref myst">Function - Exchange Delete Emails</span></a></p></li>
<li><p><a class="reference internal" href="#function---exchange-find-emails"><span class="xref myst">Function - Exchange Find Emails</span></a></p></li>
<li><p><a class="reference internal" href="#function---exchange-get-mailbox-info"><span class="xref myst">Function - Exchange Get Mailbox Info</span></a></p></li>
<li><p><a class="reference internal" href="#function---exchange-move-emails"><span class="xref myst">Function - Exchange Move Emails</span></a></p></li>
<li><p><a class="reference internal" href="#function---exchange-send-email"><span class="xref myst">Function - Exchange Send Email</span></a></p></li>
<li><p><a class="reference internal" href="#data-table---email-information"><span class="xref myst">Data Table - Email Information</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#data-table---meeting-information"><span class="xref myst">Data Table - Meeting Information</span></a></p>
<ul>
<li><p><a class="reference internal" href="#api-name-1"><span class="xref myst">API Name:</span></a></p></li>
<li><p><a class="reference internal" href="#columns-1"><span class="xref myst">Columns:</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#playbook"><span class="xref myst">Playbook</span></a></p></li>
<li><p><a class="reference internal" href="#troubleshooting--support"><span class="xref myst">Troubleshooting &amp; Support</span></a></p>
<ul>
<li><p><a class="reference internal" href="#for-support"><span class="xref myst">For Support</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>v2.0.0</p></td>
<td><p>February</p></td>
<td><p>UI update, Playbook Migration, Custom Layout, Data-tables, Timezone support and bug fixes</p></td>
</tr>
<tr class="row-odd"><td><p>v1.0.4</p></td>
<td><p>September 2022</p></td>
<td><p>Bugfix on Selftest</p></td>
</tr>
<tr class="row-even"><td><p>v1.0.3</p></td>
<td><p>June 2022</p></td>
<td><p>Add support for Python 3.9.</p></td>
</tr>
<tr class="row-odd"><td><p>v1.0.2</p></td>
<td><p>June 2021</p></td>
<td><p>Fix for <code class="docutils literal notranslate"><span class="pre">selftest</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>v1.0.1</p></td>
<td><p>December 2020</p></td>
<td><p>Added App Host support, Added proxy support.</p></td>
</tr>
<tr class="row-odd"><td><p>v1.0.0</p></td>
<td><p>August 2018</p></td>
<td><p>Initial Release.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p><strong>Integrate with Microsoft Exchange email and meeting functionality</strong></p>
<p><img alt="screenshot: main" src="../_images/main15.png" /></p>
<p>This application extends the capabilities of the SOAR platform with Microsoft Exchange On-prem services and functionality. Emails from an exchange mailbox can now be read, written, sent, queried, deleted, and moved from within the platform. Both Online and in-person meetings can be scheduled and invites can be sent using this application. All extracted information is now tabulated and neatly displayed in a separate incident tab. <br></p>
<section id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Compose and send emails to multiple recipients.<br></p></li>
<li><p>Schedule an Online meeting in Microsoft Exchange and send out invites with links to the meeting.<br></p></li>
<li><p>Schedule an Offline meeting and send out invites with information regarding meeting venue.<br></p></li>
<li><p>Saved all scheduled meetings as incident notes or in a separate incident tab called Exchange.<br></p></li>
<li><p>Get emails from a user’s mailbox and filter them based on fundamental attributes including the sender’s email address, the location of the email’s folder, the subject, the body, and if it contains attachments.<br></p></li>
<li><p>Conduct a thorough search of the user’s mailbox by tunneling subfolders, conducting the search based on the beginning and ending dates of emails received, sorting emails by recency, and limiting the number of emails obtained.</p></li>
<li><p>Save all retrieved information as either artifacts or tabulate in a separate incident tab called Exchange.<br></p></li>
<li><p>Delete email permanently from a user’s mailbox or move them to the Trash folder.<br></p></li>
<li><p>Migrate all the contents of a folder to another.<br></p></li>
<li><p>Get mailbox information for a particular sender.<br></p></li>
<li><p>All the above mentioned functionality has now been incorporated with Playbooks<br></p></li>
</ul>
</section>
</section>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>This app supports the IBM Security QRadar SOAR Platform and the IBM Security QRadar SOAR for IBM Cloud Pak for Security.</p>
<section id="soar-platform">
<h3>SOAR platform<a class="headerlink" href="#soar-platform" title="Link to this heading">¶</a></h3>
<p>The SOAR platform supports two app deployment mechanisms, Edge Gateway (formerly App Host) and integration server.</p>
<p>If deploying to a SOAR platform with an integration server, the requirements are:</p>
<ul>
<li><p>SOAR platform &gt;= <code class="docutils literal notranslate"><span class="pre">46.0</span></code>.</p></li>
<li><p>The app is in the older integration format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file which contains a <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file).</p></li>
<li><p>Integration server is running <code class="docutils literal notranslate"><span class="pre">resilient_circuits&gt;=48.0.0</span></code>.</p></li>
<li><p>If using an API key account, make sure the account provides the following minimum permissions:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Permissions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Org Data</p></td>
<td><p>Read</p></td>
</tr>
<tr class="row-odd"><td><p>Function</p></td>
<td><p>Read</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<p>The following SOAR platform guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>Integration Server Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings.</p></li>
<li><p><em>System Administrator Guide</em>: provides the procedure to install, configure and deploy apps.</p></li>
</ul>
<p>The above guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>. On this web page, select your SOAR platform version. On the follow-on page, you can find the <em>Edge Gateway Deployment Guide</em>, <em>App Host Deployment Guide</em>, or <em>Integration Server Guide</em> by expanding <strong>Apps</strong> in the Table of Contents pane. The System Administrator Guide is available by expanding <strong>System Administrator</strong>.</p>
</section>
<section id="cloud-pak-for-security">
<h3>Cloud Pak for Security<a class="headerlink" href="#cloud-pak-for-security" title="Link to this heading">¶</a></h3>
<p>If you are deploying to IBM Cloud Pak for Security, the requirements are:</p>
<ul class="simple">
<li><p>IBM Cloud Pak for Security &gt;= <code class="docutils literal notranslate"><span class="pre">1.10</span></code>.</p></li>
<li><p>Cloud Pak is configured with an Edge Gateway.</p></li>
<li><p>The app is in a container-based format (available from the AppExchange as a <code class="docutils literal notranslate"><span class="pre">zip</span></code> file).</p></li>
</ul>
<p>The following Cloud Pak guides provide additional information:</p>
<ul class="simple">
<li><p><em>Edge Gateway Deployment Guide</em> or <em>App Host Deployment Guide</em>: provides installation, configuration, and troubleshooting information, including proxy server settings. From the Table of Contents, select Case Management and Orchestration &amp; Automation &gt; <strong>Orchestration and Automation Apps</strong>.</p></li>
<li><p><em>System Administrator Guide</em>: provides information to install, configure, and deploy apps. From the IBM Cloud Pak for Security IBM Documentation table of contents, select Case Management and Orchestration &amp; Automation &gt; <strong>System administrator</strong>.</p></li>
</ul>
<p>These guides are available on the IBM Documentation website at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a>. From this web page, select your IBM Cloud Pak for Security version. From the version-specific IBM Documentation page, select Case Management and Orchestration &amp; Automation.</p>
</section>
<section id="proxy-server">
<h3>Proxy Server<a class="headerlink" href="#proxy-server" title="Link to this heading">¶</a></h3>
<p>The app <strong>does</strong> support a proxy server.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Link to this heading">¶</a></h3>
<p>Python 3.6 and Python 3.9 are supported.
Additional package dependencies may exist for each of these packages:</p>
<ul class="simple">
<li><p>exchangelib ~= 4.6.2;python_version==’3.6’</p></li>
<li><p>exchangelib ~= 4.9.0;python_version&gt;=’3.9’</p></li>
<li><p>resilient_circuits&gt;=48.0.0</p></li>
</ul>
</section>
<section id="development-version">
<h3>Development Version<a class="headerlink" href="#development-version" title="Link to this heading">¶</a></h3>
<p>This app has been implemented using:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Product Name</p></th>
<th class="head"><p>Product Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Microsoft Exchange</p></td>
<td><p>2016</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="endpoint-developed-with">
<h3>Endpoint Developed With<a class="headerlink" href="#endpoint-developed-with" title="Link to this heading">¶</a></h3>
<p>This app has been implemented using <strong>Microsoft Exchange Server</strong></p>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h3>
<p>Please pay attention to the below mentioned pointers as the application can be slightly complex and confusing to configure.</p>
<section id="timezones">
<h4>Timezones<a class="headerlink" href="#timezones" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>The application now has the ability to set a default timezone from the app.conf. Timezones are to be specified using their <code class="docutils literal notranslate"><span class="pre">Tz</span> <span class="pre">Database</span> <span class="pre">name</span></code>. Here are a few examples:</p></li>
</ul>
<ul class="simple">
<li><p>timezone = Europe/Dublin</p></li>
<li><p>timezone = Etc/GMT+2</p></li>
<li><p>timezone = Asia/Kolkata</p></li>
<li><p>timezone = Etc/GMT</p></li>
</ul>
</section>
<section id="folder-paths">
<h4>Folder Paths<a class="headerlink" href="#folder-paths" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>When the <code class="docutils literal notranslate"><span class="pre">Source</span> <span class="pre">location</span></code> or the <code class="docutils literal notranslate"><span class="pre">exchange_folder_path</span></code> fields are left empty, they are substituted with the value specified for <code class="docutils literal notranslate"><span class="pre">default_folder_path</span></code> in app.conf</p></li>
<li><p>The path related fields might be slightly complicated to configure as they tend to vary with the Exchange environment. Upon entering an invalid folder path, a tree structure of the folder hierarchy will be printed. Here is an example:</p></li>
</ul>
<p><img alt="screenshot: fn-exchange-folder-path " src="../_images/fn-exchange-folder-path.png" /></p>
<ul class="simple">
<li><p>Example folder paths given this folder structure
could be any path following the root path:</p>
<ul>
<li><p>Top of Information Store/Inbox</p></li>
<li><p>Top of Information Store/Deleted Items</p></li>
<li><p>Finder/Unread Mail</p></li>
<li><p>Finder</p></li>
</ul>
</li>
<li><p>Additionally, if the <code class="docutils literal notranslate"><span class="pre">exchange_search_subfolders</span></code> path is set to true, every folder in its branch will be included in the query. For example if the specified folder is <strong>Recoverable Items</strong>, then the searched folders would be:</p>
<ul>
<li><p>Recoverable Items</p></li>
<li><p>Recoverable Items/Deletions</p></li>
<li><p>Recoverable Items/Purges</p></li>
<li><p>Recoverable Items/Versions</p></li>
</ul>
</li>
<li><p>To search folder paths, the specified account in config file must have access to the searched folders. Folders that contain <code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">,</span></code> must be wrapped in quotes.</p>
<ul>
<li><p>Example/”One/With/Quotes”/Folder</p></li>
<li><p>Example/”One, with, commas”/Folder</p></li>
<li><p>Example/”One/with, both”/Folder</p></li>
</ul>
</li>
<li><p>Multiple folder paths can be specified by separating them with commas and following the above rules.</p></li>
</ul>
</section>
<section id="information-as-data-tables-or-artifacts">
<h4>Information as Data-tables or Artifacts<a class="headerlink" href="#information-as-data-tables-or-artifacts" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>Information extracted from emails and meetings can now be either added as artifacts (legacy) or to data-tables present in the Exchange tab of an Incident. This behavior can be changed by toggling the <code class="docutils literal notranslate"><span class="pre">enable_write_to_datatables</span></code> option found in the Post processing scripts of the workflows.</p></li>
<li><p>For more information on specific function inputs, check the tooltips.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<section id="install">
<h3>Install<a class="headerlink" href="#install" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To install or uninstall an App or Integration on the <em>SOAR platform</em>, see the documentation at <a class="reference external" href="https://ibm.biz/soar-docs">ibm.biz/soar-docs</a>.</p></li>
<li><p>To install or uninstall an App on <em>IBM Cloud Pak for Security</em>, see the documentation at <a class="reference external" href="https://ibm.biz/cp4s-docs">ibm.biz/cp4s-docs</a> and follow the instructions above to navigate to Orchestration and Automation.</p></li>
</ul>
</section>
<section id="app-configuration">
<h3>App Configuration<a class="headerlink" href="#app-configuration" title="Link to this heading">¶</a></h3>
<p>The following table provides the settings you need to configure the app. These settings are made in the app.config file. See the documentation discussed in the Requirements section for the procedure.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Config</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>default_folder_path</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Inbox</span></code></p></td>
<td><p><em>Some folder path after root Multiple folder paths must be separated by commas.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>server</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">example.com</span></code></p></td>
<td><p><em>Exchange server DNS name or ip address.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>email</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">admin&#64;example.com</span></code></p></td>
<td><p><em>default account to send emails and create meetings if one was not specified. Specifying an account that is not this one will require impersonation access.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>username</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">domain\username</span></code></p></td>
<td><p><em>Admin account with mailbox access to other accounts.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>password</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">password</span></code></p></td>
<td><p><em>Password of Admin account.</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>verify_cert</strong></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p><em>Use a CA cert for access to an Exchange server.</em></p></td>
</tr>
<tr class="row-even"><td><p><strong>timezone</strong></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Etc/GMT</span></code></p></td>
<td><p><em>Default Timezone for the application. Used for Meetings and querying emails.</em></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="custom-layouts">
<h3>Custom Layouts<a class="headerlink" href="#custom-layouts" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Import the Data Tables and Custom Fields like the screenshot below:</p></li>
</ul>
<p><img alt="screenshot: layout_tab.png" src="../_images/layout_tab.png" /></p>
<p><img alt="screenshot: layout_datatables.png" src="../_images/layout_datatables.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="function-exchange-create-meeting">
<h2>Function - Exchange Create Meeting<a class="headerlink" href="#function-exchange-create-meeting" title="Link to this heading">¶</a></h2>
<p>Creates a meeting and sends out invitation to attendees. The user is provided with the option to choose required and optional attendees. If its a virtual meeting, the user now has the ability to specify the URL to the meeting room and mark the invite as an online meeting.</p>
<p><img alt="screenshot: popup_create_meeting.png" src="../_images/popup_create_meeting.png" /></p>
<p><img alt="screenshot: workflow_create_meeting.png" src="../_images/workflow_create_meeting.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_email</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Email account that is used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_meeting_subject</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meeting</span> <span class="pre">Subject</span></code></p></td>
<td><p>Subject of exchange meeting</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_meeting_body</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Meeting</span> <span class="pre">Body</span></code></p></td>
<td><p>Body of exchange meeting</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_meeting_end_time</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>When the meeting should end</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_meeting_start_time</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>When the meeting should start</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_optional_attendees</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user1&#64;example.com,</span> <span class="pre">user2&#64;example.com</span></code></p></td>
<td><p>Comma separated list of optional attendees</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_required_attendees</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user1&#64;example.com,</span> <span class="pre">user2&#64;example.com</span></code></p></td>
<td><p>Comma separated list of required attendees</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_meeting_location</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">https://meeting.room.com/meet/user</span></code></p></td>
<td><p>If the meeting is conducted online, then the URL to the Room. Or the name of the physical location of the Meeting Room</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_is_online_meeting</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Specifies if the location provided in the above filled is a link or not</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Please be present&quot;</span><span class="p">,</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Please be present&quot;</span><span class="p">,</span>
    <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-24 13:00:37&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;online_meeting&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;optional_attendees&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;johndoe.s.1@exchange2016.com&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;required_attendees&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;sampleuser@exchange2016.com&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.n@exchange2016.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-24 12:00:37&quot;</span><span class="p">,</span>
    <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Weekly Meeting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timezone&quot;</span><span class="p">:</span> <span class="s2">&quot;Etc/GMT&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-24 13:00:37&quot;</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;exchange_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.n@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_is_online_meeting&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;exchange_meeting_body&quot;</span><span class="p">:</span> <span class="s2">&quot;Please be present&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_meeting_end_time&quot;</span><span class="p">:</span> <span class="mi">1679662837000</span><span class="p">,</span>
      <span class="s2">&quot;exchange_meeting_location&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_meeting_start_time&quot;</span><span class="p">:</span> <span class="mi">1679659237000</span><span class="p">,</span>
      <span class="s2">&quot;exchange_meeting_subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Weekly Meeting&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_optional_attendees&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.1@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_required_attendees&quot;</span><span class="p">:</span> <span class="s2">&quot;sampleuser@exchange2016.com&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">3233</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;exchange2016&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-exchange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-01 14:28:03&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;online_meeting&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;optional_attendees&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;johndoe.s.1@exchange2016.com&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">required_attendees</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">sampleuser@exchange2016.com</span><span class="se">\&quot;</span><span class="s2">], </span><span class="se">\&quot;</span><span class="s2">optional_attendees</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">johndoe.s.1@exchange2016.com</span><span class="se">\&quot;</span><span class="s2">], </span><span class="se">\&quot;</span><span class="s2">sender</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">johndoe.n@exchange2016.com</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">subject</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Security Weekly Meeting</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">body</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Please be present</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">start_time</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">2023-03-24 12:00:37</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">end_time</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">2023-03-24 13:00:37</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">timezone</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Etc/GMT</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">location</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">https://example.com</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">online_meeting</span><span class="se">\&quot;</span><span class="s2">: true}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;required_attendees&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;sampleuser@exchange2016.com&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.n@exchange2016.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-24 12:00:37&quot;</span><span class="p">,</span>
  <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Weekly Meeting&quot;</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;timezone&quot;</span><span class="p">:</span> <span class="s2">&quot;Etc/GMT&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_start_time</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_meeting_start_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_end_time</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_meeting_end_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_subject</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_meeting_subject&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_required_attendees</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_required_attendees&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_optional_attendees</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_optional_attendees&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_location</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_meeting_location&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_is_online_meeting</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_is_online_meeting&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_body</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_body</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_body</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_meeting_body</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Push Meeting Invite to DataTable Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Results:</span>
<span class="sd">--------</span>
<span class="sd">   &#39;required_attendees&#39;:required1@example.com,required2@example.com</span>
<span class="sd">   &#39;optional_attendees&#39;: optional1@example.com,...</span>
<span class="sd">   &#39;sender&#39;: sender@example.com</span>
<span class="sd">   &#39;subject&#39;: meeting subject</span>
<span class="sd">   &#39;body&#39;: meeting body</span>
<span class="sd">   &#39;start_time&#39;: 1655938800000</span>
<span class="sd">   &#39;end_time&#39;: 1656025200000</span>
<span class="sd">   &#39;location&#39;: https://meeting.room.com/meet/johndoe</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">enable_write_to_datatables</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">content</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_create_meeting</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_create_meeting</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="n">fail_reason</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_create_meeting</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Unable to create meeting&quot;</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fail_reason</span><span class="p">)</span>
  <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
  <span class="n">required_attendees</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;required_attendees&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;required_attendees&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  <span class="n">optional_attendees</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;optional_attendees&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;optional_attendees&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;online_meeting&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">location</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;a href=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&gt;Meeting URL&lt;/a&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

  <span class="k">if</span> <span class="n">enable_write_to_datatables</span><span class="p">:</span>
    <span class="n">message_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;exchange_dt_meeting_information&quot;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_created_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_meeting_subject</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_start_time</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start_time&#39;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_end_time</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end_time&#39;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_mandatory_attendees</span> <span class="o">=</span> <span class="n">required_attendees</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_optional_attendees</span> <span class="o">=</span> <span class="n">optional_attendees</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_meeting_location</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="n">text</span>  <span class="o">=</span>  <span class="s2">&quot;&lt;b&gt;Meeting created from Exchange Create Meeting:&lt;/b&gt;&lt;br /&gt;&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Subject: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Start time: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start_time&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;End time: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end_time&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Timezone: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timezone&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Required Attendees: </span><span class="si">{</span><span class="n">required_attendees</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Optional Attendees: </span><span class="si">{</span><span class="n">optional_attendees</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Body: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Location: </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Online Meeting: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;online_meeting&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-exchange-delete-emails">
<h2>Function - Exchange Delete Emails<a class="headerlink" href="#function-exchange-delete-emails" title="Link to this heading">¶</a></h2>
<p>Emails can be queried from a user’s mailbox and deleted. These emails can be filtered based on fundamental attributes including the sender’s email address, the location of the email’s folder, the subject, the body, and if it contains attachments. A thorough search can be performed on the user’s mailbox by tunneling subfolders, beginning and ending dates of emails received, sorting emails by recency, and limiting the number of emails obtained. Once these emails are selected, the user has an option to either permanently delete the emails or move them to the Trash folder. The email information retrieved form the mailbox is now stored in a data-table available under the Exchange incident tab. The ability to store information as artifacts is also retained. This can be turned on from within the <code class="docutils literal notranslate"><span class="pre">Push</span> <span class="pre">Emails</span> <span class="pre">to</span> <span class="pre">DataTables</span></code> of this Playbook.</p>
<p><img alt="screenshot: popup_delete_email.png" src="../_images/popup_delete_email.png" /></p>
<p><img alt="screenshot: workflow_delete_email.png" src="../_images/workflow_delete_email.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_email</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Email account that is used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma separated list of email ids</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_end_date</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">03/24/2023</span> <span class="pre">13:00:37</span> <span class="pre">+00:00</span></code></p></td>
<td><p>Get emails until after this date, leave empty to not set an end date</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_start_date</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">03/24/2023</span> <span class="pre">13:00:37</span> <span class="pre">+00:00</span></code></p></td>
<td><p>Get emails on or after this date, leave empty to not set a start date</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_folder_path</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store,Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Inbox,Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Drafts,...</span></code></p></td>
<td><p>Comma separated list of folder paths to query from</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_hard_delete</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Yes for hard deletion. No for soft deletion (move to deleted folder)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_has_attachments</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>True to include attachments, False to exclude attachments, leave empty to get all</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_body</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Hello,</span> <span class="pre">how</span> <span class="pre">are</span> <span class="pre">you?</span></code></p></td>
<td><p>Text for the message body of an email to query or to send, depending on the function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_subject</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Invitation:</span> <span class="pre">Security</span> <span class="pre">Meeting</span></code></p></td>
<td><p>Text for the subject of an email to query or send depending on the function.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_num_emails</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
<td><p>Number of emails to be selected</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_order_by_recency</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>Yes to get newest emails first, No to get oldest emails first, leave empty to ignore time sent</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_search_subfolders</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Yes to search subfolders, No or leave empty to not search subfolders</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_sender</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Only get emails from this sender, leave blank to ignore sender attribute</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;exchange_email&quot;</span><span class="p">:</span> <span class="s2">&quot;exampleuser1@outlook2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_ids&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_end_date&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_folder_path&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_hard_delete&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;exchange_has_attachments&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Weekly Meeting&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_num_emails&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;exchange_order_by_recency&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_search_subfolders&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_sender&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_start_date&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">1293</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;exchange2016&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-exchange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-02-28 20:21:08&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;The SMTP address has no mailbox associated with it.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set inputs</span>
<span class="c1"># For for information on input values, read tooltips</span>
<span class="c1"># For information on input values, read tooltips</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_hard_delete</span>     <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_hard_delete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_hard_delete</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_operation</span> <span class="o">=</span> <span class="s2">&quot;DELETED&quot;</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_operation</span> <span class="o">=</span> <span class="s2">&quot;TRASHED&quot;</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>           <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_ids</span>       <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email_ids&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_sender</span>          <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_sender&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_subject</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_start_date</span>      <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_start_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_end_date</span>        <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_end_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_num_emails</span>      <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_num_emails&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_folder_path</span>     <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_folder_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_order_by_recency</span>  <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_order_by_recency&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_search_subfolders</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_search_subfolders&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_has_attachments</span>   <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_has_attachments&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span>

</pre></div>
</div>
</p>
</details>
<details><summary>Push Emails to DataTables Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">Example function results:</span>
<span class="sd">------------------------</span>
<span class="sd">    {</span>
<span class="sd">      &#39;email_ids&#39;: [&#39;id1&#39;, &#39;idN&#39;],</span>
<span class="sd">      &#39;emails&#39;: {</span>
<span class="sd">          &#39;id1&#39;: {</span>
<span class="sd">              &#39;subject&#39;: &#39;Email Subject&#39;,</span>
<span class="sd">              &#39;body&#39;: &#39;Subject body in HTML&#39;,</span>
<span class="sd">              &#39;mime_content&#39;: mime content of message</span>
<span class="sd">              &#39;sender_name&#39;: &#39;FirstName LastName&#39;,</span>
<span class="sd">              &#39;sender_email&#39;: &#39;example@example.com&#39;,</span>
<span class="sd">              &#39;attachment_ids&#39;: [&#39;attachment_id1&#39;, &#39;attachment_id2&#39;],</span>
<span class="sd">              &#39;attachments&#39;: {</span>
<span class="sd">                  &#39;attachment_id1&#39;: {</span>
<span class="sd">                      &#39;attachment_name&#39;: &#39;attachment.xslx&#39;,</span>
<span class="sd">                      &#39;attachment_content_type&#39;: &#39;spreadsheet&#39;,</span>
<span class="sd">                      &#39;attachment_size&#39;: &#39;8842&#39;,</span>
<span class="sd">                      &#39;attachment_base64&#39;: &#39;attachment encoded in base 64&#39;},</span>
<span class="sd">                  &#39;attachment_id2&#39;: {</span>
<span class="sd">                      &#39;attachment_name&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_content_type&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_size&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_base64&#39;: &#39;attachment encoded in base 64&#39;}}},</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Enable to add all information to a datatable found in the Exchange tab.</span>
<span class="n">enable_write_to_datatables</span>  <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Enable to add attachments found as a base64 encoded value. This option only works when enable_write_to_datatables is set to False</span>
<span class="n">enable_add_attachment_value</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_emails</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
<span class="n">content</span>   <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="n">emails</span>    <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;emails&quot;</span><span class="p">)</span>
<span class="n">email_ids</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;email_ids&quot;</span><span class="p">)</span>
<span class="n">status_colour_map</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;QUERIED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#B0C4DE&quot;</span><span class="p">,</span> <span class="c1"># LightSteelBlue</span>
  <span class="s2">&quot;MOVED&quot;</span>   <span class="p">:</span> <span class="s2">&quot;#B8860B&quot;</span><span class="p">,</span> <span class="c1"># DarkGoldenrod</span>
  <span class="s2">&quot;TRASHED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#CD5C5C&quot;</span><span class="p">,</span> <span class="c1"># IndianRed</span>
  <span class="s2">&quot;DELETED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#B22222&quot;</span><span class="p">}</span> <span class="c1"># Firebrick</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Unable to find emails&quot;</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fail_reason</span><span class="p">)</span>
  <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">email_id</span> <span class="ow">in</span> <span class="n">email_ids</span><span class="p">:</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">emails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">email_id</span><span class="p">)</span>
    <span class="n">attachment_ids</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attachment_ids&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">enable_write_to_datatables</span><span class="p">:</span>

      <span class="n">email_status</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exchange_email_operation&quot;</span><span class="p">)</span>
      <span class="n">email_status</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;p style= &quot;color:</span><span class="si">{color}</span><span class="s2">&quot;&gt;</span><span class="si">{status}</span><span class="s2"> &lt;/p&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">status_colour_map</span><span class="p">[</span><span class="n">email_status</span><span class="p">],</span> <span class="n">status</span><span class="o">=</span><span class="n">email_status</span><span class="p">)</span>

      <span class="n">message_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;exchange_email_information_dt&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_date_of_retrieval</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_id</span> <span class="o">=</span> <span class="n">email_id</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_recipient_email</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_email&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_sender_email</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_email_status</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">email_status</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_subject</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_count_attachments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">attachment_ids</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="n">attachments</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attachments&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_name&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender Name&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;sender_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Sender name for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_email&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;sender_email&#39;</span><span class="p">],</span> <span class="s1">&#39;Sender email address for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Subject&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span> <span class="s1">&#39;Email subject for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Body&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">],</span> <span class="s1">&#39;Email body in HTML for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>

      <span class="k">for</span> <span class="n">attachment_id</span> <span class="ow">in</span> <span class="n">attachment_ids</span><span class="p">:</span>
        <span class="n">attachment</span> <span class="o">=</span> <span class="n">attachments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Attachment Name&#39;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Attachment name for attachment </span><span class="si">{}</span><span class="s1"> from email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">,</span> <span class="n">email_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">enable_add_attachment_value</span><span class="p">:</span>
          <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Attachment&#39;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_base64&#39;</span><span class="p">],</span> <span class="s1">&#39;Attachment file </span><span class="si">{}</span><span class="s1"> base64 encoded : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_name&#39;</span><span class="p">],</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_base64&#39;</span><span class="p">]))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-exchange-find-emails">
<h2>Function - Exchange Find Emails<a class="headerlink" href="#function-exchange-find-emails" title="Link to this heading">¶</a></h2>
<p>Emails can be queried from a user’s mailbox and deleted. These emails can be filtered based on fundamental attributes including the sender’s email address, the location of the email’s folder, the subject, the body, and if it contains attachments. A thorough search can be performed on the user’s mailbox by tunneling subfolders, beginning and ending dates of emails received, sorting emails by recency, and limiting the number of emails obtained. The email retrieved form the mailbox can now be stored in a data-table available under the Exchange incident tab. The ability to store information as artifacts is also retained. This can be turned on from within the <code class="docutils literal notranslate"><span class="pre">Push</span> <span class="pre">Emails</span> <span class="pre">to</span> <span class="pre">DataTables</span> <span class="pre">Script</span></code> of this playbook.</p>
<p><img alt="screenshot: popup_find_email.png" src="../_images/popup_find_email.png" /></p>
<p><img alt="screenshot: workflow_find_email.png" src="../_images/workflow_find_email.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_email</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Email account that is used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma separated list of email ids</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_start_date</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">03/24/2023</span> <span class="pre">13:00:37</span> <span class="pre">+00:00</span></code></p></td>
<td><p>Get emails on or after this date, leave empty to not set a start date</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_end_date</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">03/24/2023</span> <span class="pre">13:00:37</span> <span class="pre">+00:00</span></code></p></td>
<td><p>Get emails until after this date, leave empty to not set an end date</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_folder_path</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store,Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Inbox,Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Drafts,...</span></code></p></td>
<td><p>Comma separated list of folder paths to query from</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_has_attachments</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>True to include attachments, False to exclude attachments, leave empty to get all</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_body</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Hello,</span> <span class="pre">how</span> <span class="pre">are</span> <span class="pre">you?</span></code></p></td>
<td><p>Text for the message body of an email to query or to send, depending on the function.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_subject</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Invitation:</span> <span class="pre">Security</span> <span class="pre">Meeting</span></code></p></td>
<td><p>Text for the subject of an email to query or send depending on the function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_num_emails</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
<td><p>Number of emails to be selected</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_order_by_recency</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>Yes to get newest emails first, No to get oldest emails first, leave empty to ignore time sent</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_search_subfolders</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Yes to search subfolders, No or leave empty to not search subfolders</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_sender</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Only get emails from this sender, leave blank to ignore sender attribute</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;email_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">8a9cc4cff1414ae38fa9b3fa85674f04@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">53fe9fb07c4b48218c611b835c1e9603@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;emails&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">53fe9fb07c4b48218c611b835c1e9603@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">style type=</span><span class="se">\&quot;</span><span class="s2">text/css</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">display:none;</span><span class="se">\&quot;\u003e\u003c</span><span class="s2">!-- P {margin-top:0;margin-bottom:0;} --</span><span class="se">\u003e\u003c</span><span class="s2">/style</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">div id=</span><span class="se">\&quot;</span><span class="s2">divtagdefaultwrapper</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">font-size:12pt;color:#000000;font-family:Calibri,Helvetica,sans-serif;</span><span class="se">\&quot;</span><span class="s2"> dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">p</span><span class="se">\u003e</span><span class="s2">sent from </span><span class="se">\u003c</span><span class="s2">span</span><span class="se">\u003e</span><span class="s2">johndoe.s.1@exchange2016.com</span><span class="se">\u003c</span><span class="s2">/span</span><span class="se">\u003e\u003c</span><span class="s2">br</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/p</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/div</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe@exchange2016.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;test shared mailbox&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">8a9cc4cff1414ae38fa9b3fa85674f04@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">style type=</span><span class="se">\&quot;</span><span class="s2">text/css</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">display:none;</span><span class="se">\&quot;\u003e\u003c</span><span class="s2">!-- P {margin-top:0;margin-bottom:0;} --</span><span class="se">\u003e\u003c</span><span class="s2">/style</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">div id=</span><span class="se">\&quot;</span><span class="s2">divtagdefaultwrapper</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">font-size:12pt;color:#000000;font-family:Calibri,Helvetica,sans-serif;</span><span class="se">\&quot;</span><span class="s2"> dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">p</span><span class="se">\u003e\u003c</span><span class="s2">span</span><span class="se">\u003e</span><span class="s2">send to shared mailbox</span><span class="se">\u003c</span><span class="s2">/span</span><span class="se">\u003e\u003c</span><span class="s2">br</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/p</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/div</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe@exchange2016.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;send to shared mailbox&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;email_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">8a9cc4cff1414ae38fa9b3fa85674f04@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">53fe9fb07c4b48218c611b835c1e9603@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;emails&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">53fe9fb07c4b48218c611b835c1e9603@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">style type=</span><span class="se">\&quot;</span><span class="s2">text/css</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">display:none;</span><span class="se">\&quot;\u003e\u003c</span><span class="s2">!-- P {margin-top:0;margin-bottom:0;} --</span><span class="se">\u003e\u003c</span><span class="s2">/style</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">div id=</span><span class="se">\&quot;</span><span class="s2">divtagdefaultwrapper</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">font-size:12pt;color:#000000;font-family:Calibri,Helvetica,sans-serif;</span><span class="se">\&quot;</span><span class="s2"> dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">p</span><span class="se">\u003e</span><span class="s2">sent from </span><span class="se">\u003c</span><span class="s2">span</span><span class="se">\u003e</span><span class="s2">johndoe.s.1@exchange2016.com</span><span class="se">\u003c</span><span class="s2">/span</span><span class="se">\u003e\u003c</span><span class="s2">br</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/p</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/div</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;test shared mailbox&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">8a9cc4cff1414ae38fa9b3fa85674f04@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">style type=</span><span class="se">\&quot;</span><span class="s2">text/css</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">display:none;</span><span class="se">\&quot;\u003e\u003c</span><span class="s2">!-- P {margin-top:0;margin-bottom:0;} --</span><span class="se">\u003e\u003c</span><span class="s2">/style</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">div id=</span><span class="se">\&quot;</span><span class="s2">divtagdefaultwrapper</span><span class="se">\&quot;</span><span class="s2"> style=</span><span class="se">\&quot;</span><span class="s2">font-size:12pt;color:#000000;font-family:Calibri,Helvetica,sans-serif;</span><span class="se">\&quot;</span><span class="s2"> dir=</span><span class="se">\&quot;</span><span class="s2">ltr</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">p</span><span class="se">\u003e\u003c</span><span class="s2">span</span><span class="se">\u003e</span><span class="s2">send to shared mailbox</span><span class="se">\u003c</span><span class="s2">/span</span><span class="se">\u003e\u003c</span><span class="s2">br</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/p</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/div</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;send to shared mailbox&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;exchange_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.1@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_ids&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_end_date&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_folder_path&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_has_attachments&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_num_emails&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;exchange_order_by_recency&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_search_subfolders&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_sender&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_start_date&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">190199</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;exchange2016&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-exchange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-02-28 15:51:03&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For information on input values, read tooltips</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_operation</span> <span class="o">=</span> <span class="s2">&quot;QUERIED&quot;</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>           <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_ids</span>       <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email_ids&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_sender</span>          <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_sender&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_subject</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_start_date</span>      <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_start_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_end_date</span>        <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_end_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_num_emails</span>      <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_num_emails&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_folder_path</span>     <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_folder_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_order_by_recency</span>  <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_order_by_recency&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_search_subfolders</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_search_subfolders&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_has_attachments</span>   <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_has_attachments&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Push Emails to DataTables Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">Example function results:</span>
<span class="sd">------------------------</span>
<span class="sd">    {</span>
<span class="sd">      &#39;email_ids&#39;: [&#39;id1&#39;, &#39;idN&#39;],</span>
<span class="sd">      &#39;emails&#39;: {</span>
<span class="sd">          &#39;id1&#39;: {</span>
<span class="sd">              &#39;subject&#39;: &#39;Email Subject&#39;,</span>
<span class="sd">              &#39;body&#39;: &#39;Subject body in HTML&#39;,</span>
<span class="sd">              &#39;mime_content&#39;: mime content of message</span>
<span class="sd">              &#39;sender_name&#39;: &#39;FirstName LastName&#39;,</span>
<span class="sd">              &#39;sender_email&#39;: &#39;example@example.com&#39;,</span>
<span class="sd">              &#39;attachment_ids&#39;: [&#39;attachment_id1&#39;, &#39;attachment_id2&#39;],</span>
<span class="sd">              &#39;attachments&#39;: {</span>
<span class="sd">                  &#39;attachment_id1&#39;: {</span>
<span class="sd">                      &#39;attachment_name&#39;: &#39;attachment.xslx&#39;,</span>
<span class="sd">                      &#39;attachment_content_type&#39;: &#39;spreadsheet&#39;,</span>
<span class="sd">                      &#39;attachment_size&#39;: &#39;8842&#39;,</span>
<span class="sd">                      &#39;attachment_base64&#39;: &#39;attachment encoded in base 64&#39;},</span>
<span class="sd">                  &#39;attachment_id2&#39;: {</span>
<span class="sd">                      &#39;attachment_name&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_content_type&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_size&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_base64&#39;: &#39;attachment encoded in base 64&#39;}}},</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Enable to add all information to a datatable found in the Exchange tab.</span>
<span class="n">enable_write_to_datatables</span>  <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Enable to add attachments found as a base64 encoded value. This option only works when enable_write_to_datatables is set to False</span>
<span class="n">enable_add_attachment_value</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_emails</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
<span class="n">content</span>   <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="n">emails</span>    <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;emails&quot;</span><span class="p">)</span>
<span class="n">email_ids</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;email_ids&quot;</span><span class="p">)</span>
<span class="n">status_colour_map</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;QUERIED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#B0C4DE&quot;</span><span class="p">,</span> <span class="c1"># LightSteelBlue</span>
  <span class="s2">&quot;MOVED&quot;</span>   <span class="p">:</span> <span class="s2">&quot;#B8860B&quot;</span><span class="p">,</span> <span class="c1"># DarkGoldenrod</span>
  <span class="s2">&quot;TRASHED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#CD5C5C&quot;</span><span class="p">,</span> <span class="c1"># IndianRed</span>
  <span class="s2">&quot;DELETED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#B22222&quot;</span><span class="p">}</span> <span class="c1"># Firebrick</span>


<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Unable to find emails&quot;</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fail_reason</span><span class="p">)</span>
  <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">email_id</span> <span class="ow">in</span> <span class="n">email_ids</span><span class="p">:</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">emails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">email_id</span><span class="p">)</span>
    <span class="n">attachment_ids</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attachment_ids&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">enable_write_to_datatables</span><span class="p">:</span>

      <span class="n">email_status</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exchange_email_operation&quot;</span><span class="p">)</span>
      <span class="n">email_status</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;p style= &quot;color:</span><span class="si">{color}</span><span class="s2">&quot;&gt;</span><span class="si">{status}</span><span class="s2"> &lt;/p&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">status_colour_map</span><span class="p">[</span><span class="n">email_status</span><span class="p">],</span> <span class="n">status</span><span class="o">=</span><span class="n">email_status</span><span class="p">)</span>

      <span class="n">message_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;exchange_email_information_dt&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_date_of_retrieval</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_id</span> <span class="o">=</span> <span class="n">email_id</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_recipient_email</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_email&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_sender_email</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_email_status</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">email_status</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_subject</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_count_attachments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">attachment_ids</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="n">attachments</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attachments&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_name&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender Name&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;sender_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Sender name for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_email&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;sender_email&#39;</span><span class="p">],</span> <span class="s1">&#39;Sender email address for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Subject&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span> <span class="s1">&#39;Email subject for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Body&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">],</span> <span class="s1">&#39;Email body in HTML for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>

      <span class="k">for</span> <span class="n">attachment_id</span> <span class="ow">in</span> <span class="n">attachment_ids</span><span class="p">:</span>
        <span class="n">attachment</span> <span class="o">=</span> <span class="n">attachments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Attachment Name&#39;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Attachment name for attachment </span><span class="si">{}</span><span class="s1"> from email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">,</span> <span class="n">email_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">enable_add_attachment_value</span><span class="p">:</span>
          <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Attachment&#39;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_base64&#39;</span><span class="p">],</span> <span class="s1">&#39;Attachment file </span><span class="si">{}</span><span class="s1"> base64 encoded : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_name&#39;</span><span class="p">],</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_base64&#39;</span><span class="p">]))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-exchange-get-mailbox-info">
<h2>Function - Exchange Get Mailbox Info<a class="headerlink" href="#function-exchange-get-mailbox-info" title="Link to this heading">¶</a></h2>
<p>Get mailbox info for specified email. The information retrieved from the server is saved as a incident note.</p>
<p><img alt="screenshot: popup_retrieve_info.png" src="../_images/popup_retrieve_info.png" /></p>
<p><img alt="screenshot: workflow_get-mailbox_info.png" src="../_images/workflow_get-mailbox_info.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_get_email</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Email to get mailbox info from</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;email_address&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.n@exchange2016.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mailbox_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Mailbox&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;routing_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SMTP&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;email_address&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.n@exchange2016.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;exchange_get_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.n@exchange2016.com&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;mailbox_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Mailbox&quot;</span><span class="p">,</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">254</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;exchange2016&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-exchange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-02 12:21:02&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">John Doe</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">email_address</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">johndoe.n@exchange2016.com</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">routing_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SMTP</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">mailbox_type</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Mailbox</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_get_email</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_get_email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Example</span>
<span class="sd">-------</span>
<span class="sd">response = {</span>
<span class="sd">  &#39;name&#39;: &#39;firstname lastname&#39;,</span>
<span class="sd">  &#39;email_address&#39;: &#39;user@example.com&#39;,</span>
<span class="sd">  &#39;routing_type&#39;: &#39;SMTP&#39;,</span>
<span class="sd">  &#39;mailbox_type&#39;: &#39;Mailbox&#39;}</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">write_to_artifact</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_get_mailbox</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Unable to create meeting&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">u</span><span class="s2">&quot;Failure reason: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fail_reason</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">write_to_artifact</span><span class="p">:</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender&#39;</span><span class="p">,</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email_address&#39;</span><span class="p">),</span> <span class="s1">&#39;Email address from Exchange Get Mailbox Info&#39;</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender Name&#39;</span><span class="p">,</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="s1">&#39;Email sender name from Exchange Get Mailbox Info&#39;</span><span class="p">)</span>

  <span class="n">text</span>  <span class="o">=</span>  <span class="s2">&quot;&lt;b&gt;Microsoft Exchange Mailbox Information:&lt;/b&gt;&lt;br /&gt;&quot;</span>
  <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Name: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Email Address: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email_address&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Routing Type: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;routing_type&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Mailbox Type: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mailbox_type&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>
</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-exchange-move-emails">
<h2>Function - Exchange Move Emails<a class="headerlink" href="#function-exchange-move-emails" title="Link to this heading">¶</a></h2>
<p>Move queried emails from a specified folder to another specified folder. The <code class="docutils literal notranslate"><span class="pre">exchange_destination_folder_path</span></code> must be specified to perform this action. If the user decides to migrate all contents form one folder to another and delete the source, <code class="docutils literal notranslate"><span class="pre">exchange_delete_source_folder</span> </code> must be enabled. Emails can be queried from a user’s mailbox and deleted. These emails can be filtered based on fundamental attributes including the sender’s email address, the location of the email’s folder, the subject, the body, and if it contains attachments. A thorough search can be performed on the user’s mailbox by tunneling subfolders, beginning and ending dates of emails received, sorting emails by recency, and limiting the number of emails obtained. The email retrieved form the mailbox can now be stored in a data-table available under the Exchange incident tab. The ability to store information as artifacts is also retained. This can be turned on from within the <code class="docutils literal notranslate"><span class="pre">Push</span> <span class="pre">Emails</span> <span class="pre">to</span> <span class="pre">DataTables</span></code> script of this playbook.</p>
<p><img alt="screenshot: popup_move_email.png" src="../_images/popup_move_email.png" /></p>
<p><img alt="screenshot: workflow_move_email.png" src="../_images/workflow_move_email.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_delete_source_folder</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>Move the emails to another folder and delete the current folder</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_destination_folder_path</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store,</span> <span class="pre">Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Inbox</span></code></p></td>
<td><p>Folder path of destination folder from root folder, leave empty for root folder</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_email</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Email account that is used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_ids</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Comma separated list of email ids</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_start_date</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">03/24/2023</span> <span class="pre">13:00:37</span> <span class="pre">+00:00</span></code></p></td>
<td><p>Get emails on or after this date, leave empty to not set a start date</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_end_date</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">datetimepicker</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">03/24/2023</span> <span class="pre">13:00:37</span> <span class="pre">+00:00</span></code></p></td>
<td><p>Get emails until after this date, leave empty to not set an end date</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_folder_path</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store,Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Inbox,Top</span> <span class="pre">of</span> <span class="pre">Information</span> <span class="pre">Store/Drafts,...</span></code></p></td>
<td><p>Comma separated list of folder paths to query from</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_force_delete_subfolders</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>Yes to delete even if the folder has subfolders else stops operation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_has_attachments</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>True to include attachments, False to exclude attachments, leave empty to get all</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_body</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Hello,</span> <span class="pre">how</span> <span class="pre">are</span> <span class="pre">you?</span></code></p></td>
<td><p>Text for the message body of an email to query or to send, depending on the function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_subject</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Invitation:</span> <span class="pre">Security</span> <span class="pre">Meeting</span></code></p></td>
<td><p>Text for the subject of an email to query or send depending on the function.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_num_emails</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
<td><p>Number of emails to be selected</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_order_by_recency</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
<td><p>Yes to get newest emails first, No to get oldest emails first, leave empty to ignore time sent</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_search_subfolders</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
<td><p>Yes to search subfolders, No or leave empty to not search subfolders</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_sender</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Only get emails from this sender, leave blank to ignore sender attribute</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;dst_folder&quot;</span><span class="p">:</span> <span class="s2">&quot;Top of Information Store/Notes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">dacfdd29axxxxxxxxxxxxxxxx4d9@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">3e563564exxxxxxxxxxxxxxxx570@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">f2ff33ff9xxxxxxxxxxxxxxxxce8@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">6c7f6d14axxxxxxxxxxxxxxxx9da@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;emails&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">3e563564e5cc44a6aebb26f41da9d570@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body</span><span class="se">\u003e\r\n</span><span class="s2">body</span><span class="se">\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe Norcross&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Meeting&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">6c7f6d14acca4dc8ab34fd78de50e9da@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body</span><span class="se">\u003e\r\n</span><span class="s2">hello</span><span class="se">\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe Norcross&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Meeting&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">dacfdd29ab69473b8c7dad28366ca4d9@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body</span><span class="se">\u003e\r\n</span><span class="s2">None</span><span class="se">\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe Norcross&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Meeting&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">f2ff33ff93104e74b33f0371b655ace8@exchange2016.com</span><span class="se">\u003e</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;attachment_ids&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u003c</span><span class="s2">html</span><span class="se">\u003e\r\n\u003c</span><span class="s2">head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">Content-Type</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">text/html; charset=utf-8</span><span class="se">\&quot;\u003e\r\n\u003c</span><span class="s2">/head</span><span class="se">\u003e\r\n\u003c</span><span class="s2">body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/body</span><span class="se">\u003e\r\n\u003c</span><span class="s2">/html</span><span class="se">\u003e\r\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sender_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe Norcross&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Meeting&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;src_folder&quot;</span><span class="p">:</span> <span class="s2">&quot;Top of Information Store/Inbox&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;dst_folder&quot;</span><span class="p">:</span> <span class="s2">&quot;Top of Information Store/Notes&quot;</span><span class="p">,</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;exchange_delete_source_folder&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;exchange_destination_folder_path&quot;</span><span class="p">:</span> <span class="s2">&quot;Top of Information Store/Notes&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_ids&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_end_date&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_folder_path&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_force_delete_subfolders&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;exchange_has_attachments&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Security Meeting&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_num_emails&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_order_by_recency&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_search_subfolders&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_sender&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;exchange_start_date&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">10386</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;exchange2016&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-exchange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-02-28 19:55:32&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;src_folder&quot;</span><span class="p">:</span> <span class="s2">&quot;Top of Information Store/Inbox&quot;</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For information on input values, read tooltips</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_operation</span> <span class="o">=</span> <span class="s2">&quot;MOVED&quot;</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_delete_source_folder</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_folder_path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_folder_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_destination_folder_path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_destination_folder_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_force_delete_subfolders</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_force_delete_subfolders&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>           <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_ids</span>       <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email_ids&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_sender</span>          <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_sender&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_subject</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_start_date</span>      <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_start_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_end_date</span>        <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_end_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_num_emails</span>      <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_num_emails&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_order_by_recency</span>  <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_order_by_recency&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_search_subfolders</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_search_subfolders&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_has_attachments</span>   <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_has_attachments&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Push Emails to DataTables Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">Example function results:</span>
<span class="sd">------------------------</span>
<span class="sd">    {</span>
<span class="sd">      &#39;email_ids&#39;: [&#39;id1&#39;, &#39;idN&#39;],</span>
<span class="sd">      &#39;emails&#39;: {</span>
<span class="sd">          &#39;id1&#39;: {</span>
<span class="sd">              &#39;subject&#39;: &#39;Email Subject&#39;,</span>
<span class="sd">              &#39;body&#39;: &#39;Subject body in HTML&#39;,</span>
<span class="sd">              &#39;mime_content&#39;: mime content of message</span>
<span class="sd">              &#39;sender_name&#39;: &#39;FirstName LastName&#39;,</span>
<span class="sd">              &#39;sender_email&#39;: &#39;example@example.com&#39;,</span>
<span class="sd">              &#39;attachment_ids&#39;: [&#39;attachment_id1&#39;, &#39;attachment_id2&#39;],</span>
<span class="sd">              &#39;attachments&#39;: {</span>
<span class="sd">                  &#39;attachment_id1&#39;: {</span>
<span class="sd">                      &#39;attachment_name&#39;: &#39;attachment.xslx&#39;,</span>
<span class="sd">                      &#39;attachment_content_type&#39;: &#39;spreadsheet&#39;,</span>
<span class="sd">                      &#39;attachment_size&#39;: &#39;8842&#39;,</span>
<span class="sd">                      &#39;attachment_base64&#39;: &#39;attachment encoded in base 64&#39;},</span>
<span class="sd">                  &#39;attachment_id2&#39;: {</span>
<span class="sd">                      &#39;attachment_name&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_content_type&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_size&#39;: &#39;...&#39;,</span>
<span class="sd">                      &#39;attachment_base64&#39;: &#39;attachment encoded in base 64&#39;}}},</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Enable to add all information to a datatable found in the Exchange tab.</span>
<span class="n">enable_write_to_datatables</span>  <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># Enable to add attachments found as a base64 encoded value. This option only works when enable_write_to_datatables is set to False</span>
<span class="n">enable_add_attachment_value</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_emails</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
<span class="n">content</span>   <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="n">emails</span>    <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;emails&quot;</span><span class="p">)</span>
<span class="n">email_ids</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;email_ids&quot;</span><span class="p">)</span>
<span class="n">status_colour_map</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;QUERIED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#B0C4DE&quot;</span><span class="p">,</span> <span class="c1"># LightSteelBlue</span>
  <span class="s2">&quot;MOVED&quot;</span>   <span class="p">:</span> <span class="s2">&quot;#B8860B&quot;</span><span class="p">,</span> <span class="c1"># DarkGoldenrod</span>
  <span class="s2">&quot;TRASHED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#CD5C5C&quot;</span><span class="p">,</span> <span class="c1"># IndianRed</span>
  <span class="s2">&quot;DELETED&quot;</span> <span class="p">:</span> <span class="s2">&quot;#B22222&quot;</span><span class="p">}</span> <span class="c1"># Firebrick</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Unable to find emails&quot;</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fail_reason</span><span class="p">)</span>
  <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">email_id</span> <span class="ow">in</span> <span class="n">email_ids</span><span class="p">:</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">emails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">email_id</span><span class="p">)</span>
    <span class="n">attachment_ids</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attachment_ids&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">enable_write_to_datatables</span><span class="p">:</span>

      <span class="n">email_status</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exchange_email_operation&quot;</span><span class="p">)</span>
      <span class="n">email_status</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;p style= &quot;color:</span><span class="si">{color}</span><span class="s2">&quot;&gt;</span><span class="si">{status}</span><span class="s2"> &lt;/p&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">status_colour_map</span><span class="p">[</span><span class="n">email_status</span><span class="p">],</span> <span class="n">status</span><span class="o">=</span><span class="n">email_status</span><span class="p">)</span>

      <span class="n">message_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;exchange_email_information_dt&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_date_of_retrieval</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_id</span> <span class="o">=</span> <span class="n">email_id</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_recipient_email</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_email&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_sender_email</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_email_status</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">email_status</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_subject</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
      <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_count_attachments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">attachment_ids</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="n">attachments</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attachments&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_name&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender Name&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;sender_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Sender name for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sender_email&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Sender&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;sender_email&#39;</span><span class="p">],</span> <span class="s1">&#39;Sender email address for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Subject&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span> <span class="s1">&#39;Email subject for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">):</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Body&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">],</span> <span class="s1">&#39;Email body in HTML for email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">email_id</span><span class="p">))</span>

      <span class="k">for</span> <span class="n">attachment_id</span> <span class="ow">in</span> <span class="n">attachment_ids</span><span class="p">:</span>
        <span class="n">attachment</span> <span class="o">=</span> <span class="n">attachments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">)</span>
        <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Attachment Name&#39;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Attachment name for attachment </span><span class="si">{}</span><span class="s1"> from email </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">,</span> <span class="n">email_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">enable_add_attachment_value</span><span class="p">:</span>
          <span class="n">incident</span><span class="o">.</span><span class="n">addArtifact</span><span class="p">(</span><span class="s1">&#39;Email Attachment&#39;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_base64&#39;</span><span class="p">],</span> <span class="s1">&#39;Attachment file </span><span class="si">{}</span><span class="s1"> base64 encoded : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_name&#39;</span><span class="p">],</span> <span class="n">attachment</span><span class="p">[</span><span class="s1">&#39;attachment_base64&#39;</span><span class="p">]))</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="function-exchange-send-email">
<h2>Function - Exchange Send Email<a class="headerlink" href="#function-exchange-send-email" title="Link to this heading">¶</a></h2>
<p>Send an email to a list of recipients. Multiple recipients can be specified in a comma seperated fashion. The email being sent can now be stored in a data-table available under the Exchange incident tab. The ability to store information as artifacts is also retained. This can be turned on from within the <code class="docutils literal notranslate"><span class="pre">Process</span> <span class="pre">Sent</span> <span class="pre">Email</span></code> script of this playbook.</p>
<p><img alt="screenshot: popup_send_email.png" src="../_images/popup_send_email.png" /></p>
<p><img alt="screenshot: workflow_send_email.png" src="../_images/workflow_send_email.png" /></p>
<details><summary>Inputs:</summary>
<p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head text-center"><p>Type</p></th>
<th class="head text-center"><p>Required</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_email</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user&#64;example.com</span></code></p></td>
<td><p>Email account that is used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_email_recipients</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>Yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">user1&#64;example.com,user2&#64;example.com,...</span></code></p></td>
<td><p>Comma separated list of emails</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_body</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Hello,</span> <span class="pre">how</span> <span class="pre">are</span> <span class="pre">you?</span></code></p></td>
<td><p>Text for the message body of an email to query or to send, depending on the function.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exchange_message_subject</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td class="text-center"><p>No</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Invitation:</span> <span class="pre">Security</span> <span class="pre">Meeting</span></code></p></td>
<td><p>Text for the subject of an email to query or send depending on the function.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</details>
<details><summary>Outputs:</summary>
<p>
<blockquote>
<div><p><strong>NOTE:</strong> This example might be in JSON format, but <code class="docutils literal notranslate"><span class="pre">results</span></code> is a Python Dictionary on the SOAR platform.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;msg_body&quot;</span><span class="p">:</span> <span class="s2">&quot;Happy to announce that we have successfully cancelled your insurance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msg_subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Cancellation request&quot;</span><span class="p">,</span>
    <span class="s2">&quot;recipients&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s@exchange2016.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;exchange_email&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_email_recipients&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s@exchange2016.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_body&quot;</span><span class="p">:</span> <span class="s2">&quot;Happy to announce that we have successfully cancelled your insurance&quot;</span><span class="p">,</span>
      <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Cancellation request&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;execution_time_ms&quot;</span><span class="p">:</span> <span class="mi">3496</span><span class="p">,</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;exchange2016&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package&quot;</span><span class="p">:</span> <span class="s2">&quot;fn-exchange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;package_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-02-28 20:10:41&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;msg_body&quot;</span><span class="p">:</span> <span class="s2">&quot;Happy to announce that we have successfully cancelled your insurance&quot;</span><span class="p">,</span>
  <span class="s2">&quot;msg_subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Cancellation request&quot;</span><span class="p">,</span>
  <span class="s2">&quot;raw&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">recipients</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">johndoe.s@exchange2016.com</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">sender</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">johndoe.s.n@exchange2016.com</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">msg_subject</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Cancellation request</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">msg_body</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Happy to announce that we have successfully cancelled your insurance</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;recipients&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s@exchange2016.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;johndoe.s.n@exchange2016.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Pre-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set inputs</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email</span>            <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_subject</span>  <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_message_subject&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">exchange_email_recipients</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="s2">&quot;exchange_email_recipients&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">if</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="ow">and</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
  <span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">exchange_message_body</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</p>
</details>
<details><summary>Example Post-Process Script:</summary>
<p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Example</span>
<span class="sd">-------</span>
<span class="sd">response = {</span>
<span class="sd">  &#39;recipients&#39;: [&#39;user1@example.com&#39;, &#39;user2@example.com&#39;],</span>
<span class="sd">  &#39;sender&#39;: &#39;sender@example.com&#39;,</span>
<span class="sd">  &#39;subject&#39;: &#39;Subject&#39;,</span>
<span class="sd">  &#39;body&#39;: &#39;HTML Body&#39;}</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Enable to write the information from the email to the data-table</span>
<span class="n">enable_write_to_datatables</span> <span class="o">=</span> <span class="kc">True</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">playbook</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">output_exchange_send_email</span>

<span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">):</span>
  <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Unable to send email&quot;</span>
  <span class="n">fail_reason</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">fail_reason</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">:</span><span class="se">\n\t</span><span class="s2">Failure reason: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fail_reason</span><span class="p">)</span>
  <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
  <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">enable_write_to_datatables</span><span class="p">:</span>
    <span class="n">message_row</span> <span class="o">=</span> <span class="n">incident</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;exchange_email_information_dt&quot;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_date_of_retrieval</span>    <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_recipient_email</span>   <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recipients&#39;</span><span class="p">))</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_sender_email</span>      <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sender&#39;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_email_status</span>      <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;&quot;&quot;&lt;p style= &quot;color:</span><span class="si">{color}</span><span class="s2">&quot;&gt;</span><span class="si">{status}</span><span class="s2"> &lt;/p&gt;&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#228B22&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s2">&quot;SENT&quot;</span><span class="p">))</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_message_subject</span>   <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;msg_subject&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="n">message_row</span><span class="o">.</span><span class="n">exchange_dt_count_attachments</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="n">text</span>  <span class="o">=</span>  <span class="s2">&quot;&lt;b&gt;Exchange email:&lt;/b&gt;&lt;br /&gt;&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;From: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sender&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Recipients: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recipients&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Subject: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;msg_subject&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&lt;br /&gt;Body: </span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;msg_body&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">noteText</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">createRichText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">incident</span><span class="o">.</span><span class="n">addNote</span><span class="p">(</span><span class="n">noteText</span><span class="p">)</span>

</pre></div>
</div>
</p>
</details>
</section>
<hr class="docutils" />
<section id="data-table-email-information">
<h2>Data Table - Email Information<a class="headerlink" href="#data-table-email-information" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: datatable_email_information.png" src="../_images/datatable_email_information.png" /></p>
<section id="api-name">
<h3>API Name:<a class="headerlink" href="#api-name" title="Link to this heading">¶</a></h3>
<p>exchange_email_information_dt</p>
</section>
<section id="columns">
<h3>Columns:<a class="headerlink" href="#columns" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Attachments</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_count_attachments</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p>Number of attachments in the email</p></td>
</tr>
<tr class="row-odd"><td><p>Date of Retrieval</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_date_of_retrieval</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Date the email was retrieved from the mailbox. Not to be confused with email received date.</p></td>
</tr>
<tr class="row-even"><td><p>Message ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_message_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Unique ID of the message</p></td>
</tr>
<tr class="row-odd"><td><p>Message Subject</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_message_subject</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Subject of the email</p></td>
</tr>
<tr class="row-even"><td><p>Recipient Email Address</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_recipient_email</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Email address of the Recipient</p></td>
</tr>
<tr class="row-odd"><td><p>Sender Email Address</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_sender_email</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Email address of the sender</p></td>
</tr>
<tr class="row-even"><td><p>Status</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_email_status</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textArea</span></code></p></td>
<td><p>Queried / Sent / Moved / Deleted / Trashed (depends on the action being performed)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="data-table-meeting-information">
<h2>Data Table - Meeting Information<a class="headerlink" href="#data-table-meeting-information" title="Link to this heading">¶</a></h2>
<p><img alt="screenshot: datatable_meeting_information.png" src="../_images/datatable_meeting_information.png" /></p>
<section id="id1">
<h3>API Name:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>exchange_dt_meeting_information</p>
</section>
<section id="id2">
<h3>Columns:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>API Access Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Tooltip</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Created Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_created_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Date and time of when the meeting was created</p></td>
</tr>
<tr class="row-odd"><td><p>End Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_end_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Meeting end date and time</p></td>
</tr>
<tr class="row-even"><td><p>Location</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_meeting_location</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">textArea</span></code></p></td>
<td><p>Online meeting URL or offline meeting phsical location</p></td>
</tr>
<tr class="row-odd"><td><p>Mandatory Attendees</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_mandatory_attendees</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Required participants</p></td>
</tr>
<tr class="row-even"><td><p>Meeting Subject</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_meeting_subject</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Subject of the invite</p></td>
</tr>
<tr class="row-odd"><td><p>Optional Attendees</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_optional_attendees</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Optional participants</p></td>
</tr>
<tr class="row-even"><td><p>Start Time</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exchange_dt_start_time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">text</span></code></p></td>
<td><p>Meeting start date and time</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="playbook">
<h2>Playbook<a class="headerlink" href="#playbook" title="Link to this heading">¶</a></h2>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Playbook Name</p></th>
<th class="head"><p>Object</p></th>
<th class="head"><p>API Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Playbooks: Exchange Create Meeting</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_exchange_create_meeting</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Playbooks: Exchange Delete Emails</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_exchange_delete_emails</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Playbooks: Exchange Find Emails</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_exchange_find_emails</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Playbooks: Exchange Move Contents and Delete Folder</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_ve_and_delete_folder</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Playbooks: Exchange Move Emails</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_exchange_move_emails</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Playbooks: Exchange Retrieve Mailbox Information</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_exchange_get_mailbox_info</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Playbooks: Exchange Send Email</p></td>
<td><p>incident</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">playbook_exchange_send_email</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="troubleshooting-support">
<h2>Troubleshooting &amp; Support<a class="headerlink" href="#troubleshooting-support" title="Link to this heading">¶</a></h2>
<p>Refer to the documentation listed in the Requirements section for troubleshooting information.</p>
<section id="for-support">
<h3>For Support<a class="headerlink" href="#for-support" title="Link to this heading">¶</a></h3>
<p>This is an IBM supported app. Please search <a class="reference external" href="https://ibm.com/mysupport">ibm.com/mysupport</a> for assistance.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../fn_exchange_online/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Microsoft Exchange Online</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../fn_email_header_validation/README.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Email Header Validation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Microsoft Exchange</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a></li>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#soar-platform">SOAR platform</a></li>
<li><a class="reference internal" href="#cloud-pak-for-security">Cloud Pak for Security</a></li>
<li><a class="reference internal" href="#proxy-server">Proxy Server</a></li>
<li><a class="reference internal" href="#python-environment">Python Environment</a></li>
<li><a class="reference internal" href="#development-version">Development Version</a></li>
<li><a class="reference internal" href="#endpoint-developed-with">Endpoint Developed With</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#timezones">Timezones</a></li>
<li><a class="reference internal" href="#folder-paths">Folder Paths</a></li>
<li><a class="reference internal" href="#information-as-data-tables-or-artifacts">Information as Data-tables or Artifacts</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#install">Install</a></li>
<li><a class="reference internal" href="#app-configuration">App Configuration</a></li>
<li><a class="reference internal" href="#custom-layouts">Custom Layouts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-exchange-create-meeting">Function - Exchange Create Meeting</a></li>
<li><a class="reference internal" href="#function-exchange-delete-emails">Function - Exchange Delete Emails</a></li>
<li><a class="reference internal" href="#function-exchange-find-emails">Function - Exchange Find Emails</a></li>
<li><a class="reference internal" href="#function-exchange-get-mailbox-info">Function - Exchange Get Mailbox Info</a></li>
<li><a class="reference internal" href="#function-exchange-move-emails">Function - Exchange Move Emails</a></li>
<li><a class="reference internal" href="#function-exchange-send-email">Function - Exchange Send Email</a></li>
<li><a class="reference internal" href="#data-table-email-information">Data Table - Email Information</a><ul>
<li><a class="reference internal" href="#api-name">API Name:</a></li>
<li><a class="reference internal" href="#columns">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-table-meeting-information">Data Table - Meeting Information</a><ul>
<li><a class="reference internal" href="#id1">API Name:</a></li>
<li><a class="reference internal" href="#id2">Columns:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#playbook">Playbook</a></li>
<li><a class="reference internal" href="#troubleshooting-support">Troubleshooting &amp; Support</a><ul>
<li><a class="reference internal" href="#for-support">For Support</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/custom.js?v=a365c389"></script>
    </body>
</html>