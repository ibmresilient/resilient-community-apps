<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - BitSight Cyber Insurance: Get Alerts - Example (PB)

### API Name
`bitsight_cyber_insurance_get_alerts`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Alert Date | `bitsight_ci_alert_date` | datepicker | Filter alerts by the specified alert date. Format YYYY‑MM‑DD | Optional |
| Alert Date gt > | `bitsight_ci_alert_date_gt` | datepicker | Filter alerts after the requested date. This parameter is incompatible with alert_date. Format YYYY‑MM‑DD | Optional |
| Alert Date gte >= | `bitsight_ci_alert_date_gte` | datepicker | Filter alerts after or on the requested date. This parameter is incompatible with alert_date. Format YYYY‑MM‑DD | Optional |
| Alert Date lt < | `bitsight_ci_alert_date_lt` | datepicker | Filter alerts prior to the requested date. This parameter is incompatible with alert_date. Format YYYY‑MM‑DD | Optional |
| Alert Date lte <= | `bitsight_ci_alert_date_lte` | datepicker | Filter alerts prior to or on the requested date. This parameter is incompatible with alert_date. Format YYYY‑MM‑DD | Optional |
| Clear SOAR Data table | `clear_soar_data_table` | boolean | Remove all the data from a SOAR data table before new data is added. | Optional |
| Company GUID | `bitsight_ci_company_guid` | text | The GUID of a company. | Optional |
| Expand | `bitsight_ci_expand` | text |  Include additional alert details. Examples: company_custom_id or details only one can be given. | Optional |
| Folder GUID | `bitsight_ci_folder_guid` | text | Filter alerts by the specified folder. Folder unique identifier. | Optional |
| limit | `bitsight_ci_limit` | number | Set the maximum number of results. The results might include fewer records (even zero), but not more. Defaults to 100. | Optional |
| offset | `bitsight_ci_offset` | number | Set the starting point of the return. Defaults to 0. | Optional |
| Severity | `bitsight_ci_severity` | select | Filter alerts by the specified change severity. Allowed values: CRITICAL, WARN, INCREASE, INFORMATIONAL | Optional |

### Object Type
`incident`

### Description
See your existing alerts and their details.


---
## Function - BitSight Cyber Insurance: Get Alerts

### API Name
`bitsight_cyber_insurance_get_alerts`

### Output Name
`bitsight_ci_get_alerts_return`

### Message Destination
`fn_bitsight_cyber_insurance`

### Function-Input Script
```python
if getattr(playbook.inputs, "bitsight_ci_alert_date", None):
  inputs.bitsight_ci_alert_date = getattr(playbook.inputs, "bitsight_ci_alert_date", None)
if getattr(playbook.inputs, "bitsight_ci_alert_date_gt", None):
  inputs.bitsight_ci_alert_date_gt = getattr(playbook.inputs, "bitsight_ci_alert_date_gt", None)
if getattr(playbook.inputs, "bitsight_ci_alert_date_gte", None):
  inputs.bitsight_ci_alert_date_gte = getattr(playbook.inputs, "bitsight_ci_alert_date_gte", None)
if getattr(playbook.inputs, "bitsight_ci_alert_date_lt", None):
  inputs.bitsight_ci_alert_date_lt = getattr(playbook.inputs, "bitsight_ci_alert_date_lt", None)
if getattr(playbook.inputs, "bitsight_ci_alert_date_lte", None):
  inputs.bitsight_ci_alert_date_lte = getattr(playbook.inputs, "bitsight_ci_alert_date_lte", None)
if getattr(playbook.inputs, "bitsight_ci_company_guid", None):
  inputs.bitsight_ci_company_guid =  getattr(playbook.inputs, "bitsight_ci_company_guid", None)
if getattr(playbook.inputs, "bitsight_ci_alert_type", None):
  inputs.bitsight_ci_alert_type = getattr(playbook.inputs, "bitsight_ci_alert_type", None)
if getattr(playbook.inputs, "bitsight_ci_expand", None):
  inputs.bitsight_ci_expand = getattr(playbook.inputs, "bitsight_ci_expand", None)
if getattr(playbook.inputs, "bitsight_ci_folder_guid", None):
  inputs.bitsight_ci_folder_guid = getattr(playbook.inputs, "bitsight_ci_folder_guid", None)
if getattr(playbook.inputs, "bitsight_ci_limit", 100):
  inputs.bitsight_ci_limit = getattr(playbook.inputs, "bitsight_ci_limit", 100)
if getattr(playbook.inputs, "bitsight_ci_offset", 0):
  inputs.bitsight_ci_offset = getattr(playbook.inputs, "bitsight_ci_offset", 0)
if getattr(playbook.inputs, "bitsight_ci_severity", None):
  inputs.bitsight_ci_severity = getattr(playbook.inputs, "bitsight_ci_severity", None)
if getattr(playbook.inputs, "clear_soar_data_table", None):
  inputs.bitsight_ci_clear_datatable = getattr(playbook.inputs, "clear_soar_data_table", None)
  inputs.bitsight_ci_soar_datatable_name = "bitsight_cyber_insurance_alerts"
  inputs.bitsight_ci_soar_incident_id = incident.id
```

---

## Local script - BitSight Cyber Insurance: Get Alerts output

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
from datetime import datetime
results = playbook.functions.results.bitsight_ci_get_alerts_return
if results.get("success", None):
  for alert in results.get('content', []):
    row = incident.addRow("bitsight_cyber_insurance_alerts")
    row['bitsight_queried_time'] = int(datetime.now().timestamp()*1000)
    row['bitsight_ci_alert_guid'] = alert.get("guid", None)
    row["bitsight_ci_alert_type"] = alert.get("alert_type", None)
    row["bitsight_ci_alert_date"] = int(datetime.strptime(alert.get("alert_date", None), "%Y-%m-%d").timestamp()*1000) if alert.get("alert_date", None) else None
    row["bitsight_ci_start_date"] = int(datetime.strptime(alert.get("start_date", None), "%Y-%m-%d").timestamp()*1000) if alert.get("start_date", None) else None
    row["bitsight_ci_company_name"] = alert.get("company_name", None)
    row["bitsight_ci_company_guid"] = alert.get("company_guid", None)
    row["bitsight_ci_company_url"] = alert.get("company_url", None)
    row["bitsight_ci_folder_guid"] = alert.get("folder_guid", None)
    row["bitsight_ci_folder_name"] = alert.get("folder_name", None)
    row["bitsight_ci_severity"] = alert.get("severity", None)
    row["bitsight_ci_trigger"] = alert.get("trigger", None)
    row["bitsight_ci_alert_set_name"] = alert.get("alert_set_name", None)
    row["bitsight_ci_alert_set_guid"] = alert.get("alert_set_guid", None)
else:
  incident.addNote(f"BitSight Cyber Insurance: Get Alerts failed with reason:\n{results.get('reason', None)}")
```

---

