<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - BitSight Cyber Insurance: Get Company Search - Example (PB)

### API Name
`bitsight_cyber_insurance_get_company_search`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Clear SOAR data table | `bitsight_clear_soar_data_table` | boolean | Remove all the data from a SOAR data table before new data is added. | Optional |
| Company GUID | `bitsight_ci_company_guid` | text | The GUID of a company. | Optional |
| Company Name | `bitsight_ci_company_name` | text | The name of a company. | Optional |
| Domain | `bitsight_ci_domain` | text | The domain of a company. Search by domain name. | Optional |
| expand | `bitsight_ci_expand` | text |  Include additional alert details. Examples: company_custom_id or details only one can be given. | Optional |
| In Portfolio | `bitsight_ci_in_portfolio` | boolean | true = Limit results to only portfolio companies. | Optional |
| Industry | `bitsight_ci_industry` | text | Industry name. Filter companies by their industry. | Optional |
| Industry Slug | `bitsight_ci_industry_slug` | text | Industry slug name. Filter companies by their industry. | Optional |
| limit | `bitsight_ci_limit` | number | Set the maximum number of results. The results might include fewer records (even zero), but not more. Defaults to 100. | Optional |
| offset | `bitsight_ci_offset` | number | Set the starting point of the return. Defaults to 0. | Optional |
| Scope | `bitsight_ci_scope` | text | Filter by Security Performance Management and Benchmarking companies. spm. | Optional |

### Object Type
`incident`

### Description
Search for a company in the Bitsight inventory by name or domain.


---
## Function - BitSight Cyber Insurance: Get Company Search

### API Name
`bitsight_cyber_insurance_get_company_search`

### Output Name
`bitsight_ci_get_company_search_return`

### Message Destination
`fn_bitsight_cyber_insurance`

### Function-Input Script
```python
if getattr(playbook.inputs, "bitsight_ci_domain", None):
  inputs.bitsight_ci_domain = getattr(playbook.inputs, "bitsight_ci_domain", None)

if getattr(playbook.inputs, "bitsight_ci_company_guid", None):
  inputs.bitsight_ci_company_guid = getattr(playbook.inputs, "bitsight_ci_company_guid", None)

if getattr(playbook.inputs, "bitsight_ci_industry_slug", None):
  inputs.bitsight_ci_industry_slug = getattr(playbook.inputs, "bitsight_ci_industry_slug", None)

if getattr(playbook.inputs, "bitsight_ci_limit", None):
  inputs.bitsight_ci_limit = getattr(playbook.inputs, "bitsight_ci_limit", None)

if getattr(playbook.inputs, "bitsight_ci_in_portfolio", None):
  inputs.bitsight_ci_in_portfolio = getattr(playbook.inputs, "bitsight_ci_in_portfolio", None)

if getattr(playbook.inputs, "bitsight_ci_offset", None):
  inputs.bitsight_ci_offset = getattr(playbook.inputs, "bitsight_ci_offset", None)

if getattr(playbook.inputs, "bitsight_ci_industry", None):
  inputs.bitsight_ci_industry = getattr(playbook.inputs, "bitsight_ci_industry", None)

if getattr(playbook.inputs, "bitsight_ci_expand", None):
  inputs.bitsight_ci_expand = getattr(playbook.inputs, "bitsight_ci_expand", None)

if getattr(playbook.inputs, "bitsight_ci_company_name", None):
  inputs.bitsight_ci_company_name = getattr(playbook.inputs, "bitsight_ci_company_name", None)

if getattr(playbook.inputs, "bitsight_ci_scope", None):
  inputs.bitsight_ci_scope = getattr(playbook.inputs, "bitsight_ci_scope", None)

if getattr(playbook.inputs, "bitsight_clear_soar_data_table", None):
  inputs.bitsight_ci_clear_datatable = getattr(playbook.inputs, "bitsight_clear_soar_data_table", None)
  inputs.bitsight_ci_soar_datatable_name = "bitsight_cyber_insurance_companies"
  inputs.bitsight_ci_soar_incident_id = incident.id
```

---

## Local script - BitSight Cyber Insurance: Get Company Search output

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
from datetime import datetime
results = playbook.functions.results.bitsight_ci_get_company_search_return
if results.get("success", None):
  if len(results.get('content', [])):
    for alert in results.get("content", []):
      row = incident.addRow("bitsight_cyber_insurance_companies")
      row['bitsight_queried_time'] = int(datetime.now().timestamp()*1000)
      row["bitsight_ci_company_guid"] = alert.get("guid", None)
      row["bitsight_ci_company_name"] = alert.get("name", None)
      row["bitsight_ci_industry"] = alert.get("industry", None)
      row["bitsight_ci_industry_slug"] = alert.get("industry_slug", None)
      row["bitsight_ci_primary_domain"] = alert.get("primary_domain", None)
      row["bitsight_ci_description"] = alert.get("description", None)
      row["bitsight_ci_website"] = alert.get("website", None)
  else:
    incident.addNote("BitSight Cyber Insurance: Get Company Search returned 0 results.")
else:
  incident.addNote(f"BitSight Cyber Insurance: Get Company Search failed with reason:\n{results.get('reason', None)}")
```

---

