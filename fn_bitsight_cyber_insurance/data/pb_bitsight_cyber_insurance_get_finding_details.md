<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Playbook - BitSight Cyber Insurance: Get Finding Details - Example (PB)

### API Name
`bitsight_cyber_insurance_get_finding_details`

### Status
`enabled`

### Activation Type
`Manual`

### Activation Conditions
`-`

### Activation Form Elements
| Input Field Label | API Name | Element Type | Tooltip | Requirement |
| ----------------- | -------- | ------------ | ------- | ----------- |
| Affects Rating | `bitsight_ci_affects_rating` | boolean | true = Include only the findings that have an impact on the letter grade. Filter by findings that have an impact on the letter grade. | Optional |
| Affects Rating Details | `bitsight_ci_affects_rating_details` | select | Allowed values are AFFECTS_RATING and LIFETIME_EXPIRED. AFFECTS_RATING - Affects the risk vector grade. LIFETIME_EXPIRED - Does not affect the risk vector grade because the finding has reached the end of its lifetime. | Optional |
| assets.assets | `bitsight_ci_assets_asset` | text | Either a Domain or an IP Address. Filter by asset. | Optional |
| assets.category | `bitsight_ci_assets_category` | select | Allowed values are low, medium, high, and critical. Filter by asset importance. | Optional |
| assets.combined_importance | `bitsight_ci_assets_combined_importance` | multiselect | Comma-separated asset importance. Allowed values are low, medium, high, and critical. Filter by combined asset importance. | Optional |
| assets.hosted_by | `bitsight_ci_assets_hosted_by` | text | Hosting provider’s unique identifier entity_guid. Filter by the hosting provider. | Optional |
| Attributed Companies GUID | `bitsight_ci_attributed_companies_guid` | text | Comma-separated My Company or My Subsidiary unique identifiers entity_guid. Filter by companies in your Ratings Tree that are attributed to the finding. | Optional |
| Attributed Companies Name | `bitsight_ci_attributed_companies_name` | text | Comma-separated company names. Filter by companies in your Ratings Tree that are attributed to the finding. | Optional |
| Company GUID | `bitsight_ci_company_guid` | text | The GUID of a company. | Always |
| cvss base gte >= | `bitsight_ci_cvss_base_gte` | text | Decimal 1 to 10. Include findings with vulnerabilities with a CVSS score greater than or equal to this value. | Optional |
| cvss base lte <= | `bitsight_ci_cvss_base_lte` | text | Decimal 1 to 10. Include findings with vulnerabilities with a CVSS score less than or equal to this value. | Optional |
| Details Grade | `bitsight_ci_details_grade` | select | Allowed values are GOOD, FAIR, WARN, BAD, NEUTRAL, and NA. Filter by Diligence finding grade or N/A for Compromised Systems and User Behavior findings. Incompatible with grade_lt and grade_gt. | Optional |
| Details Grade gt > | `bitsight_ci_details_grade_gt` | select | Allowed values are GOOD, FAIR, WARN, BAD, NEUTRAL, and NA. Include a range from the selected Diligence finding grade to GOOD. Incompatible with grade. | Optional |
| Details Grade lt < | `bitsight_ci_details_grade_lt` | select | Allowed values are GOOD, FAIR, WARN, BAD, NEUTRAL, and NA. Include a range from the selected Diligence finding grade to BAD. Incompatible with grade. | Optional |
| Details Infection Family | `bitsight_ci_details_infection_family` | text | Comma-separated infection names. Example Gamarue. Filter by infections. | Optional |
| Details Observed IPs Contains | `bitsight_ci_details_observed_ips_contains` | text | IP Address. Include findings from a particular IP address. | Optional |
| Details Vulnerabilities Severity | `bitsight_ci_details_vulnerabilities_severity` | select | The Bitsight severity of vulnerabilities. Allowed values are minor, moderate, material, and severe. Filter by vulnerability severity. | Optional |
| Evidence Key | `bitsight_ci_evidence_key` | text | Either a domain or IP address. Filter by the company’s asset (domain or IP address) that’s attributed to the finding. | Optional |
| expand | `bitsight_ci_expand_findings` | select | Allowed values are attributed_companies, remediation_history, assets.tag_details, and tag_details. attributed_companies = Include companies that are attributed to the finding. remediation_history = Issue tracking history. assets.tag_details = Tag details associated with each asset that relates to the finding. tag_details = Tag details associated with the finding. Include additional information. | Optional |
| First Seen | `bitsight_ci_first_seen` | datepicker | Date in format YYYY-MM-DD. Include findings that were first seen on this date. Incompatible with first_seen_lt and first_seen_gt. | Optional |
| First Seen gt > | `bitsight_ci_first_seen_gt` | datepicker | Date in format YYYY-MM-DD. Include findings that were first seen after this date. Incompatible with first_seen. | Optional |
| First Seen gte >= | `bitsight_ci_first_seen_gte` | datepicker | Date in format YYYY-MM-DD. Include findings that were first seen on and after this date. Incompatible with first_seen. | Optional |
| First Seen lt < | `bitsight_ci_first_seen_lt` | datepicker | Date in format YYYY-MM-DD. Include findings that were first seen prior to this date. Incompatible with first_seen. | Optional |
| First Seen lte <= | `bitsight_ci_first_seen_lte` | datepicker | Date in format YYYY-MM-DD. Include findings that were first seen on and prior to this date. Incompatible with first_seen. | Optional |
| Last Remediation Status Date | `bitsight_ci_last_remediation_status_date` | datepicker | Date in format YYYY-MM-DD. Include findings that last had a remediation status change on this date. Incompatible with last_remediation_status_date_lt and last_remediation_status_date_gt. | Optional |
| Last Remediation Status Date gt > | `bitsight_ci_last_remediation_status_date_gt` | datepicker | Date in format YYYY-MM-DD. Include findings that last had a remediation status change after this date. Incompatible with last_remediation_status_date. | Optional |
| Last Remediation Status Date gte >= | `bitsight_ci_last_remediation_status_date_gte` | datepicker | Date in format YYYY-MM-DD. Include findings that last had a remediation status change on and after this date. Incompatible with last_remediation_status_date. | Optional |
| Last Remediation Status Label | `bitsight_ci_last_remediation_status_label` | select | The remediation status of the finding. Allowed values are No Status, Open, To Do, Work In Progress, Resolved, and Risk Accepted. Filter by the current remediation status of the finding. | Optional |
| Last Remediation Status lt < | `bitsight_ci_last_remediation_status_date_lt` | datepicker | Date in format YYYY-MM-DD. Include findings that last had a remediation status change prior to this date. Incompatible with last_remediation_status_date. | Optional |
| Last Remediation Status lte <= | `bitsight_ci_last_remediation_status_date_lte` | datepicker | Date in format YYYY-MM-DD. Include findings that last had a remediation status change prior to and on this date. Incompatible with last_remediation_status_date. | Optional |
| Last Seen | `bitsight_ci_last_seen` | datepicker | Date in format YYYY-MM-DD. Include findings that were last seen on this date. Incompatible with last_seen_lt and last_seen_gt. | Optional |
| Last Seen gt > | `bitsight_ci_last_seen_gt` | datepicker | Date in format YYYY-MM-DD. Include findings that were last seen after this date. Incompatible with last_seen. | Optional |
| Last Seen gte >= | `bitsight_ci_last_seen_gte` | datepicker | Date in format YYYY-MM-DD. Include findings that were last seen on and after this date. Incompatible with last_seen. | Optional |
| Last Seen lt < | `bitsight_ci_last_seen_lt` | datepicker | Date in format YYYY-MM-DD. Include findings that were last seen prior to this date. Incompatible with last_seen. | Optional |
| Last Seen lte <= | `bitsight_ci_last_seen_lte` | datepicker | Date in format YYYY-MM-DD. Include findings that were last seen on and prior to this date. Incompatible with last_seen. | Optional |
| limit | `bitsight_ci_limit` | number | Set the maximum number of results. The results might include fewer records (even zero), but not more. Defaults to 100. | Optional |
| Offset | `bitsight_ci_offset` | number | Set the starting point of the return. Defaults to 0. | Optional |
| Remediation Assignments | `bitsight_ci_remediation_assignments` | text | Comma-separated user unique identifier user_guid. Filter by users assigned to the findings. | Optional |
| Risk Vector Label | `bitsight_ci_risk_vector_label` | text | Comma-separated risk vector slug names. Examples: botnet_infections, spam_propagation, spf_domains, open_ports, and file_sharing. Filter by particular risk vectors. Does not include Domain Squatting, Security Incidents, and Other Disclosures. | Optional |
| Severity | `bitsight_ci_severity_num` | text | Decimal severity. 1 to 3.9 is Minor, 4 to 6.9 is Moderate, 7 to 8.9 is Material, and 9 to 10 is Severe. Filter by finding severity. | Optional |
| Severity Category | `bitsight_ci_severity_category` | text | Decimal severity. 1 to 3.9 is Minor, 4 to 6.9 is Moderate, 7 to 8.9 is Material, and 9 to 10 is Severe. Filter by finding severity. | Optional |
| Severity gt > | `bitsight_ci_severity_gt` | text | Decimal severity. 1 to 3.9 is Minor, 4 to 6.9 is Moderate, 7 to 8.9 is Material, and 9 to 10 is Severe. Include finding severity that are of greater severity. | Optional |
| Severity gte >= | `bitsight_ci_severity_gte` | text | Decimal severity. 1 to 3.9 is Minor, 4 to 6.9 is Moderate, 7 to 8.9 is Material, and 9 to 10 is Severe. Include finding severity that are of greater or equal severity. | Optional |
| Severity lt < | `bitsight_ci_severity_lt` | text | Decimal severity. 1 to 3.9 is Minor, 4 to 6.9 is Moderate, 7 to 8.9 is Material, and 9 to 10 is Severe. Include finding severity that are of lesser severity. | Optional |
| Severity lte <= | `bitsight_ci_severity_lte` | text | Decimal severity. 1 to 3.9 is Minor, 4 to 6.9 is Moderate, 7 to 8.9 is Material, and 9 to 10 is Severe. Include finding severity that are of lesser or equal severity. | Optional |
| Tags Contains | `bitsight_ci_tags_contains` | text | Infrastructure tags, which are defined by the company to identify assets that belong to them. Filter by infrastructure tags. | Optional |
| Vulnerabilities | `bitsight_ci_vulnerabilities` | text | Comma-separated vulnerability names. Example: CVE-2016-10712. Filter companies that have certain vulnerabilities.  | Optional |

### Object Type
`incident`

### Description
Get an organization’s finding details.
This includes the finding details of risk types that affect or will affect security ratings; Compromised Systems, Diligence (except Domain Squatting), and User Behavior (File Sharing).
This does not include Domain Squatting and Public Disclosures (Security Incidents and Other Disclosures), as their findings cannot be queried via the API.


---
## Function - BitSight Cyber Insurance: Get Finding Details

### API Name
`bitsight_cyber_insurance_get_finding_details`

### Output Name
`bitsight_ci_get_finding_details_return`

### Message Destination
`fn_bitsight_cyber_insurance`

### Function-Input Script
```python
if getattr(playbook.inputs, "bitsight_ci_company_guid", None):
  inputs.bitsight_ci_company_guid = getattr(playbook.inputs, "bitsight_ci_company_guid", None)
if getattr(playbook.inputs, "bitsight_ci_offset", 0) is not None:
  inputs.bitsight_ci_offset = getattr(playbook.inputs, "bitsight_ci_offset", 0)
if getattr(playbook.inputs, "bitsight_ci_limit", None):
  inputs.bitsight_ci_limit = getattr(playbook.inputs, "bitsight_ci_limit", None)
if getattr(playbook.inputs, "bitsight_ci_affects_rating", None):
  inputs.bitsight_ci_affects_rating = getattr(playbook.inputs, "bitsight_ci_affects_rating", None)
if getattr(playbook.inputs, "bitsight_ci_affects_rating_details", None):
  inputs.bitsight_ci_affects_rating_details = getattr(playbook.inputs, "bitsight_ci_affects_rating_details", None)
if getattr(playbook.inputs, "bitsight_ci_assets_asset", None):
  inputs.bitsight_ci_assets_asset = getattr(playbook.inputs, "bitsight_ci_assets_asset", None)
if getattr(playbook.inputs, "bitsight_ci_assets_category", None):
  inputs.bitsight_ci_assets_category = getattr(playbook.inputs, "bitsight_ci_assets_category", None)
if getattr(playbook.inputs, "bitsight_ci_assets_combined_importance", None):
  inputs.bitsight_ci_assets_combined_importance = getattr(playbook.inputs, "bitsight_ci_assets_combined_importance", None)
if getattr(playbook.inputs, "bitsight_ci_assets_hosted_by", None):
  inputs.bitsight_ci_assets_hosted_by = getattr(playbook.inputs, "bitsight_ci_assets_hosted_by", None)
if getattr(playbook.inputs, "bitsight_ci_attributed_companies_guid", None):
  inputs.bitsight_ci_attributed_companies_guid = getattr(playbook.inputs, "bitsight_ci_attributed_companies_guid", None)
if getattr(playbook.inputs, "bitsight_ci_attributed_companies_name", None):
  inputs.bitsight_ci_attributed_companies_name = getattr(playbook.inputs, "bitsight_ci_attributed_companies_name", None)
if getattr(playbook.inputs, "bitsight_ci_cvss_base_gte", None):
  inputs.bitsight_ci_cvss_base_gte = float(getattr(playbook.inputs, "bitsight_ci_cvss_base_gte", None))
if getattr(playbook.inputs, "bitsight_ci_cvss_base_lte", None):
  inputs.bitsight_ci_cvss_base_lte = float(getattr(playbook.inputs, "bitsight_ci_cvss_base_lte", None))
if getattr(playbook.inputs, "bitsight_ci_details_grade", None):
  inputs.bitsight_ci_details_grade = getattr(playbook.inputs, "bitsight_ci_details_grade", None)
if getattr(playbook.inputs, "bitsight_ci_details_grade_gt", None):
  inputs.bitsight_ci_details_grade_gt = getattr(playbook.inputs, "bitsight_ci_details_grade_gt", None)
if getattr(playbook.inputs, "bitsight_ci_details_grade_lt", None):
  inputs.bitsight_ci_details_grade_lt = getattr(playbook.inputs, "bitsight_ci_details_grade_lt", None)
if getattr(playbook.inputs, "bitsight_ci_details_infection_family", None):
  inputs.bitsight_ci_details_infection_family = getattr(playbook.inputs, "bitsight_ci_details_infection_family", None)
if getattr(playbook.inputs, "bitsight_ci_details_observed_ips_contains", None):
  inputs.bitsight_ci_details_observed_ips_contains = getattr(playbook.inputs, "bitsight_ci_details_observed_ips_contains", None)
if getattr(playbook.inputs, "bitsight_ci_details_vulnerabilities_severity", None):
  inputs.bitsight_ci_details_vulnerabilities_severity = getattr(playbook.inputs, "bitsight_ci_details_vulnerabilities_severity", None)
if getattr(playbook.inputs, "bitsight_ci_evidence_key", None):
  inputs.bitsight_ci_evidence_key = getattr(playbook.inputs, "bitsight_ci_evidence_key", None)
if getattr(playbook.inputs, "bitsight_ci_expand_findings", None):
  inputs.bitsight_ci_expand_findings = getattr(playbook.inputs, "bitsight_ci_expand_findings", None)
if getattr(playbook.inputs, "bitsight_ci_first_seen", None):
  inputs.bitsight_ci_first_seen = getattr(playbook.inputs, "bitsight_ci_first_seen", None)
if getattr(playbook.inputs, "bitsight_ci_first_seen_gt", None):
  inputs.bitsight_ci_first_seen_gt = getattr(playbook.inputs, "bitsight_ci_first_seen_gt", None)
if getattr(playbook.inputs, "bitsight_ci_first_seen_gte", None):
  inputs.bitsight_ci_first_seen_gte = getattr(playbook.inputs, "bitsight_ci_first_seen_gte", None)
if getattr(playbook.inputs, "bitsight_ci_first_seen_lt", None):
  inputs.bitsight_ci_first_seen_lt = getattr(playbook.inputs, "bitsight_ci_first_seen_lt", None)
if getattr(playbook.inputs, "bitsight_ci_first_seen_lte", None):
  inputs.bitsight_ci_first_seen_lte = getattr(playbook.inputs, "bitsight_ci_first_seen_lte", None)
if getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date", None):
  inputs.bitsight_ci_last_remediation_status_date = getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date", None)
if getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_gt", None):
  inputs.bitsight_ci_last_remediation_status_date_gt = getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_gt", None)
if getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_gte", None):
  inputs.bitsight_ci_last_remediation_status_date_gte = getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_gte", None)
if getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_lt", None):
  inputs.bitsight_ci_last_remediation_status_date_lt = getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_lt", None)
if getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_lte", None):
  inputs.bitsight_ci_last_remediation_status_date_lte = getattr(playbook.inputs, "bitsight_ci_last_remediation_status_date_lte", None)
if getattr(playbook.inputs, "bitsight_ci_last_remediation_status_label", None):
  inputs.bitsight_ci_last_remediation_status_label = getattr(playbook.inputs, "bitsight_ci_last_remediation_status_label", None)
if getattr(playbook.inputs, "bitsight_ci_last_seen", None):
  inputs.bitsight_ci_last_seen = getattr(playbook.inputs, "bitsight_ci_last_seen", None)
if getattr(playbook.inputs, "bitsight_ci_last_seen_gt", None):
  inputs.bitsight_ci_last_seen_gt = getattr(playbook.inputs, "bitsight_ci_last_seen_gt", None)
if getattr(playbook.inputs, "bitsight_ci_last_seen_gte", None):
  inputs.bitsight_ci_last_seen_gte = getattr(playbook.inputs, "bitsight_ci_last_seen_gte", None)
if getattr(playbook.inputs, "bitsight_ci_last_seen_lt", None):
  inputs.bitsight_ci_last_seen_lt = getattr(playbook.inputs, "bitsight_ci_last_seen_lt", None)
if getattr(playbook.inputs, "bitsight_ci_last_seen_lte", None):
  inputs.bitsight_ci_last_seen_lte = getattr(playbook.inputs, "bitsight_ci_last_seen_lte", None)
if getattr(playbook.inputs, "bitsight_ci_remediation_assignments", None):
  inputs.bitsight_ci_remediation_assignments = getattr(playbook.inputs, "bitsight_ci_remediation_assignments", None)
if getattr(playbook.inputs, "bitsight_ci_risk_vector_label", None):
  inputs.bitsight_ci_risk_vector_label = getattr(playbook.inputs, "bitsight_ci_risk_vector_label", None)
if getattr(playbook.inputs, "bitsight_ci_severity_num", None):
  inputs.bitsight_ci_severity_num = float(getattr(playbook.inputs, "bitsight_ci_severity_num", None))
if getattr(playbook.inputs, "bitsight_ci_severity_gt", None):
  inputs.bitsight_ci_severity_gt = float(getattr(playbook.inputs, "bitsight_ci_severity_gt", None))
if getattr(playbook.inputs, "bitsight_ci_severity_gte", None):
  inputs.bitsight_ci_severity_gte = float(getattr(playbook.inputs, "bitsight_ci_severity_gte", None))
if getattr(playbook.inputs, "bitsight_ci_severity_lt", None):
  inputs.bitsight_ci_severity_lt = float(getattr(playbook.inputs, "bitsight_ci_severity_lt", None))
if getattr(playbook.inputs, "bitsight_ci_severity_lte", None):
  inputs.bitsight_ci_severity_lte = float(getattr(playbook.inputs, "bitsight_ci_severity_lte", None))
if getattr(playbook.inputs, "bitsight_ci_severity_category", None):
  inputs.bitsight_ci_severity_category = float(getattr(playbook.inputs, "bitsight_ci_severity_category", None))
if getattr(playbook.inputs, "bitsight_ci_tags_contains", None):
  inputs.bitsight_ci_tags_contains = getattr(playbook.inputs, "bitsight_ci_tags_contains", None)
if getattr(playbook.inputs, "bitsight_ci_vulnerabilities", None):
  inputs.bitsight_ci_vulnerabilities = getattr(playbook.inputs, "bitsight_ci_vulnerabilities", None)
```

---

## Local script - BitSight Cyber Insurance: Get Finding Details output

### Description


### Script Type
`Local script`

### Object Type
`incident`

### Script Content
```python
from json import dumps
results = playbook.functions.results.bitsight_ci_get_finding_details_return
if results.get("success", None):
  incident.addNote(f"BitSight Cyber Insurance: Get Finding Details returned:\n{dumps(results.get('content', {}), indent=4)}")
else:
  incident.addNote(f"BitSight Cyber Insurance: Get Finding Details failed with reason:\n{results.get('reason', None)}")
```

---

