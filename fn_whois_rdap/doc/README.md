<!--
  This User README.md is generated by running:
  "resilient-circuits docgen -p fn_whois_rdap --only-user-guide"

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)
-->

# **User Guide:** fn_whois_rdap_v1.0.0

## Table of Contents
- [**User Guide:** fn_whois_rdap_v1.0.0](#user-guide-fnwhoisrdapv100)
  - [Table of Contents](#table-of-contents)
  - [Key Features](#key-features)
  - [Function - RDAP: Query](#function---rdap-query)
  - [Inform Resilient Users](#inform-resilient-users)

---

## Key Features
<!--
  List the Key Features of the Integration
-->
* This integration return WHOIS registry enrichment information via the improved RDAP protocol

---

## Function - RDAP: Query
Using ipwhois library to make general queries using improved RDAP protocol

 ![screenshot: fn-rdap-query ](./screenshots/fn-rdap-query.png)

<details><summary>Inputs:</summary>
<p>

| Name | Type | Required | Example | Tooltip |
| ---- | :--: | :------: | ------- | ------- |
| `rdap_depth` | `number` | Yes | `1` | 1 |
| `rdap_query` | `text` | Yes | `ibm.com` | IP or domain name or URL|

</p>
</details>

<details><summary>Outputs:</summary>
<p>

```python
results = {
    # TODO: Copy and paste an example of the Function Output within this code block.
    # To see view the output of a Function, run resilient-circuits in DEBUG mode and invoke the Function. 
    # The Function results will be printed in the logs: "resilient-circuits run --loglevel=DEBUG"
}
```

</p>
</details>

<details><summary>Example Pre-Process Script:</summary>
<p>

```python
inputs.rdap_query = artifact.value
inputs.rdap_depth = 0
```

</p>
</details>

<details><summary>Example Post-Process Script:</summary>
<p>

```python
try:
    des = artifact.description.content
except Exception:
  des = None
dummy ={}
dummy = results["content"]

if des is None:
  note =u"""<div><p>RDAP threat intelligence:\n\n <br> Possible dictonary keys: <br> \n {0} \n\n <br> Associated objects <br> \n {1} \n\n <br> DNS zone: <br> \n {2}<div><p>""".format(dummy.keys(), dummy.get(u'objects'),dummy.get('dns_zone'))
  artifact.description = helper.createRichText(note)
else:
  note = des + u"""<div><p>RDAP threat intelligence:\n\n <br> Possible dictonary keys: <br> \n {0} \n\n <br> Associated objects <br> \n {1} \n\n <br> DNS zone: <br> \n {2}<div><p>""".format(dummy.keys(), dummy.get(u'objects'),dummy.get('dns_zone'))
  artifact.description = helper.createRichText(note)

```

</p>
</details>

---





<!--
## Inform Resilient Users
  Use this section to optionally provide additional information so that Resilient playbook 
  designer can get the maximum benefit of your integration.
-->