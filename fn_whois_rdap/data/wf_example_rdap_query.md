<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v51.0.5.0.1475
-->

# Example: RDAP query

## Function - RDAP: Query

### API Name
`rdap_query`

### Output Name
``

### Message Destination
`fn_whois_rdap`

### Pre-Processing Script
```python
inputs.rdap_query = artifact.value
inputs.rdap_depth = 0
```

### Post-Processing Script
```python
def format_link(item):
  if item and ("https://" in item or "http://" in item):
    return "<a target='blank' href='{0}'>{0}</a>".format(item)
  else:
    return item

def expand_list(list_value, separator="<br>"):
  if not isinstance(list_value, list):
    return format_link(list_value)
  else:
    try:
      items = []
      for item in list_value:
        if isinstance(item, dict):
          items.append("<div style='padding:10px'>{}</div>".format(walk_dict(item)))
        else:
          items.append(format_link(item))
      return separator.join(items)
    except:
        pass
    
def walk_dict(sub_dict):
  notes = []
  for key, value in sub_dict.items():
    if key not in ['display_content']:
      if isinstance(value, dict):
        notes.append("<b>{}</b>: <div style='padding:10px'>{}</div>".format(key, walk_dict(value)))
      else:
        notes.append("<b>{}</b>: {}".format(key, expand_list(value)))
      
  return "<br>".join(notes)
    

note = "RDAP Whois for artifact: {}<br><br>".format(artifact.value)
if results["success"]:
  note = note + walk_dict(results["content"])
else:
  note = note + "This Artifact has no ans accessible registry information"

incident.addNote(helper.createRichText(note))


'''
  for key.value in results["content"].items():
    if isinstance
    if key not in ['network']:
      item.append("<b>{}</br>: {}".format(key, expand_list)
  if des is None:
    note = note + """<div><p><br><b>RDAP threat intelligence at {2}:</b></br>\n\n
    <br><b>{0}</b></br></div></p>\n\n
    <div><p><br><b> Possible accessible keys:</b></br>\n\n
    <br><b>{1}</b></br>\n\n""".format(results["content"]["display_content"],results["content"].keys(),results["metrics"]["timestamp"])
'''
```

---

