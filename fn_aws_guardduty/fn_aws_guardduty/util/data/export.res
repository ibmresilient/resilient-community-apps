{
  "action_order": [],
  "actions": [
    {
      "automations": [],
      "conditions": [
        {
          "evaluation_id": null,
          "field_name": "incident.properties.aws_guardduty_detector_id",
          "method": "has_a_value",
          "type": null,
          "value": null
        },
        {
          "evaluation_id": null,
          "field_name": "incident.properties.aws_guardduty_finding_id",
          "method": "has_a_value",
          "type": null,
          "value": null
        },
        {
          "evaluation_id": null,
          "field_name": "incident.properties.aws_guardduty_region",
          "method": "has_a_value",
          "type": null,
          "value": null
        }
      ],
      "enabled": true,
      "export_key": "Example: AWS GuardDuty: Refresh Finding",
      "id": 27,
      "logic_type": "all",
      "message_destinations": [],
      "name": "Example: AWS GuardDuty: Refresh Finding",
      "object_type": "incident",
      "tags": [],
      "timeout_seconds": 86400,
      "type": 1,
      "uuid": "d7aa6986-65c9-4321-9880-f742e56452f3",
      "view_items": [],
      "workflows": [
        "wf_aws_guardduty_refresh_finding"
      ]
    }
  ],
  "apps": [],
  "automatic_tasks": [],
  "export_date": 1611322190348,
  "export_format_version": 2,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_region",
      "hide_notification": false,
      "id": 432,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_region",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_region",
      "tooltip": "AWS GuardDuty region.",
      "type_id": 11,
      "uuid": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_detector_id",
      "hide_notification": false,
      "id": 434,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_detector_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_detector_id",
      "tooltip": "AWS GuardDuty detector ID.",
      "type_id": 11,
      "uuid": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_finding_id",
      "hide_notification": false,
      "id": 433,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_finding_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_finding_id",
      "tooltip": "AWS GuardDuty finding ID.",
      "type_id": 11,
      "uuid": "a90b292d-a1c4-45b0-96f0-20ff45818655",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/incident_id",
      "hide_notification": false,
      "id": 438,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "incident_id",
      "tooltip": "Resilient incident ID.",
      "type_id": 11,
      "uuid": "60757a36-6f7f-4983-a1fe-5c0416763b9c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_region",
      "hide_notification": false,
      "id": 393,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_region",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Region",
      "tooltip": "",
      "type_id": 0,
      "uuid": "a5789c35-3e6f-4229-a671-2fe7ba6f3457",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_count",
      "hide_notification": false,
      "id": 394,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_count",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Count",
      "tooltip": "",
      "type_id": 0,
      "uuid": "a64d69ca-fb01-4bc1-a102-2ceea30b6b6b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_id",
      "hide_notification": false,
      "id": 395,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Finding Id",
      "tooltip": "",
      "type_id": 0,
      "uuid": "e380c315-601d-4052-90b5-78efe75d7eab",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_arn",
      "hide_notification": false,
      "id": 396,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_arn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Finding Arn",
      "tooltip": "",
      "type_id": 0,
      "uuid": "f1c8fa20-ffc3-4942-98bb-1d84fdc92f32",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_resource_type",
      "hide_notification": false,
      "id": 397,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_resource_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Resource Type",
      "tooltip": "",
      "type_id": 0,
      "uuid": "251c8f2a-9a9d-4b0e-b9a2-ed15e022754c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_detector_id",
      "hide_notification": false,
      "id": 398,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_detector_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Detector Id",
      "tooltip": "",
      "type_id": 0,
      "uuid": "5e191046-c9ce-4e74-b5be-f7277f93792b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_updated_at",
      "hide_notification": false,
      "id": 399,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_updated_at",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Resource Updated At",
      "tooltip": "",
      "type_id": 0,
      "uuid": "63d7c51c-ab4d-417e-9173-6d366d05f6d5",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_type",
      "hide_notification": false,
      "id": 400,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Finding Type",
      "tooltip": "",
      "type_id": 0,
      "uuid": "6fc421a3-c414-48de-9d39-bb833b777d00",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "creator": {
        "display_name": "Resilient Sysadmin",
        "id": 4,
        "name": "a@a.com",
        "type": "user"
      },
      "description": {
        "content": "Resilient Function to refresh AWS GuardDuty finding details in an incident.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GUARDDUTY: Refresh Finding",
      "export_key": "func_aws_guardduty_refresh_finding",
      "id": 1,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 4,
        "name": "a@a.com",
        "type": "user"
      },
      "last_modified_time": 1611322023645,
      "name": "func_aws_guardduty_refresh_finding",
      "tags": [],
      "uuid": "2d1446f8-13fc-4400-af6a-c96b55d9a0df",
      "version": 7,
      "view_items": [
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a90b292d-a1c4-45b0-96f0-20ff45818655",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "60757a36-6f7f-4983-a1fe-5c0416763b9c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": [
        {
          "actions": [],
          "description": null,
          "name": "Example: AWS GuardDuty: Refresh Finding",
          "object_type": "incident",
          "programmatic_name": "wf_aws_guardduty_refresh_finding",
          "tags": [],
          "uuid": null,
          "workflow_id": 1
        }
      ]
    }
  ],
  "geos": null,
  "groups": null,
  "id": 4,
  "inbound_mailboxes": null,
  "incident_artifact_types": [
    {
      "desc": "Amazon Web Services (AWS) IAM access key id.",
      "enabled": true,
      "export_key": "aws_iam_access_key_id",
      "file": false,
      "id": 0,
      "multi_aware": false,
      "name": "AWS IAM Access Key ID",
      "parse_as_csv": false,
      "programmatic_name": "aws_iam_access_key_id",
      "reg_exp": null,
      "system": false,
      "tags": [],
      "use_for_relationships": true,
      "uuid": "a33a1971-162c-4417-b344-8708f9d25644",
      "version": 0
    },
    {
      "desc": "Amazon Web Services (AWS) IAM user name.",
      "enabled": true,
      "export_key": "aws_iam_user_name",
      "file": false,
      "id": 0,
      "multi_aware": false,
      "name": "AWS IAM User Name",
      "parse_as_csv": false,
      "programmatic_name": "aws_iam_user_name",
      "reg_exp": null,
      "system": false,
      "tags": [],
      "use_for_relationships": true,
      "uuid": "3a0a5309-ba33-47cb-92df-c8a506f87317",
      "version": 0
    }
  ],
  "incident_types": [
    {
      "create_date": 1611322184933,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1611322184933,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "industries": null,
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_aws_gd",
      "name": "fn_aws_gd",
      "programmatic_name": "fn_aws_gd",
      "tags": [],
      "users": [
        "a@a.com"
      ],
      "uuid": "982c1bc0-69a7-4dc6-bee7-508470d51ee5"
    }
  ],
  "notifications": null,
  "overrides": [],
  "phases": [],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 4,
    "major": 38,
    "minor": 1,
    "version": "38.1.4"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "GuardDuty Action Details",
      "export_key": "gd_action_details",
      "fields": {
        "action_api": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/action_api",
          "hide_notification": false,
          "id": 402,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "action_api",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Action api",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "f1be8138-1a2b-4458-b648-8ea44bd26713",
          "values": [],
          "width": 69
        },
        "action_service_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/action_service_name",
          "hide_notification": false,
          "id": 403,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "action_service_name",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Service name",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "58db2789-f873-44e8-a9b9-e69099f0803a",
          "values": [],
          "width": 139
        },
        "action_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/action_type",
          "hide_notification": false,
          "id": 404,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "action_type",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Action type",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "71698e3e-e588-49c6-b7f2-91af22412140",
          "values": [],
          "width": 77
        },
        "actor_caller_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/actor_caller_type",
          "hide_notification": false,
          "id": 405,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "actor_caller_type",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Actor caller type",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "32323b4c-f368-4c88-bbfe-3606cd04eb9d",
          "values": [],
          "width": 112
        },
        "asn": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/asn",
          "hide_notification": false,
          "id": 406,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "asn",
          "operation_perms": {},
          "operations": [],
          "order": 17,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Asn",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "02e84510-244e-443f-bdce-ddb364ee6d7c",
          "values": [],
          "width": 25
        },
        "asn_org": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/asn_org",
          "hide_notification": false,
          "id": 407,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "asn_org",
          "operation_perms": {},
          "operations": [],
          "order": 16,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Finding asn org",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "2647e26a-3241-49a5-b85e-7da32e5578b6",
          "values": [],
          "width": 51
        },
        "city_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/city_name",
          "hide_notification": false,
          "id": 408,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "city_name",
          "operation_perms": {},
          "operations": [],
          "order": 14,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "City name",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "836614f1-62ab-48a7-990a-fc9d557a15b0",
          "values": [],
          "width": 67
        },
        "country_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/country_name",
          "hide_notification": false,
          "id": 409,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "country_name",
          "operation_perms": {},
          "operations": [],
          "order": 15,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Country",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "eb19d165-6679-4761-813f-6ee810099d45",
          "values": [],
          "width": 94
        },
        "dns_blocked": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/dns_blocked",
          "hide_notification": false,
          "id": 410,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "dns_blocked",
          "operation_perms": {},
          "operations": [],
          "order": 13,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "DNS request blocked",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "9c7f5f14-3d52-4337-9ab4-72477308c024",
          "values": [],
          "width": 53
        },
        "dns_domain_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/dns_domain_name",
          "hide_notification": false,
          "id": 411,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "dns_domain_name",
          "operation_perms": {},
          "operations": [],
          "order": 12,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "DNS domain name",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "7f392168-f15d-489e-9c3b-163c3836111e",
          "values": [],
          "width": 50
        },
        "event_first_seen": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/event_first_seen",
          "hide_notification": false,
          "id": 412,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "event_first_seen",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Event first Seen",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "09a9027f-ee68-4e92-bb8c-bbf0d89a4719",
          "values": [],
          "width": 38
        },
        "event_last_seen": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/event_last_seen",
          "hide_notification": false,
          "id": 413,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "event_last_seen",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Event Last Seen",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "d9c15e25-0920-4c6b-bf2c-322b0314f2dd",
          "values": [],
          "width": 38
        },
        "isp": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/isp",
          "hide_notification": false,
          "id": 414,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "isp",
          "operation_perms": {},
          "operations": [],
          "order": 18,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Fining isp",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "ec7698cf-30e5-4cc3-af24-24533035e224",
          "values": [],
          "width": 41
        },
        "local_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/local_ip",
          "hide_notification": false,
          "id": 415,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "local_ip",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Local IP address",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "4734c0dd-6c93-483e-9875-0fbc8b76a8b9",
          "values": [],
          "width": 53
        },
        "local_port": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/local_port",
          "hide_notification": false,
          "id": 416,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "local_port",
          "operation_perms": {},
          "operations": [],
          "order": 9,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Local port",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "d4b0ffc2-f20c-4ca6-9c58-ab947552234d",
          "values": [],
          "width": 35
        },
        "org": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/org",
          "hide_notification": false,
          "id": 417,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "org",
          "operation_perms": {},
          "operations": [],
          "order": 19,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Finding org",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "059db373-635b-4afd-9ffa-9580b7dab2f9",
          "values": [],
          "width": 50
        },
        "protocol": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/protocol",
          "hide_notification": false,
          "id": 418,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "protocol",
          "operation_perms": {},
          "operations": [],
          "order": 11,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Protocol",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "d366e76b-cd33-47b8-829f-bc08594371f5",
          "values": [],
          "width": 56
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/query_execution_date",
          "hide_notification": false,
          "id": 436,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query Execution date",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "7e199cfc-4d0d-4efc-897b-4de690071d22",
          "values": [],
          "width": 66
        },
        "remote_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/remote_ip",
          "hide_notification": false,
          "id": 419,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "remote_ip",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Remote IP address",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "55a83144-7056-42e8-8385-84a05b9eb949",
          "values": [],
          "width": 134
        },
        "remote_port": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/remote_port",
          "hide_notification": false,
          "id": 420,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "remote_port",
          "operation_perms": {},
          "operations": [],
          "order": 10,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Remote port",
          "tooltip": "",
          "type_id": 1000,
          "uuid": "1455bed3-ae3e-4bc8-87da-656f87f53c13",
          "values": [],
          "width": 51
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_action_details",
      "uuid": "883bd79f-a9e2-4544-b5bd-cf866725d42c"
    },
    {
      "actions": [],
      "display_name": "GuardDuty Resource Affected",
      "export_key": "gd_resource_affected",
      "fields": {
        "instance_id": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_id",
          "hide_notification": false,
          "id": 421,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_id",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance ID",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "28e8cd5f-c497-4ab4-a0c9-38183628a5ec",
          "values": [],
          "width": 110
        },
        "instance_private_dns": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_private_dns",
          "hide_notification": false,
          "id": 422,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_private_dns",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance private dns name",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "42c93501-a6f8-4885-a5cf-733915be9d22",
          "values": [],
          "width": 140
        },
        "instance_private_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_private_ip",
          "hide_notification": false,
          "id": 423,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_private_ip",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance private ip address",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "dbea58cb-693e-4446-8d2e-68e897e08674",
          "values": [],
          "width": 129
        },
        "instance_public_dns": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_public_dns",
          "hide_notification": false,
          "id": 424,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_public_dns",
          "operation_perms": {},
          "operations": [],
          "order": 9,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance public dns name",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "9d7a63d0-e54e-4282-ba47-8d4c8c4f8618",
          "values": [],
          "width": 134
        },
        "instance_public_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_public_ip",
          "hide_notification": false,
          "id": 425,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_public_ip",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance public ip address",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "eba38abb-b08c-4638-87a6-7d63f80520f6",
          "values": [],
          "width": 124
        },
        "instance_state": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_state",
          "hide_notification": false,
          "id": 426,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_state",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance state",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "a9a97f75-4bb6-41c5-a10c-0e8425e8051d",
          "values": [],
          "width": 137
        },
        "instance_type": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_type",
          "hide_notification": false,
          "id": 427,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_type",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance type",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "2c108511-9154-4704-9da5-ca2845e297a1",
          "values": [],
          "width": 132
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/query_execution_date",
          "hide_notification": false,
          "id": 437,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query execution date",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "4044d357-4e24-47c3-9ede-eb55bdfe2271",
          "values": [],
          "width": 65
        },
        "resource_role": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/resource_role",
          "hide_notification": false,
          "id": 428,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "resource_role",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Resource role",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "c03b7250-29a4-4f47-a4f3-4bcac4c662ef",
          "values": [],
          "width": 130
        },
        "resource_type": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/resource_type",
          "hide_notification": false,
          "id": 429,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "resource_type",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Resource type",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "df53ffe5-968d-4f95-a2c8-038271420ee8",
          "values": [],
          "width": 133
        },
        "s3bucket_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/s3bucket_name",
          "hide_notification": false,
          "id": 430,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "s3bucket_name",
          "operation_perms": {},
          "operations": [],
          "order": 10,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "S3 bucket name",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "37ac99cd-ec58-46a9-b828-935cbe870056",
          "values": [],
          "width": 46
        },
        "s3bucket_owner": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/s3bucket_owner",
          "hide_notification": false,
          "id": 431,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "s3bucket_owner",
          "operation_perms": {},
          "operations": [],
          "order": 11,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "S3 bucket owner",
          "tooltip": "",
          "type_id": 1001,
          "uuid": "efb0aa23-327b-4502-8aa4-172f44dc031b",
          "values": [],
          "width": 46
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_resource_affected",
      "uuid": "b2462a6f-8b07-4702-8943-e0df9213c349"
    }
  ],
  "workflows": [
    {
      "actions": [],
      "content": {
        "version": 50,
        "workflow_id": "wf_aws_guardduty_refresh_finding",
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"wf_aws_guardduty_refresh_finding\" isExecutable=\"true\" name=\"Example: AWS GuardDuty: Refresh Finding\"\u003e\u003cdocumentation\u003eResilient Workflow to refresh AWS GuardDuty finding details in an incident.\u003c/documentation\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eSequenceFlow_0zedv2p\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_06mwqw8\" name=\"AWS GUARDDUTY: Refresh Finding\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"2d1446f8-13fc-4400-af6a-c96b55d9a0df\"\u003e{\"inputs\":{},\"post_processing_script\":\"##  wf_aws_guardduty_refresh_finding ##\\n# Example result:\\n\\\"\\\"\\\"\\nResult: { \u0027version\u0027: \u00271.0\u0027,\\n          \u0027success\u0027: True,\\n          \u0027reason\u0027: None,\\n          \u0027content\u0027: {\u0027payload\u0027: {\u0027name\u0027: \u0027AWS GuardDuty: API GeneratedFindingAPIName was invoked from an IP address on a custom threat list.\u0027,\\n                                  \u0027description\u0027: {\u0027format\u0027: \u0027text\u0027, \u0027content\u0027: \u0027An API was used to access a bucket from an IP address on a custom threat list.\u0027},\\n                                  \u0027discovered_date\u0027: \u00272020-11-25T13:46:37.960Z\u0027,\\n                                  \u0027severity_code\u0027: \u0027Low\u0027,\\n                                  \u0027properties\u0027: {\u0027aws_guardduty_finding_id\u0027: \u002760baffd3f9042e38640f2300d5c5a631\u0027,\\n                                                 \u0027aws_guardduty_finding_arn\u0027: \u0027arn:aws:guardduty:us-west-2:834299573936:detector/f2baedb0ac74f8f42fc929e15f56da6a/finding/60baffd3f9042e38640f2300d5c5a631\u0027,\\n                                                 \u0027aws_guardduty_finding_type\u0027: \u0027UnauthorizedAccess:S3/MaliciousIPCaller.Custom\u0027,\\n                                                 \u0027aws_guardduty_finding_updated_at\u0027: \u00272020-11-26T15:18:12.620Z\u0027, \u0027aws_guardduty_region\u0027: \u0027us-west-2\u0027,\\n                                                 \u0027aws_guardduty_resource_type\u0027: \u0027S3Bucket\u0027, \u0027aws_guardduty_count\u0027: 4,\\n                                                 \u0027aws_guardduty_detector_id\u0027: \u0027f2baedb0ac74f8f42fc929e15f56da6a\u0027},\\n                                  \u0027artifacts\u0027: [],\\n                                  \u0027comments\u0027: [{\u0027text\u0027: {\u0027format\u0027: \u0027text\u0027, \u0027content\u0027: \\\"AWS GuardDuty finding Payload:\\\\n\u0026lt;FINDING_PAYLOAD_AS_STRING\u0026gt;\\\"}}]\\n\\n                                 },\\n                      \\\"data_tables\\\": {\\\"gd_action_details\\\": [{\\\"cells\\\": {\\\"action_type\\\": {\\\"value\\\": \\\"AWS_API_CALL\\\"},\\n                                                             \\\"action_api\\\": {\\\"value\\\": \\\"GeneratedFindingAPIName\\\"},\\n                                                             \\\"event_first_seen\\\": {\\\"value\\\": \\\"2020-11-25T13:46:37.960Z\\\"},\\n                                                             \\\"event_last_seen\\\": {\\\"value\\\": \\\"2020-11-26T15:18:12.620Z\\\"},\\n                                                            \\\"actor_caller_type\\\": {\\\"value\\\": \\\"Remote IP\\\"}, \\\"city_name\\\": {\\\"value\\\": \\\"GeneratedFindingCityName\\\"}, \\\"country_name\\\": {\\\"value\\\": \\\"GeneratedFindingCountryName\\\"}, \\\"asn\\\": {\\\"value\\\": \\\"-1\\\"}, \\\"asn_org\\\": {\\\"value\\\": \\\"GeneratedFindingASNOrg\\\"}, \\\"isp\\\": {\\\"value\\\": \\\"GeneratedFindingISP\\\"}, \\\"org\\\": {\\\"value\\\": \\\"GeneratedFindingORG\\\"}, \\\"action_service_name\\\": {\\\"value\\\": \\\"GeneratedFindingAPIServiceName\\\"}, \\\"remote_ip\\\": {\\\"value\\\": \\\"198.51.100.0\\\"}}}],\\n                                     \\\"gd_resource_affected\\\": [{\\\"cells\\\": {\\\"resource_type\\\": {\\\"value\\\": \\\"S3Bucket\\\"}, \\\"instance_id\\\": {\\\"value\\\": \\\"i-99999999\\\"}, \\\"instance_type\\\": {\\\"value\\\": \\\"m3.xlarge\\\"}, \\\"instance_state\\\": {\\\"value\\\": \\\"running\\\"}, \\\"resource_role\\\": {\\\"value\\\": \\\"TARGET\\\"}, \\\"instance_private_ip\\\": {\\\"value\\\": \\\"10.0.0.1\\\"}, \\\"instance_private_dns\\\": {\\\"value\\\": \\\"GeneratedFindingPrivateName\\\"}, \\\"instance_public_ip\\\": {\\\"value\\\": \\\"198.51.100.0\\\"}, \\\"instance_public_dns\\\": {\\\"value\\\": \\\"GeneratedFindingPublicDNSName\\\"}, \\\"s3bucket_name\\\": {\\\"value\\\": \\\"bucketName\\\"}, \\\"s3bucket_owner\\\": {\\\"value\\\": \\\"CanonicalId of Owner\\\"}}}]\\n\\n                      }}\u0027,\\n            \u0027inputs\u0027: {\u0027incident_id\u0027: 2168, \u0027aws_gd_finding_id\u0027: \u002760baffd3f9042e38640f2300d5c5a631\u0027,\\n                       \u0027aws_gd_region\u0027: \u0027us-west-2\u0027, \u0027aws_gd_detector_id\u0027: \u0027f2baedb0ac74f8f42fc929e15f56da6a\u0027},\\n            \u0027metrics\u0027: {\u0027version\u0027: \u00271.0\u0027, \u0027package\u0027: \u0027fn-aws-guardduty\u0027, \u0027package_version\u0027: \u00271.0.0\u0027,\\n                        \u0027host\u0027: \u0027Johnp-MacBook-Pro-2.galway.ie.ibm.com\u0027, \u0027execution_time_ms\u0027: 10739,\\n                        \u0027timestamp\u0027: \u00272021-01-18 16:51:10\u0027}\\n}\\n\\\"\\\"\\\"\\n#  Globals\\n# List of fields in datatable for wf_aws_guardduty_refresh_finding script\\nDATA_TABLES = [\\\"gd_action_details\\\", \\\"gd_resource_affected\\\"]\\nFN_NAME = \\\"func_aws_guardduty_refresh_finding\\\"\\nWF_NAME = \\\"Example: AWS GuardDuty: Refresh Finding\\\"\\n# Resilient artifact names to api names.\\nARTIFACT_API_TO_TYPE = {\\n    \\\"aws_iam_access_key_id\\\": \\\"AWS IAM Access Key ID\\\",\\n    \\\"aws_iam_user_name\\\": \\\"AWS IAM User Name\\\",\\n    \\\"IP Address\\\": \\\"IP Address\\\",\\n    \\\"DNS Name\\\": \\\"DNS Name\\\",\\n    \\\"Port\\\": \\\"Port\\\"\\n}\\nCONTENT = results.content\\nQUERY_EXECUTION_DATE = results[\\\"metrics\\\"][\\\"timestamp\\\"]\\nif CONTENT:\\n    FINDING = CONTENT.finding\\n    PAYLOAD = CONTENT.payload\\n    ARTIFACTS = PAYLOAD.artifacts\\n    DATA_TABLES = CONTENT.data_tables\\n\\n# Processing\\n\\ndef main():\\n    note_text = \u0027\u0027\\n    if CONTENT:\\n        note_text = \\\"AWS GuardDuty Integration: Workflow \u0026lt;b\u0026gt;{0}\u0026lt;/b\u0026gt;: Finding data returned for Resilient function \\\" \\\\\\n                    \\\"\u0026lt;b\u0026gt;{2}\u0026lt;/b\u0026gt;\\\".format(WF_NAME, len(CONTENT), FN_NAME)\\n\\n        update_fields()\\n        update_datatables()\\n        if ARTIFACTS:\\n            add_artifacts()\\n    else:\\n        note_text = \\\"AWS GuardDuty Integration: Workflow \u0026lt;b\u0026gt;{0}\u0026lt;/b\u0026gt;: No finding data returned for Resilient function \\\" \\\\\\n                    \\\"\u0026lt;b\u0026gt;{2}\u0026lt;/b\u0026gt;\\\".format(WF_NAME, len(CONTENT), FN_NAME)\\n\\n    incident.addNote(helper.createRichText(note_text))\\n\\ndef update_fields():\\n    incident.severity_code = PAYLOAD[\\\"severity_code\\\"]\\n    incident.properties.aws_guardduty_finding_updated_at = PAYLOAD[\\\"properties\\\"][\\\"aws_guardduty_finding_updated_at\\\"]\\n    incident.properties.aws_guardduty_count = str(PAYLOAD[\\\"properties\\\"][\\\"aws_guardduty_count\\\"])\\n\\n\\ndef update_datatables():\\n    for data_table in DATA_TABLES:\\n        for row in DATA_TABLES[data_table]:\\n            newrow = incident.addRow(data_table)\\n            newrow.query_execution_date = QUERY_EXECUTION_DATE\\n            data_table_fields = row[\\\"cells\\\"]\\n            for f, v_info in data_table_fields.items():\\n                newrow[f] = v_info.value\\n\\n\\ndef add_artifacts():\\n    for artifact in ARTIFACTS:\\n        artifact_type = ARTIFACT_API_TO_TYPE[artifact[\\\"type\\\"][\\\"name\\\"]]\\n        artifact_value = artifact[\\\"value\\\"]\\n        description = artifact[\\\"description\\\"][\\\"content\\\"]\\n        incident.addArtifact(artifact_type, artifact_value, description)\\n\\n\\nif __name__ == \\\"__main__\\\":\\n    main()\\n\",\"post_processing_script_language\":\"python\",\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_finding_id = incident.properties.aws_guardduty_finding_id\\ninputs.incident_id = incident.id\",\"pre_processing_script_language\":\"python\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eSequenceFlow_0zedv2p\u003c/incoming\u003e\u003coutgoing\u003eSequenceFlow_0k5uvi0\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"SequenceFlow_0zedv2p\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_06mwqw8\"/\u003e\u003cendEvent id=\"EndEvent_0ec9efk\"\u003e\u003cincoming\u003eSequenceFlow_0k5uvi0\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"SequenceFlow_0k5uvi0\" sourceRef=\"ServiceTask_06mwqw8\" targetRef=\"EndEvent_0ec9efk\"/\u003e\u003ctextAnnotation id=\"TextAnnotation_1kxxiyt\"\u003e\u003ctext\u003eStart your workflow here\u003c/text\u003e\u003c/textAnnotation\u003e\u003cassociation id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"162\" y=\"188\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"157\" y=\"223\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"\u003e\u003comgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"\u003e\u003comgdi:waypoint x=\"169\" xsi:type=\"omgdc:Point\" y=\"220\"/\u003e\u003comgdi:waypoint x=\"153\" xsi:type=\"omgdc:Point\" y=\"254\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_06mwqw8\" id=\"ServiceTask_06mwqw8_di\"\u003e\u003comgdc:Bounds height=\"80\" width=\"100\" x=\"255\" y=\"166\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0zedv2p\" id=\"SequenceFlow_0zedv2p_di\"\u003e\u003comgdi:waypoint x=\"198\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003comgdi:waypoint x=\"228\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003comgdi:waypoint x=\"228\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003comgdi:waypoint x=\"255\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"0\" x=\"243\" y=\"199.5\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndEvent_0ec9efk\" id=\"EndEvent_0ec9efk_di\"\u003e\u003comgdc:Bounds height=\"36\" width=\"36\" x=\"395\" y=\"188\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"0\" x=\"413\" y=\"227\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0k5uvi0\" id=\"SequenceFlow_0k5uvi0_di\"\u003e\u003comgdi:waypoint x=\"355\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003comgdi:waypoint x=\"395\" xsi:type=\"omgdc:Point\" y=\"206\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"13\" width=\"0\" x=\"375\" y=\"184\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNEdge\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "content_version": 50,
      "creator_id": "a@a.com",
      "description": "Resilient Workflow to refresh AWS GuardDuty finding details in an incident.",
      "export_key": "wf_aws_guardduty_refresh_finding",
      "last_modified_by": "a@a.com",
      "last_modified_time": 1611322091467,
      "name": "Example: AWS GuardDuty: Refresh Finding",
      "object_type": "incident",
      "programmatic_name": "wf_aws_guardduty_refresh_finding",
      "tags": [],
      "uuid": "25ff8bf1-ed1b-433b-912a-a78e6a9384c5",
      "workflow_id": 1
    }
  ],
  "workspaces": []
}
