{
  "action_order": [],
  "actions": [],
  "apps": [],
  "automatic_tasks": [],
  "case_matching_profiles": [],
  "export_date": 1755602632053,
  "export_format_version": 2,
  "export_type": null,
  "fields": [
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_tags",
      "hide_notification": false,
      "id": 5603,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_tags",
      "operation_perms": {},
      "operations": [],
      "placeholder": "key:value, key:value",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_tags",
      "tooltip": "The tags to be added to a new threat list resource.",
      "type_id": 11,
      "uuid": "84108237-0d1d-47eb-acdc-4669db2cc4b0",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_client_token",
      "hide_notification": false,
      "id": 5601,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_client_token",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_client_token",
      "tooltip": "The idempotency token for the create request.",
      "type_id": 11,
      "uuid": "86154057-7b78-44bf-b274-6447a83288b7",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": true,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_activate",
      "hide_notification": false,
      "id": 5598,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_activate",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_activate",
      "tooltip": "A Boolean value that indicates whether GuardDuty is to start using the uploaded ThreatIntelSet.",
      "type_id": 11,
      "uuid": "92a56cf4-44a6-4662-a9c1-06f632627367",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_region",
      "hide_notification": false,
      "id": 5494,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_region",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_region",
      "tooltip": "AWS GuardDuty region.",
      "type_id": 11,
      "uuid": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_detector_id",
      "hide_notification": false,
      "id": 5495,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_detector_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_detector_id",
      "tooltip": "AWS GuardDuty detector ID.",
      "type_id": 11,
      "uuid": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_new_activate",
      "hide_notification": false,
      "id": 5780,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_new_activate",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_new_activate",
      "tooltip": "The updated Boolean value that specifies whether the ThreateIntelSet is active or not.",
      "type_id": 11,
      "uuid": "a445e475-0104-4c96-b7b0-09cbd94726ed",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_finding_id",
      "hide_notification": false,
      "id": 5496,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_finding_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_finding_id",
      "tooltip": "AWS GuardDuty finding ID.",
      "type_id": 11,
      "uuid": "a90b292d-a1c4-45b0-96f0-20ff45818655",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_location",
      "hide_notification": false,
      "id": 5602,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_location",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_location",
      "tooltip": "The URI of the file that contains the ThreatIntelSet.",
      "type_id": 11,
      "uuid": "b2684643-94e8-43ce-addf-006642471ac3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_new_name",
      "hide_notification": false,
      "id": 5777,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_new_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_new_name",
      "tooltip": "A new user-friendly ThreatIntelSet name displayed in all findings that are generated by activity that involves IP addresses included in this ThreatIntelSet.",
      "type_id": 11,
      "uuid": "db760a1b-581e-48e6-9a5e-dae588e1e7eb",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_next_token",
      "hide_notification": false,
      "id": 5743,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_next_token",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_next_token",
      "tooltip": "You can use this parameter to paginate results in the response",
      "type_id": 11,
      "uuid": "efcd8abd-835b-4ba9-a7a7-7855897bdac2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_ip_set_id",
      "hide_notification": false,
      "id": 5796,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_ip_set_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_ip_set_id",
      "tooltip": "The unique ID of the IPSet to retrieve.",
      "type_id": 11,
      "uuid": "fcee14e3-c174-4000-b165-659ececaf673",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_format",
      "hide_notification": false,
      "id": 5599,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_format",
      "operation_perms": {},
      "operations": [],
      "placeholder": "TXT | STIX | OTX_CSV | ALIEN_VAULT | PROOF_POINT | FIRE_EYE",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_format",
      "tooltip": "The format of the file that contains the ThreatIntelSet.",
      "type_id": 11,
      "uuid": "23cf2dd3-d5ba-466b-a4ae-0e034a09025c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_new_location",
      "hide_notification": false,
      "id": 5778,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_new_location",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_new_location",
      "tooltip": "The updated URI of the file that contains the ThreateIntelSet.",
      "type_id": 11,
      "uuid": "33554634-5429-42a9-93fb-78d8761bb763",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_bucket_owner",
      "hide_notification": false,
      "id": 5788,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_bucket_owner",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_bucket_owner",
      "tooltip": "The Amazon Web Services account ID that owns the Amazon S3 bucket specified in the location parameter.",
      "type_id": 11,
      "uuid": "345e35cc-2eba-4f87-b7a2-62d74b4897e0",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_threat_intel_set_id",
      "hide_notification": false,
      "id": 5740,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_threat_intel_set_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_threat_intel_set_id",
      "tooltip": "The unique ID of the threatIntelSet that you want to get.",
      "type_id": 11,
      "uuid": "3da3fc26-feeb-4020-9d3b-70ff87b7dbb0",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_name",
      "hide_notification": false,
      "id": 5600,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_name",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "required": "always",
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_name",
      "tooltip": "A user-friendly ThreatIntelSet name displayed in all findings that are generated by activity that involves IP addresses included in this ThreatIntelSet.",
      "type_id": 11,
      "uuid": "455d2080-bd26-40d7-9da2-caca3e1295a2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/aws_gd_max_results",
      "hide_notification": false,
      "id": 5742,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "aws_gd_max_results",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "aws_gd_max_results",
      "tooltip": "Parameter to indicate the maximum number of items that you want in the response",
      "type_id": 11,
      "uuid": "5462d0fa-c5da-4741-b1f3-d8dcadcfddd2",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "__function/incident_id",
      "hide_notification": false,
      "id": 2753,
      "input_type": "number",
      "internal": false,
      "is_tracked": false,
      "name": "incident_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "IncidentID",
      "prefix": null,
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "incident_id",
      "tooltip": "SOAR Incident ID",
      "type_id": 11,
      "uuid": "5eaaeb87-cb70-4877-aa5e-0a5b10f73f3a",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_severity",
      "hide_notification": false,
      "id": 5427,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_severity",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Severity",
      "tooltip": "The severity of the affected resource of the GuardDuty finding. ",
      "type_id": 0,
      "uuid": "9b26f0fc-bfca-467b-8c21-be0edc22768d",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_region",
      "hide_notification": false,
      "id": 5428,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_region",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Region",
      "tooltip": "The AWS Region in which the GuardDuty finding was generated. ",
      "type_id": 0,
      "uuid": "a5789c35-3e6f-4229-a671-2fe7ba6f3457",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_count",
      "hide_notification": false,
      "id": 5429,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_count",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Count",
      "tooltip": "The number of times GuardDuty has aggregated an activity matching this pattern to this finding ID. ",
      "type_id": 0,
      "uuid": "a64d69ca-fb01-4bc1-a102-2ceea30b6b6b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_id",
      "hide_notification": false,
      "id": 5430,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Finding Id",
      "tooltip": "A unique Finding ID for this GuardDuty finding type and set of parameters. New occurrences of activity matching this pattern will be aggregated to the same ID. ",
      "type_id": 0,
      "uuid": "e380c315-601d-4052-90b5-78efe75d7eab",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_arn",
      "hide_notification": false,
      "id": 5431,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_arn",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Finding Arn",
      "tooltip": "Arn of the GuardDuty finding.",
      "type_id": 0,
      "uuid": "f1c8fa20-ffc3-4942-98bb-1d84fdc92f32",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_resource_type",
      "hide_notification": false,
      "id": 5432,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_resource_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Resource Type",
      "tooltip": "The type of the affected resource of the GuardDuty finding. This value is either AccessKey, S3 bucket or Instance. ",
      "type_id": 0,
      "uuid": "251c8f2a-9a9d-4b0e-b9a2-ed15e022754c",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_detector_id",
      "hide_notification": false,
      "id": 5433,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_detector_id",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Detector Id",
      "tooltip": "The detector ID where the GuardDuty finding was detected.",
      "type_id": 0,
      "uuid": "5e191046-c9ce-4e74-b5be-f7277f93792b",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_updated_at",
      "hide_notification": false,
      "id": 5434,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_updated_at",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Resource Updated At",
      "tooltip": "The last time this finding was updated with new activity matching the pattern that prompted GuardDuty to generate this finding. ",
      "type_id": 0,
      "uuid": "63d7c51c-ab4d-417e-9173-6d366d05f6d5",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_archived",
      "hide_notification": false,
      "id": 5435,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_archived",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Archived",
      "tooltip": " A true or false value that indicates whether this is GuardDuty finding has been archived. ",
      "type_id": 0,
      "uuid": "6d5742bd-1e74-47c3-b20f-0a786a9fcfa3",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_finding_type",
      "hide_notification": false,
      "id": 5436,
      "input_type": "text",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_finding_type",
      "operation_perms": {},
      "operations": [],
      "placeholder": "",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Finding Type",
      "tooltip": "The type of activity that triggered the GuardDuty finding.",
      "type_id": 0,
      "uuid": "6fc421a3-c414-48de-9d39-bb833b777d00",
      "values": []
    },
    {
      "allow_default_value": false,
      "blank_option": false,
      "calculated": false,
      "changeable": true,
      "chosen": false,
      "default_chosen_by_server": false,
      "deprecated": false,
      "export_key": "incident/aws_guardduty_trigger_refresh",
      "hide_notification": false,
      "id": 5437,
      "input_type": "boolean",
      "internal": false,
      "is_tracked": false,
      "name": "aws_guardduty_trigger_refresh",
      "operation_perms": {},
      "operations": [],
      "placeholder": "False",
      "prefix": "properties",
      "read_only": false,
      "rich_text": false,
      "tags": [],
      "templates": [],
      "text": "AWS GuardDuty Trigger Refresh",
      "tooltip": "Used by integration to trigger an refresh of GuardDuty incidents.",
      "type_id": 0,
      "uuid": "766a53c2-6684-44bb-9808-2cc774c56747",
      "values": []
    },
    {
      "export_key": "incident/internal_customizations_field",
      "id": 0,
      "input_type": "text",
      "internal": true,
      "name": "internal_customizations_field",
      "read_only": true,
      "text": "Customizations Field (internal)",
      "type_id": 0,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"
    }
  ],
  "functions": [
    {
      "created_date": 1753111022384,
      "description": {
        "content": "Creates a new IPSet, which is called a trusted IP list in the console user interface. An IPSet is a list of IP addresses that are trusted for secure communication with Amazon Web Services infrastructure and applications. GuardDuty doesn\u2019t generate findings for IP addresses that are included in IPSets.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Create IPSet",
      "export_key": "aws_guardduty_create_ipset",
      "id": 660,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_create_ipset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"ResponseMetadata\": {\"RequestId\": \"1be8305d-f302-4301-8f00-4a6d15c0a821\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": {\"date\": \"Mon, 21 Jul 2025 15:52:24 GMT\", \"content-type\": \"application/json\", \"content-length\": \"46\", \"connection\": \"***\", \"x-amzn-requestid\": \"1be8305d-f302-4301-8f00-4a6d15c0a821\", \"access-control-allow-origin\": \"*\", \"access-control-allow-headers\": \"Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-Content-Sha256,X-Amz-User-Agent,*,Date,X-Amz-Target,x-amzn-platform-id,x-amzn-trace-id\", \"x-amz-apigw-id\": \"OERH2EjfIAMEVrA=\", \"access-control-expose-headers\": \"x-amzn-ErrorType,x-amzn-requestid,x-amzn-errormessage,x-amzn-trace-id,x-amz-apigw-id,Date\", \"x-amzn-trace-id\": \"Root=1-687e6231-7b0f093571c8dbf50752f9d2;Parent=0774277cbf97c298;Sampled=0;Lineage=1:d3f66639:0\", \"access-control-max-age\": \"86400\"}, \"RetryAttempts\": 0}, \"IpSetId\": \"6c4c7290f81b40ab85e298a785b1db38\", \"status\": \"ok\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_format\": \"TXT\", \"aws_gd_bucket_owner\": \"None\", \"aws_gd_name\": \"Test 21\", \"aws_gd_region\": \"us-east-1\", \"aws_gd_location\": \"s3://test-ip-set/trusted_ip.txt\", \"aws_gd_client_token\": \"***\", \"aws_gd_tags\": \"Owner: Hydra\", \"aws_gd_activate\": \"True\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 8094, \"timestamp\": \"2025-07-21 16:52:24\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"ResponseMetadata\": {\"type\": \"object\", \"properties\": {\"RequestId\": {\"type\": \"string\"}, \"HTTPStatusCode\": {\"type\": \"number\"}, \"HTTPHeaders\": {\"type\": \"object\", \"properties\": {\"date\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"content-length\": {\"type\": \"string\"}, \"connection\": {\"type\": \"string\"}, \"x-amzn-requestid\": {\"type\": \"string\"}, \"access-control-allow-origin\": {\"type\": \"string\"}, \"access-control-allow-headers\": {\"type\": \"string\"}, \"x-amz-apigw-id\": {\"type\": \"string\"}, \"access-control-expose-headers\": {\"type\": \"string\"}, \"x-amzn-trace-id\": {\"type\": \"string\"}, \"access-control-max-age\": {\"type\": \"string\"}}, \"required\": [\"date\", \"content-type\", \"content-length\", \"connection\", \"x-amzn-requestid\", \"access-control-allow-origin\", \"access-control-allow-headers\", \"x-amz-apigw-id\", \"access-control-expose-headers\", \"x-amzn-trace-id\", \"access-control-max-age\"]}, \"RetryAttempts\": {\"type\": \"number\"}}, \"required\": [\"RequestId\", \"HTTPStatusCode\", \"HTTPHeaders\", \"RetryAttempts\"]}, \"IpSetId\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}}, \"required\": [\"ResponseMetadata\", \"IpSetId\", \"status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_format\": {\"type\": \"string\"}, \"aws_gd_bucket_owner\": {\"type\": \"string\"}, \"aws_gd_name\": {\"type\": \"string\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_location\": {\"type\": \"string\"}, \"aws_gd_client_token\": {\"type\": \"string\"}, \"aws_gd_tags\": {\"type\": \"string\"}, \"aws_gd_activate\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_format\", \"aws_gd_bucket_owner\", \"aws_gd_name\", \"aws_gd_region\", \"aws_gd_location\", \"aws_gd_client_token\", \"aws_gd_tags\", \"aws_gd_activate\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"localhost\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"localhost\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "0832d3fa-bcd1-4ca5-b40a-0529698c5d80",
      "version": 1,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "455d2080-bd26-40d7-9da2-caca3e1295a2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "23cf2dd3-d5ba-466b-a4ae-0e034a09025c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "b2684643-94e8-43ce-addf-006642471ac3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "92a56cf4-44a6-4662-a9c1-06f632627367",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "86154057-7b78-44bf-b274-6447a83288b7",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "84108237-0d1d-47eb-acdc-4669db2cc4b0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "345e35cc-2eba-4f87-b7a2-62d74b4897e0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1751019476158,
      "description": {
        "content": "Creates a new ThreatIntelSet. ThreatIntelSets consist of known malicious IP addresses. GuardDuty generates findings based on ThreatIntelSets. Only users of the administrator account can use this operation.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Create ThreatIntelSet",
      "export_key": "aws_guardduty_create_threatintelset",
      "id": 625,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_create_threatintelset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"ResponseMetadata\": {\"RequestId\": \"df0f48de-de02-4d20-b88b-5234c715a14a\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": {\"date\": \"Fri, 18 Jul 2025 13:27:40 GMT\", \"content-type\": \"application/json\", \"content-length\": \"55\", \"connection\": \"***\", \"x-amzn-requestid\": \"df0f48de-de02-4d20-b88b-5234c715a14a\", \"access-control-allow-origin\": \"*\", \"access-control-allow-headers\": \"Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-Content-Sha256,X-Amz-User-Agent,*,Date,X-Amz-Target,x-amzn-platform-id,x-amzn-trace-id\", \"x-amz-apigw-id\": \"N6DIBG_7IAMEogw=\", \"access-control-expose-headers\": \"x-amzn-ErrorType,x-amzn-requestid,x-amzn-errormessage,x-amzn-trace-id,x-amz-apigw-id,Date\", \"x-amzn-trace-id\": \"Root=1-687a4bcc-149a260c62ef8c641a7c8df5;Parent=3a406d782efd26b9;Sampled=0;Lineage=1:045398e1:0\", \"access-control-max-age\": \"86400\"}, \"RetryAttempts\": 0}, \"ThreatIntelSetId\": \"114da827a1d0442b96f7039275b321e8\", \"status\": \"ok\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_format\": \"TXT\", \"aws_gd_name\": \"Test 18\", \"aws_gd_region\": \"us-east-1\", \"aws_gd_location\": \"s3://test-threat-intel-set/malicious_ip.txt\", \"aws_gd_client_token\": \"***\", \"aws_gd_tags\": \"Severity:LOW, Mitigation:Possible\", \"aws_gd_activate\": \"False\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 1303, \"timestamp\": \"2025-07-18 14:27:41\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"ResponseMetadata\": {\"type\": \"object\", \"properties\": {\"RequestId\": {\"type\": \"string\"}, \"HTTPStatusCode\": {\"type\": \"number\"}, \"HTTPHeaders\": {\"type\": \"object\", \"properties\": {\"date\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"content-length\": {\"type\": \"string\"}, \"connection\": {\"type\": \"string\"}, \"x-amzn-requestid\": {\"type\": \"string\"}, \"access-control-allow-origin\": {\"type\": \"string\"}, \"access-control-allow-headers\": {\"type\": \"string\"}, \"x-amz-apigw-id\": {\"type\": \"string\"}, \"access-control-expose-headers\": {\"type\": \"string\"}, \"x-amzn-trace-id\": {\"type\": \"string\"}, \"access-control-max-age\": {\"type\": \"string\"}}, \"required\": [\"date\", \"content-type\", \"content-length\", \"connection\", \"x-amzn-requestid\", \"access-control-allow-origin\", \"access-control-allow-headers\", \"x-amz-apigw-id\", \"access-control-expose-headers\", \"x-amzn-trace-id\", \"access-control-max-age\"]}, \"RetryAttempts\": {\"type\": \"number\"}}, \"required\": [\"RequestId\", \"HTTPStatusCode\", \"HTTPHeaders\", \"RetryAttempts\"]}, \"ThreatIntelSetId\": {\"type\": \"string\"}, \"status\": {\"type\": \"string\"}}, \"required\": [\"ResponseMetadata\", \"ThreatIntelSetId\", \"status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_format\": {\"type\": \"string\"}, \"aws_gd_name\": {\"type\": \"string\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_location\": {\"type\": \"string\"}, \"aws_gd_client_token\": {\"type\": \"string\"}, \"aws_gd_tags\": {\"type\": \"string\"}, \"aws_gd_activate\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_format\", \"aws_gd_name\", \"aws_gd_region\", \"aws_gd_location\", \"aws_gd_client_token\", \"aws_gd_tags\", \"aws_gd_activate\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"localhost\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"localhost\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "30ff0a1a-46e4-4952-91fe-7e15ce6c9596",
      "version": 6,
      "view_items": [
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "455d2080-bd26-40d7-9da2-caca3e1295a2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "23cf2dd3-d5ba-466b-a4ae-0e034a09025c",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "b2684643-94e8-43ce-addf-006642471ac3",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "92a56cf4-44a6-4662-a9c1-06f632627367",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "86154057-7b78-44bf-b274-6447a83288b7",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "84108237-0d1d-47eb-acdc-4669db2cc4b0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1753438606554,
      "description": {
        "content": "Deletes the IPSet specified by the IPSet ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Delete IPSet",
      "export_key": "aws_guardduty_delete_ipset",
      "id": 664,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_delete_ipset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"ResponseMetadata\": {\"RequestId\": \"5b6eb26f-29f2-42fd-997f-6617dd1c2e40\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": {\"date\": \"Fri, 25 Jul 2025 10:58:36 GMT\", \"content-type\": \"application/json\", \"content-length\": \"0\", \"connection\": \"***\", \"x-amzn-requestid\": \"5b6eb26f-29f2-42fd-997f-6617dd1c2e40\", \"access-control-allow-origin\": \"*\", \"access-control-allow-headers\": \"Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-Content-Sha256,X-Amz-User-Agent,*,Date,X-Amz-Target,x-amzn-platform-id,x-amzn-trace-id\", \"x-amz-apigw-id\": \"OQx2fHRDIAMEnfQ=\", \"access-control-expose-headers\": \"x-amzn-ErrorType,x-amzn-requestid,x-amzn-errormessage,x-amzn-trace-id,x-amz-apigw-id,Date\", \"x-amzn-trace-id\": \"Root=1-6883635c-4177cf1b3b77b0c042d84c30;Parent=34bf08862f02b77e;Sampled=0;Lineage=1:7ef22fc1:0\", \"access-control-max-age\": \"86400\"}, \"RetryAttempts\": 0}, \"status\": \"ok\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_region\": \"us-east-1\", \"aws_gd_ip_set_id\": \"6c4c7290f81b40ab85e298a785b1db38\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 4106, \"timestamp\": \"2025-07-25 11:58:36\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"ResponseMetadata\": {\"type\": \"object\", \"properties\": {\"RequestId\": {\"type\": \"string\"}, \"HTTPStatusCode\": {\"type\": \"number\"}, \"HTTPHeaders\": {\"type\": \"object\", \"properties\": {\"date\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"content-length\": {\"type\": \"string\"}, \"connection\": {\"type\": \"string\"}, \"x-amzn-requestid\": {\"type\": \"string\"}, \"access-control-allow-origin\": {\"type\": \"string\"}, \"access-control-allow-headers\": {\"type\": \"string\"}, \"x-amz-apigw-id\": {\"type\": \"string\"}, \"access-control-expose-headers\": {\"type\": \"string\"}, \"x-amzn-trace-id\": {\"type\": \"string\"}, \"access-control-max-age\": {\"type\": \"string\"}}, \"required\": [\"date\", \"content-type\", \"content-length\", \"connection\", \"x-amzn-requestid\", \"access-control-allow-origin\", \"access-control-allow-headers\", \"x-amz-apigw-id\", \"access-control-expose-headers\", \"x-amzn-trace-id\", \"access-control-max-age\"]}, \"RetryAttempts\": {\"type\": \"number\"}}, \"required\": [\"RequestId\", \"HTTPStatusCode\", \"HTTPHeaders\", \"RetryAttempts\"]}, \"status\": {\"type\": \"string\"}}, \"required\": [\"ResponseMetadata\", \"status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_ip_set_id\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_region\", \"aws_gd_ip_set_id\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"host\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "849c767e-aacd-408a-b764-26d6a68c8a86",
      "version": 1,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "fcee14e3-c174-4000-b165-659ececaf673",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1752741544786,
      "description": {
        "content": "Deletes the ThreatIntelSet specified by the ThreatIntelSet ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Delete ThreatIntelSet",
      "export_key": "aws_guardduty_delete_threatintelset",
      "id": 659,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_delete_threatintelset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"ResponseMetadata\": {\"RequestId\": \"070495ba-88a7-4c18-93f7-a0d89136763d\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": {\"date\": \"Fri, 18 Jul 2025 14:25:30 GMT\", \"content-type\": \"application/json\", \"content-length\": \"0\", \"connection\": \"***\", \"x-amzn-requestid\": \"070495ba-88a7-4c18-93f7-a0d89136763d\", \"access-control-allow-origin\": \"*\", \"access-control-allow-headers\": \"Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-Content-Sha256,X-Amz-User-Agent,*,Date,X-Amz-Target,x-amzn-platform-id,x-amzn-trace-id\", \"x-amz-apigw-id\": \"N6LlsGaZIAMEqpw=\", \"access-control-expose-headers\": \"x-amzn-ErrorType,x-amzn-requestid,x-amzn-errormessage,x-amzn-trace-id,x-amz-apigw-id,Date\", \"x-amzn-trace-id\": \"Root=1-687a5957-396bfc5e5ec974a90850c898;Parent=166ae2d7206e62ff;Sampled=0;Lineage=1:511d78a8:0\", \"access-control-max-age\": \"86400\"}, \"RetryAttempts\": 0}, \"status\": \"ok\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_region\": \"us-east-1\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\", \"aws_gd_threat_intel_set_id\": \"1acc0467837941db18401c6cd2e2287b\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 3659, \"timestamp\": \"2025-07-18 15:25:30\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"ResponseMetadata\": {\"type\": \"object\", \"properties\": {\"RequestId\": {\"type\": \"string\"}, \"HTTPStatusCode\": {\"type\": \"number\"}, \"HTTPHeaders\": {\"type\": \"object\", \"properties\": {\"date\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"content-length\": {\"type\": \"string\"}, \"connection\": {\"type\": \"string\"}, \"x-amzn-requestid\": {\"type\": \"string\"}, \"access-control-allow-origin\": {\"type\": \"string\"}, \"access-control-allow-headers\": {\"type\": \"string\"}, \"x-amz-apigw-id\": {\"type\": \"string\"}, \"access-control-expose-headers\": {\"type\": \"string\"}, \"x-amzn-trace-id\": {\"type\": \"string\"}, \"access-control-max-age\": {\"type\": \"string\"}}, \"required\": [\"date\", \"content-type\", \"content-length\", \"connection\", \"x-amzn-requestid\", \"access-control-allow-origin\", \"access-control-allow-headers\", \"x-amz-apigw-id\", \"access-control-expose-headers\", \"x-amzn-trace-id\", \"access-control-max-age\"]}, \"RetryAttempts\": {\"type\": \"number\"}}, \"required\": [\"RequestId\", \"HTTPStatusCode\", \"HTTPHeaders\", \"RetryAttempts\"]}, \"status\": {\"type\": \"string\"}}, \"required\": [\"ResponseMetadata\", \"status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}, \"aws_gd_threat_intel_set_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_region\", \"aws_gd_detector_id\", \"aws_gd_threat_intel_set_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"localhost\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"localhost\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "14d6c7c5-c658-4240-b23e-10794d8ef0f0",
      "version": 3,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "3da3fc26-feeb-4020-9d3b-70ff87b7dbb0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1753259812614,
      "description": {
        "content": "Retrieves the IPSet specified by the IPSetId.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Get IPSet",
      "export_key": "aws_guardduty_get_ipset",
      "id": 661,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_get_ipset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"Name\": \"Test 21\", \"Format\": \"TXT\", \"Location\": \"s3://test-ip-set/trusted_ip.txt\", \"Tags\": {\"Owner\": \"Hydra\"}, \"Status\": \"ACTIVE\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_region\": \"us-east-1\", \"aws_gd_ip_set_id\": \"6c4c7290f81b40ab85e298a785b1db38\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 720, \"timestamp\": \"2025-07-23 10:20:20\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"Name\": {\"type\": \"string\"}, \"Format\": {\"type\": \"string\"}, \"Location\": {\"type\": \"string\"}, \"Tags\": {\"type\": \"object\", \"properties\": {\"Owner\": {\"type\": \"string\"}}, \"required\": [\"Owner\"]}, \"Status\": {\"type\": \"string\"}}, \"required\": [\"Name\", \"Format\", \"Location\", \"Tags\", \"Status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_ip_set_id\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_region\", \"aws_gd_ip_set_id\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"host\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "504e4145-7243-42e3-a04a-cae366b5a39c",
      "version": 1,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "fcee14e3-c174-4000-b165-659ececaf673",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1752134976603,
      "description": {
        "content": "Retrieves the ThreatIntelSet that is specified by the ThreatIntelSet ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Get ThreatIntelSet",
      "export_key": "aws_guardduty_get_threatintelset",
      "id": 653,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_get_threatintelset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"Name\": \"Test 18\", \"Format\": \"TXT\", \"Location\": \"s3://test-threat-intel-set/malicious_ip.txt\", \"Tags\": {\"Mitigation\": \"Possible\", \"Severity\": \"LOW\"}, \"Status\": \"INACTIVE\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_region\": \"us-east-1\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\", \"aws_gd_threat_intel_set_id\": \"114da827a1d0442b96f7039275b321e8\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 972, \"timestamp\": \"2025-07-18 14:41:10\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"Name\": {\"type\": \"string\"}, \"Format\": {\"type\": \"string\"}, \"Location\": {\"type\": \"string\"}, \"Tags\": {\"type\": \"object\", \"properties\": {\"Mitigation\": {\"type\": \"string\"}, \"Severity\": {\"type\": \"string\"}}, \"required\": [\"Mitigation\", \"Severity\"]}, \"Status\": {\"type\": \"string\"}}, \"required\": [\"Name\", \"Format\", \"Location\", \"Tags\", \"Status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}, \"aws_gd_threat_intel_set_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_region\", \"aws_gd_detector_id\", \"aws_gd_threat_intel_set_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"localhost\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"localhost\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "fb4e92b7-42fd-480e-944c-91ebe4b66b62",
      "version": 4,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "3da3fc26-feeb-4020-9d3b-70ff87b7dbb0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1753279629106,
      "description": {
        "content": "Lists the IPSets of the GuardDuty service specified by the detector ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: List IPSet",
      "export_key": "aws_guardduty_list_ipset",
      "id": 662,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_list_ipset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": [\"6c4c7290f81b40ab85e298a785b1db38\"], \"raw\": \"None\", \"inputs\": {\"aws_gd_max_results\": 5, \"aws_gd_region\": \"us-east-1\", \"aws_gd_next_token\": \"***\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 698, \"timestamp\": \"2025-07-23 15:54:02\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_max_results\": {\"type\": \"number\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_next_token\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_max_results\", \"aws_gd_region\", \"aws_gd_next_token\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"host\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "770193c3-7e68-45c9-afbe-d24646e68222",
      "version": 1,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "5462d0fa-c5da-4741-b1f3-d8dcadcfddd2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "efcd8abd-835b-4ba9-a7a7-7855897bdac2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1752230447474,
      "description": {
        "content": "Lists the ThreatIntelSets of the GuardDuty service specified by the detector ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: List ThreatIntelSet",
      "export_key": "aws_guardduty_list_threatintelset",
      "id": 654,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_list_threatintelset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": [\"114da827a1d0442b96f7039275b321e8\", \"1acc0467837941db18401c6cd2e2287b\", \"4face156778d48a3a06663dd461187ce\", \"68e7855700034e989863db54335ae22b\"], \"raw\": \"None\", \"inputs\": {\"aws_gd_max_results\": 5, \"aws_gd_region\": \"us-east-1\", \"aws_gd_next_token\": \"***\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 1080, \"timestamp\": \"2025-07-18 14:54:25\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_max_results\": {\"type\": \"number\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_next_token\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_max_results\", \"aws_gd_region\", \"aws_gd_next_token\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"localhost\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"localhost\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "743e2891-6e0d-4635-907c-8e11e058ed6e",
      "version": 3,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "5462d0fa-c5da-4741-b1f3-d8dcadcfddd2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "efcd8abd-835b-4ba9-a7a7-7855897bdac2",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1753367602830,
      "description": {
        "content": "Updates the IPSet specified by the IPSet ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Update IPSet",
      "export_key": "aws_guardduty_update_ipset",
      "id": 663,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617827,
      "name": "aws_guardduty_update_ipset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"ResponseMetadata\": {\"RequestId\": \"1b12ee00-ad22-4282-acdd-b00392e7cf9b\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": {\"date\": \"Thu, 24 Jul 2025 15:30:47 GMT\", \"content-type\": \"application/json\", \"content-length\": \"0\", \"connection\": \"***\", \"x-amzn-requestid\": \"1b12ee00-ad22-4282-acdd-b00392e7cf9b\", \"access-control-allow-origin\": \"*\", \"access-control-allow-headers\": \"Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-Content-Sha256,X-Amz-User-Agent,*,Date,X-Amz-Target,x-amzn-platform-id,x-amzn-trace-id\", \"x-amz-apigw-id\": \"OOGyPEGLoAMEjtg=\", \"access-control-expose-headers\": \"x-amzn-ErrorType,x-amzn-requestid,x-amzn-errormessage,x-amzn-trace-id,x-amz-apigw-id,Date\", \"x-amzn-trace-id\": \"Root=1-688251a7-3dff520410c0e6d3091b3ec1;Parent=03617a02703ed4c9;Sampled=0;Lineage=1:f75216a5:0\", \"access-control-max-age\": \"86400\"}, \"RetryAttempts\": 0}, \"status\": \"ok\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_new_location\": \"None\", \"aws_gd_bucket_owner\": \"None\", \"aws_gd_region\": \"us-east-1\", \"aws_gd_new_name\": \"None\", \"aws_gd_ip_set_id\": \"6c4c7290f81b40ab85e298a785b1db38\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\", \"aws_gd_new_activate\": \"False\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 1573, \"timestamp\": \"2025-07-24 16:30:47\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"ResponseMetadata\": {\"type\": \"object\", \"properties\": {\"RequestId\": {\"type\": \"string\"}, \"HTTPStatusCode\": {\"type\": \"number\"}, \"HTTPHeaders\": {\"type\": \"object\", \"properties\": {\"date\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"content-length\": {\"type\": \"string\"}, \"connection\": {\"type\": \"string\"}, \"x-amzn-requestid\": {\"type\": \"string\"}, \"access-control-allow-origin\": {\"type\": \"string\"}, \"access-control-allow-headers\": {\"type\": \"string\"}, \"x-amz-apigw-id\": {\"type\": \"string\"}, \"access-control-expose-headers\": {\"type\": \"string\"}, \"x-amzn-trace-id\": {\"type\": \"string\"}, \"access-control-max-age\": {\"type\": \"string\"}}, \"required\": [\"date\", \"content-type\", \"content-length\", \"connection\", \"x-amzn-requestid\", \"access-control-allow-origin\", \"access-control-allow-headers\", \"x-amz-apigw-id\", \"access-control-expose-headers\", \"x-amzn-trace-id\", \"access-control-max-age\"]}, \"RetryAttempts\": {\"type\": \"number\"}}, \"required\": [\"RequestId\", \"HTTPStatusCode\", \"HTTPHeaders\", \"RetryAttempts\"]}, \"status\": {\"type\": \"string\"}}, \"required\": [\"ResponseMetadata\", \"status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_new_location\": {\"type\": \"string\"}, \"aws_gd_bucket_owner\": {\"type\": \"string\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_new_name\": {\"type\": \"string\"}, \"aws_gd_ip_set_id\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}, \"aws_gd_new_activate\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_new_location\", \"aws_gd_bucket_owner\", \"aws_gd_region\", \"aws_gd_new_name\", \"aws_gd_ip_set_id\", \"aws_gd_detector_id\", \"aws_gd_new_activate\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"host\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "5d2e39f6-336f-403d-890f-f42a5daf56f9",
      "version": 1,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "fcee14e3-c174-4000-b165-659ececaf673",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "db760a1b-581e-48e6-9a5e-dae588e1e7eb",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "33554634-5429-42a9-93fb-78d8761bb763",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a445e475-0104-4c96-b7b0-09cbd94726ed",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "345e35cc-2eba-4f87-b7a2-62d74b4897e0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1752590699991,
      "description": {
        "content": "Updates the ThreatIntelSet specified by the ThreatIntelSet ID.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Update ThreatIntelSet",
      "export_key": "aws_guardduty_update_threatintelset",
      "id": 658,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1753462617828,
      "name": "aws_guardduty_update_threatintelset",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": 2, \"success\": \"True\", \"reason\": \"None\", \"content\": {\"ResponseMetadata\": {\"RequestId\": \"ef9c6a36-1a25-495c-b193-59a45e5764c5\", \"HTTPStatusCode\": 200, \"HTTPHeaders\": {\"date\": \"Fri, 18 Jul 2025 14:11:35 GMT\", \"content-type\": \"application/json\", \"content-length\": \"0\", \"connection\": \"***\", \"x-amzn-requestid\": \"ef9c6a36-1a25-495c-b193-59a45e5764c5\", \"access-control-allow-origin\": \"*\", \"access-control-allow-headers\": \"Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-Content-Sha256,X-Amz-User-Agent,*,Date,X-Amz-Target,x-amzn-platform-id,x-amzn-trace-id\", \"x-amz-apigw-id\": \"N6JjrHLdIAMEt8Q=\", \"access-control-expose-headers\": \"x-amzn-ErrorType,x-amzn-requestid,x-amzn-errormessage,x-amzn-trace-id,x-amz-apigw-id,Date\", \"x-amzn-trace-id\": \"Root=1-687a5617-2f62a30c63bb69fb29504207;Parent=3aba685ead709b1f;Sampled=0;Lineage=1:c7568072:0\", \"access-control-max-age\": \"86400\"}, \"RetryAttempts\": 0}, \"status\": \"ok\"}, \"raw\": \"None\", \"inputs\": {\"aws_gd_new_location\": \"None\", \"aws_gd_region\": \"us-east-1\", \"aws_gd_new_name\": \"New Test 18\", \"aws_gd_detector_id\": \"48bb********************b7ccbc82\", \"aws_gd_threat_intel_set_id\": \"4face156778d48a3a06663dd461187ce\", \"aws_gd_new_activate\": \"None\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"2.0.0\", \"host\": \"localhost\", \"execution_time_ms\": 1269, \"timestamp\": \"2025-07-18 15:11:35\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"number\"}, \"success\": {\"type\": \"string\"}, \"reason\": {\"type\": \"string\"}, \"content\": {\"type\": \"object\", \"properties\": {\"ResponseMetadata\": {\"type\": \"object\", \"properties\": {\"RequestId\": {\"type\": \"string\"}, \"HTTPStatusCode\": {\"type\": \"number\"}, \"HTTPHeaders\": {\"type\": \"object\", \"properties\": {\"date\": {\"type\": \"string\"}, \"content-type\": {\"type\": \"string\"}, \"content-length\": {\"type\": \"string\"}, \"connection\": {\"type\": \"string\"}, \"x-amzn-requestid\": {\"type\": \"string\"}, \"access-control-allow-origin\": {\"type\": \"string\"}, \"access-control-allow-headers\": {\"type\": \"string\"}, \"x-amz-apigw-id\": {\"type\": \"string\"}, \"access-control-expose-headers\": {\"type\": \"string\"}, \"x-amzn-trace-id\": {\"type\": \"string\"}, \"access-control-max-age\": {\"type\": \"string\"}}, \"required\": [\"date\", \"content-type\", \"content-length\", \"connection\", \"x-amzn-requestid\", \"access-control-allow-origin\", \"access-control-allow-headers\", \"x-amz-apigw-id\", \"access-control-expose-headers\", \"x-amzn-trace-id\", \"access-control-max-age\"]}, \"RetryAttempts\": {\"type\": \"number\"}}, \"required\": [\"RequestId\", \"HTTPStatusCode\", \"HTTPHeaders\", \"RetryAttempts\"]}, \"status\": {\"type\": \"string\"}}, \"required\": [\"ResponseMetadata\", \"status\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_new_location\": {\"type\": \"string\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_new_name\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}, \"aws_gd_threat_intel_set_id\": {\"type\": \"string\"}, \"aws_gd_new_activate\": {\"type\": \"string\"}}, \"required\": [\"aws_gd_new_location\", \"aws_gd_region\", \"aws_gd_new_name\", \"aws_gd_detector_id\", \"aws_gd_threat_intel_set_id\", \"aws_gd_new_activate\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"localhost\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"localhost\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "e8ea199c-cc4d-446b-858a-b484d46a6b04",
      "version": 6,
      "view_items": [
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "3da3fc26-feeb-4020-9d3b-70ff87b7dbb0",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "db760a1b-581e-48e6-9a5e-dae588e1e7eb",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "33554634-5429-42a9-93fb-78d8761bb763",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a445e475-0104-4c96-b7b0-09cbd94726ed",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1750424883005,
      "description": {
        "content": "Resilient Function to archive an AWS GuardDuty finding when the corresponding incident is closed.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Archive finding",
      "export_key": "func_aws_guardduty_archive_finding",
      "id": 613,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1750424883005,
      "name": "func_aws_guardduty_archive_finding",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": \"1.0\", \"success\": true, \"reason\": null, \"content\": {\"status\": \"ok\"}, \"raw\": \"{\\\"status\\\": \\\"ok\\\"}\", \"inputs\": {\"aws_gd_finding_id\": \"xxxxyyyyzzzz\", \"aws_gd_region\": \"us-east-1\", \"aws_gd_detector_id\": \"48bbf98612*******5c7a02b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"1.1.0\", \"host\": \"IBM-dummy-MacBookPro.local\", \"execution_time_ms\": 2058, \"timestamp\": \"2024-04-11 14:09:19\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-06/schema\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"status\": {\"type\": \"string\"}}}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"aws_gd_finding_id\": {\"type\": \"string\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"integer\"}, \"timestamp\": {\"type\": \"string\"}}}}}",
      "tags": [],
      "uuid": "ee7aaede-3fd1-46d5-bd05-4bd6062f67e3",
      "version": 0,
      "view_items": [
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a90b292d-a1c4-45b0-96f0-20ff45818655",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    },
    {
      "created_date": 1750424883246,
      "description": {
        "content": "Resilient Function to refresh AWS GuardDuty finding details in an incident.",
        "format": "text"
      },
      "destination_handle": "fn_aws_gd",
      "display_name": "AWS GuardDuty: Refresh Finding",
      "export_key": "func_aws_guardduty_refresh_finding",
      "id": 614,
      "last_modified_by": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755009972818,
      "name": "func_aws_guardduty_refresh_finding",
      "output_description": {
        "content": null,
        "format": "text"
      },
      "output_json_example": "{\"version\": \"1.0\", \"success\": true, \"reason\": null, \"content\": {\"timestamp\": \"2024-04-11 14:08:54\", \"finding\": {\"AccountId\": \"xxxxyyyyzzzz\", \"Arn\": \"arn:aws:guardduty:us-east-1:xxxxyyyyzzzz:detector/48bb********************b7ccbc82/finding/xxxxyyyyzzzz\", \"CreatedAt\": \"2024-04-11T05:47:16.625Z\", \"Description\": \"APIs commonly used in Discovery tactics were invoked by user IAMUser : dummy under unusual circumstances. Such activity is not typically seen from this user.\", \"Id\": \"xxxxyyyyzzzz\", \"Partition\": \"aws\", \"Region\": \"us-east-1\", \"Resource\": {\"AccessKeyDetails\": {\"AccessKeyId\": \"xxxxyyyy\", \"PrincipalId\": \"xxxxyyyy\", \"UserName\": \"dummy\", \"UserType\": \"IAMUser\"}, \"ResourceType\": \"AccessKey\"}, \"SchemaVersion\": \"2.0\", \"Service\": {\"Action\": {\"ActionType\": \"AWS_API_CALL\", \"AwsApiCallAction\": {\"Api\": \"ListFindings\", \"CallerType\": \"Remote IP\", \"RemoteIpDetails\": {\"City\": {\"CityName\": \"Singapore\"}, \"Country\": {\"CountryName\": \"Singapore\"}, \"GeoLocation\": {\"Lat\": 1.2868, \"Lon\": 103.8503}, \"IpAddressV4\": \"129.41.56.2\", \"Organization\": {\"Asn\": \"17390\", \"AsnOrg\": \"CIO-ORGANIZATION\", \"Isp\": \"IBM Corporation\", \"Org\": \"IBM Corporation\"}}, \"ServiceName\": \"guardduty.amazonaws.com\", \"AffectedResources\": {}}}, \"Archived\": false, \"Count\": 1, \"DetectorId\": \"48bb********************b7ccbc82\", \"EventFirstSeen\": \"2024-04-11T05:26:01.000Z\", \"EventLastSeen\": \"2024-04-11T05:32:48.000Z\", \"ResourceRole\": \"TARGET\", \"ServiceName\": \"guardduty\", \"AdditionalInfo\": {\"Value\": \"{\\\"userAgent\\\":{\\\"fullUserAgent\\\":\\\"Boto3/1.34.82 md/Botocore#1.34.82 ua/2.0 os/macos#23.4.0 md/arch#x86_64 lang/python#3.9.16 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.82\\\",\\\"userAgentCategory\\\":\\\"Botocore\\\"},\\\"anomalies\\\":{\\\"anomalousAPIs\\\":\\\"guardduty.amazonaws.com:[ListFindings:success , ListDetectors:success , GetFindings:success , ArchiveFindings:success] , ec2.amazonaws.com:[DescribeRegions:success]\\\"},\\\"profiledBehavior\\\":{\\\"rareProfiledAPIsAccountProfiling\\\":\\\"\\\",\\\"infrequentProfiledAPIsAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledAPIsAccountProfiling\\\":\\\"ListFindings , DescribeVolumes , GetResources , BatchGetResourceConfig , ListHostedZones , SelectResourceConfig , DescribeConfigurationRecorderStatus , ListResourceRecordSets , DescribeTrails , DescribeRegions , GetBucketLocation , DescribeDBInstances , GetAccountPublicAccessBlock , GetBucketLifecycle , GenerateCredentialReport , DescribeMetricFilters , DescribeInstances , DescribeDBClusters , GetTrailStatus , ListBuckets\\\",\\\"rareProfiledAPIsUserIdentityProfiling\\\":\\\"ListFindings , TerminateInstances , EnableAlarmActions , CreateImage , ListMembers , GetBucketPolicy , DeleteAlarms , ModifyVolume , DescribeRegions , StartInstances , CreateSnapshot , GetFindings\\\",\\\"infrequentProfiledAPIsUserIdentityProfiling\\\":\\\"DescribeInstances , AllocateAddress , ListDetectors , PutBucketPolicy , RebootInstances , CreateTags\\\",\\\"frequentProfiledAPIsUserIdentityProfiling\\\":\\\"CreateBucket , ListBuckets\\\",\\\"rareProfiledUserTypesAccountProfiling\\\":\\\"\\\",\\\"infrequentProfiledUserTypesAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledUserTypesAccountProfiling\\\":\\\"IAM_USER , ASSUMED_ROLE , ROOT\\\",\\\"rareProfiledUserNamesAccountProfiling\\\":\\\"aws:ec2-instance\\\",\\\"infrequentProfiledUserNamesAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledUserNamesAccountProfiling\\\":\\\"dummy , AWSServiceRoleForSecurityHub , AWSServiceRoleForTrustedAdvisor , CloudabilityRole , AWSServiceRoleForAccessAnalyzer , AWSServiceRoleForConfig , gtrotman , mscherfling , Root , aws-controltower-ForwardSnsNotificationRole , AWSServiceRoleForAmazonGuardDuty\\\",\\\"rareProfiledASNsAccountProfiling\\\":\\\"asnNumber: 12271 asnOrg: TWC-12271-NYC asnNumber: 23908 asnOrg: IIAC asnNumber: 6167 asnOrg: CELLCO-PART asnNumber: 701 asnOrg: UUNET asnNumber: 209 asnOrg: CENTURYLINK-US-LEGACY-QWEST\\\",\\\"infrequentProfiledASNsAccountProfiling\\\":\\\"asnNumber: 4766 asnOrg: Korea Telecom\\\",\\\"frequentProfiledASNsAccountProfiling\\\":\\\"asnNumber: 17390 asnOrg: CIO-ORGANIZATION asnNumber: 16509 asnOrg: AMAZON-02 asnNumber: 36351 asnOrg: SOFTLAYER asnNumber: 2386 asnOrg: INS-AS asnNumber: 3462 asnOrg: Data Communication Business Group asnNumber: 15502 asnOrg: Vodafone Ireland Limited asnNumber: 14618 asnOrg: AMAZON-AES asnNumber: 7018 asnOrg: ATT-INTERNET4\\\",\\\"rareProfiledASNsUserIdentityProfiling\\\":\\\"\\\",\\\"infrequentProfiledASNsUserIdentityProfiling\\\":\\\"\\\",\\\"frequentProfiledASNsUserIdentityProfiling\\\":\\\"asnNumber: 2386 asnOrg: INS-AS\\\",\\\"rareProfiledUserAgentsAccountProfiling\\\":\\\"aws-sdk-go\\\",\\\"infrequentProfiledUserAgentsAccountProfiling\\\":\\\"aws-internal/account-settings\\\",\\\"frequentProfiledUserAgentsAccountProfiling\\\":\\\"AWS Service , aws-sdk-java , Botocore , AWS Internal , browser , aws-internal/3 , OTHER\\\",\\\"rareProfiledUserAgentsUserIdentityProfiling\\\":\\\"\\\",\\\"infrequentProfiledUserAgentsUserIdentityProfiling\\\":\\\"\\\",\\\"frequentProfiledUserAgentsUserIdentityProfiling\\\":\\\"Botocore\\\"},\\\"unusualBehavior\\\":{\\\"unusualAPIsAccountProfiling\\\":\\\"ArchiveFindings\\\",\\\"unusualUserTypesAccountProfiling\\\":\\\"\\\",\\\"unusualUserNamesAccountProfiling\\\":\\\"\\\",\\\"unusualASNsAccountProfiling\\\":\\\"\\\",\\\"unusualUserAgentsAccountProfiling\\\":\\\"\\\",\\\"unusualAPIsUserIdentityProfiling\\\":\\\"ArchiveFindings\\\",\\\"unusualASNsUserIdentityProfiling\\\":\\\"asnNumber: 17390 asnOrg: CIO-ORGANIZATION\\\",\\\"unusualUserAgentsUserIdentityProfiling\\\":\\\"\\\",\\\"isUnusualUserIdentity\\\":\\\"false\\\"}}\", \"Type\": \"default\"}}, \"Severity\": 2, \"Title\": \"The user IAMUser : dummy is anomalously invoking APIs commonly used in Discovery tactics.\", \"Type\": \"Discovery:IAMUser/AnomalousBehavior\", \"UpdatedAt\": \"2024-04-11T05:47:16.625Z\"}, \"region\": \"us-east-1\", \"payload\": {\"name\": \"AWS GuardDuty: The user IAMUser : dummy is anomalously invoking APIs commonly used in Discovery tactics.\", \"description\": {\"format\": \"text\", \"content\": \"APIs commonly used in Discovery tactics were invoked by user IAMUser : dummy under unusual circumstances. Such activity is not typically seen from this user.\"}, \"discovered_date\": \"2024-04-11T05:47:16.625Z\", \"severity_code\": \"Low\", \"properties\": {\"aws_guardduty_finding_id\": \"xxxxyyyyzzzz\", \"aws_guardduty_finding_arn\": \"arn:aws:guardduty:us-east-1:xxxxyyyyzzzz:detector/48bb********************b7ccbc82/finding/xxxxyyyyzzzz\", \"aws_guardduty_finding_type\": \"Discovery:IAMUser/AnomalousBehavior\", \"aws_guardduty_finding_updated_at\": \"2024-04-11T05:47:16.625Z\", \"aws_guardduty_region\": \"us-east-1\", \"aws_guardduty_severity\": \"2\", \"aws_guardduty_resource_type\": \"AccessKey\", \"aws_guardduty_detector_id\": \"48bb********************b7ccbc82\", \"aws_guardduty_count\": \"1\", \"aws_guardduty_archived\": \"False\"}, \"artifacts\": [], \"comments\": []}, \"data_tables\": {\"gd_finding_overview\": [{\"cells\": {\"severity\": {\"value\": \"2\"}, \"query_execution_date\": {\"value\": \"2024-04-11 14:08:54\"}, \"region\": {\"value\": \"us-east-1\"}, \"count\": {\"value\": \"1\"}, \"account_id\": {\"value\": \"111111111111\"}, \"created_at\": {\"value\": \"2024-04-11T05:47:16.625Z\"}, \"updated_at\": {\"value\": \"2024-04-11T05:47:16.625Z\"}}}], \"gd_action_details\": [{\"cells\": {\"action_type\": {\"value\": \"AWS_API_CALL\"}, \"query_execution_date\": {\"value\": \"2024-04-11 14:08:54\"}, \"action_api\": {\"value\": \"ListFindings\"}, \"event_first_seen\": {\"value\": \"2024-04-11T05:26:01.000Z\"}, \"event_last_seen\": {\"value\": \"2024-04-11T05:32:48.000Z\"}, \"actor_caller_type\": {\"value\": \"Remote IP\"}, \"city_name\": {\"value\": \"Singapore\"}, \"country_name\": {\"value\": \"Singapore\"}, \"asn\": {\"value\": \"17390\"}, \"asn_org\": {\"value\": \"CIO-ORGANIZATION\"}, \"isp\": {\"value\": \"IBM Corporation\"}, \"org\": {\"value\": \"IBM Corporation\"}, \"service_name\": {\"value\": \"guardduty.amazonaws.com\"}, \"remote_ip\": {\"value\": \"129.41.56.2\"}}}], \"gd_resource_affected\": [{\"cells\": {\"resource_type\": {\"value\": \"AccessKey\"}, \"query_execution_date\": {\"value\": \"2024-04-11 14:08:54\"}, \"resource_role\": {\"value\": \"TARGET\"}}}], \"gd_s3_bucket_details\": [], \"gd_instance_details\": [], \"gd_access_key_details\": [{\"cells\": {\"access_key_id\": {\"value\": \"xxxxyyyy\"}, \"query_execution_date\": {\"value\": \"2024-04-11 14:08:54\"}, \"principal_id\": {\"value\": \"xxxxyyyy\"}, \"user_type\": {\"value\": \"IAMUser\"}, \"user_name\": {\"value\": \"dummy\"}}}]}}, \"raw\": \"{\\\"timestamp\\\": \\\"2024-04-11 14:08:54\\\", \\\"finding\\\": {\\\"AccountId\\\": \\\"xxxxyyyyzzzz\\\", \\\"Arn\\\": \\\"arn:aws:guardduty:us-east-1:xxxxyyyyzzzz:detector/48bb********************b7ccbc82/finding/xxxxyyyyzzzz\\\", \\\"CreatedAt\\\": \\\"2024-04-11T05:47:16.625Z\\\", \\\"Description\\\": \\\"APIs commonly used in Discovery tactics were invoked by user IAMUser : dummy under unusual circumstances. Such activity is not typically seen from this user.\\\", \\\"Id\\\": \\\"xxxxyyyyzzzz\\\", \\\"Partition\\\": \\\"aws\\\", \\\"Region\\\": \\\"us-east-1\\\", \\\"Resource\\\": {\\\"AccessKeyDetails\\\": {\\\"AccessKeyId\\\": \\\"xxxxyyyy\\\", \\\"PrincipalId\\\": \\\"xxxxyyyy\\\", \\\"UserName\\\": \\\"dummy\\\", \\\"UserType\\\": \\\"IAMUser\\\"}, \\\"ResourceType\\\": \\\"AccessKey\\\"}, \\\"SchemaVersion\\\": \\\"2.0\\\", \\\"Service\\\": {\\\"Action\\\": {\\\"ActionType\\\": \\\"AWS_API_CALL\\\", \\\"AwsApiCallAction\\\": {\\\"Api\\\": \\\"ListFindings\\\", \\\"CallerType\\\": \\\"Remote IP\\\", \\\"RemoteIpDetails\\\": {\\\"City\\\": {\\\"CityName\\\": \\\"Singapore\\\"}, \\\"Country\\\": {\\\"CountryName\\\": \\\"Singapore\\\"}, \\\"GeoLocation\\\": {\\\"Lat\\\": 1.2868, \\\"Lon\\\": 103.8503}, \\\"IpAddressV4\\\": \\\"129.41.56.2\\\", \\\"Organization\\\": {\\\"Asn\\\": \\\"17390\\\", \\\"AsnOrg\\\": \\\"CIO-ORGANIZATION\\\", \\\"Isp\\\": \\\"IBM Corporation\\\", \\\"Org\\\": \\\"IBM Corporation\\\"}}, \\\"ServiceName\\\": \\\"guardduty.amazonaws.com\\\", \\\"AffectedResources\\\": {}}}, \\\"Archived\\\": false, \\\"Count\\\": 1, \\\"DetectorId\\\": \\\"48bb********************b7ccbc82\\\", \\\"EventFirstSeen\\\": \\\"2024-04-11T05:26:01.000Z\\\", \\\"EventLastSeen\\\": \\\"2024-04-11T05:32:48.000Z\\\", \\\"ResourceRole\\\": \\\"TARGET\\\", \\\"ServiceName\\\": \\\"guardduty\\\", \\\"AdditionalInfo\\\": {\\\"Value\\\": \\\"{\\\\\\\"userAgent\\\\\\\":{\\\\\\\"fullUserAgent\\\\\\\":\\\\\\\"Boto3/1.34.82 md/Botocore#1.34.82 ua/2.0 os/macos#23.4.0 md/arch#x86_64 lang/python#3.9.16 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.82\\\\\\\",\\\\\\\"userAgentCategory\\\\\\\":\\\\\\\"Botocore\\\\\\\"},\\\\\\\"anomalies\\\\\\\":{\\\\\\\"anomalousAPIs\\\\\\\":\\\\\\\"guardduty.amazonaws.com:[ListFindings:success , ListDetectors:success , GetFindings:success , ArchiveFindings:success] , ec2.amazonaws.com:[DescribeRegions:success]\\\\\\\"},\\\\\\\"profiledBehavior\\\\\\\":{\\\\\\\"rareProfiledAPIsAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"infrequentProfiledAPIsAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"frequentProfiledAPIsAccountProfiling\\\\\\\":\\\\\\\"ListFindings , DescribeVolumes , GetResources , BatchGetResourceConfig , ListHostedZones , SelectResourceConfig , DescribeConfigurationRecorderStatus , ListResourceRecordSets , DescribeTrails , DescribeRegions , GetBucketLocation , DescribeDBInstances , GetAccountPublicAccessBlock , GetBucketLifecycle , GenerateCredentialReport , DescribeMetricFilters , DescribeInstances , DescribeDBClusters , GetTrailStatus , ListBuckets\\\\\\\",\\\\\\\"rareProfiledAPIsUserIdentityProfiling\\\\\\\":\\\\\\\"ListFindings , TerminateInstances , EnableAlarmActions , CreateImage , ListMembers , GetBucketPolicy , DeleteAlarms , ModifyVolume , DescribeRegions , StartInstances , CreateSnapshot , GetFindings\\\\\\\",\\\\\\\"infrequentProfiledAPIsUserIdentityProfiling\\\\\\\":\\\\\\\"DescribeInstances , AllocateAddress , ListDetectors , PutBucketPolicy , RebootInstances , CreateTags\\\\\\\",\\\\\\\"frequentProfiledAPIsUserIdentityProfiling\\\\\\\":\\\\\\\"CreateBucket , ListBuckets\\\\\\\",\\\\\\\"rareProfiledUserTypesAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"infrequentProfiledUserTypesAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"frequentProfiledUserTypesAccountProfiling\\\\\\\":\\\\\\\"IAM_USER , ASSUMED_ROLE , ROOT\\\\\\\",\\\\\\\"rareProfiledUserNamesAccountProfiling\\\\\\\":\\\\\\\"aws:ec2-instance\\\\\\\",\\\\\\\"infrequentProfiledUserNamesAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"frequentProfiledUserNamesAccountProfiling\\\\\\\":\\\\\\\"dummy , AWSServiceRoleForSecurityHub , AWSServiceRoleForTrustedAdvisor , CloudabilityRole , AWSServiceRoleForAccessAnalyzer , AWSServiceRoleForConfig , gtrotman , mscherfling , Root , aws-controltower-ForwardSnsNotificationRole , AWSServiceRoleForAmazonGuardDuty\\\\\\\",\\\\\\\"rareProfiledASNsAccountProfiling\\\\\\\":\\\\\\\"asnNumber: 12271 asnOrg: TWC-12271-NYC asnNumber: 23908 asnOrg: IIAC asnNumber: 6167 asnOrg: CELLCO-PART asnNumber: 701 asnOrg: UUNET asnNumber: 209 asnOrg: CENTURYLINK-US-LEGACY-QWEST\\\\\\\",\\\\\\\"infrequentProfiledASNsAccountProfiling\\\\\\\":\\\\\\\"asnNumber: 4766 asnOrg: Korea Telecom\\\\\\\",\\\\\\\"frequentProfiledASNsAccountProfiling\\\\\\\":\\\\\\\"asnNumber: 17390 asnOrg: CIO-ORGANIZATION asnNumber: 16509 asnOrg: AMAZON-02 asnNumber: 36351 asnOrg: SOFTLAYER asnNumber: 2386 asnOrg: INS-AS asnNumber: 3462 asnOrg: Data Communication Business Group asnNumber: 15502 asnOrg: Vodafone Ireland Limited asnNumber: 14618 asnOrg: AMAZON-AES asnNumber: 7018 asnOrg: ATT-INTERNET4\\\\\\\",\\\\\\\"rareProfiledASNsUserIdentityProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"infrequentProfiledASNsUserIdentityProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"frequentProfiledASNsUserIdentityProfiling\\\\\\\":\\\\\\\"asnNumber: 2386 asnOrg: INS-AS\\\\\\\",\\\\\\\"rareProfiledUserAgentsAccountProfiling\\\\\\\":\\\\\\\"aws-sdk-go\\\\\\\",\\\\\\\"infrequentProfiledUserAgentsAccountProfiling\\\\\\\":\\\\\\\"aws-internal/account-settings\\\\\\\",\\\\\\\"frequentProfiledUserAgentsAccountProfiling\\\\\\\":\\\\\\\"AWS Service , aws-sdk-java , Botocore , AWS Internal , browser , aws-internal/3 , OTHER\\\\\\\",\\\\\\\"rareProfiledUserAgentsUserIdentityProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"infrequentProfiledUserAgentsUserIdentityProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"frequentProfiledUserAgentsUserIdentityProfiling\\\\\\\":\\\\\\\"Botocore\\\\\\\"},\\\\\\\"unusualBehavior\\\\\\\":{\\\\\\\"unusualAPIsAccountProfiling\\\\\\\":\\\\\\\"ArchiveFindings\\\\\\\",\\\\\\\"unusualUserTypesAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"unusualUserNamesAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"unusualASNsAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"unusualUserAgentsAccountProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"unusualAPIsUserIdentityProfiling\\\\\\\":\\\\\\\"ArchiveFindings\\\\\\\",\\\\\\\"unusualASNsUserIdentityProfiling\\\\\\\":\\\\\\\"asnNumber: 17390 asnOrg: CIO-ORGANIZATION\\\\\\\",\\\\\\\"unusualUserAgentsUserIdentityProfiling\\\\\\\":\\\\\\\"\\\\\\\",\\\\\\\"isUnusualUserIdentity\\\\\\\":\\\\\\\"false\\\\\\\"}}\\\", \\\"Type\\\": \\\"default\\\"}}, \\\"Severity\\\": 2, \\\"Title\\\": \\\"The user IAMUser : dummy is anomalously invoking APIs commonly used in Discovery tactics.\\\", \\\"Type\\\": \\\"Discovery:IAMUser/AnomalousBehavior\\\", \\\"UpdatedAt\\\": \\\"2024-04-11T05:47:16.625Z\\\"}, \\\"region\\\": \\\"us-east-1\\\", \\\"payload\\\": {\\\"name\\\": \\\"AWS GuardDuty: The user IAMUser : dummy is anomalously invoking APIs commonly used in Discovery tactics.\\\", \\\"description\\\": {\\\"format\\\": \\\"text\\\", \\\"content\\\": \\\"APIs commonly used in Discovery tactics were invoked by user IAMUser : dummy under unusual circumstances. Such activity is not typically seen from this user.\\\"}, \\\"discovered_date\\\": \\\"2024-04-11T05:47:16.625Z\\\", \\\"severity_code\\\": \\\"Low\\\", \\\"properties\\\": {\\\"aws_guardduty_finding_id\\\": \\\"xxxxyyyyzzzz\\\", \\\"aws_guardduty_finding_arn\\\": \\\"arn:aws:guardduty:us-east-1:xxxxyyyyzzzz:detector/48bb********************b7ccbc82/finding/xxxxyyyyzzzz\\\", \\\"aws_guardduty_finding_type\\\": \\\"Discovery:IAMUser/AnomalousBehavior\\\", \\\"aws_guardduty_finding_updated_at\\\": \\\"2024-04-11T05:47:16.625Z\\\", \\\"aws_guardduty_region\\\": \\\"us-east-1\\\", \\\"aws_guardduty_severity\\\": \\\"2\\\", \\\"aws_guardduty_resource_type\\\": \\\"AccessKey\\\", \\\"aws_guardduty_detector_id\\\": \\\"48bb********************b7ccbc82\\\", \\\"aws_guardduty_count\\\": \\\"1\\\", \\\"aws_guardduty_archived\\\": \\\"False\\\"}, \\\"artifacts\\\": [], \\\"comments\\\": []}, \\\"data_tables\\\": {\\\"gd_finding_overview\\\": [{\\\"cells\\\": {\\\"severity\\\": {\\\"value\\\": \\\"2\\\"}, \\\"query_execution_date\\\": {\\\"value\\\": \\\"2024-04-11 14:08:54\\\"}, \\\"region\\\": {\\\"value\\\": \\\"us-east-1\\\"}, \\\"count\\\": {\\\"value\\\": \\\"1\\\"}, \\\"account_id\\\": {\\\"value\\\": \\\"xxxxyyyyzzzz\\\"}, \\\"created_at\\\": {\\\"value\\\": \\\"2024-04-11T05:47:16.625Z\\\"}, \\\"updated_at\\\": {\\\"value\\\": \\\"2024-04-11T05:47:16.625Z\\\"}}}], \\\"gd_action_details\\\": [{\\\"cells\\\": {\\\"action_type\\\": {\\\"value\\\": \\\"AWS_API_CALL\\\"}, \\\"query_execution_date\\\": {\\\"value\\\": \\\"2024-04-11 14:08:54\\\"}, \\\"action_api\\\": {\\\"value\\\": \\\"ListFindings\\\"}, \\\"event_first_seen\\\": {\\\"value\\\": \\\"2024-04-11T05:26:01.000Z\\\"}, \\\"event_last_seen\\\": {\\\"value\\\": \\\"2024-04-11T05:32:48.000Z\\\"}, \\\"actor_caller_type\\\": {\\\"value\\\": \\\"Remote IP\\\"}, \\\"city_name\\\": {\\\"value\\\": \\\"Singapore\\\"}, \\\"country_name\\\": {\\\"value\\\": \\\"Singapore\\\"}, \\\"asn\\\": {\\\"value\\\": \\\"17390\\\"}, \\\"asn_org\\\": {\\\"value\\\": \\\"CIO-ORGANIZATION\\\"}, \\\"isp\\\": {\\\"value\\\": \\\"IBM Corporation\\\"}, \\\"org\\\": {\\\"value\\\": \\\"IBM Corporation\\\"}, \\\"service_name\\\": {\\\"value\\\": \\\"guardduty.amazonaws.com\\\"}, \\\"remote_ip\\\": {\\\"value\\\": \\\"129.41.56.2\\\"}}}], \\\"gd_resource_affected\\\": [{\\\"cells\\\": {\\\"resource_type\\\": {\\\"value\\\": \\\"AccessKey\\\"}, \\\"query_execution_date\\\": {\\\"value\\\": \\\"2024-04-11 14:08:54\\\"}, \\\"resource_role\\\": {\\\"value\\\": \\\"TARGET\\\"}}}], \\\"gd_s3_bucket_details\\\": [], \\\"gd_instance_details\\\": [], \\\"gd_access_key_details\\\": [{\\\"cells\\\": {\\\"access_key_id\\\": {\\\"value\\\": \\\"xxxxyyyy\\\"}, \\\"query_execution_date\\\": {\\\"value\\\": \\\"2024-04-11 14:08:54\\\"}, \\\"principal_id\\\": {\\\"value\\\": \\\"xxxxyyyy\\\"}, \\\"user_type\\\": {\\\"value\\\": \\\"IAMUser\\\"}, \\\"user_name\\\": {\\\"value\\\": \\\"dummy\\\"}}}]}}\", \"inputs\": {\"incident_id\": 2114, \"aws_gd_finding_id\": \"xxxxyyyyzzzz\", \"aws_gd_region\": \"us-east-1\", \"aws_gd_detector_id\": \"48bbf9861*******215c7a02b7ccbc82\"}, \"metrics\": {\"version\": \"1.0\", \"package\": \"fn-aws-guardduty\", \"package_version\": \"1.1.0\", \"host\": \"IBM-dummy-MacBookPro.local\", \"execution_time_ms\": 1530, \"timestamp\": \"2024-04-11 14:08:54\"}}",
      "output_json_schema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"title\": \"Generated schema for Root\", \"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"success\": {\"type\": \"boolean\"}, \"reason\": {}, \"content\": {\"type\": \"object\", \"properties\": {\"timestamp\": {\"type\": \"string\"}, \"finding\": {\"type\": \"object\", \"properties\": {\"AccountId\": {\"type\": \"string\"}, \"Arn\": {\"type\": \"string\"}, \"CreatedAt\": {\"type\": \"string\"}, \"Description\": {\"type\": \"string\"}, \"Id\": {\"type\": \"string\"}, \"Partition\": {\"type\": \"string\"}, \"Region\": {\"type\": \"string\"}, \"Resource\": {\"type\": \"object\", \"properties\": {\"AccessKeyDetails\": {\"type\": \"object\", \"properties\": {\"AccessKeyId\": {\"type\": \"string\"}, \"PrincipalId\": {\"type\": \"string\"}, \"UserName\": {\"type\": \"string\"}, \"UserType\": {\"type\": \"string\"}}, \"required\": [\"AccessKeyId\", \"PrincipalId\", \"UserName\", \"UserType\"]}, \"ResourceType\": {\"type\": \"string\"}}, \"required\": [\"AccessKeyDetails\", \"ResourceType\"]}, \"SchemaVersion\": {\"type\": \"string\"}, \"Service\": {\"type\": \"object\", \"properties\": {\"Action\": {\"type\": \"object\", \"properties\": {\"ActionType\": {\"type\": \"string\"}, \"AwsApiCallAction\": {\"type\": \"object\", \"properties\": {\"Api\": {\"type\": \"string\"}, \"CallerType\": {\"type\": \"string\"}, \"RemoteIpDetails\": {\"type\": \"object\", \"properties\": {\"City\": {\"type\": \"object\", \"properties\": {\"CityName\": {\"type\": \"string\"}}, \"required\": [\"CityName\"]}, \"Country\": {\"type\": \"object\", \"properties\": {\"CountryName\": {\"type\": \"string\"}}, \"required\": [\"CountryName\"]}, \"GeoLocation\": {\"type\": \"object\", \"properties\": {\"Lat\": {\"type\": \"number\"}, \"Lon\": {\"type\": \"number\"}}, \"required\": [\"Lat\", \"Lon\"]}, \"IpAddressV4\": {\"type\": \"string\"}, \"Organization\": {\"type\": \"object\", \"properties\": {\"Asn\": {\"type\": \"string\"}, \"AsnOrg\": {\"type\": \"string\"}, \"Isp\": {\"type\": \"string\"}, \"Org\": {\"type\": \"string\"}}, \"required\": [\"Asn\", \"AsnOrg\", \"Isp\", \"Org\"]}}, \"required\": [\"City\", \"Country\", \"GeoLocation\", \"IpAddressV4\", \"Organization\"]}, \"ServiceName\": {\"type\": \"string\"}, \"AffectedResources\": {\"type\": \"object\", \"properties\": {}, \"required\": []}}, \"required\": [\"Api\", \"CallerType\", \"RemoteIpDetails\", \"ServiceName\", \"AffectedResources\"]}}, \"required\": [\"ActionType\", \"AwsApiCallAction\"]}, \"Archived\": {\"type\": \"boolean\"}, \"Count\": {\"type\": \"number\"}, \"DetectorId\": {\"type\": \"string\"}, \"EventFirstSeen\": {\"type\": \"string\"}, \"EventLastSeen\": {\"type\": \"string\"}, \"ResourceRole\": {\"type\": \"string\"}, \"ServiceName\": {\"type\": \"string\"}, \"AdditionalInfo\": {\"type\": \"object\", \"properties\": {\"Value\": {\"type\": \"string\"}, \"Type\": {\"type\": \"string\"}}, \"required\": [\"Value\", \"Type\"]}}, \"required\": [\"Action\", \"Archived\", \"Count\", \"DetectorId\", \"EventFirstSeen\", \"EventLastSeen\", \"ResourceRole\", \"ServiceName\", \"AdditionalInfo\"]}, \"Severity\": {\"type\": \"number\"}, \"Title\": {\"type\": \"string\"}, \"Type\": {\"type\": \"string\"}, \"UpdatedAt\": {\"type\": \"string\"}}, \"required\": [\"AccountId\", \"Arn\", \"CreatedAt\", \"Description\", \"Id\", \"Partition\", \"Region\", \"Resource\", \"SchemaVersion\", \"Service\", \"Severity\", \"Title\", \"Type\", \"UpdatedAt\"]}, \"region\": {\"type\": \"string\"}, \"payload\": {\"type\": \"object\", \"properties\": {\"name\": {\"type\": \"string\"}, \"description\": {\"type\": \"object\", \"properties\": {\"format\": {\"type\": \"string\"}, \"content\": {\"type\": \"string\"}}, \"required\": [\"format\", \"content\"]}, \"discovered_date\": {\"type\": \"string\"}, \"severity_code\": {\"type\": \"string\"}, \"properties\": {\"type\": \"object\", \"properties\": {\"aws_guardduty_finding_id\": {\"type\": \"string\"}, \"aws_guardduty_finding_arn\": {\"type\": \"string\"}, \"aws_guardduty_finding_type\": {\"type\": \"string\"}, \"aws_guardduty_finding_updated_at\": {\"type\": \"string\"}, \"aws_guardduty_region\": {\"type\": \"string\"}, \"aws_guardduty_severity\": {\"type\": \"string\"}, \"aws_guardduty_resource_type\": {\"type\": \"string\"}, \"aws_guardduty_detector_id\": {\"type\": \"string\"}, \"aws_guardduty_count\": {\"type\": \"string\"}, \"aws_guardduty_archived\": {\"type\": \"string\"}}, \"required\": [\"aws_guardduty_finding_id\", \"aws_guardduty_finding_arn\", \"aws_guardduty_finding_type\", \"aws_guardduty_finding_updated_at\", \"aws_guardduty_region\", \"aws_guardduty_severity\", \"aws_guardduty_resource_type\", \"aws_guardduty_detector_id\", \"aws_guardduty_count\", \"aws_guardduty_archived\"]}, \"artifacts\": {\"type\": \"array\", \"items\": {}}, \"comments\": {\"type\": \"array\", \"items\": {}}}, \"required\": [\"name\", \"description\", \"discovered_date\", \"severity_code\", \"properties\", \"artifacts\", \"comments\"]}, \"data_tables\": {\"type\": \"object\", \"properties\": {\"gd_finding_overview\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"cells\": {\"type\": \"object\", \"properties\": {\"severity\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"query_execution_date\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"region\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"count\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"account_id\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"created_at\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"updated_at\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}}, \"required\": [\"severity\", \"query_execution_date\", \"region\", \"count\", \"account_id\", \"created_at\", \"updated_at\"]}}, \"required\": [\"cells\"]}}, \"gd_action_details\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"cells\": {\"type\": \"object\", \"properties\": {\"action_type\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"query_execution_date\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"action_api\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"event_first_seen\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"event_last_seen\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"actor_caller_type\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"city_name\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"country_name\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"asn\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"asn_org\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"isp\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"org\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"service_name\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"remote_ip\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}}, \"required\": [\"action_type\", \"query_execution_date\", \"action_api\", \"event_first_seen\", \"event_last_seen\", \"actor_caller_type\", \"city_name\", \"country_name\", \"asn\", \"asn_org\", \"isp\", \"org\", \"service_name\", \"remote_ip\"]}}, \"required\": [\"cells\"]}}, \"gd_resource_affected\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"cells\": {\"type\": \"object\", \"properties\": {\"resource_type\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"query_execution_date\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"resource_role\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}}, \"required\": [\"resource_type\", \"query_execution_date\", \"resource_role\"]}}, \"required\": [\"cells\"]}}, \"gd_s3_bucket_details\": {\"type\": \"array\", \"items\": {}}, \"gd_instance_details\": {\"type\": \"array\", \"items\": {}}, \"gd_access_key_details\": {\"type\": \"array\", \"items\": {\"type\": \"object\", \"properties\": {\"cells\": {\"type\": \"object\", \"properties\": {\"access_key_id\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"query_execution_date\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"principal_id\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"user_type\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}, \"user_name\": {\"type\": \"object\", \"properties\": {\"value\": {\"type\": \"string\"}}, \"required\": [\"value\"]}}, \"required\": [\"access_key_id\", \"query_execution_date\", \"principal_id\", \"user_type\", \"user_name\"]}}, \"required\": [\"cells\"]}}}, \"required\": [\"gd_finding_overview\", \"gd_action_details\", \"gd_resource_affected\", \"gd_s3_bucket_details\", \"gd_instance_details\", \"gd_access_key_details\"]}}, \"required\": [\"timestamp\", \"finding\", \"region\", \"payload\", \"data_tables\"]}, \"raw\": {\"type\": \"string\"}, \"inputs\": {\"type\": \"object\", \"properties\": {\"incident_id\": {\"type\": \"number\"}, \"aws_gd_finding_id\": {\"type\": \"string\"}, \"aws_gd_region\": {\"type\": \"string\"}, \"aws_gd_detector_id\": {\"type\": \"string\"}}, \"required\": [\"incident_id\", \"aws_gd_finding_id\", \"aws_gd_region\", \"aws_gd_detector_id\"]}, \"metrics\": {\"type\": \"object\", \"properties\": {\"version\": {\"type\": \"string\"}, \"package\": {\"type\": \"string\"}, \"package_version\": {\"type\": \"string\"}, \"host\": {\"type\": \"string\"}, \"execution_time_ms\": {\"type\": \"number\"}, \"timestamp\": {\"type\": \"string\"}}, \"required\": [\"version\", \"package\", \"package_version\", \"host\", \"execution_time_ms\", \"timestamp\"]}}, \"required\": [\"version\", \"success\", \"reason\", \"content\", \"raw\", \"inputs\", \"metrics\"]}",
      "tags": [],
      "uuid": "2d1446f8-13fc-4400-af6a-c96b55d9a0df",
      "version": 3,
      "view_items": [
        {
          "content": "9af24b4c-9409-43ec-8c72-ea86f04fbc25",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "9fa35803-ee7e-42cd-bb0b-d1dcefdbd341",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "a90b292d-a1c4-45b0-96f0-20ff45818655",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        },
        {
          "content": "5eaaeb87-cb70-4877-aa5e-0a5b10f73f3a",
          "element": "field_uuid",
          "field_type": "__function",
          "show_if": null,
          "show_link_header": false,
          "step_label": null
        }
      ],
      "workflows": []
    }
  ],
  "geos": null,
  "groups": null,
  "id": 312,
  "inbound_destinations": [],
  "inbound_mailboxes": null,
  "incident_artifact_types": [
    {
      "default_scan_option": "unsupported",
      "desc": "Amazon Web Services (AWS) IAM access key id.",
      "enabled": true,
      "export_key": "aws_iam_access_key_id",
      "file": false,
      "id": 0,
      "multi_aware": false,
      "name": "AWS IAM Access Key ID",
      "parse_as_csv": false,
      "programmatic_name": "aws_iam_access_key_id",
      "reg_exp": null,
      "system": false,
      "tags": [],
      "use_for_relationships": true,
      "uuid": "a33a1971-162c-4417-b344-8708f9d25644",
      "version": 0
    },
    {
      "default_scan_option": "unsupported",
      "desc": "Amazon Web Services (AWS) IAM user name.",
      "enabled": true,
      "export_key": "aws_iam_user_name",
      "file": false,
      "id": 0,
      "multi_aware": false,
      "name": "AWS IAM User Name",
      "parse_as_csv": false,
      "programmatic_name": "aws_iam_user_name",
      "reg_exp": null,
      "system": false,
      "tags": [],
      "use_for_relationships": true,
      "uuid": "3a0a5309-ba33-47cb-92df-c8a506f87317",
      "version": 0
    },
    {
      "default_scan_option": "unsupported",
      "desc": "Amazon Web Services (AWS) S3 bucket name.",
      "enabled": true,
      "export_key": "aws_s3_bucket_name",
      "file": false,
      "id": 0,
      "multi_aware": false,
      "name": "AWS S3 Bucket Name",
      "parse_as_csv": false,
      "programmatic_name": "aws_s3_bucket_name",
      "reg_exp": null,
      "system": false,
      "tags": [],
      "use_for_relationships": true,
      "uuid": "b98bbc83-39be-4379-aa1e-2a38b7053560",
      "version": 0
    }
  ],
  "incident_types": [
    {
      "create_date": 1755602629849,
      "description": "Customization Packages (internal)",
      "enabled": false,
      "export_key": "Customization Packages (internal)",
      "hidden": false,
      "id": 0,
      "name": "Customization Packages (internal)",
      "parent_id": null,
      "system": false,
      "update_date": 1755602629849,
      "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0"
    }
  ],
  "layouts": [],
  "locale": null,
  "message_destinations": [
    {
      "api_keys": [
        "9208db2b-3895-4537-a4d4-bb866ca9d0fb"
      ],
      "destination_type": 0,
      "expect_ack": true,
      "export_key": "fn_aws_gd",
      "name": "fn_aws_gd",
      "programmatic_name": "fn_aws_gd",
      "tags": [],
      "users": [
        "shresh@example.com"
      ],
      "uuid": "982c1bc0-69a7-4dc6-bee7-508470d51ee5"
    }
  ],
  "notifications": null,
  "overrides": null,
  "phases": [],
  "playbooks": [
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.plan_status",
              "method": "changed_to",
              "type": null,
              "value": "Closed"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_archived",
              "method": "not_equals",
              "type": null,
              "value": "True"
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_finding_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b\" isExecutable=\"true\" name=\"playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_15uoz7n\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Archive finding\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"ee7aaede-3fd1-46d5-bd05-4bd6062f67e3\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_finding_id = incident.properties.aws_guardduty_finding_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_15uoz7n\u003c/incoming\u003e\u003coutgoing\u003eFlow_1lejp4v\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_15uoz7n\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Archive Finding Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"021b041b-85f9-4682-a99e-30b6b8756f48\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1lejp4v\u003c/incoming\u003e\u003coutgoing\u003eFlow_00l1m6l\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_00l1m6l\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1lejp4v\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003csequenceFlow id=\"Flow_00l1m6l\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_00l1m6l\" id=\"Flow_00l1m6l_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"382\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"414\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1lejp4v\" id=\"Flow_1lejp4v_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"298\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15uoz7n\" id=\"Flow_15uoz7n_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"298\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2109\" x=\"656\" y=\"414\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1750424884428,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b",
      "description": {
        "content": "A SOAR playbook to archive an AWS GuardDuty finding when the corresponding incident is closed.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Archive Finding (PB)",
      "export_key": "example_aws_guardduty_archive_finding_pb",
      "field_type_handle": "playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Archive Finding (PB)",
        "export_key": "playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b",
        "uuid": "d71d232a-55eb-4158-aa12-acb39d848f6f"
      },
      "has_logical_errors": false,
      "id": 385,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602377660,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1750424884740,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Archive Finding Post Script",
          "id": 388,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1750424884740,
          "name": "AWS GuardDuty: Archive Finding Post Script",
          "object_type": "incident",
          "playbook_handle": "example_aws_guardduty_archive_finding_pb",
          "programmatic_name": "example_aws_guardduty_archive_finding_pb_aws_guardduty_archive_finding_post_script",
          "script_text": "##  wf_aws_guardduty_refresh_finding ##\n# Example result:\n\"\"\"\nGood\n====\nResult: {\u0027version\u0027: \u00271.0\u0027, \u0027success\u0027: True, \u0027reason\u0027: None,\n         \u0027content\u0027: {\u0027status\u0027: \u0027ok\u0027},\n         \u0027raw\u0027: \u0027{\"status\": \"ok\"}\u0027,\n         \u0027inputs\u0027: {\u0027aws_gd_finding_id\u0027: \u0027c2bb95a17b879bffc96c58f8a1689785\u0027, \u0027aws_gd_region\u0027: \u0027us-east-2\u0027,\n                    \u0027aws_gd_detector_id\u0027: \u002732b7017d2019dfe922abc4e07c3fdded\u0027\n                    },\n         \u0027metrics\u0027: {\u0027version\u0027: \u00271.0\u0027, \u0027package\u0027: \u0027fn-aws-guardduty\u0027, \u0027package_version\u0027: \u00271.0.0\u0027,\n         \u0027host\u0027: \u0027myhost.ibm.com\u0027, \u0027execution_time_ms\u0027: 1310, \u0027timestamp\u0027: \u00272021-01-28 11:31:30\u0027\n        }\n}\nError:\nResult: {\u0027version\u0027: \u00271.0\u0027, \u0027success\u0027: True, \u0027reason\u0027: None,\n         \u0027content\u0027: {\u0027status\u0027: \u0027error\u0027,\n                     \u0027msg\u0027: \u0027An error occurred (BadRequestException) when calling the ArchiveFindings operation:\n                     The request is rejected because the input detectorId is not owned by the current account.\u0027},\n                     \u0027raw\u0027: \u0027\u003ccontent_as_string\u003e\u0027,\n         \u0027inputs\u0027: {\u0027aws_gd_finding_id\u0027: \u0027c2bb95a17b879bffc96c58f8a1689784\u0027, \u0027aws_gd_region\u0027: \u0027us-east-2\u0027,\n                    \u0027aws_gd_detector_id\u0027: \u002732b7017d2019dfe922abc4e07c3fdfff\u0027\n                    },\n         \u0027metrics\u0027: {\u0027version\u0027: \u00271.0\u0027, \u0027package\u0027: \u0027fn-aws-guardduty\u0027, \u0027package_version\u0027: \u00271.0.0\u0027,\n         \u0027host\u0027: \u0027myhost.ibm.com\u0027, \u0027execution_time_ms\u0027: 1446, \u0027timestamp\u0027: \u00272021-01-28 11:34:53\u0027\n         }\n}\n\"\"\"\n#  Globals\nFN_NAME = \"func_aws_guardduty_archive_finding\"\nWF_NAME = \"AWS GuardDuty: Archive Finding\"\n\nCONTENT = playbook.functions.results.output.get(\"content\", {})\nINPUTS = playbook.functions.results.output.get(\"inputs\", {})\n\n\n# Processing\nnote_text = \u0027\u0027\nif CONTENT:\n    if CONTENT[\"status\"] == \"ok\":\n        note_text = \"AWS IAM Integration: Playbook: {0}\u003cbr\u003eThe finding with id \u003cb\u003e{1}\u003c/b\u003e and detector id \" \\\n                    \"\u003cb\u003e{2}\u003c/b\u003e in region \u003cb\u003e{3}\u003c/b\u003e was successfully archived for SOAR function: \u003cb\u003e{4}\u003c/b\u003e\"\\\n            .format(WF_NAME, INPUTS[\"aws_gd_finding_id\"], INPUTS[\"aws_gd_detector_id\"], INPUTS[\"aws_gd_region\"], FN_NAME)\n        # Update archived property.\n        incident.properties.aws_guardduty_archived = \"True\"  \n        \n\n    elif CONTENT[\"status\"] == \"error\":\n        note_text = \"AWS IAM Integration: Playbook: {0}\u003cbr\u003eThe finding with id \u003cb\u003e{1}\u003c/b\u003e and detector id \" \\\n                    \"\u003cb\u003e{2}\u003c/b\u003e in region \u003cb\u003e{3}\u003c/b\u003e failed archive with error \u003cb\u003e{4}\u003c/b\u003e for SOAR function: \u003cb\u003e{5}\u003c/b\u003e\"\\\n            .format(WF_NAME, INPUTS[\"aws_gd_finding_id\"], INPUTS[\"aws_gd_detector_id\"], INPUTS[\"aws_gd_region\"],\n                    CONTENT[\"msg\"], FN_NAME)\n\n    else:\n        note_text = \"AWS IAM Integration: Playbook: {0}\u003cbr\u003eThe finding with id \u003cb\u003e{1}\u003c/b\u003e and detector id \" \\\n                    \"\u003cb\u003e{2}\u003c/b\u003e in region \u003cb\u003e{3}\u003c/b\u003e got unexpected status \u003cb\u003e{4}\u003c/b\u003e for SOAR function: \u003cb\u003e{5}\u003c/b\u003e\" \\\n            .format(WF_NAME, INPUTS[\"aws_gd_finding_id\"], INPUTS[\"aws_gd_detector_id\"], CONTENT[\"status\"], INPUTS[\"aws_gd_region\"],\n                    FN_NAME)\n\nelse:\n    note_text += \"AWS IAM Integration: Playbook {0}\u003cbr\u003eThere was no result returned for SOAR function: \u003cb\u003e{1}\u003c/b\u003e\"\\\n        .format(WF_NAME, FN_NAME)\n\nincident.addNote(helper.createRichText(note_text))\n",
          "tags": [],
          "uuid": "021b041b-85f9-4682-a99e-30b6b8756f48"
        }
      ],
      "name": "example_aws_guardduty_archive_finding_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_dcfbac7d-214a-41c3-bf6e-7f4b9abd4e7b",
        "id": 566,
        "name": "playbook_dcfbac7d_214a_41c3_bf6e_7f4b9abd4e7b",
        "type": "playbook",
        "uuid": "eaa61a78-0e52-4a1b-ab44-62aff583b296"
      },
      "tags": [],
      "type": "default",
      "uuid": "dcfbac7d-214a-41c3-bf6e-7f4b9abd4e7b",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 9,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_9a8d439d_d209_499f_951d_3788ab7abbc0\" isExecutable=\"true\" name=\"playbook_9a8d439d_d209_499f_951d_3788ab7abbc0\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1cf5oxf\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Create IPSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"0832d3fa-bcd1-4ca5-b40a-0529698c5d80\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_name = playbook.inputs.aws_gd_name\\ninputs.aws_gd_activate = playbook.inputs.aws_gd_activate\\ninputs.aws_gd_format = playbook.inputs.aws_gd_format\\ninputs.aws_gd_location = playbook.inputs.aws_gd_location\\ninputs.aws_gd_client_token = playbook.inputs.aws_gd_client_token\\ninputs.aws_gd_tags = playbook.inputs.aws_gd_tags\\ninputs.aws_gd_bucket_owner = playbook.inputs.aws_gd_bucket_owner\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1cf5oxf\u003c/incoming\u003e\u003coutgoing\u003eFlow_18d8bah\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1cf5oxf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Create IPSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"b08c4b86-6a7b-4be8-b285-57104455fcaa\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_18d8bah\u003c/incoming\u003e\u003coutgoing\u003eFlow_0sq6n8q\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_18d8bah\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0sq6n8q\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0sq6n8q\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_9a8d439d_d209_499f_951d_3788ab7abbc0\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0sq6n8q\" id=\"Flow_0sq6n8q_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"574\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_18d8bah\" id=\"Flow_18d8bah_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1cf5oxf\" id=\"Flow_1cf5oxf_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"574\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1753111749980,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
      "description": {
        "content": "SOAR function to create a new ip set on AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Create IPSet (PB)",
      "export_key": "aws_guardduty_create_ipset_pb",
      "field_type_handle": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Create IPSet (PB)",
        "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
        "fields": {
          "aws_gd_activate": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_activate",
            "hide_notification": false,
            "id": 5789,
            "input_type": "boolean",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_activate",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Activation",
            "tooltip": "Should the GuardDuty use this IP Set",
            "type_id": 1557,
            "uuid": "7d0a1d15-974f-4aed-88cf-9fc9047a4d96",
            "values": []
          },
          "aws_gd_bucket_owner": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_bucket_owner",
            "hide_notification": false,
            "id": 5790,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_bucket_owner",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Bucket Owner",
            "tooltip": "Account linked to S3 bucket whose location is specified in the File Path",
            "type_id": 1557,
            "uuid": "230684c6-6aef-4baf-a419-929137e56dfe",
            "values": []
          },
          "aws_gd_client_token": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_client_token",
            "hide_notification": false,
            "id": 5791,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_client_token",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Client Token",
            "tooltip": "Token generated for the create request",
            "type_id": 1557,
            "uuid": "4f5fe68a-0309-4342-b0e4-e4b669cb61b6",
            "values": []
          },
          "aws_gd_format": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_format",
            "hide_notification": false,
            "id": 5792,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_format",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "File Format",
            "tooltip": "File format that contains the trusted IP Addresses",
            "type_id": 1557,
            "uuid": "a35bc15c-63a3-417f-b6ea-a4a4cddb263a",
            "values": [
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "TXT",
                "properties": null,
                "uuid": "b7fd1158-7004-4eaa-b5ac-a24448ae4730",
                "value": 5852
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "STIX",
                "properties": null,
                "uuid": "4a2d210f-de8a-4578-b95b-bf49514dd4e8",
                "value": 5853
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "OTX_CSV",
                "properties": null,
                "uuid": "b4b9b6a2-f972-498c-a294-9087cfa6b1cc",
                "value": 5854
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "ALIEN_VAULT",
                "properties": null,
                "uuid": "d3923469-e455-42f1-b740-c40894562eeb",
                "value": 5855
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "PROOF_POINT",
                "properties": null,
                "uuid": "71f8e711-5553-40fb-be03-f68bff435ccd",
                "value": 5856
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "FIRE_EYE",
                "properties": null,
                "uuid": "8491aea3-d346-41b1-a85f-1b0b512adae0",
                "value": 5857
              }
            ]
          },
          "aws_gd_location": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_location",
            "hide_notification": false,
            "id": 5793,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_location",
            "operation_perms": {},
            "operations": [],
            "placeholder": "https://s3.amazonaws.com/bucket-name/file.txt",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "File Path",
            "tooltip": "Path of the file which has the trusted IP Addresses",
            "type_id": 1557,
            "uuid": "f9a05022-2575-4556-b58b-bb3495df4ad2",
            "values": []
          },
          "aws_gd_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_name",
            "hide_notification": false,
            "id": 5794,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "IP Set Name",
            "tooltip": "Name displayed in all findings which are associated with this IP Set",
            "type_id": 1557,
            "uuid": "6ae31b59-eee6-4b19-a5c6-66e1407d707a",
            "values": []
          },
          "aws_gd_tags": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0/aws_gd_tags",
            "hide_notification": false,
            "id": 5795,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_tags",
            "operation_perms": {},
            "operations": [],
            "placeholder": "key:value, key:value",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Tags",
            "tooltip": "Add tags to newly created IP Set",
            "type_id": 1557,
            "uuid": "a7daeb1b-c513-4cb9-af92-a1b2c7d4219d",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
        "uuid": "dd2d7225-15e9-4567-ac2d-2dab2d05c848"
      },
      "has_logical_errors": false,
      "id": 445,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602624545,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1753112424576,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Create IPSet Post Script",
          "id": 433,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755266855617,
          "name": "AWS GuardDuty: Create IPSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_create_ipset_pb",
          "programmatic_name": "aws_guardduty_create_ipset_pb_aws_guardduty_create_ipset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty Create IPset\n\nFN_NAME = \"aws_guardduty_create_ipset\"\nWF_NAME = \"AWS GuardDuty: Create IPSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content.status != \u0027error\u0027 and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    ip_set_id = response_body.get(\"IpSetId\")\n    note_text += f\"IPSetId: {ip_set_id}\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027content\u0027).get(\u0027msg\u0027)}\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "b08c4b86-6a7b-4be8-b285-57104455fcaa"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "6ae31b59-eee6-4b19-a5c6-66e1407d707a",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a35bc15c-63a3-417f-b6ea-a4a4cddb263a",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "f9a05022-2575-4556-b58b-bb3495df4ad2",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "7d0a1d15-974f-4aed-88cf-9fc9047a4d96",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a7daeb1b-c513-4cb9-af92-a1b2c7d4219d",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "4f5fe68a-0309-4342-b0e4-e4b669cb61b6",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "230684c6-6aef-4baf-a419-929137e56dfe",
            "element": "field_uuid",
            "field_type": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_create_ipset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_9a8d439d-d209-499f-951d-3788ab7abbc0",
        "id": 637,
        "name": "playbook_9a8d439d_d209_499f_951d_3788ab7abbc0",
        "type": "playbook",
        "uuid": "aa2dee8c-1d8c-466e-8106-da9e53cd68c1"
      },
      "tags": [],
      "type": "default",
      "uuid": "9a8d439d-d209-499f-951d-3788ab7abbc0",
      "version": 13
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 29,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c\" isExecutable=\"true\" name=\"playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0hcqk3o\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Create ThreatIntelSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"30ff0a1a-46e4-4952-91fe-7e15ce6c9596\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_name = playbook.inputs.aws_gd_name\\ninputs.aws_gd_activate = playbook.inputs.aws_gd_activate\\ninputs.aws_gd_format = playbook.inputs.aws_gd_format\\ninputs.aws_gd_location = playbook.inputs.aws_gd_location\\ninputs.aws_gd_client_token = playbook.inputs.aws_gd_client_token\\ninputs.aws_gd_tags = playbook.inputs.aws_gd_tags\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0hcqk3o\u003c/incoming\u003e\u003coutgoing\u003eFlow_0e57tg6\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0hcqk3o\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Create ThreatIntelSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"8765ab6c-deb5-4292-be7f-b6d945b2f02d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0e57tg6\u003c/incoming\u003e\u003coutgoing\u003eFlow_17p0ful\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0e57tg6\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_17p0ful\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_17p0ful\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_17p0ful\" id=\"Flow_17p0ful_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"442\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"504\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0e57tg6\" id=\"Flow_0e57tg6_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"358\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0hcqk3o\" id=\"Flow_0hcqk3o_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"198\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"358\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"504\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1751541910632,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
      "description": {
        "content": "SOAR function to create a new threat intel set on AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Create ThreatIntelSet (PB)",
      "export_key": "aws_guardduty_create_threatintelset_pb",
      "field_type_handle": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Create ThreatIntelSet (PB)",
        "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
        "fields": {
          "aws_gd_activate": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c/aws_gd_activate",
            "hide_notification": false,
            "id": 5652,
            "input_type": "boolean",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_activate",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Activation",
            "tooltip": "Should the GuardDuty use this Threat Intel Set",
            "type_id": 1525,
            "uuid": "a57d1d29-494b-4b13-a16b-4c0e4ae1c524",
            "values": []
          },
          "aws_gd_client_token": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c/aws_gd_client_token",
            "hide_notification": false,
            "id": 5653,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_client_token",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Client Token",
            "tooltip": "Token generated for the create request",
            "type_id": 1525,
            "uuid": "ef5b01c2-35f5-4218-b71d-252dc1ecc2ca",
            "values": []
          },
          "aws_gd_format": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c/aws_gd_format",
            "hide_notification": false,
            "id": 5651,
            "input_type": "select",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_format",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "File Format",
            "tooltip": "File format that contains the malicious IP Addresses",
            "type_id": 1525,
            "uuid": "28852f8b-a954-4a2b-8ed2-c6ec222385e8",
            "values": [
              {
                "default": true,
                "enabled": true,
                "hidden": false,
                "label": "TXT",
                "properties": null,
                "uuid": "234001e5-8bd7-42b1-8da3-f0897cf9ecad",
                "value": 5652
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "STIX",
                "properties": null,
                "uuid": "5034ce52-4a0f-4324-aad8-a421b844e90b",
                "value": 5653
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "OTX_CSV",
                "properties": null,
                "uuid": "c50344dd-251f-4dc5-b930-2f3d91663650",
                "value": 5654
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "ALIEN_VAULT",
                "properties": null,
                "uuid": "7adec130-caa7-4ffd-a3da-dd20938a1c50",
                "value": 5655
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "PROOF_POINT",
                "properties": null,
                "uuid": "808dbe32-43c6-4e5f-a3f6-e4629d477bc7",
                "value": 5656
              },
              {
                "default": false,
                "enabled": true,
                "hidden": false,
                "label": "FIRE_EYE",
                "properties": null,
                "uuid": "080034d0-3742-41e2-8f75-a87abc65b91c",
                "value": 5657
              }
            ]
          },
          "aws_gd_location": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c/aws_gd_location",
            "hide_notification": false,
            "id": 5654,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_location",
            "operation_perms": {},
            "operations": [],
            "placeholder": "https://s3.amazonaws.com/bucket-name/file.txt",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "File Path",
            "tooltip": "Path of the file which has the malicious IP Addresses",
            "type_id": 1525,
            "uuid": "b82f0ce4-2661-4f43-9228-670f8c16836a",
            "values": []
          },
          "aws_gd_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c/aws_gd_name",
            "hide_notification": false,
            "id": 5650,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Threat Intel Set Name",
            "tooltip": "Name displayed in all findings which are associated with this Threat Intel Set",
            "type_id": 1525,
            "uuid": "0dfc8d28-cc99-4dbe-b1a7-4718b9f07a3a",
            "values": []
          },
          "aws_gd_tags": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c/aws_gd_tags",
            "hide_notification": false,
            "id": 5655,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_tags",
            "operation_perms": {},
            "operations": [],
            "placeholder": "key:value, key:value",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Tags",
            "tooltip": "Add tags to newly created Threat Intel Set",
            "type_id": 1525,
            "uuid": "511d3be5-1ae7-46b5-84cf-886c1c5d93cb",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
        "uuid": "bf7f62a9-7845-420c-8851-2e0a2c6d55ab"
      },
      "has_logical_errors": false,
      "id": 415,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602601066,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1751541910874,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Create ThreatIntelSet Post Script",
          "id": 407,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755266747430,
          "name": "AWS GuardDuty: Create ThreatIntelSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_create_threatintelset_pb",
          "programmatic_name": "aws_guardduty_create_threatintelset_pb_aws_guardduty_create_threatintelset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty Create ThreatIntelset\n\nFN_NAME = \"aws_guardduty_create_threatintelset\"\nWF_NAME = \"AWS GuardDuty: Create ThreatIntelSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content.status != \u0027error\u0027 and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    threat_intel_set_id = response_body.get(\"ThreatIntelSetId\")\n    note_text += f\"ThreatIntelSetId: {threat_intel_set_id}\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027content\u0027).get(\u0027msg\u0027)}\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "8765ab6c-deb5-4292-be7f-b6d945b2f02d"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "0dfc8d28-cc99-4dbe-b1a7-4718b9f07a3a",
            "element": "field_uuid",
            "field_type": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "28852f8b-a954-4a2b-8ed2-c6ec222385e8",
            "element": "field_uuid",
            "field_type": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "b82f0ce4-2661-4f43-9228-670f8c16836a",
            "element": "field_uuid",
            "field_type": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a57d1d29-494b-4b13-a16b-4c0e4ae1c524",
            "element": "field_uuid",
            "field_type": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "511d3be5-1ae7-46b5-84cf-886c1c5d93cb",
            "element": "field_uuid",
            "field_type": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "ef5b01c2-35f5-4218-b71d-252dc1ecc2ca",
            "element": "field_uuid",
            "field_type": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_create_threatintelset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_f86ecb63-5f00-41e3-a2d5-aefbf703162c",
        "id": 604,
        "name": "playbook_f86ecb63_5f00_41e3_a2d5_aefbf703162c",
        "type": "playbook",
        "uuid": "aa8a4cec-6bba-401d-9bfe-ee9920a53bb9"
      },
      "tags": [],
      "type": "default",
      "uuid": "f86ecb63-5f00-41e3-a2d5-aefbf703162c",
      "version": 33
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 6,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_bb505f39_7d5c_4407_a999_a25222d64c41\" isExecutable=\"true\" name=\"playbook_bb505f39_7d5c_4407_a999_a25222d64c41\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1wit9of\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Delete IPSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"849c767e-aacd-408a-b764-26d6a68c8a86\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_ip_set_id = playbook.inputs.aws_gd_ip_set_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1wit9of\u003c/incoming\u003e\u003coutgoing\u003eFlow_02bmrjd\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1wit9of\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Delete IPSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"0f6f67d4-e782-41f1-ad81-26c4b9daea77\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_02bmrjd\u003c/incoming\u003e\u003coutgoing\u003eFlow_100e0ad\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_02bmrjd\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_100e0ad\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_100e0ad\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_bb505f39_7d5c_4407_a999_a25222d64c41\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_100e0ad\" id=\"Flow_100e0ad_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"502\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"614\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_02bmrjd\" id=\"Flow_02bmrjd_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"312\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"418\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1wit9of\" id=\"Flow_1wit9of_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"228\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"228\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"418\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"614\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1753440122038,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41",
      "description": {
        "content": "SOAR function to delete a ip set from AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Delete IPSet (PB)",
      "export_key": "aws_guardduty_delete_ipset_pb",
      "field_type_handle": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Delete IPSet (PB)",
        "export_key": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41",
        "fields": {
          "aws_gd_ip_set_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41/aws_gd_ip_set_id",
            "hide_notification": false,
            "id": 5806,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_ip_set_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "IP Set Id",
            "tooltip": "The unique id associated with a IP Set",
            "type_id": 1562,
            "uuid": "b03140ce-fe54-4269-88fa-5fed18f73699",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41",
        "uuid": "ad37f2b6-ccab-477d-bf2f-cbd456d31a67"
      },
      "has_logical_errors": false,
      "id": 450,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602381109,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1753440678230,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Delete IPSet Post Script",
          "id": 438,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755266556681,
          "name": "AWS GuardDuty: Delete IPSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_delete_ipset_pb",
          "programmatic_name": "aws_guardduty_delete_ipset_pb_aws_guardduty_delete_ipset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty Delete IPset\n\nFN_NAME = \"aws_guardduty_delete_IPset\"\nWF_NAME = \"AWS GuardDuty: Delete IPSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content.status != \u0027error\u0027 and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    note_text += f\"IPSet Deleted: {playbook.inputs.aws_gd_ip_set_id}\u003cbr\u003e\"\n    note_text += f\"\u003cb\u003eStatus of request:\u003c/b\u003e {response_body.get(\u0027status\u0027)}\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027content\u0027).get(\u0027msg\u0027)}\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "0f6f67d4-e782-41f1-ad81-26c4b9daea77"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "b03140ce-fe54-4269-88fa-5fed18f73699",
            "element": "field_uuid",
            "field_type": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_delete_ipset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_bb505f39-7d5c-4407-a999-a25222d64c41",
        "id": 642,
        "name": "playbook_bb505f39_7d5c_4407_a999_a25222d64c41",
        "type": "playbook",
        "uuid": "30f7ae40-b160-42b1-8885-617e8933bbef"
      },
      "tags": [],
      "type": "default",
      "uuid": "bb505f39-7d5c-4407-a999-a25222d64c41",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 11,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca\" isExecutable=\"true\" name=\"playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1narqvv\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Delete ThreatIntelSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"14d6c7c5-c658-4240-b23e-10794d8ef0f0\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_threat_intel_set_id = playbook.inputs.aws_gd_threat_intel_set_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1narqvv\u003c/incoming\u003e\u003coutgoing\u003eFlow_0ildhp9\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1narqvv\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Delete ThreatIntelSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"f5322073-5977-47df-9647-3a976b8a2a72\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0ildhp9\u003c/incoming\u003e\u003coutgoing\u003eFlow_1tm7eoi\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0ildhp9\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1tm7eoi\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1tm7eoi\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1tm7eoi\" id=\"Flow_1tm7eoi_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"462\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"524\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0ildhp9\" id=\"Flow_0ildhp9_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"378\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1narqvv\" id=\"Flow_1narqvv_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"136\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"84\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"378\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"524\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1752743529657,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca",
      "description": {
        "content": "SOAR function to delete a threat intel set from AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Delete ThreatIntelSet (PB)",
      "export_key": "aws_guardduty_delete_threatintelset_pb",
      "field_type_handle": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Delete ThreatIntelSet (PB)",
        "export_key": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca",
        "fields": {
          "aws_gd_threat_intel_set_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca/aws_gd_threat_intel_set_id",
            "hide_notification": false,
            "id": 5785,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_threat_intel_set_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Threat Intel Set Id",
            "tooltip": "The unique id associated with a Threat Intel Set",
            "type_id": 1554,
            "uuid": "d904b035-3244-4f75-9e42-7f7037022f49",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca",
        "uuid": "bf3f9bfc-4e64-4ed7-be00-48ffc662fd21"
      },
      "has_logical_errors": false,
      "id": 442,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602382126,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1752743938288,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Delete ThreatIntelSet Post Script",
          "id": 430,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755266461269,
          "name": "AWS GuardDuty: Delete ThreatIntelSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_delete_threatintelset_pb",
          "programmatic_name": "aws_guardduty_delete_threatintelset_pb_aws_guardduty_delete_threatintelset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty Delete ThreatIntelset\n\nFN_NAME = \"aws_guardduty_delete_threatintelset\"\nWF_NAME = \"AWS GuardDuty: Delete ThreatIntelSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content.status != \u0027error\u0027 and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    note_text += f\"ThreatIntelSet Deleted: {playbook.inputs.aws_gd_threat_intel_set_id}\u003cbr\u003e\"\n    note_text += f\"\u003cb\u003eStatus of request:\u003c/b\u003e {response_body.get(\u0027status\u0027)}\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027content\u0027).get(\u0027msg\u0027)}\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "f5322073-5977-47df-9647-3a976b8a2a72"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "d904b035-3244-4f75-9e42-7f7037022f49",
            "element": "field_uuid",
            "field_type": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_delete_threatintelset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_96b02ecb-3b1b-49ea-8e10-9422918ed6ca",
        "id": 634,
        "name": "playbook_96b02ecb_3b1b_49ea_8e10_9422918ed6ca",
        "type": "playbook",
        "uuid": "0987363d-717f-407e-80a6-329c76a3b51c"
      },
      "tags": [],
      "type": "default",
      "uuid": "96b02ecb-3b1b-49ea-8e10-9422918ed6ca",
      "version": 15
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41\" isExecutable=\"true\" name=\"playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_11m1q6c\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Get IPSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"504e4145-7243-42e3-a04a-cae366b5a39c\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_ip_set_id = playbook.inputs.aws_gd_ip_set_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_11m1q6c\u003c/incoming\u003e\u003coutgoing\u003eFlow_0cj6r8a\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_11m1q6c\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: GET IPSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"1a815dab-d5aa-47ac-96a3-f39664be9629\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0cj6r8a\u003c/incoming\u003e\u003coutgoing\u003eFlow_1nqq9f7\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0cj6r8a\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1nqq9f7\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1nqq9f7\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1nqq9f7\" id=\"Flow_1nqq9f7_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"482\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"554\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0cj6r8a\" id=\"Flow_0cj6r8a_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"398\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_11m1q6c\" id=\"Flow_11m1q6c_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"398\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"554\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1753260785264,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41",
      "description": {
        "content": "SOAR function to read a ip set from AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: GET IPSet (PB)",
      "export_key": "aws_guardduty_get_ipset_pb",
      "field_type_handle": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: GET IPSet (PB)",
        "export_key": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41",
        "fields": {
          "aws_gd_ip_set_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41/aws_gd_ip_set_id",
            "hide_notification": false,
            "id": 5797,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_ip_set_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "IP Set Id",
            "tooltip": "The unique id associated with a IP Set",
            "type_id": 1558,
            "uuid": "6b73af1f-4fd6-41be-bbfc-e8f4063171f2",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41",
        "uuid": "d25e9896-78ec-49d6-a6c1-546354b42087"
      },
      "has_logical_errors": false,
      "id": 446,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602383090,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1753261432370,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: GET IPSet Post Script",
          "id": 434,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755266260488,
          "name": "AWS GuardDuty: GET IPSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_get_ipset_pb",
          "programmatic_name": "aws_guardduty_get_ipset_pb_aws_guardduty_get_ipset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty GET IPset\n\nFN_NAME = \"aws_guardduty_get_ipset\"\nWF_NAME = \"AWS GuardDuty: GET IPSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    ip_set_id = response_body.get(\"IpSetId\")\n    note_text += f\"\u003cb\u003eInformation about the IPSet:\u003c/b\u003e\u003cbr\u003e\"\n    note_text += f\"IPSetId: {playbook.inputs.aws_gd_ip_set_id}\u003cbr\u003e\"\n    note_text += f\"Name: {response_body.get(\u0027Name\u0027)}\u003cbr\u003eFormat: {response_body.get(\u0027Format\u0027)}\u003cbr\u003eLocation: {response_body.get(\u0027Location\u0027)}\u003cbr\u003eStatus: {response_body.get(\u0027Status\u0027)}\u003cbr\u003eTags: {response_body.get(\u0027Tags\u0027)}\u003cbr\u003eBucketOwner: {response_body.get(\u0027ExpectedBucketOwner\u0027)}\u003cbr\u003e\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "1a815dab-d5aa-47ac-96a3-f39664be9629"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "6b73af1f-4fd6-41be-bbfc-e8f4063171f2",
            "element": "field_uuid",
            "field_type": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_get_ipset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_240f7bd9-ef6c-4666-baa2-e175d1b9aa41",
        "id": 638,
        "name": "playbook_240f7bd9_ef6c_4666_baa2_e175d1b9aa41",
        "type": "playbook",
        "uuid": "769de86c-464a-4eaf-9e71-328cf2ca175c"
      },
      "tags": [],
      "type": "default",
      "uuid": "240f7bd9-ef6c-4666-baa2-e175d1b9aa41",
      "version": 11
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 19,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_ec565154_a468_4a8b_a061_5519b5db323e\" isExecutable=\"true\" name=\"playbook_ec565154_a468_4a8b_a061_5519b5db323e\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1r1p0nl\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Get ThreatIntelSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"fb4e92b7-42fd-480e-944c-91ebe4b66b62\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_threat_intel_set_id = playbook.inputs.aws_gd_threat_intel_set_id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1r1p0nl\u003c/incoming\u003e\u003coutgoing\u003eFlow_14fm6uk\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1r1p0nl\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: GET ThreatIntelSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"a939ac1c-407f-482d-ab67-00c0cc5e51f7\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_14fm6uk\u003c/incoming\u003e\u003coutgoing\u003eFlow_1kfvohx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_14fm6uk\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1kfvohx\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1kfvohx\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_ec565154_a468_4a8b_a061_5519b5db323e\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1kfvohx\" id=\"Flow_1kfvohx_di\"\u003e\u003comgdi:waypoint x=\"870\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"514\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_14fm6uk\" id=\"Flow_14fm6uk_di\"\u003e\u003comgdi:waypoint x=\"870\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1r1p0nl\" id=\"Flow_1r1p0nl_di\"\u003e\u003comgdi:waypoint x=\"870\" y=\"126\"/\u003e\u003comgdi:waypoint x=\"870\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"776\" y=\"74\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"772\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"772\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"804\" y=\"514\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1752157344044,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_ec565154_a468_4a8b_a061_5519b5db323e",
      "description": {
        "content": "SOAR function to read a threat intel set from AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: GET ThreatIntelSet (PB)",
      "export_key": "aws_guardduty_get_threatintelset_pb",
      "field_type_handle": "playbook_ec565154_a468_4a8b_a061_5519b5db323e",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: GET ThreatIntelSet (PB)",
        "export_key": "playbook_ec565154_a468_4a8b_a061_5519b5db323e",
        "fields": {
          "aws_gd_threat_intel_set_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_ec565154_a468_4a8b_a061_5519b5db323e/aws_gd_threat_intel_set_id",
            "hide_notification": false,
            "id": 5741,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_threat_intel_set_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Threat Intel Set Id",
            "tooltip": "The unique id associated with a Threat Intel Set",
            "type_id": 1543,
            "uuid": "9609b146-0bfd-47a5-920e-bd906e9905d1",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_ec565154_a468_4a8b_a061_5519b5db323e",
        "uuid": "998aab62-616b-4778-b608-4bed07587213"
      },
      "has_logical_errors": false,
      "id": 432,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602384038,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1752158128629,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: GET ThreatIntelSet Post Script",
          "id": 422,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755266218539,
          "name": "AWS GuardDuty: GET ThreatIntelSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_get_threatintelset_pb",
          "programmatic_name": "aws_guardduty_get_threatintelset_pb_aws_guardduty_get_threatintelset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty GET ThreatIntelset\n\nFN_NAME = \"aws_guardduty_get_threatintelset\"\nWF_NAME = \"AWS GuardDuty: GET ThreatIntelSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    threat_intel_set_id = response_body.get(\"ThreatIntelSetId\")\n    note_text += f\"\u003cb\u003eInformation about the ThreatIntelSet:\u003c/b\u003e\u003cbr\u003e\"\n    note_text += f\"ThreatIntelSetId: {playbook.inputs.aws_gd_threat_intel_set_id}\u003cbr\u003e\"\n    note_text += f\"Name: {response_body.get(\u0027Name\u0027)}\u003cbr\u003eFormat: {response_body.get(\u0027Format\u0027)}\u003cbr\u003eLocation: {response_body.get(\u0027Location\u0027)}\u003cbr\u003eStatus: {response_body.get(\u0027Status\u0027)}\u003cbr\u003eTags: {response_body.get(\u0027Tags\u0027)}\u003cbr\u003e\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "a939ac1c-407f-482d-ab67-00c0cc5e51f7"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "9609b146-0bfd-47a5-920e-bd906e9905d1",
            "element": "field_uuid",
            "field_type": "playbook_ec565154_a468_4a8b_a061_5519b5db323e",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_get_threatintelset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_ec565154-a468-4a8b-a061-5519b5db323e",
        "id": 622,
        "name": "playbook_ec565154_a468_4a8b_a061_5519b5db323e",
        "type": "playbook",
        "uuid": "40925a6f-25ef-435f-8751-e2e24ef5170a"
      },
      "tags": [],
      "type": "default",
      "uuid": "ec565154-a468-4a8b-a061-5519b5db323e",
      "version": 23
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 10,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2\" isExecutable=\"true\" name=\"playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_16s212p\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: List IPSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"770193c3-7e68-45c9-afbe-d24646e68222\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_max_results = playbook.inputs.aws_gd_max_results\\ninputs.aws_gd_next_token = playbook.inputs.aws_gd_next_token\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_16s212p\u003c/incoming\u003e\u003coutgoing\u003eFlow_151w5j4\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_16s212p\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: List IPSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"5982f8da-348c-43d0-935b-52443771898b\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_151w5j4\u003c/incoming\u003e\u003coutgoing\u003eFlow_15sennu\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_151w5j4\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_15sennu\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_15sennu\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_15sennu\" id=\"Flow_15sennu_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"562\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"684\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_151w5j4\" id=\"Flow_151w5j4_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"342\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"478\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_16s212p\" id=\"Flow_16s212p_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"258\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"258\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"478\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"684\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1753281275512,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
      "description": {
        "content": "SOAR function to read list of all ip sets from AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: List IPSet (PB)",
      "export_key": "aws_guardduty_list_ipset_pb",
      "field_type_handle": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: List IPSet (PB)",
        "export_key": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
        "fields": {
          "aws_gd_max_results": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2/aws_gd_max_results",
            "hide_notification": false,
            "id": 5798,
            "input_type": "number",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_max_results",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Max Results",
            "tooltip": "specify the maximum number of results you want to get ",
            "type_id": 1559,
            "uuid": "ae63c9a1-6850-4f8e-a70a-58b228a99b7f",
            "values": []
          },
          "aws_gd_next_token": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2/aws_gd_next_token",
            "hide_notification": false,
            "id": 5799,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_next_token",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Next Token",
            "tooltip": "Pagination parameter to be used on the next list operation to retrieve more items",
            "type_id": 1559,
            "uuid": "815c6364-85d3-4eff-9da4-a18337215123",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
        "uuid": "bcc5c388-2b76-42a8-aad4-2abddb45c37f"
      },
      "has_logical_errors": false,
      "id": 447,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602384965,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1753281912266,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: List IPSet Post Script",
          "id": 435,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755548696521,
          "name": "AWS GuardDuty: List IPSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_list_ipset_pb",
          "programmatic_name": "aws_guardduty_list_ipset_pb_aws_guardduty_list_ipset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty List IPset\n\nFN_NAME = \"aws_guardduty_list_ip_set\"\nWF_NAME = \"AWS GuardDuty: List IPSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    ip_set_ids = results.get(\"content\")\n    note_text += f\"\u003cb\u003eListing all the IPSetIds:\u003c/b\u003e\u003cbr\u003e{ip_set_ids}\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e No IPSets found on AWS GuardDuty for this region\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "5982f8da-348c-43d0-935b-52443771898b"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "ae63c9a1-6850-4f8e-a70a-58b228a99b7f",
            "element": "field_uuid",
            "field_type": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "815c6364-85d3-4eff-9da4-a18337215123",
            "element": "field_uuid",
            "field_type": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_list_ipset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_836542f6-b2b1-42ab-b63d-cf2ade176da2",
        "id": 639,
        "name": "playbook_836542f6_b2b1_42ab_b63d_cf2ade176da2",
        "type": "playbook",
        "uuid": "c2a2772a-8bee-4cba-8082-326e1ff7fc87"
      },
      "tags": [],
      "type": "default",
      "uuid": "836542f6-b2b1-42ab-b63d-cf2ade176da2",
      "version": 14
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 19,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_25847f1d_be4b_4530_938a_458851ac8c7c\" isExecutable=\"true\" name=\"playbook_25847f1d_be4b_4530_938a_458851ac8c7c\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_0m98c4g\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: List ThreatIntelSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"743e2891-6e0d-4635-907c-8e11e058ed6e\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_max_results = playbook.inputs.aws_gd_max_results\\ninputs.aws_gd_next_token = playbook.inputs.aws_gd_next_token\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0m98c4g\u003c/incoming\u003e\u003coutgoing\u003eFlow_1hqbpnn\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_0m98c4g\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: List ThreatIntelSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7c6912f9-6d4b-4d4f-ae68-3c36133788fc\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1hqbpnn\u003c/incoming\u003e\u003coutgoing\u003eFlow_0wmufny\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1hqbpnn\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0wmufny\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0wmufny\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_25847f1d_be4b_4530_938a_458851ac8c7c\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0wmufny\" id=\"Flow_0wmufny_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"462\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"534\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1hqbpnn\" id=\"Flow_1hqbpnn_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"302\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"378\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0m98c4g\" id=\"Flow_0m98c4g_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"156\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"218\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"104\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"218\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"378\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"534\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1752243054916,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
      "description": {
        "content": "SOAR function to read list of all threat intel sets from AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: List ThreatIntelSet (PB)",
      "export_key": "aws_guardduty_list_threatintelset_pb",
      "field_type_handle": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: List ThreatIntelSet (PB)",
        "export_key": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
        "fields": {
          "aws_gd_max_results": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c/aws_gd_max_results",
            "hide_notification": false,
            "id": 5744,
            "input_type": "number",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_max_results",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Max Results",
            "tooltip": "specify the maximum number of results you want to get ",
            "type_id": 1544,
            "uuid": "2684d030-80d5-4569-97c3-55fa9fbf692c",
            "values": []
          },
          "aws_gd_next_token": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c/aws_gd_next_token",
            "hide_notification": false,
            "id": 5745,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_next_token",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Next Token",
            "tooltip": "Pagination parameter to be used on the next list operation to retrieve more items",
            "type_id": 1544,
            "uuid": "dbedf0cc-a0e8-4ef0-87ff-4e78f0513e2d",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
        "uuid": "3b69f234-90d6-41a3-80ea-37e9d150d4b3"
      },
      "has_logical_errors": false,
      "id": 433,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602386055,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1752244227149,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: List ThreatIntelSet Post Script",
          "id": 423,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755256505892,
          "name": "AWS GuardDuty: List ThreatIntelSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_list_threatintelset_pb",
          "programmatic_name": "aws_guardduty_list_threatintelset_pb_aws_guardduty_list_threatintelset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty List ThreatIntelset\n\nFN_NAME = \"aws_guardduty_list_threatintelset\"\nWF_NAME = \"AWS GuardDuty: List ThreatIntelSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    threat_intel_set_ids = results.get(\"content\")\n    note_text += f\"\u003cb\u003eListing all the ThreatIntelSetIds:\u003c/b\u003e\u003cbr\u003e{threat_intel_set_ids}\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e No ThreatIntelSets found on AWS GuardDuty for this region\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "7c6912f9-6d4b-4d4f-ae68-3c36133788fc"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "2684d030-80d5-4569-97c3-55fa9fbf692c",
            "element": "field_uuid",
            "field_type": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "dbedf0cc-a0e8-4ef0-87ff-4e78f0513e2d",
            "element": "field_uuid",
            "field_type": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_list_threatintelset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_25847f1d-be4b-4530-938a-458851ac8c7c",
        "id": 623,
        "name": "playbook_25847f1d_be4b_4530_938a_458851ac8c7c",
        "type": "playbook",
        "uuid": "9ab04d9e-32bd-4795-a986-47f89928626b"
      },
      "tags": [],
      "type": "default",
      "uuid": "25847f1d-be4b-4530-938a-458851ac8c7c",
      "version": 24
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_a99e9657_b10e_44e3_8558_e494fe2c9039\" isExecutable=\"true\" name=\"playbook_a99e9657_b10e_44e3_8558_e494fe2c9039\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1r6qekf\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Refresh Finding\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"2d1446f8-13fc-4400-af6a-c96b55d9a0df\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_finding_id = incident.properties.aws_guardduty_finding_id\\ninputs.incident_id = incident.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1r6qekf\u003c/incoming\u003e\u003coutgoing\u003eFlow_1ifg4iq\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1r6qekf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cendEvent id=\"EndPoint_2\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1x750lg\u003c/incoming\u003e\u003c/endEvent\u003e\u003cscriptTask id=\"ScriptTask_3\" name=\"AWS GuardDuty: Refresh Finding Details Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"6b13da79-dd49-48b8-b511-588b0570d078\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1ifg4iq\u003c/incoming\u003e\u003coutgoing\u003eFlow_1x750lg\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_1ifg4iq\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_3\"/\u003e\u003csequenceFlow id=\"Flow_1x750lg\" sourceRef=\"ScriptTask_3\" targetRef=\"EndPoint_2\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_a99e9657_b10e_44e3_8558_e494fe2c9039\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1x750lg\" id=\"Flow_1x750lg_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"402\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"464\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1ifg4iq\" id=\"Flow_1ifg4iq_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"262\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"318\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1r6qekf\" id=\"Flow_1r6qekf_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"178\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"178\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_2\" id=\"EndPoint_2_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2109\" x=\"656\" y=\"464\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_3\" id=\"ScriptTask_3_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"318\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1750424885810,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_a99e9657_b10e_44e3_8558_e494fe2c9039",
      "description": {
        "content": "A SOAR playbook to refresh or update AWS GuardDuty finding details in an incident.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Refresh Finding Details (PB)",
      "export_key": "example_aws_guardduty_refresh_finding_details_pb",
      "field_type_handle": "playbook_a99e9657_b10e_44e3_8558_e494fe2c9039",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Refresh Finding Details (PB)",
        "export_key": "playbook_a99e9657_b10e_44e3_8558_e494fe2c9039",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_a99e9657_b10e_44e3_8558_e494fe2c9039",
        "uuid": "55ec1f55-147d-4b19-a64d-4dad5f711128"
      },
      "has_logical_errors": false,
      "id": 386,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602387148,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1750424886100,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Refresh Finding Details Post Script",
          "id": 389,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1750424886100,
          "name": "AWS GuardDuty: Refresh Finding Details Post Script",
          "object_type": "incident",
          "playbook_handle": "example_aws_guardduty_refresh_finding_details_pb",
          "programmatic_name": "example_aws_guardduty_refresh_finding_details_pb_aws_guardduty_refresh_finding_details_post_script",
          "script_text": "##  wf_aws_guardduty_refresh_finding ##\n# Example result:\n\"\"\"\nResult: { \u0027version\u0027: \u00271.0\u0027,\n          \u0027success\u0027: True,\n          \u0027reason\u0027: None,\n          \u0027content\u0027: {\u0027payload\u0027: {\u0027name\u0027: \u0027AWS GuardDuty: API GeneratedFindingAPIName was invoked from an IP address on a custom threat list.\u0027,\n                                  \u0027description\u0027: {\u0027format\u0027: \u0027text\u0027, \u0027content\u0027: \u0027An API was used to access a bucket from an IP address on a custom threat list.\u0027},\n                                  \u0027discovered_date\u0027: \u00272020-11-25T13:46:37.960Z\u0027,\n                                  \u0027severity_code\u0027: \u0027Low\u0027,\n                                  \u0027properties\u0027: {\u0027aws_guardduty_finding_id\u0027: \u002760baffd3f9042e38640f2300d5c5a631\u0027,\n                                                \u0027aws_guardduty_finding_arn\u0027: \u0027arn:aws:guardduty:us-west-2:834299573936:detector/f2baedb0ac74f8f42fc929e15f56da6a/finding/60baffd3f9042e38640f2300d5c5a631\u0027,\n                                                \u0027aws_guardduty_finding_type\u0027: \u0027UnauthorizedAccess:S3/MaliciousIPCaller.Custom\u0027,\n                                                \u0027aws_guardduty_finding_updated_at\u0027: \u00272020-11-26T15:18:12.620Z\u0027, \u0027aws_guardduty_region\u0027: \u0027us-west-2\u0027,\n                                                \u0027aws_guardduty_resource_type\u0027: \u0027S3Bucket\u0027, \u0027aws_guardduty_count\u0027: 4,\n                                                \u0027aws_guardduty_detector_id\u0027: \u0027f2baedb0ac74f8f42fc929e15f56da6a\u0027},\n                                  \u0027artifacts\u0027: [],\n                                  \u0027comments\u0027: [{\u0027text\u0027: {\u0027format\u0027: \u0027text\u0027, \u0027content\u0027: \"AWS GuardDuty finding Payload:\\n\u003cFINDING_PAYLOAD_AS_STRING\u003e\"}}]\n\n                                },\n                      \"data_tables\": {\"gd_action_details\": [{\"cells\": {\"action_type\": {\"value\": \"AWS_API_CALL\"},\n                                                            \"action_api\": {\"value\": \"GeneratedFindingAPIName\"},\n                                                            \"event_first_seen\": {\"value\": \"2020-11-25T13:46:37.960Z\"},\n                                                            \"event_last_seen\": {\"value\": \"2020-11-26T15:18:12.620Z\"},\n                                                            \"actor_caller_type\": {\"value\": \"Remote IP\"}, \"city_name\": {\"value\": \"GeneratedFindingCityName\"}, \"country_name\": {\"value\": \"GeneratedFindingCountryName\"}, \"asn\": {\"value\": \"-1\"}, \"asn_org\": {\"value\": \"GeneratedFindingASNOrg\"}, \"isp\": {\"value\": \"GeneratedFindingISP\"}, \"org\": {\"value\": \"GeneratedFindingORG\"}, \"action_service_name\": {\"value\": \"GeneratedFindingAPIServiceName\"}, \"remote_ip\": {\"value\": \"198.51.100.0\"}}}],\n                                    \"gd_resource_affected\": [{\"cells\": {\"resource_type\": {\"value\": \"S3Bucket\"}, \"instance_id\": {\"value\": \"i-99999999\"}, \"instance_type\": {\"value\": \"m3.xlarge\"}, \"instance_state\": {\"value\": \"running\"}, \"resource_role\": {\"value\": \"TARGET\"}, \"instance_private_ip\": {\"value\": \"10.0.0.1\"}, \"instance_private_dns\": {\"value\": \"GeneratedFindingPrivateName\"}, \"instance_public_ip\": {\"value\": \"198.51.100.0\"}, \"instance_public_dns\": {\"value\": \"GeneratedFindingPublicDNSName\"}, \"s3bucket_name\": {\"value\": \"bucketName\"}, \"s3bucket_owner\": {\"value\": \"CanonicalId of Owner\"}}}]\n\n                      }}\u0027,\n            \u0027inputs\u0027: {\u0027incident_id\u0027: 2168, \u0027aws_gd_finding_id\u0027: \u002760baffd3f9042e38640f2300d5c5a631\u0027,\n                      \u0027aws_gd_region\u0027: \u0027us-west-2\u0027, \u0027aws_gd_detector_id\u0027: \u0027f2baedb0ac74f8f42fc929e15f56da6a\u0027},\n            \u0027metrics\u0027: {\u0027version\u0027: \u00271.0\u0027, \u0027package\u0027: \u0027fn-aws-guardduty\u0027, \u0027package_version\u0027: \u00271.0.0\u0027,\n                        \u0027host\u0027: \u0027Johnp-MacBook-Pro-2.galway.ie.ibm.com\u0027, \u0027execution_time_ms\u0027: 10739,\n                        \u0027timestamp\u0027: \u00272021-01-18 16:51:10\u0027}\n}\n\"\"\"\n#  Globals\n# List of fields in datatable for wf_aws_guardduty_refresh_finding script\nDATA_TABLES = [\"gd_action_details\", \"gd_resource_affected\",\"gd_finding_overview\"]\nFN_NAME = \"func_aws_guardduty_refresh_finding\"\nWF_NAME = \"Example: AWS GuardDuty: Refresh Finding\"\n# Resilient artifact names to api names.\nARTIFACT_API_TO_TYPE = {\n    \"aws_iam_access_key_id\": \"AWS IAM Access Key ID\",\n    \"aws_iam_user_name\": \"AWS IAM User Name\",\n    \"aws_s3_bucket_name\": \"AWS S3 Bucket Name\",\n    \"IP Address\": \"IP Address\",\n    \"DNS Name\": \"DNS Name\",\n    \"Port\": \"Port\"\n}\n\nCONTENT = playbook.functions.results.output\nQUERY_EXECUTION_DATE = playbook.functions.results.output[\"metrics\"][\"timestamp\"]\nif CONTENT:\n    FINDING = CONTENT.finding\n    PAYLOAD = CONTENT.payload\n    ARTIFACTS = CONTENT.artifacts\n    DATA_TABLES = CONTENT.data_tables\n\n# Processing\n\ndef main():\n    note_text = \u0027\u0027\n    if CONTENT:\n        note_text = \"AWS GuardDuty Integration: Workflow \u003cb\u003e{0}\u003c/b\u003e: Finding data returned for Resilient function \" \\\n                    \"\u003cb\u003e{2}\u003c/b\u003e\".format(WF_NAME, len(CONTENT), FN_NAME)\n\n        update_fields()\n        update_datatables()\n        if ARTIFACTS:\n            add_artifacts()\n    else:\n        note_text = \"AWS GuardDuty Integration: Workflow \u003cb\u003e{0}\u003c/b\u003e: No finding data returned for Resilient function \" \\\n                    \"\u003cb\u003e{2}\u003c/b\u003e\".format(WF_NAME, len(CONTENT), FN_NAME)\n\n    incident.addNote(helper.createRichText(note_text))\n\ndef update_fields():\n    incident.severity_code = PAYLOAD[\"severity_code\"]\n    incident.properties.aws_guardduty_finding_updated_at = PAYLOAD[\"properties\"][\"aws_guardduty_finding_updated_at\"]\n    incident.properties.aws_guardduty_count = str(PAYLOAD[\"properties\"][\"aws_guardduty_count\"])\n    incident.properties.aws_guardduty_archived = str(PAYLOAD[\"properties\"][\"aws_guardduty_archived\"])\n    incident.properties.aws_guardduty_severity = str(PAYLOAD[\"properties\"][\"aws_guardduty_severity\"])\n    incident.properties.aws_guardduty_finding_id = str(PAYLOAD[\"properties\"][\"aws_guardduty_finding_id\"])\n\ndef update_datatables():\n    for data_table in DATA_TABLES:\n        for row in DATA_TABLES[data_table]:\n            newrow = incident.addRow(data_table)\n            newrow.query_execution_date = QUERY_EXECUTION_DATE\n            data_table_fields = row[\"cells\"]\n            for f, v_info in data_table_fields.items():\n                newrow[f] = v_info.value\n\n\ndef add_artifacts():\n    for artifact in ARTIFACTS:\n        artifact_type = ARTIFACT_API_TO_TYPE[artifact[\"type\"][\"name\"]]\n        artifact_value = artifact[\"value\"]\n        description = artifact[\"description\"][\"content\"]\n        incident.addArtifact(artifact_type, artifact_value, description)\n\n\nif __name__ == \"__main__\":\n    main()\n",
          "tags": [],
          "uuid": "6b13da79-dd49-48b8-b511-588b0570d078"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_finding_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": []
      },
      "name": "example_aws_guardduty_refresh_finding_details_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_a99e9657-b10e-44e3-8558-e494fe2c9039",
        "id": 567,
        "name": "playbook_a99e9657_b10e_44e3_8558_e494fe2c9039",
        "type": "playbook",
        "uuid": "0b63830b-8a85-4ced-80a7-5c6e7990dcc1"
      },
      "tags": [],
      "type": "default",
      "uuid": "a99e9657-b10e-44e3-8558-e494fe2c9039",
      "version": 10
    },
    {
      "activation_details": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_finding_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_trigger_refresh",
              "method": "changed",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_trigger_refresh",
              "method": "equals",
              "type": null,
              "value": true
            }
          ],
          "logic_type": "all"
        }
      },
      "activation_type": "automatic",
      "content": {
        "content_version": 7,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29\" isExecutable=\"true\" name=\"playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1kqhenv\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Refresh Finding\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"2d1446f8-13fc-4400-af6a-c96b55d9a0df\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_finding_id = incident.properties.aws_guardduty_finding_id\\ninputs.incident_id = incident.id\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1kqhenv\u003c/incoming\u003e\u003coutgoing\u003eFlow_0cq2222\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1kqhenv\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Update Finding Details Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"7667b80e-9574-4ba3-82d6-08c86feb194d\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0cq2222\u003c/incoming\u003e\u003coutgoing\u003eFlow_0pa5lc0\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_0pa5lc0\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_0cq2222\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003csequenceFlow id=\"Flow_0pa5lc0\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0pa5lc0\" id=\"Flow_0pa5lc0_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"362\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"394\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0cq2222\" id=\"Flow_0cq2222_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"242\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"278\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1kqhenv\" id=\"Flow_1kqhenv_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"158\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"158\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"278\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.21875\" x=\"656\" y=\"394\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1750424887174,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29",
      "description": {
        "content": null,
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Update Finding Details (PB)",
      "export_key": "example_aws_guardduty_update_finding_details_pb",
      "field_type_handle": "playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Update Finding Details (PB)",
        "export_key": "playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29",
        "fields": {},
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29",
        "uuid": "41a9e2b5-8170-49ce-bf49-53dd6d588355"
      },
      "has_logical_errors": false,
      "id": 387,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602388254,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1750424887411,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Update Finding Details Post Script",
          "id": 390,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1750424887411,
          "name": "AWS GuardDuty: Update Finding Details Post Script",
          "object_type": "incident",
          "playbook_handle": "example_aws_guardduty_update_finding_details_pb",
          "programmatic_name": "example_aws_guardduty_update_finding_details_pb_aws_guardduty_refresh_finding_details_post_script",
          "script_text": "##  wf_aws_guardduty_refresh_finding ##\n# Example result:\n\"\"\"\nResult: { \u0027version\u0027: \u00271.0\u0027,\n          \u0027success\u0027: True,\n          \u0027reason\u0027: None,\n          \u0027content\u0027: {\u0027payload\u0027: {\u0027name\u0027: \u0027AWS GuardDuty: API GeneratedFindingAPIName was invoked from an IP address on a custom threat list.\u0027,\n                                  \u0027description\u0027: {\u0027format\u0027: \u0027text\u0027, \u0027content\u0027: \u0027An API was used to access a bucket from an IP address on a custom threat list.\u0027},\n                                  \u0027discovered_date\u0027: \u00272020-11-25T13:46:37.960Z\u0027,\n                                  \u0027severity_code\u0027: \u0027Low\u0027,\n                                  \u0027properties\u0027: {\u0027aws_guardduty_finding_id\u0027: \u002760baffd3f9042e38640f2300d5c5a631\u0027,\n                                                 \u0027aws_guardduty_finding_arn\u0027: \u0027arn:aws:guardduty:us-west-2:834299573936:detector/f2baedb0ac74f8f42fc929e15f56da6a/finding/60baffd3f9042e38640f2300d5c5a631\u0027,\n                                                 \u0027aws_guardduty_finding_type\u0027: \u0027UnauthorizedAccess:S3/MaliciousIPCaller.Custom\u0027,\n                                                 \u0027aws_guardduty_finding_updated_at\u0027: \u00272020-11-26T15:18:12.620Z\u0027, \u0027aws_guardduty_region\u0027: \u0027us-west-2\u0027,\n                                                 \u0027aws_guardduty_resource_type\u0027: \u0027S3Bucket\u0027, \u0027aws_guardduty_count\u0027: 4,\n                                                 \u0027aws_guardduty_detector_id\u0027: \u0027f2baedb0ac74f8f42fc929e15f56da6a\u0027},\n                                  \u0027artifacts\u0027: [],\n                                  \u0027comments\u0027: [{\u0027text\u0027: {\u0027format\u0027: \u0027text\u0027, \u0027content\u0027: \"AWS GuardDuty finding Payload:\\n\u003cFINDING_PAYLOAD_AS_STRING\u003e\"}}]\n\n                                 },\n                      \"data_tables\": {\"gd_action_details\": [{\"cells\": {\"action_type\": {\"value\": \"AWS_API_CALL\"},\n                                                             \"action_api\": {\"value\": \"GeneratedFindingAPIName\"},\n                                                             \"event_first_seen\": {\"value\": \"2020-11-25T13:46:37.960Z\"},\n                                                             \"event_last_seen\": {\"value\": \"2020-11-26T15:18:12.620Z\"},\n                                                            \"actor_caller_type\": {\"value\": \"Remote IP\"}, \"city_name\": {\"value\": \"GeneratedFindingCityName\"}, \"country_name\": {\"value\": \"GeneratedFindingCountryName\"}, \"asn\": {\"value\": \"-1\"}, \"asn_org\": {\"value\": \"GeneratedFindingASNOrg\"}, \"isp\": {\"value\": \"GeneratedFindingISP\"}, \"org\": {\"value\": \"GeneratedFindingORG\"}, \"action_service_name\": {\"value\": \"GeneratedFindingAPIServiceName\"}, \"remote_ip\": {\"value\": \"198.51.100.0\"}}}],\n                                     \"gd_resource_affected\": [{\"cells\": {\"resource_type\": {\"value\": \"S3Bucket\"}, \"instance_id\": {\"value\": \"i-99999999\"}, \"instance_type\": {\"value\": \"m3.xlarge\"}, \"instance_state\": {\"value\": \"running\"}, \"resource_role\": {\"value\": \"TARGET\"}, \"instance_private_ip\": {\"value\": \"10.0.0.1\"}, \"instance_private_dns\": {\"value\": \"GeneratedFindingPrivateName\"}, \"instance_public_ip\": {\"value\": \"198.51.100.0\"}, \"instance_public_dns\": {\"value\": \"GeneratedFindingPublicDNSName\"}, \"s3bucket_name\": {\"value\": \"bucketName\"}, \"s3bucket_owner\": {\"value\": \"CanonicalId of Owner\"}}}]\n\n                      }}\u0027,\n            \u0027inputs\u0027: {\u0027incident_id\u0027: 2168, \u0027aws_gd_finding_id\u0027: \u002760baffd3f9042e38640f2300d5c5a631\u0027,\n                       \u0027aws_gd_region\u0027: \u0027us-west-2\u0027, \u0027aws_gd_detector_id\u0027: \u0027f2baedb0ac74f8f42fc929e15f56da6a\u0027},\n            \u0027metrics\u0027: {\u0027version\u0027: \u00271.0\u0027, \u0027package\u0027: \u0027fn-aws-guardduty\u0027, \u0027package_version\u0027: \u00271.0.0\u0027,\n                        \u0027host\u0027: \u0027Johnp-MacBook-Pro-2.galway.ie.ibm.com\u0027, \u0027execution_time_ms\u0027: 10739,\n                        \u0027timestamp\u0027: \u00272021-01-18 16:51:10\u0027}\n}\n\"\"\"\n#  Globals\n# List of fields in datatable for wf_aws_guardduty_refresh_finding script\nDATA_TABLES = [\"gd_action_details\", \"gd_resource_affected\"]\nFN_NAME = \"func_aws_guardduty_refresh_finding\"\nWF_NAME = \"AWS GuardDuty: Refresh Finding\"\n# Resilient artifact names to api names.\nARTIFACT_API_TO_TYPE = {\n    \"aws_iam_access_key_id\": \"AWS IAM Access Key ID\",\n    \"aws_iam_user_name\": \"AWS IAM User Name\",\n    \"aws_s3_bucket_name\": \"AWS S3 Bucket Name\",\n    \"IP Address\": \"IP Address\",\n    \"DNS Name\": \"DNS Name\",\n    \"Port\": \"Port\"\n}\nCONTENT = playbook.functions.results.output.output.get(\"content\", {})\nQUERY_EXECUTION_DATE = playbook.functions.results.output[\"metrics\"][\"timestamp\"]\nif CONTENT:\n    FINDING = CONTENT.finding\n    PAYLOAD = CONTENT.payload\n    ARTIFACTS = PAYLOAD.artifacts\n    DATA_TABLES = CONTENT.data_tables\n\n# Processing\ndef main():\n    note_text = \u0027\u0027\n    if CONTENT:\n        note_text = \"AWS GuardDuty: Playbook: \u003cb\u003e{0}\u003c/b\u003e\u003cbr\u003eFindings returned for SOAR function \" \\\n                    \"\u003cb\u003e{1}\u003c/b\u003e\".format(WF_NAME, FN_NAME)\n\n        update_fields()\n        update_datatables()\n        if ARTIFACTS:\n            add_artifacts()\n    else:\n        note_text = \"AWS GuardDuty: Playbook: \u003cb\u003e{0}\u003c/b\u003e\u003cbr\u003eNo finding data returned for SOAR function \" \\\n                    \"\u003cb\u003e{1}\u003c/b\u003e\".format(WF_NAME, FN_NAME)\n\n    incident.addNote(helper.createRichText(note_text))\n\ndef update_fields():\n    incident.severity_code = PAYLOAD[\"severity_code\"]\n    incident.properties.aws_guardduty_finding_updated_at = PAYLOAD[\"properties\"][\"aws_guardduty_finding_updated_at\"]\n    incident.properties.aws_guardduty_count = str(PAYLOAD[\"properties\"][\"aws_guardduty_count\"])\n    incident.properties.aws_guardduty_archived = str(PAYLOAD[\"properties\"][\"aws_guardduty_archived\"])\n    incident.properties.aws_guardduty_severity = str(PAYLOAD[\"properties\"][\"aws_guardduty_severity\"])\n    incident.properties.aws_guardduty_finding_id = str(PAYLOAD[\"properties\"][\"aws_guardduty_finding_id\"])\n\ndef update_datatables():\n    for data_table in DATA_TABLES:\n        for row in DATA_TABLES[data_table]:\n            newrow = incident.addRow(data_table)\n            newrow.query_execution_date = QUERY_EXECUTION_DATE\n            data_table_fields = row[\"cells\"]\n            for f, v_info in data_table_fields.items():\n                newrow[f] = v_info.value\n\n\ndef add_artifacts():\n    for artifact in ARTIFACTS:\n        artifact_type = ARTIFACT_API_TO_TYPE[artifact[\"type\"][\"name\"]]\n        artifact_value = artifact[\"value\"]\n        description = artifact[\"description\"][\"content\"]\n        incident.addArtifact(artifact_type, artifact_value, description)\n\n\nif __name__ == \"__main__\":\n    main()\n",
          "tags": [],
          "uuid": "7667b80e-9574-4ba3-82d6-08c86feb194d"
        }
      ],
      "name": "example_aws_guardduty_update_finding_details_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_db21b0b4-697b-40c0-bb9a-47615ce77f29",
        "id": 568,
        "name": "playbook_db21b0b4_697b_40c0_bb9a_47615ce77f29",
        "type": "playbook",
        "uuid": "148b36d1-9dd3-47ba-9a0e-2a8fdcd41bdc"
      },
      "tags": [],
      "type": "default",
      "uuid": "db21b0b4-697b-40c0-bb9a-47615ce77f29",
      "version": 10
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 11,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5\" isExecutable=\"true\" name=\"playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_07ujvtc\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Update IPSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"5d2e39f6-336f-403d-890f-f42a5daf56f9\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_ip_set_id = playbook.inputs.aws_gd_ip_set_id\\ninputs.aws_gd_new_name = playbook.inputs.aws_gd_new_name\\ninputs.aws_gd_new_location = playbook.inputs.aws_gd_new_location\\ninputs.aws_gd_new_activate = playbook.inputs.aws_gd_new_activate\\ninputs.aws_gd_bucket_owner = playbook.inputs.aws_gd_bucket_owner\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_07ujvtc\u003c/incoming\u003e\u003coutgoing\u003eFlow_0srktlc\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_07ujvtc\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Update IPSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"b8641e61-4e41-4598-aa99-d884c768ee8a\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_0srktlc\u003c/incoming\u003e\u003coutgoing\u003eFlow_1r1c9bx\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_0srktlc\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_1r1c9bx\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_1r1c9bx\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1r1c9bx\" id=\"Flow_1r1c9bx_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"492\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"594\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_0srktlc\" id=\"Flow_0srktlc_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"312\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"408\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_07ujvtc\" id=\"Flow_07ujvtc_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"228\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"228\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"408\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"594\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1753369961754,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
      "description": {
        "content": "SOAR function to update an existing ip set on AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Update IPSet (PB)",
      "export_key": "aws_guardduty_update_ipset_pb",
      "field_type_handle": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Update IPSet (PB)",
        "export_key": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
        "fields": {
          "aws_gd_bucket_owner": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5/aws_gd_bucket_owner",
            "hide_notification": false,
            "id": 5800,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_bucket_owner",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Bucket Owner",
            "tooltip": "Account linked to S3 bucket whose location is specified in the File Path",
            "type_id": 1561,
            "uuid": "45650be3-444d-4720-b24d-946592e45669",
            "values": []
          },
          "aws_gd_ip_set_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5/aws_gd_ip_set_id",
            "hide_notification": false,
            "id": 5801,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_ip_set_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "IP Set Id",
            "tooltip": "The unique id associated with a IP Set",
            "type_id": 1561,
            "uuid": "e2dbd52d-114c-4943-b630-8cd9ac29a353",
            "values": []
          },
          "aws_gd_new_activate": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5/aws_gd_new_activate",
            "hide_notification": false,
            "id": 5802,
            "input_type": "boolean",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_new_activate",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Activation",
            "tooltip": "Should the GuardDuty use this IP Set",
            "type_id": 1561,
            "uuid": "a260a1e7-7f83-4d61-9cc6-e4bc38bdc2fb",
            "values": []
          },
          "aws_gd_new_location": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5/aws_gd_new_location",
            "hide_notification": false,
            "id": 5805,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_new_location",
            "operation_perms": {},
            "operations": [],
            "placeholder": "https://s3.amazonaws.com/bucket-name/file.txt",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "File Path",
            "tooltip": "New path of the file which has the trusted IP Addresses",
            "type_id": 1561,
            "uuid": "b7695902-3b42-4be7-aa60-20db9ed97776",
            "values": []
          },
          "aws_gd_new_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5/aws_gd_new_name",
            "hide_notification": false,
            "id": 5803,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_new_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Ip Set Name",
            "tooltip": "New name that needs to be updated for the IP Set",
            "type_id": 1561,
            "uuid": "5ccb7e45-6367-420d-82ab-ef546dee57c2",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
        "uuid": "d8bf9dbd-9c00-42f8-b755-27c0cee5ff5f"
      },
      "has_logical_errors": false,
      "id": 449,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602576238,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1753370738681,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Update IPSet Post Script",
          "id": 437,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755256856280,
          "name": "AWS GuardDuty: Update IPSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_update_ipset_pb",
          "programmatic_name": "aws_guardduty_update_ipset_pb_aws_guardduty_update_ipset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty Update IPset\n\nFN_NAME = \"aws_guardduty_update_ipset\"\nWF_NAME = \"AWS GuardDuty: Update IPSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content.status != \u0027error\u0027 and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    response_status = response_body.get(\"status\")\n    note_text += f\"\u003cb\u003eStatus of request:\u003c/b\u003e {response_status}\u003cbr\u003e\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027content\u0027).get(\u0027msg\u0027)}\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "b8641e61-4e41-4598-aa99-d884c768ee8a"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "5ccb7e45-6367-420d-82ab-ef546dee57c2",
            "element": "field_uuid",
            "field_type": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a260a1e7-7f83-4d61-9cc6-e4bc38bdc2fb",
            "element": "field_uuid",
            "field_type": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "e2dbd52d-114c-4943-b630-8cd9ac29a353",
            "element": "field_uuid",
            "field_type": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "45650be3-444d-4720-b24d-946592e45669",
            "element": "field_uuid",
            "field_type": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "b7695902-3b42-4be7-aa60-20db9ed97776",
            "element": "field_uuid",
            "field_type": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_update_ipset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_689c987f-44c9-49a7-a57d-6adce1fd57e5",
        "id": 641,
        "name": "playbook_689c987f_44c9_49a7_a57d_6adce1fd57e5",
        "type": "playbook",
        "uuid": "f0f229a4-c8f3-475e-95d2-3e507f19594d"
      },
      "tags": [],
      "type": "default",
      "uuid": "689c987f-44c9-49a7-a57d-6adce1fd57e5",
      "version": 16
    },
    {
      "activation_type": "manual",
      "content": {
        "content_version": 18,
        "xml": "\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\u003cdefinitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"\u003e\u003cprocess id=\"playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21\" isExecutable=\"true\" name=\"playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21\"\u003e\u003cdocumentation/\u003e\u003cstartEvent id=\"StartEvent_155asxm\"\u003e\u003coutgoing\u003eFlow_1x7cttn\u003c/outgoing\u003e\u003c/startEvent\u003e\u003cserviceTask id=\"ServiceTask_1\" name=\"AWS GuardDuty: Update ThreatIntelSet\" resilient:type=\"function\"\u003e\u003cextensionElements\u003e\u003cresilient:function uuid=\"e8ea199c-cc4d-446b-858a-b484d46a6b04\"\u003e{\"inputs\":{},\"pre_processing_script\":\"inputs.aws_gd_region = incident.properties.aws_guardduty_region\\ninputs.aws_gd_detector_id = incident.properties.aws_guardduty_detector_id\\ninputs.aws_gd_threat_intel_set_id = playbook.inputs.aws_gd_threat_intel_set_id\\ninputs.aws_gd_new_name = playbook.inputs.aws_gd_new_name\\ninputs.aws_gd_new_location = playbook.inputs.aws_gd_new_location\\ninputs.aws_gd_new_activate = playbook.inputs.aws_gd_new_activate\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"response_output\"}\u003c/resilient:function\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_1x7cttn\u003c/incoming\u003e\u003coutgoing\u003eFlow_17htaav\u003c/outgoing\u003e\u003c/serviceTask\u003e\u003csequenceFlow id=\"Flow_1x7cttn\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/\u003e\u003cscriptTask id=\"ScriptTask_2\" name=\"AWS GuardDuty: Update ThreatIntelSet Post Script\"\u003e\u003cextensionElements\u003e\u003cresilient:script uuid=\"d1d71741-1f40-4d44-ad4f-9ea8494af111\"/\u003e\u003c/extensionElements\u003e\u003cincoming\u003eFlow_17htaav\u003c/incoming\u003e\u003coutgoing\u003eFlow_03i7w42\u003c/outgoing\u003e\u003cscript\u003escript\u003c/script\u003e\u003c/scriptTask\u003e\u003csequenceFlow id=\"Flow_17htaav\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/\u003e\u003cendEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"\u003e\u003cincoming\u003eFlow_03i7w42\u003c/incoming\u003e\u003c/endEvent\u003e\u003csequenceFlow id=\"Flow_03i7w42\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/\u003e\u003c/process\u003e\u003cbpmndi:BPMNDiagram id=\"BPMNDiagram_1\"\u003e\u003cbpmndi:BPMNPlane bpmnElement=\"playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21\" id=\"BPMNPlane_1\"\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_03i7w42\" id=\"Flow_03i7w42_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"452\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"524\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_17htaav\" id=\"Flow_17htaav_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"282\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"368\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNEdge bpmnElement=\"Flow_1x7cttn\" id=\"Flow_1x7cttn_di\"\u003e\u003comgdi:waypoint x=\"722\" y=\"117\"/\u003e\u003comgdi:waypoint x=\"722\" y=\"198\"/\u003e\u003c/bpmndi:BPMNEdge\u003e\u003cbpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"187.188\" x=\"628\" y=\"65\"/\u003e\u003cbpmndi:BPMNLabel\u003e\u003comgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/\u003e\u003c/bpmndi:BPMNLabel\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"198\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"\u003e\u003comgdc:Bounds height=\"84\" width=\"196\" x=\"624\" y=\"368\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003cbpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"\u003e\u003comgdc:Bounds height=\"52\" width=\"132.2188\" x=\"656\" y=\"524\"/\u003e\u003c/bpmndi:BPMNShape\u003e\u003c/bpmndi:BPMNPlane\u003e\u003c/bpmndi:BPMNDiagram\u003e\u003c/definitions\u003e"
      },
      "create_date": 1752595512139,
      "creator_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "deployment_id": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
      "description": {
        "content": "SOAR function to update an existing threat intel set on AWS GuardDuty.",
        "format": "text"
      },
      "display_name": "AWS GuardDuty: Update ThreatIntelSet (PB)",
      "export_key": "aws_guardduty_update_threatintelset_pb",
      "field_type_handle": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
      "fields_type": {
        "actions": [],
        "display_name": "AWS GuardDuty: Update ThreatIntelSet (PB)",
        "export_key": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
        "fields": {
          "aws_gd_new_activate": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21/aws_gd_new_activate",
            "hide_notification": false,
            "id": 5781,
            "input_type": "boolean",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_new_activate",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Activation",
            "tooltip": "Should the GuardDuty use this Threat Intel Set",
            "type_id": 1553,
            "uuid": "69ae291e-86c3-4dd4-a158-7a54ed52145b",
            "values": []
          },
          "aws_gd_new_location": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21/aws_gd_new_location",
            "hide_notification": false,
            "id": 5782,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_new_location",
            "operation_perms": {},
            "operations": [],
            "placeholder": "https://s3.amazonaws.com/bucket-name/file.txt",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "File Path",
            "tooltip": "New path of the file which has the malicious IP Addresses",
            "type_id": 1553,
            "uuid": "441eff2a-a434-4c60-9285-7364a609a8c6",
            "values": []
          },
          "aws_gd_new_name": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21/aws_gd_new_name",
            "hide_notification": false,
            "id": 5783,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_new_name",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Threat Intel Set Name",
            "tooltip": "New name that should be displayed in all findings which are associated with this Threat Intel Set",
            "type_id": 1553,
            "uuid": "54c19bf5-9332-435e-bba7-9f47858ad21a",
            "values": []
          },
          "aws_gd_threat_intel_set_id": {
            "allow_default_value": false,
            "blank_option": false,
            "calculated": false,
            "changeable": true,
            "chosen": false,
            "default_chosen_by_server": false,
            "deprecated": false,
            "export_key": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21/aws_gd_threat_intel_set_id",
            "hide_notification": false,
            "id": 5784,
            "input_type": "text",
            "internal": false,
            "is_tracked": false,
            "name": "aws_gd_threat_intel_set_id",
            "operation_perms": {},
            "operations": [],
            "placeholder": "",
            "prefix": null,
            "read_only": false,
            "required": "always",
            "rich_text": false,
            "tags": [],
            "templates": [],
            "text": "Threat Intel Set Id",
            "tooltip": "The unique id associated with a Threat Intel Set",
            "type_id": 1553,
            "uuid": "a66fc7f0-43a5-42d9-b82d-5e369ee2cd1a",
            "values": []
          }
        },
        "for_actions": false,
        "for_custom_fields": false,
        "for_notifications": false,
        "for_workflows": false,
        "id": null,
        "parent_types": [
          "__playbook"
        ],
        "properties": {
          "can_create": false,
          "can_destroy": false,
          "for_who": []
        },
        "scripts": [],
        "tags": [],
        "type_id": 28,
        "type_name": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
        "uuid": "154bb676-c23d-4541-a748-abad9aba0a5f"
      },
      "has_logical_errors": false,
      "id": 441,
      "is_deleted": false,
      "is_locked": false,
      "last_modified_principal": {
        "display_name": "Resilient Sysadmin",
        "id": 39,
        "name": "shresh@example.com",
        "type": "user"
      },
      "last_modified_time": 1755602536600,
      "local_scripts": [
        {
          "actions": [],
          "created_date": 1752596457196,
          "description": "",
          "enabled": false,
          "export_key": "AWS GuardDuty: Update ThreatIntelSet Post Script",
          "id": 429,
          "language": "python3",
          "last_modified_by": "shresh@example.com",
          "last_modified_time": 1755256775819,
          "name": "AWS GuardDuty: Update ThreatIntelSet Post Script",
          "object_type": "incident",
          "playbook_handle": "aws_guardduty_update_threatintelset_pb",
          "programmatic_name": "aws_guardduty_update_threatintelset_pb_aws_guardduty_update_threatintelset_post_script",
          "script_text": "#This is a Post-Processing Script for AWS GuardDuty Update ThreatIntelset\n\nFN_NAME = \"aws_guardduty_update_threatintelset\"\nWF_NAME = \"AWS GuardDuty: Update ThreatIntelSet\"\n\nresults = playbook.functions.results.response_output\n\nnote_text = f\"Action ran for AWS Region: \u003cb\u003e{incident.properties.aws_guardduty_region}\u003c/b\u003e\u003cbr\u003e\"\n\nif results.content.status != \u0027error\u0027 and results.success:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eSuccessfully executed for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.content:\n    response_body = results.get(\"content\")\n    response_status = response_body.get(\"status\")\n    note_text += f\"\u003cb\u003eStatus of request:\u003c/b\u003e {response_status}\u003cbr\u003e\"\nelse:\n  note_text += f\"AWS GuardDuty: Playbook: \u003cb\u003e{WF_NAME}\u003c/b\u003e\u003cbr\u003eExecution error for SOAR function \u003cb\u003e{FN_NAME}\u003c/b\u003e\u003cbr\u003e\"\n  if results.reason is None:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027content\u0027).get(\u0027msg\u0027)}\"\n  else:\n    note_text += f\"\u003cb\u003eReason:\u003c/b\u003e {results.get(\u0027reason\u0027)}\"\nincident.addNote(helper.createRichText(note_text))",
          "tags": [],
          "uuid": "d1d71741-1f40-4d44-ad4f-9ea8494af111"
        }
      ],
      "manual_settings": {
        "activation_conditions": {
          "conditions": [
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_detector_id",
              "method": "has_a_value",
              "type": null,
              "value": null
            },
            {
              "evaluation_id": null,
              "field_name": "incident.properties.aws_guardduty_region",
              "method": "has_a_value",
              "type": null,
              "value": null
            }
          ],
          "logic_type": "all"
        },
        "view_items": [
          {
            "content": "\u003cp\u003eYou are running this action for \u003cb\u003eAWS region\u003c/b\u003e specified in the AWS incident generated by the poller\u003c/p\u003e",
            "element": "html",
            "field_type": null,
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "54c19bf5-9332-435e-bba7-9f47858ad21a",
            "element": "field_uuid",
            "field_type": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "441eff2a-a434-4c60-9285-7364a609a8c6",
            "element": "field_uuid",
            "field_type": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "69ae291e-86c3-4dd4-a158-7a54ed52145b",
            "element": "field_uuid",
            "field_type": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          },
          {
            "content": "a66fc7f0-43a5-42d9-b82d-5e369ee2cd1a",
            "element": "field_uuid",
            "field_type": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
            "show_if": null,
            "show_link_header": false,
            "step_label": null
          }
        ]
      },
      "name": "aws_guardduty_update_threatintelset_pb",
      "object_type": "incident",
      "status": "enabled",
      "tag": {
        "display_name": "Playbook_04c4dbab-92bd-4eba-9e14-689acc6f5d21",
        "id": 633,
        "name": "playbook_04c4dbab_92bd_4eba_9e14_689acc6f5d21",
        "type": "playbook",
        "uuid": "963117be-4ba4-4a50-9dce-7108bad428bc"
      },
      "tags": [],
      "type": "default",
      "uuid": "04c4dbab-92bd-4eba-9e14-689acc6f5d21",
      "version": 22
    }
  ],
  "regulators": null,
  "roles": [],
  "scripts": [],
  "server_version": {
    "build_number": 9339,
    "f": 0,
    "m": 0,
    "major": 0,
    "minor": 0,
    "r": 0,
    "v": 51,
    "version": "51.0.0.0.9339"
  },
  "tags": [],
  "task_order": [],
  "timeframes": null,
  "types": [
    {
      "actions": [],
      "display_name": "GuardDuty Resource - Access Key Details",
      "export_key": "gd_access_key_details",
      "fields": {
        "access_key_id": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_access_key_details/access_key_id",
          "hide_notification": false,
          "id": 5438,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "access_key_id",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Access key ID",
          "tooltip": "",
          "type_id": 1488,
          "uuid": "b27dad20-dacc-44a1-8f30-9b212914b79f",
          "values": [],
          "width": 132
        },
        "principal_id": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_access_key_details/principal_id",
          "hide_notification": false,
          "id": 5439,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "principal_id",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Principal ID",
          "tooltip": "",
          "type_id": 1488,
          "uuid": "60b722d7-f071-4c21-a3f2-f1353a18bb91",
          "values": [],
          "width": 114
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_access_key_details/query_execution_date",
          "hide_notification": false,
          "id": 5440,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query Execution date",
          "tooltip": "",
          "type_id": 1488,
          "uuid": "a5903a18-b86b-41cc-bfd7-d3ba9e6e2270",
          "values": [],
          "width": 199
        },
        "user_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_access_key_details/user_name",
          "hide_notification": false,
          "id": 5441,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "user_name",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "User name",
          "tooltip": "",
          "type_id": 1488,
          "uuid": "3cd04b96-5a00-4a9b-9be4-7a2f8a9cd950",
          "values": [],
          "width": 104
        },
        "user_type": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_access_key_details/user_type",
          "hide_notification": false,
          "id": 5442,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "user_type",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "User type",
          "tooltip": "",
          "type_id": 1488,
          "uuid": "7df25967-de3a-4324-8afd-b1197ff4e63e",
          "values": [],
          "width": 95
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_access_key_details",
      "uuid": "9c33b5ca-a3fa-4d8d-8609-e337373279f4"
    },
    {
      "actions": [],
      "display_name": "GuardDuty Action/Actor Details",
      "export_key": "gd_action_details",
      "fields": {
        "action_api": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/action_api",
          "hide_notification": false,
          "id": 5443,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "action_api",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Action api",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "f1be8138-1a2b-4458-b648-8ea44bd26713",
          "values": [],
          "width": 69
        },
        "action_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/action_type",
          "hide_notification": false,
          "id": 5444,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "action_type",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Action type",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "71698e3e-e588-49c6-b7f2-91af22412140",
          "values": [],
          "width": 77
        },
        "actor_caller_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/actor_caller_type",
          "hide_notification": false,
          "id": 5445,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "actor_caller_type",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Actor caller type",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "32323b4c-f368-4c88-bbfe-3606cd04eb9d",
          "values": [],
          "width": 112
        },
        "asn": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/asn",
          "hide_notification": false,
          "id": 5446,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "asn",
          "operation_perms": {},
          "operations": [],
          "order": 18,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Asn",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "02e84510-244e-443f-bdce-ddb364ee6d7c",
          "values": [],
          "width": 25
        },
        "asn_org": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/asn_org",
          "hide_notification": false,
          "id": 5447,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "asn_org",
          "operation_perms": {},
          "operations": [],
          "order": 15,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Finding asn org",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "2647e26a-3241-49a5-b85e-7da32e5578b6",
          "values": [],
          "width": 51
        },
        "city_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/city_name",
          "hide_notification": false,
          "id": 5448,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "city_name",
          "operation_perms": {},
          "operations": [],
          "order": 16,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "City name",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "836614f1-62ab-48a7-990a-fc9d557a15b0",
          "values": [],
          "width": 67
        },
        "connection_direction": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/connection_direction",
          "hide_notification": false,
          "id": 5449,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "connection_direction",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Connection direction",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "a0a63bea-02c8-48cc-9b68-c195bd5f8854",
          "values": [],
          "width": 76
        },
        "country_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/country_name",
          "hide_notification": false,
          "id": 5450,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "country_name",
          "operation_perms": {},
          "operations": [],
          "order": 17,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Country",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "eb19d165-6679-4761-813f-6ee810099d45",
          "values": [],
          "width": 94
        },
        "dns_blocked": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/dns_blocked",
          "hide_notification": false,
          "id": 5451,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "dns_blocked",
          "operation_perms": {},
          "operations": [],
          "order": 14,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "DNS request blocked",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "9c7f5f14-3d52-4337-9ab4-72477308c024",
          "values": [],
          "width": 53
        },
        "dns_domain_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/dns_domain_name",
          "hide_notification": false,
          "id": 5452,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "dns_domain_name",
          "operation_perms": {},
          "operations": [],
          "order": 13,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "DNS domain name",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "7f392168-f15d-489e-9c3b-163c3836111e",
          "values": [],
          "width": 50
        },
        "event_first_seen": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/event_first_seen",
          "hide_notification": false,
          "id": 5453,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "event_first_seen",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Event first Seen",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "09a9027f-ee68-4e92-bb8c-bbf0d89a4719",
          "values": [],
          "width": 38
        },
        "event_last_seen": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/event_last_seen",
          "hide_notification": false,
          "id": 5454,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "event_last_seen",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Event Last Seen",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "d9c15e25-0920-4c6b-bf2c-322b0314f2dd",
          "values": [],
          "width": 38
        },
        "isp": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/isp",
          "hide_notification": false,
          "id": 5455,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "isp",
          "operation_perms": {},
          "operations": [],
          "order": 19,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Finding isp",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "ec7698cf-30e5-4cc3-af24-24533035e224",
          "values": [],
          "width": 50
        },
        "local_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/local_ip",
          "hide_notification": false,
          "id": 5456,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "local_ip",
          "operation_perms": {},
          "operations": [],
          "order": 9,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Local IP address",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "4734c0dd-6c93-483e-9875-0fbc8b76a8b9",
          "values": [],
          "width": 53
        },
        "local_port": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/local_port",
          "hide_notification": false,
          "id": 5457,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "local_port",
          "operation_perms": {},
          "operations": [],
          "order": 10,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Local port",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "d4b0ffc2-f20c-4ca6-9c58-ab947552234d",
          "values": [],
          "width": 35
        },
        "org": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/org",
          "hide_notification": false,
          "id": 5458,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "org",
          "operation_perms": {},
          "operations": [],
          "order": 20,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Finding org",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "059db373-635b-4afd-9ffa-9580b7dab2f9",
          "values": [],
          "width": 50
        },
        "protocol": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/protocol",
          "hide_notification": false,
          "id": 5459,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "protocol",
          "operation_perms": {},
          "operations": [],
          "order": 12,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Protocol",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "d366e76b-cd33-47b8-829f-bc08594371f5",
          "values": [],
          "width": 56
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/query_execution_date",
          "hide_notification": false,
          "id": 5460,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query Execution date",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "7e199cfc-4d0d-4efc-897b-4de690071d22",
          "values": [],
          "width": 66
        },
        "remote_ip": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/remote_ip",
          "hide_notification": false,
          "id": 5461,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "remote_ip",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Remote IP address",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "55a83144-7056-42e8-8385-84a05b9eb949",
          "values": [],
          "width": 134
        },
        "remote_port": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/remote_port",
          "hide_notification": false,
          "id": 5462,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "remote_port",
          "operation_perms": {},
          "operations": [],
          "order": 11,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Remote port",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "1455bed3-ae3e-4bc8-87da-656f87f53c13",
          "values": [],
          "width": 51
        },
        "service_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_action_details/service_name",
          "hide_notification": false,
          "id": 5463,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "service_name",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Service name",
          "tooltip": "",
          "type_id": 1489,
          "uuid": "58db2789-f873-44e8-a9b9-e69099f0803a",
          "values": [],
          "width": 139
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_action_details",
      "uuid": "883bd79f-a9e2-4544-b5bd-cf866725d42c"
    },
    {
      "actions": [],
      "display_name": "GuardDuty Finding Overview",
      "export_key": "gd_finding_overview",
      "fields": {
        "account_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/account_id",
          "hide_notification": false,
          "id": 5464,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "account_id",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Account ID",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "15334021-e452-44a6-9662-c7c877463f5a",
          "values": [],
          "width": 85
        },
        "count": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/count",
          "hide_notification": false,
          "id": 5465,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "count",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Count",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "12a837a0-b7bf-44c2-b75c-30f5a26ef0bb",
          "values": [],
          "width": 57
        },
        "created_at": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/created_at",
          "hide_notification": false,
          "id": 5466,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "created_at",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Created at",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "54643cce-7c5e-4cf4-86ca-0cef9b80aab3",
          "values": [],
          "width": 80
        },
        "finding_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/finding_id",
          "hide_notification": false,
          "id": 5467,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "finding_id",
          "operation_perms": {},
          "operations": [],
          "order": 8,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Finding ID",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "ca180769-c5ad-4fa7-a576-16dd12e1f586",
          "values": [],
          "width": 79
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/query_execution_date",
          "hide_notification": false,
          "id": 5468,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Query Execution date",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "8a7df4b7-eb1a-4e5d-8b66-a3b3093318d4",
          "values": [],
          "width": 164
        },
        "region": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/region",
          "hide_notification": false,
          "id": 5469,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "region",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Region",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "6cc4c558-88b6-4a01-88aa-8f5b570989c7",
          "values": [],
          "width": 59
        },
        "resource_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/resource_id",
          "hide_notification": false,
          "id": 5470,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "resource_id",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Resource ID",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "839c7996-d8d4-406f-a176-f0d985e18141",
          "values": [],
          "width": 93
        },
        "severity": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/severity",
          "hide_notification": false,
          "id": 5471,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "severity",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Severity",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "75282f43-6caf-44db-b9eb-8773cc8b2e4b",
          "values": [],
          "width": 63
        },
        "updated_at": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_finding_overview/updated_at",
          "hide_notification": false,
          "id": 5472,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "updated_at",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "short_text": "",
          "tags": [],
          "templates": [],
          "text": "Updated at",
          "tooltip": "",
          "type_id": 1490,
          "uuid": "d1009026-3194-41d9-a6bd-8e518535401a",
          "values": [],
          "width": 84
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_finding_overview",
      "uuid": "4cfac58d-2303-4726-9378-adb0bf4e81cb"
    },
    {
      "actions": [],
      "display_name": "GuardDuty Resource - Instance Details",
      "export_key": "gd_instance_details",
      "fields": {
        "instance_id": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/instance_id",
          "hide_notification": false,
          "id": 5473,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_id",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "ID",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "a1b947dd-72f2-4235-b1b2-883f128b3366",
          "values": [],
          "width": 87
        },
        "instance_state": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/instance_state",
          "hide_notification": false,
          "id": 5474,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_state",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "State",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "b00c52eb-e7e1-4578-a683-8a2387b8131d",
          "values": [],
          "width": 106
        },
        "private_dns_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/private_dns_name",
          "hide_notification": false,
          "id": 5475,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "private_dns_name",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Private dns name",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "7ec6545a-02fc-45da-b878-97f6a33a9e05",
          "values": [],
          "width": 48
        },
        "private_ip": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/private_ip",
          "hide_notification": false,
          "id": 5476,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "private_ip",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Private ip address",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "c6e5a1a9-ceb6-4872-a36a-87e38a7e85c6",
          "values": [],
          "width": 199
        },
        "public_dns_name": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/public_dns_name",
          "hide_notification": false,
          "id": 5477,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "public_dns_name",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Public dns name",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "2beb8aeb-4878-4e63-9c33-3d9ba845efc5",
          "values": [],
          "width": 42
        },
        "public_ip": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/public_ip",
          "hide_notification": false,
          "id": 5478,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "public_ip",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Public ip address",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "6f078d4e-74d6-437b-8c8b-6f1e9826c7a7",
          "values": [],
          "width": 53
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/query_execution_date",
          "hide_notification": false,
          "id": 5479,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query execution date",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "6a836888-0e24-4a41-9026-3a35e6c43b74",
          "values": [],
          "width": 156
        },
        "type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_instance_details/type",
          "hide_notification": false,
          "id": 5480,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "type",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Type",
          "tooltip": "",
          "type_id": 1491,
          "uuid": "98475689-2714-48e2-b5f8-d4b0e01e8870",
          "values": [],
          "width": 102
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_instance_details",
      "uuid": "9ace7caf-f184-40a8-bc91-7fd421fe3280"
    },
    {
      "actions": [],
      "display_name": "GuardDuty Resource Affected",
      "export_key": "gd_resource_affected",
      "fields": {
        "instance_id": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_id",
          "hide_notification": false,
          "id": 5481,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_id",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance ID",
          "tooltip": "",
          "type_id": 1492,
          "uuid": "28e8cd5f-c497-4ab4-a0c9-38183628a5ec",
          "values": [],
          "width": 110
        },
        "instance_type": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/instance_type",
          "hide_notification": false,
          "id": 5482,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "instance_type",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Instance type",
          "tooltip": "",
          "type_id": 1492,
          "uuid": "2c108511-9154-4704-9da5-ca2845e297a1",
          "values": [],
          "width": 132
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/query_execution_date",
          "hide_notification": false,
          "id": 5483,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query execution date",
          "tooltip": "",
          "type_id": 1492,
          "uuid": "4044d357-4e24-47c3-9ede-eb55bdfe2271",
          "values": [],
          "width": 65
        },
        "resource_role": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/resource_role",
          "hide_notification": false,
          "id": 5484,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "resource_role",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Resource role",
          "tooltip": "",
          "type_id": 1492,
          "uuid": "c03b7250-29a4-4f47-a4f3-4bcac4c662ef",
          "values": [],
          "width": 130
        },
        "resource_type": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_resource_affected/resource_type",
          "hide_notification": false,
          "id": 5485,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "resource_type",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Resource type",
          "tooltip": "",
          "type_id": 1492,
          "uuid": "df53ffe5-968d-4f95-a2c8-038271420ee8",
          "values": [],
          "width": 133
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_resource_affected",
      "uuid": "b2462a6f-8b07-4702-8943-e0df9213c349"
    },
    {
      "actions": [],
      "display_name": "GuardDuty Resource - S3 Bucket Details",
      "export_key": "gd_s3_bucket_details",
      "fields": {
        "bucket_arn": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/bucket_arn",
          "hide_notification": false,
          "id": 5486,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "bucket_arn",
          "operation_perms": {},
          "operations": [],
          "order": 3,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Bucket Arn",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "358718e0-ba9a-4530-8569-ba55c994d8d6",
          "values": [],
          "width": 64
        },
        "bucket_name": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/bucket_name",
          "hide_notification": false,
          "id": 5487,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "bucket_name",
          "operation_perms": {},
          "operations": [],
          "order": 1,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Bucket name",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "53120c05-d2bf-4d6f-a74f-a5c990d947ef",
          "values": [],
          "width": 72
        },
        "bucket_owner": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/bucket_owner",
          "hide_notification": false,
          "id": 5488,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "bucket_owner",
          "operation_perms": {},
          "operations": [],
          "order": 4,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Bucket owner",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "91b04ad5-1fa8-4dc0-bd3b-cd2f0a2ce100",
          "values": [],
          "width": 76
        },
        "bucket_type": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/bucket_type",
          "hide_notification": false,
          "id": 5489,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "bucket_type",
          "operation_perms": {},
          "operations": [],
          "order": 2,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Bucket Type",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "1f4de505-a95e-4385-90f9-66bd2cb55dd6",
          "values": [],
          "width": 69
        },
        "effective_permissions": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/effective_permissions",
          "hide_notification": false,
          "id": 5490,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "effective_permissions",
          "operation_perms": {},
          "operations": [],
          "order": 7,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Effective Permission",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "2053ab7c-40bf-4b34-803e-b67139d212c4",
          "values": [],
          "width": 74
        },
        "encryption_type": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/encryption_type",
          "hide_notification": false,
          "id": 5491,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "encryption_type",
          "operation_perms": {},
          "operations": [],
          "order": 6,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Encryption type",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "301a2f73-f969-4638-a5a1-eaecfec590dd",
          "values": [],
          "width": 94
        },
        "kms_master_key_arn": {
          "allow_default_value": false,
          "blank_option": false,
          "calculated": false,
          "changeable": true,
          "chosen": false,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/kms_master_key_arn",
          "hide_notification": false,
          "id": 5492,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "kms_master_key_arn",
          "operation_perms": {},
          "operations": [],
          "order": 5,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Kms master key ARN",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "8f230a0c-7569-4a43-af3e-d2800c518eee",
          "values": [],
          "width": 107
        },
        "query_execution_date": {
          "allow_default_value": false,
          "blank_option": true,
          "calculated": false,
          "changeable": true,
          "chosen": true,
          "default_chosen_by_server": false,
          "deprecated": false,
          "export_key": "gd_s3_bucket_details/query_execution_date",
          "hide_notification": false,
          "id": 5493,
          "input_type": "text",
          "internal": false,
          "is_tracked": false,
          "name": "query_execution_date",
          "operation_perms": {},
          "operations": [],
          "order": 0,
          "placeholder": "",
          "prefix": null,
          "read_only": false,
          "rich_text": false,
          "tags": [],
          "templates": [],
          "text": "Query execution date",
          "tooltip": "",
          "type_id": 1493,
          "uuid": "a2fc4076-6459-4682-95dd-c123dac09a3d",
          "values": [],
          "width": 115
        }
      },
      "for_actions": false,
      "for_custom_fields": false,
      "for_notifications": false,
      "for_workflows": false,
      "id": null,
      "parent_types": [
        "incident"
      ],
      "properties": {
        "can_create": false,
        "can_destroy": false,
        "for_who": []
      },
      "scripts": [],
      "tags": [],
      "type_id": 8,
      "type_name": "gd_s3_bucket_details",
      "uuid": "c71024b5-5f5a-470e-b020-7d4b22db5e83"
    }
  ],
  "workflows": [],
  "workspaces": []
}
