<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.0.4423
-->

# Playbook - BMC Helix Create Incident from Task

### API Name
`bmc_helix_create_incident_from_task`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`task`

### Description
Create a new Incident in BMC Helix from a SOAR Incident Task


---
## Function - Helix: Create Incident

### API Name
`helix_create_incident`

### Output Name
`create_incident`

### Message Destination
`fn_bmc_helix`

### Function-Input Script
```python
payload = u"""{{ "ApplyTemplate": {},
  "First_Name": {},
  "Last_Name": {},
  "Impact": {},
  "Urgency": {},
  "Service_Type": {},
  "Status": {},
  "Reported Source": {},
  "Description": {},
  "Assigned Support Organization": {},
  "additional_data": {}
}}""".format(playbook.properties.bmc_helix_template,
  playbook.properties.bmc_helix_customer_first_name,
  playbook.properties.bmc_helix_customer_last_name,
  playbook.properties.bmc_helix_impact,
  playbook.properties.bmc_helix_urgency,
  playbook.properties.bmc_helix_service_type,
  playbook.properties.bmc_helix_status,
  playbook.properties.bmc_helix_reported_source,
  playbook.properties.bmc_helix_note,
  playbook.properties.bmc_helix_support_group,
  playbook.properties.bmc_helix_additional_data.content if playbook.properties.bmc_helix_additional_data.content else "null"
)

# set inputs
inputs.task_id = task.id 
inputs.incident_id = incident.id
inputs.helix_incident_name = task.name
inputs.helix_payload = payload
```

---

## Local script - post process

### Description


### Script Type
`Local script`

### Objet Type
`task`

### Script Content
```python
results = playbook.functions.results.create_incident
noteText = "<h5> Helix Create Incident</h5>"

task_id = task.id
task_name = task.name
values = results.get("content", {}).get("values", {})

if results["success"]:
  noteText += f"<p>Successfully sent task {task_id} \"{task_name}\" to Helix as Incident Number {values.get('Incident Number')} (UI name) and Request ID {values.get('Request ID')} (API name).</p>"
else:
  noteText += f"<p>Unable to send task {task_id} \"{task_name}\" to Helix</p>"
  noteText += "<p>Ensure the activity fields and payload you provide meet the minimum requirements in your system for incident creation and routing."

richText = helper.createRichText(noteText)
incident.addNote(richText)
```

---
