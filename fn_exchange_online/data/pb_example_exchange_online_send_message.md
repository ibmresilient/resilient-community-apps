<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v49.0.4423
-->

# Playbook - Example: Exchange Online Send Message (PB)

### API Name
`example_exchange_online_send_message`

### Status
`enabled`

### Activation Type
`manual`

### Object Type
`incident`

### Description
This playbook will send a message from a specified email address with specified message subject and body to the specified recipients.


---
## Function - Exchange Online: Send Message

### API Name
`exchange_online_send_message`

### Output Name
`exchange_online_send_message_result`

### Message Destination
`fn_exchange_online`

### Function-Input Script
```python
inputs.exo_email_address   = playbook.inputs.exchange_online_sender_address
inputs.exo_recipients      = playbook.inputs.exchange_online_recipient_addresses
inputs.exo_message_subject = playbook.inputs.exchange_online_message_subject
inputs.exo_message_body    = playbook.inputs.exchange_online_message_body
inputs.exo_attachment_names = playbook.inputs.exchange_online_attachment_names
inputs.incident_id = incident.id
```

---

## Local script - exchange_online_send_message_post_process

### Description


### Script Type
`Local script`

### Objet Type
`incident`

### Script Content
```python
results=playbook.functions.results.exchange_online_send_message_result

if results.success:
  noteText = u"Exchange Online message sent\n   From: {0}\n   To: {1}\n   Subject: {2}\n   Body: {3}".format(results.inputs["exo_email_address"], results.inputs["exo_recipients"], results.inputs["exo_message_subject"], results.inputs["exo_message_body"])
else:
  noteText = u"Exchange Online message NOT sent\n   From: {0}\n  To: {1}".format(results.inputs["exo_email_address"], results.inputs["exo_recipients"])
  
if results.content.get("failed_attachments"):
  noteText += u"""\nWarning: Exchange Online send message - One or more attachments failed to attach to the message. 
Unable to find a matching attachment name on incident for the following names. Are they spelled correctly and was the extension included?
Failed attachment names: {}""".format(", ".join(results.content["failed_attachments"]))

incident.addNote(noteText)
```

---
