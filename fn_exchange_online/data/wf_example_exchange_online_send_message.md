<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
-->

# Example: Exchange Online Send Message

## Function - Exchange Online: Send Message

### API Name
`exchange_online_send_message`

### Output Name
``

### Message Destination
`fn_exchange_online`

### Pre-Processing Script
```python
inputs.exo_email_address   = inputs.exo_email_address   if rule.properties.exo_message_sender_address is None else rule.properties.exo_message_sender_address
inputs.exo_recipients      = inputs.exo_recipients      if rule.properties.exo_message_recipients     is None else rule.properties.exo_message_recipients
inputs.exo_message_subject = inputs.exo_message_subject if rule.properties.exo_message_subject is None else rule.properties.exo_message_subject
inputs.exo_message_body    = inputs.exo_message_body if rule.properties.exo_message_send_body.content is None else rule.properties.exo_message_send_body.content
inputs.exo_attachment_names = inputs.exo_attachment_names if rule.properties.exo_attachment_names is None else rule.properties.exo_attachment_names
inputs.incident_id = incident.id
```

### Post-Processing Script
```python
if results.success:
  noteText = u"Exchange Online message sent\n   From: {0}\n   To: {1}\n   Subject: {2}\n   Body: {3}".format(results.inputs["exo_email_address"], results.inputs["exo_recipients"], results.inputs["exo_message_subject"], results.inputs["exo_message_body"])
else:
  noteText = u"Exchange Online message NOT sent\n   From: {0}\n  To: {1}".format(results.inputs["exo_email_address"], results.inputs["exo_recipients"])
  
if results.content.get("failed_attachments"):
  noteText += u"""\nWarning: Exchange Online send message - One or more attachments failed to attach to the message. 
Unable to find a matching attachment name on incident for the following names. Are they spelled correctly and was the extension included?
Failed attachment names: {}""".format(", ".join(results.content["failed_attachments"]))

incident.addNote(noteText)
```

---

