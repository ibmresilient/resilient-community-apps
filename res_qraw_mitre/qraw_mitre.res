{"locale": null, "workflows": [{"description": "Map a QRadar rule to MITRE ATT&CK tactic using QRAW", "workflow_id": 24, "object_type": "qradar_reference_set", "export_key": "qradar_advisor_map_rule_to_tactic", "uuid": "cf368ebb-9e75-45ed-8c3c-b26476624ad7", "last_modified_by": "yongjian.feng@ibm.com", "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"qradar_advisor_map_rule_to_tactic\" isExecutable=\"true\" name=\"Example of mapping QRadar rule to tactic\"><documentation><![CDATA[Map a QRadar rule to MITRE ATT&CK tactic using QRAW]]></documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_1vffano</outgoing></startEvent><serviceTask id=\"ServiceTask_1pzn8wl\" name=\"QRadar Advisor Map Rule\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"f1dbf8b7-a5ed-45e4-b788-4edc49830993\">{\"inputs\":{},\"pre_processing_script\":\"inputs.qradar_rule_name = row.source\",\"result_name\":\"qraw_rule_map\"}</resilient:function></extensionElements><incoming>SequenceFlow_1vffano</incoming><outgoing>SequenceFlow_03oh0n5</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_1vffano\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1pzn8wl\"/><serviceTask id=\"ServiceTask_157vqta\" name=\"MITRE tactic information\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"669947ce-ee8d-45f4-b0bc-778c278cfaea\">{\"inputs\":{},\"post_processing_script\":\"#\\n# Sample return from function\\n# \\n# results = {\\\"mitre_tactics\\\":[\\n#   {\\n#     \\\"tactic_name\\\": \\\"Execution\\\",\\n#     \\\"tactic_id\\\": \\\"TA0002\\\",\\n#     \\\"tactic_ref\\\": \\\"https://attack.mitre.org/tactics/TA0002/\\\",\\n#     \\\"techs\\\": []\\n#   }\\n#]\\n#\\n#\\n\\n# Read result from QRAW to get confidence information\\nmapping = workflow.properties.qraw_rule_map.tactics[\\\"mapping\\\"]\\ntactic_names = mapping.keys()\\n\\ntactic_confidence = {}\\nif tactic_names is not None:\\n  for t_name in tactic_names:\\n    tactic_confidence[t_name] = mapping[t_name][\\\"confidence\\\"]\\n\\n\\ntactics = results.mitre_tactics\\n\\nfor tactic in tactics:\\n  #\\n  # MITRE ATTACK of Incident Datatable\\n  #\\n  tactic_row = incident.addRow(\\\"mitre_attack_of_artifact\\\")\\n  tactic_row[\\\"artifact\\\"] = row.item_value\\n  tactic_row[\\\"mitre_attack_tactic\\\"] = tactic[\\\"tactic_name\\\"]\\n  tactic_row[\\\"tactic_code\\\"] = tactic[\\\"tactic_id\\\"]\\n  url_html = '&lt;a href=\\\"' + tactic[\\\"tactic_ref\\\"] + '\\\"&gt;' + tactic[\\\"tactic_ref\\\"] + '&lt;/a&gt;&lt;br&gt;'\\n  tactic_row[\\\"reference\\\"] = helper.createRichText(url_html)\\n  tactic_row[\\\"confidence\\\"] = str(tactic_confidence.get(tactic[\\\"tactic_name\\\"], \\\"\\\"))\\n  #\\n  # MITRE ATT&amp;CK techniques Datatable\\n  #\\n  techs = tactic[\\\"techs\\\"]\\n  for att_tech in techs:\\n    tech_row = incident.addRow(\\\"mitre_attack_techniques\\\")\\n    tech_row[\\\"tactic\\\"] = tactic[\\\"tactic_name\\\"]\\n\\n    tech_row[\\\"technique_name\\\"] = att_tech[\\\"name\\\"]\\n    tech_row[\\\"tech_description\\\"] = att_tech[\\\"description\\\"]\\n    refs = att_tech[\\\"external_references\\\"]\\n    ref_html = \\\"\\\"\\n    for ref in refs:\\n      ref_html = ref_html + '&lt;a href=\\\"' + ref[\\\"url\\\"] + '\\\"&gt;' + ref[\\\"url\\\"] + '&lt;/a&gt;&lt;br&gt;'\\n    tech_row[\\\"references\\\"] = helper.createRichText(ref_html)\\n    tech_row[\\\"detection\\\"] = att_tech[\\\"x_mitre_detection\\\"]\\n    tech_row[\\\"technique_id\\\"] = att_tech[\\\"mitre_tech_id\\\"]\\n\\n\",\"pre_processing_script\":\"\\\"\\\"\\\"\\nSample data from QRaw:\\n  {\\n    u'id': u'SYSTEM-1458', \\n    u'has_ibm_default': True, \\n    u'mapping': {\\n                  u'Privilege Escalation': {\\n                                              u'user_override': False, \\n                                              u'confidence': u'high', \\n                                              u'ibm_default': True, \\n                                              u'enabled': True, \\n                                              u'techniques': {}\\n                  }, \\n                  u'Execution': {\\n                                  u'user_override': False, \\n                                  u'confidence': u'high', \\n                                  u'ibm_default': True, \\n                                  u'enabled': True, \\n                                  u'techniques': {}\\n                  }, \\n                  u'Initial Access': {\\n                                  u'user_override': False, \\n                                  u'confidence': u'high', \\n                                  u'ibm_default': True, \\n                                  u'enabled': True, \\n                                  u'techniques': {}\\n                  }\\n    }\\n  }\\n\\\"\\\"\\\"\\ntactics = workflow.properties.qraw_rule_map.tactics\\n\\nmapping = tactics[\\\"mapping\\\"]\\n\\natt_tactics = \\\", \\\".join(mapping.keys())\\ninputs.mitre_tactic_name = att_tactics\"}</resilient:function></extensionElements><incoming>SequenceFlow_03oh0n5</incoming><outgoing>SequenceFlow_06z09po</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_03oh0n5\" sourceRef=\"ServiceTask_1pzn8wl\" targetRef=\"ServiceTask_157vqta\"/><endEvent id=\"EndEvent_0oillnw\"><incoming>SequenceFlow_06z09po</incoming></endEvent><sequenceFlow id=\"SequenceFlow_06z09po\" sourceRef=\"ServiceTask_157vqta\" targetRef=\"EndEvent_0oillnw\"/><textAnnotation id=\"TextAnnotation_1kxxiyt\"><text>Start your workflow here</text></textAnnotation><association id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/><textAnnotation id=\"TextAnnotation_1xogoap\"><text><![CDATA[Input from datatable row about QRadar rule, call QRadar Advisor to map it to MITRE ATT&CK tactic(s)\n]]></text></textAnnotation><association id=\"Association_1h4fot7\" sourceRef=\"ServiceTask_1pzn8wl\" targetRef=\"TextAnnotation_1xogoap\"/><textAnnotation id=\"TextAnnotation_0jogne1\"><text><![CDATA[QRadar Advisor returns tactics\n]]></text></textAnnotation><association id=\"Association_16frvmr\" sourceRef=\"ServiceTask_1pzn8wl\" targetRef=\"TextAnnotation_0jogne1\"/><textAnnotation id=\"TextAnnotation_08lmhu7\"><text><![CDATA[Use tactic(s) returned by QRadar Advisor to look for more information about it.\n]]></text></textAnnotation><association id=\"Association_1ic24kl\" sourceRef=\"ServiceTask_157vqta\" targetRef=\"TextAnnotation_08lmhu7\"/><textAnnotation id=\"TextAnnotation_0dl4bu8\"><text><![CDATA[MITRE Integration returns information about tactics and techniques. Populate datatable(s)\n]]></text></textAnnotation><association id=\"Association_1sj7mmr\" sourceRef=\"ServiceTask_157vqta\" targetRef=\"TextAnnotation_0dl4bu8\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"187\" y=\"179\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"182\" y=\"214\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"><omgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"><omgdi:waypoint x=\"192\" xsi:type=\"omgdc:Point\" y=\"209\"/><omgdi:waypoint x=\"157\" xsi:type=\"omgdc:Point\" y=\"254\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1pzn8wl\" id=\"ServiceTask_1pzn8wl_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"314\" y=\"157\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1vffano\" id=\"SequenceFlow_1vffano_di\"><omgdi:waypoint x=\"223\" xsi:type=\"omgdc:Point\" y=\"197\"/><omgdi:waypoint x=\"314\" xsi:type=\"omgdc:Point\" y=\"197\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"268.5\" y=\"175\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"ServiceTask_157vqta\" id=\"ServiceTask_157vqta_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"576.2740926157697\" y=\"157\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_03oh0n5\" id=\"SequenceFlow_03oh0n5_di\"><omgdi:waypoint x=\"414\" xsi:type=\"omgdc:Point\" y=\"197\"/><omgdi:waypoint x=\"576\" xsi:type=\"omgdc:Point\" y=\"197\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"495\" y=\"175\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_0oillnw\" id=\"EndEvent_0oillnw_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"789.9547038327526\" y=\"179\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"807.9547038327526\" y=\"218\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_06z09po\" id=\"SequenceFlow_06z09po_di\"><omgdi:waypoint x=\"676\" xsi:type=\"omgdc:Point\" y=\"197\"/><omgdi:waypoint x=\"790\" xsi:type=\"omgdc:Point\" y=\"197\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"733\" y=\"175\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1xogoap\" id=\"TextAnnotation_1xogoap_di\"><omgdc:Bounds height=\"83\" width=\"108\" x=\"147\" y=\"7\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1h4fot7\" id=\"Association_1h4fot7_di\"><omgdi:waypoint x=\"322\" xsi:type=\"omgdc:Point\" y=\"159\"/><omgdi:waypoint x=\"248\" xsi:type=\"omgdc:Point\" y=\"90\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_0jogne1\" id=\"TextAnnotation_0jogne1_di\"><omgdc:Bounds height=\"47\" width=\"109\" x=\"437\" y=\"10\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_16frvmr\" id=\"Association_16frvmr_di\"><omgdi:waypoint x=\"395\" xsi:type=\"omgdc:Point\" y=\"157\"/><omgdi:waypoint x=\"474\" xsi:type=\"omgdc:Point\" y=\"57\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_08lmhu7\" id=\"TextAnnotation_08lmhu7_di\"><omgdc:Bounds height=\"104\" width=\"130\" x=\"450\" y=\"300\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1ic24kl\" id=\"Association_1ic24kl_di\"><omgdi:waypoint x=\"597\" xsi:type=\"omgdc:Point\" y=\"237\"/><omgdi:waypoint x=\"552\" xsi:type=\"omgdc:Point\" y=\"300\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_0dl4bu8\" id=\"TextAnnotation_0dl4bu8_di\"><omgdc:Bounds height=\"130\" width=\"106\" x=\"710\" y=\"287\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1sj7mmr\" id=\"Association_1sj7mmr_di\"><omgdi:waypoint x=\"661\" xsi:type=\"omgdc:Point\" y=\"237\"/><omgdi:waypoint x=\"710\" xsi:type=\"omgdc:Point\" y=\"293\"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "qradar_advisor_map_rule_to_tactic", "version": 1}, "creator_id": "yongjian.feng@ibm.com", "actions": [], "last_modified_time": 1553872488012, "programmatic_name": "qradar_advisor_map_rule_to_tactic", "name": "Example of mapping QRadar rule to tactic"}, {"description": "Performs an offense analysis in QRadar Advisor. Results will populate a Data Table, create a Task, and generate a STIX representation in Notes.\nQRAW returns MITRE ATT&CK tactic information about the given offense. MITRE integration is called to get tactic information. Result published in a data table.", "workflow_id": 25, "object_type": "incident", "export_key": "qradar_advisor_offense_analysis_mitre", "uuid": "5adcd70e-8a27-4025-ba54-d7ca672e9320", "last_modified_by": "yongjian.feng@ibm.com", "content": {"xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"qradar_advisor_offense_analysis_mitre\" isExecutable=\"true\" name=\"Example of QRadar Advisor Offense Analysis with MITRE\"><documentation><![CDATA[Performs an offense analysis in QRadar Advisor. Results will populate a Data Table, create a Task, and generate a STIX representation in Notes.\nQRAW returns MITRE ATT&CK tactic information about the given offense. MITRE integration is called to get tactic information. Result published in a data table.]]></documentation><startEvent id=\"StartEvent_155asxm\"><outgoing>SequenceFlow_1ofd2ct</outgoing></startEvent><serviceTask id=\"ServiceTask_0l3ao75\" name=\"QRadar Advisor Offense Analysis\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"744e9c8b-f00f-4a71-9ae6-c3dde388d6fa\">{\"inputs\":{\"48819fe4-2c70-488a-9996-9581a81d886a\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"bee62681-b35f-4ff8-9c4f-52489e6920cf\"}},\"eb4d07be-006d-41d9-9392-ed22cefff172\":{\"input_type\":\"static\",\"static_input\":{\"boolean_value\":true,\"multiselect_value\":[]}}},\"pre_processing_script\":\"#\\n# This sample workflow uses the custom field (qradar_id) to perform \\n# an offense analysis in QRadar Advisor\\n#\\ninputs.qradar_offense_id = incident.properties.qradar_id\",\"result_name\":\"qraw_offense_insights\"}</resilient:function></extensionElements><incoming>SequenceFlow_1ofd2ct</incoming><outgoing>SequenceFlow_0s00a23</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_1ofd2ct\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_0l3ao75\"/><serviceTask id=\"ServiceTask_0er8nnp\" name=\"MITRE Tactic Information\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"669947ce-ee8d-45f4-b0bc-778c278cfaea\">{\"inputs\":{},\"post_processing_script\":\"#\\n# Sample return from function\\n# \\n# results = {\\\"mitre_tactics\\\":[\\n#   {\\n#     \\\"tactic_name\\\": \\\"Execution\\\",\\n#     \\\"tactic_id\\\": \\\"TA0002\\\",\\n#     \\\"tactic_ref\\\": \\\"https://attack.mitre.org/tactics/TA0002/\\\",\\n#     \\\"techs\\\": []\\n#   }\\n#]\\n#\\n#\\n\\n# Read result from QRAW to get confidence information\\ninsights = workflow.properties.qraw_offense_insights.insights\\nmitre_tactics = insights[\\\"tactics\\\"]\\n\\ntactic_confidence = {}\\nif mitre_tactics is not None:\\n  for tactic in mitre_tactics:\\n    tactic_confidence[tactic[\\\"tactic_id\\\"]] = tactic[\\\"confidence\\\"]\\n\\n\\ntactics = results.mitre_tactics\\n\\nfor tactic in tactics:\\n  #\\n  # MITRE ATTACK of Incident Datatable\\n  #\\n  tactic_row = incident.addRow(\\\"mitre_attack_of_incident\\\")\\n  tactic_row[\\\"attack_tactic\\\"] = tactic[\\\"tactic_name\\\"]\\n  tactic_row[\\\"tactic_code\\\"] = tactic[\\\"tactic_id\\\"]\\n  url_html = '&lt;a href=\\\"' + tactic[\\\"tactic_ref\\\"] + '\\\"&gt;' + tactic[\\\"tactic_ref\\\"] + '&lt;/a&gt;&lt;br&gt;'\\n  tactic_row[\\\"reference\\\"] = helper.createRichText(url_html)\\n  tactic_row[\\\"confidence\\\"] = str(tactic_confidence.get(tactic[\\\"tactic_name\\\"], \\\"\\\"))\\n  #\\n  # MITRE ATT&amp;CK techniques Datatable\\n  #\\n  techs = tactic[\\\"techs\\\"]\\n  for att_tech in techs:\\n    tech_row = incident.addRow(\\\"mitre_attack_techniques\\\")\\n    tech_row[\\\"tactic\\\"] = tactic[\\\"tactic_name\\\"]\\n\\n    tech_row[\\\"technique_name\\\"] = att_tech[\\\"name\\\"]\\n    tech_row[\\\"tech_description\\\"] = att_tech[\\\"description\\\"]\\n    refs = att_tech[\\\"external_references\\\"]\\n    ref_html = \\\"\\\"\\n    for ref in refs:\\n      ref_html = ref_html + '&lt;a href=\\\"' + ref[\\\"url\\\"] + '\\\"&gt;' + ref[\\\"url\\\"] + '&lt;/a&gt;&lt;br&gt;'\\n    tech_row[\\\"references\\\"] = helper.createRichText(ref_html)\\n    tech_row[\\\"detection\\\"] = att_tech[\\\"x_mitre_detection\\\"]\\n    tech_row[\\\"technique_id\\\"] = att_tech[\\\"mitre_tech_id\\\"]\\n\\n\",\"pre_processing_script\":\"insights = workflow.properties.qraw_offense_insights.insights\\n\\ntactics = insights[\\\"tactics\\\"]\\n\\nmitre_tactic_names = []\\nif tactics is not None:\\n  for tactic in tactics:\\n    #\\n    # Note, even though QRAW calls it tactic_id, it is more a tactic name\\n    #\\n    mitre_tactic_names.append(tactic[\\\"tactic_id\\\"])\\n#\\n# QRadar Advisor might return more than one tactics for a given offense. Include them inputs\\n# a comma separated string\\n#\\ninputs.mitre_tactic_name = \\\", \\\".join(mitre_tactic_names)\",\"result_name\":\"\"}</resilient:function></extensionElements><incoming>SequenceFlow_0s00a23</incoming><outgoing>SequenceFlow_0xjpndv</outgoing></serviceTask><sequenceFlow id=\"SequenceFlow_0s00a23\" sourceRef=\"ServiceTask_0l3ao75\" targetRef=\"ServiceTask_0er8nnp\"/><endEvent id=\"EndEvent_1ci3iqv\"><incoming>SequenceFlow_0xjpndv</incoming></endEvent><sequenceFlow id=\"SequenceFlow_0xjpndv\" sourceRef=\"ServiceTask_0er8nnp\" targetRef=\"EndEvent_1ci3iqv\"/><textAnnotation id=\"TextAnnotation_1kxxiyt\"><text>Start your workflow here</text></textAnnotation><association id=\"Association_1seuj48\" sourceRef=\"StartEvent_155asxm\" targetRef=\"TextAnnotation_1kxxiyt\"/><textAnnotation id=\"TextAnnotation_02mdunq\"><text><![CDATA[Inputs: \n qradar_offense_id \nqradar_advisor_result_stage \nqradar_analysis_restart_if_existed]]></text></textAnnotation><association id=\"Association_0x6nbfp\" sourceRef=\"ServiceTask_0l3ao75\" targetRef=\"TextAnnotation_02mdunq\"/><textAnnotation id=\"TextAnnotation_04ul2oz\"><text><![CDATA[Outputs:\nresults.observables\n results.note \nresults.insights\nresults.insights.tactics\n results.stix\n]]></text></textAnnotation><association id=\"Association_1ehcz3i\" sourceRef=\"ServiceTask_0l3ao75\" targetRef=\"TextAnnotation_04ul2oz\"/><textAnnotation id=\"TextAnnotation_1tjc57e\"><text><![CDATA[Inputs:\nMITRE tactic name(s)\nMITRE tactic id(s)\n]]></text></textAnnotation><association id=\"Association_1668csu\" sourceRef=\"ServiceTask_0er8nnp\" targetRef=\"TextAnnotation_1tjc57e\"/><textAnnotation id=\"TextAnnotation_0br22rs\"><text><![CDATA[Outputs:\nresults.mitre_tactics\n]]></text></textAnnotation><association id=\"Association_1ukydem\" sourceRef=\"ServiceTask_0er8nnp\" targetRef=\"TextAnnotation_0br22rs\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"undefined\" id=\"BPMNPlane_1\"><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"237\" y=\"143\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"232\" y=\"178\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1kxxiyt\" id=\"TextAnnotation_1kxxiyt_di\"><omgdc:Bounds height=\"30\" width=\"100\" x=\"99\" y=\"254\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1seuj48\" id=\"Association_1seuj48_di\"><omgdi:waypoint x=\"241\" xsi:type=\"omgdc:Point\" y=\"171\"/><omgdi:waypoint x=\"161\" xsi:type=\"omgdc:Point\" y=\"254\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"ServiceTask_0l3ao75\" id=\"ServiceTask_0l3ao75_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"361\" y=\"121\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_1ofd2ct\" id=\"SequenceFlow_1ofd2ct_di\"><omgdi:waypoint x=\"273\" xsi:type=\"omgdc:Point\" y=\"161\"/><omgdi:waypoint x=\"361\" xsi:type=\"omgdc:Point\" y=\"161\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"317\" y=\"139\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_02mdunq\" id=\"TextAnnotation_02mdunq_di\"><omgdc:Bounds height=\"74\" width=\"219\" x=\"182\" y=\"-9\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_0x6nbfp\" id=\"Association_0x6nbfp_di\"><omgdi:waypoint x=\"375\" xsi:type=\"omgdc:Point\" y=\"121\"/><omgdi:waypoint x=\"324\" xsi:type=\"omgdc:Point\" y=\"65\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_04ul2oz\" id=\"TextAnnotation_04ul2oz_di\"><omgdc:Bounds height=\"98\" width=\"155\" x=\"512\" y=\"-16\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1ehcz3i\" id=\"Association_1ehcz3i_di\"><omgdi:waypoint x=\"458\" xsi:type=\"omgdc:Point\" y=\"128\"/><omgdi:waypoint x=\"522\" xsi:type=\"omgdc:Point\" y=\"82\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"ServiceTask_0er8nnp\" id=\"ServiceTask_0er8nnp_di\"><omgdc:Bounds height=\"80\" width=\"100\" x=\"659.0506787330316\" y=\"121\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0s00a23\" id=\"SequenceFlow_0s00a23_di\"><omgdi:waypoint x=\"461\" xsi:type=\"omgdc:Point\" y=\"161\"/><omgdi:waypoint x=\"659\" xsi:type=\"omgdc:Point\" y=\"161\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"560\" y=\"139\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_1tjc57e\" id=\"TextAnnotation_1tjc57e_di\"><omgdc:Bounds height=\"71\" width=\"166\" x=\"487\" y=\"260\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1668csu\" id=\"Association_1668csu_di\"><omgdi:waypoint x=\"668\" xsi:type=\"omgdc:Point\" y=\"200\"/><omgdi:waypoint x=\"607\" xsi:type=\"omgdc:Point\" y=\"260\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"TextAnnotation_0br22rs\" id=\"TextAnnotation_0br22rs_di\"><omgdc:Bounds height=\"74\" width=\"139\" x=\"798\" y=\"257\"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"Association_1ukydem\" id=\"Association_1ukydem_di\"><omgdi:waypoint x=\"752\" xsi:type=\"omgdc:Point\" y=\"198\"/><omgdi:waypoint x=\"823\" xsi:type=\"omgdc:Point\" y=\"257\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"EndEvent_1ci3iqv\" id=\"EndEvent_1ci3iqv_di\"><omgdc:Bounds height=\"36\" width=\"36\" x=\"906.5004557885142\" y=\"143\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"924.5004557885142\" y=\"182\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement=\"SequenceFlow_0xjpndv\" id=\"SequenceFlow_0xjpndv_di\"><omgdi:waypoint x=\"759\" xsi:type=\"omgdc:Point\" y=\"161\"/><omgdi:waypoint x=\"907\" xsi:type=\"omgdc:Point\" y=\"161\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"13\" width=\"0\" x=\"833\" y=\"139\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>", "workflow_id": "qradar_advisor_offense_analysis_mitre", "version": 1}, "creator_id": "yongjian.feng@ibm.com", "actions": [], "last_modified_time": 1553872488084, "programmatic_name": "qradar_advisor_offense_analysis_mitre", "name": "Example of QRadar Advisor Offense Analysis with MITRE"}], "actions": [{"object_type": "qradar_reference_set", "type": 1, "name": "Map rule to MITRE tactic", "view_items": [], "timeout_seconds": 86400, "workflows": ["qradar_advisor_map_rule_to_tactic"], "logic_type": "all", "export_key": "Map rule to MITRE tactic", "uuid": "a8667541-9d0e-4027-81d8-e10af81bff87", "automations": [], "conditions": [], "id": 44, "message_destinations": []}, {"object_type": "incident", "type": 1, "name": "QRadar Advisor Offense Analysis with MITRE", "view_items": [], "timeout_seconds": 86400, "workflows": ["qradar_advisor_offense_analysis_mitre"], "logic_type": "all", "export_key": "QRadar Advisor Offense Analysis with MITRE", "uuid": "2dab6400-6a55-4fe0-a44b-b2b902cf850e", "automations": [], "conditions": [], "id": 45, "message_destinations": []}], "layouts": [], "export_format_version": 2, "id": 16, "industries": null, "functions": [], "action_order": [], "geos": null, "task_order": [], "types": [{"properties": {"for_who": [], "can_destroy": false, "can_create": false}, "display_name": "MITRE ATT&CK of Artifact", "uuid": "d619a589-3209-45b7-8889-f2a12764af7e", "type_id": 8, "fields": {"confidence": {"operations": [], "type_id": 1008, "operation_perms": {}, "text": "Confidence", "blank_option": false, "prefix": null, "changeable": true, "id": 208, "read_only": false, "uuid": "992cbfa0-cc55-488e-821d-1a545de46066", "chosen": false, "input_type": "text", "tooltip": "confidence of the mapping", "width": 109, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_artifact/confidence", "hide_notification": false, "placeholder": "", "name": "confidence", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 3}, "mitre_attack_tactic": {"operations": [], "type_id": 1008, "operation_perms": {}, "text": "MITRE ATT&CK Tactic", "blank_option": true, "prefix": null, "changeable": true, "id": 209, "read_only": false, "uuid": "617e007a-5518-4b4a-acbc-068b800724dd", "chosen": true, "input_type": "text", "tooltip": "MITRE ATT&CK tactic ID", "width": 198, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_artifact/mitre_attack_tactic", "hide_notification": false, "placeholder": "", "name": "mitre_attack_tactic", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 1}, "reference": {"operations": [], "type_id": 1008, "operation_perms": {}, "text": "Reference", "blank_option": false, "prefix": null, "changeable": true, "id": 210, "read_only": false, "uuid": "8d11862d-c184-4fe6-bdd3-bc4da5413d75", "chosen": false, "input_type": "textarea", "tooltip": "url reference to MITRE ATT&CK Tactic", "width": 125, "internal": false, "rich_text": true, "templates": [], "export_key": "mitre_attack_of_artifact/reference", "hide_notification": false, "placeholder": "", "name": "reference", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 4}, "artifact": {"operations": [], "type_id": 1008, "operation_perms": {}, "text": "Artifact", "blank_option": false, "prefix": null, "changeable": true, "id": 211, "read_only": false, "uuid": "a8fb3c4e-6236-40c7-9f47-0bbfb42a38a7", "chosen": false, "input_type": "text", "tooltip": "artifact value related to the attack tactic", "width": 105, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_artifact/artifact", "hide_notification": false, "placeholder": "", "name": "artifact", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 0}, "tactic_code": {"operations": [], "type_id": 1008, "operation_perms": {}, "text": "Tactic Code", "blank_option": true, "prefix": null, "changeable": true, "id": 212, "read_only": false, "uuid": "b0fb84d5-1ac2-4707-8169-e9b673944ee6", "chosen": true, "input_type": "text", "tooltip": "tactic code", "width": 122, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_artifact/tactic_code", "hide_notification": false, "placeholder": "", "name": "tactic_code", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 2}}, "parent_types": ["incident"], "type_name": "mitre_attack_of_artifact", "export_key": "mitre_attack_of_artifact", "for_custom_fields": false, "actions": [], "id": null, "for_actions": false, "scripts": [], "for_notifications": false}, {"properties": {"for_who": [], "can_destroy": false, "can_create": false}, "display_name": "MITRE ATT&CK of Incident", "uuid": "70a7968b-5758-4052-9dcb-c5cc16688339", "type_id": 8, "fields": {"confidence": {"operations": [], "type_id": 1003, "operation_perms": {}, "text": "Confidence", "blank_option": false, "prefix": null, "changeable": true, "id": 176, "read_only": false, "uuid": "f5dc0711-012e-4127-82b2-8adece60417b", "chosen": false, "input_type": "text", "tooltip": "confidence of the mapping", "width": 160, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_incident/confidence", "hide_notification": false, "placeholder": "", "name": "confidence", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 2}, "attack_tactic": {"operations": [], "type_id": 1003, "operation_perms": {}, "text": "ATT&CK Tactic", "blank_option": false, "prefix": null, "changeable": true, "id": 177, "read_only": false, "uuid": "61d22935-99c4-4a30-9b49-23208d3b106f", "chosen": false, "input_type": "text", "tooltip": "Tactic id", "width": 190, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_incident/attack_tactic", "hide_notification": false, "placeholder": "", "name": "attack_tactic", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 0}, "reference": {"operations": [], "type_id": 1003, "operation_perms": {}, "text": "Reference", "blank_option": false, "prefix": null, "changeable": true, "id": 178, "read_only": false, "uuid": "557aa983-94d6-45d6-a4b9-fc0fdec930f7", "chosen": false, "input_type": "textarea", "tooltip": "url links for MITRE ATT&CK Tactic", "width": 173, "internal": false, "rich_text": true, "templates": [], "export_key": "mitre_attack_of_incident/reference", "hide_notification": false, "placeholder": "", "name": "reference", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 3}, "tactic_code": {"operations": [], "type_id": 1003, "operation_perms": {}, "text": "Tactic Code", "blank_option": false, "prefix": null, "changeable": true, "id": 179, "read_only": false, "uuid": "54c78f06-438d-43da-b835-e9a63715bf76", "chosen": false, "input_type": "text", "tooltip": "tactic code", "width": 163, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_of_incident/tactic_code", "hide_notification": false, "placeholder": "", "name": "tactic_code", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 1}}, "parent_types": ["incident"], "type_name": "mitre_attack_of_incident", "export_key": "mitre_attack_of_incident", "for_custom_fields": false, "actions": [], "id": null, "for_actions": false, "scripts": [], "for_notifications": false}, {"properties": {"for_who": [], "can_destroy": false, "can_create": false}, "display_name": "MITRE ATT&CK Techniques", "uuid": "c2baf0af-dcc1-40a0-af37-07a7745c56ba", "type_id": 8, "fields": {"tech_description": {"operations": [], "type_id": 1004, "operation_perms": {}, "text": "Description", "blank_option": true, "prefix": null, "changeable": true, "id": 180, "read_only": false, "uuid": "453a20a9-158b-4db1-bc5d-e5c1dd855e93", "chosen": true, "input_type": "text", "tooltip": "Description of MITRE ATT&CK Technique", "width": 155, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_techniques/tech_description", "hide_notification": false, "placeholder": "", "name": "tech_description", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 4}, "technique_id": {"operations": [], "type_id": 1004, "operation_perms": {}, "text": "Technique id", "blank_option": false, "prefix": null, "changeable": true, "id": 181, "read_only": false, "uuid": "27a78277-5d3f-4730-bcdf-bcca747a8078", "chosen": false, "input_type": "text", "tooltip": "MITRE ATT&CK Technique ID", "width": 122, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_techniques/technique_id", "hide_notification": false, "placeholder": "", "name": "technique_id", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 2}, "detection": {"operations": [], "type_id": 1004, "operation_perms": {}, "text": "Detection", "blank_option": true, "prefix": null, "changeable": true, "id": 182, "read_only": false, "uuid": "37ace286-fff1-4dfc-965f-4353cf87bd2d", "chosen": true, "input_type": "text", "tooltip": "Detection of MITRE ATT&CK Technique ", "width": 121, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_techniques/detection", "hide_notification": false, "placeholder": "", "name": "detection", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 5}, "references": {"operations": [], "type_id": 1004, "operation_perms": {}, "text": "References", "blank_option": false, "prefix": null, "changeable": true, "id": 183, "read_only": false, "uuid": "40e1e293-9d47-430e-a156-86668093ab78", "chosen": false, "input_type": "textarea", "tooltip": "url references for MITRE ATT&CK Technique", "width": 60, "internal": false, "rich_text": true, "templates": [], "export_key": "mitre_attack_techniques/references", "hide_notification": false, "placeholder": "", "name": "references", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 3}, "tactic": {"operations": [], "type_id": 1004, "operation_perms": {}, "text": "Tactic", "blank_option": false, "prefix": null, "changeable": true, "id": 184, "read_only": false, "uuid": "9177895d-eced-4605-ac15-711b052d0c90", "chosen": false, "input_type": "text", "tooltip": "MITRE ATT&CK Tactic name", "width": 122, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_techniques/tactic", "hide_notification": false, "placeholder": "", "name": "tactic", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 0}, "technique_name": {"operations": [], "type_id": 1004, "operation_perms": {}, "text": "Technique name", "blank_option": false, "prefix": null, "changeable": true, "id": 185, "read_only": false, "uuid": "35d35b5d-5d5d-4f48-bb86-925b88e6fb64", "chosen": false, "input_type": "text", "tooltip": "MITRE ATT&CK Technique name", "width": 53, "internal": false, "rich_text": false, "templates": [], "export_key": "mitre_attack_techniques/technique_name", "hide_notification": false, "placeholder": "", "name": "technique_name", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 1}}, "parent_types": ["incident"], "type_name": "mitre_attack_techniques", "export_key": "mitre_attack_techniques", "for_custom_fields": false, "actions": [], "id": null, "for_actions": false, "scripts": [], "for_notifications": false}, {"properties": {"for_who": [], "can_destroy": false, "can_create": false}, "display_name": "QRadar Reference Set", "uuid": "1eef8608-0621-475e-a28e-e92a382046ac", "type_id": 8, "fields": {"source": {"operations": [], "type_id": 1005, "operation_perms": {}, "text": "Source", "blank_option": true, "prefix": null, "changeable": true, "id": 191, "read_only": false, "uuid": "5110a075-82a8-4ee1-9e9b-26bb7fb1075f", "chosen": true, "input_type": "text", "tooltip": "how this value is added to the reference set", "width": 196, "internal": false, "rich_text": false, "templates": [], "export_key": "qradar_reference_set/source", "hide_notification": false, "placeholder": "", "name": "source", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 2}, "reference_set": {"operations": [], "type_id": 1005, "operation_perms": {}, "text": "Reference Set", "blank_option": true, "prefix": null, "changeable": true, "id": 192, "read_only": false, "uuid": "0c0a0482-2e19-49e8-b63b-8eb912ed8f8e", "chosen": true, "input_type": "text", "tooltip": "Name of reference set", "width": 258, "internal": false, "rich_text": false, "templates": [], "export_key": "qradar_reference_set/reference_set", "hide_notification": false, "placeholder": "", "name": "reference_set", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 0}, "item_value": {"operations": [], "type_id": 1005, "operation_perms": {}, "text": "Item Value", "blank_option": true, "prefix": null, "changeable": true, "id": 193, "read_only": false, "uuid": "fde56836-581c-47a9-a961-67427a5b3a80", "chosen": true, "input_type": "text", "tooltip": "Item value", "width": 219, "internal": false, "rich_text": false, "templates": [], "export_key": "qradar_reference_set/item_value", "hide_notification": false, "placeholder": "", "name": "item_value", "deprecated": false, "default_chosen_by_server": false, "values": [], "order": 1}}, "parent_types": ["incident"], "type_name": "qradar_reference_set", "export_key": "qradar_reference_set", "for_custom_fields": false, "actions": [], "id": null, "for_actions": false, "scripts": [], "for_notifications": false}], "timeframes": null, "workspaces": [], "automatic_tasks": [], "phases": [], "notifications": null, "regulators": null, "incident_types": [{"create_date": 1553872566246, "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "id": 0, "name": "Customization Packages (internal)", "update_date": 1553872566246, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "enabled": false, "system": false, "parent_id": null, "hidden": false}], "scripts": [], "server_version": {"major": 31, "version": "31.0.4254", "build_number": 4254, "minor": 0}, "message_destinations": [], "incident_artifact_types": [], "roles": [], "fields": [{"operations": [], "type_id": 0, "operation_perms": {}, "text": "Simulation", "blank_option": false, "prefix": null, "changeable": true, "id": 36, "read_only": true, "uuid": "c3f0e3ed-21e1-4d53-affb-fe5ca3308cca", "chosen": false, "input_type": "boolean", "tooltip": "Whether the incident is a simulation or a regular incident.  This field is read-only.", "internal": false, "rich_text": false, "templates": [], "export_key": "incident/inc_training", "hide_notification": false, "name": "inc_training", "deprecated": false, "default_chosen_by_server": false, "values": []}], "overrides": [], "export_date": 1553872543544}