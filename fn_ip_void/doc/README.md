<!--
  This User README.md is generated by running:
  "resilient-sdk docgen -p fn_ip_void --user-guide"

  It is best edited using a Text Editor with a Markdown Previewer. VS Code
  is a good example. Checkout https://guides.github.com/features/mastering-markdown/
  for tips on writing with Markdown

  If you make manual edits and run docgen again, a .bak file will be created

  Store any screenshots in the "doc/screenshots" directory and reference them like:
  ![screenshot: screenshot_1](./screenshots/screenshot_1.png)
-->

# **User Guide:** fn_ip_void_v1.0.1

## Table of Contents
- [Key Features](#key-features)
- [Function - IPVOID API Implementation](#function---ipvoid-api-implementation)
- [Rules](#rules)

---

## Key Features
<!--
  List the Key Features of the Integration
-->
* Get the threat intelligence of a domain name or IP address.
* Get the SSL certificate information of a domain name.

---

## Function - IPVOID API Implementation
Look up the threat intelligence using the IP Void API.

 ![screenshot: fn-ipvoid-api-implementation ](./screenshots/main.png)

<details><summary>Inputs:</summary>
<p>

| Name | Type | Required | Example | Tooltip |
| ---- | :--: | :------: | ------- | ------- |
| `ip_void_artifact_type` | `text` | Yes | `"IP Address"` | - |
| `ip_void_artifact_value` | `text` | Yes | `"129.42.38.10"` | - |
| `ip_void_request_type` | `select` | Yes | `"IP Reputation"` | - |

</p>
</details>

<details><summary>Outputs:</summary>
<p>

```python
results = {
  'version': '1.0',
  'success': True,
  'reason': None,
  'content': {
    'data': {
      'report': {
        'ip': '129.42.38.10',
        'blacklists': {
          'engines': {
            '10': {
              'engine': 'Anti-Attacks BL',
              'detected': False,
              'reference': 'https://www.anti-attacks.com/',
              'elapsed': '0.00'
            }
          },
          'detections': 0,
          'engines_count': 88,
          'detection_rate': '0%',
          'scantime': '0.68'
        },
        'information': {
          'reverse_dns': '',
          'continent_code': 'NA',
          'continent_name': 'North America',
          'country_code': 'US',
          'country_name': 'United States of America',
          'country_currency': 'USD',
          'country_calling_code': '1',
          'region_name': 'North Carolina',
          'city_name': 'Durham',
          'latitude': 35.99470138549805,
          'longitude': -78.89620208740234,
          'isp': 'IBM'
        },
        'anonymity': {
          'is_proxy': False,
          'is_webproxy': False,
          'is_vpn': False,
          'is_hosting': False,
          'is_tor': False
        }
      }
    },
    'credits_remained': 0.0,
    'estimated_queries': '0',
    'elapsed_time': '1.09',
    'success': True
  },
  'raw': '{"data": {"report": .......}',
  'inputs': {
    'ip_void_artifact_type': 'IP Address',
    'ip_void_request_type': {
      'id': 58,
      'name': 'IP Reputation'
    },
    'ip_void_artifact_value': '129.42.38.10'
  },
  'data': {
    'report': {
      'ip': '129.42.38.10',
      'blacklists': {
        'engines': {
          '10': {
            'engine': 'Anti-Attacks BL',
            'detected': False,
            'reference': 'https://www.anti-attacks.com/',
            'elapsed': '0.00'
          }
        },
        'detections': 0,
        'engines_count': 88,
        'detection_rate': '0%',
        'scantime': '0.68'
      },
      'information': {
        'reverse_dns': '',
        'continent_code': 'NA',
        'continent_name': 'North America',
        'country_code': 'US',
        'country_name': 'United States of America',
        'country_currency': 'USD',
        'country_calling_code': '1',
        'region_name': 'North Carolina',
        'city_name': 'Durham',
        'latitude': 35.99470138549805,
        'longitude': -78.89620208740234,
        'isp': 'IBM'
      },
      'anonymity': {
        'is_proxy': False,
        'is_webproxy': False,
        'is_vpn': False,
        'is_hosting': False,
        'is_tor': False
      }
    }
  }
}
```

</p>
</details>

<details><summary>Workflows</summary>

  <details><summary>Example Pre-Process Script:</summary>
  <p>

  ```python
  inputs.ip_void_artifact_type = artifact.type
inputs.ip_void_artifact_value = artifact.value
  ```

  </p>
  </details>

  <details><summary>Example Post-Process Script:</summary>
  <p>

  ```python
  try:
    des = artifact.description.content
except Exception:
  des = None
  
if des is None:
 
  artifact.description = u"""IPVOID threat intelligence {0}""".format(results["data"])
else:

  artifact.description = des + u"""IPVOID threat intelligence {0}""".format(results["data"])
  ```

  </p>
  </details>

</details>

---


## Rules
| Rule Name | Object | Workflow Triggered |
| --------- | ------ | ------------------ |
| Example: IPVOID API Email Domain Check | artifact | `example_ipvoid_verify_email_domain` |
| Example: IPVOID API Check IP Address | artifact | `example_ipvoidip_reputation` |
| Example: IPVOID API Threat Log Check | artifact | `example_ipvoid_threat_log` |
| Example: IPVOID API SSL Certificate Information | artifact | `example_ipvoid_get_ssl_certificate_information` |
| Example: IPVOID API Domain name | artifact | `example_ipvoid_dns_lookup` |
| Example: IPVOID Domain Blacklist Check | artifact | `example_ipvoid_domain_blacklist_check` |

---

<!--
## Inform Resilient Users
  Use this section to optionally provide additional information so that Resilient playbook 
  designer can get the maximum benefit of your integration.
-->