<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Example: AMP get SCD file lists

## Function - AMP: Get File Lists

### API Name
`fn_amp_get_file_lists`

### Output Name
``

### Message Destination
`fn_cisco_amp`

### Pre-Processing Script
```python
None
```

### Post-Processing Script
```python
##  Cisco AMP for endpoints - fn_amp_get_file_lists script ##
# Example result:
"""
Result: {
          "input_params": {"name": null, "limit": null, "offset": null },
          "response": {u'version': u'v1.2.0',
                       u'data': {u'items': [],
                                 u'guid': u'9710a198-b95a-462a-b184-9e688968fd94',
                                 u'name': u'File Blacklist',
                                 u'policies': [{ u'guid': u'a98a0f97-4d54-4175-9eef-b8dee9c8e74b',
                                                 u'name': u'Audit',
                                                 u'links': {
                                                    u'policy': u'https://api.amp.cisco.com/v1/policies/a98a0f97-4d54-4175-9eef-b8dee9c8e74b'
                                                 }
                                               }, {
                                                 u'guid': u'fdf4c7f9-b0de-41bf-9d86-d0fae7aa5267',
                                                 u'name': u'Audit',
                                                 u'links': {
                                                     u'policy': u'https://api.amp.cisco.com/v1/policies/fdf4c7f9-b0de-41bf-9d86-d0fae7aa5267'
                                                 }
                                               }
                                 ]
                        },
                        u'metadata': {u'results':
                                        {u'index': 10,
                                         u'total': 1,
                                         u'items_per_page': 500,
                                         u'current_item_count': 0
                                         },
                                      u'links': {
                                          u'self': u'https://api.amp.cisco.com/v1/file_lists/e773a9eb-296c-40df-98d8-bed46322589d/files'
                                         }
                                      }
                        }
          },
          "query_execution_time": "2018-08-09 11:56:02"
    }
"""
#  Globals
# List of fields in datatable fn_amp_get_file_lists script
DATA_TBL_FIELDS = ["query_execution_time", "list_name", "guid", "type"]

# Processing
response = results.response
query_execution_time = results.query_execution_time

if response is not None:
    r = response["metadata"]["results"]
    noteText = "Cisco AMP for Endpoints Integration: There were <b>{0}</b> results returned out of a total of <b>{1}</b> for Resilient function " \
               "<b>{2}</b>".format(len(response["data"]), r["total"], "fn_amp_get_file_lists")
    for d in response["data"]:
        newrow = incident.addRow("amp_scd_file_lists")
        newrow.query_execution_time = query_execution_time
        newrow.list_name = d["name"]
        newrow.guid = d["guid"]
        newrow.type = d["type"]
else:
    noteText += "Cisco AMP for Endpoints Integration: There were <b>no</b> results returned for Resilient function <b>{0}</b>".format("fn_amp_get_file_lists")

incident.addNote(helper.createRichText(noteText))
```

---

