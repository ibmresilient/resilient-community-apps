<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Example: AMP set file in list

## Function - AMP: Set File in List

### API Name
`fn_amp_set_file_list_files`

### Output Name
`None`

### Message Destination
`fn_cisco_amp`

### Pre-Processing Script
```python
# The parameter amp_file_list_guid needs to be set to a valid file list guid.
# e.g. inputs.amp_file_list_guid = "9710a198-b95a-462a-b184-9e688968fd94"
# In the example it will be assigned from an activity field drop-down.
get_file_lists_response = workflow.properties.get_file_lists_results.response
inputs.amp_file_list_guid = get_file_lists_response["data"][0]["guid"]
inputs.amp_file_sha256 = artifact.value
if artifact.description is not None:
  inputs.amp_file_description = artifact.description.content
else:
  inputs.amp_file_description = "Empty description."
```

### Post-Processing Script
```python
##  Cisco AMP for endpoints - fn_amp_set_file_list_files script ##
#  fn_amp_set_file_list_files
# Example result:
"""
Result: {
          "input_params":{"file_list_guid": "e773a9eb-296c-40df-98d8-bed46322589d",
                          "file_sha256": "8a68fc7ffd25e12cb92e3cb8a51bf219cada775baef73991bee384b3656fa284",
                          "description": "Sha256 description"},
          "response": {u'version': u'v1.2.0',
                                  u'data': {u'source': u'Created by entering SHA-256 via Public api.',
                                    u'sha256': u'8a68fc7ffd25e12cb92e3cb8a51bf219cada775baef73991bee384b3656fa284',
                                    u'description': u'Test file sha256',
                                    u'links': {u'file_list': u'https://api.amp.cisco.com/v1/file_lists/e773a9eb-296c-40df-98d8-bed46322589d'}
                                  },
                                  u'metadata': {
                                    u'links': {
                                        u'self': u'https://api.amp.cisco.com/v1/file_lists/e773a9eb-296c-40df-98d8-bed46322589d/files/8a68fc7ffd25e12cb92e3cb8a51bf219cada775baef73991bee384b3656fa284'}
                                    }
                                  },
          "query_execution_time": "2018-08-09 11:56:02"
}

"""
#  Globals
# List of fields in datatable fn_amp_set_file_list_files script


# Processing
response = results.get("response")
query_execution_time = results.get("query_execution_time")
input_params = results.get("input_params", {})
errors = response.get("errors")

if response is not None and errors is None:
    noteText = "Cisco AMP for Endpoints Integration: Successfully added sha256 <b>{0}</b> " \
               "to list with guid <b>{1}</b> for Resilient function <b>{2}</b>."\
        .format(input_params.get("file_sha256"), input_params.get("file_list_guid"), "fn_amp_set_file_list_files")
else:
  noteText = "Cisco AMP Integration: Unsuccessful attempt to set sha256 <b>{0}</b> to list with guid <b>{1}</b> " \
             "for Resilient function <b>{2}</b>."\
        .format(input_params.get("file_sha256"), input_params.get("file_list_guid"), "fn_amp_set_file_list_files")

incident.addNote(helper.createRichText(noteText))

```

---

## Function - AMP: Get File Lists

### API Name
`fn_amp_get_file_lists`

### Output Name
`get_file_lists_results`

### Message Destination
`fn_cisco_amp`

### Pre-Processing Script
```python
None
```

### Post-Processing Script
```python
##  Cisco AMP for endpoints - fn_amp_get_file_lists script ##
#  fn_amp_get_file_lists script
# Example result:
"""
Result: {
          "input_params": {"limit": null, "name": "File Blacklist", "offset": null}
          "response": {u'version': u'v1.2.0',
                       u'data': {u'items': [],
                                 u'guid': u'9710a198-b95a-462a-b184-9e688968fd94',
                                 u'name': u'File Blacklist',
                                 u'policies': [{ u'guid': u'a98a0f97-4d54-4175-9eef-b8dee9c8e74b',
                                                 u'name': u'Audit',
                                                 u'links': {
                                                    u'policy': u'https://api.amp.cisco.com/v1/policies/a98a0f97-4d54-4175-9eef-b8dee9c8e74b'
                                                 }
                                               }, {
                                                 u'guid': u'fdf4c7f9-b0de-41bf-9d86-d0fae7aa5267',
                                                 u'name': u'Audit',
                                                 u'links': {
                                                     u'policy': u'https://api.amp.cisco.com/v1/policies/fdf4c7f9-b0de-41bf-9d86-d0fae7aa5267'
                                                 }
                                               }
                                 ]
                        },
                        u'metadata': {u'results':
                                        {u'index': 10,
                                         u'total': 1,
                                         u'items_per_page': 500,
                                         u'current_item_count': 0
                                         },
                                      u'links': {
                                          u'self': u'https://api.amp.cisco.com/v1/file_lists/e773a9eb-296c-40df-98d8-bed46322589d/files'
                                         }
                                      }
                        }
          },
          "query_execution_time": "2018-08-09 11:56:02"
}
"""
#  Globals
# List of fields in datatable fn_amp_get_file_lists script
DATA_TBL_FIELDS = ["query_execution_time", "list_name", "guid", "type"]

# Processing
response = results.response
query_execution_time = results.query_execution_time

if response is None:
   noteText = "Cisco AMP for Endpoints Integration: There were <b>no</b> results returned for SOAR function <b>{0}</b>".format("fn_amp_get_file_lists")

   incident.addNote(helper.createRichText(noteText))
```

---

