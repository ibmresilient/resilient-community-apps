<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Example: AMP get files from list

## Function - AMP: Get Files from List

### API Name
`fn_amp_get_file_list_files`

### Output Name
``

### Message Destination
`fn_cisco_amp`

### Pre-Processing Script
```python
inputs.amp_file_list_guid = row.guid
inputs.amp_file_sha256 = None
inputs.amp_limit = None
inputs.amp_offset = None
```

### Post-Processing Script
```python
##  Cisco AMP for endpoints - fn_amp_get_file_list_files script ##
#  fn_amp_get_file_list_files  -  Event type list
# Example result:
"""
Result:  {
          "input_params": {"file_list_guid": "e773a9eb-296c-40df-98d8-bed46322589d",
                           "file_sha256": "", "limit": null,
                           "offset": null},
          "response": {
            "version": "v1.2.0",
            "data": {
              "items": [
                {
                  "source": "Created by entering SHA-256 via Public api.",
                  "sha256": "c26dc4e73a335b4414d238b6b30bfd6aff693293f9e4946b5df13f9aac40af5c",
                  "description": "A test malware file. ",
                  "links": {
                    "file_list": "https://api.amp.cisco.com/v1/file_lists/9710a198-b95a-462a-b184-9e688968fd94"
                  }
                },
                {
                  "source": "Created by entering SHA-256 via Public api.",
                  "sha256": "d15766ead5d8ffe68fd96d4bda75c07378fc74f76e251ae6631f4ec8226d2bcb",
                  "description": "\"Malware test file - by JP.\"",
                  "links": {
                    "file_list": "https://api.amp.cisco.com/v1/file_lists/9710a198-b95a-462a-b184-9e688968fd94"
                  }
                }
              ],
              "guid": "9710a198-b95a-462a-b184-9e688968fd94",
              "name": "File Blacklist",
              "policies": [
                {
                  "guid": "a98a0f97-4d54-4175-9eef-b8dee9c8e74b",
                  "name": "Audit",
                  "links": {
                    "policy": "https://api.amp.cisco.com/v1/policies/a98a0f97-4d54-4175-9eef-b8dee9c8e74b"
                  }
                },
                {
                  "guid": "51450374-366c-4759-9099-7baa138c499f",
                  "name": "Triage",
                  "links": {
                    "policy": "https://api.amp.cisco.com/v1/policies/51450374-366c-4759-9099-7baa138c499f"
                  }
                },
                ...
                ...
              ]
            },
            "metadata": {
              "results": {
                "index": 0,
                "total": 2,
                "items_per_page": 50,
                "current_item_count": 2
              },
              "links": {
                "self": "https://api.amp.cisco.com/v1/file_lists/9710a198-b95a-462a-b184-9e688968fd94/files?limit=50"
              }
            }
          },
          "query_execution_time": "2018-10-23 10:09:19"
}
"""
#  Globals
# List of fields in datatable fn_amp_get_file_list_files script
DATA_TBL_FIELDS = ["query_execution_time", "list_name", "guid", "file_description", "sha256", "source"]

# Processing
response = results.response
query_execution_time = results.query_execution_time
if response is not None:
    data = response["data"]
    r = response["metadata"]["results"]
    noteText = "Cisco AMP for Endpoints Integration: There were <b>{0}</b> results returned out of a total of <b>{1}</b> " \
               "for list <b>{2}</b> for Resilient function <b>{3}</b>"\
        .format(len(data["items"]), r["total"], data["name"], "fn_amp_get_file_list_files")
    if data is not None:
        items = data["items"]
        for i in items:
            newrow = incident.addRow("amp_file_list_files")
            newrow.query_execution_time = query_execution_time
            for f in DATA_TBL_FIELDS[1:]:
                if data[f] is not None:
                    newrow[f] = data[f]
                if i[f] is not None:
                    newrow[f] = i[f]
            if data.name is not None:
                newrow.list_name = data.name
            if i.description is not None:
                newrow.file_description = i.description
else:
    noteText += "Cisco AMP for Endpoints Integration: There were <b>no</b> results returned for Resilient function <b>{0}</b>"\
        .format("fn_amp_get_file_list_files")

incident.addNote(helper.createRichText(noteText))
```

---

