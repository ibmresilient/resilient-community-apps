<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v52.0.0.0.927
-->

# Example: AMP get groups

## Function - AMP: Get Groups

### API Name
`fn_amp_get_groups`

### Output Name
`None`

### Message Destination
`fn_cisco_amp`

### Pre-Processing Script
```python
inputs.amp_group_guid = None
inputs.amp_group_name = None
inputs.amp_limit = None
```

### Post-Processing Script
```python
##  Cisco AMP for endpoints - fn_amp_get_groups script ##
#  fn_amp_get_groups  -  Event type list
# Example result:
"""
Result: {
          "input_params": {"group_guid": null, "limit": null, "name": null},
          "response": {
            "version": "v1.2.0",
            "data": [
              {
                "source": null,
                "guid": "abcd1234-a123-b456-c769-abcdef123456",
                "name": "Audit",
                "links": {
                  "group": "https://api.amp.cisco.com/v1/groups/abcd1234-a123-b456-c769-abcdef123456"
                },
                "description": "Test Audit Group 1"
              },
              ...
            ],
            "metadata": {
              "results": {
                "index": 0,
                "total": 5,
                "items_per_page": 500,
                "current_item_count": 5
              },
              "links": {
                "self": "https://api.amp.cisco.com/v1/groups"
              }
            }
          },
          "query_execution_time": "2018-10-08 12:49:38"
}
"""
#  Globals
# List of fields in datatable fn_amp_get_groups script
DATA_TBL_FIELDS = ["group_name"]

# Processing
response = results.get("response", {})
query_execution_time = results.get("query_execution_time", "")

if response is not None:
    r = response.get("metadata", {}).get("results")
    noteText = "Cisco AMP for Endpoints Integration: There were <b>{0}</b> results returned out of a total of <b>{1}</b> for Resilient function " \
               "<b>{2}</b>".format(len(response.get("data", [])), r.get("total"), "fn_amp_get_groups")
    for data in response.get("data", []):
        newrow = incident.addRow("amp_groups")
        newrow.query_execution_time = query_execution_time
        newrow.group_name = data.get("name")
        newrow.guid =  data.get("guid")
        newrow.group_description = data.get("description")
else:
    noteText += "Cisco AMP for Endpoints Integration: There were <b>no</b> results returned for SOAR function <b>{0}</b>".format("fn_amp_get_groups")

incident.addNote(helper.createRichText(noteText))
```

---

