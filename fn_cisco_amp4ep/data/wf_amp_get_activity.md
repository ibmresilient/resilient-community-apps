<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-sdk codegen
    Generated with resilient-sdk v50.1.262
-->

# Example: AMP get computers with activity

## Function - AMP: Get Activity

### API Name
`fn_amp_get_activity`

### Output Name
``

### Message Destination
`fn_cisco_amp`

### Pre-Processing Script
```python
inputs.amp_q = artifact.value
```

### Post-Processing Script
```python
##  Cisco AMP for endpoints - fn_amp_get_activity script ##
#  fn_amp_get_activity  -  Event type list
# Example result:
"""
Result: {
          "input_params": {"q": "wsymqyv90.exe", "limit": null, "offset": null},
          "response": {
            "version": "v1.2.0",
            "data": [
              {
                "active": true,
                "hostname": "Demo_Upatre",
                "connector_guid": "76edc092-9e9f-42d4-a2b5-77c094efe348",
                "links": {
                  "trajectory": "https://api.amp.cisco.com/v1/computers/76edc092-9e9f-42d4-a2b5-77c094efe348/trajectory?q=wsymqyv90.exe",
                  "computer": "https://api.amp.cisco.com/v1/computers/76edc092-9e9f-42d4-a2b5-77c094efe348",
                  "group": "https://api.amp.cisco.com/v1/groups/f31bb1cf-c986-4a56-a259-5acd56f7639e"
                }
              }
            ],
            "metadata": {
              "results": {
                "index": 0,
                "total": 1,
                "items_per_page": 500,
                "current_item_count": 1
              },
              "links": {
                "self": "https://api.amp.cisco.com/v1/computers/activity?q=wsymqyv90.exe"
              }
            }
          },
          "query_execution_time": "2018-10-18 16:42:11",
          "query": "wsymqyv90.exe",
        }
}
"""
#  Globals
# List of fields in datatable fn_amp_get_activity script
DATA_TBL_FIELDS = ["query_execution_time", "query", "active", "hostname", "connector_guid"]

# Processing
response = results.response
query_execution_time = results.query_execution_time
query =  results.input_params["q"]
if response is not None:
    r = response["metadata"]["results"]
    noteText = "Cisco AMP for Endpoints Integration: There were <b>{0}</b> results returned out of a total of <b>{1}</b> for query string <b>{2}</b> " \
               "for Resilient function <b>{3}</b>.".format(len(response["data"]), r["total"], query ,"fn_amp_get_activity")
    for data in response["data"]:
        newrow = incident.addRow("amp_activity")
        newrow.query_execution_time = query_execution_time
        newrow.query = query
        for f in DATA_TBL_FIELDS:
            if f == "query" or f == "query_execution_time":
                continue
            newrow[f] = data[f]
else:
    noteText += "Cisco AMP for Endpoints Integration: There were <b>no</b> results returned for Resilient function <b>{0}</b>".format("fn_amp_get_activity")
incident.addNote(helper.createRichText(noteText))
```

---

