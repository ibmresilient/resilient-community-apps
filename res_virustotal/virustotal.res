{"action_order": [], "actions": [], "apps": [], "automatic_tasks": [], "export_date": 1686063924459, "export_format_version": 2, "export_type": null, "fields": [{"export_key": "incident/internal_customizations_field", "id": 0, "input_type": "text", "internal": true, "name": "internal_customizations_field", "read_only": true, "text": "Customizations Field (internal)", "type_id": 0, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"}], "functions": [], "geos": null, "groups": null, "id": 144, "inbound_destinations": [], "inbound_mailboxes": null, "incident_artifact_types": [], "incident_types": [{"update_date": 1686064379200, "create_date": 1686064379200, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "name": "Customization Packages (internal)", "enabled": false, "system": false, "parent_id": null, "hidden": false, "id": 0}], "industries": null, "layouts": [], "locale": null, "message_destinations": [], "notifications": null, "overrides": null, "phases": [], "playbooks": [{"activation_type": "manual", "content": {"content_version": 8, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb\" isExecutable=\"true\" name=\"playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_19wsot1</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"VirusTotal\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"d108590a-21f9-4e42-92c4-d2a6fe39c9b4\">{\"inputs\":{},\"pre_processing_script\":\"typeLookup = { 'Email Attachment': 'file', 'Malware Sample': 'file', 'Malware MD5 Hash': 'hash', 'Malware SHA-1 Hash': 'hash', 'Malware SHA-256 Hash': 'hash', 'Other File': 'file', 'RCF 822 Email Message File': 'file', 'File Name': 'filename',\\n 'URL': 'url', 'IP Address': 'ip', 'DNS Name':'domain'}\\nif artifact.type in typeLookup:\\n  inputs.vt_type = typeLookup.get(artifact.type, artifact.type)\\nelse:\\n  inputs.vt_type = artifact.type\\n\\ninputs.incident_id = incident.id\\ninputs.artifact_id = artifact.id\\ninputs.vt_data = artifact.value\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"vt_scan_results\"}</resilient:function></extensionElements><incoming>Flow_19wsot1</incoming><outgoing>Flow_0hr502p</outgoing></serviceTask><sequenceFlow id=\"Flow_19wsot1\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"VirusTotal: create artifact hit from VirusTotal results\"><extensionElements><resilient:script uuid=\"65a986a8-bb09-4594-9e4d-225a95aaae37\"/></extensionElements><incoming>Flow_0hr502p</incoming><outgoing>Flow_0i5o6y3</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_0hr502p\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_0i5o6y3</incoming></endEvent><sequenceFlow id=\"Flow_0i5o6y3\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_0i5o6y3\" id=\"Flow_0i5o6y3_di\"><omgdi:waypoint x=\"721\" y=\"92\"/><omgdi:waypoint x=\"721\" y=\"154\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0hr502p\" id=\"Flow_0hr502p_di\"><omgdi:waypoint x=\"721\" y=\"-28\"/><omgdi:waypoint x=\"721\" y=\"8\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_19wsot1\" id=\"Flow_19wsot1_di\"><omgdi:waypoint x=\"721\" y=\"-184\"/><omgdi:waypoint x=\"721\" y=\"-112\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"-236\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"622.7\" y=\"-112.5\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"622.7\" y=\"7.5\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"654.7\" y=\"153.5\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1685653676008, "creator_principal": {"display_name": "Admin User", "id": 1, "name": "admin@example.com", "type": "user"}, "deployment_id": "playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb", "description": {"format": "text", "content": "Create artifact hits on artifacts the VirusTotal has deemed malicious. Create malware hash artifacts if found in the VT scan data results."}, "display_name": "VirusTotal: Scan for Hits (PB)", "export_key": "virustotal_scan_hits_manual", "field_type_handle": "playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb", "fields_type": {"actions": [], "display_name": "VirusTotal: Scan Manual (PB)", "export_key": "playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_0137b9e5_d20c_4be4_bcfb_602750fb8bcb", "uuid": "26046d72-c47c-4c11-8a3d-69c9df84edc5"}, "has_logical_errors": false, "id": 32, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "Admin User", "id": 1, "name": "admin@example.com", "type": "user"}, "last_modified_time": 1686061794768, "local_scripts": [{"actions": [], "created_date": 1685653676209, "description": "Create artifact hits on artifacts the VirusTotal has deemed malicious. Created malware hash artifacts if found in the VT scan data results.", "enabled": false, "export_key": "VirusTotal: create artifact hit from VirusTotal results", "id": 44, "language": "python3", "last_modified_by": "admin@example.com", "last_modified_time": 1685735470979, "name": "VirusTotal: create artifact hit from VirusTotal results", "object_type": "artifact", "playbook_handle": "virustotal_scan_hits_manual", "programmatic_name": "virustotal_scan_hits_manual_example_virustotal_scan_hits_manual_virustotal_create_artifact_hit_from_virustotal_results", "script_text": "VIRUSTOTAL_GUI_URL = \"https://www.virustotal.com/gui\"\n\nresults = playbook.functions.results.vt_scan_results\n\nif results:\n  scan = results.get(\"scan\", None)\n  if scan and scan.get(\"data\", None):\n    data = scan.get(\"data\", None)\n    attributes = data.get(\"attributes\", None)\n    if attributes:\n      last_analysis_stats = attributes.get(\"last_analysis_stats\", None)\n      if last_analysis_stats:\n        malicious = last_analysis_stats.get(\"malicious\", None)\n        if malicious and malicious > 0:\n          hit = [\n            {\n              \"name\": \"Artifact Value\",\n              \"type\": \"string\",\n              \"value\": \"{}\".format(artifact.value)\n            }\n          ]\n          \n          # Add VirusTotal Report link to the note\n          uriLookup = { 'Email Attachment': 'file', \n                'Malware Sample': 'file', \n                'Malware MD5 Hash': 'file', \n                'Malware SHA-1 Hash': 'file', \n                'Malware SHA-256 Hash': 'file', \n                'Other File': 'file',\n                'RCF 822 Email Message File': 'file', \n                'File Name': 'file',\n                'URL': 'url', \n                'IP Address': 'ip-address', \n                'DNS Name':'domain'}\n          uri_fragment = uriLookup.get(artifact.type, None)\n          vt_id = data.get(\"id\", None)\n\n          if vt_id and uri_fragment:\n            entry = {\"name\": \"VirusTotal Report\", \n                     \"type\": \"uri\",\n                     \"value\": \"{0}/{1}/{2}\".format(VIRUSTOTAL_GUI_URL, uri_fragment, vt_id)\n                     }\n            hit.append(entry)\n\n          artifact.addHit(\"VirusTotal hits added.\", hit)\n\n          if attributes.get(\"last_http_response_content_sha256\", None):\n            incident.addArtifact('Malware SHA-256 Hash', attributes.get(\"last_http_response_content_sha256\", None), \"Created by VirusTotalapp for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n            \n          if attributes.get('md5', None):\n            incident.addArtifact('Malware MD5 Hash', attributes.get('md5'), \"Created by VirusTotal app for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n  \n          if attributes.get('sha1', None):\n            incident.addArtifact('Malware SHA-1 Hash', attributes.get('sha1'), \"Created by VirusTotalapp for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n    \n          if attributes.get('sha256', None):\n            incident.addArtifact('Malware SHA-256 Hash', attributes.get('sha256'), \"Created by VirusTotal app for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n        else:\n          incident.addNote(\"VirusTotal has not found a hit: {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n      else:\n        incident.addNote(\"VirusTotal has failed. - no last_analysis_stats: {0} {1} {2}.\".format(artifact.type, artifact.value, artifact.id))\n    else:\n      incident.addNote(\"VirusTotal has failed - no attributes: {0} {1} {2}.\".format(artifact.type, artifact.value, artifact.id))\n  else:\n    incident.addNote(\"VirusTotal has failed - no data: {0} {1} {2].\".format(artifact.type, artifact.value, artifact.id))\nelse:\n  incident.addNote(\"VirusTotal has failed - no results: {0} {1} {2}.\".format(artifact.type, artifact.value, artifact.id))\n      ", "tags": [], "uuid": "65a986a8-bb09-4594-9e4d-225a95aaae37"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "equals", "type": null, "value": "DNS Name"}, {"evaluation_id": null, "field_name": "artifact.type", "method": "equals", "type": null, "value": "IP Address"}, {"evaluation_id": null, "field_name": "artifact.type", "method": "equals", "type": null, "value": "Malware MD5 Hash"}, {"evaluation_id": null, "field_name": "artifact.type", "method": "equals", "type": null, "value": "Malware SHA-256 Hash"}, {"evaluation_id": null, "field_name": "artifact.type", "method": "equals", "type": null, "value": "URL"}], "logic_type": "any"}, "view_items": []}, "name": "virustotal_scan_hits_manual", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "playbook_0137b9e5-d20c-4be4-bcfb-602750fb8bcb", "id": 35, "name": "playbook_0137b9e5-d20c-4be4-bcfb-602750fb8bcb", "type": "playbook", "uuid": "0696d648-7740-4b60-9789-c275ad73fab1"}, "tags": [], "type": "default", "uuid": "0137b9e5-d20c-4be4-bcfb-602750fb8bcb", "version": 14}, {"activation_details": {"activation_conditions": {"conditions": [{"evaluation_id": 1, "field_name": "artifact.type", "method": "equals", "type": null, "value": "IP Address"}, {"evaluation_id": 2, "field_name": "artifact.type", "method": "equals", "type": null, "value": "Malware MD5 Hash"}, {"evaluation_id": 3, "field_name": "artifact.type", "method": "equals", "type": null, "value": "DNS Name"}, {"evaluation_id": 4, "field_name": "artifact.type", "method": "equals", "type": null, "value": "URL"}, {"evaluation_id": 5, "field_name": "artifact.type", "method": "equals", "type": null, "value": "Malware SHA-256 Hash"}, {"evaluation_id": 6, "field_name": null, "method": "object_added", "type": null, "value": null}], "custom_condition": "6 AND (1 OR 2 OR 3 OR 4 OR 5)", "logic_type": "advanced"}}, "activation_type": "automatic", "content": {"content_version": 51, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e\" isExecutable=\"true\" name=\"playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_10ys58q</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"VirusTotal\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"d108590a-21f9-4e42-92c4-d2a6fe39c9b4\">{\"inputs\":{},\"pre_processing_script\":\"typeLookup = { 'Email Attachment': 'file', 'Malware Sample': 'file', 'Malware MD5 Hash': 'hash', 'Malware SHA-1 Hash': 'hash', 'Malware SHA-256 Hash': 'hash', 'Other File': 'file', 'RCF 822 Email Message File': 'file', 'File Name': 'filename',\\n 'URL': 'url', 'IP Address': 'ip', 'DNS Name':'domain'}\\nif artifact.type in typeLookup:\\n  inputs.vt_type = typeLookup.get(artifact.type, artifact.type)\\nelse:\\n  inputs.vt_type = artifact.type\\n\\ninputs.incident_id = incident.id\\ninputs.artifact_id = artifact.id\\ninputs.vt_data = artifact.value\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"vt_scan_results\"}</resilient:function></extensionElements><incoming>Flow_10ys58q</incoming><outgoing>Flow_0nybqro</outgoing></serviceTask><sequenceFlow id=\"Flow_10ys58q\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"VirusTotal: Create artifact hits\"><extensionElements><resilient:script uuid=\"f739be17-e9d4-4ccc-b889-d0fe0215f4d0\"/></extensionElements><incoming>Flow_0nybqro</incoming><outgoing>Flow_0iw8kar</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_0nybqro\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_0iw8kar</incoming></endEvent><sequenceFlow id=\"Flow_0iw8kar\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_0iw8kar\" id=\"Flow_0iw8kar_di\"><omgdi:waypoint x=\"721\" y=\"412\"/><omgdi:waypoint x=\"721\" y=\"484\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0nybqro\" id=\"Flow_0nybqro_di\"><omgdi:waypoint x=\"721\" y=\"272\"/><omgdi:waypoint x=\"721\" y=\"328\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_10ys58q\" id=\"Flow_10ys58q_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"188\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"188\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"328\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"484\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1682453595198, "creator_principal": {"display_name": "Admin User", "id": 1, "name": "admin@example.com", "type": "user"}, "deployment_id": "playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e", "description": {"format": "text", "content": "Perform automatic lookups for artifacts including IP addresses, hashes, domains, and URLS and creates a hit for the artifact if it is deemed potentially malicious by VirusTotal."}, "display_name": "VirusTotal: Scan for Hits Automatic (PB)", "export_key": "virustotal_scan_hits", "field_type_handle": "playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e", "fields_type": {"actions": [], "display_name": "VirusTotal: Scan for Hits Automatic (PB)", "export_key": "playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e", "uuid": "12c0652f-0c9e-4c53-9b62-5a8f2636ea6e"}, "has_logical_errors": false, "id": 3, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "Admin User", "id": 1, "name": "admin@example.com", "type": "user"}, "last_modified_time": 1686061904580, "local_scripts": [{"actions": [], "created_date": 1682454020006, "description": "Create artifact hits on artifacts the VirusTotal has deemed malicious. Create malware hash artifacts if found in the VT scan data results.", "enabled": false, "export_key": "VirusTotal: Create artifact hits", "id": 4, "language": "python3", "last_modified_by": "admin@example.com", "last_modified_time": 1685735543695, "name": "VirusTotal: Create artifact hits", "object_type": "artifact", "playbook_handle": "virustotal_scan_hits", "programmatic_name": "virustotal_scan_hits_virustotal_create_artifact_hits", "script_text": "VIRUSTOTAL_GUI_URL = \"https://www.virustotal.com/gui\"\n\nresults = playbook.functions.results.vt_scan_results\n\nif results:\n  scan = results.get(\"scan\", None)\n  if scan and scan.get(\"data\", None):\n    data = scan.get(\"data\", None)\n    attributes = data.get(\"attributes\", None)\n    if attributes:\n      last_analysis_stats = attributes.get(\"last_analysis_stats\", None)\n      if last_analysis_stats:\n        malicious = last_analysis_stats.get(\"malicious\", None)\n        if malicious and malicious > 0:\n          hit = [\n            {\n              \"name\": \"Artifact Value\",\n              \"type\": \"string\",\n              \"value\": \"{}\".format(artifact.value)\n            }\n          ]\n          \n          # Add VirusTotal Report link to the note\n          uriLookup = { 'Email Attachment': 'file', \n                'Malware Sample': 'file', \n                'Malware MD5 Hash': 'file', \n                'Malware SHA-1 Hash': 'file', \n                'Malware SHA-256 Hash': 'file', \n                'Other File': 'file',\n                'RCF 822 Email Message File': 'file', \n                'File Name': 'file',\n                'URL': 'url', \n                'IP Address': 'ip-address', \n                'DNS Name':'domain'}\n          uri_fragment = uriLookup.get(artifact.type, None)\n          vt_id = data.get(\"id\", None)\n\n          if vt_id and uri_fragment:\n            entry = {\"name\": \"VirusTotal Report\", \n                     \"type\": \"uri\",\n                     \"value\": \"{0}/{1}/{2}\".format(VIRUSTOTAL_GUI_URL, uri_fragment, vt_id)\n                     }\n            hit.append(entry)\n\n          artifact.addHit(\"VirusTotal hits added.\", hit)\n\n          if attributes.get(\"last_http_response_content_sha256\", None):\n            incident.addArtifact('Malware SHA-256 Hash', attributes.get(\"last_http_response_content_sha256\", None), \"Created by VirusTotal app for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n            \n          if attributes.get('md5', None):\n            incident.addArtifact('Malware MD5 Hash', attributes.get('md5'), \"Created by VirusTotal app for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n  \n          if attributes.get('sha1', None):\n            incident.addArtifact('Malware SHA-1 Hash', attributes.get('sha1'), \"Created by VirusTotalapp for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n    \n          if attributes.get('sha256', None):\n            incident.addArtifact('Malware SHA-256 Hash', attributes.get('sha256'), \"Created by VirusTotal app for {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n\n        else:\n          incident.addNote(\"VirusTotal has not found a hit: {0}: <b>{1}</b>  artifact id:{2}.\".format(artifact.type, artifact.value, artifact.id))\n      else:\n        incident.addNote(\"VirusTotal has failed. - no last_analysis_stats: {0} {1} {2}.\".format(artifact.type, artifact.value, artifact.id))\n    else:\n      incident.addNote(\"VirusTotal has failed - no attributes: {0} {1} {2}.\".format(artifact.type, artifact.value, artifact.id))\n  else:\n    incident.addNote(\"VirusTotal has failed - no data: {0} {1} {2].\".format(artifact.type, artifact.value, artifact.id))\nelse:\n  incident.addNote(\"VirusTotal has failed - no results: {0} {1} {2}.\".format(artifact.type, artifact.value, artifact.id))\n      ", "tags": [], "uuid": "f739be17-e9d4-4ccc-b889-d0fe0215f4d0"}], "name": "virustotal_scan_hits", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "Playbook_eff2d4c0-cdb2-4b4c-825b-347c357cf05e", "id": 3, "name": "playbook_eff2d4c0_cdb2_4b4c_825b_347c357cf05e", "type": "playbook", "uuid": "6fd8cf7a-e50c-489b-8fa2-149653a8bbe6"}, "tags": [], "type": "default", "uuid": "eff2d4c0-cdb2-4b4c-825b-347c357cf05e", "version": 64}], "regulators": null, "roles": [], "scripts": [], "server_version": {"build_number": 8131, "major": 45, "minor": 2, "version": "45.2.0"}, "tags": [], "task_order": [], "timeframes": null, "types": [], "workflows": [], "workspaces": []}